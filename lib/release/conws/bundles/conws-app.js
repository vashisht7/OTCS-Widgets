csui.define("css!conws/utils/icons/icons",[],function(){}),csui.define("conws/utils/icons/icons",["css!conws/utils/icons/icons"],function(){return[{"equals":{"type":848},"className":"csui-icon conws-mime_workspace"},{"equals":{"type":854},"className":"csui-icon conws-mime_related_workspace"},{"equals":{"type":20541},"className":"csui-icon conws-doctemplates_volume"}]}),csui.define("conws/controls/inlineforms/workspace/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/inlineforms/workspace/impl/nls/root/lang",{"NewWorkspacePlaceholder":"Enter new workspace name"}),csui.define("hbs!conws/controls/inlineforms/workspace/impl/workspace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'  <div class="csui-inlineform-group csui-inlineform-group-error">\r\n    <div class="binf-text-danger">'+this.escapeExpression((i=null!=(i=t.errorMessage||(null!=e?e.errorMessage:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"errorMessage","hash":{}}):i))+"</div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="csui-inlineform-group conws-inlineform-group-workspace-name">\r\n  <input type="text" value="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" placeholder="'+this.escapeExpression((n=null!=(n=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"namePlaceholder","hash":{}}):n))+'"\r\n         class="binf-form-control csui-inlineform-input-name">\r\n  <button class="csui-btn-metadata binf-btn"><span class="csui-icon icon-metadata"></span></button>\r\n  <button class="csui-btn-save csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n  <button class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n</div>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("conws_controls_inlineforms_workspace_impl_workspace",s),s}),csui.define("css!conws/controls/inlineforms/workspace/impl/workspace",[],function(){}),csui.define("conws/controls/inlineforms/workspace/workspace.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!conws/controls/inlineforms/workspace/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!conws/controls/inlineforms/workspace/impl/workspace","css!conws/controls/inlineforms/workspace/impl/workspace"],function(e,t,i,s,o,n,a){var r=n.extend({"className":function(){var e="conws-inlineform-workspace";return n.prototype.className&&(e+=" "+t.result(n.prototype,"className")),e},"template":a,"templateHelpers":function(){var e=this._templateHelpers(),i=t.extend(e,{"namePlaceholder":s.NewWorkspacePlaceholder});return i},"ui":{},"events":{},"constructor":function(e){this.options=e||{},this.ui=t.extend({},this.ui,n.prototype.ui),this.events=t.extend({},this.events,n.prototype.events),i.ItemView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.ui.inputFieldName.select()},"_saveIfOk":function(){this._viewToModelData();var e=this.model.get("name");e.length>0&&this._save({"name":e})}},{"CSSubType":848});return o.registerByAddableType(r.CSSubType,r),r}),csui.define("conws/controls/inlineforms/conwstemplate/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/inlineforms/conwstemplate/impl/nls/root/lang",{"NamePlaceholder":"Enter name","WSTypePlaceholder":"Select Workspace Type"}),csui.define("conws/models/workspacetypes/workspacetype.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url"],function(e,t,i,s){var o=i.Model.extend({"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments),t&&t.connector&&t.connector.assignTo(this)},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),t=s.combine(e,"businessworkspacetypes");return t},"parse":function(e){return this.fetched=!0,{"wstypes":e.results}},"isFetchable":function(){return!0}});return o}),csui.define("conws/models/workspacetypes/workspacetype.factory",["module","csui/lib/jquery","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","conws/models/workspacetypes/workspacetype.model","csui/utils/commands"],function(e,t,i,s,o,n){var a=s.extend({"propertyPrefix":"workspacetypes","constructor":function(e,t){s.prototype.constructor.apply(this,arguments);var i=e.getObject(o,t);this.context=e,this.property=new n(t,{"connector":i})},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}});return a}),csui.define("hbs!conws/controls/inlineforms/conwstemplate/impl/conwstemplate",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return"hasError"},"3":function(e,t,i,s){var o,n;return'    <select type="text" value="" class="binf-hidden-xs binf-hidden-sm binf-form-control conws-inlineform-input-wstype">\r\n      <option value="">'+this.escapeExpression((n=null!=(n=t.wsTypePlaceholder||(null!=e?e.wsTypePlaceholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wsTypePlaceholder","hash":{}}):n))+"</option>\r\n"+(null!=(o=t.each.call(e,null!=e?e.wstypes:e,{"name":"each","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?o:"")+"    </select>\r\n"},"4":function(e){var t;return'      <option value="'+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.data:e)?t.properties:t)?t.wksp_type_id:t,e))+'">'+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.data:e)?t.properties:t)?t.wksp_type_name:t,e))+"</option>\r\n"},"6":function(){return" "},"8":function(){return"binf-btn-default "},"10":function(){return" disabled "},"12":function(e,t,i,s){var o,n;return'    <select type="text" value="" class=" binf-form-control conws-inlineform-input-wstype">\r\n      <option value="">'+this.escapeExpression((n=null!=(n=t.wsTypePlaceholder||(null!=e?e.wsTypePlaceholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wsTypePlaceholder","hash":{}}):n))+"</option>\r\n"+(null!=(o=t.each.call(e,null!=e?e.wstypes:e,{"name":"each","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?o:"")+"    </select>\r\n"},"14":function(e,t){var i;return'<div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n  <div class="binf-text-danger">'+this.escapeExpression((i=null!=(i=t.errorMessage||(null!=e?e.errorMessage:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"errorMessage","hash":{}}):i))+"</div>\r\n</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<form>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       conws-inlineform-vertical-spacer"></div>\r\n  <div class="csui-inlineform-group csui-inlineform-group-conwstemplate">\r\n\r\n    <input type="text" value="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" placeholder="'+this.escapeExpression((n=null!=(n=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"namePlaceholder","hash":{}}):n))+'" class="binf-form-control csui-inlineform-input-name '+(null!=(o=t["if"].call(e,null!=e?e.validationFailed_Name:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'">\r\n    \r\n'+(null!=(o=t["if"].call(e,null!=e?e.createMode:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+'\r\n    <button type="button" class="binf-hidden-xs\r\n    binf-hidden-sm csui-btn-metadata binf-btn">\r\n      <span class="icon icon-toolbar-metadata"></span>\r\n    </button>\r\n    <button type="submit" class="binf-hidden-xs\r\n    binf-hidden-sm csui-btn-save csui-btn binf-btn\r\n            '+(null!=(o=t["if"].call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?o:"")+'" '+(null!=(o=t["if"].call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")+">"+this.escapeExpression((n=null!=(n=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n    <button type="button" class="binf-hidden-xs binf-hidden-sm csui-btn-cancel csui-btn binf-btn\r\n            binf-btn-default">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+'</button>\r\n\r\n  </div>\r\n\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       conws-inlineform-vertical-spacer"></div>\r\n\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl csui-inlineform-group\r\ncsui-inlineform-group-conwstemplate-wrapped">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.createMode:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?o:"")+'    <button type="button" class="csui-btn-metadata binf-btn">\r\n      <span class="icon icon-toolbar-metadata"></span>\r\n    </button>\r\n    <button type="submit" class="csui-btn-save csui-btn binf-btn\r\n            '+(null!=(o=t["if"].call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?o:"")+'" '+(null!=(o=t["if"].call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")+">"+this.escapeExpression((n=null!=(n=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n    <button type="button" class="csui-btn-cancel csui-btn binf-btn binf-btn-default">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+'</button>\r\n  </div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       conws-inlineform-vertical-spacer"></div>\r\n</form>\r\n'+(null!=(o=t["if"].call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("conws_controls_inlineforms_conwstemplate_impl_conwstemplate",s),s}),csui.define("css!conws/controls/inlineforms/conwstemplate/impl/conwstemplate",[],function(){}),csui.define("conws/controls/inlineforms/conwstemplate/conwstemplate.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!conws/controls/inlineforms/conwstemplate/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","conws/models/workspacetypes/workspacetype.factory","hbs!conws/controls/inlineforms/conwstemplate/impl/conwstemplate","css!conws/controls/inlineforms/conwstemplate/impl/conwstemplate"],function(e,t,i,s,o,n,a,r,l){var c=a.extend({"className":function(){var e="conws-template-csui-inlineform";return a.prototype.className&&(e+=" "+i.result(a.prototype,"className")),e},"template":l,"templateHelpers":function(){var e=this._templateHelpers(),t=i.extend(e,{"wstypes":this.wstypes?this.wstypes.get("wstypes"):"","namePlaceholder":o.NamePlaceholder,"wsTypePlaceholder":o.WSTypePlaceholder,"createMode":this.createMode});return t},"ui":{"wsTypeField":".conws-inlineform-input-wstype"},"events":{"change @ui.wsTypeField":"keyReleased"},"constructor":function(e){if(this.options=e||{},this.ui=i.extend({},this.ui,a.prototype.ui),this.events=i.extend({},this.events,a.prototype.events),s.ItemView.prototype.constructor.apply(this,arguments),this.createMode=""===this.options.model.get("name")?!0:!1,this.createMode){var t=this.options.context.getFactory("workspacetypes");t&&t.property&&t.property.fetched?this.wstypes=t.property:(this.wstypes=this.options.context.getModel(r,{}),this.wstypes.fetch(),this.listenTo(this.wstypes,"sync",this.render))}},"_viewToModelDataExtended":function(){this.createMode&&this.model.set("reference_type",this._getWSTypeID(),{"silent":!0})},"toggleButton":function(){if(this.ui.saveButton.length){var e=this.ui.inputFieldName.val().trim(),t=!1;if(t=0!==e.length,this.createMode){var i=this.ui.wsTypeField?this.ui.wsTypeField[0]:void 0;if(t&&i){var s=this._getWSTypeID();t=0!==s.length}}t?this.ui.saveButton.prop("disabled",!1).addClass("binf-btn-default"):this.ui.saveButton.attr("disabled","disabled").removeClass("binf-btn-default")}this.refershTabableElements()},"_getWSTypeID":function(){var e=this.ui.wsTypeField;return t(e).val()},"_saveIfOk":function(){this._viewToModelData();var e=this.model.get("name"),t={},i=!1;if(e.length>0&&(t.name=e,i=!0),this.createMode&&i){var s=this._getWSTypeID();s.length>0?t.reference_type=s:i=!1}i&&this._save(t)}},{"CSSubType":848});return n.registerByAddableType(c.CSSubType,c),c}),csui.define("conws/controls/form/fields/referencefield.states.behavior",["csui/controls/form/impl/fields/csformfield.states.behavior"],function(e){var t=e.extend({"constructor":function(){e.apply(this,arguments)},"isReadOnly":function(){return!0}});return t}),csui.define("hbs!conws/controls/form/impl/fields/reference/reference",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.hasValue:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?o:""},"2":function(e,t){var i;return'			 <div class="btn-container reference-field-data">\r\n				<button aria-labelledby="'+this.escapeExpression((i=null!=(i=t.idBtnLabel||(null!=e?e.idBtnLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"idBtnLabel","hash":{}}):i))+" "+this.escapeExpression((i=null!=(i=t.refDataId||(null!=e?e.refDataId:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"refDataId","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.data||(null!=e?e.data:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"data","hash":{}}):i))+'">\r\n					<span id="'+this.escapeExpression((i=null!=(i=t.refDataId||(null!=e?e.refDataId:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"refDataId","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.data||(null!=e?e.data:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"data","hash":{}}):i))+"</span>\r\n				</button>\r\n			 </div>\r\n"},"4":function(e,t,i,s){var o,n;return'		<div class="reference-field-generate '+(null!=(o=t["if"].call(e,null!=e?e.generateReference:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(5,s,0)}))?o:"")+'">\r\n			<button id="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.btnDesc||(null!=e?e.btnDesc:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"btnDesc","hash":{}}):n))+'" class="binf-btn binf-btn-primary reference-generate-number '+(null!=(o=t["if"].call(e,null!=e?e.generateReference:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(7,s,0)}))?o:"")+'" \r\n					title="'+this.escapeExpression((n=null!=(n=t.genRefNumber||(null!=e?e.genRefNumber:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"genRefNumber","hash":{}}):n))+'" '+(null!=(o=t["if"].call(e,null!=e?e.generateReference:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(9,s,0)}))?o:"")+">"+this.escapeExpression((n=null!=(n=t.genRefNumber||(null!=e?e.genRefNumber:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"genRefNumber","hash":{}}):n))+'\r\n			</button>\r\n		</div>\r\n		<div class="reference-field-generate-read">\r\n			<div class="reference-field-generate-text">'+this.escapeExpression((n=null!=(n=t.depInlineText||(null!=e?e.depInlineText:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"depInlineText","hash":{}}):n))+" </div>\r\n		</div>\r\n"},"5":function(){return" cursor-disabled "},"7":function(){return" reference-generate-number-disabled "},"9":function(){return' aria-disabled="true" '},"11":function(e,t,i,s){var o,n;return'   <div class="cs-field-read">\r\n        <div class="cs-field-read-inner">\r\n            <div class="btn-container">\r\n				<button aria-labelledby="'+this.escapeExpression((n=null!=(n=t.idBtnLabel||(null!=e?e.idBtnLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"idBtnLabel","hash":{}}):n))+" "+this.escapeExpression((n=null!=(n=t.refDataId||(null!=e?e.refDataId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"refDataId","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.data||(null!=e?e.data:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"data","hash":{}}):n))+'">\r\n					<span id="'+this.escapeExpression((n=null!=(n=t.refDataId||(null!=e?e.refDataId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"refDataId","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.data||(null!=e?e.data:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"data","hash":{}}):n))+"</span>\r\n				</button>\r\n            </div>\r\n        </div>\r\n    </div>   \r\n"+(null!=(o=t["if"].call(e,null!=e?e.readOnly:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(12,s,0)}))?o:"")},"12":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.canRegenerateReference:e,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?o:""},"13":function(e,t){var i;return'			<div class="reference-field-generate-read">\r\n				<button id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.btnDesc||(null!=e?e.btnDesc:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"btnDesc","hash":{}}):i))+'" class="binf-btn binf-btn-primary reference-generate-number"\r\n						title="'+this.escapeExpression((i=null!=(i=t.reGenRefNumber||(null!=e?e.reGenRefNumber:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"reGenRefNumber","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.reGenRefNumber||(null!=e?e.reGenRefNumber:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"reGenRefNumber","hash":{}}):i))+'\r\n				</button>\r\n			</div>\r\n			<div class="reference-field-generate-read">\r\n				<div class="reference-field-generate-text">'+this.escapeExpression((i=null!=(i=t.depInlineText||(null!=e?e.depInlineText:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"depInlineText","hash":{}}):i))+" </div>\r\n			</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="reference-field">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.create:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(11,s,0)}))?o:"")+"</div>\r\n\r\n"}});return i.registerPartial("conws_controls_form_impl_fields_reference_reference",s),s}),csui.define("conws/controls/form/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/form/impl/nls/root/lang",{"genRefNumber":"Generate reference","reGenRefNumber":"Re-generate reference","depFieldsText":"Value can be generated automatically and depends on","rmClassificationText":"RM Classification","rmClassificationNameText":"Following RM classification will be used in reference generation:","independentFieldsText":"Value can be generated automatically"}),csui.define("css!conws/controls/form/impl/fields/reference/reference",[],function(){}),csui.define("conws/controls/form/fields/reference.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","csui/utils/url","csui/controls/form/impl/fields/csformfield.editable.behavior","csui/dialogs/modal.alert/modal.alert","csui/controls/form/pub.sub","conws/controls/form/fields/referencefield.states.behavior","hbs!conws/controls/form/impl/fields/reference/reference","i18n!conws/controls/form/impl/nls/lang","css!conws/controls/form/impl/fields/reference/reference"],function(e,t,i,s,o,n,a,r,l,c,d,p){var u=o.extend({"constructor":function(){o.apply(this,arguments),this.create="create"===this.options.mode?!0:!1,this.catId=this.options.dataId.split("_")[0],this.formView=this.options.alpacaField.connector.config.formView,this.node=this.formView.node?this.formView.node:this.formView.model.node,this.connector=this.node.connector,this.generatereference=!1,this.regenerateReference=!1,this.parentsAttrDataChanged=!1,this.parentattrIds=[],this.parentsattrData=[],this.canRegenerateReference=this.alpacaField.schema.canRegenerateReference,this.rmClassificationUsed=this.alpacaField.schema.rmClassificationUsed,this.rmClassificationsAttached=!0,this.alpacaField.schema.oldReferenceAttributeID&&(this.oldReferenceAttributeID=this.alpacaField.schema.oldReferenceAttributeID),this.create&&this.listenTo(this.formView,"invalid:field",this.invalidFieldChange);var t;this.hasValue=null===this.alpacaField.data||void 0===this.alpacaField.data||""===this.alpacaField.data?!1:!0,this.alpacaField.schema.depattrlist&&e.each(this.options.alpaca.schema.depattrlist,function(e){this.parentattrIds.push(e),t={"id":e,"data":this.getAttrData(e)},this.parentsattrData.push(t),this.create&&this.listenTo(l,e+"dependentattrchanged",this.parentChange)},this),this.parentattrIds.length>0?this.checkReadyForGenerateReference():this.hasValue||(this.generatereference=!0),this.create&&this.rmClassificationUsed&&this.formView.model.collection&&(this.listenTo(this.formView.model.collection,"add",this.rmClassificationChange),this.listenTo(this.formView.model.collection,"remove",this.rmClassificationChange),this.formView.model.collection.get("recordsDetails")||(this.rmClassificationsAttached=!1,this.generatereference=!1,this.regenerateReference=!1)),this.create===!1&&(this.regenerateReference=!0),this.idBtnLabel=this.options.labelId?this.options.labelId:"",this.refDataId=e.uniqueId("referenceData"),this.depFieldsText=this.getDependencyInlineText(),this.btnDesc=this.alpacaField.options.label+", "+(this.hasValue?p.reGenRefNumber:p.genRefNumber)+", "+(this.canRegenerateReference?this.depFieldsText:"")},"className":"cs-formfield cs-referencefield","template":d,"templateHelpers":function(){return{"create":this.create,"generateReference":this.generatereference,"data":this.curVal,"hasValue":this.hasValue,"readOnly":this.alpacaField.schema.readonly,"depInlineText":this.depFieldsText,"id":this.model&&this.model.get("id")?this.model.get("id"):e.uniqueId("button"),"genRefNumber":p.genRefNumber,"reGenRefNumber":p.reGenRefNumber,"canRegenerateReference":this.canRegenerateReference,"idBtnLabel":this.idBtnLabel,"refDataId":this.refDataId,"btnDesc":this.btnDesc}},"behaviors":{"FormFieldEditable":{"behaviorClass":a},"FormFieldStates":{"behaviorClass":c}},"events":{"click button.reference-generate-number":"generateReferenceNumber"},"getDependencyInlineText":function(){var e,t="",i="";return this.rmClassificationUsed&&this.rmClassificationsAttached&&this.formView.model.collection&&(this.formView.model.collection.get("recordsDetails").options.className?i=this.formView.model.collection.get("recordsDetails").options.className:this.formView.model.collection.get("recordsDetails").get("data")&&(e=this.formView.model.collection.get("recordsDetails").get("data"),e.name?i=this.formView.model.collection.get("recordsDetails").get("data").name:e.inherited_rmclassification_name&&(i=e.inherited_rmclassification_name[0]))),this.parentattrIds.length>0?(t=p.depFieldsText+" "+this.alpacaField.schema.depattrtext,this.rmClassificationUsed&&(t=t+", "+p.rmClassificationText,this.rmClassificationsAttached&&(t=t+". "+p.rmClassificationNameText+" "+i))):this.rmClassificationUsed?(t=p.depFieldsText+" "+p.rmClassificationText,this.rmClassificationsAttached&&(t=t+". "+p.rmClassificationNameText+" "+i)):t=p.independentFieldsText,t},"generateReferenceNumber":function(e){if("true"===this.$el.find("button.reference-generate-number").attr("aria-disabled"))return e.preventDefault();var t,i=this.node.connector,s=this.getV2Url(i.connection.url),o=this,a=this.getFormData();t=n.combine(s+"/refnumbers");var l={"type":"POST","url":t,"data":a,"success":function(e){if(e.results.errMsg)r.showError(e.results.errMsg);else{if(o.regenerateReference&&o.oldReferenceAttributeID){var t=o.getAttrElement(o.oldReferenceAttributeID);"undefined"!=typeof t&&(t.setValue(o.curVal),t.refresh())}if(o.options.alpacaField.setValue(e.results.referenceNumber),o.hasValue=!0,o.curVal=o.options.alpacaField.getValue(),o.generatereference=!1,o.create===!1&&(o.regenerateReference=!0),o.parentsAttrDataChanged=!1,o.create)o.render(o.$el.find(".reference-field-data button").length>0)&&o.$el.find(".reference-field-data button").focus();else{var i=o.$el.find(".reference-field .btn-container button");i.find("span").text(o.curVal),i.focus()}o.create||848!==o.node.get("type")||(o.formView.options.metadataView?o.formView.options.metadataView.metadataHeaderView.metadataItemNameView.model.set("name",e.results.nodeName):o.formView.options.node.set("name",e.results.nodeName))}},"error":function(e){var t=e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:p.defaultErrorGenerateNumber;r.showError(t)}};i.extendAjaxOptions(l),i.makeAjaxCall(l)},"getV2Url":function(e){return e.replace("/v1","/v2")},"invalidFieldChange":function(t){var i=document.getElementById(t.target.id).closest(".alpaca-container-item").getAttribute("data-alpaca-container-item-name"),s=this;e.each(this.options.alpaca.schema.depattrlist,function(t){t===i&&e.each(s.parentsattrData,function(e){e.id===i&&(e.data=null)})});var o=this.generatereference;this.checkReadyForGenerateReference(),this.create?this.regenerateReference=!1:this.generatereference=this.hasValue?!1:!0,o!==this.generatereference&&(this.generatereference?this.$el.find("button.reference-generate-number").removeClass("reference-generate-number-disabled").attr("aria-disabled","false"):(this.$el.find(".reference-field-generate").addClass("cursor-disabled"),this.$el.find("button.reference-generate-number").addClass("reference-generate-number-disabled").attr("aria-disabled","true")))},"parentChange":function(e){var t,i=e,s=this.generatereference;i!==this&&(this.insertParentAttrData(e),this.checkReadyForGenerateReference(),this.create?this.regenerateReference=!1:this.generatereference=this.hasValue?!1:!0,t=this.generatereference,s!==t&&(this.generatereference?this.$el.find("button.reference-generate-number").removeClass("reference-generate-number-disabled").attr("aria-disabled","false"):(this.$el.find(".reference-field-generate").addClass("cursor-disabled"),this.$el.find("button.reference-generate-number").addClass("reference-generate-number-disabled").attr("aria-disabled","true"))))},"rmClassificationChange":function(){var e,t=this.generatereference;this.formView.model.collection&&this.formView.model.collection.get("recordsDetails")?(this.rmClassificationsAttached=!0,this.create?this.generatereference=!0:this.regenerateReference=!0):(this.rmClassificationsAttached=!1,this.generatereference=!1,this.regenerateReference=!1),this.checkReadyForGenerateReference();var i=this.getDependencyInlineText(),s=this.alpacaField.options.label+", "+(this.hasValue?p.reGenRefNumber:p.genRefNumber)+", "+(this.canRegenerateReference?i:"");this.$el.find(".reference-field .reference-field-generate-read .reference-field-generate-text").text(i),this.$el.find("button.reference-generate-number").attr("aria-label",s),e=this.generatereference,t!==e&&(this.generatereference?(this.$el.find(".reference-field-generate").removeClass("cursor-disabled"),this.$el.find("button.reference-generate-number").removeClass("reference-generate-number-disabled").attr("aria-disabled","false")):(this.$el.find(".reference-field-generate").addClass("cursor-disabled"),this.$el.find("button.reference-generate-number").addClass("reference-generate-number-disabled").attr("aria-disabled","true")))},"checkReadyForGenerateReference":function(){var t=0;e.each(this.parentsattrData,function(e){void 0!==e.data&&null!==e.data&&""!==e.data&&t++}),t===this.parentsattrData.length?this.create&&this.hasValue?(this.generatereference=!1,this.regenerateReference=!1):this.rmClassificationsAttached?this.create?(this.generatereference=!0,this.regenerateReference=!1):this.parentsAttrDataChanged?this.regenerateReference=!0:this.generatereference=!0:(this.generatereference=!1,this.regenerateReference=!1):(this.generatereference=!1,this.regenerateReference=!1)},"insertParentAttrData":function(t){var i=this,s=t.curVal;e.each(i.parentsattrData,function(e){e.id===t.options.dataId&&("object"==typeof t.curVal&&(s=t.curVal.id),String(e.data)!==s&&(e.data=s,i.generatereference=!0,i.regenerateReference=!0,i.parentsAttrDataChanged=!0))})},"getAttrData":function(e){var t,i,s,o,n=e.split("_"),a=n[0],r=0;if(n.length>3)if(6===n.length){if(s=n[0]+"_"+n[1],i=this.formView.alpaca.data[s],o=e.replace(s+"_",""),"undefined"!=typeof i)t=i[o];else if(this.formView.metadataview.formViewList.length>1)for(r=0;r<this.formView.metadataview.formViewList.length;r++)if("undefined"!=typeof this.formView.metadataview.formViewList[r].alpaca.data[o]){t=this.formView.metadataview.formViewList[r].alpaca.data[o];break}}else 7===n.length?n[2]===a?(s=n[0]+"_"+n[1],i=this.formView.alpaca.data[s],o=n[2]+"_"+n[3]+"_"+n[4]+"_"+n[5],t=i[o][0]):(s=n[0]+"_"+n[1],i=this.formView.alpaca.data[s][0],o=n[3]+"_"+n[4]+"_"+n[5]+"_"+n[6],t=i[o]):(s=n[0]+"_"+n[1],i=this.formView.alpaca.data[s][0],o=n[3]+"_"+n[4]+"_"+n[5]+"_"+n[6],t=i[o][0]);else{if(e=n[0]+"_"+n[1],t=this.formView.alpaca.data[e],"undefined"==typeof t&&this.formView.metadataview.formViewList.length>1)for(r=0;r<this.formView.metadataview.formViewList.length;r++)if("undefined"!=typeof this.formView.metadataview.formViewList[r].alpaca.data[e]){t=this.formView.metadataview.formViewList[r].alpaca.data[e];break}3===n.length&&(t=t[0])}return t},"getAttrElement":function(e){var t,i,s,o=e.split("_"),n=o[0],a=0;if(o.length>3)if(6===o.length){if(i=o[0]+"_"+o[1],t=this.formView.$el.alpaca().childrenByPropertyId[i],s=e.replace(i+"_",""),"undefined"!=typeof t)t=t.childrenByPropertyId[s];else if(this.formView.metadataview.formViewList.length>1)for(a=0;a<this.formView.metadataview.formViewList.length;a++)if("undefined"!=typeof this.formView.metadataview.formViewList[a].$el.alpaca().childrenByPropertyId[s]){t=this.formView.metadataview.formViewList[a].$el.alpaca().childrenByPropertyId[s];break}}else 7===o.length?o[2]===n?(i=o[0]+"_"+o[1],t=this.formView.$el.alpaca().childrenByPropertyId[i],s=o[2]+"_"+o[3]+"_"+o[4]+"_"+o[5],t=t.childrenByPropertyId[s].children[0]):(i=o[0]+"_"+o[1],t=this.formView.$el.alpaca().childrenByPropertyId[i].children[0],s=o[3]+"_"+o[4]+"_"+o[5]+"_"+o[6],t=t.childrenByPropertyId[s]):(i=o[0]+"_"+o[1],t=this.formView.$el.alpaca().childrenByPropertyId[i].children[0],s=o[3]+"_"+o[4]+"_"+o[5]+"_"+o[6],t=t.childrenByPropertyId[s].children[0]);else{if(e=o[0]+"_"+o[1],t=this.formView.$el.alpaca().childrenByPropertyId[e],"undefined"==typeof t&&this.formView.metadataview.formViewList.length>1)for(a=0;a<this.formView.metadataview.formViewList.length;a++)if("undefined"!=typeof this.formView.metadataview.formViewList[a].$el.alpaca().childrenByPropertyId[e]){t=this.formView.metadataview.formViewList[a].$el.alpaca().childrenByPropertyId[e];
break}3===o.length&&(t=t.children[0])}return t},"allowEditOnClickReadArea":function(){return!1},"getFormData":function(){var t,i={},s=this.create,o=this.node.attributes.id,n=this.node.attributes.parent_id,a=this.catId,r="",l="",c=0,d=this.options.alpaca.schema.cacheId;if(void 0!==s&&(i.create=s),!s)return void 0!==o&&(i.node_id=o),i;if(void 0!==d&&(i.cache_id=d),void 0!==n&&("object"==typeof n&&(n=n.id),i.parent_id=n),void 0!==a&&(i.category_id=a),this.formView.model.collection.get("recordsDetails")&&(t=this.formView.model.collection.get("recordsDetails").get("data"),t.rmclassification_id&&0!==t.rmclassification_id[0]?i.rm_class_ids=t.rmclassification_id[0]:t.inherited_rmclassification_id&&(i.rm_class_ids=t.inherited_rmclassification_id[0])),this.parentattrIds.length>0){var p=this.parentsattrData.length;e.each(this.parentsattrData,function(e){c++,c!==p?(r=""+r+"'"+e.id+"',",l=""+l+"'"+e.data+"',"):(r=r+"'"+e.id+"'",l=l+"'"+e.data+"'")}),void 0!==l&&void 0!==r&&(i.attribute_keys=r.toString(),i.attribute_values=l.toString())}return i}});return u}),csui.define("conws/controls/form/fields/alpaca/referencefield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","conws/controls/form/fields/reference.view","csui/utils/base"],function(e,t,i,s,o,n,a,r){return n.Fields.ReferenceField=n.Fields.TextField.extend({"constructor":function(e,t,i,s,o,n,a){this.base(e,t,i,s,o,n,a)},"getFieldType":function(){return"reference"},"postRender":function(e){this.base(e),this.showField()},"showField":function(){var e=this.id;this.options.id="lbl"+t.uniqueId(e);var n,a=i(this.field[0]).find("label");a&&1===a.length&&(n=a.attr("for")+"Label",a.attr("id",n)),this.fieldView=new r({"model":new s.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":e}),"id":t.uniqueId(e),"alpacaField":this,"labelId":n,"value":this.data,"readonly":!0,"mode":this.options.mode,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var l=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(l),this.region=new o.Region({"el":l}),this.region.show(this.fieldView)},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),n.registerFieldClass("reference",n.Fields.ReferenceField,"bootstrap-csui"),i.alpaca.Fields.ReferenceField}),csui.define("hbs!conws/controls/description/impl/description",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o,n;return'  <span class="description '+this.escapeExpression((n=null!=(n=t.truncate_fade_class||(null!=e?e.truncate_fade_class:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"truncate_fade_class","hash":{}}):n))+'"\r\n        title="'+this.escapeExpression((n=null!=(n=t.complete_description||(null!=e?e.complete_description:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"complete_description","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.current_description||(null!=e?e.current_description:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"current_description","hash":{}}):n))+"</span>\r\n"+(null!=(o=t.unless.call(e,null!=e?e.show_expandedView:e,{"name":"unless","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?o:"")},"2":function(e,t){var i;return'  <div class="description-caret-div">\r\n    <span class="description-readmore icon-expandArrowDownWhite" role="button" aria-expanded="false" title="'+this.escapeExpression((i=null!=(i=t.showmore_tooltip||(null!=e?e.showmore_tooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showmore_tooltip","hash":{}}):i))+'"\r\n          aria-label="'+this.escapeExpression((i=null!=(i=t.showmore_aria||(null!=e?e.showmore_aria:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showmore_aria","hash":{}}):i))+'" tabindex="0"></span>\r\n    <span class="description-showless icon-expandArrowUpWhite" role="button" aria-expanded="true" title="'+this.escapeExpression((i=null!=(i=t.showless_tooltip||(null!=e?e.showless_tooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showless_tooltip","hash":{}}):i))+'"\r\n          aria-label="'+this.escapeExpression((i=null!=(i=t.showless_aria||(null!=e?e.showless_aria:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showless_aria","hash":{}}):i))+'" tabindex="0"></span>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.current_description:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:""}});return i.registerPartial("conws_controls_description_impl_description",s),s}),csui.define("conws/controls/description/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/description/impl/nls/root/lang",{"showmore":"Show more","showmoreAria":"Show more description","showless":"Show less","showlessAria":"Show less description"}),csui.define("css!conws/controls/description/impl/description",[],function(){}),csui.define("conws/controls/description/description.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!conws/controls/description/impl/description","i18n!conws/controls/description/impl/nls/lang","css!conws/controls/description/impl/description"],function(e,t,i,s,o,n,a,r){var l=0,c=i.ItemView.extend({"className":"conws-description","template":a,"initialize":function(){this.shortDescMode=!0,this.has_more_desc=!1,this.hideShowLess=!1,this.collapsedHeightIsOneLine=!1},"templateHelpers":function(){return{"complete_description":this.options.complete_desc,"current_description":this.options.complete_desc,"more_description":this.has_more_desc&&!this.hideShowLess,"showmore_tooltip":r.showmore,"showmore_aria":r.showmoreAria,"showless_tooltip":r.showless,"showless_aria":r.showlessAria,"show_expandedView":this.expandDescription}},"ui":{"description":".description","readMore":".description-readmore","showLess":".description-showless","caretDiv":".description-caret-div"},"events":{"keydown @ui.readMore":"readMoreClicked","keydown @ui.showLess":"showLessClicked","click @ui.readMore":"readMoreClicked","click @ui.showLess":"showLessClicked"},"behaviors":{"TabableRegion":{"behaviorClass":o},"PerfectScrolling":{"behaviorClass":n,"contentParent":".description","suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(e){this.options=e||{},this.expandDescription=void 0===e.expandDescription?!0:e.expandDescription,i.ItemView.prototype.constructor.apply(this,arguments),this.hideShowLess=!1,this.listenTo(this,"dom:refresh",this._truncateIfNecessary),this.listenTo(this.options.view,"dom:refresh",function(){this.triggerMethod("dom:refresh")})},"currentlyFocusedElement":function(){return this.has_more_desc?this.shortDescMode?this.ui.readMore:this.ui.showLess:t()},"onDestroy":function(){l=0,this.renderTimer&&clearTimeout(this.renderTimer)},"_setTimer":function(){this.renderTimer&&clearTimeout(this.renderTimer),this.renderTimer=setTimeout(e.bind(function(){this._truncateIfNecessary()},this),200)},"onRender":function(){this._setTimer()},"_updateDescriptionAndCaret":function(){this._enableCaretState(),this.shortDescMode&&this.has_more_desc?this.$el.addClass("conws-description-collapsed"):this.$el.removeClass("conws-description-collapsed")},"_truncateIfNecessary":function(){if(this.ui.description&&"object"==typeof this.ui.description){var e,t=this.getActualHeight();t&&0!==t&&(t>l&&(l=t),this.$el.removeClass("description-height-threeline description-height-twoline"),this.expandDescription===!0?(this.$el.addClass("description-expanded-view"),e=this.getMaxHeight(),this.$el.addClass(l===e?"description-height-oneline":l>2*e?"description-height-threeline":"description-height-twoline")):(this.$el.removeClass("description-expanded-view"),e=this.getMaxHeight(),t>e&&(this.has_more_desc=!0),this._enableCaretState(),this.$el.addClass("description-height-oneline")))}},"getActualHeight":function(){return this.ui.description.height()},"getMaxHeight":function(){return parseFloat(this.ui.description.css("line-height"))},"readMoreClicked":function(e){if(e&&(13===e.keyCode||32===e.keyCode||"click"===e.type)){e.preventDefault(),e.stopPropagation(),this.shortDescMode=!1,this._truncateIfNecessary(),this.$el.removeClass("description-height-oneline");var t=this.getMaxHeight();this.$el.addClass(l>2*t?"description-height-threeline":"description-height-twoline"),this.ui.caretDiv.addClass(l>2*t?"description-height-threeline":"description-height-twoline"),this.ui.showLess.focus(),this.trigger("show:more:description")}},"showLessClicked":function(e){!e||13!==e.keyCode&&32!==e.keyCode&&"click"!==e.type||(e.preventDefault(),e.stopPropagation(),this.$el.find(".description").scrollTop(0),this.shortDescMode=!0,this._truncateIfNecessary(),this.$el.removeClass("description-height-threeline description-height-twoline"),this.ui.caretDiv.removeClass("description-height-threeline description-height-twoline"),this.ui.readMore.focus(),this.trigger("show:less:description"))},"_enableCaretState":function(){this.has_more_desc?(this.ui.readMore.toggleClass("caret-hide",this.shortDescMode?!1:!0),this.ui.showLess.toggleClass("caret-hide",this.shortDescMode?!0:!1)):(this.ui.readMore.addClass("caret-hide"),this.ui.showLess.addClass("caret-hide"))}});return c}),csui.define("hbs!conws/controls/lazyactions/impl/lazy.loading.template",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<li role="menuitem" class="csui-loading-parent-wrapper binf-disabled csui-disbaled">\r\n  <span class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </span>\r\n</li>'}});return i.registerPartial("conws_controls_lazyactions_impl_lazy.loading.template",s),s}),csui.define("conws/controls/lazyactions/lazyToolbar.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/utils/commands","csui/controls/toolbar/delayed.toolbar.view","csui/controls/toolbar/toolbar.command.controller","hbs!conws/controls/lazyactions/impl/lazy.loading.template"],function(e,t,i,s,o,n,a,r,l,c){var d=r.extend({"constructor":function(e){e=e||{};var t=e.node;if(!e.nodes){var i=new o(t);i.connector=t.connector,e.nodes=i}this.connector=e.connector||e.nodes.connector||t.connector,e.status||(e.status={"context":e.context,"nodes":e.nodes,"container":e.container,"originatingView":e.originatingView}),this.status=e.status,this.commandController=e.commandController||new l({"commands":e.commands||a}),e.collection||(e.collection=new n(e.toolbarItems,{"status":this.status,"commands":this.commandController.commands,"delayedActions":t.delayedActions,"mask":e.toolbarItemsMask})),this.collection=e.collection,r.prototype.constructor.apply(this,arguments),this.listenTo(this,"delayed:toolbar:refresh",this._refreshLazyToolbar),this.listenTo(this,"childview:toolitem:action",this._toolbarItemClicked)},"events":{"show.binf.dropdown":"onBeforeShowDropDown"},"onBeforeShowDropDown":function(){var e,i,n,a=[];this.lazyActionsRetrieved||(this.$el.find(".csui-more-dropdown-menu").append(c),e=this.status.nodes instanceof o?this.status.nodes:this.status.nodes instanceof s.Collection?new o(this.status.nodes.models):t.isArray(this.status.nodes)?new o(this.status.nodes):new o,e.connector||(e.connector=this.connector),e.each(function(e){i=i&&e.get("csuiLazyActionsRetrieved"),n=n&&e.isLocallyCreated,a=a.length?a:e.nonPromotedActionCommands}),e.nonPromotedActionCommands=a,e.lazyActionsRetrieved=i,i||n||!a.length||(e.lazyActionsRetrieved=this.lazyActionsRetrieved,this._renderLazyActions(e)),this.lazyActionsRetrieved=!0)},"_onDomRefresh":function(){},"_refreshLazyToolbar":function(){r.prototype._onDomRefresh.call(this)},"_toolbarItemClicked":function(e,t){this.commandController.toolitemClicked(t.toolItem,this.options)}});return d}),csui.define("conws/controls/selectedmetadataform/selectedmetadataform.view",["csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/utils/url","csui/controls/form/form.view","csui/controls/globalmessage/globalmessage"],function(e,t,i,s,o,n){function a(e,i){for(var s;i.length;){if(t(i).is(e))return s?">"+s:"";var o=i[0],n=o.localName;if(!n)break;n=n.toLowerCase();var a=i.parent(),r=a.children(),l=r.index(o)+1;n+=":nth-child("+l+")",s=n+(s?">"+s:""),i=a}return e?void 0:s}function r(e){var t,i=e.$el.find(":focus");if(i.length){for(var s=i;s&&s.length&&!s.attr("data-alpaca-field-id");)s=s.parent();s.length&&(t=a(e.$el,s))}var o=e.$el.parent().parent().scrollTop();return{"focused":i,"focusPath":t,"scrolltop":o}}function l(e,t){t.scrolltop>=0&&e.$el.parent().parent().scrollTop(t.scrolltop);var i=e.$el.find(":focus");if(!i.is(t.focused)&&t.focusPath){var s=e.$el.find(t.focusPath),o=s.find(".alpaca-control .cs-field-read button");o.click()}}function c(e,t){this.count=e,this.fct=t,this.callback=function(){this.count>0&&(this.count=this.count-1,0===this.count&&this.fct.call())}}function d(t,i){var s=new c(t,function(){setTimeout(i,0)});return e.bind(s.callback,s)}function p(t,i){var s;if(t.children&&t.children.length&&i&&i.length)if(i.length>t.children.length)for(s=t.children.length;s<i.length;s++){var o=i[s],n=e.extend({},t.children[0].options),a=e.extend({},t.children[0].schema);t.addItem(s,a,n,o,function(){})}else if(i.length<t.children.length)for(s=t.children.length-1;s>=i.length;s--)t.removeItem(s,function(){})}function u(e,t,i,s){for(var o=[],n=0;n<e.length;n++){var a=e[n];a.propertyId&&t.hasOwnProperty(a.propertyId)?(s?a.path===i:a.path!==i)&&o.push(a):a.children&&(o=o.concat(u(a.children,t,i,s)))}return o}function h(e,t,i,s,o){var n=u(e.form.children,i,s,o);if(n.length){var a=d(n.length,function(){l(e,t)});n.forEach(function(e){p(e,i[e.propertyId]),e.setValue(i[e.propertyId]),e.refresh(a)})}}var m=o.extend({"constructor":function(e){o.prototype.constructor.call(this,e),this.node=this.options.node,this.listenTo(this,"change:field",function(e){this._saveField(e)})},"_saveField":function(e){if(this._hasDependentFields(e))this._saveDependentFields(e.fieldView);else{var t=this.form.getControlByPath("/"===e.path[0]?e.path.substring(1):e.path);this._saveChanges(t.propertyId,e.value,t.path,!0)}},"_hasDependentFields":function(e){return"undefined"!=typeof e.fieldView&&"undefined"!=typeof e.fieldView.isTKLField&&e.fieldView.isTKLField&&e.fieldView.children.length>0?!0:!1},"_saveDependentFields":function(e){if(this._saveChanges(e.alpacaField.propertyId,e.getEditValue(),e.alpacaField.path,!1),e.children.length>0)for(var t=0;t<e.children.length;t++)this._saveDependentFields(e.children[t])},"_saveChanges":function(o,a,l,c){for(var d={},p={},u=this.getValues(),m="/"===l[0]?l.substring(1):l,g=m.split("/"),f=0;f<g.length-1;f++)u&&(u=u[g[f]]);if(u&&e.each(u,function(e,t){t===o&&(d[t]=e,p[t]=e)},p),o.search("x")>0){var w,v={};v[o]=p[o],delete p[o],delete d[o],w=o.substring(0,o.indexOf("x")-1),p[w]=[v],d[w]=[v]}if(!this.node)throw new Error("Missing node to save the categories to.");if(this._validate(d)){var b=r(this);return this._blockActions(),this.node.connector.makeAjaxCall(this.node.connector.extendAjaxOptions({"type":"PUT","url":s.combine(this.node.urlBase(),"categories",o.split("_")[0]),"data":p,"async":c})).done(e.bind(function(){this.model.updateData(d),h(this,b,d,l,!1),this.trigger("forms:sync");var e=t.Event("tab:content:field:changed");this.$el.trigger(e)},this)).fail(e.bind(function(e){var t=this.model.restoreData(d);h(this,b,t,l,!0);var s=new i.Error(e);n.showMessage("error",s.message),this.trigger("forms:error")},this)).always(e.bind(function(){this._unblockActions()},this))}return t.Deferred().reject().promise()}});return m}),csui.define("conws/utils/commands/permissions/permissions.util",["csui/utils/url"],function(e){var t={"getUrl":function(t){var i=t.nodeId,s=t.connector.connection.url.replace("/v1","/v2");if(s=e.combine(s,"businessworkspaces",i,"roles"),t.action){var o;if("delete"===t.action||"editperms"===t.action)o=t.get("right_id"),s=e.combine(s,o);else if("fetch"===t.action||"update"===t.action){o=t.get("right_id");var n=e.combineQueryString({"fields":"members"});s=e.combine(s,o),s=s+"?"+n}}return s},"isWorkspaceRole":function(e){var t,i=e.get("right_id_expand");return t=i?!!i.type&&848===i.type:!!e.get("type")&&848===e.get("type")},"isLeaderRole":function(e,t){var i,s=this.isInheritedRole(e,t),o=t.get("right_id_expand");return i=o?!s&&!!o.id&&!!o.leader_id&&o.id===o.leader_id:!s&&!!t.get("id")&&!!t.get("leader_id")&&t.get("id")===t.get("leader_id")},"isInheritedRole":function(e,t){var i,s=t.get("right_id_expand");return i=s?!!s.node_id&&!!e&&!!e.get("id")&&s.node_id!==e.get("id"):!!t.get("node_id")&&!!e&&!!e.get("id")&&t.get("node_id")!==e.get("id")},"isWorkspace":function(e){return!!e&&!!e.get("type")&&848===e.get("type")}};return t}),csui.define("hbs!conws/controls/table/cells/role/impl/role",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return" binf-disabled"},"3":function(e,t,i,s){var o;return null!=(o=t.unless.call(e,null!=e?e.addOwnerOrGroup:e,{"name":"unless","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?o:""},"4":function(e,t){var i;return'  <div class="'+this.escapeExpression((i=null!=(i=t.inlineToolBarPlaceholderClass||(null!=e?e.inlineToolBarPlaceholderClass:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"inlineToolBarPlaceholderClass","hash":{}}):i))+' binf-hidden"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="csui-user-container">\r\n  <div class="csui-profileimg binf-pull-left">\r\n    <span class="csui-icon-paceholder csui-icon conws-mime_roles" aria-label="'+this.escapeExpression((n=null!=(n=t.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaUserLabel","hash":{}}):n))+'"></span>\r\n  </div>\r\n  <div class="member-info csui-fadeout'+(null!=(o=t["if"].call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+' ">\r\n    <div class="">\r\n      <span class="csui-user-display-name csui-role" aria-label="'+this.escapeExpression((n=null!=(n=t.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaUserLabel","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n    </div>\r\n  </div>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.includeInlineToolBarPlaceholder:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+"</div>"}});return i.registerPartial("conws_controls_table_cells_role_impl_role",s),s}),csui.define("css!conws/controls/table/cells/role/impl/role",[],function(){}),csui.define("conws/controls/table/cells/role/role.view",["csui/lib/underscore","csui/controls/table/cells/user/user.view","csui/controls/table/cells/cell.registry","csui/models/member","conws/utils/commands/permissions/permissions.util","hbs!conws/controls/table/cells/role/impl/role","css!conws/controls/table/cells/role/impl/role"],function(e,t,i,s,o,n){var a=t.extend({"renderValue":function(){var e=this.getValueData(),t=this.getTemplate(),i=e?t(e):"";this.$el.html(i)},"getTemplate":function(){var e;return e=this.isWorkspaceRole&&this.isWorkspaceRole?n:this.template},"getValueData":function(){return e.extend(a.__super__.getValueData.apply(this,arguments),{"isWorkspaceRole":this.isWorkspaceRole})},"constructor":function r(){if(r.__super__.constructor.apply(this,arguments),this.model&&this.model.collection&&(this.isWorkspaceRole=o.isWorkspaceRole(this.model),this.model.collection.extraMemberModels||(this.model.collection.extraMemberModels=[]),this.isWorkspaceRole)){var e=this.model.collection.extraMemberModels.some(function(e){return e.get("id")===this.model.get("right_id_expand").id},this);if(!e){var t=new s(this.model.get("right_id_expand"));t.nodeModel=this.options.nodeModel,this.model.collection.extraMemberModels.push(t)}}}});return i.registerByColumnKey("right_id",a),a}),csui.define("conws/controls/table/cells/permission/role.permission.level.view",["csui/lib/jquery","csui/lib/underscore","csui/controls/table/cells/permission/permission.level.view","csui/utils/commands","csui/controls/table/cells/cell.registry","conws/utils/commands/permissions/permissions.util"],function(e,t,i,s,o,n){var a=i.extend({"constructor":function r(){r.__super__.constructor.apply(this,arguments),this.$=e},"onClickPermissionLevel":function(){var e,t=n.isWorkspaceRole(this.options.model),i=[0,1,848];i.indexOf(this.options.model.get("right_id_expand")&&this.options.model.get("right_id_expand").type)<0&&"custom"===this.options.model.get("type")?this._handlePermissionLevelFocus({"cellView":this}):(e=s.get(t?"EditRolePermission":"EditPermission"),this._handlePermissionLevelClicked({"cellView":this,"command":e}),this.trigger("cell:content:clicked",this))}});return o.registerByColumnKey("permissions",a),a}),csui.define("conws/controls/userpicker/nls/role.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/userpicker/nls/root/role.lang",{"roleViewGroupTitle":"Business Workspace Role","roleViewLeaderTitle":"Leader Role","inheritedrole":"Inherited Role"}),csui.define("hbs!conws/controls/userpicker/role",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o,n;return'<div class="member-info'+(null!=(o=t["if"].call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?o:"")+' binf-pull-left">\r\n  <span class="name binf-pull-left" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n</div>\r\n"},"2":function(){return" binf-disabled"},"4":function(e,t,i,s){var o,n;return'<div class="member-picture'+(null!=(o=t["if"].call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?o:"")+' binf-pull-left">\r\n  <span class="csui-icon conws-mime_roles"></span>\r\n</div>\r\n<div class="member-info'+(null!=(o=t["if"].call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?o:"")+' binf-pull-left">\r\n  <span class="name binf-pull-left" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n  <span class="group-title binf-pull-left" title="'+this.escapeExpression((n=null!=(n=t["role-title"]||(null!=e?e["role-title"]:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"role-title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t["role-title"]||(null!=e?e["role-title"]:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"role-title","hash":{}}):n))+"</span>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.isWorkspace:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?o:"")+"</div>\r\n"},"5":function(e,t,i,s){var o;return(null!=(o=t["if"].call(e,null!=e?e.leader:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.isInheritedRole:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")},"6":function(e,t){var i;return'  <span class="leader-title binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t["leader-title"]||(null!=e?e["leader-title"]:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"leader-title","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t["leader-title"]||(null!=e?e["leader-title"]:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"leader-title","hash":{}}):i))+"</span>\r\n"},"8":function(e,t){var i;return'  <span class="leader-title binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t["isInheritedRole-title"]||(null!=e?e["isInheritedRole-title"]:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"isInheritedRole-title","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t["isInheritedRole-title"]||(null!=e?e["isInheritedRole-title"]:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"isInheritedRole-title","hash":{}}):i))+"</span>\r\n"},"10":function(e,t){var i;return'  <span class="message binf-pull-left">'+this.escapeExpression((i=null!=(i=t["disabled-message"]||(null!=e?e["disabled-message"]:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"disabled-message","hash":{}}):i))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.lightWeight:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(4,s,0)}))?o:""}});return i.registerPartial("conws_controls_userpicker_role",s),s}),csui.define("conws/controls/userpicker/role.view",["csui/utils/base","csui/controls/userpicker/impl/group.view","conws/utils/commands/permissions/permissions.util","i18n!conws/controls/userpicker/nls/role.lang","hbs!conws/controls/userpicker/role"],function(e,t,i,s,o){var n=t.extend({"getTemplate":function(){var e;return e=this.isWorkspaceRole&&this.isWorkspaceRole?o:this.template},"templateHelpers":function(){return{"name":e.formatMemberName(this.model),"role-title":s.roleViewGroupTitle,"isWorkspace":this.isWorkspace,"leader":this.isLeaderRole,"leader-title":s.roleViewLeaderTitle,"isInheritedRole":this.isInheritedRole,"isInheritedRole-title":s.inheritedrole,"disabled":this.model.get("disabled"),"disabled-message":this.options.disabledMessage,"lightWeight":!!this.options.lightWeight}},"constructor":function(e){t.prototype.constructor.call(this,e),this.model&&this.model.nodeModel&&(this.isWorkspace=i.isWorkspace(this.model.nodeModel),this.isWorkspaceRole=i.isWorkspaceRole(this.model),this.isLeaderRole=i.isLeaderRole(this.model.nodeModel,this.model),this.isInheritedRole=i.isInheritedRole(this.model.nodeModel,this.model))}});return n}),csui.define("conws/dialogs/addoreditrole/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/dialogs/addoreditrole/impl/nls/root/lang",{"dialogTitle":"View role membership","missingConnector":"Missing connector information!","AddRole":"Add role","EditRole":"Edit role","doneButtonLabel":"Save","nextButtonLabel":"Next","cancelButtonLabel":"Cancel","RoleStepName":"Role","PermissionsStepName":"Permissions","ParticipantsStepName":"Participants","RoleName":"Role name","RoleNamePlaceholder":"Enter name","RoleDesc":"Role Description","RoleDescPlaceholder":"Add Description","TeamLead":"Team Lead","SubItemsInherit":"Apply to sub-items","backButtonTooltip":"Go back","backButtonAria":"Go back","selectPermissionLevel":"Select permission level","simplePermissionSelection":"Simple Permission Selection","rolePartcipantsWithNoparticipantsMessage":"No participants have been added.","participantsTitle":"Participants","addParticipantTitle":"Add Participant","roleParticipantsUserPickerPlaceholder":"Add participants","roleParticipantsDisabledMemberMessage":"Is already a participant.","roleParticipantsSearchAria":"Search for participants"}),csui.define("conws/controls/wizard/step/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/wizard/step/impl/footer.view"],function(e,t,i){var s=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":t}},"constructor":function(){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,t=this.model.attributes;"undefined"==typeof t.isButton?(e.text(t.label),e.addClass("binf-btn"),e.addClass(t["default"]?"binf-btn-primary cs-add-button":"binf-btn-default"),t.toolTip&&e.attr("title",t.toolTip),t.separate&&e.addClass("cs-separate")):(e.addClass("arrow_back button_image"),t.toolTip&&e.attr({"title":t.toolTip,"aria-label":t.toolTip,"role":"link"}),"next"===t.id&&e.addClass("button_image_next")),this.updateButton(t)},"updateButton":function(e){var t=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?t.addClass("binf-hidden"):t.removeClass("binf-hidden")),void 0!==e.disabled&&t.prop("disabled",e.disabled)}}),o=i.extend({"childView":s,"constructor":function(){i.prototype.constructor.apply(this,arguments)}});return o}),csui.define("conws/controls/wizard/step/wizard.step.view",["module","csui/lib/underscore","csui/lib/backbone","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/wizard/step/wizard.step.view","conws/controls/wizard/step/impl/footer.view","csui/utils/log","i18n!csui/controls/wizard/impl/nls/lang"],function(e,t,i,s,o,n,a,r){a=a(e.id);var l=o.extend({"constructor":function(){o.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.setViewInitialFocus)},"setViewInitialFocus":function(){this.options.view.trigger("set:initial:focus")},"_renderFooter":function(){var e=this.footerView=this.options.footerView;if(e)this.ui.footer.removeClass("binf-hidden"),this.footer.show(e);else{var s=[];this.options.isFirstStep||s.push({"id":"previous","label":this.options.previousButtonLabel||r.back,"toolTip":this.options.previousButtonLabel||r.back,"default":!1,"disabled":!1,"isButton":!1,"separate":this.options.seperatePrevious||!1,"click":t.bind(this.onClickPreviousButton,this)});var o={"id":"next","label":this.options.nextButtonLabel||r.next,"toolTip":this.options.nextButtonLabel||r.next,"default":!0,"disabled":void 0===this.options.disableNext?!0:this.options.disableNext,"separate":this.options.seperateNext||!1,"isButton":!1,"click":t.bind(this.onClickNextButton,this)},a={"id":"done","label":this.options.doneButtonLabel||r.done,"toolTip":this.options.doneButtonLabel||r.done,"default":!0,"disabled":void 0===this.options.disableDone?!0:this.options.disableDone,"separate":this.options.seperateDone||!0,"click":t.bind(this.onClickDoneButton,this)};this.options.nextButton&&this.options.doneButton?(s.push(o),s.push(a)):this.options.nextButton?s.push(o):this.options.doneButton&&s.push(a),s.push({"id":"cancel","label":r.cancel,"toolTip":r.cancel,"separate":this.options.seperateCancel||!0,"close":!0});var l=this.options.buttons||s;l.length&&this.ui.footer.removeClass("binf-hidden"),e=this.footerView=new n({"collection":new i.Collection(l),"wizardView":this,"el":this.ui.footer[0]}),this.listenTo(e,"childview:click",this.onClickButton),e.render(),this.footer.attachView(e)}}});return t.extend(l.prototype,s),l}),csui.define("css!conws/controls/wizard/impl/wizard",[],function(){}),csui.define("conws/controls/wizard/wizard.view",["csui/lib/underscore","csui/controls/wizard/wizard.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/controls/wizard/step/wizard.step.view","css!conws/controls/wizard/impl/wizard"],function(e,t,i,s){var o=t.extend({"constructor":function(e){e||(e={}),t.prototype.constructor.apply(this,arguments)
},"getCurrentView":function(){if(this.currentStep<this.stepViews.length)return this.stepViews[this.currentStep];var t=this.currentStep,i=new s(e.extend(this.options.steps[t],{"wizard":this,"isFirstStep":this.isFirstStep(),"isLastStep":this.isLastStep()}));return this.stepViews.push(i),this.listenTo(i,"next:clicked",this.nextStep).listenTo(i,"previous:clicked",this.prevStep).listenTo(i,"done:clicked",this.save).listenTo(i,"close:wizard",this.closeWizard),i},"showCurrentView":function(){this.currentView.$el.removeClass("binf-hidden"),this.currentView.triggerMethod("set:initial:focus")}});return e.extend(o.prototype,i),o}),csui.define("conws/dialogs/addoreditrole/impl/tabbable.form.view",["csui/lib/jquery","csui/controls/form/form.view","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,t,i){var s=t.extend({"behaviors":{"TabablesBehavior":{"behaviorClass":i,"recursiveNavigation":!0,"containTabFocus":!0}},"events":{"keydown":"onKeyInView"},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(){var t=!!this.$form&&this.$form.find(".alpaca-readonly button"),i=this.$("*[tabindex]:visible");return i.length&&(i.prop("tabindex",0),t.length&&t.attr("tabindex",-1)),this.tabableElements=i,e(i[0])},"onKeyInView":function(e){var t=this.tabableElements.length;if(t>0&&9===e.keyCode)if(e.shiftKey){var i=this.tabableElements.index(e.target),s=--i;s>=0&&this._setFocus(e,s)}else{var i=this.tabableElements.index(e.target),s=++i;t>s&&this._setFocus(e,s)}},"_setFocus":function(e,t){this.tabableElements.eq(t).focus(),e.stopPropagation(),e.preventDefault()}});return s}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="dashed-border"></div>\r\n<div class="conws-addoreditrole-wizardstep-header">\r\n    <span class="conws-addoreditrole-wizardstep1">'+this.escapeExpression((i=null!=(i=t.Step1||(null!=e?e.Step1:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"Step1","hash":{}}):i))+'</span>\r\n    <span class="conws-addoreditrole-wizardstep2">'+this.escapeExpression((i=null!=(i=t.Step2||(null!=e?e.Step2:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"Step2","hash":{}}):i))+'</span>\r\n    <span class="conws-addoreditrole-wizardstep3">'+this.escapeExpression((i=null!=(i=t.Step3||(null!=e?e.Step3:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"Step3","hash":{}}):i))+"</span>\r\n</div>"}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleheader_impl_roleheader.view",s),s}),csui.define("css!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleheader/roleheader.view",["csui/lib/underscore","csui/lib/marionette","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view","css!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view"],function(e,t,i,s){var o=t.LayoutView.extend({"template":s,"regions":{"StepHeaderRegion":".conws-addoreditrole-wizardstep-header"},"templateHelpers":{"Step1":i.RoleStepName,"Step2":i.PermissionsStepName,"Step3":i.ParticipantsStepName},"constructor":function(i){i||(i={}),this.context=i.context,this.connector=i.connector,i.currentStep&&(this.listenTo(this,"render",this._updateClasses),e.bind(this._updateClasses,i)),t.LayoutView.prototype.constructor.apply(this,arguments)},"_updateClasses":function(e){switch(e.options.currentStep){case"step1":this.$el.find(".conws-addoreditrole-wizardstep1").addClass("conws-addoreditrole-wizardstep-header-active");break;case"step2":this.$el.find(".conws-addoreditrole-wizardstep2").addClass("conws-addoreditrole-wizardstep-header-active");break;case"step3":this.$el.find(".conws-addoreditrole-wizardstep3").addClass("conws-addoreditrole-wizardstep-header-active")}}});return o}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="conws-addoreditrole-roledetails">\r\n    <div class="conws-addoreditrole-roledetails-header">\r\n    </div>\r\n    <div class="conws-addoreditrole-roledetails-body">\r\n        <div class="conws-addoreditrole-roledetails-left">\r\n        </div>\r\n        <div class="conws-addoreditrole-roledetails-right">\r\n        </div>\r\n    </div>\r\n</div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roledetails_impl_roledetails",s),s}),csui.define("css!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roledetails/roledetails.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/form","conws/dialogs/addoreditrole/impl/tabbable.form.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/dialogs/addoreditrole/impl/roleheader/roleheader.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails","css!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails"],function(e,t,i,s,o,n,a,r,l,c){var d=i.LayoutView.extend({"template":c,"regions":{"HeaderRegion":".conws-addoreditrole-roledetails-header","LeftRegion":".conws-addoreditrole-roledetails-left","RightRegion":".conws-addoreditrole-roledetails-right"},"templateHelpers":{},"triggers":{"keyup input":{"event":"required:field:changed","preventDefault":!1,"stopPropagation":!1}},"_createHeaderControl":function(){var e=new a({"headerViewoptions":this.options,"currentStep":"step1"});return e},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.onSetInitialFocus),this.propagateEventsToRegions()},"onRender":function(){var e={"data":{"role_name":this.options.addrole?"":this.options.name,"role_description":this.options.addrole?"":this.options.description},"options":{"fields":{"role_name":{"hidden":!1,"hideInitValidationError":!0,"label":l.RoleName,"placeholder":l.RoleNamePlaceholder,"readonly":!1,"type":"text"},"role_description":{"hidden":!1,"hideInitValidationError":!0,"label":l.RoleDesc,"placeholder":l.RoleDescPlaceholder,"readonly":!1,"type":"textarea"}},"label":""},"schema":{"properties":{"role_name":{"maxLength":42,"readonly":!1,"required":!0,"title":l.RoleName,"type":"string"},"role_description":{"readonly":!1,"required":!1,"title":l.RoleDesc,"type":"string","maxLength":450}},"type":"object"}},t=this.options.addrole?this.options.isFirstRole?!0:!1:this.options.team_lead,i={"data":{"team_lead":t},"options":{"fields":{"team_lead":{"hidden":!1,"hideInitValidationError":!0,"label":l.TeamLead,"readonly":t?!0:!1,"type":"checkbox"}},"label":""},"schema":{"properties":{"team_lead":{"readonly":t?!0:!1,"required":!1,"title":l.TeamLead,"type":"boolean"}},"type":"object"}},n=new o({"mode":"create","model":new s(e)}),a=new o({"mode":"create","model":new s(i)});this.HeaderRegion.show(this._createHeaderControl()),this.LeftRegion.show(n),this.RightRegion.show(a)},"onAfterShow":function(){this.onSetInitialFocus()},"onSetInitialFocus":function(){this.LeftRegion.currentView.$el.find("[data-alpaca-container-item-name='role_name'] input[type='text']").focus()}});return e.extend(d.prototype,n),d}),csui.define("conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions.title.view",["csui/lib/handlebars","csui/lib/marionette"],function(e,t){return TitleView=t.ItemView.extend({"template":e.compile("{{title}}"),"templateHelpers":function(){return{"title":this.model.get("title")}},"constructor":function(){t.View.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}})}),csui.define("hbs!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="conws-addoreditrole-rolepermissions">\r\n    <div class="conws-addoreditrole-rolepermissions-header"></div>\r\n    <div class="conws-addoreditrole-rolepermissions-picker-header">\r\n        <div class="conws-addoreditrole-rolepermissions-left">\r\n            <div class="conws-addoreditrole-rolepermissions-back"></div>\r\n            <div class="conws-addoreditrole-rolepermissions-title"></div>\r\n        </div>\r\n        <div class="conws-addoreditrole-rolepermissions-right">\r\n        </div>\r\n    </div>\r\n    <div class="conws-addoreditrole-rolepermissions-picker"></div>\r\n</div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_rolepermissions_impl_rolepermissions",s),s}),csui.define("css!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/rolepermissions/rolepermissions.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/models/form","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/dialogs/addoreditrole/impl/tabbable.form.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view","csui/models/permission/nodepermission.model","conws/dialogs/addoreditrole/impl/roleheader/roleheader.view","conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions.title.view","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions","css!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions","i18n"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g){var f=s.ItemView.extend({"template":!1,"tagName":"div","className":"conws-addoreditrole-rolepermissions-backbtn icon circular arrow_back cs-go-back binf-hidden","attributes":{"title":h.backButtonTooltip,"aria-label":h.backButtonAria,"role":"link"},"constructor":function(){s.View.prototype.constructor.apply(this,arguments)},"behaviors":{"TabableRegion":{"behaviorClass":n}},"currentlyFocusedElement":function(){return this.$el}}),w=s.LayoutView.extend({"template":m,"regions":{"HeaderRegion":".conws-addoreditrole-rolepermissions-header","PickerRegion":".conws-addoreditrole-rolepermissions-picker","TitleRegion":".conws-addoreditrole-rolepermissions-title","RightRegion":".conws-addoreditrole-rolepermissions-right","BackButtonRegion":".conws-addoreditrole-rolepermissions-back"},"templateHelpers":{"title":h.selectPermissionLevel,"backButtonTooltip":h.backButtonTooltip,"backButtonAria":h.backButtonAria},"events":{"click .conws-addoreditrole-rolepermissions-back":"onBackSelection","keydown .conws-addoreditrole-rolepermissions-back":"onBackKeySelection"},"_createHeaderControl":function(){var e=new p({"headerViewoptions":this.options,"currentStep":"step2"});return e},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,s.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.onSetInitialFocus),this.propagateEventsToRegions()},"onRender":function(){var e={"data":{"subitems_inherit":!0},"options":{"fields":{"subitems_inherit":{"hidden":!1,"hideInitValidationError":!0,"label":h.SubItemsInherit,"readonly":!1,"type":"checkbox"}},"label":""},"schema":{"properties":{"subitems_inherit":{"readonly":!1,"required":!1,"title":h.SubItemsInherit,"type":"boolean"}},"type":"object"}},t=new l({"selected":this.options.addrole?1:this.options.model.getPermissionLevel(),"isContainer":this.options.isContainer,"nodeModel":this.options.nodeModel,"permissionModel":this.options.model}),s=new a({"model":new o(e),"mode":"create"});this.titleView=new u({"model":new i.Model({"title":h.selectPermissionLevel})}),this.options.addrole||(this.lastSelectedPermLevel=this.options.model.getPermissionLevel(),this.options.model.getPermissionLevel()===d.PERMISSION_LEVEL_CUSTOM&&(this.lastSelectedCustomPermissions=this.options.model.get("permissions"))),t.on("permission:level:selected",this.onPermissionLevelSelection,this),this.HeaderRegion.show(this._createHeaderControl()),this.PickerRegion.show(t),this.RightRegion.show(s),this.TitleRegion.show(this.titleView),this.BackButtonRegion.show(new f)},"onPermissionLevelSelection":function(){var e=this.PickerRegion.currentView;if(e&&e.selected===d.PERMISSION_LEVEL_CUSTOM){var i=new c({"permissions":this.lastSelectedCustomPermissions?this.lastSelectedCustomPermissions:[],"readonly":!1,"showButtons":!1,"node":this.options.nodeModel});this.titleView.model.set("title",h.simplePermissionSelection),this.$el.find(".conws-addoreditrole-rolepermissions-backbtn").removeClass("binf-hidden").focus(),this.BackButtonRegion.currentView.trigger("dom:refresh"),this.PickerRegion.show(i),this.isCustom=!0;for(var s,o,n,a=i.$el.find(".csui-permission-attribute-tree"),r=a.find(".csui-tree-split"),l=r.length-1,p=0;p<r.length;l--,p++)o=t(r[l]).width()*p,n=t(r[l]).closest(".csui-tree-child").find(".csui-separator"),r[l]===r[r.length-1]?s=a.outerHeight():(s=Math.round(t(r[l]).closest("li").position().top+t(r[l]).closest(".csui-tree-child").outerHeight()),o+=p),g&&g.settings.rtl?(t(r[l]).css({"height":s,"left":o}),n.css({"width":a.find(".csui-tree-container").width(),"left":o}),t(r[l]).closest(".csui-tree-child").css({"padding-left":o+t(r[l]).width()})):(t(r[l]).css({"height":s,"right":o}),n.css({"width":a.find(".csui-tree-container").width(),"right":o}),t(r[l]).closest(".csui-tree-child").css({"padding-right":o+t(r[l]).width()}))}else this.lastSelectedPermLevel=e.selected},"onBackSelection":function(){this.lastSelectedCustomPermissions=this.PickerRegion.currentView.getSelectedPermissions(),this.titleView.model.set("title",h.selectPermissionLevel),this.$el.find(".conws-addoreditrole-rolepermissions-backbtn").addClass("binf-hidden"),this.BackButtonRegion.currentView.trigger("dom:refresh");var e=new l({"selected":this.lastSelectedPermLevel?this.lastSelectedPermLevel:1,"isContainer":this.options.isContainer,"nodeModel":this.options.nodeModel});this.PickerRegion.show(e),e.on("permission:level:selected",this.onPermissionLevelSelection,this),this.PickerRegion.currentView.$el.find("li[data-optionid='"+d.PERMISSION_LEVEL_NONE+"'] a").focus()},"onBackKeySelection":function(e){13===e.keyCode&&this.onBackSelection()},"onAfterShow":function(){this.onSetInitialFocus()},"onSetInitialFocus":function(){this.RightRegion.currentView.$el.find("[data-alpaca-container-item-name='subitems_inherit'] input[type='checkbox']").focus()}});return e.extend(w.prototype,r),w}),csui.define("hbs!conws/widgets/team/impl/controls/avatar/impl/avatar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="participant-picture">\r\n  <span class="csui-icon binf-img-circle" aria-label="'+this.escapeExpression((i=null!=(i=t.display_name||(null!=e?e.display_name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"display_name","hash":{}}):i))+'"/>\r\n  <img class="csui-icon binf-img-circle" alt="'+this.escapeExpression((i=null!=(i=t.display_name||(null!=e?e.display_name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"display_name","hash":{}}):i))+'">\r\n</div>'}});return i.registerPartial("conws_widgets_team_impl_controls_avatar_impl_avatar",s),s}),csui.define("css!conws/widgets/team/impl/controls/avatar/impl/avatar",[],function(){}),csui.define("conws/widgets/team/impl/controls/avatar/avatar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/url","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/avatar/impl/avatar","css!conws/widgets/team/impl/controls/avatar/impl/avatar"],function(e,t,i,s,o,n){var a=i.LayoutView.extend({"template":n,"templateHelpers":function(){return{"type":this.model.getMemberType()}},"ui":{"profileImage":".participant-picture > img","profileImageDefault":".participant-picture > span"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments)},"onRender":function(){this._displayProfileImage()},"_displayProfileImage":function(){var t=this._getUserPhotoUrl();if(this.ui.profileImage.addClass("esoc-userprofile-img-"+this.model.get("id")),t){var i=this.model.connector.extendAjaxOptions({"url":t,"dataType":"binary"});this._releasePhotoUrl(),this.model.connector.makeAjaxCall(i).always(e.bind(function(e,t,i){200===i.status?(this.photoUrl=URL.createObjectURL(e),this.ui.profileImage.attr("src",this.photoUrl),this.ui.profileImageDefault.remove()):(this.ui.profileImage.remove(),this.ui.profileImageDefault.addClass(this._getPlaceholderImageClass()))},this))}else this.ui.profileImage.remove(),this.ui.profileImageDefault.addClass(this._getPlaceholderImageClass())},"_getUserPhotoUrl":function(){var t=this.model.connector.connection,i=new s(t.url).getCgiScript(),o=this.model.get("id"),n=this.model.get("photo_id");if(n){var a=e.str.sformat("api/v1/members/{0}/photo?v={1}",o,n);return s.combine(i,a)}},"_getPlaceholderImageClass":function(){return"user"===this.model.getMemberType()?"conws-avatar-user-placeholder":"group"===this.model.getMemberType()?"conws-avatar-group-placeholder":"conws-avatar-role-placeholder"},"_releasePhotoUrl":function(){this.photoUrl&&URL.revokeObjectURL(this.photoUrl)}});return a}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="participant-content binf-pull-left"></div>\r\n<div class="participant-delete binf-pull-right"></div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_participant.listitem",s),s}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.details",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="participant-picture binf-pull-left"></div>\r\n<div class="participant-info binf-pull-left">\r\n  <span class="name binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'</span>\r\n  <span class="email binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t.email||(null!=e?e.email:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"email","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.email||(null!=e?e.email:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"email","hash":{}}):i))+'</span>\r\n  <span class="title binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'</span>\r\n  <span class="department binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t.department||(null!=e?e.department:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"department","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.department||(null!=e?e.department:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"department","hash":{}}):i))+'</span>\r\n  <span class="office binf-pull-left" title="'+this.escapeExpression((i=null!=(i=t.office||(null!=e?e.office:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"office","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.office||(null!=e?e.office:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"office","hash":{}}):i))+"</span>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem.details",s),s}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.delete",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<span class="remove csui-icon conws-icon-cross" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.removeParticipant||(null!=e?e.removeParticipant:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"removeParticipant","hash":{}}):i))+'"\r\n    aria-label="'+this.escapeExpression((i=null!=(i=t.removeParticipantAria||(null!=e?e.removeParticipantAria:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"removeParticipantAria","hash":{}}):i))+'"></span>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_participant.listitem.delete",s),s}),csui.define("css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/utils/contexts/factories/user","esoc/widgets/userwidget/userwidget","conws/widgets/team/impl/controls/avatar/avatar.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.details","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.delete","css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem"],function(e,t,i,s,o,n,a,r,l,c,d,p){var u=i.ItemView.extend({"template":d,"templateHelpers":function(){return{"type":this.model.getMemberType(),"name":this.model.displayName(),"email":this.model.displayEmail(),"title":this.model.displayTitle(),"department":this.model.displayDepartment(),"office":this.model.displayOffice()}},"ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.avatar=new r({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.context.getModel(n),t={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.context,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id"),"placeholder":this.$el.find(".participant-picture"),"showUserWidgetFor":"profilepic"};a.getUser(t)}else this.$(".participant-picture").append(this.avatar.render().$el)}}),h=i.ItemView.extend({"template":p,"templateHelpers":function(){return{"removeParticipant":l.addParticipantsRemove,"removeParticipantAria":e.str.sformat(l.removeParticipantAria,this.model.displayName())}},"events":{"click .remove":"onRemoveOnClick","keydown .remove":"onRemoveOnKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":s}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"onRemoveOnClick":function(e){e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model)},"onRemoveOnKeyDown":function(e){(13===e.keyCode||32===e.keyCode||46===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model))},"currentlyFocusedElement":function(){return this.$(".remove")}}),m=i.LayoutView.extend({"template":c,"tagName":"li","className":"binf-list-group-item conws-participant","regions":{"content":".participant-content","delete":".participant-delete"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"remove",this.onParticipantRemove),this.propagateEventsToRegions()},"onRender":function(){this.content.show(new u({"model":this.model})),this.delete.show(new h({"model":this.model}))},"onParticipantRemove":function(){this._parent.selectedIndex=this._index}});return e.extend(m.prototype,o),m}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-addoreditrole-emptyroleparticipants">\r\n    <div class="conws-addoreditrole-emptyroleparticipants conws-empty_team"></div>\r\n    <div class="conws-addoreditrole-emptyroleparticipants-msg">\r\n        <p>'+this.escapeExpression((i=null!=(i=t.message||(null!=e?e.message:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"message","hash":{}}):i))+"</p>\r\n    </div>\r\n</div>"}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_empty.roleparticipants",s),s}),csui.define("css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants.view",["csui/lib/underscore","csui/lib/marionette","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants","css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants"],function(e,t,i,s){var o=t.LayoutView.extend({"template":s,"templateHelpers":{"message":i.rolePartcipantsWithNoparticipantsMessage},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,t.LayoutView.prototype.constructor.apply(this,arguments)}});return o}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-addoreditrole-roleparticipants">\r\n  <div class="conws-addoreditrole-roleparticipants-header"></div>\r\n  <div class="conws-addoreditrole-roleparticipants-body">\r\n    <div class="conws-addoreditrole-roleparticipants-left">\r\n      <div class="conws-addoreditrole-roleparticipants-userpicker-title">\r\n        '+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'\r\n      </div>\r\n    </div>\r\n    <div class="conws-addoreditrole-roleparticipants-right">\r\n      <div class="conws-addoreditrole-roleparticipants-search">\r\n        <div class="conws-addoreditrole-roleparticipants-userpicker">\r\n          <!-- user picker region -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="conws-addoreditrole-roleparticipants-members-body">\r\n    <div class="conws-addoreditrole-roleparticipants-members">\r\n    </div>\r\n  </div>\r\n</div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_roleparticipants",s),s}),csui.define("css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleparticipants/roleparticipants.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/tile/behaviors/perfect.scrolling.behavior","conws/widgets/team/impl/participant.model","conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.view","conws/dialogs/addoreditrole/impl/roleheader/roleheader.view","conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants.view","csui/controls/userpicker/userpicker.view","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants","css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants"],function(e,t,i,s,o,n,a,r,l,c,d,p,u){var h=i.CollectionView.extend({"tagName":"ul","className":"binf-list-group","childView":r,"constructor":function(e){i.CollectionView.call(this,e)},"onRemoveChild":function(e){this.moveTabIndex(e)},"moveTabIndex":function(){var e=this.children&&this.children.length;if(e){var t=this.selectedIndex;t===e&&(t-=1);var i=this.children.findByModel(this.collection.at(t));i&&i.$el.find(".participant-delete .conws-icon-cross").focus()}}}),m=i.LayoutView.extend({"template":u,"regions":{"HeaderRegion":".conws-addoreditrole-roleparticipants-header","userPickerRegion":".conws-addoreditrole-roleparticipants-userpicker","participantsRegion":".conws-addoreditrole-roleparticipants-members"},"behaviors":{"PerfectScrolling":{"behaviorClass":n,"contentParent":".conws-addoreditrole-roleparticipants-members","suppressScrollX":!0}},"templateHelpers":{"title":p.participantsTitle},"_createHeaderControl":function(){var e=new l({"headerViewoptions":this.options,"currentStep":"step3"});return e},"_createEmptyRoleParticipantsView":function(){var e=new c({"options":this.options});return e},"_createParticipantsListCollectionView":function(){var i=new h({"context":this.context,"collection":e.extend(new t.Collection,{"context":this.context,"node":this.options.nodeModel,"comparator":function(e,t){return s.localeCompareString(e.get("display_name"),t.get("display_name"))}})});return i},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.onSetInitialFocus),this.propagateEventsToRegions()},"onRender":function(){var t=new d({"context":this.context,"limit":20,"clearOnSelect":!0,"placeholder":p.roleParticipantsUserPickerPlaceholder,"disabledMessage":p.roleParticipantsDisabledMemberMessage,"onRetrieveMembers":e.bind(this.retrieveMembersCallback,this),"prettyScrolling":!0,"initialActivationWeight":100});this.HeaderRegion.show(this._createHeaderControl()),this.userPickerRegion.show(t),t.$(".cs-search-icon").attr("aria-label",p.roleParticipantsSearchAria),this.listenTo(t,"item:change",this.onUserItemChanged);var i=this._createParticipantsListCollectionView();!this.options.addrole&&this.options.model&&e.each(this.options.model.get("members"),function(e){var t=new a(e,{"connector":this.connector,"collection":this.participants});i.collection.add(t)},this),this.participants=i.collection,this.participantView=i,this.listenTo(this.participants,"reset add change",this.onParticipantsChanged),this.listenTo(this.participants,"remove",this.onParticipantsRemove),0===i.collection.length?this.participantsRegion.show(this._createEmptyRoleParticipantsView()):(this.participantsRegion.show(i),this.participantsRegion.$el.addClass("conws-addoreditrole-roleparticipants-members-exist"))},"onAfterShow":function(){e.each(this.participantView.children._views,function(e){e.delete&&e.delete.currentView&&e.delete.currentView.trigger("dom:refresh")},this),this.onSetInitialFocus()},"onSetInitialFocus":function(){this.userPickerRegion.currentView.$el.find("[class='csui-control-userpicker'] input[type='text']").focus()},"onUserItemChanged":function(t){if(!t.item.get("disabled")){var i=e.extend(t.item.attributes,{"display_name":t.item.get("name_formatted")}),s=new a(i,{"connector":this.connector,"collection":this.participants});if(0===this.participants.length){this.participantsRegion.$el.addClass("conws-addoreditrole-roleparticipants-members-exist");
var o=this._createParticipantsListCollectionView();o.collection=this.participants,o.collection.add(s),this.participantsRegion.show(o),this.listenTo(o.collection,"reset add change",this.onParticipantsChanged),this.listenTo(o.collection,"remove",this.onParticipantsRemove),this.trigger("update:scrollbar")}else this.participants.add(s)}},"retrieveMembersCallback":function(e){var t=this;e.collection.each(function(e){var i=!1;t.participants.findWhere({"id":e.get("id")})&&(i=!0),e.set("disabled",i)})},"onParticipantsRemove":function(){this.onParticipantsChanged(),this.participants&&0===this.participants.length&&(this.userPickerRegion.currentView.currentlyFocusedElement().focus(),this.participantsRegion.$el.removeClass("conws-addoreditrole-roleparticipants-members-exist"),this.participantsRegion.show(this._createEmptyRoleParticipantsView()))},"onParticipantsChanged":function(){this.trigger("update:scrollbar")}});return e.extend(m.prototype,o),m}),csui.define("conws/dialogs/addoreditrole/addoreditrole.wizard",["csui/lib/underscore","csui/lib/jquery","csui/utils/contexts/factories/connector","i18n!conws/dialogs/addoreditrole/impl/nls/lang","csui/utils/log","csui/controls/progressblocker/blocker","csui/models/permission/nodepermission.model","conws/controls/wizard/wizard.view","conws/dialogs/addoreditrole/impl/roledetails/roledetails.view","conws/dialogs/addoreditrole/impl/rolepermissions/rolepermissions.view","conws/dialogs/addoreditrole/impl/roleparticipants/roleparticipants.view"],function(e,t,i,s,o,n,a,r,l,c,d){function p(t){if(t||(t={}),this.options=e.defaults(t,u),this.options.connector||(this.options.connector=this._getConnector(this.options)),!this.options.connector){var i=s.missingConnector;throw o.error(i)&&console.error(i),new Error(i)}}var u={"initialSelection":[],"dialogTitle":s.dialogTitle};return e.extend(p.prototype,{"show":function(){return this._showWizard(),this._deferred=t.Deferred(),this._deferred.promise()},"_showWizard":function(){this._steps=this._createWizardSteps(),this._wizard=new r({"steps":this._steps}),n.imbue(this._wizard),this._wizard.show(this._wizard.options),this._wizard.on("save:result",this.onClickFinishButton,this),this._wizard.on("closing:wizard",this.onClickCancelButton,this)},"_RoleDetailsView":function(){var e=new l({"addrole":this.options.addrole,"teamLead":!0,"isFirstRole":this.options.isFirstRole});return!this.options.addrole&&this.options.model&&this.options.model.get("right_id_expand")&&(e.options.name=this.options.model.get("right_id_expand").name,e.options.description=this.options.model.get("right_id_expand").description,e.options.team_lead=this.options.model.get("right_id_expand").team_lead),e.on("required:field:changed",function(){var t=e.LeftRegion.currentView.$el.find("div[data-alpaca-container-item-name='role_name']").find("input[type='text']").val().length;t?(this._wizard.currentView.updateButton("next",{"disabled":!1}),this._wizard.currentView.updateButton("done",{"disabled":!1})):(this._wizard.currentView.updateButton("next",{"disabled":!0}),this._wizard.currentView.updateButton("done",{"disabled":!0}))},this),e},"_RolePermissionsView":function(){var e=new c({"addrole":this.options.addrole,"model":this.options.model,"isContainer":this.options.nodeModel?this.options.nodeModel.get("container"):!0,"nodeModel":this.options.nodeModel});return e},"_RoleParticipantsView":function(){var e=new d(this.options);return e},"dialogClassName":function(){var e="target-browse";return this.options&&this.options.userClassName&&(e=e+" "+this.options.userClassName),e},"_createWizardSteps":function(){var t,i,o,n=this.options,a="rolePickerHeader",r=e.uniqueId("permissionLevel");return t={"title":n.dialogTitle,"view":this._RoleDetailsView(),"className":this.dialogClassName()+" csui-permissions-level conws-addoreditrole-dialog","nextButton":!0,"disableNext":this.options.addrole?!0:!1,"doneButtonLabel":s.doneButtonLabel,"disableDone":this.options.addrole?!0:!1,"doneButton":!0,"largeSize":!0,"attributes":{"aria-labelledby":a}},i={"title":n.dialogTitle,"nextButtonLabel":s.nextButtonLabel,"nextButton":!0,"disableNext":!1,"doneButtonLabel":s.doneButtonLabel,"disableDone":!1,"doneButton":!0,"largeSize":!0,"view":this._RolePermissionsView(),"className":this.dialogClassName()+" csui-permissions-level conws-addoreditrole-dialog","attributes":{"aria-labelledby":a,"aria-describedby":r}},o={"title":n.dialogTitle,"doneButtonLabel":s.doneButtonLabel,"disableDone":!1,"doneButton":!0,"largeSize":!0,"view":this._RoleParticipantsView(),"className":this.dialogClassName()+" csui-permissions-level conws-addoreditrole-dialog","attributes":{"aria-labelledby":a}},[t,i,o]},"onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._result):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0}))},"onClickCancelButton":function(){this.onHideDialog()},"onClickFinishButton":function(){var t,i,s,o,n,r,l;if(this){var c=this.getRoleDetailsView(),d=this.getPermissionsView();c.LeftRegion&&c.LeftRegion.currentView&&(t=c.LeftRegion.currentView.getValues().role_name,i=c.LeftRegion.currentView.getValues().role_description),s=c.RightRegion&&c.RightRegion.currentView&&c.RightRegion.currentView.getValues().team_lead,d.PickerRegion&&d.PickerRegion.currentView&&(o=d.PickerRegion.currentView.getSelectedPermissions(),null===o&&d.lastSelectedPermLevel&&d.lastSelectedPermLevel===a.PERMISSION_LEVEL_CUSTOM&&(o=d.lastSelectedCustomPermissions),r=this.options.nodeModel&&this.options.nodeModel.get("container")?!0:!1,d.RightRegion&&d.RightRegion.currentView&&(n=0,r&&(n=d.RightRegion.currentView.getValues().subitems_inherit?2:0))),this.getParticipantsView().participants&&(l=[],e.each(this.getParticipantsView().participants.models,function(e){l.push(e.get("id"))})),this._result={"role_name":t,"role_description":i,"team_lead":s,"permissions":o,"apply_to":n,"participants":l},this._wizard.destroy(),this.onHideDialog()}else this._wizard.currentView.updateButton("next",{"disabled":!0})},"_getConnector":function(t){var s;if(t.context)s=t.context.getObject(i);else if(t.initialSelection||t.initialContainer){var o=t.initialSelection,n=o?e.isArray(o)?o:o.models:void 0,a=t.initialContainer||n[0];s=a&&a.connector}return s},"getRoleDetailsView":function(){return this._steps[0].view},"getPermissionsView":function(){return this._steps[1].view},"getParticipantsView":function(){return this._steps[2].view}}),p}),csui.define("conws/dialogs/applyrolepermissions/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/dialogs/applyrolepermissions/impl/nls/root/lang",{"applyRolePermissionHeaderTitle":"Apply permissions","deleteRolePermissionHeaderTitle":"Delete {0}","removeRolePermissionHeaderTitle":"Remove {0}","SubItemsInherit":"Apply to sub-items","applyToItem":"Permissions will be applied to all items in {0}.","deleteToItem":"{0} will be deleted and permissions will be removed from all items in {1}","removeToItem":"Permissions will be removed from all items in {0}"}),csui.define("hbs!conws/dialogs/applyrolepermissions/impl/apply.role.permissions",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="conws-apply-role-permission-content">\r\n  <span class="conws-apply-role-permission-message"></span>\r\n</div>\r\n<div class="conws-apply-role-permission-switch">\r\n</div>'}});return i.registerPartial("conws_dialogs_applyrolepermissions_impl_apply.role.permissions",s),s}),csui.define("css!conws/dialogs/applyrolepermissions/impl/apply.role.permissions",[],function(){}),csui.define("conws/dialogs/applyrolepermissions/apply.role.permissions.view",["csui/lib/underscore","csui/lib/marionette","csui/models/form","conws/dialogs/addoreditrole/impl/tabbable.form.view","i18n!conws/dialogs/applyrolepermissions/impl/nls/lang","hbs!conws/dialogs/applyrolepermissions/impl/apply.role.permissions","css!conws/dialogs/applyrolepermissions/impl/apply.role.permissions"],function(e,t,i,s,o,n){return ApplyRolePermissionsView=t.LayoutView.extend({"template":n,"ui":{"applyRolePermissionMsg":".conws-apply-role-permission-message"},"regions":{"ContentRegion":".conws-apply-role-permission-switch"},"templateHelpers":function(){return{"title":this.model.get("title")}},"constructor":function(){t.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"onRender":function(){var t="";if(this.options.removePermission)if(this.options.permissionModel&&void 0!==this.options.permissionModel.isRoleDelete&&!this.options.permissionModel.isRoleDelete)t=e.str.sformat(o.removeToItem,this.options.model.get("name"));else{var n=this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted;t=e.str.sformat(o.deleteToItem,n,this.options.model.get("name"))}else t=e.str.sformat(o.applyToItem,this.options.model.get("name"));this.ui.applyRolePermissionMsg.html(t);var a={"data":{"subitems_inherit":!0},"options":{"fields":{"subitems_inherit":{"hidden":!1,"hideInitValidationError":!0,"label":o.SubItemsInherit,"readonly":!1,"type":"checkbox"}},"label":""},"schema":{"properties":{"subitems_inherit":{"readonly":!1,"required":!1,"title":o.SubItemsInherit,"type":"boolean"}},"type":"object"}},r=new s({"model":new i(a),"mode":"create"});this.options.removePermission?this.options.permissionModel&&void 0!==this.options.permissionModel.isRoleDelete&&!this.options.permissionModel.isRoleDelete&&this.ContentRegion.show(r):this.ContentRegion.show(r)}})}),csui.define("conws/dialogs/applyrolepermissions/impl/header/apply.role.permissions.header.view",["csui/lib/underscore","csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view","i18n!conws/dialogs/applyrolepermissions/impl/nls/lang"],function(e,t,i){var s=t.extend({"templateHelpers":function(){var t="";if(this.options.removePermission&&this.options.permissionModel){var s=this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted;t=this.options.permissionModel.isRoleDelete?e.str.sformat(i.deleteRolePermissionHeaderTitle,s):e.str.sformat(i.removeRolePermissionHeaderTitle,s)}else t=i.applyRolePermissionHeaderTitle;return{"title":t}},"constructor":function(e){e||(e={}),t.prototype.constructor.apply(this,arguments)}});return s}),csui.define("conws/utils/commands/nls/commands.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/utils/commands/nls/root/commands.lang",{"CommandNameEmail":"Send e-mail","CommandNameExport":"Download","CommandNameAddParticipant":"Add participants","CommandNameExportParticipants":"Download list of participants","CommandNamePrintParticipants":"Print list of participants","CommandNameShowRoles":"Show roles","CommandNameRemoveParticipant":"Remove from team","CommandNameAddRole":"Add role","CommandNameEditRole":"Edit role","CommandNamePrintRoles":"Print list of roles","CommandNameExportRoles":"Download list of roles","CommandNameShowDetails":"Show details","CommandNameDeleteRole":"Delete","CommandNameAddConnectedWorkspace":"Add business workspace","RemoveParticipantTitleSingle":"Remove participant","RemoveParticipantTitleMultiple":"Remove participants","RemoveParticipantMessage":"Removing participants from the team will also remove them from their roles.","RemoveParticipantErrorMessageDefault":"Cannot remove one or more participants.","DeleteRoleTitleSingle":"Delete role","DeleteRoleTitleMultiple":"Delete roles","DeleteRoleMessageNoParticipantsAffected":"When you delete this role, no participant will be removed from the team: The role is empty or all participants of this role are members of other team roles.","DeleteRoleMessageParticipantsAffectedSingle":"When you delete this role, 1 participant will be removed from the team.","DeleteRoleMessageParticipantsAffectedMultiple":"When you delete this role, {0} participants will be removed from the team.","ErrorLoadingAddItemMenu":"Cannot load workspace types to the Add menu.","AddConwsMetadataDialogTitle":"Create {0}","BusinessWorkspace":"business workspace","AddConwsMetadataDialogAddButtonTitle":"Save","BusinessWorkspaceTypeName":"Business Workspace","BusinessWorkspaceSuccessfullyCreated":"{0} was successfully created.","nameIsGeneratedAutomatically":"Workspace name is generated automatically.","errorGettingCreateForm":"Error getting form for workspace creation.","CommandNameAddCONWSTemplate":"Add business workspace template","ErrorAddingSubfolderToNodesTable":"Failed to add subfolder to the nodestable","ServerCommandNameDeleteRelatedItem":"Remove related item","CommandNameDeleteRelatedItem":"Remove relationships","CommandVerbDeleteRelatedItem":"remove","DeleteRelatedItemsNoneMessage":"No relationship removed.","DeleteOneRelatedItemSuccessMessage":"One relationship successfully removed.","DeleteSomeRelatedItemsSuccessMessage":"{0} relationships successfully removed.","DeleteManyRelatedItemsSuccessMessage":"{0} relationships successfully removed.","DeleteOneRelatedItemConfirmMessage":"Do you want to remove the relationship to '{1}'?","DeleteSomeRelatedItemsConfirmMessage":"Do you want to remove {0} relationships?","DeleteManyRelatedItemsConfirmMessage":"Do you want to remove {0} relationships?","CommandNameAddRelatedItem":"Add relationships","CommandVerbAddRelatedItem":"add","AddRelatedItemsNoneMessage":"No relationship added.","AddOneRelatedItemSuccessMessage":"One relationship successfully added.","AddSomeRelatedItemsSuccessMessage":"{0} relationships successfully added.","AddManyRelatedItemsSuccessMessage":"{0} relationships successfully added.","AddRoleSuccess":"{0} added successfully","EditRoleSuccess":"{0} updated successfully","BusinessWorkspaceRole":"Business Workspace Role","DeletePermissionCommandForSubItems":"Remove role","ToolbarItemEditRolePermission":"Edit role permissions","DeleteRoleCommandSuccessMessage":"{0} was deleted successfully","DeleteRoleCommandFailMessage":"Failed to delete {0}."}),csui.define("conws/utils/commands/tabletoolbar.extension",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","csui/controls/globalmessage/globalmessage","csui/controls/toolbar/toolitem.model","i18n!conws/utils/commands/nls/commands.lang","csui/utils/base"],function(e,t,i,s,o,n,a){function r(){}return t.extend(r.prototype,{"_addMenuItems":function(e,t){var i=[];t.forEach(function(e){e.templates.length>0&&e.templates.forEach(function(t){var s=848===t.subType?n.BusinessWorkspaceTypeName:"",a=new o({"signature":"AddConnectedWorkspace","name":t.name,"type":t.subType,"group":"conws","commandData":{"wsType":e,"subType":t.subType,"subTypeName":s,"template":t}});i.push(a)})}),i.length>0&&(i.sort(function(e,t){var i=e.get("name"),s=t.get("name"),o=a.localeCompareString(i,s,{"usage":"sort"});return o}),i.forEach(function(t){e.push(t)}))},"OnUpdateToolbar":function(o){var a=o.async(),r=o.container,l=o.toolbarItems,c=t.find(l,function(e){return 848===e.attributes.type?e:void 0});c&&(c.set("signature","AddCONWSTemplate"),c.set("group","conws"));var d=e.Deferred(),p=i.combine(r.urlBase(),"businessworkspacetypes"),u=r.connector.extendAjaxOptions({"type":"GET","url":p}),h=this;r.connector.makeAjaxCall(u).done(function(e){e&&e.businessworkspacetypes&&e.businessworkspacetypes.length>0&&h._addMenuItems(l,e.businessworkspacetypes),d.resolve.apply(d,arguments),a()}).fail(function(e,t,i){var o="\r\n",r=[];if("error"!==t&&r.push(t),e.responseText){var l=JSON.parse(e.responseText);l&&l.error&&r.push(l.error)}i&&r.push(i);var c=r.length>0?r.join(o):void 0;s.showMessage("error",n.ErrorLoadingAddItemMenu,c),d.reject.apply(d,arguments),a()})}}),function(e){var t=new r;e.on("before:updateAddToolbar",function(){t.OnUpdateToolbar.apply(t,arguments)})}}),csui.define("conws/utils/commands/permissions/permissions.dropdown.menu.items.extension",["i18n!conws/utils/commands/nls/commands.lang"],function(e){return{"dropdownMenuList":[{"signature":"AddOrEditRole","name":e.CommandNameAddRole}]}}),csui.define("conws/utils/commands/permissions/permissions.list.toolbaritems.extension",["i18n!conws/utils/commands/nls/commands.lang"],function(e){return{"inlineToolbar":[{"signature":"AddOrEditRole","name":e.CommandNameEditRole,"icon":"icon icon-toolbar-edit-role","svgId":"themes--carbonfiber--image--generated_icons--action_view_column32"},{"signature":"DeleteRole","name":e.DeleteRoleTitleSingle,"icon":"icon icon-toolbar-delete","svgId":"themes--carbonfiber--image--generated_icons--action_delete32"},{"signature":"EditRolePermission","name":e.ToolbarItemEditRolePermission,"icon":"icon icon-toolbar-edit","svgId":"themes--carbonfiber--image--generated_icons--action_edit32"}]}}),csui.define("conws/widgets/header/impl/headertoolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){function o(e){var o;this.toolbars=t.reduce(n,function(t,n){o=t[n],o||(o=new s);var a=new i(o,{"normalize":!1}),r=e[n];return r&&a.extendMask(r),a.storeMask(),t[n]=a,t},{})}var n=["rightToolbar","delayedActionsToolbar"];return o.toolbars=n,o}),csui.define("conws/utils/commands/addconws",["require","csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/models/command","csui/models/node/node.model","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s,o,n,a,r){function l(e,t,i){var s=t.at(0);if(!e.get("id")){var n=s.get("data");if(n){var a=n.name;o.debug("name fetched and used: {0}",a)&&console.log(o.last),e.set("name",a)}else o.debug("name set to empty.")&&console.log(o.last),e.set("name","")}var l=i.metadataAddItemPropView,c=l&&l.metadataHeaderView,d=c&&c.metadataItemNameView;if(d){var p=s.get("schema"),u=p&&p.properties&&p.properties.name&&p.properties.name.readonly?!0:!1,h=u?r.nameIsGeneratedAutomatically:void 0;d.setPlaceHolder(h),u&&l&&l.metadataPropertiesView&&l.metadataPropertiesView.once("render:forms",function(){this.options.metadataView.metadataHeaderView.metadataItemNameView.$el.find("span.title").removeAttr("role");var e=this.currentlyFocusedElement();e&&e.trigger("focus")})}}var c=!1,d=n.extend({"defaults":{"signature":"AddConnectedWorkspace","name":r.CommandNameAddConnectedWorkspace,"verb":"create","doneVerb":"created","scope":"single"},"enabled":function(){return!0},"execute":function(e,n){var d=t.Deferred(),p=e.data||{},u=e.container||{},h=p.wsType||{},m=p.template||{},g=p.subType,f=p.subTypeName,w=new a({"type":g,"type_name":f,"container":!0,"name":"","parent_id":u.attributes.id,"rm_enabled":h.rm_enabled,"sub_folder_id":0},{"connector":e.container.connector});return c?(e.forwardToTable=!0,d.resolve(w)):(e.suppressSuccessMessage=!0,csui.require(["csui/models/nodes","csui/utils/commandhelper","csui/widgets/metadata/metadata.add.item.controller","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage","conws/models/workspacecreateforms","conws/models/metadata.controller","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/next.node"],function(t,c,p,u,f,v,b,y,k){function x(){var e=S.dialog;e&&e.$el&&(e.$el.addClass("conws-initializing"),R.off(null,x))}function _(){var e=S.dialog;e&&e.$el&&(e.$el.removeClass("conws-initializing"),R.off(null,_))}function C(){var t=i.str.sformat(r.BusinessWorkspaceSuccessfullyCreated,w.get("name")),s={"context":e.context,"nextNodeModelFactory":k,"link_url":y.getDefaultActionNodeUrl(w),"targetFolder":w};f.showMessage("success_with_link",t,void 0,s)}function T(){var t=!1;if(e.collection.forEach(function(e){e.get("id")===w.get("id")&&(e.set(w.attributes),t=!0)}),!t){var i=e.collection.node.get("id"),s=w.get("parent_id"),o=w.get("sub_folder_id");if(i===s||i===-s)e.collection.add(w,{"at":0});else if(i!==o&&0!==o){var n=new a({"id":o},{"connector":e.container.connector,"collection":e.collection});n.fetch({"success":function(){n.get("parent_id")===i&&void 0===e.collection.findWhere({"id":n.get("id")})&&(n.isLocallyCreated=!0,e.collection.add(n,{"at":0})),C()},"error":function(){u.showError(r.ErrorAddingSubfolderToNodesTable),C()}})}else C()}}var S=new p;n.dialogTitle=i.str.sformat(r.AddConwsMetadataDialogTitle,m.name||r.BusinessWorkspace),n.addButtonTitle=r.AddConwsMetadataDialogAddButtonTitle,e.nodes=new t([w]),n=i.extend({"formCollection":new v(void 0,{"metadataAddItemController":S,"node":e.container,"type":g,"wsType":h,"template":m}),"metadataController":new b(void 0,{"type":g,"wsType":h,"template":m,"collection":e.collection})},n);var R=n.formCollection;R.on("request",function(){var e=S.dialog;e&&e.$el&&e.$el.addClass("conws-add-workspace")}),R.once("request",x),R.once("sync",_),R.once("error",_),R.on("sync",function(){l(w,R,S)}),R.on("error",function(e,t){var i=t&&new s.Error(t).message||r.errorGettingCreateForm;o.error("Fetching the create forms failed: {0}",i)&&console.error(o.last),u.showError(i)}),S.displayForm(e,n).then(function(){w.isLocallyCreated=!0,T(),d.resolve.apply(d,arguments)}).fail(function(e){e instanceof Error?d.reject(e):d.reject()}),e.metadataAddItemController=S},function(e){d.reject(e)})),d.promise()}});return d}),csui.define("conws/utils/commands/addconwstemplate",["require","csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/models/command","csui/models/node/node.model","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s,o,n,a,r){var l=20541,c=n.extend({"defaults":{"signature":"AddCONWSTemplate","name":r.CommandNameAddCONWSTemplate,"scope":"single"},"enabled":function(e){var t=e.container||{};return t.get("type")===l?!0:!1},"execute":function(e,i){var s=t.Deferred(),o=i.addableType,n=i.addableTypeName,r=new a({"type":o,"type_name":n,"container":!0,"name":"","parent_id":e.container.attributes.id,"is_doctemplate":!0},{"connector":e.container.connector});return e.forwardToTable=!0,s.resolve(r),s.promise()}});return c}),csui.define("conws/utils/commands/delete",["csui/lib/jquery","csui/lib/underscore","csui/utils/commands/delete"],function(e,t,i){var s=i.prototype.enabled,o=i.extend({"enabled":function(e){return void 0===e.container||854!==e.container.get("type")?s.call(this,e):!1}});return i.prototype=o.prototype,i}),csui.define("conws/utils/commands/permissions/addoreditrole",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/models/command","conws/utils/commands/permissions/permissions.util","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s,o,n,a){var r,l=o.extend({"defaults":{"signature":"AddOrEditRole","name":a.CommandNameAddRole},"enabled":function(e){var t=e.nodeModel||e.originatingView&&e.originatingView.model;return n.isWorkspace(t)?e.nodeModel?!0:!e.nodeModel&&e.model&&n.isWorkspaceRole(e.model)&&!n.isInheritedRole(t,e.model)?!0:!1:!1},"execute":function(e,o){{var l=this,c=i.Deferred();e.context||o&&o.context}return e.addrole=!!e.nodeModel,e.suppressSuccessMessage=!0,csui.require(["csui/models/permission/nodepermission.model","csui/controls/globalmessage/globalmessage"],function(d){if(r=arguments[1],!e.addrole&&e.model){e.model.action="fetch",e.model.nodeId=e.originatingView&&e.originatingView.model&&e.originatingView.model.get("id");var p=n.getUrl(e.model);e.model.fetch({"url":p}).done(function(){e.model.get("results")&&e.model.get("results").data&&e.model.get("results").data.members&&e.model.get("results").data.properties&&(e.model.set("members",e.model.get("results").data.members),e.model.get("right_id_expand").name=e.model.get("results").data.properties.name,e.model.get("right_id_expand").description=e.model.get("results").data.properties.description,e.model.get("right_id_expand").team_lead=e.model.get("results").data.properties.leader),e.model.unset("links"),e.model.unset("results"),e.model.unset("addEmptyAttribute"),l._selectAddOrEditRoleOptions(e,o).done(function(o){var a={"name":o.role_name,"description":o.role_description,"leader":o.team_lead};o.permissions&&(a.permissions=o.permissions,a.apply_to=o.apply_to,a.include_sub_types=o.apply_to>0?[204,207,215,298,3030202]:[]),o.participants&&(a.members=o.participants),e.model.action="update",p=n.getUrl(e.model),e.model.save(a,{"url":p,"patch":!0,"wait":!0,"silent":!0}).done(function(){var s=e.model.get("right_id_expand");if(s.name!==o.role_name){var a=t.find(e.model.collection.extraMemberModels,{"id":e.model.get("right_id")});a&&(a.set("name",o.role_name),a.set("name_formatted",o.role_name))}if(s.name=o.role_name,s.name_formatted=o.role_name,s.description=o.role_description,s.team_lead=o.team_lead,o.team_lead){var d=e.nodeModel||e.originatingView&&e.originatingView.model;i.each(e.model.collection.models,function(e,t){n.isWorkspaceRole(t)&&!n.isInheritedRole(d,t)&&(t.get("right_id_expand").leader_id=s.id)}),s.leader_id=s.id,i.each(e.model.collection.extraMemberModels,function(e,t){n.isWorkspaceRole(t)&&!n.isInheritedRole(d,t)&&t.set("leader_id",s.id)})}o.permissions&&o.apply_to&&(s.permissions=o.permissions,e.model.set("permissions",o.permissions),s.apply_to=o.apply_to),o.participants&&o.participants.length>0&&(s.members=o.participants,e.model.set("members",o.participants)),e.model.set({"right_id_expand":s,"type":"custom"},{"silent":!0}),r.showMessage("success",l._getMessageWithRoleName(e.model)),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),e.originatingView&&e.originatingView.permissionsContentView&&e.originatingView.permissionsContentView.permissionsListView&&e.originatingView.permissionsContentView.permissionsListView.trigger("update:table",e.model),c.resolve(e.model)}).fail(function(t){var i=new s.Error(t);e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),r.showMessage("error",i),c.reject(e.model,i)})}).fail(function(e){c.reject(e)})}).fail(function(e){c.reject(e)})}else e.isWorkspaceRoleExists=e.permissionCollection.models.some(function(t){return n.isWorkspaceRole(t)&&!n.isInheritedRole(e.nodeModel,t)},this),l._selectAddOrEditRoleOptions(e,o).done(function(o){var p=void 0!==o.apply_to?o.apply_to:2,u={"name":o.role_name,"description":o.role_description,"leader":o.team_lead,"members":o.participants,"permissions":void 0!==o.permissions?o.permissions:d.getReadPermissions(),"apply_to":p,"include_sub_types":p>0?[204,207,215,298,3030202]:[]},h=new d(u,e);h.unset("addEmptyAttribute"),h.action="create",h.nodeId=e.nodeId,e.originatingView&&e.originatingView.blockActions&&e.originatingView.blockActions();var m=n.getUrl(h);h.save(u,{"url":m,"silent":!0,"wait":!0}).done(function(s){var d,p=s.results&&s.results.data&&s.results.data.properties,u=p&&p.id,m=p&&p.leader,g=e.nodeModel||e.originatingView&&e.originatingView.model;if(m)i.each(e.permissionCollection.models,function(e,t){n.isWorkspaceRole(t)&&!n.isInheritedRole(g,t)&&(t.get("right_id_expand").leader_id=u)}),i.each(e.permissionCollection.extraMemberModels,function(e,t){n.isWorkspaceRole(t)&&!n.isInheritedRole(g,t)&&t.set("leader_id",u)});else{var f=t.filter(e.permissionCollection.models,function(e){return n.isWorkspaceRole(e)&&n.isLeaderRole(g,e)});d=f.length&&f[0].get("right_id_expand").leader_id}h.set({"right_id_expand":{"id":u,"initials":o.role_name[0],"leader_id":m?u:d,"name":o.role_name,"name_formatted":o.role_name,"type":848,"node_id":e.nodeId,"type_name":a.BusinessWorkspaceRole},"type":"custom","right_id":u},{"silent":!0}),r.showMessage("success",l._getMessageWithRoleName(h)),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),c.resolve(h)}).fail(function(t){var i=new s.Error(t);e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),r.showMessage("error",i),c.reject(h,i)})}).fail(function(e){c.reject(e)})},function(e){c.reject(e)}),c.promise()},"_selectAddOrEditRoleOptions":function(e){var t=i.Deferred();return csui.require(["conws/dialogs/addoreditrole/addoreditrole.wizard"],function(i){var s=new i({"command":"addoreditrole","context":e.context,"connector":e.connector,"dialogClass":"cs-permission-role-picker","displayName":e.addrole?a.CommandNameAddRole:a.CommandNameEditRole,"dialogTitle":e.addrole?a.CommandNameAddRole:a.CommandNameEditRole,"addrole":e.addrole,"nodeModel":e.addrole?e.nodeModel:e.originatingView.model,"model":e.model,"addButtonLabel":a.AddButtonLabel,"availablePermissions":e.addrole?e.permissionCollection.availablePermissions:e.originatingView.collection,"applyTo":e.applyTo,"isFirstRole":!e.isWorkspaceRoleExists});s.show().done(function(){t.resolve.apply(t,arguments)}).fail(function(){t.reject.apply(t,arguments)})},function(e){t.reject(e)}),t.promise()},"_getMessageWithRoleName":function(e){var i,o;return e.get("right_id_expand")&&(o=s.formatMemberName(e.get("right_id_expand"))),i=e.action&&"update"===e.action?t.str.sformat(a.EditRoleSuccess,o):t.str.sformat(a.AddRoleSuccess,o)}});return l}),csui.define("conws/utils/workspaces/busyindicator",[],function(){function e(e,t){this.on_fct=e,this.off_fct=t}function t(t,i){if(t.busyIndicator)t.busyIndicator[i]();else{var s=t.originatingView;s&&s.blockActions&&s.unblockActions&&(t.busyIndicator=new e(function(){s.blockActions()},function(){s.unblockActions()}),t.busyIndicator[i]())}}return e.on=function(e){t(e,"on")},e.off=function(e){t(e,"off")},e.prototype.on=function(){this.busy||(this.busy=!0,this.on_fct())},e.prototype.off=function(){this.busy&&(this.busy=!1,this.off_fct())},e}),csui.define("conws/utils/commands/addrelateditem",["require","csui/lib/underscore","csui/lib/jquery","i18n!conws/utils/commands/nls/commands.lang","csui/models/action","csui/models/command","conws/utils/workspaces/busyindicator"],function(e,t,i,s,o,n,a){function r(e){var t,i=e.collection&&e.collection.workspace;return i&&i.actions&&(t=i.actions.get?i.actions.get("add-relitem"):i.actions["add-relitem"]),t}var l=n.extend({"defaults":{"signature":"AddRelation","command_key":["add-relitem"],"scope":"multiple","name":s.CommandNameAddRelatedItem,"verb":s.CommandVerbAddRelatedItem,"successMessages":{"formatForNone":s.AddRelatedItemsNoneMessage,"formatForOne":s.AddOneRelatedItemSuccessMessage,"formatForTwo":s.AddSomeRelatedItemsSuccessMessage,"formatForFive":s.AddManyRelatedItemsSuccessMessage}},"enabled":function(e){var t=!1;return e.data&&e.data.submit?e.nodes&&e.nodes.length&&(t=!!r(e)):t=!!r(e),t},"execute":function(e,t){return e.suppressSuccessMessage=!0,e.data&&e.data.submit?this.submitNodes(e,t):this.openSearch(e,t)},"submitNodes":function(e){var t=this,s=i.Deferred();return e.suppressSuccessMessage=!0,a.on(e),s.always(function(){a.off(e)}),csui.require(["csui/lib/underscore","csui/utils/base","csui/utils/url","csui/controls/globalmessage/globalmessage"],function(i,o,n,a){function l(e){var t,s,o,a=e.nodes,l=[],c=r(e);if(a&&c&&a.each(function(e){t=e.connector,s=e.get("name");var o=c.href||c.get("href"),a=o.match(/^\/?api\/v([0-9\.])+\/([^?#]+)/i),r=i.extend(n.urlParams(o),{"rel_bw_id":e.get("id"),"rel_type":e.get("rel_type")}),d={"apiCall":a&&a.length>=3?a[2]:o,"params":{"fRequestArgs":r,"fVersionNumber":a&&a.length>=2?parseInt(a[1]):2,"fParamTicket":"","fParamMethod":c.method||c.get("method"),"fCallName":o}};l.push(d)}),t){var d=t.getConnectionUrl(),p=d.getCgiScript(),u=n.combine(p,"/api/v1/csui/batch"),h=new FormData;h.append("body",JSON.stringify({"exitOnError":!0,"calls":l})),o={"url":u,"method":"POST","data":h,"contentType":!1,"processData":!1}}return{"connector":t,"name":s,"data":o,"count":l.length}}var c=l(e);c.count?c.connector.makeAjaxCall(c.data).done(function(i){var n=o.formatMessage(i.calls.length,t.get("successMessages"),c.name);s.resolve(e.nodes),a.showMessage("success",n),e.originatingView&&e.originatingView.trigger("cmd:success",t.get("signature"),e.nodes)}).fail(function(i){var o=i.responseJSON?i.responseJSON.error:i.statusText,n=new Error(o);n.suppressFailMessage=!0,s.reject(n),a.showMessage("error",o),e.originatingView&&e.originatingView.trigger("cmd:failure",t.get("signature"),n)}):s.resolve()},s.reject),s.promise()},"openSearch":function(e){var n=this,a=i.Deferred();
e.suppressSuccessMessage=!0;var l=r(e);return l?csui.require(["conws/widgets/relatedworkspaces/addrelatedworkspaces.search"],function(i){var r,l=new i({"title":n.get("name"),"signature":n.get("signature"),"status":e});l.searchView.on("go:back",function(){r?(r.suppressFailMessage=!0,a.reject(r)):a.resolve()}),l.searchView.on("cmd:success",function(e,i){e===n.get("signature")&&(r=void 0,l.close(),i.each(function(e){var i=e.get("rel_source"),n=e.get("id"),a=e.get("rel_type"),r=t.str.sformat("/api/v2/businessworkspaces/{0}/relateditems/{1}?rel_type={2}",i,n,a),l=new o({"body":"","content_type":"","form_href":"","href":r,"method":"DELETE","name":s.ServerCommandNameDeleteRelatedItem,"signature":"deleterelateditem"},{"connector":e.connector});e.actions.add(l)}),a.resolve(i.models))}),l.searchView.on("cmd:failure",function(e,t){e===n.get("signature")&&(r=t)}),l.show()},a.reject):a.resolve(),a.promise()}});return l}),csui.define("conws/utils/commands/deleterelateditem",["require","csui/lib/jquery","i18n!conws/utils/commands/nls/commands.lang","csui/models/command","conws/utils/workspaces/busyindicator"],function(e,t,i,s,o){var n=s.extend({"defaults":{"signature":"RemoveRelation","command_key":["deleterelateditem"],"scope":"multiple","name":i.CommandNameDeleteRelatedItem,"verb":i.CommandVerbDeleteRelatedItem,"confirmMessages":{"formatForOne":i.DeleteOneRelatedItemConfirmMessage,"formatForTwo":i.DeleteSomeRelatedItemsConfirmMessage,"formatForFive":i.DeleteManyRelatedItemsConfirmMessage},"successMessages":{"formatForNone":i.DeleteRelatedItemsNoneMessage,"formatForOne":i.DeleteOneRelatedItemSuccessMessage,"formatForTwo":i.DeleteSomeRelatedItemsSuccessMessage,"formatForFive":i.DeleteManyRelatedItemsSuccessMessage}},"enabled":function(e){if(e.nodes&&e.nodes.length){var t=e.nodes.find(function(e){return e.actions&&e.actions.get("deleterelateditem")?void 0:e});return!t}return!1},"execute":function(e){var i=this,s=t.Deferred();return e.suppressSuccessMessage=!0,o.on(e),s.always(function(){o.off(e)}),csui.require(["csui/lib/underscore","csui/utils/base","csui/utils/url","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage"],function(t,n,a,r,l){function c(e){var t,i,s,o=e.nodes,n=[];if(o&&o.each(function(e){var s=e.actions.get("deleterelateditem");if(s){t=e.connector,i=e.get("name");var o=s.get("href"),r=o.match(/^\/?api\/v([0-9\.])+\/([^?#]+)/i),l={"apiCall":r&&r.length>=3?r[2]:o,"params":{"fRequestArgs":a.urlParams(o),"fVersionNumber":r&&r.length>=2?parseInt(r[1]):2,"fParamTicket":"","fParamMethod":s.get("method"),"fCallName":o}};n.push(l)}}),t){var r=t.getConnectionUrl(),l=r.getCgiScript(),c=a.combine(l,"/api/v1/csui/batch"),d=new FormData;d.append("body",JSON.stringify({"exitOnError":!0,"calls":n})),s={"url":c,"method":"POST","data":d,"contentType":!1,"processData":!1}}return{"connector":t,"name":i,"data":s,"count":n.length}}var d=c(e);if(d.count){o.off(e);var p=n.formatMessage(d.count,i.get("confirmMessages"),d.name);r.confirmQuestion(p,i.get("name")).done(function(){o.on(e),d.connector.makeAjaxCall(d.data).done(function(e){var t=n.formatMessage(e.calls.length,i.get("successMessages"),d.name);s.resolve(e.calls),l.showMessage("success",t)}).fail(function(e){var t=e.responseJSON?e.responseJSON.error:e.statusText,i=new Error(t);i.suppressFailMessage=!0,s.reject(i),l.showMessage("error",t)})}).fail(function(){s.resolve()})}else s.resolve()},s.reject),s.promise()}});return n}),csui.define("conws/utils/commands/permissions/deleterole",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/commands/permissions/delete.permission","csui/utils/command.error","csui/controls/globalmessage/globalmessage","conws/utils/commands/permissions/permissions.util","i18n!conws/utils/commands/nls/commands.lang","i18n!csui/utils/commands/nls/localized.strings"],function(e,t,i,s,o,n,a,r,l,c){var d=o.extend({"defaults":{"signature":"DeleteRole","name":l.CommandNameDeleteRole,"scope":"single"},"enabled":function(e){var t=e.model,i=r.isWorkspaceRole(t),s=t&&t.get("type"),o=e.nodeModel||e.originatingView&&e.originatingView.model,n=r.isWorkspace(o),a=r.isInheritedRole(o,t),c=r.isLeaderRole(o,t),d=s&&"custom"===s&&i&&!c&&o.actions&&!!o.actions.get({"signature":"editpermissions"});return(!n&&i||n&&a)&&e.toolItem.set("name",l.DeletePermissionCommandForSubItems),d},"execute":function(e,i){var s=t.Deferred(),o=this;return i||(i={}),e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","conws/dialogs/applyrolepermissions/apply.role.permissions.view","conws/dialogs/applyrolepermissions/impl/header/apply.role.permissions.header.view","csui/controls/progressblocker/blocker","csui/controls/dialog/dialog.view","csui/utils/permissions/permissions.precheck"],function(t,n,l,c,d,p){a=t;var u=e.model,h=e.nodeModel||e.originatingView&&e.originatingView.model,m=r.isWorkspace(h),g=r.isWorkspaceRole(u),f=r.isInheritedRole(h,u);u.isRoleDelete=m&&g&&!f?!0:!1,e.originatingView&&e.originatingView.model&&e.originatingView.model.get("container")?(i.removePermission=!0,o._executeDeletePermission(e,i,l,n,c,d,p).then(s.resolve,s.reject)):o._deletePermission(e,i).then(s.resolve,s.reject)},s.reject),s.promise()},"_performActions":function(e){var i,s=this,o=t.Deferred(),d=e.dialog?e.dialog.options.view.options.permissionModel:e.model,p=d.get("type"),u=d.collection,h=this._getMessageWithUserDisplayName(c.DeletePermissionCommandFailMessage,d);if(u&&u.options&&u.options.node&&u.options.node.actions.get({"signature":"editpermissions"})){d.nodeId=u.options&&u.options.node&&u.options.node.get("id");{var m,g=u.options&&u.options.node&&u.options.node.get("container");u.options&&u.options.node&&u.options.node.get("permissions_model")}e.dialog&&!d.isRoleDelete&&(d.apply_to=g&&e.dialog.options.view.ContentRegion.currentView.getValues().subitems_inherit?2:0,d.include_sub_types=d.apply_to>0?[204,207,215,298,3030202]:[]),m=d.url(),d.isRoleDelete&&(d.action="delete",m=r.getUrl(d),h=this._getMessageWithUserDisplayName(l.DeleteRoleCommandFailMessage,d)),s.originatingView&&s.originatingView.blockActions&&(s.destroyDialog(e),s.originatingView.blockActions());var f=d.destroy({"url":m,"wait":!0}).done(function(e){d.set("results",e.results),s.originatingView&&s.originatingView.trigger("permission:changed",s),s.originatingView&&s.originatingView.unblockActions&&s.originatingView.unblockActions(),i=d.isRoleDelete?s._getMessageWithUserDisplayName(l.DeleteRoleCommandSuccessMessage,d):s._getMessageWithUserDisplayName(d.get("results")&&d.get("results").success>0?c.DeletePermissionCommandSuccessMessageWithCount:c.DeletePermissionCommandSuccessMessage,d),a.showMessage("success",i),("owner"===p||"group"===p)&&u.processForEmptyOwner&&u.processForEmptyOwner(),o.resolve(d)}).fail(function(e){var t=e?new n(e,d):e;s.handleFailure(t,h),o.reject(d,t),e||f.abort()}).always(function(){s.originatingView&&s.originatingView.unblockActions&&s.originatingView.unblockActions()});return o.promise()}return s.destroyDialog(e),o.reject(new n(h,{"errorDetails":c.undefinedCollection}))},"handleFailure":function(e,t){var i,o=s.Model.extend({"defaults":{"name":"","state":"pending","commandName":"ViewPermission"}}),n=s.Collection.extend({"model":o}),r=new n;i=new o({"name":e,"mime_type":"","state":"rejected"}),r.add(i),a.showPermissionApplyingProgress(r,{"oneFileFailure":t})}});return d}),csui.define("conws/utils/commands/permissions/edit.role.permissions",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/models/command","csui/utils/command.error","csui/utils/commands/permissions/permission.util","conws/utils/commands/permissions/permissions.util","i18n!csui/utils/commands/nls/localized.strings"],function(e,t,i,s,o,n,a,r,l){var c=o.extend({"defaults":{"signature":"EditRolePermission","command_key":["editpermissions","Edit Permissions"]},"enabled":function(e){var t=e.model,i=t&&t.get("type"),s=e.nodeModel||e.originatingView&&e.originatingView.model,o=i&&"custom"===i&&r.isWorkspaceRole(t)&&s.actions&&!!s.actions.get({"signature":"editpermissions"});return o},"execute":function(e){var t=this,s=i.Deferred(),o=e.model,c=o.collection,d=e.targetView;t.targetView=d,e.suppressFailMessage=!0,e.suppressSuccessMessage=!0;var p=this._getMessageWithUserDisplayName(l.EditPermissionCommandFailMessage,o),u=c&&c.options&&c.options.node&&c.options.node.actions.get({"signature":"editpermissions"});return c&&u?(o.nodeId=c.options&&c.options.node&&c.options.node.get("id"),csui.require(["conws/utils/commands/permissions/edit.role.permission.helper","csui/utils/contexts/factories/user","csui/controls/globalmessage/globalmessage","csui/utils/permissions/permissions.precheck"],function(i,l,c,d){var p=e.originatingView.context.getModel(l);t.loginUserId=p.get("id"),t.editRolePermissionHelper=new i({"permissionModel":o,"popoverPlacement":"left","popoverAtBodyElement":e.originatingView?!e.originatingView.options.isExpandedView:!0,"popoverTargetElement":e.targetView.permissions.$el,"readonly":!1,"originatingView":e.originatingView,"applyTo":e.applyTo}),t.editRolePermissionHelper._showSelectPermissionLevelPopover(),t.editRolePermissionHelper.listenTo(t.editRolePermissionHelper,"permissions:selected",function(i){var l,p={"permissions":i.permissions,"apply_to":i.apply_to,"include_sub_types":i.apply_to>0?d.includeSubTypes():[]},u=t.targetView&&t.targetView.options&&t.targetView.options.nodeModel||t.targetView&&t.targetView.permissions&&t.targetView.permissions.options&&t.targetView.permissions.options.nodeModel;i.right_id&&(p.right_id=i.right_id),r.isWorkspace(u)&&r.isWorkspaceRole(o)&&(o.action="editperms",l=r.getUrl(o)),o.save(p,{"url":l,"patch":!0,"wait":!0,"silent":!0}).done(function(i){o.set(p,{"silent":!0}),e.originatingView.trigger("permission:changed",e),t.editRolePermissionHelper.destroy(),t.editRolePermissionHelper.unblockActions(),s.resolve(),"simple"!==e.originatingView.model.get("permissions_model")&&a.generateSuccessMessage(i,c)}).fail(function(e){var t=e?new n(e,o):e;c.showMessage("error",t),s.reject(o,t)})}),t.editRolePermissionHelper.listenTo(t.editRolePermissionHelper,"closed:permission:level:popover",function(){s.reject(o)})}),s.promise()):s.reject(new n(p,{"errorDetails":l.undefinedCollection}))},"_getMessageWithUserDisplayName":function(e,i){var o;i.get("right_id_expand")?o=s.formatMemberName(i.get("right_id_expand")):"public"===i.get("type")&&(o=l.publicAccess);var n=t.str.sformat(e,o);return n}});return c}),csui.define("conws/utils/commands/permissions/edit.role.permission.helper",["csui/lib/underscore","csui/controls/dialog/dialog.view","csui/models/permission/nodepermission.model","csui/widgets/permissions/impl/edit/edit.permission.helper","conws/dialogs/applyrolepermissions/apply.role.permissions.view","csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view","csui/controls/progressblocker/blocker","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,t,i,s,o,n,a,r){var l=s.extend({"constructor":function(){s.prototype.constructor.apply(this,arguments)},"_permissionLevelSelected":function(){this._blockActions();var e=this.permissionLevelSelectorView.selected;e!==i.PERMISSION_LEVEL_CUSTOM?(this.showingPopover&&this.closePopover(!0),this.permissions=i.getPermissionsByLevelExceptCustom(e,this.options.originatingView?this.options.originatingView.model.get("container"):!0,this.options.originatingView&&this.options.originatingView.model.get("advanced_versioning")),this.options.originatingView&&this.options.originatingView.model&&this.options.originatingView.model.get("container")?(this._applyDialog=this.showApplyPermissionDialog(),this._applyDialog.show()):this.triggerMethod("permissions:selected",{"permissions":this.permissions})):this.showCustomPermissionPopover(),this.unblockActions()},"showApplyPermissionDialog":function(){var i=new n;this._view=new o({"context":this.options.context||this.options.originatingView.context,"model":this.options.nodeModel||this.options.originatingView.model,"applyTo":this.options.applyTo,"permissionModel":this.options.permissionModel});var s=new t({"headerView":i,"view":this._view,"className":"csui-permissions-apply-dialog","midSize":!0,"buttons":[{"id":"apply","label":r.applyButtonLabel,"toolTip":r.applyButtonLabel,"default":!0,"click":e.bind(this.onClickApplyButton,this)},{"label":r.cancelButtonLabel,"toolTip":r.cancelButtonLabel,"close":!0}]});return s.listenTo(s,"hide",e.bind(this.onHideDialog,this)),a.imbue(s),s},"onClickApplyButton":function(e){{var t=e.dialog.options.view.model.get("container"),i=e.dialog.options.view.options.permissionModel&&e.dialog.options.view.options.permissionModel.get("right_id"),s=t&&e.dialog.options.view.ContentRegion.currentView.getValues().subitems_inherit?2:0,o=s>0?[204,207,215,298,3030202]:[];this.triggerMethod("permissions:selected",{"permissions":this.permissions,"apply_to":s,"right_id":i,"include_sub_types":o})}this._applyDialog.destroy(),this._blockActions()}});return l}),csui.define("conws/utils/dragndrop/dragndrop.subtypes",[],function(){return 848}),csui.define("css!conws/utils/overlay/impl/conwsoverlay",[],function(){}),csui.define("conws/utils/overlay/conwsoverlay",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","css!conws/utils/overlay/impl/conwsoverlay"],function(e,t,i){var s=i.Controller.extend({"constructor":function(){i.Controller.prototype.constructor.apply(this,arguments)},"_transitionEnd":t.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if("undefined"!=typeof i.style[e])return t[e]}),"_hidePresentationView":function(){this.options.onHidePresentationView&&this.options.onHidePresentationView(this.modalContent),this.modalWrapper.detach(),this.presentationView.$el.detach(),this.presentationView.$el.removeClass("conws-overlay-panel"),this.modalContent.removeClass("conws-overlay-showing")},"_showOtherView":function(){this.modalContent.find(">:not(.conws-overlay-wrapper)").show(),this.options.onShowOtherView&&this.options.onShowOtherView(this.modalContent)},"_hideOtherView":function(){this.options.onHideOtherView&&this.options.onHideOtherView(this.modalContent),this.modalContent.find(">:not(.conws-overlay-wrapper)").hide()},"_showPresentationView":function(){this.modalContent=e(this.options.presentationRoot),this.modalContent.addClass("conws-overlay-beforeshow"),this.presentationView||(this.presentationView=this.options.presentationView,this.presentationView.render()),this.presentationView.$el.addClass("conws-overlay-panel"),this.modalWrapper=e('<div class="conws-overlay-wrapper"></div>'),this.modalContent.append(this.modalWrapper),this.modalWrapper.append(this.presentationView.$el),this.options.onShowPresentationView&&this.options.onShowPresentationView(this.modalContent),this.presentationView.$el.position(),this.presentationView.triggerMethod("dom:refresh");var t=this;this.presentationView.$el.one(this._transitionEnd(),function(){t.modalContent.removeClass("conws-overlay-animating"),t.modalContent.addClass("conws-overlay-showing"),t._hideOtherView()}),this.modalContent.addClass("conws-overlay-animating"),this.modalContent.removeClass("conws-overlay-beforeshow")},"show":function(){this._showPresentationView()},"close":function(){this._showOtherView(),this._hidePresentationView()}});return s}),csui.define("conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchresult.model",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/nodes","csui/models/browsable/browsable.mixin","csui/models/mixins/node.resource/node.resource.mixin","csui/models/mixins/expandable/expandable.mixin","conws/utils/workspaces/impl/workspaces.collection.mixin"],function(e,t,i,s,o,n,a,r,l,c){function d(e){this.set(e)}function p(e,t){this.set(e,t)}var u=e.config();d.prototype.set=function(e){this.sortedColumns=e||{}},p.prototype.set=function(e,t){var i={},s=t||"name asc",o=s.replace(/( asc| desc)$/,""),n=s.slice(o.length+1),a=n?n+"_"+o:o,r=o.charAt(0).toUpperCase()+o.slice(1);e&&e.each(function(e){var t=e.get("column_key"),s=e.get("name");o===t?r=s:e.get("sort")&&(i["asc_"+t]={"name":s},i["desc_"+t]={"name":s})}),n?(i["asc_"+o]={"name":r},i["desc_"+o]={"name":r}):i[o]={"name":r},this.links=i,this.sort=[a]};var h=n.extend({"constructor":function(e,o){this.wherePart=["where_workspace_type_ids","where_rel_type"],n.prototype.constructor.apply(this,arguments),this.options=i.pick(o,"query","connector","node","search","autofetch","autoreset","stateEnabled","workspace","orderBy"),this.workspace=o.workspace,this.searchFacets=new s.Collection,this.searchFacets.filters=[],this.searchFacets.ensureFetched=function(e){return t.Deferred().resolve(this,{},e).promise()},this.searchFacets.getAvailableFacets=function(){return[]},this.searchFacets.clearFilter=function(){},this.makeBrowsable(o),this.makeNodeResource(o),this.makeExpandable(o),this.makeWorkspacesCollection(o),this.completeColumns=new this.columns.constructor(o.columns.toJSON(),{"dataCollectionName":this.dataCollectionName}),this.columns.reset(i.each(o.columns.toJSON(),function(e){delete e.sort,delete e.sort_key})),this.searching=new d(this.columns),this.sorting=new p(this.completeColumns,this.orderBy)}});a.mixin(h.prototype),r.mixin(h.prototype),l.mixin(h.prototype),c.mixin(h.prototype);var m=h.prototype.parse;return i.extend(h.prototype,{"url":function(){var e=this.options.query||{};this._cleanupQuery(e),e=this.mergeUrlPaging(u,e),e=this.mergeUrlSorting(e),this.filters=i.omit(this.options.search.attributes,"query_id","forcePerspectiveChange","dummy"),e=this.mergeUrlFiltering(e);var t=this.options.node.get("id"),s=o.combine(this.getBaseUrl(),"businessworkspaces",t,"relateditemspicklist");return s=s.replace("/v1","/v2"),e=i.omit(e,function(e){return null==e||""===e}),e.metadata=void 0,s+"?"+this.queryParamsToString(e)},"parse":function(e){this.completeColumns.resetColumns(e,this.options);var t=e.meta_data&&e.meta_data[this.dataCollectionName]||{};i.each(t,function(e){delete e.sort,delete e.sort_key});var s=m.apply(this,arguments);if(this.searching.set(this.columns),this.sorting.set(this.completeColumns,this.orderBy),s){var o=this.options.node.get("id"),n=this.options.query&&this.options.query.where_rel_type;s.forEach(function(e){e.data||(e.data={}),e.data.properties||(e.data.properties={}),e.data.properties.rel_source=o,e.data.properties.rel_type=n,e.data.properties.OTName=e.data.properties.name})}return s},"setPreviousOrder":function(e,t){return i.isEqual(this.previousOrderBy,e)?void 0:(this.previousOrderBy=e,t!==!1&&this.fetch({"skipSort":!1}),!0)},"getResourceScope":function(){return{"query":i.deepClone(this.options.query),"node":this.node}},"setResourceScope":function(e){e.query&&(this.options.query=e.query),e.node&&(this.node=e.node)},"isFetchable":function(){return this.options.node.isFetchable()}}),h}),csui.define("conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchform.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","conws/utils/workspaces/impl/workspaceutil"],function(e,t,i,s){function o(e,t,i,s,o){e.data[t]=i,e.options.fields[t]=s,e.schema.properties[t]=o}function n(e,i){var o,n=s.getFormFieldTemplate(e.attributes);return n&&(o=t.deepClone(n),o.data=i,o.options.label=e.get("name"),o.schema.title=e.get("name")),o}function a(e){var t={"data":{},"options":{"type":"object","fields":{}},"schema":{"type":"object","properties":{}}};return e&&(t.options.label=e,t.schema.title=e),t}var r=i.Model.extend({"constructor":function(e,s){s||(s={}),e=t.extend({"data":{},"options":{},"schema":{}},e),i.Model.prototype.constructor.call(this,e,s),this.setFromColumns(s.columns,s.tableColumns),this.listenTo(s.columns,"reset update",function(){this.setFromColumns(s.columns,s.tableColumns)})},"setFromColumns":function(e,i){var s=i&&i.sortBy("sequence").reduce(function(t,i){return t.concat([e.get(i.get("key"))])},[]);s=s?t.compact(s):e.models;var r=a();o(r,"dummy","dummy",{"type":"hidden"},{"type":"string"});var c=this.get("data");s.forEach(function(e){var t=e.get("column_key");if(!l[t]){var i=c&&c.search?c.search[t]:void 0,s=n(e,i);s&&o(r,t,s.data,s.options,s.schema)}});var d=a();o(d,"search",r.data,r.options,r.schema),this.set(d)}}),l={"favorite":"true","id":!0,"modify_date":!0,"size":!0,"type":!0};return r}),csui.define("conws/widgets/relatedworkspaces/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/relatedworkspaces/impl/nls/root/lang",{"dialogTitle":"Related workspaces","searchPlaceholder":"%1","noResultsPlaceholder":"No related workspaces to display.","errorFieldFormatTagUnrecognized":"Invalid format specification for {0}.","ToolbarItemAddRelation":"Add relationships","ToolbarItemAddRelationSubmit":"Add relationships","ToolbarItemRemoveRelation":"Remove relationships"}),csui.define("conws/widgets/relatedworkspaces/addrelatedworkspaces.search",["csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/controls/toolbar/toolitems.factory","conws/utils/overlay/conwsoverlay","csui/widgets/search.results/search.results.view","conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchresult.model","conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchform.model","csui/utils/contexts/factories/search.query.factory","i18n!conws/widgets/relatedworkspaces/impl/nls/lang"],function(e,t,i,s,o,n,a,r,l,c){var d=t.Controller.extend({"constructor":function(){t.Controller.prototype.constructor.apply(this,arguments);var o=this.options.status,d=e.extend(!0,{},o.collection.options.query);d.where_workspace_type_ids=encodeURIComponent("{"+d.where_workspace_type_id+"}"),d.where_rel_type=d.where_relationtype,delete d.where_workspace_type_id,delete d.where_relationtype;var p=new l(o.context).property,u=new a([],{"node":o.collection.node,"query":d,"search":p,"connector":o.collection.connector,"autofetch":!0,"autoreset":!0,"stateEnabled":!0,"columns":o.collection.columns,"workspace":o.collection.workspace,"orderBy":o.collection.orderBy}),h=o.originatingView.tableColumns&&o.originatingView.tableColumns.deepClone(),m=new r({},{"columns":u.columns,"tableColumns":h}),g=new s({"main":[{"signature":this.options.signature,"commandData":{"submit":!0},"name":c.ToolbarItemAddRelationSubmit}]},{"maxItemsShown":1,"dropDownText":c.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),f={"otherToolbar":g,"inlineToolbar":[],"tableHeaderToolbar":g},w=new t.ItemView({"tagName":"div","template":i.compile('<span><h2 class="csui-custom-search-title">{{title}}</h2><span class="headerCount"/></span>')({"title":this.options.title})}),v=new n({"enableBackButton":!0,"enableSearchSettings":!1,"showFacetPanel":!1,"context":o.context,"query":p,"collection":u,"customSearchViewModel":m,"toolbarItems":f,"titleView":w,"tableColumns":h});v.on("render",function(){v.$el.addClass("conws-searchview")}),this.searchView=v},"show":function(){var e=new o({"presentationRoot":this.options.status.originatingView.$el.parent(),"presentationView":this.searchView});this.searchView.on("go:back",function(){e.close()}),this._overlay=e,this._overlay.show()},"close":function(){this._overlay.close()}});return d}),csui.define("conws/utils/workspaces/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/utils/workspaces/impl/nls/root/lang",{"errorCustomColumnConfigInvalid":"Invalid custom column configuration: {0}.","errorCustomColumnMissingBraces":"Missing curly braces in custom column configuration: {0}.","errorOrderByMustNotBeString":"Configuration 'orderBy' must be an object not a string.","errorOrderByMissingBraces":"Missing curly braces in 'orderBy' configuration.","errorFilteringFailed":"Filtering of result list failed. Please contact your administrator.","noWorkspacesFound":"No workspaces found.","selectedItemActionBarAria":"Action bar of selected items","ToolbarItemCloseExpandedView":"Close expanded view"}),csui.define("css!conws/utils/workspaces/workspaces",[],function(){}),csui.define("hbs!conws/utils/workspaces/error.template",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-workspaces-error content-tile">\r\n  <div class="conws-workspaces-error-icon-div">\r\n    <div class="conws-workspaces-error-icon-parent">\r\n      <div class="conws-workspaces-error-icon notification_error"></div>\r\n    </div>\r\n  </div>\r\n  <div class="conws-workspaces-message">'+this.escapeExpression((i=null!=(i=t.errorMessage||(null!=e?e.errorMessage:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"errorMessage","hash":{}}):i))+"</div>\r\n</div>"}});return i.registerPartial("conws_utils_workspaces_error.template",s),s}),csui.define("conws/utils/workspaces/workspaces.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/base","csui/controls/list/list.view","csui/utils/nodesprites","csui/behaviors/limiting/limiting.behavior","csui/behaviors/expanding/expanding.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/list/behaviors/list.view.keyboard.behavior","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/utils/contexts/factories/node","csui/controls/progressblocker/blocker","csui/dialogs/modal.alert/modal.alert","i18n!conws/utils/workspaces/impl/nls/lang","css!conws/utils/workspaces/workspaces","hbs!conws/utils/workspaces/error.template"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v){var b=t.config(),y=c.extend({"constructor":function(e,t){e=i.extend({"collapsedView":t},e),c.prototype.constructor.call(this,e,t),this.listenTo(t.options.context,"close:expanded",function(e){e.widgetView===this.expandedView&&this.dialog&&this.dialog.body&&this.dialog.body.currentView===e.widgetView&&this.dialog.destroy()})},"_expandOtherView":function(e){e===!1&&(this.expandedView.collapsedView=this.view,this.view.expandedView=this.expandedView);var t=c.prototype._expandOtherView.apply(this,arguments);return t},"_enableExpandingAgain":function(){var e=c.prototype._enableExpandingAgain.apply(this,arguments);return this.expandedView.collapsedView=void 0,this.view.expandedView=void 0,e}}),k=a.extend({"constructor":function(e){if(void 0===e||!e.context)throw new Error("Context required to create WorkspacesView");e.data||(e.data={}),a.prototype.constructor.apply(this,arguments),this.options.blockingParentView?m.delegate(this,this.options.blockingParentView):m.imbue(this),this.options.data.pageSize=b.defaultPageSize||30,this.configOptionsData=i.clone(e.data),this.lastFilterValue="",this.limit=0,this.listenTo(this.collection,"sync",this._renderWorkspaceTitleIcon),this.listenTo(this.collection,"error",this.handleError);var t=this.getContext().getObject(h,e.context.options);this.listenTo(t,"change:id",this._reset),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",function(){this.messageOnError=void 0,this.unblockActions.apply(this,arguments)}).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",function(){this.unblockActions.apply(this,arguments),this.messageOnError&&(g.showError(this.messageOnError),this.messageOnError=void 0)}),this.listenTo(this.collection,"request",this.destroyEmptyView),this.listenTo(this,"go:away",function(){var e=this.expandedView;e&&this.listenTo(e,"destroy",function(){e&&e.changed&&(this.collection.fetch(),e=void 0)})})},"getContext":function(){return this.options.context},"initialize":function(){this.collection=this.completeCollection},"onRender":function(){this._resetInfiniteScrolling(),a.prototype.onRender.call(this)},"onClickHeader":function(){this.triggerMethod("expand")},"_resetInfiniteScrolling":function(){this.collection.setLimit(0,this.options.data.pageSize,!1)},"templateHelpers":function(){return{"title":this._getTitle(),"imageUrl":this._getTitleIcon().src,"imageClass":"conws-workspacestitleicon","searchPlaceholder":this._getSearchPlaceholder()}},"childEvents":{"click:item":"onClickItem"},"onClickItem":function(e){this.triggerMethod("execute:defaultAction",e.model)},"className":function(){var e=this.viewClassName,t=this.options.data.workspaceType,s=i.result(a.prototype,"className");return t&&(e=e+" conws-workspacetype-"+t),s&&(e=e+" "+s),e},"_reset":function(){this.collection&&this.collection.resetLimit(),this.ui.searchInput&&""!==this.ui.searchInput.val()&&(this.collection&&this.collection.clearFilter(!1),this.ui.searchInput.val("")),this.ui.searchInput&&this.ui.searchInput.is(":visible")&&this.searchClicked(new CustomEvent(""))},"workspacesCollectionFactory":void 0,"workspacesTableView":void 0,"viewClassName":void 0,"dialogClassName":void 0,"lang":void 0,"behaviors":{"LimitedList":{"behaviorClass":l,"limit":function(){return this.limit},"completeCollection":function(){return this.getContext().getCollection(this.workspacesCollectionFactory,{"attributes":this._getCollectionAttributes(),"options":this._getCollectionOptions()})}},"ExpandableList":{"behaviorClass":y,"expandedView":function(){return this.workspacesTableView},"expandedViewOptions":function(){return this._getExpandedViewOptions()},"dialogTitle":function(){return this._getTitle()},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":function(){return"conwsworkspacestable"+(this.dialogClassName?" "+this.dialogClassName:"")},"titleBarImageUrl":function(){return this._getTitleIcon().src},"titleBarImageClass":function(){return this._getTitleIcon().cssClass||"conws-workspacestitleicon"}},"InfiniteScrolling":{"behaviorClass":u,"contentParent":".tile-content","fetchMoreItemsThreshold":80},"TabableRegion":{"behaviorClass":d},"ListViewKeyboardBehavior":{"behaviorClass":p}},"_getCollectionOptions":function(){return{"query":this._getCollectionUrlQuery()}},"_getExpandedViewOptions":function(){return{"data":i.clone(this.configOptionsData)}},"filterChanged":function(e){e&&"keyup"===e.type&&27===e.keyCode&&this.searchClicked();var t=this.ui.searchInput.val();this.lastFilterValue!==t&&(this.lastFilterValue=t,this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(e){e.filterTimeout=void 0,e._resetInfiniteScrolling(),e.collection.reset();var i;e._getFilterPropertyName&&(i=e._getFilterPropertyName());var s={};s[i||"name"]=t,e.collection.setFilter(s,{"fetch":!1})&&(e.messageOnError=f.errorFilteringFailed,e.collection.fetch())},1e3,this))},"_getTitleIcon":function(){var e={"src":"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==","cssClass":void 0};return this.collection&&this.collection.titleIcon?e.src=this.collection.titleIcon:this.collection&&null===this.collection.titleIcon&&(e.cssClass="conws-workspacestitleicondefault conws-mime_workspace"),e},"_renderWorkspaceTitleIcon":function(){var e=this.$el.find(".tile-type-image")[0],t=e&&this.$el.find(".tile-type-image").find("img")[0];if(t){var i=this._getTitleIcon();o(t).attr("src")!==i.src&&o(t).attr("src",i.src),i.cssClass&&o(t).attr("class")!==i.cssClass&&o(t).attr("class",i.cssClass)}},"_getTitle":function(){var e=this.lang.dialogTitle;return this.options.data.title&&(e=n.getClosestLocalizedString(this.options.data.title,this.lang.dialogTitle)),e},"_getSearchPlaceholder":function(){return this.lang.searchPlaceholder.replace("%1",this._getTitle())},"_getNoResultsPlaceholder":function(){var e=this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.noResultsPlaceholder;return e=e?n.getClosestLocalizedString(e,this.lang.noResultsPlaceholder):this.lang.noResultsPlaceholder},"collectionEvents":{"reset":"onCollectionSync"},"onCollectionSync":function(){this.synced=!0},"isEmpty":function(){return this.synced&&0===this.collection.models.length},"handleError":function(){if(this.collection.error&&this.collection.error.message){var e=v.call(this,{"errorMessage":this.collection.error.message});
this.$el.find(".tile-content").append(e)}}});return k}),csui.define("hbs!conws/utils/previewpane/impl/previewheader",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'    <span class="conws-preview-header-typename">'+this.escapeExpression((i=null!=(i=t.typeName||(null!=e?e.typeName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"typeName","hash":{}}):i))+"</span>\r\n"},"3":function(e,t){var i;return'    <a class="csui-icon conws-quick_link conws-preview-header-icon"\r\n       title="'+this.escapeExpression((i=null!=(i=t.quickLinkTooltip||(null!=e?e.quickLinkTooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"quickLinkTooltip","hash":{}}):i))+'"\r\n       href="'+this.escapeExpression((i=null!=(i=t.display_url||(null!=e?e.display_url:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"display_url","hash":{}}):i))+'" target="_blank"></a>\r\n'},"5":function(e,t){var i;return'  <a class="conws-preview-header-title narrow" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'"\r\n     href="'+this.escapeExpression((i=null!=(i=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"defaultActionUrl","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</a>\r\n"},"7":function(e,t){var i;return'  <a class="conws-preview-header-title" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'"\r\n     href="'+this.escapeExpression((i=null!=(i=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"defaultActionUrl","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</a>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return"<div>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.typeName:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.display_url:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+"</div>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.display_url:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?o:"")+"\r\n"}});return i.registerPartial("conws_utils_previewpane_impl_previewheader",s),s}),csui.define("conws/utils/previewpane/impl/previewheader.view",["csui/lib/underscore","csui/lib/marionette","csui/lib/numeral","csui/lib/moment","csui/lib/handlebars","csui/behaviors/default.action/default.action.behavior","i18n","hbs!conws/utils/previewpane/impl/previewheader","css!conws/utils/icons/icons"],function(e,t,i,s,o,n,a,r){var l=t.ItemView.extend({"constructor":function(){t.ItemView.apply(this,arguments)},"className":"preview-header","template":r,"templateHelpers":function(){return{"defaultActionUrl":n.getDefaultActionNodeUrl(this.model)}}});return l}),csui.define("hbs!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return'      <div class="conws-modal-dialog dialog-header"></div>\r\n'},"3":function(){return'      <div class="conws-modal-dialog dialog-body"></div>\r\n'},"5":function(){return'      <div class="conws-modal-dialog dialog-footer"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="binf-modal-dialog conws-modal-dialog '+this.escapeExpression((n=null!=(n=t.modalClassName||(null!=e?e.modalClassName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"modalClassName","hash":{}}):n))+'">\r\n  <div class="binf-modal-content">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.existsHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.existsBody:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.existsFooter:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?o:"")+"  </div>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_modaldialog_impl_modal.dialog.view",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabables.behavior","hbs!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view","css!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view"],function(e,t,i,s,o,n){var a=s.Region.extend({"constructor":function(){s.Region.prototype.constructor.apply(this,arguments)},"attachHtml":function(e){this.el.appendChild(e.el)}}),r=s.LayoutView.extend({"className":"cs-dialog binf-modal binf-fade conws-modal-dialog-parent","attributes":{"tabindex":"-1","role":"dialog","aria-hidden":"true"},"template":n,"templateHelpers":function(){return{"existsHeader":!e.isUndefined(this.options.header),"existsBody":!e.isUndefined(this.options.body),"existsFooter":!e.isUndefined(this.options.footer),"modalClassName":this.options.modalClassName}},"behaviors":{"TabablesBehavior":{"behaviorClass":o,"recursiveNavigation":!0,"containTabFocus":!0}},"ui":{"header":".dialog-header","body":".dialog-body","footer":".dialog-footer"},"regions":{"header":".dialog-header","body":".dialog-body","footer":".dialog-footer"},"events":{"keydown":"onKeyDown","hidden.binf.modal":"onHidden","shown.binf.modal":"onShown"},"constructor":function(){s.LayoutView.prototype.constructor.apply(this,arguments)},"show":function(){var e=t.fn.binf_modal.getDefaultContainer?t.fn.binf_modal.getDefaultContainer():document.body,i=new a({"el":e});return i.show(this),this},"destroy":function(){return this.$el.is(":visible")?this.$el.binf_modal("hide"):r.__super__.destroy.apply(this,arguments),t("body").addClass("binf-modal-open"),this},"kill":function(){return r.__super__.destroy.apply(this,arguments),!0},"onRender":function(){this.options.dialogTxtAria&&this.$el.attr({"aria-label":this.options.dialogTxtAria}),this.options.body&&this.body.show(this.options.body)},"onShow":function(){this.$el.binf_modal({"backdrop":"static","keyboard":!1})},"onKeyDown":function(e){27===e.keyCode&&"filtersearch"!==e.target.id&&this.destroy()},"onHidden":function(){this.destroy()},"onShown":function(){this.options.body&&(this.options.body.triggerMethod("dom:refresh"),this.options.body.triggerMethod("after:show"))}});return r}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/role",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<span style="white-space:pre" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</span>"}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_role",s),s}),csui.define("conws/widgets/team/impl/controls/rolepicker/impl/role.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!conws/widgets/team/impl/controls/rolepicker/impl/role"],function(e,t,i,s){var o=i.ItemView.extend({"tagName":"span","template":s,"templateHelpers":function(){return{"name":this.model.get("name")}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)}});return o}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="search-input"></div>\r\n<div class="search-clear"></div>\r\n<div class="typeahead cs-search-icon icon-caret-down"\r\n     title="'+this.escapeExpression((i=null!=(i=t.showValues||(null!=e?e.showValues:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showValues","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.showValues||(null!=e?e.showValues:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showValues","hash":{}}):i))+'">\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_rolepicker",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.clear",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="typeahead cs-search-clear csui-icon formfield_clear" style=""\r\n     title="'+this.escapeExpression((i=null!=(i=t.clearValue||(null!=e?e.clearValue:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"clearValue","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.clearValue||(null!=e?e.clearValue:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"clearValue","hash":{}}):i))+'">\r\n</div>'}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_rolepicker.clear",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.input",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<input class="typeahead binf-form-control cs-search" type="search" placeholder="'+this.escapeExpression((i=null!=(i=t.placeholder||(null!=e?e.placeholder:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"placeholder","hash":{}}):i))+'">\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_rolepicker.input",s),s}),csui.define("css!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker",[],function(){}),csui.define("conws/widgets/team/impl/controls/rolepicker/rolepicker.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/controls/rolepicker/impl/role.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker","hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.clear","hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.input","css!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker","csui/lib/bootstrap3-typeahead"],function(e,t,i,s,o,n,a,r,l,c,d){var p=i.ItemView.extend({"template":d,"templateHelpers":function(){return{"placeholder":this.options.placeholder}},"ui":{"searchbox":".typeahead.cs-search"},"events":{"keydown @ui.searchbox":"onKeyDown","keyup @ui.searchbox":"onKeyUp","dragstart .typeahead.binf-dropdown-menu li > a":"onDragRole"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"triggers":{"click @ui.searchbox":"click","focus @ui.searchbox":"focus"},"constructor":function(e){e||(e={}),e.delay||(e.delay=200),e.minLength||(e.minLength=0),e.placeholder||(e.placeholder=r.addParticipantsRolePickerPlaceholder),e.roles||(e.roles=[]),e.prettyScrolling||(e.prettyScrolling=!1),void 0===e.showInherited&&(e.showInherited=!0),e.roles.comparator=function(e,t){return s.localeCompareString(e.get("name"),t.get("name"))},e.roles.sort(),this.rolePicked=!0,i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(e.view,"clearInput",this.clear)},"onRender":function(){this.$("input.typeahead").typeahead({"items":"all","afterSelect":e.bind(this._afterSelect,this),"highlighter":e.bind(this._renderHighlighter,this),"delay":this.options.delay,"displayText":this._retrieveDisplayText,"matcher":this._matcher,"afterHide":e.bind(this._afterHide,this),"nextHighlighter":e.bind(this._nextHighlighter,this),"accessbility":e.bind(this._accessbility,this),"currentHighlighter":e.bind(this._currentHighlighter,this),"sorter":this._sorter,"minLength":this.options.minLength,"source":e.bind(this._source,this),"prettyScrolling":this.options.prettyScrolling,"appendTo":this.$el}),this.ui.searchbox.append(this.options.$el)},"onClick":function(){this.ui.searchbox.trigger("focus"),this.ui.searchbox.typeahead("lookup",this.ui.searchbox.val())},"onKeyUp":function(e){var t=this.ui.searchbox.val();0!==t.length||13!==e.keyCode&&32!==e.keyCode&&46!==e.keyCode?(this.rolePicked=!0,this.options.view.filterLength=this.ui.searchbox.val().length,this.options.view.trigger("updateStyles")):this.rolePicked=!1},"onKeyDown":function(e){9===e.keyCode&&(this.options.view.filterLength=this.ui.searchbox.val().length,this.options.view.trigger("updateStyles"),this.ui.searchbox.typeahead("hide"))},"onDragRole":function(){return!1},"isTabable":function(){return t(this.ui.searchbox).is(":not(:disabled)")&&t(this.ui.searchbox).is(":not(:hidden)")&&t(this.ui.searchbox).is(":visible")},"clear":function(){this.ui.searchbox.val(""),this.ui.searchbox.trigger("focus"),this.ui.searchbox.typeahead("lookup",this.ui.searchbox.val())},"currentlyFocusedElement":function(){return this.ui.searchbox},"_source":function(){var e=[];return this.rolePicked&&void 0!==this.options.roles&&(e=this.options.showInherited?this.options.roles.models:this.options.roles.filter(function(e){return!e.get("inherited_from_id")})),e},"_matcher":function(e){var t=e.get("name");return~t.toLowerCase().indexOf(this.query.toLowerCase())},"_sorter":function(e){return e},"_retrieveDisplayText":function(e){return e.get("name")},"_afterSelect":function(e){this.ui.searchbox.val(""),this.options.view.filterLength=this.ui.searchbox.val().length,this.options.view.trigger("updateStyles"),this.options.view.trigger("item:change",{"item":e})},"_renderHighlighter":function(e){var t=this.options.roles.findWhere({"name":e}),i=new a({"model":t,"connector":this.options.roles.connector});return i.render().el},"_afterHide":function(){},"_currentHighlighter":function(){},"_nextHighlighter":function(){},"_accessbility":function(){}}),u=i.ItemView.extend({"template":c,"templateHelpers":function(){return{"clearValue":r.addParticipantsRolePickerClear}},"ui":{"searchclear":".typeahead.cs-search-clear"},"events":{"click @ui.searchclear":"onClickClear","keyup @ui.searchclear":"onClearKeyUp"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(e.view,"updateStyles",this.updateStyles)},"onClickClear":function(){this.updateStyles(),this.options.view.trigger("clearInput")},"onClearKeyUp":function(e){(13===e.keyCode||32===e.keyCode)&&(this.updateStyles(),this.options.view.trigger("clearInput"))},"updateStyles":function(){var e=this.options.view.filterLength>0;this.ui.searchclear.css({"display":e?"":"none"}).attr("tabindex",0)},"isTabable":function(){return t(this.ui.searchclear).is(":not(:disabled)")&&t(this.ui.searchclear).is(":not(:hidden)")&&t(this.ui.searchclear).is(":visible")},"currentlyFocusedElement":function(){return this.ui.searchclear}}),h=i.LayoutView.extend({"tagName":"div","className":"conws-control-rolepicker","template":l,"templateHelpers":function(){return{"showValues":r.addParticipantsRolePickerShow}},"ui":{"rolepicker":"div.conws-control-rolepicker","searchicon":".typeahead.cs-search-icon","searchbox":".search-input","searchclear":".search-clear"},"regions":{"searchRegion":"@ui.searchbox","clearRegion":"@ui.searchclear"},"triggers":{"click @ui.searchicon":"click"},"constructor":function(e){e||(e={}),this.filterLength=0,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"updateFocus",this.updateFocus),this.propagateEventsToRegions()},"onRender":function(){var e=this.searchView;e?this.searchRegion.show(e):(e=this.searchView=new p(t.extend({},this.options,{"view":this})),this.searchRegion.show(e)),this.clearView=new u(t.extend({},this.options,{"view":this})),this.clearRegion.show(this.clearView),this.clearView.updateStyles()},"onClick":function(){this.updateFocus(),this.searchView.$("input.typeahead").typeahead("lookup",this.ui.searchbox.val())},"updateFocus":function(){this.searchView.currentlyFocusedElement().trigger("focus")}});return e.extend(h.prototype,n),h}),csui.define("conws/widgets/team/impl/behaviors/list.keyboard.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette"],function(e,t,i,s){var o=s.Behavior.extend({"defaults":{"currentlyFocusedElementSelector":"li:nth-child({0})"},"constructor":function(e,i){s.Behavior.prototype.constructor.apply(this,arguments),t.extend(i,{"selectedIndex":0,"onKeyDown":function(e){var t=this.currentlyFocusedElement();switch(e.keyCode){case 38:this._moveTo(e,this._selectPrevious(),t);break;case 40:this._moveTo(e,this._selectNext(),t)}},"_moveTo":function(e,i,s){e.preventDefault(),e.stopPropagation(),setTimeout(t.bind(function(){s&&s.prop("tabindex","-1"),i.prop("tabindex","0"),i.trigger("focus")},this),50)},"_selectNext":function(){var e=this.model||this.collection;return this.selectedIndex<e.length-1&&this.selectedIndex++,this.currentlyFocusedElement()},"_selectPrevious":function(){return this.selectedIndex>0&&this.selectedIndex--,this.currentlyFocusedElement()},"currentlyFocusedElementSelector":this.options.currentlyFocusedElementSelector,"currentlyFocusedElement":function(){var e=this.model||this.collection;0!==this.selectedIndex&&this.selectedIndex>=e.length&&(this.selectedIndex=e.length-1);var i=this.$(t.str.sformat(this.currentlyFocusedElementSelector,this.selectedIndex+1)),s=0!==i.length?this.$(i[0]):null;return s}})}});return o}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="binf-alert binf-alert-success binf-alert-dismissible">\r\n  <strong title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'</strong>\r\n  <div class="remove binf-alert-close binf-close" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"\r\n       title="'+this.escapeExpression((i=null!=(i=t.removeRole||(null!=e?e.removeRole:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"removeRole","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.removeRole||(null!=e?e.removeRole:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"removeRole","hash":{}}):i))+'"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.roles",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/url","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles","css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles"],function(e,t,i,s,o,n,a,r){var l=i.ItemView.extend({"tagName":"li","template":r,"templateHelpers":function(){return{"removeRole":a.rolesDialogRemoveRole,"name":this.model.get("name"),"id":this.model.get("id")}},"events":{"click .remove":"onRemoveOnClick","keydown .binf-alert":"onRemoveOnKeyDown"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"onRemoveOnClick":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("remove:role",{"model":this.model})},"onRemoveOnKeyDown":function(e){(13===e.keyCode||32===e.keyCode||46===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.triggerMethod("remove:role",{"model":this.model}))}}),c=i.CollectionView.extend({"tagName":"ul","childView":l,"events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":s},"ListKeyboard":{"behaviorClass":n,"currentlyFocusedElementSelector":"li:nth-child({0}) .binf-alert"}},"constructor":function(){i.CollectionView.prototype.constructor.apply(this,arguments)},"onAddChild":function(){this.triggerMethod("refresh:tabindexes")},"onRemoveChild":function(){this.triggerMethod("refresh:tabindexes")}});return c}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="participant-content binf-pull-left"></div>\r\n<div class="participant-roles binf-pull-left"></div>\r\n<div class="participant-delete binf-pull-right"></div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem",s),s}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.roles",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="participant-roles-list">\r\n  <!-- role items -->\r\n</div>\r\n<div class="conws-participants-rolepicker">\r\n  <!-- roles picker region -->\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem.roles",s),s}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.delete",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<span class="remove csui-icon cs-icon-delete" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"\r\n      title="'+this.escapeExpression((i=null!=(i=t.removeParticipant||(null!=e?e.removeParticipant:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"removeParticipant","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.removeParticipant||(null!=e?e.removeParticipant:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"removeParticipant","hash":{}}):i))+'"></span>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem.delete",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/utils/url","csui/utils/contexts/factories/user","esoc/widgets/userwidget/userwidget","conws/widgets/team/impl/controls/avatar/avatar.view","conws/widgets/team/impl/controls/rolepicker/rolepicker.view","conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.details","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.roles","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.delete","css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g){var f=i.ItemView.extend({"template":h,"templateHelpers":function(){return{"type":this.model.getMemberType(),"name":this.model.displayName(),"email":this.model.displayEmail(),"title":this.model.displayTitle(),"department":this.model.displayDepartment(),"office":this.model.displayOffice()}},"ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.avatar=new l({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.workspaceContext.getModel(a),t={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.workspaceContext,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id"),"placeholder":this.$el.find(".participant-picture"),"showUserWidgetFor":"profilepic"};r.getUser(t)}else this.$(".participant-picture").append(this.avatar.render().$el)}}),w=i.LayoutView.extend({"regions":{"rolesListRegion":".participant-roles-list","rolePickerRegion":".conws-participants-rolepicker"},"template":m,"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"onRender":function(){var e=new d({"collection":this.model.roles});this.rolesListRegion.show(e),this.listenTo(e,"childview:remove:role",this.onRoleItemRemove);var t=new c({"placeholder":p.addParticipantsRolePickerPlaceholderMore,"roles":this.model.collection.roles,"showInherited":!1,"prettyScrolling":!0});this.rolePickerRegion.show(t),this.listenTo(t,"item:change",this.onRoleItemChanged)},"onRoleItemChanged":function(e){this.model.roles.add(e.item)},"onRoleItemRemove":function(e,t){this.model.roles.remove(t.model),0===this.model.roles.length&&this.rolePickerRegion.currentView.trigger("updateFocus")}}),v=i.ItemView.extend({"template":g,"templateHelpers":function(){return{"removeParticipant":p.addParticipantsRemove}},"events":{"click .remove":"onRemoveOnClick","keydown .remove":"onRemoveOnKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":s}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"onRemoveOnClick":function(e){e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model)},"onRemoveOnKeyDown":function(e){(13===e.keyCode||32===e.keyCode||46===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model))},"currentlyFocusedElement":function(){return this.$(".remove")}}),b=i.LayoutView.extend({"template":u,"tagName":"li","className":"binf-list-group-item conws-participant","regions":{"content":".participant-content","roles":".participant-roles","delete":".participant-delete"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this.model.roles,"reset remove add",this.onParticipantRolesChanged),this.listenTo(this.model,"remove",this.onParticipantRemove),this.propagateEventsToRegions()},"onRender":function(){this.content.show(new f({"model":this.model})),this.roles.show(new w({"model":this.model})),this.delete.show(new v({"model":this.model})),this.applyRolesStyle(),this.applyRolesHeight(!0)},"onParticipantRemove":function(){this._parent.selectedIndex=this._index},"onParticipantRolesChanged":function(t,i,s){this.model.collection.trigger("change",this.model.collection),this.applyRolesStyle();var o=e.isUndefined(s.index);this.applyRolesHeight(o)},"applyRolesStyle":function(){0!==this.model.roles.length?(this.$el.addClass("has-role"),this.$el.removeClass("no-role")):(this.$el.addClass("no-role"),this.$el.removeClass("has-role"))},"applyRolesHeight":function(e){var t=this.$el.outerHeight()-this.$el.height(),i=this.$(".conws-participants-rolepicker .cs-search").outerHeight(),s=this.$(".participant-roles-list").outerHeight(),o=this.model.roles.length;o>1?s=s/(e?o-1:o+1)*o:1===o&&(s=s/(e?o:o+1)*o),this.$el.height(i+s+t/2)}});return e.extend(w.prototype,o),e.extend(b.prototype,o),b}),csui.define("hbs!conws/widgets/team/impl/controls/footer/impl/footer",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="conws-roles-edit-buttons binf-modal-footer">\r\n  <span class="conws-roles-edit-reset-region"></span>\r\n  <span class="conws-roles-edit-save-region"></span>\r\n  <span class="conws-roles-edit-cancel-region"></span>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_footer_impl_footer",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/footer/impl/button",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return"disabled"},"3":function(){return'data-binf-dismiss="modal"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<button class="binf-btn binf-btn-default btn-footer '+this.escapeExpression((n=null!=(n=t.css||(null!=e?e.css:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"css","hash":{}}):n))+'" '+(null!=(o=t["if"].call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+" "+(null!=(o=t["if"].call(e,null!=e?e.close:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+" >"+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</button>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_footer_impl_button",s),s}),csui.define("css!conws/widgets/team/impl/controls/footer/impl/footer",[],function(){}),csui.define("conws/widgets/team/impl/controls/footer/footer.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","hbs!conws/widgets/team/impl/controls/footer/impl/footer","hbs!conws/widgets/team/impl/controls/footer/impl/button","css!conws/widgets/team/impl/controls/footer/impl/footer"],function(e,t,i,s,o,n,a,r){var l=i.ItemView.extend({"tagName":"span","templateHelpers":function(){return{"label":this.model.get("label"),"css":this.model.get("css"),"disabled":this.model.get("disabled"),"close":this.model.get("close")}},"template":r,"ui":{"button":".btn-footer"},"events":{"click @ui.button":"onClick"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"onClick":function(t){var i=this.model.get("click");i&&e.isFunction(i)&&i(t)},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"isTabable":function(){return t(this.ui.button).is(":enabled")},"currentlyFocusedElement":function(){return this.ui.button}}),c=i.LayoutView.extend({"regions":{"resetRegion":".conws-roles-edit-reset-region","submitRegion":".conws-roles-edit-save-region","cancelRegion":".conws-roles-edit-cancel-region"},"template":a,"constructor":function(e){this.buttons=e.collection.models,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"updateButton",this.updateButton),this.propagateEventsToRegions()},"onRender":function(){var t=this;e.each(this.buttons,function(e){"reset"===e.id?(t.resetView=new l({"model":e,"initialActivationWeight":e.get("initialActivationWeight")}),t.resetRegion.show(t.resetView)):"submit"===e.id?(t.submitView=new l({"model":e,"initialActivationWeight":e.get("initialActivationWeight")}),t.submitRegion.show(t.submitView)):"cancel"===e.id&&(t.cancelView=new l({"model":e,"initialActivationWeight":e.get("initialActivationWeight")}),t.cancelRegion.show(t.cancelView))
})},"updateButton":function(){var t=this;e.each(t.collection.models,function(e){e.get("disabled")||("submit"===e.id?t.submitView.currentlyFocusedElement().focus():"cancel"===e.id?t.cancelView.currentlyFocusedElement().focus():"reset"===e.id&&t.resetView.currentlyFocusedElement().focus())})}});return e.extend(c.prototype,n),c}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="binf-modal-content">\r\n  <div class="binf-modal-header">\r\n    <h4 class="binf-modal-title">'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'</h4>\r\n    <div class="conws-addparticipants-search">\r\n      <div class="conws-addparticipants-userpicker">\r\n        <!-- user picker region -->\r\n      </div>\r\n      <div>\r\n        <div class="conws-addparticipants-rolepicker">\r\n          <!-- roles picker region -->\r\n        </div>\r\n        <div class="conws-addparticipants-rolepicker-help">'+this.escapeExpression((i=null!=(i=t["roles-help"]||(null!=e?e["roles-help"]:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"roles-help","hash":{}}):i))+'</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="binf-modal-body">\r\n    <div class="conws-addparticipants-members"></div>\r\n  </div>\r\n  <div class="conws-addparticipants-buttons">\r\n    <!-- button bar region -->\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_addparticipants",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/addparticipants/addparticipants.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/dialogs/modal.alert/modal.alert","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/participant.model","conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.view","conws/widgets/team/impl/controls/rolepicker/rolepicker.view","conws/widgets/team/impl/controls/footer/footer.view","csui/controls/userpicker/userpicker.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants","css!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f){var w=s.CollectionView.extend({"tagName":"ul","className":"binf-list-group","childView":p,"constructor":function(e){s.CollectionView.call(this,e),this.listenTo(this,"moveTabIndex",this.moveTabIndex)},"moveTabIndex":function(e){this.children.each(function(t){e.children.length===e.selectedIndex&&(e.selectedIndex=e.children.length-1),t._index===e.selectedIndex&&t.roles.currentView.rolePickerRegion.currentView.trigger("updateFocus")})}}),v=s.LayoutView.extend({"template":f,"regions":{"userPickerRegion":".conws-addparticipants-userpicker","rolePickerRegion":".conws-addparticipants-rolepicker","buttonsRegion":".conws-addparticipants-buttons","participantsRegion":".conws-addparticipants-members"},"templateHelpers":{"title":g.addParticipantsTitle,"roles-help":g.addParticipantsRolesHelp},"constructor":function(e){e||(e={}),this.view=e.view,this.context=e.view.context,this.connector=e.view.context.getObject(n,e.view),e.workspaceContext||(e.workspaceContext=e.view.context.getObject(c)),this.workspaceContext=e.workspaceContext,this.teamRoles=e.view.roleCollection.clone(),this.teamParticipants=e.view.participantCollection,this.listenTo(this.view,"destroy",this.close),this.buttonsModel=void 0,s.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"onRender":function(){var t=new m({"context":this.workspaceContext,"limit":20,"clearOnSelect":!0,"placeholder":g.addParticipantsUserPickerPlaceholder,"disabledMessage":g.addParticipantsDisabledMemberMessage,"onRetrieveMembers":e.bind(this.retrieveMembersCallback,this),"prettyScrolling":!0,"initialActivationWeight":100});this.userPickerRegion.show(t),t.$(".cs-search-icon").attr("aria-label",g.addParticipantsSearchAria),this.listenTo(t,"item:change",this.onUserItemChanged);var s=new u({"roles":this.teamRoles,"showInherited":!1,"prettyScrolling":!0});this.rolePickerRegion.show(s),this.listenTo(s,"item:change",this.onRoleItemChanged);var n=new w({"context":this.options.workspaceContext,"collection":e.extend(new i.Collection,{"workspaceContext":this.workspaceContext,"node":this.workspaceContext.getModel(a),"roles":this.teamRoles,"comparator":function(e,t){return o.localeCompareString(e.get("display_name"),t.get("display_name"))}})});this.participantsRegion.show(n),this.participants=n.collection,this.listenTo(this.participants,"reset add change",this.onParticipantsChanged),this.listenTo(this.participants,"remove",this.onParticipantsRemove),this.buttonModel=new i.Collection([{"id":"reset","label":g.addParticipantsButtonClear,"css":"clear binf-pull-left","click":e.bind(this.onClickClear,this),"disabled":!0,"close":!1},{"id":"submit","label":g.addParticipantsButtonSave,"css":"save","click":e.bind(this.onClickSave,this),"disabled":!0,"close":!0},{"id":"cancel","label":g.addParticipantsButtonCancel,"css":"cancel","disabled":!1,"close":!0}]),this.buttonsRegion.show(new h({"collection":this.buttonModel}))},"onUserItemChanged":function(t){if(!t.item.get("disabled")){var s=e.extend(t.item.attributes,{"display_name":t.item.get("name_formatted")}),n=new d(s,{"connector":this.connector,"collection":this.participants});n.roles=new i.Collection(void 0,{"comparator":function(e,t){return o.localeCompareString(e.get("name"),t.get("name"))}}),this.participants.add(n)}},"retrieveMembersCallback":function(e){var t=this;e.collection.each(function(e){var i=!1;t.teamParticipants.findWhere({"id":e.get("id")})?i=!0:t.participants.findWhere({"id":e.get("id")})&&(i=!0),e.set("disabled",i)})},"onRoleItemChanged":function(e){this.participants.each(function(t){t.roles.add(e.item)})},"onClickSave":function(){var e=this,t=!1,i=this.participants.length;this.participants.each(function(s){e.teamParticipants.addNewParticipant(s),s.save({"add":s.roles.models},{"success":function(){0===--i&&e.refreshAfterSave(t)},"error":function(){t=!0,0===--i&&e.refreshAfterSave(t)}})})},"refreshAfterSave":function(e){function t(){i.teamParticipants.trigger("saved",i.teamParticipants)}var i=this;e===!0&&l.showError(g.addParticipantsErrorMessageDefault),i.teamParticipants.fetch({"success":function(){i.teamParticipants.setNewParticipant()}}).then(t,t)},"onClickClear":function(){this.participants.reset(),this.userPickerRegion.currentView.currentlyFocusedElement().focus(),this.updateScrollbar()},"onParticipantsRemove":function(){this.onParticipantsChanged(),this.participants&&this.participants.length>0?this.participantsRegion.currentView.trigger("moveTabIndex",this.participantsRegion.currentView):this.userPickerRegion.currentView.currentlyFocusedElement().focus()},"onParticipantsChanged":function(){var e=0===this.participants.length,t=0===this.participants.length;this.participants.each(function(e){(void 0===e.roles||0===e.roles.length)&&(t=!0)}),this.buttonModel.get("reset").set("disabled",e),this.buttonModel.get("submit").set("disabled",t),this.$el.find(".conws-addparticipants-members").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15})},"updateScrollbar":function(){var i=this.$el.find(".conws-addparticipants-members");e.each(i,function(e){t(e).perfectScrollbar("update")})}});return e.extend(v.prototype,r),v}),csui.define("conws/utils/commands/addparticipant",["csui/lib/underscore","csui/models/command","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","conws/widgets/team/impl/dialogs/addparticipants/addparticipants.view","i18n!conws/utils/commands/nls/commands.lang","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,s,o,n){var a=t.extend({"defaults":{"signature":"AddParticipant","name":o.CommandNameAddParticipant,"scope":"multiple"},"constructor":function(e){e||(e={}),this.roles=e.roles,t.prototype.constructor.apply(this,arguments)},"enabled":function(){var t=!1;if(this.roles){var i=this.roles.filter(function(t){return t.get("actions").actionEdit&&e.isNull(t.get("inherited_from_id"))});t=0!==i.length}return t},"execute":function(e){var t=new i({"dialogTxtAria":n.addParticipantsTitle,"body":new s({"view":e.originatingView}),"modalClassName":"conws-addparticipants"});t.show()}});return a}),csui.define("conws/utils/commands/export",["csui/lib/underscore","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i){var s=t.extend({"defaults":{"signature":"Export","name":i.CommandNameExport,"scope":"multiple"},"constructor":function(){t.prototype.constructor.call(this,arguments)},"enabled":function(e){return e&&e.nodes&&e.nodes.length>0?!0:!1},"execute":function(e){var t="export.csv",i=this._export(e.nodes.models);this._download(i,t)},"_exportHeader":function(){var e="";return e},"_exportModel":function(){var e="";return e},"_export":function(t){var i=this,s=this._exportHeader()+"\n";return e.each(t,function(e){s+=i._exportModel(e)+"\n"}),s},"_download":function(e,t){var i=new Blob([e],{"type":"text/csv"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,t);else{var s=document.createElement("a");s.download=t,s.innerHTML="Download File","webkitURL"in window?s.href=window.webkitURL.createObjectURL(i):(s.href=window.URL.createObjectURL(i),s.style.display="none",s.onclick=function(e){document.body.removeChild(e.target)},document.body.appendChild(s)),s.click()}}});return s}),csui.define("conws/widgets/team/impl/commands/exportparticipants",["csui/lib/underscore","conws/utils/commands/export","i18n!conws/utils/commands/nls/commands.lang","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,s){var o=t.extend({"defaults":{"signature":"ExportParticipants","name":i.CommandNameExportParticipants,"scope":"multiple"},"constructor":function(){t.prototype.constructor.call(this,arguments)},"_exportHeader":function(){var e="";return e+='"'+s.participantNameColTitle.replace(/"/g,'""')+'";',e+='"'+s.participantRolesColTitle.replace(/"/g,'""')+'";',e+='"'+s.participantLoginColTitle.replace(/"/g,'""')+'";',e+='"'+s.participantEmailColTitle.replace(/"/g,'""')+'";',e+='"'+s.participantDepartmentColTitle.replace(/"/g,'""')+'";'},"_exportModel":function(e){var t='"';return t+=e.get("display_name")?e.get("display_name").replace(/"/g,'""'):e.get("name").replace(/"/g,'""'),t+='";"'+e.getLeadingRole().replace(/"/g,'""')+" "+e.getRolesIndicator().replace(/"/g,'""'),t+='";"',t+=e.get("name")?e.get("name").replace(/"/g,'""'):"",t+='";"',t+=e.get("business_email")?e.get("business_email").replace(/"/g,'""'):"",t+='";"',t+=e.get("group_name")?e.get("group_name").replace(/"/g,'""'):"",t+='";'}});return o}),csui.define("conws/utils/commands/showroles",["csui/lib/underscore","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i){var s=t.extend({"defaults":{"signature":"ShowRoles","name":i.CommandNameShowRoles,"scope":"single"},"enabled":function(e){return e&&e.nodes&&1===e.nodes.length?!0:!1},"execute":function(){throw new Error("The '"+this.get("signature")+"' action must be handled by the caller.")}});return s}),csui.define("conws/utils/commands/removeparticipant",["csui/lib/underscore","csui/dialogs/modal.alert/modal.alert","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s){var o=i.extend({"defaults":{"signature":"RemoveParticipant","name":s.CommandNameRemoveParticipant,"scope":"multiple"},"enabled":function(t){if(t&&t.nodes&&t.nodes.length>0){var i=!0;return e.each(t.nodes.models,function(e){e.canRemove()||(i=!1)}),i}return!1},"execute":function(i){var o=1===i.nodes.length?s.RemoveParticipantTitleSingle:s.RemoveParticipantTitleMultiple,n=s.RemoveParticipantMessage,a=this;t.confirmQuestion(n,o).always(function(t){if(t){var s=i.nodes.length,o=!1;e.each(i.nodes.models,function(e){e.save({"add":[],"remove":e.roles.models},{"success":function(){0===--s&&a._refresh(i,o)},"error":function(){o=!0,0===--s&&a._refresh(i,o)}})})}})},"_refresh":function(e,i){i===!0&&t.showError(s.RemoveParticipantErrorMessageDefault),e.originatingView.roleCollection.fetch(),e.originatingView.participantCollection.fetch({"success":function(){e.originatingView.participantCollection.setNewParticipant(),e.originatingView.participantCollection.trigger("saved",e.originatingView.participantCollection)}})}});return o}),csui.define("conws/widgets/team/impl/commands/exportroles",["csui/lib/underscore","conws/utils/commands/export","i18n!conws/utils/commands/nls/commands.lang","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,s){var o=t.extend({"defaults":{"signature":"ExportRoles","name":i.CommandNameExportRoles,"scope":"multiple"},"constructor":function(){t.prototype.constructor.call(this,arguments)},"_exportHeader":function(){var e="";return e+='"'+s.rolesNameColTitle.replace(/"/g,'""')+'";',e+='"'+s.rolesParticipantsColTitle.replace(/"/g,'""')+'";'},"_exportModel":function(e){var t="";return t+='"'+e.displayName().replace(/"/g,'""')+'";',t+='"'+e.displayMembers().replace(/"/g,'""')+'";'}});return o}),csui.define("conws/utils/commands/showdetails",["csui/lib/underscore","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i){var s=t.extend({"defaults":{"signature":"ShowDetails","name":i.CommandNameShowDetails,"scope":"single"},"enabled":function(e){return e&&e.nodes&&1===e.nodes.length?!0:!1},"execute":function(){throw new Error("The '"+this.get("signature")+"' action must be handled by the caller.")}});return s}),csui.define("conws/utils/commands/deleterole",["csui/lib/underscore","csui/dialogs/modal.alert/modal.alert","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s){var o=i.extend({"defaults":{"signature":"DeleteRoles","name":s.CommandNameDeleteRole,"scope":"multiple"},"enabled":function(t){if(t&&t.nodes&&t.nodes.length>0){var i=!0;return e.each(t.nodes.models,function(e){e.canDelete()||(i=!1),e.get("leader")===!0&&e.collection.length>1&&(i=!1)}),i}return!1},"execute":function(i){var o=this._evaluateMembersRemoved(i).length,n=1===i.nodes.length?s.DeleteRoleTitleSingle:s.DeleteRoleTitleMultiple,a=s.DeleteRoleMessageNoParticipantsAffected;1===o?a=s.DeleteRoleMessageParticipantsAffectedSingle:o>1&&(a=s.DeleteRoleMessageParticipantsAffectedMultiple.replace("{0}",o));var r=this;t.confirmQuestion(a,n).always(function(t){t&&e.each(e.clone(i.nodes.models),function(e){e.destroy({"wait":!0,"success":function(){0===i.nodes.length&&r._refreshCollections(i)}})})})},"_evaluateMembersRemoved":function(t){var i=(t.originatingView.participantCollection,t.originatingView.roleCollection),s=[];e.each(t.nodes.models,function(e){e.members.each(function(e){s.push(e.get("id"))})}),s=e.uniq(s);var o=[];e.each(i.models,function(e){void 0===t.nodes.findWhere({"id":e.get("id")})&&e.members.each(function(e){o.push(e.get("id"))})}),o=e.uniq(o);var n=e.difference(s,o);return n},"_refreshCollections":function(e){e.originatingView.roleCollection.fetch({"success":function(){e.originatingView.participantCollection.trigger("saved",e.originatingView.participantCollection)}})}});return o}),csui.define("conws/widgets/team/impl/participants.toolbaritems",["module","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.factory","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s){var o={"otherToolbar":new i({"first":[{"signature":"AddParticipant","name":s.CommandNameAddParticipant,"icon":"binf-glyphicon binf-glyphicon-plus"}],"second":[{"signature":"PrintParticipants","name":s.CommandNamePrintParticipants,"icon":"binf-glyphicon binf-glyphicon-print"},{"signature":"ExportParticipants","name":s.CommandNameExportParticipants,"icon":"binf-glyphicon binf-glyphicon-download"}],"third":[{"signature":"ShowRoles","name":s.CommandNameShowRoles},{"signature":"RemoveParticipant","name":s.CommandNameRemoveParticipant}]},{"maxItemsShown":99,"dropDownIcon":"icon icon-toolbar-more"})};return o}),csui.define("conws/widgets/team/impl/roles.toolbaritems",["module","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.factory","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,s){var o={"otherToolbar":new i({"first":[{"signature":"AddRole","name":s.CommandNameAddRole,"icon":"binf-glyphicon binf-glyphicon-plus"}],"second":[{"signature":"PrintRoles","name":s.CommandNamePrintRoles,"icon":"binf-glyphicon binf-glyphicon-print"},{"signature":"ExportRoles","name":s.CommandNameExportRoles,"icon":"binf-glyphicon binf-glyphicon-download"}],"third":[{"signature":"ShowDetails","name":s.CommandNameShowDetails},{"signature":"DeleteRoles","name":s.CommandNameDeleteRole}]},{"maxItemsShown":99,"dropDownIcon":"icon icon-toolbar-more"})};return o}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return'    <div class="filter-search"></div>\r\n    <div class="filter-clear"></div>\r\n    <div class="filter-icon"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="conws-filter-header">\r\n  <h3 class="header-caption">'+this.escapeExpression((n=null!=(n=t.caption||(null!=e?e.caption:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"caption","hash":{}}):n))+"</h3>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.active:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter.search",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<input id="filtersearch" class="search" type="search" placeholder="'+this.escapeExpression((i=null!=(i=t.caption||(null!=e?e.caption:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"caption","hash":{}}):i))+'" style="display:none"\r\n       value="'+this.escapeExpression((i=null!=(i=t.filter||(null!=e?e.filter:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"filter","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.tooltip||(null!=e?e.tooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tooltip","hash":{}}):i))+'">\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter.search",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter.clear",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<span class="sbclearer formfield_clear" title="'+this.escapeExpression((i=null!=(i=t.tooltip||(null!=e?e.tooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tooltip","hash":{}}):i))+'" style="display:none"></span>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter.clear",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter.searchicon",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<span class="icon icon-search" style="display: inline-block" title="'+this.escapeExpression((i=null!=(i=t.tooltip||(null!=e?e.tooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tooltip","hash":{}}):i))+'"></span>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter.searchicon",s),s}),csui.define("css!conws/widgets/team/impl/controls/filter/impl/filter",[],function(){}),csui.define("conws/widgets/team/impl/controls/filter/filter.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/controls/filter/impl/filter.model","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/filter/impl/filter","hbs!conws/widgets/team/impl/controls/filter/impl/filter.search","hbs!conws/widgets/team/impl/controls/filter/impl/filter.clear","hbs!conws/widgets/team/impl/controls/filter/impl/filter.searchicon","css!conws/widgets/team/impl/controls/filter/impl/filter"],function(e,t,i,s,o,n,a,r,l,c,d){var p=i.ItemView.extend({"template":l,"templateHelpers":function(){return{"caption":this.model.get("caption"),"filter":this.model.get("filter"),"tooltip":e.str.sformat(a.searchPlaceholder,this.model.get("tooltip").toLowerCase())}},"ui":{"search":".search"},"events":{"keyup @ui.search":"onSearchKeyUp"},"behaviors":{"TabableRegion":{"behaviorClass":s}},"constructor":function(e){e.model||(e.model=new n),i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change:showSearch",this.toggleSearch),this.listenTo(this.model,"change:filter",this.changeFilter)},"onSearchKeyUp":function(e){e.stopPropagation(),27===e.keyCode?(this.model.set("showSearch",!this.model.get("showSearch")),this.triggerMethod("close")):this.model.set("filter",this.ui.search.val())},"toggleSearch":function(){var e=this,t=e.model.get("showSearch");t?e.ui.search.toggle("slide",{"direction":"right"},200,function(){e.ui.search.prop("tabindex","0"),e.trigger("changed:focus",e),e.ui.search.trigger("focus")}):(e.model.set("filter",""),e.ui.search.prop("tabindex","-1"),e.ui.search.toggle("slide",{"direction":"right"},200),this.triggerMethod("close"))},"changeFilter":function(){this.ui.search.val(this.model.get("filter"))},"isTabable":function(){return this.ui.search.is(":not(:disabled)")&&this.ui.search.is(":not(:hidden)")&&this.ui.search.is(":visible")},"currentlyFocusedElement":function(){return this.ui.search}}),u=i.ItemView.extend({"template":c,"templateHelpers":function(){return{"tooltip":a.searchClearIconTooltip}},"ui":{"clear":".sbclearer"},"events":{"click @ui.clear":"onClearClick","keyup @ui.clear":"onClearKeyUp"},"behaviors":{"TabableRegion":{"behaviorClass":s}},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change:filter",this.toggleClear)},"toggleClear":function(){var t=this.model.get("filter");e.isString(t)&&0!==t.length?(this.ui.clear.prop("tabindex","0"),this.ui.clear.show()):(this.ui.clear.prop("tabindex","-1"),this.ui.clear.hide())},"onClearClick":function(){this.model.set("filter",""),this.triggerMethod("clear")},"onClearKeyUp":function(e){(13===e.keyCode||32===e.keyCode)&&(this.model.set("filter",""),this.triggerMethod("clear"))},"isTabable":function(){return this.ui.clear.is(":not(:disabled)")&&this.ui.clear.is(":not(:hidden)")&&this.ui.clear.is(":visible")},"currentlyFocusedElement":function(){return this.ui.clear}}),h=i.ItemView.extend({"template":d,"templateHelpers":function(){return{"tooltip":e.str.sformat(a.searchIconTooltip,this.model.get("tooltip"))}},"ui":{"icon":".icon-search"},"events":{"click @ui.icon":"onSearchIconClick","keydown @ui.icon":"onSearchIconKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":s}},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments)},"onSearchIconClick":function(){this.model.set("showSearch",!this.model.get("showSearch"))},"onSearchIconKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&this.model.set("showSearch",!this.model.get("showSearch"))},"currentlyFocusedElement":function(){return this.ui.icon}}),m=i.LayoutView.extend({"template":r,"templateHelpers":function(){return{"caption":this.model.get("caption"),"active":this.model.get("active")}},"ui":{"label":".searchtext","search":".filter-search","clear":".filter-clear","icon":".filter-icon"},"regions":{"searchRegion":"@ui.search","clearRegion":"@ui.clear","iconRegion":"@ui.icon"},"constructor":function(){i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions(),this.listenTo(this.model,"change:active",this.render),this.listenTo(this.model,"change:showSearch",this.toggleLabel),this.listenTo(this,"updateFocus",this.updateFocus)},"onRender":function(){var e=this.model.get("active");e&&(this.searchView=new p({"model":this.model}),this.searchRegion.show(this.searchView),this.listenTo(this.searchView,"close",this.focusIcon),this.clearView=new u({"model":this.model}),this.clearRegion.show(this.clearView),this.listenTo(this.clearView,"clear",this.focusSearch),this.iconView=new h({"model":this.model,"initialActivationWeight":this.options.initialActivationWeight}),this.iconRegion.show(this.iconView))},"toggleLabel":function(){var e=this.model.get("showSearch");e?this.ui.label.hide():this.ui.label.show()},"updateFocus":function(){var e=this.model.get("showSearch");e?(this.searchView.trigger("changed:focus",this.searchView),this.focusSearch()):this.focusIcon()},"focusSearch":function(){this.searchView.currentlyFocusedElement().trigger("focus")},"focusIcon":function(){this.iconView.currentlyFocusedElement().trigger("focus")}});return e.extend(m.prototype,o),m}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s,o,n){var a;return"    <ul>\r\n"+(null!=(a=t.each.call(e,null!=e?e.setRoles:e,{"name":"each","hash":{},"fn":this.program(2,s,0,o,n),"inverse":this.noop}))?a:"")+"    </ul>\r\n"},"2":function(e,t,i,s,o,n){var a;return'        <li class="conws-roles-remove-item">\r\n'+(null!=(a=t["if"].call(e,null!=e?e.inherited_from_id:e,{"name":"if","hash":{},"fn":this.program(3,s,0,o,n),"inverse":this.program(5,s,0,o,n)}))?a:"")+"        </li>\r\n"},"3":function(e,t,i,s,o,n){var a,r;return'            <div class="conws-roles-edit-canedit-setitem-inherit">\r\n              <div class="conws-roles-edit-canedit-name" title="'+this.escapeExpression((r=null!=(r=t.name||(null!=e?e.name:e))?r:t.helperMissing,"function"==typeof r?r.call(e,{"name":"name","hash":{}}):r))+'">'+this.escapeExpression((r=null!=(r=t.name||(null!=e?e.name:e))?r:t.helperMissing,"function"==typeof r?r.call(e,{"name":"name","hash":{}}):r))+'</div>\r\n              <div class="conws-roles-edit-canedit-inherit">'+this.escapeExpression(this.lambda(null!=(a=null!=n[2]?n[2].captions:n[2])?a.RoleInherited:a,e))+"</div>\r\n            </div>\r\n"},"5":function(e,t,i,s,o,n){var a;return'            <div class="conws-roles-edit-canedit-setitem conws-roles-edit-itemaction-remove">\r\n              <div class="conws-roles-edit-canedit-name" title="'+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+'</div>\r\n              <a href="#" class="csui-icon inline-edit-icon binf-close" data-id="'+this.escapeExpression((a=null!=(a=t.id||(null!=e?e.id:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{"name":"id","hash":{}}):a))+'"\r\n                 title="'+this.escapeExpression(this.lambda(null!=n[2]?n[2].removeRole:n[2],e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=n[2]?n[2].removeRole:n[2],e))+'"></a>\r\n            </div>\r\n'},"7":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.removeParticipant:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?o:""},"8":function(e){var t;return'      <div class="conws-roles-edit-canedit-empty">\r\n        <span class="csui-icon csui-icon-notification-warning"\r\n              title="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.captions:e)?t.RemoveParticipantWarning:t,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.captions:e)?t.RemoveParticipantWarning:t,e))+'">\r\n        </span>\r\n        <div class="conws-roles-edit-canedit-empty-text">\r\n          <h2>'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.captions:e)?t.RemoveParticipant1:t,e))+"</h2>\r\n          <h4>"+this.escapeExpression(this.lambda(null!=(t=null!=e?e.captions:e)?t.RemoveParticipant2:t,e))+"</h4>\r\n        </div>\r\n      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s,o,n){var a;return"<div>\r\n"+(null!=(a=t["if"].call(e,null!=e?e.setRoles:e,{"name":"if","hash":{},"fn":this.program(1,s,0,o,n),"inverse":this.program(7,s,0,o,n)}))?a:"")+"</div>\r\n"},"useDepths":!0});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.edit.list.remove",s),s}),csui.define("conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/controls/globalmessage/globalmessage","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove"],function(e,t,i,s,o,n,a,r,l){var c=i.LayoutView.extend({"className":"conws-roles-edit-remove-list","template":l,"filterModel":{},"constructor":function(e){e||(e={}),this.model=e.model,this.filterModel=e.filterModel,this.selectedIndex=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"ui":{"item":".conws-roles-edit-itemaction-remove a","focusedItem":"li"},"events":{"click @ui.item":"itemRemove","click @ui.focusedItem":"itemRemove","keydown":"onKeyDownExt"},"captions":{"RemoveParticipant1":r.rolesDialogRemoveParticipant1,"RemoveParticipant2":r.rolesDialogRemoveParticipant2,"RemoveParticipantWarning":r.rolesDialogRemoveParticipantWarning,"RoleInherited":r.rolesNameColInherited},"behaviors":{"TabableRegion":{"behaviorClass":n},"ListKeyboard":{"behaviorClass":a}},"onKeyDownExt":function(e){var t=this.currentlyFocusedElement();switch(e.keyCode){case 38:this.calculateSelectedIndex(),this._moveTo(e,this._selectPrevious(),t);break;case 40:this.calculateSelectedIndex(),this._moveTo(e,this._selectNext(),t);break;case 13:case 32:case 46:this.currentlyFocusedElement().trigger("click",e)}},"initialize":function(){this.listenTo(this.filterModel,"change",this.render),this.listenTo(this.filterModel,"change:filter",function(){this.selectedIndex=0}),this.listenTo(this,"updateFocus",this.updateFocus),this.listenTo(this.model,"add change reset remove",this.render)},"templateHelpers":function(){return{"removeRole":r.rolesDialogRemoveRole,"setRoles":this.model.filterList(this.filterModel.get("filter")).toJSON(),"removeParticipant":0===this.model.length,"captions":this.captions}},"calculateSelectedIndex":function(){var e=this.filterModel.get("filter");e.length?(this.totalCount=this.model.filterList(e).models.length,0!==this.selectedIndex&&this.selectedIndex===this.totalCount-1&&(this.selectedIndex=this.selectedIndex-1)):this.totalCount=this.model.length},"updateFocus":function(){this.trigger("changed:focus",this),this.currentlyFocusedElement().trigger("focus")},"itemRemove":function(i){var s=t(i.currentTarget),o=s.data("id");e.isUndefined(o)&&s.find(this.ui.item)&&(o=t(i.currentTarget).find(this.ui.item).data("id")),this.calculateSelectedIndex(),this.model.remove(o),i.preventDefault(),i.stopPropagation()}});return c}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'            <li class="conws-roles-edit-item">\r\n              <div>\r\n                <a href="#" class="conws-roles-edit-itemaction-select conws-roles-edit-canedit-selectitem" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"><span title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</span></a>\r\n              </div>\r\n            </li>\r\n"
},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return"<div>\r\n    <ul>\r\n"+(null!=(o=t.each.call(e,null!=e?e.allRoles:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+"    </ul>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.edit.list",s),s}),csui.define("conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list"],function(e,t,i,s,o,n,a,r){var l=i.LayoutView.extend({"className":"conws-roles-edit-list","template":r,"filterModel":{},"constructor":function(e){e||(e={}),this.model=e.model,this.filterModel=e.filterModel,this.selectedIndex=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"ui":{"select":"a.conws-roles-edit-itemaction-select"},"events":{"click @ui.select":"itemSelect","click li":"itemSelect","dragstart @ui.select":"itemDrag","keydown":"onKeyDownExt"},"behaviors":{"TabableRegion":{"behaviorClass":o},"ListKeyboard":{"behaviorClass":n}},"onKeyDownExt":function(e){var t=this.currentlyFocusedElement();switch(e.keyCode){case 38:this.calculateSelectedIndex(),this._moveTo(e,this._selectPrevious(),t);break;case 40:this.calculateSelectedIndex(),this._moveTo(e,this._selectNext(),t);break;case 13:case 32:this.currentlyFocusedElement().trigger("click",e)}},"initialize":function(){this.listenTo(this.filterModel,"change",this.render),this.listenTo(this.filterModel,"change:filter",function(){this.selectedIndex=0}),this.listenTo(this.model,"add change reset remove",this.render),this.listenTo(this,"updateFocus",this.updateFocus)},"templateHelpers":function(){return{"allRoles":this.model.filterList(this.filterModel.get("filter")).toJSON()}},"calculateSelectedIndex":function(){var e=this.filterModel.get("filter");e.length?(this.totalCount=this.model.filterList(e).models.length,0!==this.selectedIndex&&this.selectedIndex===this.totalCount-1&&(this.selectedIndex=this.selectedIndex-1)):this.totalCount=this.model.length},"updateFocus":function(){this.trigger("changed:focus",this),this.currentlyFocusedElement().trigger("focus")},"itemSelect":function(i){var s=t(i.currentTarget),o=s.data("id");e.isUndefined(o)&&s.find(this.ui.select).length>0&&(o=t(i.currentTarget).find(this.ui.select).data("id")),this.calculateSelectedIndex(),this.model.remove(o),i.preventDefault(),i.stopPropagation()},"itemDrag":function(){return!1}});return l}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'      <li class="conws-roles-readonly-item" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'"><span>'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</span></li>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n,a,r="<div>\r\n  <ul>\r\n";return n=null!=(n=t.roles||(null!=e?e.roles:e))?n:t.helperMissing,a={"name":"roles","hash":{},"fn":this.program(1,s,0),"inverse":this.noop},o="function"==typeof n?n.call(e,a):n,t.roles||(o=t.blockHelperMissing.call(e,o,a)),null!=o&&(r+=o),r+"  </ul>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.readonly.list",s),s}),csui.define("css!conws/widgets/team/impl/cells/roles/impl/roles",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list","css!conws/widgets/team/impl/cells/roles/impl/roles"],function(e,t,i,s,o,n,a,r){var l=i.LayoutView.extend({"template":r,"events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":o},"ListKeyboard":{"behaviorClass":n}},"constructor":function(){this.selectedIndex=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){return{"roles":this.model.toJSON()}}});return l}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return'      <div class="conws-roles-edit-canedit">\r\n        <div\r\n            class="conws-roles-edit-canedit-left conws-roles-edit-left conws-roles-edit-canedit-separator">\r\n          <div class="conws-roles-edit-canedit-header">\r\n            <div class="conws-roles-edit-canedit-setroles-region"></div>\r\n          </div>\r\n          <div class="conws-roles-edit-canedit-content">\r\n            <div class="conws-roles-edit-canedit-setroles-list-region"></div>\r\n          </div>\r\n        </div>\r\n        <div class="conws-roles-edit-canedit-right conws-roles-edit-right">\r\n          <div class="conws-roles-edit-canedit-header">\r\n            <div class="conws-roles-edit-canedit-allroles-region"></div>\r\n          </div>\r\n          <div class="conws-roles-edit-canedit-content">\r\n            <div class="conws-roles-edit-canedit-allroles-list-region"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n'},"3":function(){return'      <div class="conws-roles-edit-readonly">\r\n        <div class="conws-roles-readonly-region"></div>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="binf-modal-content">\r\n  <div class="binf-modal-header">\r\n    <h2 class="binf-modal-title">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</h2>\r\n  </div>\r\n  <div class="binf-modal-body">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.canEdit:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?o:"")+'  </div>\r\n  <div class="conws-roles-edit-buttons-region"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.edit",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/participants/impl/roles.edit",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/participants/roles.edit.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/dialogs/modal.alert/modal.alert","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/controls/filter/filter.view","conws/widgets/team/impl/controls/filter/impl/filter.model","conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove.view","conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.view","conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list.view","conws/widgets/team/impl/controls/footer/footer.view","conws/widgets/team/impl/roles.model.expanded","conws/widgets/team/impl/participants.model","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit","conws/widgets/team/impl/roles.model","css!conws/widgets/team/impl/dialogs/participants/impl/roles.edit","css!conws/widgets/team/impl/cells/roles/impl/roles"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v){var b={"Close":f.rolesDialogButtonClose,"Save":f.rolesDialogButtonSave,"Cancel":f.rolesDialogButtonCancel,"Reset":f.rolesDialogButtonReset,"Remove":f.rolesDialogButtonRemove},y=s.LayoutView.extend({"rolesCountForFilter":15,"modified":!1,"availableRoles":new v,"assignedRoles":new v,"filterModel1":void 0,"filterModel2":void 0,"constructor":function(e){e||(e={}),this.teamRoles=e.roleCollection,this.teamParticipants=e.participantCollection,s.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"template":w,"regions":{"assignedRolesHeaderRegion":".conws-roles-edit-canedit-setroles-region","assignedRolesListRegion":".conws-roles-edit-canedit-setroles-list-region","availableRolesHeaderRegion":".conws-roles-edit-canedit-allroles-region","availableRolesListRegion":".conws-roles-edit-canedit-allroles-list-region","readonlyRolesListRegion":".conws-roles-readonly-region","buttonsRegion":".conws-roles-edit-buttons-region"},"ui":{"footer":".conws-roles-edit-buttons-region"},"captions":{"AssignedRoles":f.rolesDialogAssignedRoles,"TooltipAssignedRoles":f.rolesDialogTooltipAssignedRoles,"AvailableRoles":f.rolesDialogAvailableRoles,"TooltipAvailableRoles":f.rolesDialogTooltipAvailableRoles},"initialize":function(){if(!e.isUndefined(this.model)){this.assignedRoles.reset(this.model.roles.models);var t=this.model.collection.availableRoles.clone();t.remove(this.assignedRoles.models);var i=t.filter(function(t){var i=t.get("inherited_from_id");return e.isUndefined(i)||e.isNull(i)});this.availableRoles.reset(i),e.isUndefined(this.filterModel1)||this.filterModel1.set("resetFilter",!0),e.isUndefined(this.filterModel2)||this.filterModel2.set("resetFilter",!0),this.modified=!1,this.setDialogState(),this.listenTo(this.assignedRoles,"remove",this.removeAssignedRole),this.listenTo(this.availableRoles,"remove",this.addAvailableRole)}},"removeAssignedRole":function(e){var t=e;this.availableRoles.add(t),this.modified=!0,this.setDialogState(),0===this.assignedRoles.length?this.filterModel2.get("active")?this.availableRolesHeaderRegion.currentView.trigger("updateFocus"):this.availableRolesListRegion.currentView.trigger("updateFocus"):this.assignedRolesListRegion.currentView.totalCount-1===0&&this.filterModel1.get("active")&&this.assignedRolesHeaderRegion.currentView.trigger("updateFocus")},"addAvailableRole":function(e){var t=e;this.assignedRoles.add(t),this.modified=!0,this.setDialogState(),0===this.availableRoles.length?this.filterModel1.get("active")?this.assignedRolesHeaderRegion.currentView.trigger("updateFocus"):this.assignedRolesListRegion.currentView.trigger("updateFocus"):this.availableRolesListRegion.currentView.totalCount-1===0&&this.filterModel2.get("active")&&this.availableRolesHeaderRegion.currentView.trigger("updateFocus")},"setDialogState":function(){!e.isUndefined(this.filterModel1)&&e.isEmpty(this.filterModel1.get("filter"))&&this.filterModel1.set("active",this.assignedRoles.length>=this.rolesCountForFilter),!e.isUndefined(this.filterModel2)&&e.isEmpty(this.filterModel2.get("filter"))&&this.filterModel2.set("active",this.availableRoles.length>=this.rolesCountForFilter),e.isUndefined(this.editRolesButtons)||(this.editRolesButtons.collection.findWhere({"id":"submit"}).set({"disabled":!this.modified}),this.editRolesButtons.collection.findWhere({"id":"submit"}).set(this.assignedRoles.length>0?{"label":b.Save}:{"label":b.Remove}))},"templateHelpers":function(){var t=f.userRolesDialogTitle;"group"===this.model.getMemberType()&&(t=f.groupRolesDialogTitle);var i=e.str.sformat(t,this.model.get("display_name"));return{"title":i,"canEdit":this.model.canEdit()}},"updateScrollbar":function(){var i=this.$el.find(".binf-modal-body .conws-roles-edit-readonly");e.each(i,function(e){t(e).perfectScrollbar("update")});var s=this.$el.find(".conws-roles-edit-canedit-content");e.each(s,function(e){t(e).perfectScrollbar("update")})},"onAfterShow":function(){this.$el.find(".binf-modal-body .conws-roles-edit-readonly").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15}),this.$el.find(".conws-roles-edit-canedit-content").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15}),this.updateScrollbar()},"onRender":function(){this.model.canEdit()?(this.filterModel1=new c({"caption":this.captions.AssignedRoles,"tooltip":this.captions.TooltipAssignedRoles,"active":this.assignedRoles.length>=this.rolesCountForFilter}),this.assignedRolesHeaderRegion.show(new l({"model":this.filterModel1,"initialActivationWeight":this.assignedRoles.length>=this.rolesCountForFilter?100:0})),this.assignedRolesListRegion.show(new d({"model":this.assignedRoles,"filterModel":this.filterModel1,"initialActivationWeight":this.assignedRoles.length>0?100:0})),this.listenTo(this.assignedRolesListRegion.currentView,"dom:refresh",this.updateScrollbar),this.filterModel2=new c({"caption":this.captions.AvailableRoles,"tooltip":this.captions.TooltipAvailableRoles,"active":this.availableRoles.length>=this.rolesCountForFilter}),this.availableRolesHeaderRegion.show(new l({"model":this.filterModel2})),this.availableRolesListRegion.show(new p({"model":this.availableRoles,"filterModel":this.filterModel2})),this.listenTo(this.availableRolesListRegion.currentView,"dom:refresh",this.updateScrollbar)):this.readonlyRolesListRegion.show(new u({"model":this.model.roles,"initialActivationWeight":this.model.roles.length>0?100:0})),this._renderFooter()},"saveClicked":function(){var e=this,t=new g(void 0,{"connector":e.model.collection.connector,"node":e.model.collection.node,"context":e.model.collection.workspaceContext,"autoreset":!0});t.fetch({"success":function(t){var i,s=t.find(function(t){return t.get("id")===e.model.get("id")});if(s&&s.roles.length===e.model.roles.length&&(i=!1,s.roles.each(function(t){var s=t.id,o=e.model.roles.find(function(e){return e.id===s});o||(i=!0)})),i===!1)e.saveRolesForUser();else{var o=f.rolesEditDialogDataNotUptoDateUser;"group"===e.model.getMemberType()&&(o=f.rolesEditDialogDataNotUptoDateGroup),n.showError(o,e.getErrorMessageTitle()).always(function(){e.refreshAfterSave()})}}})},"saveRolesForUser":function(){var t=this,i=[];this.model.roles.each(function(e){var s=e.id,o=t.assignedRoles.find(function(e){return e.id===s});o||i.push(e)});var s=[];this.assignedRoles.each(function(e){var i=e.id,o=t.model.roles.find(function(e){return e.id===i});o||s.push(e)}),this.model.save({"add":s,"remove":i},{"success":function(){t.refreshAfterSave()},"error":function(i){var s="";if(i.successAdd.length>0){var o=f.rolesEditDialogSuccessfulAdded;e.each(i.successAdd,function(e){o=o+"\n"+e.role.get("name")}),s=o}if(i.errorAdd.length>0){var a=f.rolesEditDialogNotAdded;e.each(i.errorAdd,function(e){a=a+"\n"+e.role.get("name")}),s.length>0&&(s+="\n"),s+=a}if(i.successRemove.length>0){var r=f.rolesEditDialogSuccessfulRemoved;e.each(i.successRemove,function(e){r=r+"\n"+e.role.get("name")}),s.length>0&&(s+="\n"),s+=r}if(i.errorRemove.length>0){var l=f.rolesEditDialogNotRemoved;e.each(i.errorRemove,function(e){l=l+"\n"+e.role.get("name")}),s.length>0&&(s+="\n"),s+=l}n.showError(s,t.getErrorMessageTitle()).always(function(){t.refreshAfterSave()})}})},"getErrorMessageTitle":function(){var t=f.rolesEditDialogErrorTitleUser;"group"===this.model.getMemberType()&&(t=f.rolesEditDialogErrorTitleGroup);var i=e.str.sformat(t,this.model.get(this.model.get("display_name")?"display_name":"name"));return i},"refreshAfterSave":function(){function e(){i.trigger("refetched")}function t(){i.teamParticipants.trigger("saved",i.teamParticipants),i.teamRoles.fetch().then(e,e)}var i=this;this.teamParticipants.fetch({"success":function(){i.teamParticipants.setNewParticipant()}}).then(t,t)},"resetClicked":function(){this.initialize()},"_renderFooter":function(){var t=this.editRolesButtons;if(t)this.ui.footer.removeClass("binf-hidden"),this.buttonsRegion.show(t);else{var s=[];s=this.model.canEdit()?[{"id":"reset","label":b.Reset,"css":"conws-roles-edit-button binf-pull-left conws-roles-edit-button-reset","click":e.bind(this.resetClicked,this)},{"id":"submit","label":b.Save,"css":"conws-roles-edit-button conws-roles-edit-button-save","click":e.bind(this.saveClicked,this),"disabled":!0,"close":!0},{"id":"cancel","label":b.Cancel,"css":"conws-roles-edit-button conws-roles-edit-button-cancel","close":!0}]:[{"id":"cancel","label":b.Close,"css":"conws-roles-edit-button binf-pull-right","close":!0,"initialActivationWeight":100}],t=this.editRolesButtons=new h({"collection":new i.Collection(s)}),this.buttonsRegion.show(t)}}});return e.extend(y.prototype,a),y}),csui.define("hbs!conws/widgets/team/impl/dialogs/role/impl/role.details.member",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'      <span class="member-name" title="'+this.escapeExpression((i=null!=(i=t.displayName||(null!=e?e.displayName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"displayName","hash":{}}):i))+'"></span>\r\n'},"3":function(e,t){var i;return'      <span class="member-name" title="'+this.escapeExpression((i=null!=(i=t.displayName||(null!=e?e.displayName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"displayName","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.displayName||(null!=e?e.displayName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"displayName","hash":{}}):i))+'</span>\r\n      <a class="member-email" href="mailto:'+this.escapeExpression((i=null!=(i=t.email||(null!=e?e.email:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"email","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.email||(null!=e?e.email:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"email","hash":{}}):i))+"</a>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div>\r\n  <div class="conws-role-details-avatar"></div>\r\n  <div class="member-details">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.isUser:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?o:"")+"  </div>\r\n</div>"}});return i.registerPartial("conws_widgets_team_impl_dialogs_role_impl_role.details.member",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/role/impl/role.details.member",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/role/impl/role.details.member.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/utils/url","csui/utils/base","csui/utils/contexts/factories/user","conws/widgets/team/impl/controls/avatar/avatar.view","esoc/widgets/userwidget/userwidget","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/role/impl/role.details.member","css!conws/widgets/team/impl/dialogs/role/impl/role.details.member"],function(e,t,i,s,o,n,a,r,l,c,d){var p=i.ItemView.extend({"template":d,"tagName":"li","className":"conws-role-details-member","region":{"avatar":".conws-role-details-avatar"},"ui":{"userProfileName":".member-name","userProfileImg":".conws-role-details-avatar"},"events":{"keydown":"onKeyDown","touchstart @ui.userProfileName":"onTouchProfileName"},"onKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.$(".esoc-user-profile-link").click())},"onTouchProfileName":function(){this.$(".esoc-user-profile-link").click()},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.avatar=new r({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.context.getModel(a),i={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.context,"showUserProfileLink":!0,"showMiniProfile":n.isTouchBrowser()?!1:!0,"loggedUserId":e.get("id")},s=t.extend({"placeholder":this.$el.find(this.ui.userProfileImg),"showUserWidgetFor":"profilepic"},i);l.getUser(s);var o=t.extend({"placeholder":this.$el.find(this.ui.userProfileName)},i);l.getUser(o)}else this.$(".conws-role-details-avatar").append(this.avatar.render().$el)},"templateHelpers":function(){return{"displayName":this.model.displayName(),"email":this.model.displayEmail(),"isUser":0===this.model.get("type")}}});return p}),csui.define("conws/widgets/team/impl/dialogs/role/impl/role.details.members.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","conws/widgets/team/impl/dialogs/role/impl/role.details.member.view","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,s,o,n,a){var r=i.CollectionView.extend({"className":"conws-role-details-members-list","childView":a,"tagName":"ul","events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":o},"ListKeyboard":{"behaviorClass":n}},"filterModel":{},"constructor":function(e){e||(e={}),this.collection=e.model,this.filterModel=e.filterModel,i.CollectionView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.listenTo(this.filterModel,"change",this.render),this.listenTo(this.filterModel,"change:filter",function(){this.selectedIndex=0})},"addChild":function(t){if(!e.isUndefined(this.filterModel)){var s=this.filterModel.get("filter");if(!e.isUndefined(s)&&s.length>0){var o=t.displayName().toLowerCase();if(o.indexOf(s.toLowerCase())<0)return}}i.CollectionView.prototype.addChild.apply(this,arguments)}});return r}),csui.define("hbs!conws/widgets/team/impl/dialogs/role/impl/role.details",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e){var t;return'                        <div class="conws-role-details-rolename-text">\r\n                            <div class="general-text">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.model:e)?t.name:t,e))+"</div>\r\n                        </div>\r\n"},"3":function(e){var t;return'                        <input type="text" value="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.model:e)?t.name:t,e))+'" />\r\n'},"5":function(e){var t;return'                        <div class="conws-role-details-roledescription-text">\r\n                            <div class="general-text">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.model:e)?t.description:t,e))+"</div>\r\n                        </div>\r\n"},"7":function(e){var t;return'                        <textarea rows="8">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.model:e)?t.description:t,e))+"</textarea>\r\n"},"9":function(e,t){var i,s;return'                    <div class="conws-role-details-rolepermissions">\r\n                        <h3>'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.captions:e)?i.Permissions:i,e))+'</h3>\r\n                        <div class="conws-role-details-permissions">\r\n                            <div class="conws-role-details-teamlead-caption general-text" id="'+this.escapeExpression((s=null!=(s=t.labelId||(null!=e?e.labelId:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"labelId","hash":{}}):s))+'">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.captions:e)?i.TeamLead:i,e))+'</div>\r\n                            <div class="conws-role-details-teamlead-switch"></div>\r\n                        </div>\r\n                    </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="binf-modal-content">\r\n    <div class="binf-modal-header">\r\n        <h2 class="binf-modal-title">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.captions:e)?o.Title:o,e))+'</h2>\r\n    </div>\r\n    <div class="binf-modal-body">\r\n        <div class="conws-role-details-canedit">\r\n            <div class="conws-role-details-canedit-left conws-role-details-left conws-role-details-canedit-separator">\r\n                <div class="conws-role-details-rolename">\r\n                    <h3>'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.captions:e)?o.RoleName:o,e))+"</h3>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?o:"")+'                </div>\r\n                <div class="conws-role-details-roledescription">\r\n                    <h3>'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.captions:e)?o.Description:o,e))+"</h3>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?o:"")+"                </div>\r\n"+(null!=(o=t.unless.call(e,null!=e?e.hideTeamLead:e,{"name":"unless","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?o:"")+'            </div>\r\n            <div class="conws-role-details-canedit-right conws-role-details-right">\r\n                <div class="conws-role-details-header">\r\n                    <div class="conws-role-details-participants-region"></div>\r\n                </div>\r\n                <div class="conws-role-details-canedit-content">\r\n                    <div class="conws-role-details-participants-list-region"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="conws-role-details-buttons-region"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_role_impl_role.details",s),s}),csui.define("css!conws/widgets/team/impl/dialogs/role/impl/role.details",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/role/role.details.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/controls/form/fields/booleanfield.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/controls/filter/filter.view","conws/widgets/team/impl/controls/filter/impl/filter.model","conws/widgets/team/impl/controls/footer/footer.view","conws/widgets/team/impl/dialogs/role/impl/role.details.members.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/role/impl/role.details","css!conws/widgets/team/impl/dialogs/role/impl/role.details"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h){var m=e.config(),g=o.LayoutView.extend({"rolesCountForFilter":15,"filterModel":void 0,"constructor":function(e){e||(e={}),o.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions(),i(window).on("resize",t.bind(this.onWindowResize,this))},"onWindowResize":function(){this.updateScrollbar()},"template":h,"captions":{"Title":u.roleDetailsTitle,"RoleName":u.roleDetailsName,"Participants":u.rolesParticipantsColTitle,"RolesParticipantsColTooltip":u.rolesParticipantsColTooltip,"Description":u.roleDetailsDescription,"Permissions":u.roleDetailsPermissions,"TeamLead":u.rolesNameColTeamLead,"Read":u.roleDetailsRead,"Write":u.roleDetailsWrite,"Manage":u.roleDetailsManage,"Advanced":u.roleDetailsAdvanced},"regions":{"participantsHeaderRegion":".conws-role-details-participants-region","participantsListRegion":".conws-role-details-participants-list-region","teamLeadSwitch":".conws-role-details-teamlead-switch","buttonsRegion":".conws-role-details-buttons-region"},"templateHelpers":function(){return{"labelId":t.uniqueId("conws-teamlead-"),"hideTeamLead":m.hideTeamLead,"readonly":!0,"captions":this.captions,"model":this.model.toJSON()}},"onAfterShow":function(){this.$el.find(".conws-role-details-canedit-content").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15}),this.$el.find(".conws-role-details-canedit-left").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":5}),this.$el.find(".conws-roles-edit-canedit-content").perfectScrollbar("update"),this.$el.find(".conws-role-details-rolename-text").perfectScrollbar({"scrollXMarginOffset":15,"scrollYMarginOffset":15}),this.$el.find(".conws-role-details-rolename-text").scrollTop(0),this.$el.find(".conws-role-details-rolename-text").scrollLeft(0),this.$el.find(".conws-role-details-rolename-text").perfectScrollbar("update"),this.$el.find(".conws-role-details-roledescription-text").perfectScrollbar({"scrollXMarginOffset":15,"scrollYMarginOffset":15}),this.$el.find(".conws-role-details-roledescription-text").scrollTop(0),this.$el.find(".conws-role-details-roledescription-text").scrollLeft(0),this.$el.find(".conws-role-details-roledescription-text").perfectScrollbar("update")},"onRender":function(){this.filterModel=new c({"caption":this.captions.Participants,"tooltip":this.captions.RolesParticipantsColTooltip,"active":this.model.members.length>=this.rolesCountForFilter}),this.participantsHeaderRegion.show(new l({"model":this.filterModel,"initialActivationWeight":this.model.members.length>=this.rolesCountForFilter?100:0})),this.participantsListRegion.show(new p({"model":this.model.members,"filterModel":this.filterModel,"initialActivationWeight":this.model.members.length>0?100:0})),this.listenTo(this.participantsListRegion.currentView,"dom:refresh",this.updateScrollbar),m.hideTeamLead||this.teamLeadSwitch.show(new a({"model":new s.Model({"data":this.model.get("leader"),"caption":this.captions.TeamLead}),"labelId":this.$(".conws-role-details-teamlead-caption").attr("id"),"mode":"readonly"})),this.buttonsRegion.show(new d({"collection":new s.Collection([{"id":"cancel","label":u.rolesDialogButtonClose,"css":"conws-roles-edit-button pull-right","close":!0}])}))},"updateScrollbar":function(){var e=this.$el.find(".conws-role-details-canedit-content");t.each(e,function(e){i(e).scrollTop(0),i(e).perfectScrollbar("update")});var s=this.$el.find(".conws-role-details-canedit-left");s&&s.length&&(s.scrollTop(0),s.perfectScrollbar("update"))}});return t.extend(g.prototype,r),g}),csui.define("hbs!conws/widgets/team/impl/team.tablinks",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return this.escapeExpression((i=null!=(i=t.tabName||(null!=e?e.tabName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tabName","hash":{}}):i))+"\r\n"}});return i.registerPartial("conws_widgets_team_impl_team.tablinks",s),s}),csui.define("css!conws/widgets/team/impl/team",[],function(){}),csui.define("conws/widgets/team/impl/team.tablinks.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/team.tablinks","css!conws/widgets/team/impl/team"],function(e,t,i,s,o,n){var a=i.LayoutView.extend({"tagName":"a","attributes":{"role":"tab","data-binf-toggle":"tab"},"template":n,"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":200}},"events":{"keydown":"onKeyDown"},"onKeyDown":function(e){switch(e.keyCode){case 13:case 32:t(e.target).trigger("click")}},"templateHelpers":function(){return{"tabName":"participants"===this.data.attributes.aria?o.rolesParticipantsColTitle:o.participantRolesColTitle}},"initialize":function(){this.listenTo(this,"dom:refresh",this.updateAttributes)},"updateAttributes":function(){this.$el.attr({"href":this.data.attributes.href,"aria-controls":this.data.attributes["aria-controls"]})},"currentlyFocusedElement":function(){return this.$el},"constructor":function(e,t){this.data=t,i.LayoutView.prototype.constructor.call(this,e)}});return a}),csui.define("hbs!conws/widgets/team/impl/teamtables",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="conws-teamtables">\r\n    <div class="teamtables-tabs">\r\n        <!-- Nav tabs -->\r\n        <ul class="binf-nav binf-nav-tabs binf-pull-right" role="tablist">\r\n          <li role="presentation" id="tabParticipants"></li>\r\n          <li role="presentation" id="tabRoles"></li>\r\n        </ul>\r\n    </div>\r\n    <!-- Tab panes -->\r\n    <div class="teamtables-content">\r\n        <div class="binf-tab-content">\r\n            <div role="tabpanel" class="binf-tab-pane binf-fade binf-in binf-active" id="participantstab">\r\n                <div id="participantstoolbar"></div>\r\n                <div id="participantsview"></div>\r\n            </div>\r\n            <div role="tabpanel" class="binf-tab-pane binf-fade" id="rolestab">\r\n                <div id="rolestoolbar"></div>\r\n                <div id="rolesview"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'
}});return i.registerPartial("conws_widgets_team_impl_teamtables",s),s}),csui.define("hbs!conws/widgets/team/impl/cells/avatar/impl/avatar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return'<span id="status-indicator-inherited" class="status-indicator"></span>\r\n'},"3":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.isNew:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?o:""},"4":function(e,t){var i;return'    <span id="status-indicator-new" class="status-indicator"\r\n          title="'+this.escapeExpression((i=null!=(i=t.participantStatus||(null!=e?e.participantStatus:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"participantStatus","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.participantStatus||(null!=e?e.participantStatus:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"participantStatus","hash":{}}):i))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return(null!=(o=t["if"].call(e,null!=e?e.inherited:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?o:"")+'<div class="conws-avatar"></div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_cells_avatar_impl_avatar",s),s}),csui.define("css!conws/widgets/team/impl/cells/avatar/impl/avatar",[],function(){}),csui.define("conws/widgets/team/impl/cells/avatar/avatar.view",["csui/utils/url","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/contexts/factories/user","esoc/widgets/userwidget/userwidget","conws/widgets/team/impl/controls/avatar/avatar.view","conws/widgets/team/impl/participants.columns","conws/widgets/team/impl/roles.columns","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/avatar/impl/avatar","css!conws/widgets/team/impl/cells/avatar/impl/avatar"],function(e,t,i,s,o,n,a,r,l,c){var d=t.extend({"template":c,"events":{"keydown":"onKeyDown"},"onKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.$(".esoc-user-profile-link").click())},"constructor":function(){t.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"initialize":function(){this.avatar=new n({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.workspaceContext.getModel(s),t={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.workspaceContext,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id"),"placeholder":this.$el.find(".conws-avatar"),"showUserWidgetFor":"profilepic"};o.getUser(t)}else this.$(".conws-avatar").append(this.avatar.render().$el)},"getValueData":function(){return{"participantStatus":l.participantStateNew,"type":this.model.getMemberType(),"inherited":this.model.get("inherited_from_id")?!0:!1,"isNew":this.model.get("isNew")?!0:!1}}},{"hasFixedWidth":!0,"columnClassName":"team-table-cell-avatar","noTitleInHeader":!0});return i.registerByColumnKey(a.columnNames.avatar,d),i.registerByColumnKey(r.columnNames.avatar,d),d}),csui.define("hbs!conws/widgets/team/impl/cells/name/impl/name",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'  <span class="csui-name participant-name" title="'+this.escapeExpression((i=null!=(i=t.value||(null!=e?e.value:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"value","hash":{}}):i))+'"></span>\r\n'},"3":function(e,t){var i;return'  <span class="csui-name participant-name" title="'+this.escapeExpression((i=null!=(i=t.value||(null!=e?e.value:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"value","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.formattedValue||(null!=e?e.formattedValue:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"formattedValue","hash":{}}):i))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return null!=(o=t["if"].call(e,null!=e?e.isUser:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?o:""}});return i.registerPartial("conws_widgets_team_impl_cells_name_impl_name",s),s}),csui.define("css!conws/widgets/team/impl/cells/name/impl/name",[],function(){}),csui.define("conws/widgets/team/impl/cells/name/name.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/contexts/factories/user","conws/widgets/team/impl/participants.columns","esoc/widgets/userwidget/userwidget","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/name/impl/name","css!conws/widgets/team/impl/cells/name/impl/name"],function(e,t,i,s,o,n,a){var r=e.extend({"className":"csui-truncate","template":a,"ui":{"userProfileName":".csui-name"},"events":{"dragstart @ui.userProfileName":"onDrag","keydown":"onKeyDown"},"onKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.$(".esoc-user-profile-link").click())},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.options.context.getModel(i),t={"connector":this.model.connector,"userid":this.model.get("id"),"model":this.model,"context":this.options.context,"placeholder":this.$el.find(this.ui.userProfileName),"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id")};o.getUser(t)}},"onDrag":function(){return!1},"getValueData":function(){var e=this.model.get("display_name");return{"value":e,"formattedValue":e,"isUser":0===this.model.get("type")}}});return t.registerByColumnKey(s.columnNames.name,r),r}),csui.define("hbs!conws/widgets/team/impl/cells/roles/impl/roles",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-roles-btn-div">\r\n  <a class="conws-roles-btn" href="#">\r\n    <div class="conws-roles-text">\r\n      <div class="conws-roles-truncatebox">\r\n        <span title="'+this.escapeExpression((i=null!=(i=t.value||(null!=e?e.value:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"value","hash":{}}):i))+'" class="conws-roles-text-truncate">'+this.escapeExpression((i=null!=(i=t.value||(null!=e?e.value:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"value","hash":{}}):i))+'</span>&nbsp;<span class="conws-roles-count">'+this.escapeExpression((i=null!=(i=t.indicator||(null!=e?e.indicator:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"indicator","hash":{}}):i))+'</span>\r\n      </div>\r\n      <div class="role-name-icon-cell">\r\n        <span class="csui-icon conws-icon-roles-edit" title="'+this.escapeExpression((i=null!=(i=t.toolTip||(null!=e?e.toolTip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"toolTip","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.toolTip||(null!=e?e.toolTip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"toolTip","hash":{}}):i))+'"></span>\r\n      </div>\r\n    </div>\r\n  </a>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_cells_roles_impl_roles",s),s}),csui.define("conws/widgets/team/impl/cells/roles/roles.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","conws/widgets/team/impl/participants.columns","conws/widgets/team/impl/dialogs/participants/roles.edit.view","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/participants.model.factory","conws/widgets/team/impl/roles.model.factory","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/roles/impl/roles","css!conws/widgets/team/impl/cells/roles/impl/roles"],function(e,t,i,s,o,n,a,r,l,c,d,p){var u=i.extend({"className":"csui-truncate","template":p,"ui":{"roleEdit":"a.conws-roles-btn"},"events":{"click @ui.roleEdit":"roleEditClicked","dragstart @ui.roleEdit":"roleEditDrag","keydown":"onKeyDown"},"onKeyDown":function(e){switch(e.keyCode){case 13:case 32:t(e.target).find(this.ui.roleEdit).trigger("click")}},"getValueData":function(){var e=this.model.getLeadingRole(),t=this.model.getRolesIndicator();return{"value":e,"indicator":t,"cannotEdit":!this.model.canEdit(),"toolTip":d.participantRrolesColTooltip}},"roleEditClicked":function(t){this.options.workspaceContext||(this.options.workspaceContext=this.options.context.getObject(r),this.options.workspaceContext.setWorkspaceSpecific(l),this.options.workspaceContext.setWorkspaceSpecific(c)),this.editor=new o({"body":new a({"model":this.model,"roleCollection":this.options.workspaceContext.getCollection(c),"participantCollection":this.options.workspaceContext.getCollection(l)}),"modalClassName":"conws-roles-edit"}),this.editor.show();var i=e.bind(function(){this.options.tableView.$el.find('[conws-participant-row-id="'+this.model.get("id")+'"] .conws-team-table-cell-roles').trigger("click")},this);this.editor.once("destroy",function(){i()}),this.editor.options.body.once("refetched",function(){i()}),t.preventDefault(),t.stopPropagation()},"roleEditDrag":function(){return!1},"onDestroy":function(){this.editor&&(this.editor=void 0)}},{"columnClassName":"conws-team-table-cell-roles"});return s.registerByColumnKey(n.columnNames.roles,u),u}),csui.define("conws/widgets/team/impl/cells/login/login.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/participants.columns","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i){var s=e.extend({"className":"csui-truncate","getValueData":function(){var e=this.model.displayLogin();return{"value":e,"formattedValue":e}}});return t.registerByColumnKey(i.columnNames.login,s),s}),csui.define("conws/widgets/team/impl/cells/email/email.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/participants.columns","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i){var s=e.extend({"className":"csui-truncate","getValueData":function(){var e=this.model.displayEmail();return{"value":e,"formattedValue":e}}});return t.registerByColumnKey(i.columnNames.email,s),s}),csui.define("conws/widgets/team/impl/cells/department/department.view",["csui/utils/url","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/participants.columns","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,s){var o=t.extend({"className":"csui-truncate","constructor":function(){t.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"getValueData":function(){var e=this.model.displayDepartment();return{"value":e,"formattedValue":e}}},{"columnClassName":"team-table-cell-department"});return i.registerByColumnKey(s.columnNames.department,o),o}),csui.define("hbs!conws/widgets/team/impl/cells/rolename/impl/rolename",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'        <span class="teamlead">'+this.escapeExpression((i=null!=(i=t.leader||(null!=e?e.leader:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"leader","hash":{}}):i))+"</span>\r\n"},"3":function(e,t){var i;return'        <span class="inherited">'+this.escapeExpression((i=null!=(i=t.inherited||(null!=e?e.inherited:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"inherited","hash":{}}):i))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="role-name-cell">\r\n  <a href="#">\r\n    <div class="role-name-box">\r\n      <div class="role-name-name-cell">\r\n      <span class="name" title="'+this.escapeExpression((n=null!=(n=t.formattedValue||(null!=e?e.formattedValue:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.formattedValue||(null!=e?e.formattedValue:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"+(null!=(o=t["if"].call(e,null!=e?e.leader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.inherited:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+'      </div>\r\n      <div class="role-name-icon-cell">\r\n        <span class="csui-icon conws-icon-roles-details" title="'+this.escapeExpression((n=null!=(n=t.toolTip||(null!=e?e.toolTip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"toolTip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.toolTip||(null!=e?e.toolTip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"toolTip","hash":{}}):n))+'"></span>\r\n      </div>\r\n    </div>\r\n  </a>\r\n</div>'}});return i.registerPartial("conws_widgets_team_impl_cells_rolename_impl_rolename",s),s}),csui.define("css!conws/widgets/team/impl/cells/rolename/impl/rolename",[],function(){}),csui.define("conws/widgets/team/impl/cells/rolename/rolename.view",["csui/lib/jquery","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/roles.columns","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","conws/widgets/team/impl/dialogs/role/role.details.view","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/participants.model.factory","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/rolename/impl/rolename","css!conws/widgets/team/impl/cells/rolename/impl/rolename"],function(e,t,i,s,o,n,a,r,l,c){var d=t.extend({"className":"csui-truncate","template":c,"ui":{"roleDetails":"a"},"events":{"click @ui.roleDetails":"roleDetailsClicked","dragstart @ui.roleDetails":"roleDetailsDrag","keydown":"onKeyDown"},"onKeyDown":function(t){switch(t.keyCode){case 13:case 32:e(t.target).find(this.ui.roleDetails).trigger("click")}},"getValueData":function(){var e=this.model.displayName();return{"toolTip":l.rolesNameColTooltip,"formattedValue":e,"leader":this.model.get("leader")?l.rolesNameColTeamLead:"","inherited":this.model.get("inherited_from_id")?l.rolesNameColInherited:""}},"roleDetailsClicked":function(e){this.options.workspaceContext||(this.options.workspaceContext=this.options.context.getObject(a),this.options.workspaceContext.setWorkspaceSpecific(r)),this.editor=new o({"body":new n({"model":this.model,"parentCollection":this.options.workspaceContext.getCollection(r)}),"modalClassName":"conws-role-details"}),this.editor.show(),e.preventDefault(),e.stopPropagation()},"roleDetailsDrag":function(){return!1},"onDestroy":function(){this.editor&&(this.editor=void 0)}},{"hasFixedWidth":!1,"columnClassName":"team-table-cell-rolename"});return i.registerByColumnKey(s.columnNames.name,d),d}),csui.define("hbs!conws/widgets/team/impl/cells/participants/impl/participants",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<span class="'+this.escapeExpression((i=null!=(i=t.valueClass||(null!=e?e.valueClass:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"valueClass","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.value||(null!=e?e.value:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"value","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.formattedValue||(null!=e?e.formattedValue:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"formattedValue","hash":{}}):i))+"</span>"}});return i.registerPartial("conws_widgets_team_impl_cells_participants_impl_participants",s),s}),csui.define("css!conws/widgets/team/impl/cells/participants/impl/participants",[],function(){}),csui.define("conws/widgets/team/impl/cells/participants/participants.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/roles.columns","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/participants/impl/participants","css!conws/widgets/team/impl/cells/participants/impl/participants"],function(e,t,i,s,o){var n=e.extend({"className":"csui-truncate","template":o,"getValueData":function(){var e="name",t=this.model.displayMembers();return t||(t=s.rolesParticipantsColNoParticipants,e="name warning"),{"value":t,"formattedValue":t,"valueClass":e}}},{"hasFixedWidth":!1,"columnClassName":"team-table-cell-participants"});return t.registerByColumnKey(i.columnNames.members,n),n}),csui.define("conws/widgets/team/impl/teamtables.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/utils/commands","conws/utils/commands/addparticipant","conws/widgets/team/impl/commands/exportparticipants","conws/utils/commands/showroles","conws/utils/commands/removeparticipant","conws/widgets/team/impl/commands/exportroles","conws/utils/commands/showdetails","conws/utils/commands/deleterole","csui/dialogs/modal.alert/modal.alert","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table/table.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/participants.model.factory","conws/widgets/team/impl/participants.columns","conws/widgets/team/impl/participants.toolbaritems","conws/widgets/team/impl/roles.model.factory","conws/widgets/team/impl/roles.columns","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/roles.toolbaritems","conws/widgets/team/impl/dialogs/participants/roles.edit.view","conws/widgets/team/impl/dialogs/role/role.details.view","conws/widgets/team/impl/team.tablinks.view","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/teamtables","css!conws/widgets/team/impl/team","conws/widgets/team/impl/cells/avatar/avatar.view","conws/widgets/team/impl/cells/name/name.view","conws/widgets/team/impl/cells/roles/roles.view","conws/widgets/team/impl/cells/login/login.view","conws/widgets/team/impl/cells/email/email.view","conws/widgets/team/impl/cells/department/department.view","conws/widgets/team/impl/cells/rolename/rolename.view","conws/widgets/team/impl/cells/participants/participants.view"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v,b,y,k,x,_,C,T,S,R,M){var V=i.LayoutView.extend({"template":M,"dirty":!1,"events":{"shown.binf.tab .binf-nav-tabs a":"onShownTab"},"regions":{"tabParticipantsRegion":"#tabParticipants","tabRolesRegion":"#tabRoles","participantsToolbarRegion":"#participantstoolbar","participantsRegion":"#participantsview","rolesToolbarRegion":"#rolestoolbar","rolesRegion":"#rolesview"},"constructor":function(e){if(void 0===e||!e.context)throw new Error("Context is missing in the constructor options");this.context=e.context,t.isUndefined(e.collapsedView)||(this.collapsedView=e.collapsedView),e.workspaceContext||(e.workspaceContext=e.context.getObject(k),e.workspaceContext.setWorkspaceSpecific(f),e.workspaceContext.setWorkspaceSpecific(b)),this.workspaceContext=e.workspaceContext,this.participantCollection=e.workspaceContext.getCollection(f),this.roleCollection=e.workspaceContext.getCollection(b),this.participantCollection.newParticipants=[],t.each(this.participantCollection.where({"isNew":!0}),function(e){e.unset("isNew")}),e.filterBy&&e.filterBy.name.length>0?(this.participantCollection.setFilter({"conws_participantname":e.filterBy.name}),this.roleCollection.setFilter({"conws_rolename":e.filterBy.name})):(this.participantCollection.filters={},this.participantCollection.orderBy=w.columnNames.name+" asc",this.roleCollection.filters={},this.roleCollection.orderBy=y.columnNames.name+" asc"),this.listenTo(this.participantCollection,"saved",this.onParticipantsChanged),this.listenTo(this.roleCollection,"saved",this.onChanged),this.dirty=!1,e.data||(e.data={}),i.LayoutView.prototype.constructor.call(this,arguments),this.propagateEventsToRegions()},"onRender":function(){var e=this;this.tabParticipantsRegion.show(new T(t.defaults({"initialActivationWeight":202},this.options),{"attributes":{"aria":"participants","aria-controls":"participantstab","href":"#participantstab"}})),this.tabRolesRegion.show(new T(t.defaults({"initialActivationWeight":201},this.options),{"attributes":{"aria":"roles","aria-controls":"rolestab","href":"#rolestab"}})),this.participantCollection.fetched&&this.participantCollection.fetch({"reload":!0}),this.roleCollection.fetched&&this.roleCollection.fetch({"reload":!0}),this.participantCollection.once("sync",function(){e.tabParticipantsRegion.currentView.$el.trigger("click")}).fetch(),this.roleCollection.once("sync",function(){e.renderRolesAfterFetch()}).fetch()},"renderParticipantsAfterFetch":function(){if(!this.participantsToolbarView){var i=o.get(n.prototype.defaults.signature);i?i.roles=this.participantCollection.availableRoles:(o.add(new n({"roles":this.participantCollection.availableRoles})),o.add(new a),o.add(t.extend(new r,{"execute":this.onShowRoles})),o.add(new l)),this.participantsToolbarView=new h({"originatingView":this,"toolbarItems":v,"collection":this.participantCollection})}if(!this.participantsTableView){var c=t.rest(w.getColumnKeys(),1);this.participantsTableView=new m({"context":this.workspaceContext,"connector":this.context.getObject(s),"collection":this.participantCollection,"columns":this.participantCollection.columns,"filterBy":this.participantCollection.filters,"tableColumns":w,"selectColumn":!0,"enableSorting":!0,"orderBy":w.columnNames.name+" asc","nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!0,"columnsWithSearch":c,"tableTexts":{"zeroRecords":R.zeroRecordsOrFilteredParticipants}}),this.listenTo(this.participantsTableView,"tableRowSelected",this.updateParticipantsToolItems),this.listenTo(this.participantsTableView,"tableRowUnselected",this.updateParticipantsToolItems),this.listenTo(this.participantsTableView,"tableRowRendered",function(t){e(t.target).attr("conws-participant-row-id",t.node.get("id"))}),t.isUndefined(this.participantsTableView.accFocusedState.body.column)||(this.participantsTableView.accFocusedState.body.column=3)}this.participantsToolbarRegion.show(this.participantsToolbarView),this.participantsRegion.show(this.participantsTableView)},"renderRolesAfterFetch":function(){if(this.rolesToolbarView||(o.add(new c),o.add(t.extend(new d,{"execute":this.onShowDetails})),o.add(new p),this.rolesToolbarView=new h({"originatingView":this,"toolbarItems":x,"collection":this.roleCollection})),!this.rolesTableView){var e=t.rest(y.getColumnKeys(),1);this.rolesTableView=new m({"context":this.workspaceContext,"connector":this.context.getObject(s),"collection":this.roleCollection,"columns":this.roleCollection.columns,"filterBy":this.roleCollection.filters,"tableColumns":y,"selectColumn":!0,"enableSorting":!0,"orderBy":y.columnNames.name+" asc","nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!0,"columnsWithSearch":e,"tableTexts":{"zeroRecords":R.zeroRecordsOrFilteredRoles}}),this.listenTo(this.rolesTableView,"tableRowSelected",this.updateRolesToolItems),this.listenTo(this.rolesTableView,"tableRowUnselected",this.updateRolesToolItems),t.isUndefined(this.rolesTableView.accFocusedState.body.column)||(this.rolesTableView.accFocusedState.body.column=2)}this.rolesToolbarRegion.show(this.rolesToolbarView),this.rolesRegion.show(this.rolesTableView)},"onShowRoles":function(e){return this.editor=new S({"body":new _({"model":e.nodes.models[0],"roleCollection":e.originatingView.roleCollection,"participantCollection":e.originatingView.participantCollection}),"modalClassName":"conws-roles-edit"}),this.editor.show(),[]},"onShowDetails":function(e){return this.editor=new S({"body":new C({"model":e.nodes.models[0],"roleCollection":e.originatingView.roleCollection,"participantCollection":e.originatingView.participantCollection}),"modalClassName":"conws-role-details"}),this.editor.show(),[]},"updateParticipantsToolItems":function(){this.participantsToolbarView.updateForSelectedChildren(this.participantsTableView.getSelectedChildren())},"participantsTableDomRefresh":function(){this.participantsToolbarView.updateForSelectedChildren(this.participantsTableView.getSelectedChildren()),this.participantsTableView.triggerMethod("dom:refresh",this.participantsTableView)},"updateRolesToolItems":function(){this.rolesToolbarView.updateForSelectedChildren(this.rolesTableView.getSelectedChildren())},"rolesTableDomRefresh":function(){this.rolesToolbarView.updateForSelectedChildren(this.rolesTableView.getSelectedChildren()),this.rolesTableView.triggerMethod("dom:refresh",this.rolesTableView)},"onShownTab":function(e){var t=e.target.hash;switch(t){case"#participantstab":this.renderParticipantsAfterFetch(),this.participantsTableDomRefresh();break;case"#rolestab":this.renderRolesAfterFetch(),this.rolesTableDomRefresh()}},"onParticipantsChanged":function(){var e=this;this.dirty=!0,e.participantCollection.fetch({"reload":!0,"success":function(){e.participantCollection.setNewParticipant(),e.updateParticipantsToolItems()}}),e.roleCollection.fetch({"reload":!0}),this.updateRolesToolItems()},"onChanged":function(){this.dirty=!0,this.updateParticipantsToolItems(),this.updateRolesToolItems()},"onDestroy":function(){return this.rolesEditor&&(this.rolesEditor.close(),this.rolesEditor=void 0),this.detailsEditor&&(this.detailsEditor.close(),this.detailsEditor=void 0),this.dirty&&!t.isUndefined(this.collapsedView)&&this.collapsedView.triggerMethod("refresh:list"),!0}});return t.extend(V.prototype,g),V}),csui.define("hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteammember",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'        <span class="cs-name" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'"></span>\r\n'},"3":function(e,t){var i;return'        <span class="cs-name" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</span>\r\n"},"5":function(e){var t;return'        <div class="cs-stage">\r\n            <span class="cs-value" title="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.stage:e)?t.value:t,e))+'">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.stage:e)?t.value:t,e))+'</span>\r\n            <span class="cs-label">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.stage:e)?t.label:t,e))+"</span>\r\n        </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="conws-user-avatar"></div>\r\n<div class="cs-left">\r\n    <div class="cs-title">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.isUser:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?o:"")+"    </div>\r\n"+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.stage:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?o:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_listitem_impl_listitemteammember",s),s}),csui.define("hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteamrole",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e){var t;return'<div class="conws-role-avatar">\r\n  <span class="cs-icon circular cs-icon-add" aria-hidden="true"></span>\r\n</div>\r\n<div class="cs-left">\r\n  <div class="cs-title">\r\n    <span class="cs-name cs-role conws-font-1em-italic-steel-grey" title="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.stage:e)?t.value:t,e))+'">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.stage:e)?t.value:t,e))+"</span>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_listitem_impl_listitemteamrole",s),s}),csui.define("css!conws/widgets/team/impl/controls/listitem/impl/listitemteammember",[],function(){}),csui.define("conws/widgets/team/impl/controls/listitem/listitemteammember.view",["csui/lib/jquery","csui/utils/url","csui/controls/listitem/listitemstandard.view","csui/utils/contexts/factories/user","conws/widgets/team/impl/controls/avatar/avatar.view","esoc/widgets/userwidget/userwidget","hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteammember","hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteamrole","css!conws/widgets/team/impl/controls/listitem/impl/listitemteammember"],function(e,t,i,s,o,n,a,r){var l=i.extend({"tagName":"div","className":"conws-item-member "+i.prototype.className,"events":{"keydown":"onKeyDown"},"triggers":{"click":"click:item","click @ui.userAvatar":"click:profile","click @ui.userProfileName":"click:profile"},"ui":{"userProfileName":".cs-name","userAvatar":".conws-user-avatar"},"constructor":function(e){e||(e={}),e.miniProfile=void 0===e.miniProfile?!0:!1,e.context||(e.context=e.model.collection.context),i.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"getTemplate":function(){return"member"===this.model.memberType?a:r},"initialize":function(){this.avatar=new o({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var t=this.options.context.getModel(s),i={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.options.context,"showUserProfileLink":!0,"showMiniProfile":this.options.miniProfile,"loggedUserId":t.get("id")},o=e.extend({"placeholder":this.$el.find(this.ui.userAvatar),"showUserWidgetFor":"profilepic"},i);n.getUser(o);var a=e.extend({"placeholder":this.$el.find(this.ui.userProfileName)},i);n.getUser(a)}else this.$el.find(this.ui.userAvatar).append(this.avatar.render().$el)},"onKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&(this.$("a").click(),e.preventDefault(),e.stopPropagation())}});return l}),csui.define("hbs!conws/utils/previewpane/impl/rolemembers.empty",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-preview empty-role-members-view">\r\n    <span>'+this.escapeExpression((i=null!=(i=t.noResultsPlaceholder||(null!=e?e.noResultsPlaceholder:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"noResultsPlaceholder","hash":{}}):i))+"</span>\r\n</div>"}});return i.registerPartial("conws_utils_previewpane_impl_rolemembers.empty",s),s}),csui.define("css!conws/utils/previewpane/impl/previewpane",[],function(){}),csui.define("conws/utils/previewpane/impl/rolemembers.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/list/list.view","csui/controls/list/emptylist.view","csui/behaviors/limiting/limiting.behavior","csui/behaviors/expanding/expanding.behavior","conws/widgets/header/impl/header.model.factory","conws/widgets/team/impl/team.model.factory","conws/widgets/team/impl/teamtables.view","csui/utils/nodesprites","conws/widgets/team/impl/controls/listitem/listitemteammember.view","i18n!conws/utils/previewpane/impl/nls/previewpane.lang","hbs!conws/utils/previewpane/impl/rolemembers.empty","css!conws/utils/previewpane/impl/previewpane"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h){var m=(i.ItemView.extend({"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments)},"template":h}),i.CollectionView.extend({"constructor":function(e){e||(e={}),e.data||(e.data={}),i.CollectionView.prototype.constructor.apply(this,arguments)},"getEmptyView":function(){return o},"emptyViewOptions":function(){return{"templateHelpers":{"text":this.options.noRoleMembersMessage}}
},"childView":p,"childViewOptions":function(){return{"templateHelpers":function(){return{"name":this.model.get("display_name"),"email":this.model.get("business_email"),"isUser":0===this.model.get("type"),"stage":{"value":this.model.getLeadingRole(),"label":this.model.getRolesIndicator()}}},"context":this.options.context,"miniProfile":!1}},"childEvents":{"click:profile":"onClickProfile"},"onClickProfile":function(e,t){this.triggerMethod("click:member",t)},"onClickHeader":function(){this.triggerMethod("expand")}}));return m}),csui.define("hbs!conws/utils/previewpane/impl/previewpane",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="binf-panel-heading conws-preview-header">\r\n</div>\r\n\r\n<div class="binf-panel-body">\r\n    <div class="conws-preview-metadata conws-preview-perfect-scroll">\r\n    </div>\r\n\r\n    <hr>\r\n\r\n    <div class="binf-list-group conws-preview-role-members conws-preview-perfect-scroll">\r\n        User Or Role Area\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("conws_utils_previewpane_impl_previewpane",s),s}),csui.define("conws/utils/previewpane/previewpane.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/widget.container/widget.container.behavior","csui/utils/base","csui/utils/log","csui/utils/url","csui/controls/list/emptylist.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/utils/previewpane/impl/previewheader.model","conws/utils/previewpane/impl/previewheader.view","conws/utils/previewpane/impl/attributes.model","conws/utils/previewpane/impl/role.model","conws/utils/previewpane/impl/rolemembers.view","conws/models/selectedmetadataform/selectedmetadataform.model","conws/controls/selectedmetadataform/selectedmetadataform.view","i18n!conws/utils/previewpane/impl/nls/previewpane.lang","hbs!conws/utils/previewpane/impl/previewpane","css!conws/utils/previewpane/impl/previewpane"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v,b,y){var k=s.LayoutView.extend({"className":"conws-preview panel panel-default","template":y,"regions":{"headerRegion":".conws-preview-header","metaDataRegion":".conws-preview-metadata","roleMembersRegion":".conws-preview-role-members"},"triggers":{"change #header-ws-add-icon-file":"add:icon","click  #header-ws-remove-icon":"remove:icon"},"blankImage":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=","behaviors":{"PerfectScrolling":{"behaviorClass":d,"contentParent":".conws-preview-perfect-scroll","suppressScrollX":!0}},"constructor":function(e){if(s.LayoutView.prototype.constructor.call(this,e),e||(e={}),this.config=e.config,this.fetched=!1,this.config.roleId||this.config.metadata){this.parent=e.parent,this.config.noMetadataMessage=this._localize("noMetadataMessage"),this.config.noRoleMembersMessage=this._localize("noRoleMembersMessage"),this.config.readonly=!0,this.headerModel=new u(e),this.metaDataModel=new w(void 0,{"node":e.node,"metadataConfig":this.config,"autofetch":!0,"autoreset":!0}),this.roleMemberCollection=new g(null,e);var t=i.fn.binf_modal.getDefaultContainer?i.fn.binf_modal.getDefaultContainer():"body";e.parent.$el.binf_popover({"content":this.$el,"parent":e.parent.$el,"placement":function(){this.$element=this.options.parent;var e="right",t=e,s=this.tip();s.detach().css({"top":0,"left":0,"display":"block"}).addClass("binf-"+t).data("binf."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var o=this.getPosition(),n=this.options.container?i(this.options.container):this.$element.parent(),a=this.getPosition(n),r=s[0].offsetWidth;if(o.right+r<a.width||o.left-r>0)t=o.right+r>a.width?"left":o.left-r<a.left?"right":t;else{var l=i(this.$element[0]).find(".conws-previewpane-default-position");l.length>0&&(this.$element.removeAttr("aria-describedby"),this.$element=l,this.$element.attr("aria-describedby",s.attr("id")))}return t!==e&&s.removeClass("binf-"+e).addClass("binf-"+t),t},"trigger":"manual","container":t,"html":!0});var o=this.parent.$el.data("binf.popover"),n=o.tip();n.addClass("conws-previewpane-popover"),n.on("mouseenter",this,i.proxy(function(){this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Mouseenter popover")&&console.log(r.last),this.show()},this)),n.on("mouseleave",this,i.proxy(function(){this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Mouseleave popover")&&console.log(r.last),this.delayedHide()},this)),this.propagateEventsToRegions()}},"onBeforeDestroy":function(){(this.config.roleId||this.config.metadata)&&this.parent.$el.binf_popover("destroy")},"show":function(){if(this.config.roleId||this.config.metadata){var e=this;if(this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Preparing show")&&console.log(r.last),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Cleared hide timeout")&&console.log(r.last),this.hideTimeout=null),this.$el.is(":visible"))return void(this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Already visible")&&console.log(r.last));this.showCancelled=!1,this.$el.hide(),this.render();var s=i.Deferred();this.headerView&&this.headerView.destroy(),this.roleView&&this.roleView.destroy(),this.metaDataView&&this.metaDataView.destroy(),this.headerView=new h({"model":this.headerModel}),this.roleView=new f({"collection":this.roleMemberCollection,"noRoleMembersMessage":this.config.noRoleMembersMessage,"context":this.options.context}),this.listenTo(this.roleView,"click:member",this.hide),this.metaDataView=new v({"model":this.metaDataModel,"context":this.options.context}),this.metaDataView.on("render:form",function(){e._attachUserFieldHandlers(this),s.resolve()}),this.config.metadata||s.resolve();var o;this.fetched?this.config.metadata&&(this.metaDataModel.trigger("change"),o=[i.Deferred().resolve(),i.Deferred().resolve(),i.Deferred().resolve(),s]):o=[this.headerModel.fetch(),this.metaDataModel.fetch(),this.roleMemberCollection.fetch(),s],i.when.apply(this,o).done(t.bind(function(){if(this.fetched=!0,this.showCancelled)this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Show was cancelled -> skipped")&&console.log(r.last);else{i(".conws-previewpane-popover").each(function(e,t){var s=i(t).attr("id");i("[aria-describedby^='"+s+"']").binf_popover("hide")}),this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Showing")&&console.log(r.last);var e=!1;t.isEmpty(this.metaDataModel.attributes.data)&&(this.metaDataView=new c({"text":this.config.noMetadataMessage}),e=!0),this.headerRegion.show(this.headerView,{"render":!0}),this.metaDataRegion.show(this.metaDataView,{"render":e}),this.roleMembersRegion.show(this.roleView,{"render":!0}),this.$el.show(),this.options.parent.$el.binf_popover("show"),this.config.debug===!0&&(r.info("Viewport height: "+i(window).height())&&console.log(r.last),r.info("document height: "+i(document).height())&&console.log(r.last),r.info("body     height: "+i("body").height())&&console.log(r.last),r.info("popover  height: "+this.$el.height())&&console.log(r.last),r.info("metadata height: "+this.$el.find(".conws-preview-metadata").height())&&console.log(r.last),r.info("role     height: "+this.$el.find(".conws-preview-role-members").height())&&console.log(r.last)),this.triggerMethod("dom:refresh")}},this))}},"hide":function(){this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Going to hide")&&console.log(r.last),this.config&&!this.config.debugNoHide?(this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Hidden")&&console.log(r.last),this.options.parent.$el.binf_popover("hide"),this.hideTimeout=null):this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Leaving visible")&&console.log(r.last),this.showCancelled=!0,this.hideTimeout=null},"delayedHide":function(){this.config.debug===!0&&r.info("Preview "+this.options.node.get("id")+": Setting hide timeout")&&console.log(r.last),this.hideTimeout=window.setTimeout(i.proxy(this.hide,this),200)},"_localize":function(e){var t=b[e];return this.config[e]&&(t=a.getClosestLocalizedString(this.config[e],t)),t},"_attachUserFieldHandlers":function(e){var s=function(e){return r.info("User field mouseover")&&console.log(r.last),e.stopPropagation(),!1},o=e.$el.find(".cs-userfield .cs-field-read");t.each(o,function(e){e.addEventListener("mouseover",s,!0)}),s=i.proxy(this.hide,this),e.$el.find(".cs-userfield .cs-field-read-inner").click(s)}});return t.extend(k.prototype,p),k}),csui.define("hbs!conws/widgets/relatedworkspaces/impl/relateditem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'            <span class="conws-value">\r\n              <span class="conws-previewpane-default-position">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.title:e)?o.value:o,e))+"</span>\r\n            </span>\r\n"+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.title:e)?o.label:o,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?o:"")},"2":function(){return'              <!-- add element to get proper distance to value -->\r\n              <div class="conws-spacer"></div>\r\n'},"4":function(e){var t;return'            <span class="conws-label">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.title:e)?t.label:t,e))+"</span>\r\n"},"6":function(){return'            <!-- add element to get proper distance to description -->\r\n            <div class="conws-description-spacer"></div>\r\n'},"8":function(e,t,i,s){var o;return'          <div class="conws-right">\r\n'+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.topRight:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.topRight:e)?o.label:o,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?o:"")+"          </div>\r\n"},"9":function(e,t,i,s){var o;return'              <span class="conws-value">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.topRight:e)?o.value:o,e))+"</span>\r\n"+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.topRight:e)?o.label:o,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")},"10":function(){return'                <!-- add element to get proper distance to value -->\r\n                <div class="conws-spacer"></div>\r\n'},"12":function(e){var t;return'              <span class="conws-label">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.topRight:e)?t.label:t,e))+"</span>\r\n"},"14":function(e){var t;return'          <div class="conws-body">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.description:e)?t.value:t,e))+"</div>\r\n"},"16":function(e,t,i,s){var o;return'          <div class="conws-left">\r\n'+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.bottomLeft:e)?o.label:o,{"name":"if","hash":{},"fn":this.program(17,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.bottomLeft:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?o:"")+"          </div>\r\n"},"17":function(e,t,i,s){var o;return'              <span class="conws-label">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.bottomLeft:e)?o.label:o,e))+"</span>\r\n"+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.bottomLeft:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")},"19":function(e){var t;return'              <span class="conws-value">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.bottomLeft:e)?t.value:t,e))+"</span>\r\n"},"21":function(e,t,i,s){var o;return'          <div class="conws-right">\r\n'+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.bottomRight:e)?o.label:o,{"name":"if","hash":{},"fn":this.program(22,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.bottomRight:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(24,s,0),"inverse":this.noop}))?o:"")+"          </div>\r\n"},"22":function(e,t,i,s){var o;return'              <span class="conws-label">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.bottomRight:e)?o.label:o,e))+"</span>\r\n"+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.bottomRight:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")},"24":function(e){var t;return'              <span class="conws-value">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.bottomRight:e)?t.value:t,e))+"</span>\r\n"},"26":function(){return'  <div class="conws-relateditem-divider"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="conws-relateditem-action-area">\r\n  <a class="conws-nostyle" href="'+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'">\r\n    <div class="conws-relateditem-border">\r\n      <div class="conws-relateditem-top">\r\n        <div class="conws-title conws-left">\r\n'+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.title:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.title:e)?o.label:o,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.description:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?o:"")+"        </div>\r\n\r\n"+(null!=(o=t["if"].call(e,null!=e?e.topRight:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?o:"")+'      </div>\r\n\r\n      <div class="conws-relateditem-center">\r\n'+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.description:e)?o.value:o,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?o:"")+'      </div>\r\n\r\n      <div class="conws-relateditem-bottom">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.bottomLeft:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.bottomRight:e,{"name":"if","hash":{},"fn":this.program(21,s,0),"inverse":this.noop}))?o:"")+"      </div>\r\n    </div>\r\n  </a>\r\n</div>\r\n\r\n"+(null!=(o=t["if"].call(e,null!=e?e.notLastItem:e,{"name":"if","hash":{},"fn":this.program(26,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("conws_widgets_relatedworkspaces_impl_relateditem",s),s}),csui.define("css!conws/widgets/relatedworkspaces/impl/relateditem",[],function(){}),csui.define("conws/widgets/relatedworkspaces/impl/relateditem.view",["module","csui/lib/underscore","csui/lib/marionette","csui/lib/jquery","conws/utils/previewpane/previewpane.view","csui/behaviors/default.action/default.action.behavior","csui/utils/base","csui/lib/numeral","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","hbs!conws/widgets/relatedworkspaces/impl/relateditem","css!conws/widgets/relatedworkspaces/impl/relateditem"],function(e,t,i,s,o,n,a,r,l,c){var d=i.ItemView.extend({"behaviors":{"DefaultAction":{"behaviorClass":n}},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments)},"triggers":{"click .conws-relateditem-border":"click:item"},"events":{"mouseenter":"showPreviewPane","mouseleave":"hidePreviewPane"},"onClickItem":function(){this.destroyPreviewPane(),this.triggerMethod("execute:defaultAction",this.model)},"onBeforeDestroy":function(){this.destroyPreviewPane()},"showPreviewPane":function(){this.options&&this.options.data&&this.options.data.preview&&(this.options.data.preview.roleId||this.options.data.preview.metadata)&&(this.previewPane||(this.previewPane=new o({"parent":this,"context":this.options.context,"config":this.options.data&&this.options.data.preview,"node":this.model})),this.previewPane.show())},"hidePreviewPane":function(){this.previewPane&&this.previewPane.delayedHide()},"destroyPreviewPane":function(){this.previewPane&&(this.previewPane.destroy(),delete this.previewPane)},"className":"conws-relateditem-object clearfix","template":c,"serializeData":function(){var e=this._getObject(this.options.data||{}),t={};return e.title&&(t.title=e.title),e.description&&(t.description=e.description),e.topRight&&(t.topRight=e.topRight),e.bottomLeft&&(t.bottomLeft=e.bottomLeft),e.bottomRight&&(t.bottomRight=e.bottomRight),t.title||(t.title={"value":this.model.get("name")}),t.name||(t.name=this.model.get("name")),t.id||(t.id=this.model.get("id")),t.defaultActionUrl=n.getDefaultActionNodeUrl(this.model),this.model.get("id")!==this.model.collection.models[this.model.collection.models.length-1].get("id")&&(t.notLastItem=!0),t},"templateHelpers":function(e){return e},"_getObject":function(e){return t.reduce(e,function(e,t,i){if("object"!=typeof t)t=this.self._getValue(t);else if("object"==typeof t)if("value"===i||"label"===i){var s=a.getClosestLocalizedString(t);t=this.self._getValue(s)}else t=this.self._getObject(t);return e[i]=t,e},{},{"self":this})},"_getValue":function(e){for(var t,i,s,o,n,a=/{([^:}]+)(:([^}]+))?}/g,r=e;t=a.exec(e);)s=t[0],i=t[1],n=t[3],this.model.collection.columns.models&&(o=this._formatPlaceholder(i,n,this.model.attributes,this.model.collection.columns.models)),r=r.replace(s,o);return r},"_formatPlaceholder":function(e,i,s,o){var n,l,c,d="_expand",p=e;switch(l=t.find(o,function(t){return t.get("column_key")===e}),c=l&&l.get("type")||void 0,e=s[e+d]?e+d:e,n=s[e]||"",c){case-7:n=a.formatDate(n);break;case 5:n=s[e+"_formatted"],(null===n||void 0===n)&&(n="");break;case 14:-1===e.indexOf(d,this.length-d.length)||"User"!==s[e].type_name&&"Group"!==s[e].type_name||(n=a.formatMemberName(n));default:"currency"===i&&(n=r(n).format()),"object"==typeof n&&(n=s[p]||"")}return n}});return d}),csui.define("conws/utils/workspaces/close.expanded.view",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","csui/utils/commandhelper","csui/models/command"],function(e,t,i,s,o,n){var a=n.extend({"defaults":{"signature":"CloseExpandedView","scope":"single"},"enabled":function(){return!0},"execute":function(){}});return a}),csui.define("conws/widgets/relatedworkspaces/commands",["csui/models/commands","csui/utils/commands","conws/utils/workspaces/close.expanded.view"],function(e,t,i){var s=new e([new i].concat(t.models));return s}),csui.define("conws/widgets/relatedworkspaces/toolbaritems",["csui/lib/underscore","i18n!conws/utils/workspaces/impl/nls/lang","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui/widgets/favorites/favorite.star.view","csui-ext!conws/widgets/relatedworkspaces/toolbaritems"],function(e,t,i,s,o,n,a){var r={"addToolbar":new s({"main":[{"signature":"AddRelation","name":i.ToolbarItemAddRelation,"icon":"icon icon-toolbarAdd"}]},{"maxItemsShown":2,"dropDownIcon":"icon icon-toolbar-more","dropDownText":"...","addTrailingDivider":!1}),"tableHeaderToolbar":new s({"main":[{"signature":"RemoveRelation","name":i.ToolbarItemRemoveRelation}]},{"maxItemsShown":15,"dropDownIcon":"icon icon-toolbar-more","dropDownText":"...","addGroupSeparators":!1,"lazyActions":!0}),"rightToolbar":new s({"main":[{"signature":"CloseExpandedView","name":t.ToolbarItemCloseExpandedView,"icon":"icon icon-tileCollapse"}]},{"hAlign":"right","maxItemsShown":5,"dropDownIcon":"icon icon-toolbar-more","dropDownText":"...","addTrailingDivider":!1})};return a&&e.each(a,function(t){e.each(t,function(t,i){var s=r[i];if(s||"otherToolbar"!==i||(s=r.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new o(e),s.addItem(e)})})}),r}),csui.define("conws/widgets/relatedworkspaces/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){function o(){var o=e.config(),a=new s;this.toolbars=t.reduce(n,function(e,s){var n=new i(a,{"normalize":!1});return t.each(o,function(e){e=e[s],e&&n.extendMask(e)}),n.storeMask(),e[s]=n,e},{})}var n=["filterToolbar","leftToolbar","tableHeaderToolbar","inlineActionbar","rightToolbar"];return o.toolbars=n,o}),csui.define("conws/widgets/relatedworkspaces/headermenuitems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!conws/widgets/relatedworkspaces/headermenuitems"],function(e,t,i,s,o){var n={"headerMenuToolbar":new i({"other":[]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return o&&e.each(o,function(t){e.each(t,function(t,i){var o=n[i];if(!o)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new s(e),o.addItem(e)})})}),n}),csui.define("conws/widgets/relatedworkspaces/headermenuitems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){var o=i.extend({"constructor":function(){var o=e.config(),n=new s;i.prototype.constructor.call(this,n,{"normalize":!1}),t.each(o,function(e){this.extendMask(e)},this),this.storeMask()}});return o}),csui.define("hbs!conws/utils/workspaces/workspacestable",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return'<div class="conws-alternating-toolbars">\r\n  <div class="conws-table-tabletoolbar"></div>\r\n  <div class="conws-table-rowselection-toolbar"></div>\r\n</div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return(null!=(o=t["if"].call(e,null!=e?e.showAlternatingToolbar:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'<div class="conws-workspacestable">\r\n  <div id="tableview"></div>\r\n  <div id="paginationview"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_utils_workspaces_workspacestable",s),s}),csui.define("conws/utils/workspaces/workspaces.columns",["csui/lib/backbone"],function(e){var t=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),i=e.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new i(this.map(function(e){return e.attributes}))}}),s=new i([{"key":"type","sequence":10},{"key":"name","sequence":20},{"key":"size","sequence":30},{"key":"modify_date","sequence":40},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}]);return s}),csui.define("css!conws/utils/workspaces/workspacestable",[],function(){}),csui.define("conws/utils/workspaces/workspacestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","i18n!conws/utils/workspaces/impl/nls/lang","hbs!conws/utils/workspaces/workspacestable","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/connector","csui/models/node/node.model","csui/controls/table/table.view","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/utils/commands","csui/controls/toolbar/toolbar.command.controller","csui/controls/pagination/nodespagination.view","conws/utils/workspaces/workspaces.columns","csui/dialogs/modal.alert/modal.alert","csui/utils/accessibility","csui/utils/base","csui/controls/progressblocker/blocker","conws/utils/workspaces/busyindicator","csui/lib/jquery.redraw","css!conws/utils/workspaces/workspacestable","css!conws/utils/workspaces/workspaces","csui/controls/toolbar/toolbar.view"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v,b,y,k,x){var _=e.config(),C={"sortColumn":"{name}","sortOrder":"asc"},T=b.isAccessibleTable(),S=o.LayoutView.extend({"className":function(){var e="conws-workspaces-table";return T&&(e+=" csui-no-animation"),e},"template":r,"ui":{"toolbarContainer":".conws-alternating-toolbars"},"regions":{"tableToolbarRegion":".conws-table-tabletoolbar","tableRowSelectionToolbarRegion":".conws-table-rowselection-toolbar","tableRegion":"#tableview","paginationRegion":"#paginationview"},"behaviors":{"DefaultAction":{"behaviorClass":l}},"constructor":function(e){if(void 0===e||!e.context)throw new Error("Context required to create WorkspacesTableView");if(!e.collection)throw new Error("Collection required to create WorkspacesTableView");if(e.data||(e.data={}),this.context=e.context,this.collection=e.collection,o.LayoutView.prototype.constructor.apply(this,arguments),i.defaults(this.options.data,{"pageSize":_.defaultPageSize||20,"orderBy":{}}),i.defaults(this.options.data.orderBy,C),this.options&&this.options.data&&this.options.data.expandedView&&this.options.data.expandedView.orderBy)if(i.isString(this.options.data.expandedView.orderBy))n.error(a.errorOrderByMustNotBeString)&&console.log(n.last),v.showError(a.errorOrderByMustNotBeString);else if(this.options.data.expandedView.orderBy.sortColumn){var s=/{([^:}]+)(:([^}]+))?}/g,r=s.exec(this.options.data.expandedView.orderBy.sortColumn);r||(n.error(a.errorOrderByMissingBraces)&&console.log(n.last),v.showError(a.errorOrderByMissingBraces))}this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).on("resize.app",this.onWinRefresh),this.options.blockingParentView?k.delegate(this,this.options.blockingParentView):k.imbue(this),this.listenTo(this,"after:show",this.windowRefresh),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",function(e,t){this.unblockActions.apply(this,arguments),t&&v.showError(new y.Error(t).message)}).listenTo(this.collection,"sync",function(){if(this.collection.selectActions){var e=!(!this.options.showSelectColumn||!this.collection.existsSelectable);this.tableView&&this.tableView.options&&this.tableView.options.selectColumn!==e&&(this.tableView.options.selectColumn=e,this.collection.columns.trigger("reset",this.collection.columns))}})},"initialize":function(){if(o.LayoutView.prototype.initialize.apply(this,arguments),this.options.hasTableRowSelection){i.defaults(this.options,{"showCondensedHeaderToggle":!0,"showSelectColumn":!0,"showSelectionCounter":!0}),this.commands=this.options.commands||m,this.commandController=this.options.commandController||new g({"commands":this.commands}),this.listenTo(this.commandController,"before:execute:command",this._beforeExecuteCommand),this.listenTo(this.commandController,"after:execute:command",this._toolbarActionTriggered),this.listenTo(this,"dom:refresh",this._refreshTableToolbar),this.initAllSelection();var e=this.commands,t=i.compact(this.options.toolbarItems.tableHeaderToolbar.collection.map(function(t){return e.get(t.get("signature"))}));this.collection.selectActions=i.flatten(i.map(t,function(e){return e.get("command_key")}))}},"onDestroy":function(){t(window).off("resize.app",this.onWinRefresh)},"_refreshTableToolbar":function(){this.tableToolbarView&&this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter()},"templateHelpers":function(e){return e=e||{},e.showAlternatingToolbar=!!this.options.hasTableRowSelection,e},"doRender":function(e){i.extend(e.options.query,this._getCollectionUrlQuery()),e.setLimit(0,this.options.data.pageSize,!1);var t=this;e.once("sync",function(){t.renderAfterFetch(t,e)}).fetch(),this.options.hasTableRowSelection&&(this._setToolBar(),this._setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":this.options.showCondensedHeaderToggle,"showSelectionCounter":this.options.showSelectionCounter}),this._setTableRowSelectionToolbarEventListeners(),this.tableToolbarRegion.show(this.tableToolbarView),this.tableRowSelectionToolbarRegion&&(this._tableRowSelectionToolbarView&&this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this.tableRowSelectionToolbarRegion.$el.find("ul").attr("aria-label",a.selectedItemActionBarAria)))},"renderAfterFetch":function(e,t){var s=e.collection.columns,o=e.context.getObject(c),n=[];i.each(s.models,function(e){e.get("sort")===!0&&-1===e.get("type")&&n.push(e.get("column_key"))});var r=w.clone();r.add(this._getCustomColumns(!0)),this.tableColumns=r,this.tableView=new p({"context":this.options.context,"connector":o,"collection":t,"columns":s,"tableColumns":r,"columnsWithSearch":n,"selectColumn":!(!this.options.showSelectColumn||!this.collection.existsSelectable),"showSelectionCounter":!!this.options.showSelectionCounter,"allSelectedNodes":this.allSelectedNodes,"pageSize":this.options.data.pageSize,"orderBy":this.collection.orderBy,"nameEdit":!1,"tableTexts":{"zeroRecords":a.noWorkspacesFound}}),this.options.hasTableRowSelection&&this._setTableViewEvents(),this.tableView.enableEmptyViewText(),this.listenTo(this.tableView,"execute:defaultAction",function(e){this.triggerMethod("execute:defaultAction",e)}),this.listenTo(this.tableView,"render",function(){this.tableView.triggerMethod("refresh:tabindexes")}),e.paginationView=new f({"collection":t,"pageSize":e.options.data.pageSize}),i.isUndefined(e.tableView.accFocusedState.body.column)||(e.tableView.accFocusedState.body.column=1),e.tableRegion.show(e.tableView),e.paginationRegion.show(e.paginationView)},"_beforeExecuteCommand":function(e){var t=this;switch((e.command&&e.command.get("showBusy")||e.status.toolItem&&e.status.toolItem.get("showBusy"))&&(e.status.busyIndicator=new x(function(){t.blockActions()},function(){t.unblockActions()}),e.status.busyIndicator.on()),e.commandSignature){case"CloseExpandedView":this.context.trigger("close:expanded",{"widgetView":this})}},"_toolbarActionTriggered":function(e){e.status.busyIndicator&&e.status.busyIndicator.off()},"initAllSelection":function(){this.allSelectedNodes=this.getCollectionWithSpecificModelId(),this.listenTo(this.allSelectedNodes,"remove",this.removeItemToAllSelectedItems).listenTo(this.allSelectedNodes,"add",this.addItemToAllSelectedItems).listenTo(this.allSelectedNodes,"reset",this.resetAllSelectedItems)},"findNodeFromCollection":function(e,t){return e.get(t)||e.findWhere({"id":t.get("id")})},"getCollectionWithSpecificModelId":function(){var e=s.Collection.extend({"modelId":function(e){return e.id}}),t=new e;return this.collection&&this.collection.modelId&&(t.modelId=this.collection.modelId),t},"removeItemToAllSelectedItems":function(e){var t=this.findNodeFromCollection(this.collection,e);t?t.set("csuiIsSelected",!1):e.set("csuiIsSelected",!1)},"addItemToAllSelectedItems":function(e){var t=this.findNodeFromCollection(this.collection,e);t?t.set("csuiIsSelected",!0):e.set("csuiIsSelected",!0)},"resetAllSelectedItems":function(){var e=this.allSelectedNodes;this.collection.each(i.bind(function(t){var i=e.get(t);t.set("csuiIsSelected",void 0!==i)},this))},"_setTableViewEvents":function(){return this.listenTo(this.tableView,"tableRowSelected",function(e){if(this.tableView.cancelAnyExistingInlineForm.call(this.tableView),this.options.showSelectColumn&&this.allSelectedNodes){var t=e.nodes,s=[];i.each(t,function(e){this.allSelectedNodes.get(e)||void 0===e.get("id")||s.push(e)},this),this.allSelectedNodes.reset(s.concat(this.allSelectedNodes.models))}}),this.listenTo(this.tableView,"tableRowUnselected",function(e){if(this.options.showSelectColumn&&this.allSelectedNodes){var t=e.nodes;i.each(t,function(e){this.allSelectedNodes.remove(e,{"silent":!0})},this),this.allSelectedNodes.reset(i.clone(this.allSelectedNodes.models))}}),!0},"_setTableRowSelectionToolbarEventListeners":function(){this.listenTo(this.allSelectedNodes,"reset update",function(){this._tableRowSelectionToolbarView.isDestroyed||this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.allSelectedNodes.length)
})},"_setToolBar":function(){var e=new d({"type":this.collection.node.get("type"),"type_name":this.collection.node.get("type_name"),"parent_id":this.collection.node.get("parent_id"),"image_url":this.collection.titleIcon,"name":this.options.title},{"connector":this.collection.connector});return this.tableToolbarView=new u({"context":this.options.context,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"headermenuItems":this.options.headermenuItems,"headermenuItemsMask":this.options.headermenuItemsMask,"creationToolItemsMask":this.options.creationToolItemsMask,"container":e,"collection":this.collection,"originatingView":this,"blockingParentView":this.options.blockingParentView||this,"addableTypes":this.addableTypes,"toolbarCommandController":this.commandController}),this.tableToolbarView.captionView.nameView.readonly=!0,this.listenTo(this.collection,"sync",function(){this.collection.titleIcon!==e.get("image_url")&&e.set("image_url",this.collection.titleIcon)}),!0},"_setTableRowSelectionToolbar":function(e){this._tableRowSelectionToolbarView=new h({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"showSelectionCounter":e.showSelectionCounter,"commands":this.defaultActionController.commands,"selectedChildren":this.allSelectedNodes,"container":this.collection.node,"context":this.context,"originatingView":this,"collection":this.collection,"scrollableParent":".csui-table-tableview .csui-nodetable"});var t=this._tableRowSelectionToolbarView;this.listenTo(t,"toggle:condensed:header",function(){if(this.$el&&this.$el.hasClass("conws-table-rowselection-toolbar-visible")){var e=!this.$el.hasClass("csui-show-header");this.$el.addClass("csui-transitioning"),this.tableToolbarRegion.$el.one("transitionend",function(){this.$el.removeClass("csui-transitioning"),e||this.tableToolbarRegion.$el.addClass("binf-hidden")}.bind(this)),e&&(this.tableToolbarRegion.$el.removeClass("binf-hidden"),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh")),this.$el&&this.$el.toggleClass("csui-show-header"),t.trigger("toolbar:activity",!0,e)}})},"_triggerToolbarActivityEvent":function(e,t){var i=this._tableRowSelectionToolbarView;i.trigger("toolbar:activity",e,t)},"_onSelectionUpdateCssClasses":function(e){function t(e){s.$el.removeClass("csui-transitioning"),s._triggerToolbarActivityEvent(s._tableRowSelectionToolbarVisible,e),s._tableRowSelectionToolbarVisible?e||s.tableToolbarRegion.$el.addClass("binf-hidden"):s.tableRowSelectionToolbarRegion.$el.addClass("binf-hidden")}var i,s=this,o=this.tableRowSelectionToolbarRegion.$el;T?e>0?this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,this.$el.addClass("csui-transitioning"),o.removeClass("binf-hidden"),this.$el.addClass("conws-table-rowselection-toolbar-visible"),i=this.$el&&this.$el.hasClass("csui-show-header"),t(i)):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.$el.addClass("csui-transitioning"),this.$el&&this.$el.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden"),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),this.$el.removeClass("conws-table-rowselection-toolbar-visible"),t(!1)):e>0?this._tableRowSelectionToolbarVisible||(this.$el.addClass("csui-transitioning"),this._tableRowSelectionToolbarVisible=!0,i=this.$el&&this.$el.hasClass("csui-show-header"),o.removeClass("binf-hidden").redraw().one("transitionend",function(){t(i)}.bind(this)),this.$el.addClass("conws-table-rowselection-toolbar-visible")):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.$el.addClass("csui-transitioning"),this.$el&&this.$el.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden").redraw(),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),o.one("transitionend",function(){t(!1)}.bind(this)),this.$el.removeClass("conws-table-rowselection-toolbar-visible"))},"_getCustomColumns":function(e){var t=[],s=[];if(this.options&&this.options.data&&this.options.data.expandedView&&this.options.data.expandedView.customColumns){var o=!1,r=500;if(this.options.data.expandedView.customColumns.forEach(function(l){var c=/{([^:}]+)(:([^}]+))?}/g,d=c.exec(l.key);d?t.push(i.defaults({"key":d[1],"sequence":r++},l)):e&&(l.key&&l.key.indexOf("{")>=0?(o=!0,n.error(a.errorCustomColumnConfigInvalid,l.key)&&console.log(n.last)):n.error(a.errorCustomColumnMissingBraces,l.key)&&console.log(n.last),s.push(l.key))}),e&&s.length>0){var l=o?a.errorCustomColumnConfigInvalid:a.errorCustomColumnMissingBraces;v.showError(i.str.sformat(l,s.join(", ")))}}return t},"_getCustomColumnKeys":function(){var e=this._getCustomColumns();return e.length>0?t.map(e,function(e){return e.key}):[]},"_getCoreColumnKeys":function(){var e=w.models;return e.length>0?t.map(e,function(e){return e.get("key")}):[]},"getColumnsToFetch":function(){var e=this._getCustomColumnKeys(),s=this._getCoreColumnKeys(),o=["id","type","container"];return i.each(s,function(i){t.inArray(i,e)<0&&e.push(i)}),i.each(o,function(i){t.inArray(i,e)<0&&e.push(i)}),e.toString()},"windowRefresh":function(){this.paginationView&&this.paginationView.triggerMethod("dom:refresh")},"onDomRefresh":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("dom:refresh")})},"onShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("show")})},"onAfterShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})}});return S}),csui.define("css!conws/widgets/relatedworkspaces/impl/relatedworkspacestable",[],function(){}),csui.define("conws/widgets/relatedworkspaces/impl/relatedworkspacestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/header/impl/header.model.factory","conws/widgets/relatedworkspaces/commands","conws/widgets/relatedworkspaces/toolbaritems","conws/widgets/relatedworkspaces/toolbaritems.masks","conws/widgets/relatedworkspaces/headermenuitems","conws/widgets/relatedworkspaces/headermenuitems.masks","conws/utils/workspaces/impl/workspaceutil","conws/utils/workspaces/workspacestable.view","css!conws/widgets/relatedworkspaces/impl/relatedworkspacestable"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m){var g=m.extend({"constructor":function(e){e.workspaceContext||(e.workspaceContext=e.context.getObject(a),e.workspaceContext.setWorkspaceSpecific(r)),m.prototype.constructor.apply(this,arguments),this.collection.workspace=e.workspaceContext.getModel(r),this.collection.workspace.fetch(),this.listenTo(this.collection.workspace,"sync",function(){this.tableToolbarView&&this.tableToolbarView.addToolbarView&&this.tableToolbarView.addToolbarView.collection.refilter()})},"initialize":function(){this.options.commands=l,this.options.hasTableRowSelection=!0,this.options.toolbarItems=c,this.options.toolbarItemsMasks=new d,this.options.headermenuItems=p,this.options.headermenuItemsMasks=new u,m.prototype.initialize.apply(this,arguments)},"onRender":function(){var e=this.collection;e.orderBy=i.isUndefined(this.collection.options.relatedWorkspaces.attributes.sortExpanded)?h.orderByAsString(this.options.data.orderBy):this.collection.options.relatedWorkspaces.attributes.sortExpanded,this.doRender(e)},"_getCollectionUrlQuery":function(){var e={"where_relationtype":this.options.data.relationType};return e.fields=encodeURIComponent("properties{"+this.getColumnsToFetch()+"}"),e.action="properties-properties",e.expand_users="true",e},"_beforeExecuteCommand":function(){m.prototype._beforeExecuteCommand.apply(this,arguments)},"_toolbarActionTriggered":function(e){if(m.prototype._toolbarActionTriggered.apply(this,arguments),e&&!e.cancelled){var t,i=this;switch(e.commandSignature){case"AddRelation":if(i.changed=!0,t=e.newNodes,t&&t.length>0){t.forEach(function(e){e.isLocallyCreated=!0,e.attributes&&delete e.attributes.csuiIsSelected,e.collection=i.collection,e.selectable=!0}),this.collection.totalCount=this.collection.totalCount+t.length,t.length>this.collection.topCount?t=t.slice(0,this.collection.topCount):t.length<this.collection.topCount&&(t=t.concat(this.collection.slice(0,this.collection.topCount-t.length))),this.collection.updateSelectableState(t);var s=!(!this.options.showSelectColumn||!this.collection.existsSelectable);this.tableView&&this.tableView.options&&this.tableView.options.selectColumn!==s?(this.tableView.options.selectColumn=s,this.collection.reset(t,{"silent":!0}),this.collection.columns.trigger("reset",this.collection.columns),this.tableView.resetScrollToTop(),this.paginationView&&this.paginationView.collectionChange()):(this.collection.reset(t),this.tableView&&this.tableView.resetScrollToTop())}break;case"RemoveRelation":this.changed=!0,this.collection.fetch().then(function(){i.collection.totalCount<=i.collection.skipCount&&i.collection.totalCount>0&&i.collection.totalCount<=i.collection.topCount&&(i.collection.skipCount=0,i.collection.fetch())}),this.allSelectedNodes.reset([])}}}});return g}),csui.define("conws/widgets/relatedworkspaces/relatedworkspaces.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/log","conws/models/workspacecontext/workspacecontext.factory","conws/utils/workspaces/workspaces.view","conws/widgets/relatedworkspaces/impl/relateditem.view","conws/widgets/relatedworkspaces/impl/relatedworkspaces.factory","conws/widgets/relatedworkspaces/impl/relatedworkspacestable.view","csui/dialogs/modal.alert/modal.alert","csui/utils/base","conws/utils/workspaces/impl/workspaceutil","i18n!conws/utils/workspaces/impl/nls/lang","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","css!conws/utils/icons/icons","hbs!conws/widgets/relatedworkspaces/impl/relateditem","css!conws/widgets/relatedworkspaces/impl/relateditem"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g){var f=r.extend({"constructor":function(e){if(this.viewClassName="conws-relatedworkspaces",e.workspaceContext||(e.workspaceContext=e.context.getObject(a),e.workspaceContext.setWorkspaceSpecific(c)),r.prototype.constructor.apply(this,arguments),this.limit=-1,this.options&&this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.orderBy)if(i.isString(this.options.data.collapsedView.orderBy))n.error(m.errorOrderByMustNotBeString)&&console.log(n.last),p.showError(m.errorOrderByMustNotBeString);else if(this.options.data.collapsedView.orderBy.sortColumn){var t=/{([^:}]+)(:([^}]+))?}/g,s=t.exec(this.options.data.collapsedView.orderBy.sortColumn);s||(n.error(m.errorOrderByMissingBraces)&&console.log(n.last),p.showError(m.errorOrderByMissingBraces))}if(this.options&&this.options.data&&this.options.data.collapsedView){var o=[],l=this;["title","description","topRight","bottomLeft","bottomRight"].forEach(function(e){l.options.data.collapsedView[e]&&l.options.data.collapsedView[e].format&&o.push(e)}),o.length>0&&p.showError(i.str.sformat(g.errorFieldFormatTagUnrecognized,o.join(", ")))}},"getContext":function(){return this.options.workspaceContext},"childView":l,"childViewOptions":function(){return{"context":this.options.context,"data":this.options.data.collapsedView}},"emptyViewOptions":{"templateHelpers":function(){return{"text":this._parent._getNoResultsPlaceholder()}}},"workspacesCollectionFactory":c,"workspacesTableView":d,"dialogClassName":"relatedworkspaces","lang":g,"_getExpandedViewOptions":function(){var e=i.extend(r.prototype._getExpandedViewOptions.apply(this,arguments),{"title":this._getTitle()});return e},"_getCollectionAttributes":function(){var e={"workspaceTypeId":this.options.data.workspaceTypeId,"relationType":this.options.data.relationType,"sortExpanded":this.options.data.expandedView&&h.orderByAsString(this.options.data.expandedView.orderBy)||void 0,"sortCollapsed":this.options.data.collapsedView&&h.orderByAsString(this.options.data.collapsedView.orderBy)||this._getDefaultSortOrder()||void 0,"title":u.getClosestLocalizedString(this.options.data.title,g.dialogTitle)};return e},"_getDefaultSortOrder":function(){return this._getFilterPropertyName()?this._getFilterPropertyName()+" asc":void 0},"_getCollectionUrlQuery":function(){var e=this.options,t={},s=this._getPropertiesToFetch(e.data.collapsedView),o=["id","container","name","type"];o=i.union(o,s),t.fields=encodeURIComponent("properties{"+o.join(",")+"}"),t.action="properties-properties",t.where_workspace_type_id=e.data.workspaceTypeId,t.where_relationtype=e.data.relationType;var n;return e.data.collapsedView&&(n=h.orderByAsString(e.data.collapsedView.orderBy)),n||(n=this._getDefaultSortOrder()),n&&(t.sort=n),t.expand_users="true",t},"_getFirstPlaceholder":function(e){for(var t,i,s,o,n=/{([^:}]+)(:([^}]+))?}/g;t=n.exec(e);)if(s=t[0],i=t[1]){o=t;break}return o},"_getFilterPropertyName":function(){var e;if(this.options&&this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.title&&this.options.data.collapsedView.title.value){var t=this._getFirstPlaceholder(this.options.data.collapsedView.title.value);t&&(e=t[1])}return e},"_getConfiguredProperties":function(e){var t,i={},s=/{([^:}]+)(:([^}]+))?}/g,n=function(e){if("object"!=typeof e)for(;t=s.exec(e);)i[t[1]]="";else o.each(e,function(e,t){n(t)})};return n(e),i},"_getPropertiesToFetch":function(e){var t=this._getConfiguredProperties(e);return Object.keys(t)},"getElementByIndex":function(e){if(isNaN(e)||0>e)return null;var t=this.$(i.str.sformat(".conws-relateditem-object:nth-child({0}) .conws-relateditem-border",e+1));return this.$(t[0])}});return f}),csui.define("conws/widgets/header/impl/nls/header.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/header/impl/nls/root/header.lang",{"changeIconDialogTitle":"Change picture","changeIconDialogMessage":"For best results, use square images. Use JPEG, PNG or GIF formats not larger than %1.","changeIconDialogBtnReset":"Reset","changeIconDialogBtnResetTitle":"Reset to configured icon","changeIconDialogBtnUpload":"Change","changeIconDialogBtnUploadTitle":"Change to individual icon","changeIconDialogBtnCancel":"Cancel","changeIconDialogBtnCancelTitle":"Cancel","changeIconDialogDefaultError":"The image cannot be changed due to a server error.","chooseInpFileTitle":"Choose file","iconMessage":"Business Workspace Edit Icon","CollapsePageOverlay":"Close"}),csui.define("hbs!conws/widgets/header/impl/editicon",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t){var i;return'        <p class="reset" title="'+this.escapeExpression((i=null!=(i=t.resetTitle||(null!=e?e.resetTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"resetTitle","hash":{}}):i))+'"><a href="#">'+this.escapeExpression((i=null!=(i=t.reset||(null!=e?e.reset:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"reset","hash":{}}):i))+"</a></p>\r\n"},"3":function(e,t){var i;return'        <button type="button" class="binf-btn binf-btn-primary upload"\r\n                title="'+this.escapeExpression((i=null!=(i=t.uploadTitle||(null!=e?e.uploadTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"uploadTitle","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.upload||(null!=e?e.upload:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"upload","hash":{}}):i))+"</button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return"<div class=\"conws-popover\">\r\n  <div class='title'>"+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</div>\r\n  <div class='message'>"+this.escapeExpression((n=null!=(n=t.message||(null!=e?e.message:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))+'</div>\r\n  <div class="buttons">\r\n    <div class="buttons binf-left">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.resetButton:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'    </div>\r\n    <div class="buttons binf-right">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.uploadButton:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+'      <button type="button" class="binf-btn binf-btn-default cancel"\r\n              title="'+this.escapeExpression((n=null!=(n=t.cancelTitle||(null!=e?e.cancelTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancelTitle","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.cancel||(null!=e?e.cancel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel","hash":{}}):n))+"</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_header_impl_editicon",s),s}),csui.define("css!conws/widgets/header/impl/editicon",[],function(){}),csui.define("conws/widgets/header/impl/editicon.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!conws/widgets/header/impl/nls/header.lang","hbs!conws/widgets/header/impl/editicon","css!conws/widgets/header/impl/editicon"],function(e,t,i,s,o,n){var a=s.ItemView.extend({"classname":"conws-popover","template":n,"triggers":{"click .reset > a":"click:reset","click .upload":"click:upload","click .cancel":"click:cancel"},"events":{"keydown":"onKeyDown"},"constructor":function(e){e||(e={}),e.title=e.title||o.changeIconDialogTitle,e.message=e.message||o.changeIconDialogMessage,e.resetButton=void 0!==e.resetButton?e.resetButton:!0,e.uploadButton=void 0!==e.uploadButton?e.uploadButton:!0,this.tabableElements=[],(t.isFunction(e.resetButton)&&e.resetButton()||e.resetButton===!0)&&this.tabableElements.push(".reset > a"),this.tabableElements.push(".upload",".cancel");var n=this;i(".conws-header-edit").on("shown.binf.popover",function(){n._currentlyFocusedElement=n.tabableElements[0],n.$el.find(n._currentlyFocusedElement).focus(),i(".conws-header-edit").off("shown.binf.popover")}),s.ItemView.prototype.constructor.call(this,e)},"templateHelpers":function(){return{"title":this.options.title,"message":this.options.message,"resetButton":this.options.resetButton,"reset":o.changeIconDialogBtnReset,"resetTitle":o.changeIconDialogBtnResetTitle,"uploadButton":this.options.uploadButton,"upload":o.changeIconDialogBtnUpload,"uploadTitle":o.changeIconDialogBtnUploadTitle,"cancel":o.changeIconDialogBtnCancel,"cancelTitle":o.changeIconDialogBtnCancelTitle}},"_focusNextElement":function(e){var i=!0,s=t.indexOf(this.tabableElements,this._currentlyFocusedElement);e?--s<0&&(s=this.tabableElements.length-1):++s===this.tabableElements.length&&(s=0);var o=this.tabableElements[s],n=this.$el.find(o);return 1===n.length&&n.is(":visible")&&(this._currentlyFocusedElement=o,n.focus()),i},"onKeyDown":function(e){switch(e.keyCode){case 9:this._focusNextElement(e.shiftKey)&&(e.preventDefault(),e.stopPropagation());break;case 27:e.preventDefault(),e.stopPropagation(),i(".cancel").click()}},"onClick":function(e){"function"==typeof this.options.callback&&this.options.callback(e)},"onClickReset":function(){this.onClick("reset")},"onClickUpload":function(){this.onClick("upload")},"onClickCancel":function(){this.onClick("cancel")}});return a}),csui.define("css!conws/widgets/header/impl/favorite.icon",[],function(){}),csui.define("conws/widgets/header/impl/favorite.icon.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/widgets/favorites/favorite.star.view","css!conws/widgets/header/impl/favorite.icon"],function(e,t,i,s,o){var n=o.extend({"behaviors":{"TabableRegion":{"behaviorClass":s}},"constructor":function(e){o.prototype.constructor.call(this,e)},"currentlyFocusedElement":function(){return this.$el.find("button")},"onKeyInView":function(e){(32===e.keyCode||13===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.enabled()&&this.toggleFavorite())}});return n}),csui.define("hbs!conws/widgets/header/impl/commenting.icon",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(){return'<div class="conws-comment-icon"></div>\r\n'}});return i.registerPartial("conws_widgets_header_impl_commenting.icon",s),s}),csui.define("css!conws/widgets/header/impl/commenting.icon",[],function(){}),csui.define("conws/widgets/header/impl/commenting.icon.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","esoc/widgets/utils/commentdialog/commentdialog.view","hbs!conws/widgets/header/impl/commenting.icon","css!conws/widgets/header/impl/commenting.icon"],function(e,t,i,s,o,n){var a=i.LayoutView.extend({"className":"conws-comment-icon","template":n,"behaviors":{"TabableRegion":{"behaviorClass":s}},"events":{"keydown":"onKeyDown"},"constructor":function(e){i.LayoutView.prototype.constructor.call(this,e)},"enabled":function(){var e=this.model,t=e.actions.findWhere({"signature":"comment"});return Boolean(t)},"onRender":function(){var e=this,t=new i.Region({"el":e.el}),s="undefined"!=typeof window.require?window.require.s.contexts._.config:window.csui.require.s.contexts._.config;s.roId=e.model.get("id");var n=new o({"connector":e.model.connector,"nodeid":e.model.get("id"),"CSID":e.model.get("id"),"context":e.options.context,"useIconsForDarkBackground":this.options.useIconsForDarkBackground});t.show(n),this.commentCount=this.model.get("wnd_comments"),this.commentCount&&this.commentCount>0&&this.$el.addClass("conws-has-comments")},"onKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.currentlyFocusedElement().click())},"currentlyFocusedElement":function(){return this.$el.find("a")}});return a}),csui.define("conws/widgets/header/impl/headertoolbaritems",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","conws/widgets/header/impl/favorite.icon.view","conws/widgets/header/impl/commenting.icon.view","csui-ext!conws/widgets/header/headertoolbaritems"],function(e,t,i,s,o,n,a,r){var l={"rightToolbar":new i({"main":[{"signature":"Comment","name":o.ToolbarItemComment,"icon":"icon icon-socialComment","enabled":!0,"className":"esoc-socialactions-comment","customView":!0,"viewClass":a,"commandData":{"useContainer":!0},"index":4},{"signature":"Favorite2","enabled":!0,"viewClass":n,"customView":!0,"commandData":{"useContainer":!0},"index":5}]}),"delayedActionsToolbar":new i({"menu":[{"signature":"CopyLink","name":o.ToolbarItemCopyLink},{"signature":"Share","name":o.ToolbarItemShare}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1,"dropDownText":o.ToolbarItemMore,"customView":!0})};return r&&t.each(r,function(e){t.each(e,function(e,i){var o=l[i];o&&t.each(e,function(e){e=new s(e),o.addItem(e)})})}),l.rightToolbar.collection.comparator=function(e){return e.get("index")},l.rightToolbar.collection.sort(),l}),csui.define("hbs!conws/widgets/header/impl/headertoolbar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return'      <div class="conws-rightToolbar" ></div>   \r\n      <div class="conws-delayedActionsToolbar"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="conws-tabletoolbar tile-nav" aria-label="Table menubar" role="menu">\r\n   \r\n   <div class="conws-header-status-indicators-section">\r\n      <div class="conws-header-status-indicators">        \r\n      </div>\r\n      <div class="conws-header-status-toolbar-divider"></div>\r\n   </div>\r\n'+(null!=(o=t["if"].call(e,null!=e?e.hasToolbarView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'      <div class="conws-header-collapse"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_header_impl_headertoolbar",s),s}),csui.define("hbs!conws/widgets/header/impl/collapse/collapse",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-collapse '+this.escapeExpression((i=null!=(i=t.icon||(null!=e?e.icon:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"icon","hash":{}}):i))+'" role="button" tabindex="0" title="'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'"></div>'}});return i.registerPartial("conws_widgets_header_impl_collapse_collapse",s),s}),csui.define("css!conws/widgets/header/impl/collapse/collapse",[],function(){}),csui.define("conws/widgets/header/impl/collapse/collapse.page.overlay",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","hbs!conws/widgets/header/impl/collapse/collapse","i18n!conws/widgets/header/impl/nls/header.lang","css!conws/widgets/header/impl/collapse/collapse"],function(e,t,i,s,o){var n=i.ItemView.extend({"className":"conws-collapse","template":s,"events":{"keydown":"onKeyInView","click":"_executeCollapse"},"constructor":function(e){this.options=e||{},this.options.title=o.CollapsePageOverlay,this.options.icon="icon conws-collapse-icon",i.ItemView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){var e={"title":this.options.title,"icon":this.options.icon};return e},"onKeyInView":function(t){e(t.target);(13===t.keyCode||32===t.keyCode)&&this._executeCollapse(t)},"_executeCollapse":function(){var e=window.opener?window.opener:window!==window.parent?window.parent:void 0;e&&e.postMessage({"status":"closeDialog"},"*")}});return n}),csui.define("css!conws/widgets/header/impl/headertoolbar",[],function(){}),csui.define("conws/widgets/header/impl/headertoolbar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","hbs!conws/widgets/header/impl/headertoolbar","conws/controls/lazyactions/lazyToolbar.view","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/toolitems.filtered.model","csui/utils/commands","csui/controls/toolbar/toolbar.command.controller","csui/models/nodes","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/header/impl/collapse/collapse.page.overlay","css!conws/widgets/header/impl/headertoolbar"],function(e,t,i,s,o,n,a,r,l,c,d,p,u){var h=s.LayoutView.extend({"template":o,"regions":{"statusIndicatorsRegion":".conws-header-status-indicators","dividerRegion":".conws-header-status-toolbar-divider","toolbarRegion":".conws-rightToolbar","delayedActionsToolbarRegion":".conws-delayedActionsToolbar","collapseRegion":".conws-header-collapse"},"ui":{"toolbarRegion":".conws-rightToolbar","delayedActionsToolbarRegion":".conws-delayedActionsToolbar","statusIndicatorsRegion":".conws-header-status-indicators","dividerRegion":".conws-header-status-toolbar-divider","collapseRegion":".conws-header-collapse"},"templateHelpers":function(){var e={"hasToolbarView":!this.options.hideToolbar};return e},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(e){if(!e.hideToolbar){var t=e.toolbarItems,i=e.toolbarItemsMasks,s=e.node,o=new d(s);o.connector=s.connector,this.commandController=new c({"commands":e.commands||l}),this.commonToolbarOptions={"originatingView":e.originatingView,"context":e.context,"toolbarCommandController":this.commandController,"container":e.container,"useIconsForDarkBackground":e.useIconsForDarkBackground};var n=t?t.rightToolbar:void 0,a=i?i.toolbars.rightToolbar:void 0;this._righttoolbarView=this._setToolbarView(s.clone(),n,a,!1,t.rightToolbar.options);var r=t?t.delayedActionsToolbar:void 0,p=i?i.toolbars.delayedActionsToolbar:void 0;this._delayedActionsToolbarView=this._setToolbarView(s,r,p,!0,t.delayedActionsToolbar.options)}e.statusIndicatorsView&&e.statusIndicatorsViewOptions&&(this._statusIndicatorsView=new e.statusIndicatorsView(e.statusIndicatorsViewOptions)),e.enableCollapse&&(this._collapseView=new u),e.originatingView&&this.listenTo(e.originatingView,"adjust:toolbar",this.adjustToolbar),this.listenTo(this,"dom:refresh",this._DomRefresh),this.listenTo(this,"status:indicator:available",this.showDivider),this._delayedActionsToolbarView&&this.listenTo(this._delayedActionsToolbarView,"render",this._DomRefresh)},"onRender":function(){this.delegateEvents(),this._statusIndicatorsView&&this.statusIndicatorsRegion.show(this._statusIndicatorsView),this._righttoolbarView&&this.toolbarRegion.show(this._righttoolbarView),this._delayedActionsToolbarView&&this.delayedActionsToolbarRegion.show(this._delayedActionsToolbarView),this._collapseView&&this.collapseRegion.show(this._collapseView),this._showDivider&&this.ui.dividerRegion.addClass("divider-show")},"_setToolbarView":function(e,i,s,o,l){var c=new d(e);c.connector=e.connector;var p=t.extend(this.commonToolbarOptions,{"nodes":c}),u=new r(i,{"status":p,"commands":this.commandController.commands,"mask":s}),h=o?n:a,m=new h(t.extend({"collection":u},this.commonToolbarOptions,l));return m},"showDivider":function(){(this._collapseView||!this.options.hideToolbar)&&(this._showDivider=!0,this.ui.dividerRegion.addClass("divider-show"))},"onDestroy":function(){this._statusIndicatorsView&&this._statusIndicatorsView.destroy(),this._righttoolbarView&&this._righttoolbarView.destroy(),this._delayedActionsToolbarView&&this._delayedActionsToolbarView.destroy(),this._collapseView&&this._collapseView.destroy()},"_DomRefresh":function(){this._righttoolbarView&&this._righttoolbarView.triggerMethod("dom:refresh"),this._delayedActionsToolbarView&&this._delayedActionsToolbarView.triggerMethod("delayed:toolbar:refresh")},"adjustToolbar":function(){var e=-1;arguments&&arguments.length>0&&(e=arguments[0].tabIndex),0===this.$el.find(".binf-dropdown").length&&this._DomRefresh()}});return t.extend(h.prototype,p),h}),csui.define("hbs!conws/widgets/header/impl/header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(){return"-childview"},"3":function(e,t){var i;return'        <div class="conws-header-edit" tabindex="0" role="button" data-binf-toggle="popover"\r\n             aria-label="'+this.escapeExpression((i=null!=(i=t.iconMsg||(null!=e?e.iconMsg:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconMsg","hash":{}}):i))+'">\r\n          <div class="header-image">\r\n            <img src="'+this.escapeExpression((i=null!=(i=t.iconData||(null!=e?e.iconData:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconData","hash":{}}):i))+'" alt="'+this.escapeExpression((i=null!=(i=t.type||(null!=e?e.type:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"type","hash":{}}):i))+'" class="'+this.escapeExpression((i=null!=(i=t.iconClass||(null!=e?e.iconClass:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconClass","hash":{}}):i))+'">\r\n          </div>\r\n          <div class="header-editor">\r\n            <span class="icon-edit"></span>\r\n          </div>\r\n        </div>\r\n        <input class="conws-header-icon-file" title="'+this.escapeExpression((i=null!=(i=t.chooseInpFileTitle||(null!=e?e.chooseInpFileTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"chooseInpFileTitle","hash":{}}):i))+'" type="file"\r\n               accept="'+this.escapeExpression((i=null!=(i=t.iconFileTypes||(null!=e?e.iconFileTypes:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconFileTypes","hash":{}}):i))+'" style="display:none">\r\n'},"5":function(e,t){var i;return'        <img src="'+this.escapeExpression((i=null!=(i=t.iconData||(null!=e?e.iconData:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconData","hash":{}}):i))+'" alt="'+this.escapeExpression((i=null!=(i=t.type||(null!=e?e.type:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"type","hash":{}}):i))+'" class="'+this.escapeExpression((i=null!=(i=t.iconClass||(null!=e?e.iconClass:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconClass","hash":{}}):i))+'">\r\n'
},"7":function(e,t,i,s){var o;return'      <div class="conws-header-metadata-container">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.hasWorkspaceType:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.hasDescription:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t["if"].call(e,null!=e?e.hasMetadataExtension:e,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?o:"")+"      </div>\r\n"},"8":function(e,t){var i;return'          <div class="conws-header-type">\r\n            <p title="'+this.escapeExpression((i=null!=(i=t.type||(null!=e?e.type:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"type","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.type||(null!=e?e.type:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"type","hash":{}}):i))+"</p>\r\n          </div>\r\n"},"10":function(e,t,i,s){var o;return null!=(o=t.unless.call(e,null!=e?e.isDescriptionEmpty:e,{"name":"unless","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?o:""},"11":function(){return'            <div class="conws-header-desc"></div>\r\n'},"13":function(){return'          <div class="conws-header-metadata-extension"></div>\r\n'},"15":function(){return'    <div class="conws-header-childView-container">\r\n      <div id="conws-header-childview"></div>\r\n    </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="conws-header-wrapper">\r\n  <div class="conws-header-metadata'+(null!=(o=t["if"].call(e,null!=e?e.hasChildView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'">\r\n    <div class="conws-header-image">\r\n'+(null!=(o=t["if"].call(e,null!=e?e.canChange:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?o:"")+'    </div>\r\n    <div class="conws-header-title-section">\r\n      <div class="conws-header-title">\r\n        <h1 title="'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</h1>\r\n\r\n        <div class="conws-header-child-displayUrl"></div>\r\n      </div>\r\n\r\n       <div class="conws-header-toolbar"></div>\r\n      \r\n    </div>\r\n'+(null!=(o=t["if"].call(e,null!=e?e.hasMetadata:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?o:"")+"  </div>\r\n\r\n"+(null!=(o=t["if"].call(e,null!=e?e.hasChildView:e,{"name":"if","hash":{},"fn":this.program(15,s,0),"inverse":this.noop}))?o:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_header_impl_header",s),s}),csui.define("css!conws/widgets/header/impl/header",[],function(){}),csui.define("conws/widgets/header/header.view",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/utils/log","csui/utils/url","csui/utils/nodesprites","csui/dialogs/modal.alert/modal.alert","esoc/widgets/activityfeedwidget/activityfeedfactory","esoc/widgets/activityfeedwidget/activityfeedcontent","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/header/impl/editicon.view","conws/widgets/header/impl/header.model.factory","conws/widgets/header/impl/header.icon.model","conws/widgets/header/impl/headertoolbaritems","conws/widgets/header/impl/headertoolbaritems.masks","conws/models/favorite.model","conws/controls/description/description.view","conws/widgets/header/impl/headertoolbar.view","i18n!conws/widgets/header/impl/nls/header.lang","csui/utils/contexts/factories/node","hbs!conws/widgets/header/impl/header","css!conws/widgets/header/impl/header"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v,b,y,k,x,_){var C={"activityfeedwidget":"esoc/widgets/activityfeedwidget"},T=e.config(),S=o.LayoutView.extend({"className":"conws-header","template":_,"templateHelpers":function(){var e={"canChange":this.model.hasAction("upload-icon")||this.model.hasAction("update-icon")||this.model.hasAction("delete-icon"),"iconData":this.getImageInfo().iconContent,"iconClass":this.getImageInfo().iconClass,"iconFileTypes":this.options.data.iconFileTypes,"chooseInpFileTitle":this.options.data.chooseInpFileTitle,"iconMsg":k.iconMessage,"title":this.resolveProperty("title"),"type":this.resolveProperty("type"),"description":this.resolveProperty("description"),"hasChildView":this.hasChildView(),"hasDescription":!this.options.hideDescription,"isDescriptionEmpty":this.hasEmptyDescription(),"hasWorkspaceType":!this.options.hideWorkspaceType,"hasMetadataExtension":this.options.hasMetadataExtension,"hasMetadata":!this.options.hideDescription||!this.options.hideWorkspaceType||this.options.hasMetadataExtension};return e},"regions":{"childViewRegion":"#conws-header-childview","toolBarRegion":".conws-header-toolbar","descriptionRegion":".conws-header-desc"},"triggers":{"change .conws-header-icon-file":"set:icon","mouseleave .conws-header-wrapper":"mouse:leave"},"events":{"keydown":"onKeyDown"},"isTabable":function(){return 0===s(".cs-tabbed-perspective.cs-collapse").length},"currentlyFocusedElement":function(){return this.$el.find(".conws-header-edit")},"onKeyDown":function(e){(13===e.keyCode||32===e.keyCode)&&s(e.target).hasClass("conws-header-edit")&&(e.preventDefault(),e.stopPropagation(),0===s(".cs-collapse").length&&s(e.target).binf_popover("show"))},"onMouseLeave":function(){s(".conws-header-edit").binf_popover("hide")},"blankImage":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=","defaultIconFileTypes":"image/gif, image/x-png, image/jpeg, image/pjpeg, image/png, image/svg+xml","defaultIconFileSize":1048576,"constructor":function(e){if(e||(e={}),!e.context)throw new Error("Context is missing in the constructor options");if(e.data.iconFileTypes||(e.data.iconFileTypes=this.defaultIconFileTypes),e.data.iconFileSize||(e.data.iconFileSize=this.defaultIconFileSize),e.data.chooseInpFileTitle||(e.data.chooseInpFileTitle=k.chooseInpFileTitle),e.hideToolbar=e.hideToolbar?!!e.hideToolbar:!!T.hideToolbar,e.hideToolbarExtension=e.hideToolbarExtension?!!e.hideToolbarExtension:!!T.hideToolbarExtension,e.hideActivityFeed=e.hideActivityFeed?!!e.hideActivityFeed:!!T.hideActivityFeed,e.hideDescription=e.hideDescription?!!e.hideDescription:!!T.hideDescription,e.hideWorkspaceType=e.hideWorkspaceType?!!e.hideWorkspaceType:!!T.hideWorkspaceType,e.hasMetadataExtension=e.hasMetadataExtension?!!e.hasMetadataExtension:!!T.hasMetadataExtension,e.toolbarBlacklist=e.toolbarBlacklist?e.toolbarBlacklist:T.toolbarBlacklist,e.extensionToolbarBlacklist=e.extensionToolbarBlacklist?e.extensionToolbarBlacklist:T.extensionToolbarBlacklist,e.expandDescription=!0,e.enableCollapse=!!T.enableCollapse,e.workspaceContext||(e.workspaceContext=e.context.getObject(u),e.workspaceContext.setWorkspaceSpecific(m),e.workspaceContext.setWorkspaceSpecific(d)),e.model=e.workspaceContext.getModel(m),e.data.widget&&e.data.widget.type&&"activityfeed"===e.data.widget.type&&(e.data.widget.type=C.activityfeedwidget,e.data.widget.options||(e.data.widget.options={})),(Array.isArray(e.toolbarBlacklist)&&e.toolbarBlacklist.length>0||Array.isArray(e.delayedToolbarBlacklist)&&e.delayedToolbarBlacklist.length>0)&&(e.headerToolbarItemsMask=new w({"rightToolbar":{"blacklist":e.toolbarBlacklist},"delayedActionsToolbar":{"blacklist":e.delayedToolbarBlacklist}})),(Array.isArray(e.extensionToolbarBlacklist)&&e.extensionToolbarBlacklist.length>0||Array.isArray(e.extensionToolbarDelayedActionsBlacklist)&&e.extensionToolbarDelayedActionsBlacklist.length>0)&&(e.headerExtensionToolbarItemsMask=new w({"rightToolbar":{"blacklist":e.extensionToolbarBlacklist},"delayedActionsToolbar":{"blacklist":e.extensionToolbarDelayedActionsBlacklist}})),e.workspaceNode=e.workspaceContext.getModel(x),o.LayoutView.prototype.constructor.call(this,e),s(window).on("resize",i.bind(this.onWindowResize,this)),this.model.fetched=!1,this.listenTo(this.model,"change",i.bind(function(){this.model.fetched=!0,this.render()},this)),this.iconModel=new g({},{"connector":this.model.connector,"node":this.model}),this.listenTo(this.iconModel,"icon:change",this.onIconChanged),this.hasChildView()){var t=this.options.data.widget;t.type===C.activityfeedwidget&&(this._makeActivityWidget(),this.listenTo(this.model.node,"change:id",this._makeActivityWidget))}this.options.workspaceNode.nonPromotedActionCommands=this.getDelayedHeaderViewActions(),this.options.hideToolbarExtension||(this.tabBarRightExtensionView=y,this.tabBarRightExtensionViewOptions={"context":this.options.context,"node":this.options.workspaceNode,"toolbarItems":this.options.headerExtensionToolbaritems||f,"container":this.options.workspaceNode,"originatingView":this,"toolbarItemsMasks":this.options.headerExtensionToolbarItemsMask,"useIconsForDarkBackground":!0,"customClass":"conws-header-toolbar-extension conws-header-toolbar"},this.disableExtensionOnOtherTabs=!0),this.listenTo(this,"dom:refresh",this.onDomRefresh),this.listenTo(this,"active:tab",function(){this.triggerMethod("adjust:toolbar")}),this.listenTo(this,"render",this.postCallbackFucntion)},"postCallbackFucntion":function(){this.headerToolbarView=new y({"context":this.options.context,"node":this.options.workspaceNode,"toolbarItems":this.options.headertoolbaritems?this.options.headertoolbaritems:f,"toolbarItemsMasks":this.options.headerToolbarItemsMask,"container":this.options.workspaceNode,"originatingView":this,"hideToolbar":this.options.hideToolbar,"useIconsForDarkBackground":!0,"statusIndicatorsView":this.options.statusIndicatorsView,"statusIndicatorsViewOptions":this.options.statusIndicatorsViewOptions,"enableCollapse":this.options.enableCollapse}),this.toolBarRegion.show(this.headerToolbarView)},"addActivityFeedClass":function(){this.$el.find("#conws-header-childview").find(".esoc-activityfeed-contentwidget").has(".esoc-activityfeed-list-item").length?this.$el.parent().addClass("conws-activityfeed-configured").removeClass("conws-activityfeed-configured-nodata"):this.$el.find("#conws-header-childview").has(".esoc-activityfeed-contentwidget .esoc-empty-activityfeed-message").length?this.$el.parent().addClass("conws-activityfeed-configured-nodata").removeClass("conws-activityfeed-configured"):this.$el.parent().removeClass("conws-activityfeed-configured-nodata").removeClass("conws-activityfeed-configured")},"onDomRefresh":function(){this.addActivityFeedClass(),this._clampTexts(),this.hasChildView()&&this.childViewRegion.currentView&&this.childViewRegion.currentView.triggerMethod("dom:refresh"),this.headerToolbarView.triggerMethod("dom:refresh"),this.descriptionView&&this.descriptionView.ui.readMore.is(":hidden")&&this.descriptionView.ui.showLess.is(":visible")&&(this.descriptionView.ui.showLess.click(),this.currentlyFocusedElement().trigger("focus")),this.isTabable()?this.currentlyFocusedElement().attr("tabindex","0"):this.currentlyFocusedElement().attr("tabindex","-1")},"onWindowResize":function(){this._clampTexts()},"onDestroy":function(){s(window).off("resize",this.onWindowResize),this._observer&&this._observer.disconnect(),this.headerToolbarView&&this.headerToolbarView.destroy()},"onIconChanged":function(){this.model.fetch()},"onSetIcon":function(){var e=s(".conws-header-icon-file")[0].files;"node"===this.getImageInfo().iconLocation?this.iconModel.update(e).fail(function(e){var t=new n.RequestErrorMessage(e).message||k.changeIconDialogDefaultError;c.showError(t)}):this.iconModel.add(e).fail(function(e){var t=new n.RequestErrorMessage(e).message||k.changeIconDialogDefaultError;c.showError(t)})},"renderPopover":function(){var e=this.getImageInfo(),t=this,s=new h({"message":k.changeIconDialogMessage.replace("%1",n.getReadableFileSizeString(t.options.data.iconFileSize)),"resetButton":function(){return"node"===e.iconLocation&&t.model.hasAction("delete-icon")},"uploadButton":function(){return"type"!==e.iconLocation&&t.model.hasAction("upload-icon")||"node"!==e.iconLocation&&t.model.hasAction("update-icon")},"callback":i.bind(this.onClickPopover,this)});return s.render().el},"onClickPopover":function(e){s(".conws-header-edit").binf_popover("hide"),"reset"===e?this.iconModel.remove().fail(function(e){var t=new n.RequestErrorMessage(e).message||k.changeIconDialogDefaultError;c.showError(t)}):"upload"===e&&(this.$(".conws-header-icon-file").trigger("click"),n.isTouchBrowser()&&this.$(".conws-header-icon-file").trigger("click")),this.currentlyFocusedElement().trigger("focus")},"onShow":function(){var e=this,t=s(".cs-perspective-panel");1===t.length&&(this._observer=new MutationObserver(function(t){t.forEach(function(t){var i=s(t.target);i.hasClass("cs-tabbed-perspective")&&(e.titleClampLines=i.hasClass("cs-collapse")?1:2,e._clampTexts())})}),this._observer.observe(t[0],{"attributes":!0,"attributeFilter":["class"],"subtree":!0}))},"onRender":function(){if(this.model.fetched){this.$el.parent().addClass("conws-header-widget");var e=this,t=this.$(".conws-header-edit");if(t.binf_popover({"container":".conws-header-wrapper","animation":!0,"html":!0,"content":i.bind(this.renderPopover,this)}),this.hasChildView()&&(e.activityFeedContent||this._makeActivityWidget(),e.activityFeedContent)){var s=e.activityFeedContent.contentView.unblockActions();e.childViewRegion.show(s),e.activityFeedContent=void 0}if(!this.options.hideDescription&&!this.hasEmptyDescription()){var o={"view":this,"complete_desc":this.resolveProperty("description"),"expandDescription":this.options.expandDescription};this.descriptionView=new b(o),this.descriptionRegion.show(this.descriptionView),this.$el.parent().addClass("conws-description-available")}}},"hasEmptyDescription":function(){var e=this.resolveProperty("description");return""===e},"_clampTexts":function(){this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(i.bind(function(){var e=s(".conws-header-title > p");0!==e.length&&(e.text(e.attr("title")),this.clamp(e[0],e.parent().outerHeight()))},this),200)},"_makeActivityWidget":function(){if(this.activityFeedContent=void 0,this.model.node.get("id")){var e=this.options.data&&this.options.data.widget;if(e&&e.type===C.activityfeedwidget){var t=s.extend({},e.options,{"feedsize":10,"feedtype":"all","feedSettings":{"enableComments":!0,"enableFilters":!1},"feedsource":{"source":"pulsefrom","id":this.model.node.get("id")},"hideExpandIcon":!0,"context":this.options.workspaceContext,"headerView":!0});this.activityFeedContent=new p(t),this.listenTo(this.activityFeedContent.contentView.collection,"sync",this.addActivityFeedClass)}}},"configProperty":function(e){var t=this.options.data&&this.options.data.workspace&&this.options.data.workspace.properties||{};return t[e]},"resolveProperty":function(e){var t="";if(this.model.isWorkspaceType()){var s=this.configProperty(e);if("{business_properties.description}"===s&&(s="{description}"),s&&s.length>0){var o=s.match(/{(.*?)}/g);if(o){var n=this;i.each(o,function(e){s=s.replace(e,n.format(n.resolveModelValue(e)).formatted||"")})}t=s}}return t},"resolveModelValue":function(e){var t={"name":e,"value":e,"metadata":void 0};if(0===e.indexOf("{")){var s=this.model.attributes||{},o=this.model.metadata&&this.model.metadata.properties||{},n=e.substring(1,e.length-1).split("."),a=n,r=n.length>1?n[0]:void 0;if("categories"===r){s=this.model.categories||{},o=this.model.metadata&&this.model.metadata.categories||{};var l=n[1].split("_");n=[l[0],n[1]],l.length>2&&(l[2]="x"),a=[l[0],l.join("_")]}else"business_properties"===r&&(s=this.model.business_properties||{},o={},n.splice(0,1));i.find(n,function(e){return s=s[e],void 0===s?!0:void 0}),i.find(a,function(e){return o=o[e],void 0===o?!0:void 0}),"categories"===r&&o&&"Integer"===o.type_name&&("user"===o.persona||"group"===o.persona||"member"===o.persona)&&this.model.expandMemberValue({"name":n[1],"value":s,"metadata":o}),t.name=e,t.value=s,t.metadata=o}return t},"format":function(e){var t=e.metadata&&e.metadata.type_name;switch(t){case"Date":e.formatted=this.formatDate(e.value);break;case"Integer":var i=e.metadata.persona;switch(i){case"user":case"group":case"member":var s="{"+e.name.substring(1,e.name.length-1)+"_expand}",o=this.resolveModelValue(s);e.formatted=this.formatMember(o.value);break;default:e.formatted=this.formatValue(e.value)}break;default:e.formatted=this.formatValue(e.value)}return e},"formatDate":function(e){return e=i.isArray(e)?e:[e],i.map(e,function(e){return n.formatDate(e)}).join("; ")},"formatMember":function(e){e=i.isArray(e)?e:[e];var t=i.map(e,function(e){return e?void 0!==e.display_name?e.display_name:void 0!==e.name_formatted?e.name_formatted:n.formatMemberName(e):""}),s=t.join("; ");return s},"formatValue":function(e){return e=i.isArray(e)?e:[e],e.join("; ")},"hasChildView":function(){return!this.options.hideActivityFeed&&this.options.data&&this.options.data.widget&&this.options.data.widget.type&&"none"!==this.options.data.widget.type},"getImageInfo":function(){var e,t=this.model.icon;return e=t&&"none"!==t.location?{"iconContent":t.content,"iconLocation":t.location,"iconClass":void 0}:{"iconContent":this.blankImage,"iconLocation":"none","iconClass":l.findByNode(this.model).get("className")}},"clamp":function(e,t){function i(l){var c=l.nodeValue.replace(s,"");if(r||(n=o.length?o.shift():"",r=c.split(n)),r.length>1?(a=r.pop(),l.nodeValue=r.join(n)+s):r=null,r){if(e.clientHeight<=t){if(!o.length)return;l.nodeValue=r.join(n)+n+a,r=null}}else if(!s.length)return void(l.nodeValue=s);i(l)}var s="...",o=[".",","," "],n=null,a=null,r=null;e.clientHeight<=t||i(e.lastChild)},"adjustToolbar":function(){this.options.hideToolbar||this.headerToolbarView.triggerMethod("dom:refresh")},"getDelayedHeaderViewActions":function(){var e=this.options.headertoolbaritems&&this.options.headertoolbaritems.delayedActionsToolbar?this.options.headertoolbaritems.delayedActionsToolbar.collection:f.delayedActionsToolbar.collection;return i.chain(e.pluck("signature")).unique().value()}});return S}),csui.define("conws/utils/behaviors/expanding.behavior",["require","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette"],function(e,t,i,s){function o(e,i,s){if(null==e)return void 0;var o=e[i];return t.isFunction(o)?e[i].call(s):o}var n=s.Behavior.extend({"constructor":function(e,i){s.Behavior.prototype.constructor.apply(this,arguments);var o=t.bind(this._destroyExpandedView,this,!1),n=(t.bind(this._destroyExpandedView,this,!0),i.options&&i.options.context);this.listenTo(this,"before:destroy",o),n&&this.listenTo(n,"request",o).listenTo(n,"request:perspective",o)},"onExpand":function(){if(!this.expanded){this.expanded=!0;var s,n=this,a=this.view.completeCollection?this.view.completeCollection.clone():this.view.collection.clone(),r=this.view.completeCollection&&this.view.options&&this.view.options.filterValue&&this.view.options.filterValue.toLowerCase();this.view.completeCollection&&r&&r.length>0&&(s={"name":r},a.setFilter(s,{"fetch":!1}),this.view.searchClicked());var l=n.getOption("expandedView"),c=l;t.isString(l)!==!0&&(c=l.prototype instanceof i.View?l:l.call(n.view));var d=["csui/controls/dialog/dialog.view"];t.isString(c)&&d.push(c),e(d,function(e){t.isString(c)&&(c=arguments[1]);var i=o(n.options,"expandedViewOptions",n.view);n.expandedView=new c(t.extend({"context":n.view.options.context,"collection":a,"orderBy":o(n.options,"orderBy",n.view),"filterBy":s,"limited":!1},i)),n.dialog=new e({"iconLeft":o(n.options,"titleBarIcon",n.view)||o(n.view.options,"titleBarIcon",n.view),"imageLeftUrl":o(n.options,"titleBarImageUrl",n.view),"imageLeftClass":o(n.options,"titleBarImageClass",n.view),"title":o(n.options,"dialogTitle",n.view),"iconRight":o(n.options,"dialogTitleIconRight",n.view),"className":o(n.options,"dialogClassName",n.view),"headerControl":o(n.options,"headerControl",n.view),"largeSize":!0,"view":n.expandedView}),n.listenTo(n.dialog,"before:hide",n._expandOtherView).listenTo(n.dialog,"destroy",n._enableExpandingAgain),n._expandOtherView(!1),n.dialog.show()},function(){n.expanded=!1})}},"_destroyExpandedView":function(e){if(this.dialog){var t=e?"kill":"destroy";this.dialog[t](),this.dialog=void 0}},"_expandOtherView":function(e){this.options.collapsedView&&this.options.collapsedView.triggerMethod(e===!1?"go:away":"go:back")},"_enableExpandingAgain":function(){if(this.expanded=!1,this.view.tabableRegionBehavior){var e=this.view.tabableRegionBehavior,t=this.view.ui.tileExpand;e.currentlyFocusedElement&&e.currentlyFocusedElement.prop("tabindex",-1),t&&t.prop("tabindex",0),t.trigger("focus"),e.setInitialTabIndex(),this.view.currentTabPosition=2}}});return n}),csui.define("hbs!conws/widgets/team/impl/controls/teamheader/impl/teamheader",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-teamheader-content">\r\n  <div class="title primary-title" title="'+this.escapeExpression((i=null!=(i=t.primaryTitle||(null!=e?e.primaryTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"primaryTitle","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.primaryTitle||(null!=e?e.primaryTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"primaryTitle","hash":{}}):i))+'</div>\r\n  <div class="title secondary-title" title="'+this.escapeExpression((i=null!=(i=t.secondaryTitle||(null!=e?e.secondaryTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"secondaryTitle","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.secondaryTitle||(null!=e?e.secondaryTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"secondaryTitle","hash":{}}):i))+"</div>\r\n</div>"}});return i.registerPartial("conws_widgets_team_impl_controls_teamheader_impl_teamheader",s),s}),csui.define("css!conws/widgets/team/impl/controls/teamheader/impl/teamheader",[],function(){}),csui.define("conws/widgets/team/impl/controls/teamheader/teamheader.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/teamheader/impl/teamheader","css!conws/widgets/team/impl/controls/teamheader/impl/teamheader"],function(e,t,i,s,o){var n=i.LayoutView.extend({"className":"conws-teamheader","template":o,"constructor":function(e){i.LayoutView.prototype.constructor.apply(this,arguments),e||(e={})},"templateHelpers":function(){return{"primaryTitle":this.options.primaryTitle,"secondaryTitle":this.options.secondaryTitle}}});return n}),csui.define("hbs!conws/widgets/team/impl/team.empty",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="conws-team emptyview cs-emptylist-text">\r\n    <span>'+this.escapeExpression((i=null!=(i=t.noResultsPlaceholder||(null!=e?e.noResultsPlaceholder:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"noResultsPlaceholder","hash":{}}):i))+"</span>\r\n</div>"}});return i.registerPartial("conws_widgets_team_impl_team.empty",s),s}),csui.define("conws/widgets/team/team.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/list/list.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/limiting/limiting.behavior","conws/utils/behaviors/expanding.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/list/behaviors/list.view.keyboard.behavior","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/header/impl/header.model.factory","conws/widgets/team/impl/team.model.factory","conws/widgets/team/impl/teamtables.view","conws/widgets/team/impl/controls/teamheader/teamheader.view","csui/utils/base","csui/utils/nodesprites","csui/utils/contexts/factories/node","conws/widgets/team/impl/controls/listitem/listitemteammember.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/team.empty","css!conws/widgets/team/impl/team"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v){var b=t.ItemView.extend({"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments)},"template":v}),y=i.extend({"className":"conws-team "+i.prototype.className,"constructor":function(e){e||(e={}),e.data||(e.data={}),void 0===e.data.showTitleIcon&&(e.data.showTitleIcon=!0),void 0===e.data.showWorkspaceIcon&&(e.data.showWorkspaceIcon=!1),e.data.title||(e.data.title=w.dialogTitle),e.workspaceContext||(e.workspaceContext=e.context.getObject(l),e.workspaceContext.setWorkspaceSpecific(c),e.workspaceContext.setWorkspaceSpecific(d)),i.prototype.constructor.apply(this,arguments),this.headerModel=e.workspaceContext.getObject(c)},"templateHelpers":function(){return{"searchAria":w.searchAria,"expandAria":w.expandAria,"title":h.getClosestLocalizedString(this.options.data.title,w.dialogTitle),"icon":this.options.data.titleBarIcon||"title-icon title-team","searchPlaceholder":e.str.sformat(w.searchIconTooltip,w.rolesParticipantsColTooltip)}},"getEmptyView":function(){return b},"emptyViewOptions":{"templateHelpers":function(){return{"noResultsPlaceholder":w.noResultsPlaceholder}}},"childView":f,"childViewOptions":{"templateHelpers":function(){return{"name":this.model.get("display_name"),"email":this.model.get("business_email"),"isUser":0===this.model.get("type"),"stage":{"value":this.model.getLeadingRole(),"label":this.model.getRolesIndicator()}}}},"childEvents":{"click:item":"onClickItem"},"onClickItem":function(){},"behaviors":{"PerfectScrolling":{"behaviorClass":s,"contentParent":".tile-content","suppressScrollX":!0,"scrollYMarginOffset":15},"LimitedList":{"behaviorClass":o,"completeCollection":function(){return this.options.workspaceContext.getCollection(d)},"filterByProperty":"display_name","limit":0},"ExpandableList":{"behaviorClass":n,"expandedView":p,"expandedViewOptions":function(){return{"collapsedView":this}},"dialogTitle":function(){return this.headerModel.get("name")},"headerControl":function(){return new u({"primaryTitle":this.headerModel.get("name"),"secondaryTitle":this.headerModel.get("workspace_type_name")})},"titleBarIcon":function(){return this.getIconData().titleBarIcon},"titleBarImageUrl":function(){return this.getIconData().titleBarImageUrl},"titleBarImageClass":function(){return this.getIconData().titleBarImageClass},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"conws-team"},"TabableRegion":{"behaviorClass":a},"ListViewKeyboardBehavior":{"behaviorClass":r}},"onClickHeader":function(){this.triggerMethod("expand")},"getIconData":function(){var e={};return this.options.data.showTitleIcon&&(e.titleBarIcon=this.options.data.titleBarIcon||"title-icon mime-team",this.options.data.showWorkspaceIcon&&(this.headerModel.icon&&"none"!==this.headerModel.icon.location?(e.titleBarIcon=void 0,e.titleBarImageUrl=this.headerModel.icon.content):e.titleBarIcon=m.findByNode(this.headerModel).get("className"))),e},"onRefreshList":function(){e.isUndefined(this.completeCollection)||this.completeCollection.fetch()},"getElementByIndex":function(t){if(isNaN(t)||0>t)return null;var i=this.$(e.str.sformat(".conws-item-member:nth-child({0})",t+1));return this.$(i[0])}});return y}),csui.define("conws/widgets/myworkspaces/impl/myworkspaceslistitem.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/listitem/listitemstandard.view","conws/utils/previewpane/previewpane.view","csui/behaviors/default.action/default.action.behavior"],function(e,t,i,s,o){var n=i.extend({"constructor":function(){i.apply(this,arguments),this.options&&this.options.preview&&(this.previewPane=new s({"parent":this,"context":this.options.context,"config":this.options.preview,"node":this.model}))},"behaviors":{"DefaultAction":{"behaviorClass":o}},"onBeforeDestroy":function(){this.previewPane&&(this.previewPane.destroy(),delete this.previewPane)},"onClickItem":function(){this.triggerMethod("execute:DefaultAction",this.model)}});return n}),csui.define("conws/widgets/myworkspaces/impl/myworkspacestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","conws/utils/workspaces/impl/workspaceutil","conws/utils/workspaces/workspacestable.view"],function(e,t,i,s,o,n,a,r){var l=r.extend({"constructor":function(){r.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.collection;e.orderBy=i.isUndefined(this.collection.options.myworkspaces.attributes.sortExpanded)?a.orderByAsString(this.options.data.orderBy):this.collection.options.myworkspaces.attributes.sortExpanded,this.doRender(e)},"_getCollectionUrlQuery":function(){var e={};return e.fields=encodeURIComponent("properties{"+this.getColumnsToFetch()+"}"),e.action="properties-properties",e.expanded_view="true",e.expand_users="true",e}});return l}),csui.define("conws/widgets/myworkspaces/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/myworkspaces/impl/nls/root/lang",{"dialogTitle":"My workspaces","searchPlaceholder":"%1","noResultsPlaceholder":"No recently accessed workspaces to display."}),csui.define("conws/widgets/myworkspaces/myworkspaces.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","conws/widgets/myworkspaces/impl/myworkspaceslistitem.view","conws/widgets/myworkspaces/impl/myworkspaces.model.factory","conws/widgets/myworkspaces/impl/myworkspacestable.view","i18n!conws/widgets/myworkspaces/impl/nls/lang","csui/utils/nodesprites","csui/utils/base","conws/utils/workspaces/impl/workspaceutil","conws/utils/workspaces/workspaces.view"],function(e,t,i,s,o,n,a,r,l,c,d,p,u){var h=u.extend({"constructor":function(){this.viewClassName="conws-myworkspaces",u.prototype.constructor.apply(this,arguments),this.limit=-1},"childView":n,"childViewOptions":function(){return{"context":this.options.context,"preview":this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.preview,"templateHelpers":function(){return{"name":this.model.get("name"),"icon":c.findClassByNode(this.model),"enableIcon":!0}}}},"emptyViewOptions":{"templateHelpers":function(){return{"text":this._parent._getNoResultsPlaceholder()}}},"workspacesCollectionFactory":a,"workspacesTableView":r,"dialogClassName":"myworkspaces","lang":l,"_getCollectionAttributes":function(){var e={"workspaceTypeId":this.options.data.workspaceTypeId,"sortExpanded":this.options.data.expandedView&&p.orderByAsString(this.options.data.expandedView.orderBy),"title":d.getClosestLocalizedString(this.options.data.title,l.dialogTitle)};return e},"_getCollectionUrlQuery":function(){var e=this.options.data,t={};return i.isUndefined(e.workspaceTypeId)||(t.where_workspace_type_id=e.workspaceTypeId),t.fields=encodeURIComponent("properties{id,container,name,type}"),t.action="properties-properties",t.expanded_view="false",i.isEmpty(t)?void 0:t}});return h}),csui.define("conws/widgets/metadata/impl/nls/metadata.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/metadata/impl/nls/root/metadata.lang",{"defaultMetadataWidgetTitle":"Metadata","noMetadataMessage":"No data to display."}),csui.define("hbs!conws/widgets/metadata/impl/metadata",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'        <div class="tile-header">\r\n\r\n            <div class="tile-type-icon">\r\n                <div class="title-icon '+this.escapeExpression((o=null!=(o=t.icon||(null!=e?e.icon:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"icon","hash":{},"data":s}):o))+'"></div>\r\n            </div>\r\n\r\n            <div class="tile-title">\r\n                <h2 class="csui-heading">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{},"data":s}):o))+"</h2>\r\n            </div>\r\n\r\n        </div>\r\n"},"3":function(e,t,i,s){var o;
return'				<div class="form-metadata'+this.escapeExpression((o=null!=(o=t.index||s&&s.index)?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"index","hash":{},"data":s}):o))+'"/>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="conws-metadata tile content-tile">\r\n\r\n'+(null!=(o=t.unless.call(e,null!=e?e.hideHeader:e,{"name":"unless","hash":{},"fn":this.program(1,s,0),"inverse":this.noop,"data":s}))?o:"")+'\r\n    <div class="tile-content metadata-tile-content">\r\n		<div class="form-metadata">\r\n'+(null!=(o=t.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(3,s,0),"inverse":this.noop,"data":s}))?o:"")+"		</div>\r\n    </div>\r\n\r\n</div>\r\n"},"useData":!0});return i.registerPartial("conws_widgets_metadata_impl_metadata",s),s}),csui.define("css!conws/widgets/metadata/impl/metadata",[],function(){}),csui.define("conws/widgets/metadata/metadata.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/widget.container/widget.container.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/base","csui/utils/log","csui/utils/url","csui/utils/base","csui/utils/contexts/factories/node","csui/controls/list/emptylist.view","conws/controls/selectedmetadataform/selectedmetadataform.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/models/form","csui/models/node/node.model","conws/models/workspacecontext/workspacecontext.factory","conws/models/selectedmetadataform/selectedmetadataform.factory","i18n!conws/widgets/metadata/impl/nls/metadata.lang","hbs!conws/widgets/metadata/impl/metadata","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","css!conws/widgets/metadata/impl/metadata"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v,b,y,k,x){var _=o.LayoutView.extend({"className":"conws-metadata","template":k,"templateHelpers":function(){return{"items":this._items,"hideHeader":this.hideHeader,"title":p.getClosestLocalizedString(this.headerTitle,y.defaultMetadataWidgetTitle),"icon":this.headerIcon}},"events":{"keydown .form-metadata":"onKeyInView"},"behaviors":{"PerfectScrolling":{"behaviorClass":g,"contentParent":".tile-content","suppressScrollX":!0,"scrollYMarginOffset":15},"TabableRegion":{"behaviorClass":r}},"onKeyInView":function(e){var t=document.activeElement,i=this.currentlyFocusedElement(),s=0;if(t.children.length>0&&(t=t.children[0]),9===e.keyCode)if(e.shiftKey){for(s=0;s<i.length;s++)if(t===i[s]){if(t.classList.contains("esoc-user-mini-profile")||t.classList.contains("reference-generate-number")||t.classList.contains("cs-field-read-content")&&t.classList.contains("placeholder")||0>s-1)break;i[s-1].focus();break}}else for(s=0;s<i.length;s++)if(t===i[s]&&s+1<i.length){if(t.classList.contains("esoc-user-mini-profile")||t.classList.contains("reference-generate-number")||t.classList.contains("cs-field-read-content")&&t.classList.contains("placeholder"))break;i[s+1].focus();break}},"currentlyFocusedElement":function(){var e=(!!this.$form&&this.$form.find(".alpaca-readonly button"),this.$("button,*[data-cstabindex],*[tabindex]"));return e=this.remove_Elements(e)},"remove_Elements":function(e){for(var t=["alpaca-array-actionbar-action","typeahead","cs-icon","binf-hidden","csui-icon-edit","csui-bulk-edit","icon-date_picker"],i=0;i<e.length;i++)for(var s=0;s<t.length;s++)e[i].classList.contains(t[s])&&(e.splice(i,1),s=t.length,i-=1);return e},"constructor":function(e){if(e||(e={}),!e.context)throw new Error("Context is missing in the constructor options");t.defaults(e,{"searchTabContentForTabableElements":!0}),this.hideHeader=e.data&&e.data.hideHeader,this.headerTitle=e.data&&e.data.title||y.defaultMetadataWidgetTitle,this.headerIcon=e.data&&e.data.icon||"category1",this.noMetadataMessage=y.noMetadataMessage,e.data&&e.data.noMetadataMessage&&(this.noMetadataMessage=l.getClosestLocalizedString(e.data.noMetadataMessage,this.noMetadataMessage)),e.workspaceContext||(e.workspaceContext=e.context.getObject(v),e.workspaceContext.setWorkspaceSpecific(b)),this.formViewList=[],e.model=e.workspaceContext.getObject(b,{"metadataConfig":e.data,"unique":!0}),o.LayoutView.prototype.constructor.call(this,e),this.listenTo(e.model,"change",this.render),this.propagateEventsToRegions(),"undefined"==typeof e.data?c.info("Metadata Not Set")&&console.log(c.last):"undefined"==typeof e.data.metadataConfig&&this._setUpEmptyRegion()},"modelEvents":{"change":"modelChange"},"modelChange":function(){this._setUpRegions(),this._currentShortcutIndex=0},"_setUpRegions":function(){var e,s=this;s._items=[],t.each(this.options.model.metadataConfig,function(t,o){s._items[o]={"index":o},s.addRegion("Region"+o,".form-metadata"+o),e="Region"+o,s.regions[e]=i.extend({},s[e])},this)},"_setUpEmptyRegion":function(){var e,t=this;t._items=[],t._items[0]={"index":0},t.addRegion("Region0",".form-metadata0"),e="Region0",t.regions[e]=i.extend({},t[e])},"onRender":function(){if(t.isEmpty(this.model.attributes.data))this.formView=new h({"text":this.noMetadataMessage}),t.each(this.regions,function(e,t){this[t].show(this.formView)},this);else{var e=[],s={"data":{},"options":{"fields":{}},"schema":{"properties":{}}};s.data=i.extend({},this.model.attributes.data),s.options.fields=i.extend({},this.model.attributes.options.fields),s.schema.properties=i.extend({},this.model.attributes.schema.properties),t.each(this.options.model.metadataConfig,function(s,o){if("group"===s.type)e[o]={"data":{},"options":{},"schema":{}},e[o].data=i.extend({},this.model.attributes.data[s.label]),e[o].options=i.extend({},this.model.attributes.options.fields[s.label]),e[o].schema=i.extend({},this.model.attributes.schema.properties[s.label]);else if("category"===s.type)e[o]={"data":{},"options":{"fields":{}},"schema":{"properties":{}}},t.each(this.model.attributes.data,function(t,i){0===i.search(s.categoryId)&&(e[o].data[i]=this.model.attributes.data[i],e[o].options.fields[i]=this.model.attributes.options.fields[i],e[o].schema.properties[i]=this.model.attributes.schema.properties[i])},this);else if("attribute"===s.type){var n=s.categoryId+"_"+s.attributeId;"undefined"!=typeof s.columnId&&"undefined"==typeof s.rowId?n=n+"_1_"+s.columnId:"undefined"!=typeof s.rowId&&(n=n+"_x_"+s.columnId),e[o]={"data":{},"options":{"fields":{}},"schema":{"properties":{}}},"undefined"!=typeof this.model.attributes.data[n]&&(e[o].data[n]=this.model.attributes.data[n],e[o].options.fields[n]=this.model.attributes.options.fields[n],e[o].schema.properties[n]=this.model.attributes.schema.properties[n])}},this);var o=0;t.each(this.regions,function(t,i){this.model.attributes=e[o],this["formView"+o]=new m({"model":this.model,"context":this.options.context,"node":this.model.node}),this.formViewList[o]=this["formView"+o],this["formView"+o].metadataview=this,this[i].show(this["formView"+o]),o++},this),this.model.attributes=s}}});return t.extend(_.prototype,x),_}),csui.define("hbs!conws/widgets/outlook/impl/wksp/impl/wksp",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="List-item" >\r\n    <div class="listItemWksp wkspItem"  id="wkspItem" >\r\n        <span class="wksp-expand-icon" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"><div id="toggleIcon" tabindex="'+this.escapeExpression((i=null!=(i=t.tabIndex||(null!=e?e.tabIndex:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tabIndex","hash":{}}):i))+'" class="'+this.escapeExpression((i=null!=(i=t.toggleStatus||(null!=e?e.toggleStatus:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"toggleStatus","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.typeName||(null!=e?e.typeName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"typeName","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" /></span>\r\n        <span class="wkspItemIcon"><div class="'+this.escapeExpression((i=null!=(i=t.iconClass||(null!=e?e.iconClass:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconClass","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.typeName||(null!=e?e.typeName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"typeName","hash":{}}):i))+'"></div></span>\r\n        <div class="listItemWkspName wkspItemName"  tabindex="0" id="wkspNameDiv" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+' </div>\r\n        <div class="wkspFolder-actiondiv binf-fade" style="display:none">\r\n            <div id="wkspActionBar" class="wkspFolder-actionbar wkspFolder-actionbar-bubble" >\r\n                <ul class="wksptile-nav wkspnav wksptile-pills">\r\n                    <li class="needsclick wkspActionButton wkspActionSaveButton" id="wkspSaveMenuItem" style="display:none">\r\n                        <div>\r\n                            <a href="#" id="saveEmailButton" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" tabindex="0" aria-label="'+this.escapeExpression((i=null!=(i=t.saveButtonTitle||(null!=e?e.saveButtonTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveButtonTitle","hash":{}}):i))+'" >\r\n                                <div class="wkspIcon emailSaveIcon" data-id="noToggle" />\r\n                            </a>\r\n                        </div>\r\n                    </li>\r\n\r\n                    <li class="needsclick wkspActionButton">\r\n                        <div>\r\n                            <a href="'+this.escapeExpression((i=null!=(i=t.linkToWS||(null!=e?e.linkToWS:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"linkToWS","hash":{}}):i))+'" id="wkspOpenButton" title="'+this.escapeExpression((i=null!=(i=t.openLinkTitle||(null!=e?e.openLinkTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"openLinkTitle","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.openLinkTitle||(null!=e?e.openLinkTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"openLinkTitle","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" tabindex="0" target="_blank">\r\n                                <div class="wkspIcon wkspOpenIcon" data-id="noToggle" />\r\n                            </a>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="subFolders"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_wksp_impl_wksp",s),s}),csui.define("conws/widgets/outlook/impl/utils/emailservice",["module","csui/lib/jquery","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang"],function(e,t,i,s){function o(){var e=t.Deferred();try{var i=window.Office.cast.item.toItemRead(window.Office.context.mailbox.item),s=window.Office.context.mailbox.userProfile.emailAddress;i.archivableAttachments=[];for(var o=0;o<i.attachments.length;o++){var n=i.attachments[o];n.attachmentType===window.Office.MailboxEnums.AttachmentType.File&&i.archivableAttachments.push(n)}e.resolve({"currentEmail":i,"currentUser":s})}catch(a){e.reject(a)}return e.promise()}function n(){if(i.SavingSubmitted)return void(i.EmailChangedAfterSaving=!0);i.EmailChangedAfterSaving=!1;var e=window.Office.context.mailbox.item,t=window.CurrentEmailItem,s=window.pageYOffset;if(t.itemId!==e.itemId){var o=window.Office.cast.item.toItemRead(e);o.archivableAttachments=[];for(var n=0;n<o.attachments.length;n++){var a=o.attachments[n];a.attachmentType===window.Office.MailboxEnums.AttachmentType.File&&o.archivableAttachments.push(a)}window.CurrentEmailItem=o,null!==t&&(i.writeTrace("Email has been switched. New email subject: "+e.subject),window.CurrentEmailItem=window.Office.cast.item.toItemRead(e),i.uiShow(i.PreSaveSection),"standardSections"===i.PreSaveSection&&i.uiShow("customSearchButton"),i.uiHide("savePanel"),-1!==i.ScorllPositionBeforeSaving?(window.scrollTo(0,i.ScorllPositionBeforeSaving),i.ScorllPositionBeforeSaving=-1):window.scrollTo(0,s),null!==i.SuggestedWkspsView&&i.SuggestedWkspsView.refresh())}}return{"constants":{"cs_config_missing":s.config_CS_missing,"retrieve_email_error":s.error_retrieve_email},"getCurrentMailboxItem":o,"emailItemChanged":n}}),csui.define("hbs!conws/widgets/outlook/impl/folder/impl/folder",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="List-item">\r\n    <div class="wkspItem listItemFolder" id="wkspFolderItem" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'">\r\n        <span class="wksp-expand-icon" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"><div id="toggleIcon" class="'+this.escapeExpression((i=null!=(i=t.toggleStatus||(null!=e?e.toggleStatus:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"toggleStatus","hash":{}}):i))+'" tabindex="'+this.escapeExpression((i=null!=(i=t.tabIndex||(null!=e?e.tabIndex:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tabIndex","hash":{}}):i))+'" title="'+this.escapeExpression((i=null!=(i=t.typeName||(null!=e?e.typeName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"typeName","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" /></span>\r\n        <span class="wkspItemIcon" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'">\r\n            <div class="'+this.escapeExpression((i=null!=(i=t.iconClass||(null!=e?e.iconClass:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"iconClass","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"></div>\r\n        </span>\r\n        \r\n        <div data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" class="wkspItemName"  tabindex="0" id="folderNameDiv" title="'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+' </div>\r\n        <div class="wkspFolder-actiondiv binf-fade" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" style="display:none">\r\n            <div id="folderActionBar" class="wkspFolder-actionbar wkspFolder-actionbar-bubble" >\r\n                <ul class="wksptile-nav wkspnav wksptile-pills">\r\n                    \r\n                    <li class="needsclick">\r\n                        <div >\r\n                            <a href="#" id="saveEmailButton" title="'+this.escapeExpression((i=null!=(i=t.saveTitle||(null!=e?e.saveTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveTitle","hash":{}}):i))+' " aria-label="'+this.escapeExpression((i=null!=(i=t.saveTitle||(null!=e?e.saveTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveTitle","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'" tabindex="0" >\r\n                                <div class="wkspIcon emailSaveIcon" data-id="noToggle" />\r\n                            </a>            \r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="subFolders"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_folder_impl_folder",s),s}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/logindialog",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="modal-dialog modal-sm load-container">\r\n    <div class="binf-modal-dialog ">\r\n        <div class="binf-modal-content">\r\n            <div class="binf-modal-header wksp-dialog-header">\r\n                <img src="impl/images/headerbar_content_server.png" title="'+this.escapeExpression((i=null!=(i=t.signInTitle||(null!=e?e.signInTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"signInTitle","hash":{}}):i))+'" class="signInImage" />\r\n            </div>\r\n\r\n            <div class="wksp-dialog-body" title="'+this.escapeExpression((i=null!=(i=t.signInTitle||(null!=e?e.signInTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"signInTitle","hash":{}}):i))+'">\r\n                <div>'+this.escapeExpression((i=null!=(i=t.signInMessage||(null!=e?e.signInMessage:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"signInMessage","hash":{}}):i))+'</div>\r\n                <div class="errorMessage" > </div>\r\n                <div>\r\n                    <label for="userName">'+this.escapeExpression((i=null!=(i=t.usernameLabel||(null!=e?e.usernameLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"usernameLabel","hash":{}}):i))+'</label> <input class="wkspInput" id="userName" tabindex="0"/>\r\n                </div>\r\n                <div>\r\n                    <label for="password">'+this.escapeExpression((i=null!=(i=t.passwordLabel||(null!=e?e.passwordLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"passwordLabel","hash":{}}):i))+'</label> <input class="wkspInput" id="password" type="password" tabindex="0" />\r\n                </div>\r\n            </div>\r\n            \r\n            <div class="binf-modal-footer">\r\n                <button type="button" class="binf-btn binf-btn-primary csui-yes csui-default" tabindex="0" >\r\n                    '+this.escapeExpression((i=null!=(i=t.signInButtonTitle||(null!=e?e.signInButtonTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"signInButtonTitle","hash":{}}):i))+"\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>"}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_logindialog",s),s}),csui.define("conws/widgets/outlook/impl/dialog/authenticator",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/url","conws/widgets/outlook/impl/utils/utility","hbs!conws/widgets/outlook/impl/dialog/impl/logindialog","i18n!conws/widgets/outlook/impl/nls/lang","csui/behaviors/keyboard.navigation/tabkey.behavior","csui/lib/binf/js/binf"],function(e,t,i,s,o,n,a,r,l,c,d){var p=s.ItemView.extend({"className":function(){var e="csui-alert binf-modal binf-fade";return this.options.modalClass&&(e+=" "+this.options.modalClass),e},"template":l,"ui":{"errorMessage":".errorMessagae","userName":"#userName","password":"#password"},"triggers":{"click .csui-yes":"click:yes"},"events":{"shown.binf.modal":"onShown","hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","keyup":"processKey"},"behaviors":{"TabKeyBehavior":{"behaviorClass":d,"recursiveNavigation":!0}},"constructor":function(){s.ItemView.prototype.constructor.apply(this,arguments);var e=r.getConnector();this.connector=e;var t=new a(e.connection.url);this.hostName=t.getHost(),this.ticketCookieName="otcsTicket"+this.hostName.replace(/;/g,"_").replace(/=/g,"_").replace(/ /g,"_").replace(/,/g,"_").replace(/-/g,"_"),this._deferred=i.Deferred(),this.ssoDeferred=i.Deferred(),this.errorMessage="",this.llCookie=null,this.isSSOMessageReceived=!1,this.beingAuthenticated=!1},"templateHelpers":function(){return{"signInButtonTitle":c.signIn_button_Title,"usernameLabel":c.signIn_username,"passwordLabel":c.signIn_password,"signInMessage":t.str.sformat(c.signIn_message,this.hostName),"signInTitle":c.signIn_title}},"show":function(){var e=this,t=e._deferred.promise();return r.stopGlobalSpinner(),e.beingAuthenticated?(r.writeTrace("Bing authenticated, so skip."),e._deferred.resolve(!1),e.beingAuthenticated=!1):(e.beingAuthenticated=!0,r.modalOpen(),this.render(),this.$el.attr("tabindex",0),this.errorMessage&&this.$(".errorMessage").html(this.errorMessage),this.options.centerVertically&&this.centerVertically(),this.$el.binf_modal("show"),this.triggerMethod("show"),t.close=function(){return e.$el.binf_modal("hide"),t}),t},"centerVertically":function(){var e,t;e=this.$el.clone(),e.css("display","block"),e.appendTo(i.fn.binf_modal.getDefaultContainer()),t=Math.round((e.height()-e.find(".binf-modal-content").height())/2),t=t>0?t:0,e.remove(),this.$el.find(".binf-modal-content").css("margin-top",t)},"onShown":function(){this._deferred.notify({"state":"shown"}),this.$("#userName").focus()},"onHiding":function(){this._deferred.notify({"state":"hiding"})},"onHidden":function(){r.modalClose(),this.destroy(),this.options.callback&&this.options.callback(this._result),this._result?this._deferred.resolve(this._result):this._deferred.reject(this._result)},"processKey":function(e){13===e.which&&this.onClickYes()},"onClickYes":function(){var e=this,t=e.$("#userName").val().trim(),i=e.$("#password").val().trim(),s=e.$(".errorMessage");if(s.html("  "),!t||!i)return void s.html(c.signIn_required);this.connector.connection.credentials={"username":t,"password":i,"domain":""},this.connector.confirmingReload=!1;var o=this.connector.authenticator,n={"type":"POST","data":this.connector.connection.credentials,"contentType":"application/x-www-form-urlencoded"};o.login(n,function(t){r.writeTrace("Authenticated based on username & password."),"undefined"==typeof e.connector.connection.session&&(e.connector.connection.session=t.session),e.options.context.csUser=n.data.username,r.setPersistentSetting(e.ticketCookieName,t.session.ticket,t.session.expries),e.connector.timeoutProcessed=!1,e._result=!0,e.onHidden()},function(t){e.connector.timeoutProcessed=!1,e.$(".errorMessage").html(r.getErrorMessage(t))})},"_setTabFocus":function(){var e=this.$("*[tabindex=0]"),t=e.length-1,s=event.shiftKey,o=this._getStartIndex(t,s,e);if(t>-1){var a=void 0!==this.activeIndex?this.activeIndex:s?0:t;do{var r=i(e[o]);if(n.isVisibleInWindowViewport(r)){this.activeIndex=o,r.focus();break}o=s?0===o?t:o-1:o===t?0:o+1}while(o!==a)}return!1},"_getStartIndex":function(e,t){var i=0,s=this.activeIndex;return t?(i=e,void 0!==s&&s>0&&(i=this.activeIndex-1)):void 0!==s&&e>s&&(i=s+1),i},"authenticate":function(e){var t,i,s=this,o=s._deferred.promise(),n=s.connector.connection,a=(n.url,function(t,i){var s="undefined"==typeof i?r.getPersistentSetting(t.ticketCookieName):i;if(!s||t.connector.timeoutProcessed)return t.show();n.session={"ticket":s};var o=t.verifyAuthentication(t,n);return o.done(function(){t.connector.authenticator.authenticate(e,function(){r.setPersistentSetting(t.ticketCookieName,t.connector.authenticator.connection.session.ticket,t.connector.authenticator.connection.session.expries),t.connector.timeoutProcessed=!1,t._result=!0,t._deferred.resolve(t._result)},function(){return t.show()})}),o.fail(function(){r.SSOEnabled?t.getSSOTicket(t).then(function(e){return t.connector.timeoutProcessed=!1,e?(r.writeTrace("Using existing ticket unsuccessful, renew ticket using SSO."),n.session={"ticket":e},t.traceLoginUser(t,n),t.connector.confirmingReload=!1,r.stopGlobalSpinner(),r.setPersistentSetting(t.ticketCookieName,n.session.ticket,n.session.expries),t._result=!0,t._deferred.resolve(t._result),t._deferred.promise()):void t.show()},function(){t.show()}):t.show()}),t._deferred.promise()});return n.session&&n.session.ticket?(t=n.session.ticket,i="existing connection session"):(t=r.getPersistentSetting(s.ticketCookieName),i="persistent setting"),!s.connector.timeoutProcessed&&t?(r.writeTrace("Trying to authenticate based on "+i),a(s,t)):r.SSOEnabled?(r.writeTrace("Trying SSO authentication"),s.getSSOTicket(s).then(function(e){return s.connector.timeoutProcessed=!1,e?(n.session={"ticket":e},s.traceLoginUser(s,n),s.connector.confirmingReload=!1,r.stopGlobalSpinner(),r.setPersistentSetting(s.ticketCookieName,n.session.ticket,n.session.expries),s._result=!0,s._deferred.resolve(s._result),s._deferred.promise()):a(s)},function(){return a(s)}),o):a(s)},"getSSOTicket":function(e){if(r.getPersistentSetting("sso_error"))e.ssoDeferred.reject();else{setTimeout(function(){r.startGlobalSpinner(!0)},500),e.isSSOMessageReceived=!1;var t=window.ServerOrigin;e.messageListener=r.registerMessageListener(function(i){e.isSSOMessageReceived||(r.writeTrace("Received SSO message from: "+t),e.isSSOMessageReceived=!0,r.detachMessageListener(e.messageListener,t),setTimeout(function(){r.stopGlobalSpinner()},500),e.ssoDeferred.resolve(i.data))},t);var i="&tick="+(new Date).getTime(),s=window.ServerCgiScript+r.SSOLoginURL+i+"#",o=s+encodeURIComponent(document.location.href);r.isSafeURL(o)?(document.getElementById("ssoFrame").src=o,setTimeout(function(){e.isSSOMessageReceived===!1&&(r.writeTrace("SSO timed out."),e.errorMessage="",document.getElementById("ssoFrame").src="",r.detachMessageListener(e.messageListener),e.ssoDeferred.reject())},6e3),r.writeTrace("SSO enabled and token being retrieved.")):(r.writeTrace("Unsafe URL found: "+o),e.ssoDeferred.reject())}return e.ssoDeferred.promise()},"verifyAuthentication":function(e,t){var s=i.Deferred();return i.ajax({"type":"GET","headers":{"otcsticket":t.session.ticket},"url":t.url+"/auth","success":function(t){e.options.context.csUser=t.data.name,r.writeTrace("Logged in as: "+t.data.name),s.resolve({"successful":!0})},"error":function(e){s.reject(e)}}),s.promise()},"traceLoginUser":function(e,t){r.TraceEnabled&&i.ajax({"type":"GET","headers":{"Content-Type":void 0,"otcsticket":t.session.ticket},"url":t.url+"/auth","success":function(t){t&&t.data&&t.data.name?(e.options.context.csUser=t.data.name,r.writeTrace("Logged in as: "+t.data.name)):r.writeTrace("Cannot get login user.")}})}});return p}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/nameresolver",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="modal-dialog modal-sm load-container">\r\n    <div class="binf-modal-dialog ">\r\n        <div class="binf-modal-content">\r\n            <div class="binf-modal-header question-header">\r\n                <h4 class="binf-modal-title">\r\n                    <span class="icon csui-icon-notification-confirmation-white"></span>\r\n                    <span class="title-text">'+this.escapeExpression((i=null!=(i=t.titleSaveEmail||(null!=e?e.titleSaveEmail:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"titleSaveEmail","hash":{}}):i))+'</span>\r\n                </h4>\r\n            </div>\r\n\r\n            <div class="wksp-dialog-body">\r\n                <div>'+this.escapeExpression((i=null!=(i=t.validationMessage||(null!=e?e.validationMessage:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"validationMessage","hash":{}}):i))+'</div>\r\n                <div class="errorMessage"> </div>\r\n                <div>\r\n                    <span>'+this.escapeExpression((i=null!=(i=t.uniqueNameLabel||(null!=e?e.uniqueNameLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"uniqueNameLabel","hash":{}}):i))+'</span> \r\n                    <textarea class="wkspInput wkspEmailName" id="fileName" tabindex="0"/>\r\n                </div>\r\n\r\n            </div>\r\n            \r\n            <div class="binf-modal-footer">\r\n                <button type="button" class="binf-btn binf-btn-primary csui-yes csui-default" tabindex="0" >\r\n                    '+this.escapeExpression((i=null!=(i=t.titleOk||(null!=e?e.titleOk:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"titleOk","hash":{}}):i))+'\r\n                </button>\r\n                <button type="button" class="binf-btn binf-btn-default csui-cancel" tabindex="0"\r\n                        data-binf-dismiss="modal">\r\n                    '+this.escapeExpression((i=null!=(i=t.titleCancel||(null!=e?e.titleCancel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"titleCancel","hash":{}}):i))+"\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>"}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_nameresolver",s),s}),csui.define("conws/widgets/outlook/impl/dialog/nameresolver",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/url","csui/utils/requestauthenticator","conws/widgets/outlook/impl/utils/utility","hbs!conws/widgets/outlook/impl/dialog/impl/nameresolver","i18n!conws/widgets/outlook/impl/nls/lang","csui/behaviors/keyboard.navigation/tabkey.behavior","csui/lib/binf/js/binf"],function(e,t,i,s,o,n,a,r,l,c,d,p){var u=s.ItemView.extend({"className":function(){var e="csui-alert binf-modal binf-fade";return this.options.modalClass&&(e+=" "+this.options.modalClass),e},"template":c,"ui":{"errorMessage":".errorMessagae","fileName":"#fileName"},"triggers":{"click .csui-yes":"click:yes"},"events":{"shown.binf.modal":"onShown","hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","keyup":"processKey","keyup #fileName":"emailNameTyping"},"behaviors":{"TabKeyBehavior":{"behaviorClass":p,"recursiveNavigation":!0}},"constructor":function(e){s.ItemView.prototype.constructor.apply(this,arguments),e=this.options,this.connector=e.connector,this._deferred=i.Deferred(),this.folderId=e.folderId,this.proposedName=l.escapeNameToCreate(e.originalName),this.originalName=this.proposedName,this.folderName=e.folderName,this.url=a.combine(this.connector.connection.url,"validation/nodes/names"),this.bodyFormat='{"parent_id":%d,"names":["%s"]}'},"templateHelpers":function(){return{"validationMessage":this.originalName?t.str.sformat(d.validation_name_conflict,this.originalName,this.folderName):d.validation_no_subject,"titleSaveEmail":d.title_save_email,"uniqueNameLabel":d.save_nameNotUnique,"titleOk":d.title_ok,"titleCancel":d.title_cancel}},"show":function(){l.modalOpen(),this.render(),this.$el.attr("tabindex",0),this.options.centerVertically&&this.centerVertically(),this.$el.binf_modal("show"),this.triggerMethod("show"),this.proposedName&&this.$("#fileName").val(this.proposedName),this.templateHelpers();var e=this._deferred.promise(),t=this;return e.close=function(){return t.$el.binf_modal("hide"),e},e},"centerVertically":function(){var e,t;e=this.$el.clone(),e.css("display","block"),e.appendTo(i.fn.binf_modal.getDefaultContainer()),t=Math.round((e.height()-e.find(".binf-modal-content").height())/2),t=t>0?t:0,e.remove(),this.$el.find(".binf-modal-content").css("margin-top",t)
},"onShown":function(){this._deferred.notify({"state":"shown"}),this.$("#fileName").focus();var e=this.$("#fileName")[0];e.style.height="1px",e.style.height=e.scrollHeight+"px"},"onHiding":function(){this._deferred.notify({"state":"hiding"})},"onHidden":function(){l.modalClose(),this.destroy(),this.options.callback&&this.options.callback(this._result),this._result?this._deferred.resolve(this._result):this._deferred.reject(this._result)},"emailNameTyping":function(){var e=this.$("#fileName");if(0!==e.length){var t=e[0];t.style.height="1px",t.style.height=t.scrollHeight+"px"}},"processKey":function(e){13===e.which&&this.onClickYes()},"onClickNo":function(){this._result=!1},"onClickYes":function(){var e=this,t=l.escapeNameToCreate(e.$("#fileName").val().trim()),i=e.$(".errorMessage");i.html("  "),t?(e.originalName=t,e.proposedName=t,e.validate().done(function(t){t.status&&e.destroy()})):i.html(d.save_enterName)},"_setTabFocus":function(){var e=this.$("*[tabindex=0]"),t=e.length-1,s=event.shiftKey,o=this._getStartIndex(t,s,e);if(t>-1){var a=void 0!==this.activeIndex?this.activeIndex:s?0:t;do{var r=i(e[o]);if(n.isVisibleInWindowViewport(r)){this.activeIndex=o,r.focus();break}o=s?0===o?t:o-1:o===t?0:o+1}while(o!==a)}return!1},"_getStartIndex":function(e,t){var i=0,s=this.activeIndex;return t?(i=e,void 0!==s&&s>0&&(i=this.activeIndex-1)):void 0!==s&&e>s&&(i=s+1),i},"validate":function(){var e=this._deferred.promise(),t=this,i=t.url;if(t.proposedName){l.startGlobalSpinner();var s=t.verifyName(i,t.proposedName);s.done(function(e){if(e.results&&0===e.results.length)t._result={"success":!0,"name":t.proposedName},t.onHidden(),t._deferred.resolve(t._result);else{var i=t.rename(t.proposedName);t.resolveName(i,function(e){t.proposedName=e,l.stopGlobalSpinner(),t.show(),t.onShown()})}}),s.fail(function(e,i){l.stopGlobalSpinner();var s=i;e&&(s=e.responseJSON&&e.responseJSON.error?e.responseJSON.error:e.responseText?e.responseText:e.statusText?e.statusText:JSON.stringify(e)),t.$(".errorMessage").html(s),t._result={"success":!1,"status":e.status,"errorMessage":s},t._deferred.resolve(t._result)})}else t.show();return e},"verifyName":function(e,s){var o=this,n=o.connector.connection.session.ticket,a=t.str.sprintf(o.bodyFormat,o.folderId,l.escapeNameToVerify(s)+".eml");return i.ajax({"type":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","OTCSTicket":n},"url":e,"contentType":!1,"data":{"body":a}})},"resolveName":function(e,t){var i=this,s=i.url,o=i.verifyName(s,e);o.done(function(s){if(s.results&&0===s.results.length)t(e);else{var o=i.rename(e);i.resolveName(o,t)}})},"rename":function(e){if(!e)return null;var t=e.trim();if(")"===t[t.length-1]){var i=t.lastIndexOf("(");if(i>0&&i<t.length-2){var s=t.substring(i+1,t.length-1),o=parseInt(s,10);if(s===String(o))return o++,t.substring(0,i+1)+o+")"}}return t+" (1)"}});return u}),csui.define("conws/widgets/outlook/impl/utils/csservice",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/dialogs/modal.alert/modal.alert","conws/widgets/outlook/impl/utils/emailservice","conws/widgets/outlook/impl/dialog/authenticator","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/dialog/nameresolver","i18n!conws/widgets/outlook/impl/nls/lang","i18n!csui/utils/impl/nls/lang"],function(e,t,i,s,o,n,a,r,l,c,d,p){function u(i,s,o,n,a){var r=this,c=window.CurrentEmailItem,p=o?!0:!1,u="",h="",m="",g=!1,f=void 0===a?"":JSON.stringify(a),w=t.Deferred();if(null!=n&&n.length>0){g=!0;for(var v=0;v<n.length;v++)u+=0===v?'"'+n[v].name+'"':',"'+n[v].name+'"',h+=0===v?'"'+n[v].id+'"':',"'+n[v].id+'"',m+=0===v?'"'+n[v].mimeType+'"':',"'+n[v].mimeType+'"'}u="{"+u+"}",h="{"+h+"}",m="{"+m+"}";var b="";return p&&g?b=d.save_successful_all:p?b=d.save_successful_email:g&&(b=n.length>1?d.save_successful_attachments:d.save_successful_attachment),l.writeTrace("Ready to perform: saving email = "+p+", saving attachment(s) = "+g),"undefined"==typeof window.Office||"undefined"==typeof window.Office.context||"undefined"==typeof window.Office.context.mailbox?(w.reject({"errorMsg":d.warning_no_outlook_context}),l.writeTrace("Could not save email because there is no Outlook context."),w.promise()):(window.Office.context.mailbox.getCallbackTokenAsync(function(n){if("succeeded"===n.status){var a="From: Demo <demo@demo.com>\nTo: Demo <demo@demo.com>\nSubject: Content placeholder email\nDate: 1 Jul 2017",p=new Blob([a],{"type":"message/rfc822"}),v=new FormData;v.append("parent_id",s),v.append("ewsUrl",window.Office.context.mailbox.ewsUrl),v.append("emailId",c.itemId),v.append("accessToken",n.value),v.append("emailName",o),v.append("file",p),v.append("body",f),g&&(v.append("attachmentNames",u),v.append("attachmentIds",h),v.append("attachmentTypes",m)),l.writeTrace("Calling CS REST to retrieve email content and attachment to save ..."),t.ajax({"type":"POST","headers":{"Content-Type":void 0,"otcsticket":i.connection.session.ticket},"url":l.v1ToV2(i.connection.url)+"businessworkspaces/outlookaddin/email","contentType":!1,"data":v,"processData":!1,"success":function(t){var i=!1,s="";null!=t.results&&t.results.length>0?(i="Success"===t.results[0].resultCode,s=t.results[0].message):s="OutlookAddinRestFailed",i?(w.resolve({"result":b}),l.writeTrace("Saving the email/attachment to Content Server completed.")):(w.reject({"errorMsg":e.str.sformat(d.error_save_email,s)}),l.writeTrace("Saving the email/attachment to Content Server failed with message: "+s))},"error":function(t,i){var s=i;t&&(s=t.responseJSON&&t.responseJSON.error?t.responseJSON.error:t.responseText?t.responseText:t.statusText?t.statusText:JSON.stringify(t)),401===t.status?r.reauthenticate(d.warning_session_expired):(w.reject({"errorMsg":e.str.sformat(d.error_save_email,s)}),l.writeTrace("Saving the email to Content Server failed with message: "+s))}})}else w.reject({"errorMsg":d.error_retrieve_token}),l.writeTrace("Retrieving EWS access token failed.")}),w.promise())}function h(i,s){return i?(l.stopGlobalSpinner(),n.confirmQuestion(e.str.sformat(d.info_confirm_saving,s),d.title_save_email,{"buttons":n.buttons.OkCancel})):t.Deferred().resolve(!0)}function m(e){var t=l.getConnector();t.timeoutProcessed||(t.timeoutProcessed=!0,l.stopGlobalSpinner(),n.showWarning(p.AuthenticationFailureDialogText,e,{"buttons":n.buttons.Ok}).always(function(){var e=new s,i=t;e.connector=i;var o=new r({"context":e,"centerVertically":!0});o.authenticate().done(function(){o.beingAuthenticated=!1})}))}function g(e,i,s){var o=this,n=[],a=t.Deferred(),r=0,c=null,d=null!=i?i:c,p=l.getSuggestedWkspFilters(d,s);if(null!=p&&p.rules.length>0)for(r=0;r<p.rules.length;r++){var u=p.rules[r],h=u.filterName.trim();h&&n.push(o.filterWksps(e,u.typeId,u.typeName.trim(),h,u.weight))}var m=l.getSuggestedWkspEmailSearchConfig(d,s);if(null!=m&&m.searchTerm.length>0)for(r=0;r<m.searchTerm.length;r++){var g=m.searchTerm[r];null!=g.region&&null!=g.searchTerm&&n.push(o.searchWksps(e,g.region,g.searchTerm,m.sort,m.weight))}return 0===n.length?setTimeout(function(){a.resolve({"results":[]})}):t.whenAll(n).then(function(e){var t=[],i=[];for(r=0;r<e.length;r++)null!=e[r].error?i.push(e[r].error):Array.prototype.push.apply(t,e[r].results);var o=[];for(r=0;r<t.length;r++){for(var n=t[r].data.properties,c=!1,d=0;d<o.length;d++)if(n.id===o[d].data.properties.id){o[d].data.properties.suggestedWeight+=n.suggestedWeight;var p=new Date(o[d].data.properties.modifyDate),u=new Date(n.modifyDate);u>p&&(o[d].data.properties.modifyDate=u),c=!0;break}c||o.push(t[r])}var h=function(e,t){if(e.data.properties.suggestedWeight>t.data.properties.suggestedWeight)return-1;if(e.data.properties.suggestedWeight<t.data.properties.suggestedWeight)return 1;var i=new Date(e.data.properties.modifyDate),s=new Date(t.data.properties.modifyDate);return i>s?-1:1};o.sort(h);var m=null!=s.general&&null!=s.general.count?s.general.count:5,g=o.slice(0,m),f=!1;if(i.length>0)for(var w=0;w<i.length;w++)l.writeTrace("Error reported in retrieving suggested workspace: "+i[w]);var v=f?i:[];a.resolve({"results":g,"errors":v})},function(e){a.reject(l.getErrorMessage(e))}),a.promise()}function f(e,s,o,n,a){var r,c=t.Deferred();-999!==s?(l.writeTrace("Suggested Wksp: filter wksps with typeID '"+s+"' and name contains '"+n+"'"),r="where_workspace_type_id="+s+"&where_name=contains_"+encodeURIComponent(n)):(l.writeTrace("Suggested Wksp: filter wksps with type name '"+o+"' and name contains '"+n+"'"),r="where_workspace_type_name="+encodeURIComponent(o)+"&where_name=contains_"+encodeURIComponent(n));var d=i.combine(l.v1ToV2(e.connection.url),"businessworkspaces?expanded_view=true&"+r);return t.ajax({"url":d,"type":"GET","headers":{"OTCSTicket":e.connection.session.ticket},"success":function(e){var t=[];if(null!=e&&null!=e.results&&e.results.length>0)for(var i=0;i<e.results.length;i++){var s=e.results[i].data.properties;t.push({"data":{"properties":{"id":s.id,"name":s.name,"size":s.size,"modifyDate":s.modify_date,"suggestedWeight":a,"type":848,"container":!0}}})}c.resolve({"results":t})},"error":function(e){c.resolve({"error":"Filter: "+l.getErrorMessage(e)})}}),c.promise()}function w(e,s,o,n,a){var r=this,c=t.Deferred();l.writeTrace("Suggested Wksp: search emails with region '"+s+"' contains '"+o+"'");var d="search?where1=%22"+s+"%22:(*"+encodeURIComponent(o)+"*)&limit=50";"relevance"!==n&&(d+="&sort=desc_OTObjectDate");var p=i.combine(l.v1ToV2(e.connection.url),d);return t.ajax({"url":p,"type":"GET","headers":{"OTCSTicket":e.connection.session.ticket},"success":function(i){var s=[],o=[],n=0;if(null!=i&&null!=i.results&&i.results.length>0){for(n=0;n<i.results.length;n++){var d=i.results[n].data.properties;s.push(r.getWkspForEmail(e,d.id,d.modify_date,a))}t.whenAll(s).then(function(e){for(n=0;n<e.length;n++){var t=e[n];null!=t&&o.push(t)}c.resolve({"results":o})},function(e){c.reject(l.getErrorMessage(e))})}else c.resolve({"results":o})},"error":function(e){c.resolve({"error":"Search: "+l.getErrorMessage(e)})}}),c.promise()}function v(e,s,o,n){var a=t.Deferred(),r=i.combine(e.connection.url,"nodes/"+s+"/ancestors");return t.ajax({"url":r,"type":"GET","headers":{"OTCSTicket":e.connection.session.ticket},"success":function(e){var t=null;if(null!=e&&null!=e.ancestors&&e.ancestors.length>=2){for(var i=e.ancestors.length-2;i>=0;i--){var s=e.ancestors[i];if(848===s.type){t={"data":{"properties":{"id":s.id,"name":s.name,"size":1,"modifyDate":o,"suggestedWeight":n,"type":848,"container":!0}}};break}}a.resolve(t)}else a.resolve(null)},"error":function(e){a.reject(l.getErrorMessage(e))}}),a.promise()}function b(s){var o=t.Deferred(),n=i.combine(l.v1ToV2(s.connection.url),"businessworkspaces/outlookaddin/suggestedworkspacesconfig");return t.ajax({"url":n,"type":"GET","headers":{"OTCSTicket":s.connection.session.ticket},"success":function(t){null!=t&&null!=t.results&&"Success"===t.results.resultCode?o.resolve(t.results.config):o.reject(null==t||null==t.results?e.str.sformat(d.error_retrieve_suggestedConfig,"Null Configuration"):e.str.sformat(d.error_retrieve_suggestedConfig,t.results.message))},"error":function(e){o.reject(l.getErrorMessage(e))}}),o.promise()}function y(s){var o=t.Deferred(),n=i.combine(l.v1ToV2(s.connection.url),"businessworkspaces/outlookaddin/simplesearchqueries");return t.ajax({"url":n,"type":"GET","headers":{"OTCSTicket":s.connection.session.ticket},"success":function(t){null!=t&&null!=t.results&&"Success"===t.results.resultCode?o.resolve(t.results.menuEntries):o.reject(null==t||null==t.results?e.str.sformat(d.error_retrieve_searchQueries,"Null Configuration"):e.str.sformat(d.error_retrieve_searchQueries,t.results.message))},"error":function(e){o.reject(l.getErrorMessage(e))}}),o.promise()}function k(s){var o=t.Deferred(),n=i.combine(l.v1ToV2(s.connection.url),"businessworkspaces/outlookaddin/config");return t.ajax({"url":n,"type":"GET","headers":{"OTCSTicket":s.connection.session.ticket},"success":function(t){null!=t&&null!=t.results&&"Success"===t.results.resultCode?o.resolve(t.results.config):o.reject(null==t||null==t.results?e.str.sformat(d.error_retrieve_config,"Null Configuration"):e.str.sformat(d.error_retrieve_config,t.results.message))},"error":function(t){o.reject(e.str.sformat(d.error_retrieve_config,l.getErrorMessage(t)))}}),o.promise()}function x(e,s,o,n){var a=this,r=[],l=[],c=t.Deferred(),d=i.combine(e.connection.url,"validation/nodes/names"),p=e.connection.session.ticket;if(o.checked&&(o.isEmail=!0,r.push(o)),null!=n&&n.length)for(var u=0;u<n.length;u++){var h=n[u].data;h.checked&&(h.isEmail=!1,r.push(h))}var m=t.Deferred().resolve();return t.when.apply(t,t.map(r,function(e){return m=m.then(function(){var t="undefined"!=typeof e.isEmail&&e.isEmail?e.suggestedName+".eml":e.suggestedName;return a.resolveName(d,p,s,t,e,l)})})).then(function(){c.resolve()},function(e){var t=Array.isArray(e)&&e.length>0?e[0]:e;c.reject(t)}),c.promise()}function _(i,s,o,n){for(var a='{"parent_id":%d,"names":[%s]}',r=[],c=0;c<n.length;c++)r.push(l.escapeNameToVerify(n[c]));var d='"'+r.join('","')+'"',p=e.str.sprintf(a,o,d);return t.ajax({"type":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","OTCSTicket":s},"url":i,"contentType":!1,"data":{"body":p}})}function C(i,s,o,n,a,r){var c,p=this,u=t.Deferred(),h=n,m=!1;if(!Array.isArray(h)&&r.length>0)for(;p.nameExists(r,h);)c=p.prepareNames(h,5,r),h=c[1],m=!0;m||(c=p.prepareNames(h,5,r));var g=p.verifyName(i,s,o,c);return g.done(function(e){if(e.results&&0===e.results.length)a.suggestedName=c[0],a.editable=m||Array.isArray(h),a.hasConflict=m||Array.isArray(h),r.push(c[0]),u.resolve();else if(e.results.length===c.length){var t=p.resolveName(i,s,o,c,a,r);t.done(function(){u.resolve()}),t.fail(function(e){u.reject(e)})}else{for(var n=0;n<c.length;n++){for(var l=c[n],d=!1,g=0;g<e.results.length;g++){var f=e.results[g].name;if(l.toUpperCase()===f.toUpperCase()){d=!0;break}}if(!d){a.suggestedName=l,a.editable=m||0!==n,a.hasConflict=m||0!==n,r.push(l);break}}u.resolve()}}),g.fail(function(t){401===t.status?p.reauthenticate(d.warning_session_expired):u.reject(e.str.sformat(d.error_validate_name,l.getErrorMessage(t)))}),u.promise()}function T(e,t,i){var s=Array.isArray(e)?!1:!0,o=s?e:e[e.length-1],n="",a=o,r=o.lastIndexOf(".");r>=0&&(n=o.substring(r).trim(),a=o.substring(0,r));var l=/.*\((\d+)\)$/g,c=l.exec(a),d=1,p="",u=!1;null!==c&&c.length>1?(d=parseInt(c[1],10),s||d++,u=!0,p=a.substring(0,a.lastIndexOf("("))):p=a,p=p.trim();for(var h="undefined"==typeof t||1>t?5:t,m="undefined"==typeof i?[]:i,g=[],f=0;h>f;){var w;s&&!u?(w=p+n,s=!1):(w=p+" ("+d+")"+n,d++),this.nameExists(m,w)||(g.push(w),f++)}return g}function S(e,t){if(!Array.isArray(e)||0===e.length)return!1;for(var i=0;i<e.length;i++)if(t.toUpperCase()===e[i].toUpperCase())return!0;return!1}return{"save":u,"confirmSaving":h,"reauthenticate":m,"getSuggestedWksps":g,"filterWksps":f,"searchWksps":w,"getWkspForEmail":v,"getSuggestedWkspConfig":b,"getSimpleSearchQueries":y,"getAddinConfig":k,"resolveNames":x,"resolveName":C,"verifyName":_,"prepareNames":T,"nameExists":S}}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/nameControl",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<td id="checkboxTd" class="emailSaveIconTd hiddenArea">\r\n    <button type="button" id="checkButton" role="checkbox" class="checkbox csui-control csui-checkbox" tabindex="0" aria-label="'+this.escapeExpression((i=null!=(i=t.saveLabel||(null!=e?e.saveLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveLabel","hash":{}}):i))+'">\r\n        <span class="checkboxIcon" id="checkboxIcon"></span>\r\n    </button>\r\n</td>\r\n<td id="itemIconTd" class="emailSaveIconTd hiddenArea"> \r\n    <span class="wkspItemIcon"><div id="itemIcon" title="'+this.escapeExpression((i=null!=(i=t.typeName||(null!=e?e.typeName:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"typeName","hash":{}}):i))+'"></div></span>\r\n</td>\r\n<td class="emailSaveNameTd">\r\n    <div style="" class="wkspInput nameBox textReadonly textNoWrap" id="itemName" tabindex="-1"><span></span></div>\r\n</td>\r\n<td id="editButtonTd" class="emailSaveIconTd hiddenArea">\r\n    <span id="itemEditIcon" class="nameEdit" disabled tabindex="'+this.escapeExpression((i=null!=(i=t.tabIndex||(null!=e?e.tabIndex:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"tabIndex","hash":{}}):i))+'"></span>\r\n</td>'}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_nameControl",s),s}),csui.define("css!conws/widgets/outlook/impl/conwsoutlook",[],function(){}),csui.define("conws/widgets/outlook/impl/dialog/nameControl.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/utils/nodesprites","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/dialog/impl/nameControl","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c){var d=i.CompositeView.extend({"tagName":"tr","template":c,"ui":{},"events":{"click #saveSelectionBack":"backToPreSave","click #itemEditIcon":"toggleEdit","click #checkButton":"clickCheckbox","keyup #itemName":"nameTyping","blur #itemName":"ensureName","keyup #itemEditIcon":"processKey"},"templateHelpers":function(){return{"iconClass":this.mimeType,"tabIndex":this.checked?"0":"-1","saveLabel":l.save_label}},"initialize":function(){},"constructor":function(e){i.CompositeView.prototype.constructor.call(this,e);var t=this,s=null!=e.model?e.model.get("data"):e.data;if(null!=s){this.showOriginalName=null!=s.showOriginalName?s.showOriginalName:!1,this.hasConflict=null!=s.hasConflict?s.hasConflict:!1;var o="";o=this.showOriginalName&&this.hasConflict?s.name?s.name:l.name_untitled:s.suggestedName?s.suggestedName:s.name?s.name:l.name_untitled,this.name=o,this.showCheckbox=null!=s.showCheckbox?s.showCheckbox:!0,this.checkboxDisabled=null!=s.checkboxDisabled?s.checkboxDisabled:!1,this.checked=null!=s.checked?s.checked:!1,this.showEditButton=null!=s.showEditButton?s.showEditButton:!0,this.editable=this.showEditButton&&null!=s.editable?s.editable:!1,this.showIcon=null!=s.showIcon?s.showIcon:!0,this.mimeType=s.mimeType?s.mimeType:"",this.wrapping=null!=s.wrapping?s.wrapping:!1,this.focus=this.editable&&(null!=s.hasConflict?s.hasConflict:!1),this.avoidHighlight=null!=s.avoidHighlight?s.avoidHighlight:!1}t.renderForm()},"processKey":function(e){(13===e.which||32===e.which)&&"itemEditIcon"===e.target.id&&this.toggleEdit(e)},"renderMessage":function(e){var t=this,i=t.$("#saveMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"renderForm":function(){var e=this;setTimeout(function(){if(e.$("#itemName").text(e.name),e.showCheckbox&&e.$("#checkboxTd").removeClass("hiddenArea"),e.editable&&(e.$("#editButtonTd").removeClass("hiddenArea"),e.switchEditMode(!0,e.focus)),e.checked&&(e.$("#checkboxIcon").addClass("checkboxSelected"),e.$("#itemEditIcon").removeAttr("disabled")),e.checkboxDisabled&&(e.$("#checkboxIcon").removeClass("checkboxSelected"),e.$("#checkboxIcon").addClass("checkboxDisabled")),e.showEditButton&&e.$("#editButtonTd").removeClass("hiddenArea"),e.showIcon){e.$("#itemIconTd").removeClass("hiddenArea");var t="icon "+n.findClassByNode({"mime_type":e.mimeType});e.$("#itemIcon").addClass(t)}if(e.wrapping){var i=e.$("#itemName");i.removeClass("textNoWrap"),i[0].style.height=i[0].scrollHeight+"px"}})},"renderError":function(e,t){var i=this,s=e.get("error");s||(s="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),i.renderMessage(s)},"toggleEdit":function(e){var t=this,i=e.target.classList.contains("editCancelIcon");t.switchEditMode(!i,!0),t.avoidHighlight=!1},"switchEditMode":function(e,t){var i=this,s=i.$("#itemName");e?(i.$("#itemEditIcon").addClass("editCancelIcon"),s.removeClass("textReadonly"),s.prop("contenteditable",!0),s.attr("tabindex","0"),s.removeClass("textNoWrap"),setTimeout(function(){s[0].scrollHeight>=30&&(s[0].style.height=s[0].scrollHeight+"px")}),t&&setTimeout(function(){i.highlightName()})):(i.$("#itemEditIcon").removeClass("editCancelIcon"),s.addClass("textReadonly"),s.prop("contenteditable",!1),s.attr("tabindex","-1"),i.wrapping||(s.addClass("textNoWrap"),s[0].style.removeProperty("height")))},"clickCheckbox":function(){var e=this,t=e.$("#checkboxIcon"),i=e.$("#itemEditIcon");if(!t.hasClass("checkboxDisabled")){var s=t.hasClass("checkboxSelected"),o="-1",n=e.$("#itemName");s?(t.removeClass("checkboxSelected"),i.attr("disabled","disabled"),i.removeClass("editCancelIcon"),n.addClass("textReadonly"),n.prop("contenteditable",!1),e.wrapping||(n.addClass("textNoWrap"),n[0].style.removeProperty("height"))):(t.addClass("checkboxSelected"),i.removeAttr("disabled"),o="0"),i.attr("tabindex",o)}},"nameTyping":function(){var e=this.$("#itemName");if(0!==e.length&&!e.hasClass("textReadonly")){var t=e[0];t.scrollHeight>=30&&(t.style.height="1px",t.style.height=t.scrollHeight+"px")}},"ensureName":function(){var e=this;e.$("#itemName").text().trim()||e.$("#itemName").text(l.name_untitled)},"backToPreSave":function(){a.uiShow(a.PreSaveSection),"standardSections"===a.PreSaveSection&&a.uiShow("customSearchButton"),a.uiHide("saveSelectionPanel"),a.uiHide("savePanel")},"backToStandard":function(){a.uiShow("standardSections"),a.uiShow("customSearchButton"),a.uiHide("customSearchSection")},"highlightName":function(){var e=this,t=e.$("#itemName")[0];if(!e.avoidHighlight){t.focus();var i;document.selection?(i=document.body.createTextRange(),i.moveToElementText(t),i.select()):window.getSelection&&(i=document.createRange(),i.selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(i))}}});return d}),csui.define("conws/widgets/outlook/impl/metadata/impl/metadata.forms.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/widgets/metadata/metadata.forms","csui/utils/contexts/factories/connector"],function(e,t,i,s,o,n){var a=s.extend({"propertyPrefix":"createForm","widgetID":"","constructor":function(a,r){r||(r={}),s.prototype.constructor.apply(this,arguments);var l={};if(!(l instanceof i.Collection)){var c=a.getObject(n,r),d=e.config();l=new o(l.models,t.extend({"connector":c,"action":"create","container":r.container,"node":r.node,"autoreset":!0},l.options,d.options))}this.property=l},"fetch":function(){return this.property.fetch(this.options)}});return a}),csui.define("hbs!conws/widgets/outlook/impl/metadata/impl/form.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="binf-panel-heading outlook-heading hiddenArea" title="'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'" id="propertyTitle">\r\n    <span class="headerIcon sectionToggleIcon" id="toggleIcon" tabindex="0" title="'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'"></span>\r\n    <span>'+this.escapeExpression((i=null!=(i=t.title||(null!=e?e.title:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"title","hash":{}}):i))+'</span>\r\n</div>\r\n<div id="propertyForm" class="metadata-formitems"></div>'}});return i.registerPartial("conws_widgets_outlook_impl_metadata_impl_form.item",s),s}),csui.define("conws/widgets/outlook/impl/metadata/form.item.view",["csui/lib/marionette","csui/lib/underscore","csui/lib/jquery","csui/controls/form/form.view","conws/widgets/outlook/impl/utils/utility","hbs!conws/widgets/outlook/impl/metadata/impl/form.item"],function(e,t,i,s,o,n){var a=e.ItemView.extend({"tag":"div","className":"customsearch-attr-container","events":{"click #toggleIcon":"clickToggle","keyup #toggleIcon":"processKeyUp"},"templateHelpers":function(){var e=this.model.get("role_name"),t=this.model.get("title"),i=this.model.get("id");return{"title":"categories"===e?t:i,"toggleStatus":this.expended?o.ToggleStatusCollapse:o.ToggleStatusExpand}},"constructor":function(t){t||(t={}),this.options=t,e.ItemView.prototype.constructor.apply(this,arguments),this.model.on("error",this.errorHandle,this),this.options.hideNotRequired=t.hideNotRequired||!1,this.expended=!0},"template":n,"onRender":function(){var t=new e.Region({"el":this.$el.find(".metadata-formitems")}),i=new s({"context":this.options.context,"model":this.model,"layoutMode":"singleCol","mode":"create","node":this.model.node,"templateId":this.model.attributes.data.templateId});t.show(i),i.hideNotRequired(this.options.hideNotRequired),this.options.hideNotRequired&&!this.options.hasRequiredField?this.$("#propertyTitle").addClass("hiddenArea"):this.$("#propertyTitle").removeClass("hiddenArea"),1===this.options.requiredFormCount&&this.$("#toggleIcon").css("display","none"),this.formView=i},"onRenderForm":function(){this.options.objectView.triggerMethod("render:form")},"switchToHide":function(e){this.formView.hideNotRequired(e),e&&!this.options.hasRequiredField?this.$("#propertyTitle").addClass("hiddenArea"):this.$("#propertyTitle").removeClass("hiddenArea")},"clickToggle":function(){this.$("#toggleIcon").toggleClass("sectionExpended"),this.expended?(this.$("#propertyForm").addClass("hiddenArea"),this.expended=!1):(this.$("#propertyForm").removeClass("hiddenArea"),this.expended=!0)},"processKeyUp":function(e){13===e.which&&"toggleIcon"===e.target.id&&this.clickToggle(e)}});return a}),csui.define("hbs!conws/widgets/outlook/impl/metadata/impl/metadata.forms",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="csui-saved-search-form" id="metadata-forms"></div>\r\n<div class="header-right">\r\n    <div class="required-field-switch">\r\n        <span id="requiredFieldsLabelId" class="only-required-fields-label"\r\n              aria-label="'+this.escapeExpression((i=null!=(i=t.requiredFieldsSwitchTitle||(null!=e?e.requiredFieldsSwitchTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"requiredFieldsSwitchTitle","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.requiredFieldsSwitchTitle||(null!=e?e.requiredFieldsSwitchTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"requiredFieldsSwitchTitle","hash":{}}):i))+'</span>\r\n              <div id="required-fields-switch" class="required-fields-switch"></div>\r\n    </div>\r\n</div>\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_metadata_impl_metadata.forms",s),s}),csui.define("conws/widgets/outlook/impl/metadata/metadata.forms.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/lib/jsonpath","csui/controls/tile/behaviors/blocking.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/contexts/factories/node","csui/utils/contexts/page/page.context","csui/controls/form/fields/booleanfield.view","conws/widgets/outlook/impl/metadata/impl/metadata.forms.factory","conws/widgets/outlook/impl/metadata/form.item.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/metadata/impl/metadata.forms"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m){var g=i.LayoutView.extend({"className":"csui-custom-view-search","templateHelpers":function(){var e={"requiredFieldsTitle":h.required_fields_title,"requiredFieldsSwitchTitle":h.required_fields_switchLabel};return e},"behaviors":{"Blocking":{"behaviorClass":n},"PerfectScrolling":{"behaviorClass":a,"contentParent":".csui-saved-search-form","scrollYMarginOffset":15}},"regions":{"requiredSwitchRegion":"#required-fields-switch"},"constructor":function(t){t=t||{},t.data||(t.data={}),this.context=t.context||new l,this.parentView=t.parentView,i.LayoutView.prototype.constructor.apply(this,arguments),t.container=this.context.getModel(r,{"attributes":{"id":t.parentId},"connector":u.getConnector()}),t.node=this.context.getModel(r,{"attributes":{"type":144,"docParentId":t.parentId},"connector":u.getConnector()}),this.model=this.context.getCollection(d,t),this.options.context=this.context,this.listenTo(this.model,"sync",this.renderForms),this.categoryChecked=!1,this.hasRequired=!1,this.requiredFormCount=0,this.requiredFieldSwitchModel=new s.Model({"data":!1}),this.$el.on({"change input":e.bind(this._refreshDOM,this)}),this.model.fetch()},"_refreshDOM":function(){setTimeout(e.bind(function(){this.triggerMethod("dom:refresh")},this),500)},"template":m,"renderForms":function(){var t=this;if(t.model.length>0){t.checkRequired(t.model.models),t.formViews=[];for(var i,s=0;s<t.model.length;s++){var o=t.model.models[s];"general"!==o.id&&("categories"===o.get("role_name")?t.hasRequired&&(i=new p(e.extend(t.options,{"model":o,"hideNotRequired":!1,"hasRequiredField":o.attributes.hasRequiredField,"requiredFormCount":t.requiredFormCount})),t.formViews.push(i),t.appendView("view"+s,i)):o.attributes.hasRequiredField&&(i=new p(e.extend(t.options,{"model":o,"hideNotRequired":!1,"hasRequiredField":!0,"requiredFormCount":t.requiredFormCount})),t.formViews.push(i),t.appendView("view"+s,i)))}t.hasRequired&&(t.requiredFieldSwitchView=new c({"mode":"writeonly","model":t.requiredFieldSwitchModel,"labelId":"requiredFieldsLabelId"}),t.getRegion("requiredSwitchRegion").show(t.requiredFieldSwitchView),t.listenTo(t.requiredFieldSwitchView,"field:changed",function(e){t.toggleRequiredFields(e.fieldvalue)})),t.parentView.metadataFormRetrieved=!0,t.parentView.model.set("hasRequired",t.hasRequired),t.parentView.processMetadata()}},"checkRequired":function(t){var i=this,s=0;if(!i.categoryChecked){i.categoryChecked=!0;for(var n=0;n<t.length;n++){var a=t[n];if("general"!==a.id){"categories"===a.get("role_name")&&s++,a.attributes.hasRequiredField=!1;var r=o(a.attributes.schema.properties,"$..[?(@.required===true)]");e.isArray(r)&&r.length>0&&(i.hasRequired=!0,a.attributes.hasRequiredField=!0,"categories"!==a.get("role_name")&&i.requiredFormCount++)}}i.hasRequired&&(i.requiredFormCount=i.requiredFormCount+s)}},"toggleRequiredFields":function(t){e.each(this.formViews,function(e){e.switchToHide(t)})},"getValuesToParent":function(){var t=!0,i={"roles":{"categories":{}}};return e.each(this.formViews,function(e){if(!e.formView.validate())return void(t=!1);var s=e.formView.model.get("role_name");"categories"===s?i.roles.categories[e.formView.model.id]=e.formView.getValues():i.roles[s]=e.formView.getValues()}),t&&(this.parentView.metadataValue=i),t},"appendView":function(e,t){var i=this;i.$el.append('<div id="view'+e+'">'),i.addRegion("view"+e,"#view"+e),i["view"+e].show(t)}});return g}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/saveSection",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div id="saveDisplayArea" class="saveDisplayArea">\r\n    <div id="saveSelectionPanel" class="hiddenArea">\r\n        <div class="binf-panel-heading outlook-heading" >\r\n            <span class="headerIcon backwardIcon" tabindex="0" id="saveSectionBack" title="'+this.escapeExpression((i=null!=(i=t.backLabel||(null!=e?e.backLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"backLabel","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.backLabel||(null!=e?e.backLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"backLabel","hash":{}}):i))+'"></span>\r\n            <span id="saveSectionTitle"></span>\r\n        </div>\r\n        <div class="infoMessage">'+this.escapeExpression((i=null!=(i=t.saveInfo||(null!=e?e.saveInfo:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveInfo","hash":{}}):i))+'</div>\r\n        \r\n        <div id="saveMessageArea" class="hiddenArea warningMessage">\r\n            <span class="headerIcon warningIcon"></span>\r\n            <span id="saveMessage" style="display: table;"></span>\r\n        </div>\r\n        \r\n        <div id="saveEmailDiv" style="padding: 5px 5px 5px 30px;">\r\n            <div style="padding: 5px 0 5px 0">'+this.escapeExpression((i=null!=(i=t.saveEmailText||(null!=e?e.saveEmailText:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveEmailText","hash":{}}):i))+'</div>\r\n            <table style="width:100%;">\r\n                <tr>\r\n                    <td class="emailSaveNameTd" style="padding: 0;">\r\n                        <table id="emailName" class="emailSaveTable"></table>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n            \r\n        </div>\r\n        <div id="saveAttachmentDiv" style="padding: 10px 5px 5px 30px;">\r\n            <div style="padding: 5px 0 5px 0">'+this.escapeExpression((i=null!=(i=t.saveAttachmentText||(null!=e?e.saveAttachmentText:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveAttachmentText","hash":{}}):i))+'</div>\r\n            <table style="width:100%;">\r\n                <tr id="attachmentOptionTr">\r\n                    <td class="emailSaveIconTd">\r\n                        <button type="button" id="saveAttachmentCheckbox" role="checkbox" class="checkbox csui-control csui-checkbox" tabindex="0" aria-label="'+this.escapeExpression((i=null!=(i=t.saveLabel||(null!=e?e.saveLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveLabel","hash":{}}):i))+'">\r\n                            <span class="checkboxIcon" id="saveAttachmentCheckboxIcon"></span>\r\n                        </button>\r\n                    </td>\r\n                    <td class="emailSaveNameTd"> \r\n                        <span style="padding: 0 0 0 8px;">'+this.escapeExpression((i=null!=(i=t.saveAttachmentOption||(null!=e?e.saveAttachmentOption:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveAttachmentOption","hash":{}}):i))+'</span>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td colspan="2" class="emailSaveNameTd" style="padding: 10px 3px 5px 0;">\r\n                        <table id="emailAttachment" class="emailSaveTable"></table>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div id="metadataPanel" class="hiddenArea metadataForm">\r\n        <div class="binf-panel-heading outlook-heading" >\r\n            <span class="headerIcon backwardIcon" tabindex="0" id="metadataFormBack" title="'+this.escapeExpression((i=null!=(i=t.backLabel||(null!=e?e.backLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"backLabel","hash":{}}):i))+'" aria-label="'+this.escapeExpression((i=null!=(i=t.backLabel||(null!=e?e.backLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"backLabel","hash":{}}):i))+'"></span>\r\n            <span>'+this.escapeExpression((i=null!=(i=t.requiredFieldsTitle||(null!=e?e.requiredFieldsTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"requiredFieldsTitle","hash":{}}):i))+'</span>\r\n        </div>\r\n        <div class="infoMessage">'+this.escapeExpression((i=null!=(i=t.saveInfo||(null!=e?e.saveInfo:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"saveInfo","hash":{}}):i))+'</div>\r\n        <div id="metadataMessageArea" class="hiddenArea warningMessage">\r\n            <span class="headerIcon warningIcon"></span>\r\n            <span id="metadataMessage" style="display: table;"></span>\r\n        </div>\r\n        <div id="metadataDiv"></div>\r\n    </div>\r\n\r\n    <div id="saveResultPanel" class="hiddenArea">\r\n        <div class="binf-panel-heading outlook-heading" >\r\n            <span id="saveResultTitle"></span>\r\n        </div>    \r\n        <div id="saveResult" style="position:relative; padding: 0 25px 0 25px; line-height: 150%"></div>\r\n    </div>\r\n\r\n    <div class="wkspMessageArea" id="saveMsgArea"></div>\r\n</div>\r\n<div class="saveSectionButton outlook-heading binf-panel-heading" id="saveNextButton" tabindex="0"></div>\r\n\r\n\r\n'
}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_saveSection",s),s}),csui.define("conws/widgets/outlook/impl/dialog/saveSection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette3","csui/lib/backbone","csui/utils/contexts/page/page.context","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","conws/widgets/outlook/impl/utils/emailservice","conws/widgets/outlook/impl/dialog/nameControl.view","conws/widgets/outlook/impl/metadata/metadata.forms.view","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/dialog/impl/saveSection","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c,d,p){var u=i.CompositeView.extend({"template":p,"childView":l,"childEvents":{"change:status":"onStatusChange"},"childViewContainer":"#emailAttachment","events":{"click #saveSectionBack":"clickBack","click #saveEmailDiv #checkButton":"clickSaveEmail","click #saveAttachmentCheckbox":"clickSaveAttachment","click #saveAttachmentDiv #checkButton":"clickOneAttachment","click #saveNextButton":"clickNext","keyup #saveSectionBack, #saveNextButton, #metadataFormBack":"processKey","click #metadataFormBack":"clickMetadataBack"},"templateContext":function(){return{"saveEmailText":this.hasAttachment?d.save_email_text:d.save_email_text_noAttachment,"saveAttachmentText":d.save_attachment_text,"saveAttachmentOption":d.save_attachment_option,"saveInfo":t.str.sformat(d.save_email_info,this.folderName),"requiredFieldsTitle":d.required_fields_title,"saveLabel":d.save_label,"backLabel":d.save_button_back}},"initialize":function(){this.stageCode={"initial":1,"nameChecking":2,"metadata":3,"finished":4},this.model=new s.Model({})},"constructor":function(e){i.CompositeView.prototype.constructor.call(this,e);var t=this;t.connector=e.connector,t.folderId=e.folderId,t.folderName=e.folderName,t.saveStage=t.stageCode.initial,t.saveEmail=!0,t.nothingToSave=!1,t.hasAttachment=null!=e.attachments&&e.attachments.length>0?!0:!1,t.attachments=e.attachments,t.emailTitleInfo={"name":e.proposedEmailName,"showCheckbox":t.hasAttachment,"checkboxDisabled":!1,"editable":!1,"hasConflict":!1,"focus":!1},t.attachmentInfo=[],null!=t.attachments&&t.attachments.forEach(function(e){t.attachmentInfo.push({"data":{"name":e.name,"id":e.id,"mimeType":e.contentType,"attachmentType":e.attachmentType,"checked":!1,"focus":!1,"hasConflict":!1}})}),t.metadataFormView=null,t.metadataFormRetrieved=!1,t.hasRequiredMetadata=!1,t.requiredMetadataResolved=!1,t.metadataValue={},t.previousStage=t.stageCode.initial,t.saveFailed=!1,t.saveMessage="",t.hasAttachment&&(t.collection=new s.Collection(t.attachmentInfo)),t.renderForm()},"processKey":function(e){(13===e.which||32===e.which)&&("saveSectionBack"===e.target.id?this.clickBack(e):"saveNextButton"===e.target.id?this.clickNext(e):"metadataFormBack"===e.target.id&&this.clickMetadataBack(e))},"renderMessage":function(e){var t=this,i=t.$("#saveMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"onStatusChange":function(){this.render()},"renderForm":function(){var t=this;t.renderChildren(),t.saveStage===t.stageCode.initial&&(n.ConflictHighlighted=!1),setTimeout(function(){e("#saveDisplayArea").css("height","calc(100vh - "+(36+n.TraceAreaHeight)+"px)"),e("#saveResult").css("top","calc(40vh - "+(36+n.TraceAreaHeight/2)+"px)");var s=new i.Region({"el":"#emailName"}),o="";if(t.saveStage===t.stageCode.initial)o=t.emailTitleInfo.name;else{var a=t.emailTitleInfo.suggestedName.lastIndexOf(".eml");o=a>0?t.emailTitleInfo.suggestedName.substring(0,a):t.emailTitleInfo.suggestedName}s.show(new l({"data":{"context":t.context,"name":t.emailTitleInfo.name,"suggestedName":o,"showIcon":!1,"showCheckbox":t.hasAttachment,"checkboxDisabled":!t.hasAttachment,"checked":t.saveEmail,"wrapping":!0,"showOriginalName":t.emailTitleInfo.showOriginalName,"hasConflict":t.emailTitleInfo.hasConflict,"editable":t.emailTitleInfo.editable,"focus":t.emailTitleInfo.focus}})),n.uiShow("saveSelectionPanel"),t.$("#saveNextButton").text(d.save_button_next),t.saveStage===t.stageCode.initial?(n.uiHide(n.PreSaveSection),"standardSections"===n.PreSaveSection&&n.uiHide("customSearchButton"),n.uiShow("savePanel"),n.uiShow("saveSelectionPanel"),t.$("#saveSectionTitle").text(d.title_save_email),n.uiHide("metadataPanel"),n.uiHide("saveMessageArea")):t.saveStage===t.stageCode.nameChecking?(t.$("#saveSectionTitle").text(d.save_selection_conflict),n.uiShow("saveMessageArea"),t.$("#saveMessage").html(d.save_selection_conflict_msg)):t.saveStage===t.stageCode.metadata?(t.$("#saveSectionTitle").text(d.required_fields_title),n.uiShow("metadataPanel"),n.uiHide("saveSelectionPanel"),n.uiHide("saveResultPanel")):t.saveStage===t.stageCode.finished&&(n.uiHide("saveSelectionPanel"),n.uiHide("metadataPanel"),n.uiShow("saveResultPanel"),t.$("#saveNextButton").text(d.save_button_close),t.$("#saveResult").text(t.saveMessage),t.$("#saveResultTitle").text(t.saveTitle));for(var r=0,c=0;c<t.attachmentInfo.length;c++){var p=t.attachmentInfo[c].data;if(0===c)r=p.checked?1:0;else if(p.checked&&0===r||!p.checked&&1===r){r=2;break}}t.$("#saveAttachmentCheckboxIcon").removeClass("checkboxSelected checkboxMixed");var u=1===r?"checkboxSelected":2===r?"checkboxMixed":"";t.$("#saveAttachmentCheckboxIcon").addClass(u),t.hasAttachment?1===t.attachments.length&&n.uiHide("attachmentOptionTr"):n.uiHide("saveAttachmentDiv"),t.nothingToSave&&(n.uiShow("saveMessageArea"),t.$("#saveNextButton").addClass("buttonDisabled"),t.$("#saveMessage").html(d.save_noSelection))})},"renderError":function(e,t){var i=this,s=e.get("error");s||(s="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),i.renderMessage(s)},"clickBack":function(){var t=this;if(t.saveStage===t.stageCode.initial)n.uiShow(n.PreSaveSection),"standardSections"===n.PreSaveSection&&n.uiShow("customSearchButton"),n.uiHide("saveSelectionPanel"),n.uiHide("savePanel"),window.scrollTo(0,n.ScorllPositionBeforeSaving),n.ScorllPositionBeforeSaving=-1;else if(t.saveStage===t.stageCode.nameChecking){t.emailTitleInfo.showOriginalName=!0,t.emailTitleInfo.editable=!1;for(var i=0;i<t.attachmentInfo.length;i++){var s=t.attachmentInfo[i].data;s.showOriginalName=!0,s.editable=!1}t.saveStage=t.stageCode.initial,t.renderForm()}else t.saveStage===t.stageCode.metadata&&(t.saveStage=t.previousStage,t.renderForm());e("#conwsoutlook-body").focus()},"backToStandard":function(){n.uiShow("standardSections"),n.uiShow("customSearchButton"),n.uiHide("customSearchSection")},"clickMetadataBack":function(){n.uiShow("saveSelectionPanel"),n.uiHide("metadataPanel"),this.saveStage=this.previousStage,this.$("#saveSectionBack").focus()},"clickSaveAttachment":function(){var t=this,i=t.$("#saveAttachmentCheckboxIcon"),s=i.hasClass("checkboxSelected");i.removeClass("checkboxMixed"),s?i.removeClass("checkboxSelected"):(i.addClass("checkboxSelected"),t.$("#saveNextButton").hasClass("buttonDisabled")&&(t.$("#saveNextButton").removeClass("buttonDisabled"),n.uiHide("saveMessageArea"))),t.$("#saveAttachmentDiv #checkboxIcon").each(function(t,i){s?e(i).removeClass("checkboxSelected"):e(i).addClass("checkboxSelected")}),t.$("#saveAttachmentDiv #itemEditIcon").each(function(t,i){s?(e(i).attr("disabled","disabled"),e(i).removeClass("editCancelIcon"),e(i).attr("tabindex","-1")):(e(i).removeAttr("disabled"),e(i).attr("tabindex","0"))}),t.$("#saveAttachmentDiv #itemName").each(function(t,i){s&&(e(i).addClass("textReadonly"),e(i).prop("contenteditable",!1),e(i).addClass("textNoWrap"),i.style.removeProperty("height"))})},"clickOneAttachment":function(e){var t=this,i=e.target;"checkButton"===e.target.id&&(i=e.target.querySelector("span"));var s=t.$("#saveAttachmentCheckboxIcon"),o=t.$("#saveAttachmentDiv #checkboxIcon"),a=i.classList.contains("checkboxSelected")?!0:!1,r=!1;o.each(function(e,t){return t!==i&&t.classList.contains("checkboxSelected")!==a?(r=!0,!1):void 0}),r?(s.removeClass("checkboxSelected"),s.addClass("checkboxMixed")):(s.removeClass("checkboxMixed"),a?s.addClass("checkboxSelected"):s.removeClass("checkboxSelected")),a&&t.$("#saveNextButton").hasClass("buttonDisabled")&&(t.$("#saveNextButton").removeClass("buttonDisabled"),n.uiHide("saveMessageArea"))},"clickSaveEmail":function(){var e=this;!e.$("#saveEmailDiv #checkButton").hasClass("checkboxSelected")&&e.$("#saveNextButton").hasClass("buttonDisabled")&&(e.$("#saveNextButton").removeClass("buttonDisabled"),n.uiHide("saveMessageArea"))},"clickNext":function(){var t=this;if(!t.$("#saveNextButton").hasClass("buttonDisabled")){if(t.saveStage===t.stageCode.initial||t.saveStage===t.stageCode.nameChecking)if(t.previousStage=t.saveStage,t.collectInfo(),t.nothingToSave)t.renderForm();else{n.startGlobalSpinner(),t.saveStage=t.stageCode.nameChecking;var s=a.resolveNames(t.connector,t.folderId,t.emailTitleInfo,t.attachmentInfo);s.done(function(){var e=!0;t.savingEmailName=t.emailTitleInfo.checked?t.emailTitleInfo.suggestedName:"",t.savingAttachments=[],t.emailTitleInfo.hasConflict&&(e=!1);for(var s=0;s<t.attachmentInfo.length;s++){var o=t.attachmentInfo[s].data;e||(o.avoidHighlight=!0),o.hasConflict&&(e=!1),o.checked&&t.savingAttachments.push({"name":o.suggestedName,"id":o.id,"mimeType":o.mimeType})}if(e){t.saveStage=t.stageCode.metadata;var a=new i.Region({"el":"#metadataDiv"});t.metadataFormRetrieved?t.hasRequiredMetadata?(n.uiHide("saveSelectionPanel"),n.uiShow("metadataPanel"),n.stopGlobalSpinner()):t.processMetadata():(t.metadataFormView=new c({"parentId":t.folderId,"parentView":t}),a.show(t.metadataFormView))}else n.stopGlobalSpinner(),t.renderForm()}),s.fail(function(e){t.saveStage=t.stageCode.finished,t.saveFailed=!0,t.saveMessage=n.getErrorMessage(e),t.saveTitle=d.title_save_error,n.stopGlobalSpinner(),t.renderForm()})}else if(t.saveStage===t.stageCode.metadata){var o=t.metadataFormView.getValuesToParent();o?(n.startGlobalSpinner(),n.uiHide("metadataMessageArea"),t.processSave()):(n.uiShow("metadataMessageArea"),t.$("#metadataMessage").html(d.save_metadate_form_invalid))}else t.saveStage===t.stageCode.finished&&(n.SavingSubmitted=!1,n.EmailChangedAfterSaving?r.emailItemChanged({}):(n.uiShow(n.PreSaveSection),"standardSections"===n.PreSaveSection&&n.uiShow("customSearchButton"),n.uiHide("savePanel"),window.scrollTo(0,n.ScorllPositionBeforeSaving),n.ScorllPositionBeforeSaving=-1));e("#conwsoutlook-body").focus()}},"processMetadata":function(){var e=this;return e.hasRequiredMetadata=e.model.get("hasRequired")||!1,e.metadataFormRetrieved||e.hasRequiredMetadata?(e.metadataFormRetrieved=!0,void(e.hasRequiredMetadata?(n.stopGlobalSpinner(),n.uiHide("saveSelectionPanel"),n.uiShow("metadataPanel")):e.processSave())):void(e.metadataFormRetrieved=!0)},"processSave":function(){var e=this;e.saveStage=e.stageCode.finished,n.SavingSubmitted=!0;var t=a.save(e.connector,e.folderId,e.savingEmailName,e.savingAttachments,e.metadataValue);t.done(function(t){e.saveFailed=!1,e.saveMessage=t.result,e.saveTitle=d.title_save_success,n.stopGlobalSpinner(),e.renderForm()}),t.fail(function(t){e.saveFailed=!0,e.saveMessage=t.errorMsg,e.saveTitle=d.title_save_error,n.stopGlobalSpinner(),e.renderForm()})},"collectInfo":function(){var e=this;e.nothingToSave=!0,e.emailTitleInfo.suggestedName=n.escapeNameToCreate(e.$("#emailName #itemName").text().trim()),e.emailTitleInfo.showOriginalName=!1,e.saveEmail=e.$("#saveEmailDiv #checkboxIcon").hasClass("checkboxSelected")||e.$("#saveEmailDiv #checkboxIcon").hasClass("checkboxDisabled"),e.emailTitleInfo.checked=e.saveEmail,e.saveEmail?e.nothingToSave=!1:(e.emailTitleInfo.editable=!1,e.emailTitleInfo.hasConflict=!1,e.emailTitleInfo.focus=!1);for(var t=e.$("#saveAttachmentDiv #checkboxIcon"),i=e.$("#saveAttachmentDiv #itemName"),s=0;s<e.attachmentInfo.length;s++){var o=e.attachmentInfo[s].data;o.checked=t.eq(s).hasClass("checkboxSelected"),e.nothingToSave&&o.checked&&(e.nothingToSave=!1),o.suggestedName=n.escapeNameToCreate(i.eq(s).text().trim()),o.editable=!i.eq(s).hasClass("textReadonly"),o.showOriginalName=!1,o.avoidHighlight=!1,o.hasConflict=!1}}});return u}),csui.define("conws/widgets/outlook/impl/folder/folder.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/page/page.context","csui/dialogs/modal.alert/modal.alert","conws/widgets/outlook/impl/utils/emailservice","hbs!conws/widgets/outlook/impl/folder/impl/folder","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/dialog/saveSection.view","i18n!conws/widgets/outlook/impl/nls/lang","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c,d){var p=s.LayoutView.extend({"className":"FolderItem","template":r,"templateHelpers":function(){return{"serverOrigin":window.ServerOrigin,"supportFolder":window.ContentServerSupportPath,"iconClass":this.iconClass,"id":this.id,"name":this.name,"typeName":this.typeName,"toggleStatus":this.hasChild?l.ToggleStatusExpand:l.ToggleStatusEmpty,"tabIndex":this.hasChild?"0":"-1","saveTitle":d.title_save_email}},"regions":{"subFolders":"#subFolders"},"ui":{"$actionBar":".wkspFolder-actiondiv","$toggleIcon":"#toggleIcon"},"events":{"click .listItemFolder":"clickFolder","mouseenter #wkspFolderItem":"showActionBar","mouseleave #wkspFolderItem":"hideActionBar","click #saveEmailButton":"saveEmail","focusin #saveEmailButton":"buttonFocused","focusout #saveEmailButton, #folderNameDiv":"buttonFocusOut","keyup #toggleIcon, #folderNameDiv, #saveEmailButton":"processKeyUp","keydown #folderNameDiv, #saveEmailButton":"processKeyDown"},"initialize":function(){this.listenTo(this.model,"change",this.renderToggleIcon)},"constructor":function(e){this.model=e.model,this.name=e.model.get("data").properties.name,this.id=e.model.get("data").properties.id,this.type=e.model.get("data").properties.type,this.typeName=e.model.get("data").properties.type_name,this.hasChild=e.model.get("data").properties.container_size>0,this.connector=l.getConnector(),this.folderRetrieved=!1,this.folderExpended=!1,this.iconClass="wkspFolderIcon",751===this.type?this.iconClass="wkspEmailFolderIcon":136===this.type&&(this.iconClass="csui-icon compound_document listItemIcon"),s.LayoutView.prototype.constructor.call(this,e)},"clickFolder":function(e){if("saveEmailButton"!==event.target.id){var i=this;if(i.hasChild){var s=t(e.target).data("id");if(s===i.id&&"noToggle"!==s){var o=window.csui?window.csui.require("conws/widgets/outlook/impl/folder/folders.view"):window.require("conws/widgets/outlook/impl/folder/folders.view");if(i.folderRetrieved)i.folderExpended?(i.getRegion("subFolders").$el.hide(),i.folderExpended=!1,i.toggleStatus=l.ToggleStatusExpand):(i.getRegion("subFolders").$el.show(),i.folderExpended=!0,i.toggleStatus=l.ToggleStatusCollapse);else{var n=new o({"connector":i.connector,"id":i.id,"parentNode":i,"pageSize":l.pageSize,"pageNo":1});i.getRegion("subFolders").show(n)}var a=this.ui.$toggleIcon;a.attr("class",i.toggleStatus)}}}},"renderToggleIcon":function(){this.hasChild=this.model.get("hasChild");var e=this.ui.$toggleIcon;this.hasChild||(this.toggleStatus=l.ToggleStatusEmpty),e.attr("class",this.toggleStatus);var i=this.toggleStatus===l.ToggleStatusEmpty?"-1":"0";e.attr("tabindex",i),"-1"===i&&t("#conwsoutlook-body").focus()},"showActionBar":function(e){var i=this,s=t(e.currentTarget).data("id");if(s===i.id&&(751===i.type||!l.emailSavingConfig.onlySaveToEmailFolder)){var o=this.ui.$actionBar;o.css("display","block"),setTimeout(function(){o.addClass("binf-in")},300)}},"hideActionBar":function(){var e=this;if(0!==e.type||!l.emailSavingConfig.onlySaveToEmailFolder){var t=this.ui.$actionBar;t.css("display","none"),t.removeClass("binf-in")}},"processKeyUp":function(e){t(e.target).data("id")===this.id&&((13===e.which||32===e.which)&&("toggleIcon"===e.target.id?this.clickFolder(e):"saveEmailButton"===e.target.id&&(this.saveEmail(e),this.hideActionBar(e))),9===e.which&&"folderNameDiv"===e.target.id&&this.showActionBar(e))},"processKeyDown":function(e){t(e.target).data("id")===this.id&&9===e.which&&(e.shiftKey&&"folderNameDiv"===e.target.id||!e.shiftKey&&"saveEmailButton"===e.target.id)&&this.hideActionBar(e)},"buttonFocused":function(e){if("saveEmailButton"===e.target.id){var i=e.target.querySelector("div");null!==i&&(t(i).css("outline","1px dotted grey"),t(i).css("outline-offset","2px"))}},"buttonFocusOut":function(e){if("saveEmailButton"===e.target.id||"folderNameDiv"===e.target.id){var i=this;setTimeout(function(e){var t=document.activeElement.id;"saveEmailButton"!==t&&"folderNameDiv"!==t&&i.hideActionBar(e)},50);var s=e.target.querySelector("div");null!==s&&(t(s).css("outline",""),t(s).css("outline-offset",""))}},"saveEmail":function(e){var i=this,o=t(e.currentTarget).data("id");if(o===i.id){if(null==window.CurrentEmailItem)return void n.showWarning(d.warning_no_outlook_context);var a=i.id,r=i.name,p=i.connector,u=window.CurrentEmailItem;l.ScorllPositionBeforeSaving=window.pageYOffset;var h=new s.Region({"el":"#savePanel"}),m=new c({"connector":p,"folderId":a,"folderName":r,"proposedEmailName":u.subject,"attachments":u.archivableAttachments});h.show(m),t("#conwsoutlook-body").focus()}}});return p}),csui.define("hbs!conws/widgets/outlook/impl/folder/impl/folders",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div id="folders-list" style="padding-left: 22px"></div>\r\n<div class="listItemFolder"><a href="javascript:;" id="moreLink" class="moreLink" title="'+this.escapeExpression((i=null!=(i=t.showMoreFoldersTitle||(null!=e?e.showMoreFoldersTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreFoldersTitle","hash":{}}):i))+'" data-id="'+this.escapeExpression((i=null!=(i=t.id||(null!=e?e.id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"id","hash":{}}):i))+'"  tabindex="0">'+this.escapeExpression((i=null!=(i=t.showMoreLink||(null!=e?e.showMoreLink:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreLink","hash":{}}):i))+"</a></div>\r\n\r\n\r\n"}});return i.registerPartial("conws_widgets_outlook_impl_folder_impl_folders",s),s}),csui.define("conws/widgets/outlook/impl/folder/folders.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/folder/impl/folders.model","conws/widgets/outlook/impl/folder/folder.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/folder/impl/folders","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l){var c=i.CompositeView.extend({"className":"folders-conwsoutlook","template":l,"childView":n,"childViewContainer":"#folders-list","templateHelpers":function(){return{"id":this.id,"showMoreLink":r.showMore_link,"showMoreFoldersTitle":r.showMore_folders}},"events":{"click #moreLink":"retrieveNextPage"},"initialize":function(){},"constructor":function(e){e.model=new o({},e),this.parentNode=e.parentNode,this.id=e.id,this.pageNo=e.pageNo,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"sync",this.renderFolders),e.model.fetch()},"retrieveNextPage":function(e){var i=t(e.currentTarget).data("id");if(i===this.id){var s=this.model.get("collection"),o=s?s.paging:null;o&&o.links&&o.links.data&&o.links.data.next&&o.links.data.next.href&&(this.model.nextPageUrl=o.links.data.next.href,this.model.fetch())}},"renderFolders":function(e){var i=this,o=e.get("collection"),n=o?o.paging:null,r=null==n||null==n.links||null==n.links.data||null==n.links.data.previous,l=e.get("results");if(r&&(i.parentNode.folderRetrieved=!0,i.parentNode.toggleStatus=a.ToggleStatusCollapse,i.parentNode.folderExpended=!0,0===l.length?i.parentNode.model.set("hasChild",!1):i.parentNode.model.set("hasChild",!0)),0!==l.length||!r)if(null==i.collection)i.collection=new s.Collection(l),i.render();else{var c=i.collection.length;i.collection.add(new s.Collection(l).toJSON()),i._addItems(i.collection.slice(c),c)}i.$(".moreLink").each(function(){var e=t(this);e.data("id")===i.id&&(n&&n.links&&n.links.data&&n.links.data.next&&n.links.data.next.href?e.css("display","block"):e.css("display","none"))})},"_addItems":function(t,i){var s,o=this;e.each(t,function(e,t){s=o.getChildView(e),o._addChild(e,s,i+t)})},"_addChild":function(){return s.Marionette.CompositeView.prototype.addChild.apply(this,arguments)}});return c}),csui.define("conws/widgets/outlook/impl/wksp/wksp.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/dialogs/modal.alert/modal.alert","csui/utils/nodesprites","hbs!conws/widgets/outlook/impl/wksp/impl/wksp","conws/widgets/outlook/impl/folder/folders.view","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","conws/widgets/outlook/impl/dialog/saveSection.view","conws/widgets/outlook/impl/wksp/impl/wksp.model","i18n!conws/widgets/outlook/impl/nls/lang"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h){var m=s.LayoutView.extend({"className":"ListItem","template":r,"templateHelpers":function(){return{"id":this.id,"name":this.name,"iconClass":this.getIconClass(),"typeName":this.typeName,"toggleStatus":this.hasChild&&this.expendable?c.ToggleStatusExpand:c.ToggleStatusEmpty,"openLinkTitle":h.wksp_open_link,"linkToWS":o.combine(new o(this.connector.connection.url).getCgiScript(),"app/nodes",this.id),"tabIndex":this.hasChild?"0":"-1","saveButtonTitle":h.save_action_email}},"regions":{"subFolders":"#subFolders"},"ui":{"$actionBar":".wkspFolder-actiondiv","$toggleIcon":"#toggleIcon","$saveMenuItem":"#wkspSaveMenuItem","$saveButton":"#saveEmailButton"},"events":{"click .listItemWksp":"clickWksp","mouseenter #wkspItem":"showActionBar","mouseleave #wkspItem":"hideActionBar","click #saveEmailButton":"saveEmail","focusin #saveEmailButton, #wkspOpenButton":"buttonFocused","focusout #saveEmailButton, #wkspOpenButton, #wkspNameDiv":"buttonFocusOut","keyup #toggleIcon, #wkspNameDiv, #saveEmailButton":"processKeyUp","keydown #wkspNameDiv, #wkspOpenButton":"processKeyDown"},"initialize":function(){this.listenTo(this.model,"change",this.renderToggleIcon)},"constructor":function(e){this.model=e.model;var t=e.model.get("data").properties;this.name=t.name,this.id=t.id,this.typeName=t.type_name,this.type=t.type,this.hasChild=t.container&&t.size>0&&848===t.type,this.connector=c.getConnector();var i=this.model.get("enableEmailSaving");this.expendable=(void 0!==i?i:!0)&&c.emailSavingConfig.allowExpandWorkspace,this.folderRetrieved=!1,this.folderExpended=!1;var o=this;(void 0===i||i)&&this.updateModelForPreConfigFolder(o),s.LayoutView.prototype.constructor.call(this,e)},"processKeyUp":function(e){t(e.target).data("id")===this.id&&(13===e.which||32===e.which?"toggleIcon"===e.target.id?this.clickWksp(e):"saveEmailButton"===e.target.id&&this.saveEmail(e):9===e.which&&"wkspNameDiv"===e.target.id&&this.showActionBar(e))},"processKeyDown":function(e){9===e.which&&(!e.shiftKey&&"wkspOpenButton"===e.target.id||e.shiftKey&&"wkspNameDiv"===e.target.id)&&this.hideActionBar(e)},"buttonFocused":function(e){if("saveEmailButton"===e.target.id||"wkspOpenButton"===e.target.id){var i=e.target.querySelector("div");null!==i&&(t(i).css("outline","1px dotted grey"),t(i).css("outline-offset","2px"))}},"buttonFocusOut":function(e){var i=this;if(("saveEmailButton"===e.target.id||"wkspOpenButton"===e.target.id||"wkspNameDiv"===e.target.id)&&(setTimeout(function(e){var t=document.activeElement.id;"saveEmailButton"!==t&&"wkspOpenButton"!==t&&"wkspNameDiv"!==t&&i.hideActionBar(e)},50),"wkspNameDiv"!==e.target.id)){var s=e.target.querySelector("div");null!==s&&(t(s).css("outline",""),t(s).css("outline-offset",""))}},"clickWksp":function(e){if("saveEmailButton"!==e.target.id&&"wkspOpenButton"!==e.target.id){var i=this;if(i.expendable&&i.expendable&&i.hasChild){var s=t(e.target).data("id");if(!s||"noToggle"!==s){if(i.folderRetrieved)i.folderExpended?(i.getRegion("subFolders").$el.hide(),i.folderExpended=!1,i.toggleStatus=c.ToggleStatusExpand):(i.getRegion("subFolders").$el.show(),i.folderExpended=!0,i.toggleStatus=c.ToggleStatusCollapse);else{var o=new l({"connector":this.connector,"id":i.id,"parentNode":i,"pageSize":c.pageSize,"pageNo":1});i.getRegion("subFolders").show(o)}var n=this.ui.$toggleIcon;n.attr("class",i.toggleStatus)}}}},"saveEmail":function(e){var i=this,o=t(e.currentTarget).data("id");if(o===i.id){if(null==window.CurrentEmailItem)return void n.showWarning(h.warning_no_outlook_context);var a=i.saveFolderId,r=i.saveFolderName,l=i.connector,d=window.CurrentEmailItem;c.ScorllPositionBeforeSaving=window.pageYOffset;var u=new s.Region({"el":"#savePanel"}),m=new p({"connector":l,"folderId":a,"folderName":r,"proposedEmailName":d.subject,"attachments":d.archivableAttachments});u.show(m),t("#conwsoutlook-body").focus()}},"keyEnterWksp":function(e){(13===e.keyCode||27===e.keyCode)&&this.$(".listItemWkspName").click()},"showActionBar":function(){var e=this.ui.$actionBar;e.css("display","block"),setTimeout(function(){e.addClass("binf-in")},300)},"hideActionBar":function(){var e=this.ui.$actionBar;e.css("display","none"),e.removeClass("binf-in")},"renderToggleIcon":function(){this.hasChild=this.model.get("hasChild");var e=this.ui.$toggleIcon;this.hasChild&&this.expendable||(this.toggleStatus=c.ToggleStatusEmpty),e.attr("class",this.toggleStatus);var i=this.toggleStatus===c.ToggleStatusEmpty?"-1":"0";e.attr("tabindex",i),"-1"===i&&t("#conwsoutlook-body").focus()},"updateModelForPreConfigFolder":function(e){if(c.emailSavingConfig.preConfigFolderToSave.enabled){var t=new u({"id":e.id},{"connector":e.connector}),i=t.getPreConfigFolder();i.done(function(t){var i=e.ui.$saveMenuItem,s=e.ui.$saveButton;t.hasPreConfigFolder?(e.saveFolderId=t.folderId,e.saveFolderName=t.folderName,i.css("display","inline-block"),s.attr("title",h.title_save_email_to+t.folderName)):i.css("display","none")})}},"getIconClass":function(){var e=this,t=e.model.attributes,i={"type":e.type};return null!=t&&null!=t.data&&null!=t.data.properties&&(i=t.data.properties),"icon "+a.findClassByNode(i)}});return m}),csui.define("hbs!conws/widgets/outlook/impl/recentwksps/impl/recentwksps",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="binf-panel-heading outlook-heading">\r\n    <span class="headerIcon sectionToggleIcon" id="recentToggleIcon" tabindex="0"></span>\r\n    <span >'+this.escapeExpression((i=null!=(i=t.sectionTitle||(null!=e?e.sectionTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"sectionTitle","hash":{}}):i))+'</span> <span id="recentCount"></span>\r\n</div>\r\n<div id="recentSection">\r\n    <div id="recent-list" class=""></div>\r\n    <div class="listItemWksp"><a href="javascript:;" id="moreRecentWksp" class="moreLinkWksp" title="'+this.escapeExpression((i=null!=(i=t.showMoreWkspTitle||(null!=e?e.showMoreWkspTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreWkspTitle","hash":{}}):i))+'" tabindex="0">'+this.escapeExpression((i=null!=(i=t.showMoreLink||(null!=e?e.showMoreLink:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreLink","hash":{}}):i))+'</a></div>\r\n    <div class="wkspMessageArea" id="recentWkspMsgArea"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_recentwksps_impl_recentwksps",s),s}),csui.define("conws/widgets/outlook/impl/recentwksps/recentwksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/recentwksps/impl/recentwksps.model.factory","conws/widgets/outlook/impl/wksp/wksp.view","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/recentwksps/impl/recentwksps","conws/widgets/outlook/impl/utils/utility","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l){var c=i.CompositeView.extend({"className":"recentWksps-conwsoutlook panel panel-default","template":r,"childView":n,"childViewContainer":"#recent-list","templateHelpers":function(){return{"sectionTitle":a.sectionTitle_recent,"showMoreLink":a.showMore_link,"showMoreWkspTitle":a.showMore_wksp}},"events":{"click #moreRecentWksp":"retrieveNextPage","click #recentToggleIcon":"toggleIconClicked","keyup":"processKey"},"constructor":function(e){e.model=e.context.getModel(o),i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError)},"renderWksps":function(t){l.stopGlobalSpinner();var i=this,o=t.get("results"),n=t.get("paging"),r=null==n||null==n.actions||n.actions.previous;if(0===o.length&&r)n&&1===n.page&&(i.renderMessage(a.noWksp_recent),e("#recentToggleIcon").click());else if(null==i.collection)i.collection=new s.Collection(o),i.render();else{var c=i.collection.length;i.collection.add(new s.Collection(o).toJSON()),i._addItems(i.collection.slice(c),c)}e("#recentCount").html("("+n.total_count+")");var d=i.$("#moreRecentWksp");n&&n.actions&&n.actions.next&&n.actions.next.href?d.css("display","block"):d.css("display","none")},"retrieveNextPage":function(){var e=this.model.get("paging");e&&e.actions&&e.actions.next&&e.actions.next.href&&(l.startGlobalSpinner(),this.model.nextPageUrl=e.actions.next.href,this.model.fetch())},"_addItems":function(e,i){var s,o=this;t.each(e,function(e,t){s=o.getChildView(e),o._addChild(e,s,i+t)})},"_addChild":function(){return s.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"renderError":function(e,i){l.stopGlobalSpinner();var s=this,o=e.get("error");o||(o="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),s.renderMessage(t.str.sformat(a.error_retrieve_recent,o))},"renderMessage":function(e){var t=this,i=t.$("#recentWkspMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"processKey":function(e){(13===e.which||32===e.which)&&"recentToggleIcon"===e.target.id&&this.toggleIconClicked(e)},"toggleIconClicked":function(){l.collapsibleClicked("recent")}});return c}),csui.define("hbs!conws/widgets/outlook/impl/favoritewksps/impl/favoritewksps",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="binf-panel-heading outlook-heading">\r\n    <span class="headerIcon sectionToggleIcon" id="favoriteToggleIcon" tabindex="0"></span>\r\n    <span >'+this.escapeExpression((i=null!=(i=t.sectionTitle||(null!=e?e.sectionTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"sectionTitle","hash":{}}):i))+'</span> <span id="favoriteCount"></span>\r\n</div>\r\n<div id="favoriteSection">\r\n    <div id="favorite-list" class="panel panel-default"></div>\r\n    <div class="listItemWksp"><a href="javascript:;" id="moreFavoriteWksp" class="moreLinkWksp" title="'+this.escapeExpression((i=null!=(i=t.showMoreWkspTitle||(null!=e?e.showMoreWkspTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreWkspTitle","hash":{}}):i))+'" tabindex="0">'+this.escapeExpression((i=null!=(i=t.showMoreLink||(null!=e?e.showMoreLink:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreLink","hash":{}}):i))+'</a></div>\r\n    <div class="wkspMessageArea" id="recentWkspMsgArea"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_favoritewksps_impl_favoritewksps",s),s}),csui.define("conws/widgets/outlook/impl/favoritewksps/favoritewksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/favoritewksps/impl/favoritewksps.model.factory","conws/widgets/outlook/impl/wksp/wksp.view","conws/widgets/outlook/impl/wksp/impl/wksp.model","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/favoritewksps/impl/favoritewksps","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c){var d=i.CompositeView.extend({"className":"favoriteWksps-conwsoutlook panel panel-default","template":c,"childView":n,"childViewContainer":"#favorite-list","templateHelpers":function(){return{"sectionTitle":l.sectionTitle_favorite,"showMoreLink":l.showMore_link,"showMoreWkspTitle":l.showMore_wksp}
},"events":{"click #moreFavoriteWksp":"retrieveNextPage","click #favoriteToggleIcon":"toggleIconClicked","keyup":"processKey"},"initialize":function(){},"constructor":function(e){e.model=e.context.getModel(o),i.CompositeView.prototype.constructor.call(this,e),this.pageIndex=0,this.pageSize=r.pageSize,this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError)},"renderWksps":function(t){var i=this,o=t.get("results"),n=o.length;if(0===n)i.renderMessage(l.noWksp_favorite),e("#favoriteToggleIcon").click();else{var a;if(0===i.pageIndex)a=n>i.pageSize?i.pageSize:n,i.collection=new s.Collection(o.slice(0,a)),i.render();else{var r=i.pageIndex*i.pageSize,c=(i.pageIndex+1)*i.pageSize,d=i.collection.length;a=n>c?c:n,i.collection.add(new s.Collection(o.slice(r,a)).toJSON()),i._addItems(i.collection.slice(d),d)}}e("#favoriteCount").html("("+n+")");var p=i.$("#moreFavoriteWksp"),u=(i.pageIndex+1)*i.pageSize<n?"block":"none";p.css("display",u)},"retrieveNextPage":function(){var e=this;e.pageIndex++,e.renderWksps(e.model)},"_addItems":function(e,i){var s,o=this;t.each(e,function(e,t){s=o.getChildView(e),o._addChild(e,s,i+t)})},"_addChild":function(){return s.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"renderError":function(e,i){var s=this,o=e.get("error");o||(o="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),s.renderMessage(t.str.sformat(l.error_retrieve_favorite,o))},"renderMessage":function(e){var t=this,i=t.$("#recentWkspMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"processKey":function(e){(13===e.which||32===e.which)&&"favoriteToggleIcon"===e.target.id&&this.toggleIconClicked(e)},"toggleIconClicked":function(){r.collapsibleClicked("favorite")}});return d}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/searchresult",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div id="searchresult-list" ></div>\r\n<div class="listItemWksp"><a href="javascript:;" id="moreSearchWksp" class="moreLinkWksp" title="'+this.escapeExpression((i=null!=(i=t.showMoreWkspTitle||(null!=e?e.showMoreWkspTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreWkspTitle","hash":{}}):i))+'" tabindex="0">'+this.escapeExpression((i=null!=(i=t.showMoreLink||(null!=e?e.showMoreLink:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"showMoreLink","hash":{}}):i))+'</a></div>\r\n<div class="wkspMessageArea" id="searchResultMsgArea"></div>\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_searchresult",s),s}),csui.define("conws/widgets/outlook/impl/searchwksps/searchresult.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/searchwksps/impl/searchresult.model","conws/widgets/outlook/impl/wksp/wksp.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/searchresult","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l){var c=i.CompositeView.extend({"className":"wksp-srch-results","template":l,"childView":n,"childViewContainer":"#searchresult-list","templateHelpers":function(){return{"showMoreLink":r.showMore_link,"showMoreWkspTitle":r.showMore_wksp}},"ui":{"srchResultMessage":"#searchResultMsgArea","srchResultList":"#searchresult-list"},"events":{"click #moreSearchWksp":"retrieveNextPage"},"initialize":function(){},"constructor":function(e){e.model=new o({},e),this.enableEmailSaving=e.enableEmailSaving,this.typeAhead=e.typeAhead,this.wkspName=e.wkspName,this.pageNo=e.pageNo,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError),e.model.fetch()},"retrieveNextPage":function(){var e=this.model.get("paging");e&&e.actions&&e.actions.next&&e.actions.next.href&&(a.startGlobalSpinner(),this.model.nextPageUrl=e.actions.next.href,this.model.fetch())},"renderWksps":function(e){a.stopGlobalSpinner();var i=this,o=e.get("paging"),n=null==o||null==o.actions||o.actions.previous,l=e.get("results");if(t.each(l,function(e){e.enableEmailSaving=i.enableEmailSaving}),0===l.length&&n)1===i.pageNo&&i.renderMessage(r.noWksp_search);else{if(null==i.collection)i.collection=new s.Collection(l),i.render();else{var c=i.collection.length;i.collection.add(new s.Collection(l).toJSON()),i._addItems(i.collection.slice(c),c)}i.typeAhead&&i.highlight(i,i.wkspName)}var d=i.$("#moreSearchWksp");o&&o.actions&&o.actions.next&&o.actions.next.href?d.css("display","block"):d.css("display","none")},"_addItems":function(e,i){var s,o=this;t.each(e,function(e,t){s=o.getChildView(e),o._addChild(e,s,i+t)})},"_addChild":function(){return s.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"highlight":function(t,i){if(i){var s=RegExp(i,"gi"),o="<u style='font-weight: bold'>$&</u>";t.$("div.listItemWkspName").each(function(){e(this).html(e(this).html().replace(s,o))})}},"renderError":function(e,i){a.stopGlobalSpinner();var s=this,o=e.get("error");o||(o="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),s.renderMessage(t.str.sformat(r.error_retrieve_search,o))},"renderMessage":function(e){var t=this;e?(t.ui.srchResultMessage.text(e),t.ui.srchResultMessage.css("display","block"),t.ui.srchResultList.css("display","none")):(t.ui.srchResultMessage.css("display","none"),t.ui.srchResultList.css("display","block"))}});return c}),csui.define("conws/widgets/outlook/impl/searchwksps/simplesearch.view",["csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/lib/jquery","csui/widgets/search.custom/search.custom.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang"],function(e,t,i,s,o,n){var a=o.extend({"constructor":function(e){e||(e={}),o.prototype.constructor.call(this,e),this.context=e.context,this.options=e,this.options.parentView=this,this.contentViewOptions=this.options,n.startGlobalSpinner()},"initialize":function(){e.bindAll(this,"render","afterRender");var t=this;this.render=e.wrap(this.render,function(e){return e(),t.afterRender(),t})},"afterRender":function(){this.verifyForm()},"verifyForm":function(){setTimeout(function e(){var t=s(".customsearch-attr-container");if(0===t.length)setTimeout(e,100);else{n.stopGlobalSpinner();var i=n.SearchFormBottomPadding+n.TraceAreaHeight+"px";s(".tile-content").css("height","calc(100vh - "+i+")")}},20)}});return a}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/wksptype",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<option value="'+this.escapeExpression((i=null!=(i=t.value||(null!=e?e.value:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"value","hash":{}}):i))+'">'+this.escapeExpression((i=null!=(i=t.name||(null!=e?e.name:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"name","hash":{}}):i))+"</option>"}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_wksptype",s),s}),csui.define("conws/widgets/outlook/impl/searchwksps/wksptypes.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!conws/widgets/outlook/impl/searchwksps/impl/wksptype"],function(e,t,i,s,o){var n=s.LayoutView.extend({"tagName":"option","template":o,"templateHelpers":function(){return{"value":this.id,"name":this.name}},"initialize":function(e){var t=e.model.get("results");this.collection=new i.Collection(t)},"constructor":function(e){this.model=e.model,this.name=e.model.get("data").properties.wksp_type_name,this.id=e.model.get("data").properties.wksp_type_id,s.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){this.$el=this.$el.children(),this.$el.unwrap(),this.setElement(this.$el)}});return n}),csui.define("conws/widgets/outlook/impl/searchwksps/impl/simplesearchresult.model",["csui/lib/backbone","csui/utils/url","conws/widgets/outlook/impl/utils/utility"],function(e,t,i){var s=e.Model.extend({"defaults":{"name":"Unnamed"},"constructor":function(t,i){e.Model.prototype.constructor.apply(this,arguments),i&&i.context.connector&&(i.context.connector.assignTo(this),this.pageSize=i.pageSize,this.pageNo=i.pageNo,this.nextPageUrl="",this.query=i.query)},"url":function(){var e=i.v1ToV2(this.connector.connection.url),s=this.query.toJSON(),o="",n="";if(this.nextPageUrl){this.pageNo++;var a=/cache_id=\d+/g,r=a.exec(this.nextPageUrl);o=r.length>0?r[0]:""}return n="page="+this.pageNo+"&limit="+this.pageSize,s=t.combineQueryString(s,n,o),t.combine(e,"search?"+s)}});return s}),csui.define("conws/widgets/outlook/impl/searchwksps/simplesearchresult.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/search.results.factory","conws/widgets/outlook/impl/searchwksps/impl/simplesearchresult.model","conws/widgets/outlook/impl/wksp/wksp.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/searchresult","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c,d){var p=i.CompositeView.extend({"className":"wksp-srch-results","template":d,"childView":r,"childViewContainer":"#searchresult-list","templateHelpers":function(){return{"showMoreLink":c.showMore_link,"showMoreWkspTitle":c.showMore_wksp}},"ui":{"srchResultMessage":"#searchResultMsgArea","srchResultList":"#searchresult-list"},"events":{"click #moreSearchWksp":"retrieveNextPage"},"constructor":function(e){this.enableEmailSaving=e.enableEmailSaving,this.pageNo=e.pageNo,this.pageSize=e.pageSize,this.context=e.context,e.query||(e.query=this.context.getModel(o)),e.model=new a({},e),this.model=e.model,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError),this.model.fetch()},"retrieveNextPage":function(){var e=this.model.get("collection"),t=null==e.paging?null:e.paging;t&&t.links&&t.links.next&&t.links.next.href&&(l.startGlobalSpinner(),this.model.nextPageUrl=t.links.next.href,this.model.fetch())},"renderWksps":function(e){l.stopGlobalSpinner();var i=this,o=e.get("collection"),n=null==o.paging?null:o.paging,a=null==n||null==n.actions||n.actions.previous,r=e.get("results");if(t.each(r,function(e){e.enableEmailSaving=i.enableEmailSaving}),0===r.length&&a)1===i.pageNo&&i.renderMessage(c.noWksp_search);else if(null==i.collection)i.collection=new s.Collection(r),i.render();else{var d=i.collection.length;i.collection.add(new s.Collection(r).toJSON()),i._addItems(i.collection.slice(d),d)}var p=i.$("#moreSearchWksp");n&&n.links&&n.links.next&&n.links.next.href?p.css("display","block"):p.css("display","none")},"_addItems":function(e,i){var s,o=this;t.each(e,function(e,t){s=o.getChildView(e),o._addChild(e,s,i+t)})},"_addChild":function(){return s.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"renderError":function(e,i){l.stopGlobalSpinner();var s=this,o=e.get("error");o||(o="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),s.renderMessage(t.str.sformat(c.error_retrieve_search,o))},"renderMessage":function(e){var t=this;e?(t.ui.srchResultMessage.text(e),t.ui.srchResultMessage.css("display","block"),t.ui.srchResultList.css("display","none")):(t.ui.srchResultMessage.css("display","none"),t.ui.srchResultList.css("display","block"))}});return p}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/searchwksps",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="binf-panel-heading outlook-heading" >'+this.escapeExpression((i=null!=(i=t.sectionTitle||(null!=e?e.sectionTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"sectionTitle","hash":{}}):i))+' \r\n    <!--<img src="'+this.escapeExpression((i=null!=(i=t.serverOrigin||(null!=e?e.serverOrigin:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"serverOrigin","hash":{}}):i))+"/"+this.escapeExpression((i=null!=(i=t.supportFolder||(null!=e?e.supportFolder:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"supportFolder","hash":{}}):i))+'/csui/themes/carbonfiber/image/icons/help_mo.svg" class="wkspHelpIcon" title="'+this.escapeExpression((i=null!=(i=t.helpTooltip||(null!=e?e.helpTooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"helpTooltip","hash":{}}):i))+'" />-->\r\n</div>\r\n<div class="wkspSearch">\r\n    <div class="wkspSearchInputName">\r\n        <table class="wkspNameBox">\r\n            <tr>\r\n                <td class="wkspInputWithClear">\r\n                    <input class="wkspInput wkspSearchInput wkspSearchName" id="wkspName" type="search" aria-label="'+this.escapeExpression((i=null!=(i=t.wkspNamePlaceholder||(null!=e?e.wkspNamePlaceholder:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"wkspNamePlaceholder","hash":{}}):i))+'" placeholder="'+this.escapeExpression((i=null!=(i=t.wkspNamePlaceholder||(null!=e?e.wkspNamePlaceholder:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"wkspNamePlaceholder","hash":{}}):i))+'" />\r\n                    <span class="searchClear wkspIcon" id="searchClearButton" title="'+this.escapeExpression((i=null!=(i=t.searchClearTooltip||(null!=e?e.searchClearTooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"searchClearTooltip","hash":{}}):i))+'" tabindex="0"></span>\r\n                </td>\r\n                <td class="wkspSearchButton">\r\n                    <span id="wkspTypeButton" class="wkspIcon searchTypeIcon" title="'+this.escapeExpression((i=null!=(i=t.selectWkspType||(null!=e?e.selectWkspType:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"selectWkspType","hash":{}}):i))+'" tabindex="0"></span>\r\n                    <table class="wkspTypeDropdownTable"><tr>\r\n                        <td>\r\n                            <div id="typeDropdown" class="wkspTypeDropdown saveDisplayArea hiddenArea"></div>\r\n                        </td>\r\n                    </tr></table>\r\n                </td>\r\n                <td class="wkspSearchButton">\r\n                    <span id="searchButton" class="wkspIcon searchIcon" title="'+this.escapeExpression((i=null!=(i=t.searchTooltip||(null!=e?e.searchTooltip:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"searchTooltip","hash":{}}):i))+'" tabindex="0"></span>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="3">\r\n                    <div id="wkspTypeMsg" class="wkspTypeMsg hiddenArea"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n<div class="binf-panel-heading outlook-heading hiddenArea" id="searchResultHeading">\r\n    <span class="headerIcon backwardIcon" tabindex="0" id="searchResultBackButton"></span>\r\n    <span >'+this.escapeExpression((i=null!=(i=t.resultTitle||(null!=e?e.resultTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"resultTitle","hash":{}}):i))+'</span>\r\n</div> \r\n<div id="search-result"></div>\r\n\r\n<div class="wkspMessageArea" id="searchMsgArea"></div>\r\n\r\n\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_searchwksps",s),s}),csui.define("conws/widgets/outlook/impl/searchwksps/searchwksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/widgets/search.custom/search.custom.view","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/next.node","conws/widgets/outlook/impl/searchwksps/impl/searchwksps.model.factory","conws/widgets/outlook/impl/searchwksps/searchresult.view","conws/widgets/outlook/impl/searchwksps/simplesearch.view","conws/widgets/outlook/impl/searchwksps/wksptypes.view","conws/widgets/outlook/impl/searchwksps/simplesearchresult.view","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/searchwksps","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f){window.wkspTypeSelected=function(t,i){e("#typeDropdown").addClass("hiddenArea"),-100===t?(e("#wkspTypeMsg").addClass("hiddenArea"),e("#wkspTypeMsg").removeClass("wkspTypeMsgDisplay"),e("#wkspTypeMsg").html("")):(e("#wkspTypeMsg").removeClass("hiddenArea"),e("#wkspTypeMsg").addClass("wkspTypeMsgDisplay"),e("#wkspTypeMsg").html(g.search_selected_wksp_type+": <span style='font-weight: bold' title='"+i+"'>"+i+"</span>")),h.SelectedWkspTypeId=t,h.WkspSearchPerformed&&e("#searchButton").click()};var w=i.CompositeView.extend({"className":"searchWksps-conwsoutlook panel panel-default","template":f,"ui":{"wkspNameBox":"#wkspName","searchButton":"#searchButton","searchClearButton":"#searchClearButton","searchFormDropdown":"#searchFormDropdown"},"events":{"click #searchButton":"searchWksps","keyup #wkspName":"searchWkspsTyping","click #searchClearButton":"clearSearch","click #searchResultBackButton":"clearSearch","click #wkspTypeButton":"openWkspTypeSelection","keyup":"processKey","focusin #searchButton":"searchButtonFocused"},"templateHelpers":function(){return{"serverOrigin":window.ServerOrigin,"supportFolder":window.ContentServerSupportPath,"sectionTitle":g.sectionTitle_search,"helpTooltip":g.help_button_tooltip,"searchTooltip":g.search_button_tooltip,"searchClearTooltip":g.search_clear_button_tooltip,"wkspNamePlaceholder":g.search_wkspName_placeholder,"selectWkspType":g.search_select_wksp_type,"resultTitle":g.search_result_title}},"initialize":function(){},"constructor":function(e){e.model=e.context.getModel(l),this.pageSize=e.pageSize?e.pageSize:h.pageSize,this.enableEmailSaving=e.enableEmailSaving,this.showSearchForm=e.showSearchFormSelection?e.showSearchFormSelection:!1,this.previousFormId=-1,this.context=e.context,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderSearchForm),this.listenTo(this.model,"error",this.renderError)},"renderMessage":function(e){var t=this,i=t.$("#searchMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"renderSearchForm":function(e){var i=this,s=e.get("results");i.render();for(var o="",n="<a href=\"javascript:wkspTypeSelected({0},'{1}');\" title='{1}' style='width:80vw; white-space:nowrap; overflow-x:hidden; text-overflow:ellipsis; display:flow-root list-item;'><div style='display:inline'>{1}</div></a>",a=0;a<s.length;a++){var r=s[a],l=r.data.properties.wksp_type_name,c=r.data.properties.wksp_type_id;o+=t.str.sformat(n,c,l)}i.$("#typeDropdown").html(o)},"renderError":function(e,t){var i=this,s=e.get("error");s||(s="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),i.renderMessage(s)},"processKey":function(e){(13===e.which||32===e.which)&&("wkspTypeButton"===e.target.id?this.openWkspTypeSelection(e):"searchButton"===e.target.id?this.searchWksps(e):("searchClearButton"===e.target.id||"searchResultBackButton"===e.target.id)&&this.clearSearch(e))},"searchButtonFocused":function(){e("#typeDropdown").addClass("hiddenArea")},"searchWksps":function(e){var t=this,s=t.$("#wkspName").val(),o=h.SelectedWkspTypeId,n=t.$("#searchClearButton"),a="";h.uiShow("searchResultHeading"),h.uiHide("nonSearchSections"),n.css("display","block");var r=new i.Region({"el":"#search-result"});if(-100===o&&""===s)a=g.search_noCondition,r.$el.hide();else{a="",r.$el.show();var l="wkspName"===e.target.id,d=new c({"connector":this.model.connector,"wkspTypeId":o,"wkspName":s,"typeAhead":l,"pageSize":this.pageSize,"pageNo":1,"enableEmailSaving":this.enableEmailSaving});h.WkspSearchPerformed=!0,r.show(d),h.startGlobalSpinner()}this.renderMessage(a)},"clearSearch":function(){var t=this,s=t.$("#wkspName"),o=t.$("#searchClearButton"),n=new i.Region({"el":"#search-result"});s.val(""),o.css("display","none"),n.$el.hide(),h.uiHide("searchResultHeading"),h.uiShow("nonSearchSections"),h.SelectedWkspTypeId=-100,h.WkspSearchPerformed=!1,h.uiHide("wkspTypeMsg"),e("#wkspTypeMsg").removeClass("wkspTypeMsgDisplay"),e("#wkspTypeMsg").html(""),this.renderMessage(""),e("#conwsoutlook-body").focus()},"searchWkspsTyping":function(e){var t=this,i=t.$("#wkspName").val();i.length>=2&&this.searchWksps(e)},"openWkspTypeSelection":function(){e("#typeDropdown").toggleClass("hiddenArea")}});return w}),csui.define("hbs!conws/widgets/outlook/impl/suggestedwksps/impl/suggestedwksps",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div class="binf-panel-heading outlook-heading">\r\n    \r\n    <span class="headerIcon sectionToggleIcon" id="suggestedToggleIcon" tabindex="0"></span>\r\n    <span >'+this.escapeExpression((i=null!=(i=t.sectionTitle||(null!=e?e.sectionTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"sectionTitle","hash":{}}):i))+'</span> <span id="suggestedCount"></span>\r\n    \r\n    <span style="float: right">\r\n    <div id="suggestedWkspSpinner" class="load-container binf-hidden">\r\n        <div class="outer-border wksp-outer-border">\r\n            <div class="loader wksp-loader"></div>\r\n        </div>\r\n    </div>\r\n    </span>    \r\n</div>\r\n<div id="suggestedSection">\r\n    <div id="suggested-list"></div>\r\n    <div class="wkspMessageArea" id="suggestedWkspMsgArea"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_suggestedwksps_impl_suggestedwksps",s),s}),csui.define("conws/widgets/outlook/impl/suggestedwksps/suggestedwksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/wksp/wksp.view","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/suggestedwksps/impl/suggestedwksps","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l){var c=i.CompositeView.extend({"className":"suggestedWksps-conwsoutlook panel panel-default","template":a,"childView":o,"childViewContainer":"#suggested-list","templateHelpers":function(){return{"sectionTitle":n.sectionTitle_suggested}},"events":{"click #suggestedToggleIcon":"toggleIconClicked","keyup":"processKey"},"constructor":function(e){var t=this;if(i.CompositeView.prototype.constructor.call(this,e),t.error=e.error,t.config=e.config,t.connector=e.context.connector,setTimeout(function(){r.startLocalSpinner("suggestedWkspSpinner"),t.renderMessage(t,n.info_retrieving)}),e.error)setTimeout(function(){r.stopLocalSpinner("suggestedWkspSpinner"),t.renderError(e.error)});else{var s=l.getSuggestedWksps(e.context.connector,window.CurrentEmailItem,e.config);s.done(function(e){t.renderWksps(e)}),s.fail(function(e){t.renderError(e)})}},"renderWksps":function(i){r.stopLocalSpinner("suggestedWkspSpinner");var o=this;o.collection=new s.Collection(i.results),o.render();var a="";if(0===o.collection.length&&(a=n.noWksp_suggested,e("#suggestedToggleIcon").click()),e("#suggestedCount").html("("+o.collection.length+")"),null!=i.errors&&i.errors.length>0){var l=i.errors.join("<br/>");l=t.str.sformat(n.error_retrieve_suggested,l),a=""===a?l:a+"<br/>"+l}""!==a&&o.renderMessage(o,a)},"refresh":function(){var e=this;if(!e.error){r.writeTrace("The suggested workspaces is being refreshed...."),setTimeout(function(){r.startLocalSpinner("suggestedWkspSpinner"),e.renderMessage(e,n.info_retrieving)});var t=l.getSuggestedWksps(e.connector,window.CurrentEmailItem,e.config);t.done(function(t){e.renderWksps(t)}),t.fail(function(t){e.renderError(t)})}},"renderError":function(e){r.stopLocalSpinner("suggestedWkspSpinner");var i=this,s=null!=e.responseJSON?e.responseJSON.error:e;i.renderMessage(i,t.str.sformat(n.error_retrieve_suggested,s))},"renderMessage":function(e,t){var i=e.$("#suggestedWkspMsgArea");t?(i.css("display","block"),i.html(t)):i.css("display","none")},"processKey":function(e){(13===e.which||32===e.which)&&"suggestedToggleIcon"===e.target.id&&this.toggleIconClicked(e)},"toggleIconClicked":function(){r.collapsibleClicked("suggested")}});return c}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/customsearch",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'\r\n<div id="customSearchFormArea">\r\n    <div class="binf-panel-heading outlook-heading" >\r\n        <span class="headerIcon backwardIcon" tabindex="0" id="customSearchBack"></span>\r\n        <span >'+this.escapeExpression((i=null!=(i=t.sectionTitle||(null!=e?e.sectionTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"sectionTitle","hash":{}}):i))+'</span>\r\n    </div>    \r\n    <div class="wkspSearch">\r\n\r\n        <div class="wkspSearchForm" id="searchFormListDiv">\r\n            <label class="searchFormLabel" for="searchFormDW">'+this.escapeExpression((i=null!=(i=t.selectSearchForm||(null!=e?e.selectSearchForm:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"selectSearchForm","hash":{}}):i))+'</label>\r\n            <select class="wkspInput wkspSearchInput wkspSearchSelect" id="searchFormDW" onmousedown="document.getElementById(\'searchFormDW\').focus();"></select>\r\n        </div>\r\n\r\n        <div id="searchFormDiv"></div>\r\n    </div>\r\n    <div class="wkspMessageArea" id="searchMsgArea"></div>\r\n</div>\r\n\r\n<div id="customSearchResultArea" class="hiddenArea">\r\n    <div class="binf-panel-heading outlook-heading" >\r\n        <span class="headerIcon backwardIcon" tabindex="0" id="customSearchResultBack"></span>\r\n        <span >'+this.escapeExpression((i=null!=(i=t.resultTitle||(null!=e?e.resultTitle:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"resultTitle","hash":{}}):i))+'</span>\r\n    </div>    \r\n    <div id="customSearchResult"></div>\r\n</div>\r\n\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_customsearch",s),s}),csui.define("conws/widgets/outlook/impl/searchwksps/customSearchSection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/widgets/search.custom/search.custom.view","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/next.node","conws/widgets/outlook/impl/searchwksps/impl/searchwksps.model.factory","conws/widgets/outlook/impl/searchwksps/searchresult.view","conws/widgets/outlook/impl/searchwksps/simplesearch.view","conws/widgets/outlook/impl/searchwksps/wksptypes.view","conws/widgets/outlook/impl/searchwksps/simplesearchresult.view","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/customsearch","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f){var w=i.CompositeView.extend({"className":"searchWksps-conwsoutlook panel panel-default","template":f,"ui":{"searchFormDW":"#searchFormDW"},"events":{"change #searchFormDW":"searchFormChange","click #customSearchResultBack":"backToSearchForm","click #customSearchBack":"backToStandard","keyup #customSearchBack, #customSearchResultBack":"processKey"},"templateHelpers":function(){return{"serverOrigin":window.ServerOrigin,"supportFolder":window.ContentServerSupportPath,"sectionTitle":g.sectionTitle_customSearch,"selectSearchForm":g.search_select_form,"resultTitle":g.search_result_title}},"initialize":function(){},"constructor":function(e){this.pageSize=e.pageSize?e.pageSize:h.pageSize,this.enableEmailSaving=e.enableEmailSaving,this.showSearchForm=e.showSearchFormSelection?e.showSearchFormSelection:!1,this.previousFormId=-1,this.queries=e.queries,this.context=e.context,i.CompositeView.prototype.constructor.call(this,e);var t=this;setTimeout(function(){t.renderSearchForm()})},"renderMessage":function(e){var t=this,i=t.$("#searchMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"renderSearchForm":function(){var e=this;if(e.render(),null!=e.queries&&0!==e.queries.length){e.$("#searchFormListDiv").css("display","block");for(var s="<option value='{0}'>{1}</option>",n="",a=0;a<e.queries.length;a++){var r=e.queries[a];n+=t.str.sformat(s,r[1],r[0])}e.$("#searchFormDW").html(n);var l=new o({"factories":{"connector":e.options.context.connector}});l.connector=e.options.context.connector;var c=new i.Region({"el":"#searchFormDiv"});h.writeTrace("Showing custom search view for ID: ."+e.queries[0][1]);var p=new d({"context":l,"savedSearchQueryId":e.queries[0][1]});c.show(p),e.refreshQueryModel(l),l.fetch()}},"renderError":function(e,t){var i=this,s=e.get("error");s||(s="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),i.renderMessage(s)},"processKey":function(e){(13===e.which||32===e.which)&&("customSearchBack"===e.target.id?this.backToStandard(e):"customSearchResultBack"===e.target.id&&this.backToSearchForm(e))},"searchFormChange":function(){var t=this,s=t.$("#searchFormDW").val();this.renderMessage("");var n=new i.Region({"el":"#customSearchResult"});n.$el.empty();var a=e("#csui-custom-search-form-submit").hasClass("csui-search-form-submit-disabled");if("-1"===s)t.$("#searchFormWkspTypeName").css("display","block"),t.$("#searchFormDiv").css("display","none");else if(t.$("#searchFormWkspTypeName").css("display","none"),t.$("#searchFormDiv").css("display","block"),a||t.previousFormId!==s){h.startGlobalSpinner(),t.previousFormId=s;var r=new o({"factories":{"connector":t.options.context.connector}});r.connector=t.options.context.connector;var l=new i.Region({"el":"#searchFormDiv"});h.writeTrace("Showing custom search view for ID: ."+s);var c=new d({"context":r,"savedSearchQueryId":s});l.show(c),t.refreshQueryModel(r),r.fetch()}},"refreshQueryModel":function(e){var t=this,s=e.getModel(a);history.pushState=function(){},s.on("change",Function.createDelegate(this,function(){var s=new i.Region({"el":"#customSearchResult"}),o=new u({"context":e,"pageSize":t.pageSize,"pageNo":1,"enableEmailSaving":t.enableEmailSaving});h.startGlobalSpinner(),h.uiHide("customSearchFormArea"),h.uiShow("customSearchResultArea"),s.show(o)})),e.fetch()},"backToSearchForm":function(){h.uiShow("customSearchFormArea"),h.uiHide("customSearchResultArea"),e("#conwsoutlook-body").focus()},"backToStandard":function(){h.uiShow("standardSections"),h.uiShow("customSearchButton"),h.uiHide("customSearchSection"),h.PreSaveSection="standardSections",e("#conwsoutlook-body").focus()}});return w}),csui.define("hbs!conws/widgets/outlook/impl/conwsoutlook",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t){var i;return'<div class="outlook-container" >\r\n\r\n    <div class="mainPageContent" id="standardSections">\r\n        <div class="outlook-col" id="searchRegion" ></div>\r\n        <div id="nonSearchSections">\r\n            <div class="outlook-col" id="suggestedRegion" ></div>\r\n            <div class="outlook-col" id="favoriteRegion" ></div>\r\n            <div class="outlook-col" id="recentRegion" ></div>\r\n        </div>\r\n    </div>  \r\n\r\n    <div id="customSearchSection" class="hiddenArea"></div>\r\n    <div id="savePanel" class="hiddenArea"></div>\r\n\r\n    <div class="customSearchButton outlook-heading binf-panel-heading hiddenArea" id="customSearchButton">\r\n        <span class="headerIcon forwardIcon" id="customerSearchButtonIcon" tabindex="0"></span>\r\n        <span >'+this.escapeExpression((i=null!=(i=t.customSearchLabel||(null!=e?e.customSearchLabel:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{"name":"customSearchLabel","hash":{}}):i))+'</span>\r\n    </div>\r\n    \r\n    <div id="dialogRegion"></div>\r\n\r\n</div>\r\n'
}});return i.registerPartial("conws_widgets_outlook_impl_conwsoutlook",s),s}),csui.define("conws/widgets/outlook/conwsoutlook.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/utils/authenticators/request.authenticator","csui/utils/url","csui/utils/nodesprites","conws/utils/icons/icons","conws/widgets/outlook/impl/recentwksps/recentwksps.view","conws/widgets/outlook/impl/favoritewksps/favoritewksps.view","conws/widgets/outlook/impl/searchwksps/searchwksps.view","conws/widgets/outlook/impl/suggestedwksps/suggestedwksps.view","conws/widgets/outlook/impl/searchwksps/customSearchSection.view","conws/widgets/outlook/impl/dialog/authenticator","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","conws/widgets/outlook/impl/metadata/metadata.forms.view","csui/utils/contexts/factories/node","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/conwsoutlook","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,s,o,n,a,r,l,c,d,p,u,h,m,g,f,w,v,b,y,k){var x=i.LayoutView.extend({"className":"conwsoutlook ","template":k,"regions":{"searchRegion":"#searchRegion","favoriteRegion":"#favoriteRegion","recentRegion":"#recentRegion","suggestedRegion":"#suggestedRegion","customSearchRegion":"#customSearchSection","customViewSearchResultRegion":"#customViewSearchResultRegion","dialogRegion":"#dialogRegion"},"templateHelpers":function(){return{"customSearchLabel":y.search_custom_button_label}},"events":{"click #customSearchButton":"showCustomSearch","keyup":"processKey"},"initialize":function(){this.context=this.options.context;var t={"authenticator":new a({})};this.connector=this.context.getObject(n,t),f.setConnector(this.connector);var i=this,s=new r(this.connector.connection.url);this.connector.timeoutProcessed=!1,this.connector.authenticator.on("loggedOut",function(){if(f.stopGlobalSpinner(),!i.connector.timeoutProcessed){f.writeTrace("Session logged out."),f.disableSimpleSearch(),i.connector.timeoutProcessed=!0;var e=new g({"context":i.context,"centerVertically":!0});e.authenticate().done(function(){e.beingAuthenticated=!1})}}),window.ServerOrigin=s.getOrigin(),window.ServerCgiScript=s.getCgiScript(),l.add(c);var o=e.when;e.whenAll=function(t){if(e.isArray(t)){var i=new e.Deferred;return o.apply(e,t).done(function(){i.resolve(Array.prototype.slice.call(arguments))}).fail(function(){i.reject(Array.prototype.slice.call(arguments))}),i.promise()}return o.apply(e,arguments)}},"onBeforeShow":function(){var t=this,i=new g({"context":t.context,"centerVertically":!0});f.startGlobalSpinner(),i.authenticate().done(function(s){if(f.stopGlobalSpinner(),i.beingAuthenticated=!1,s){t.context.connector=f.getConnector();var o=w.getAddinConfig(t.context.connector);o.done(function(i){f.setConfig(i,t.context.csUser),t.getRegion("recentRegion").show(new d({"context":t.context})),t.getRegion("favoriteRegion").show(new p({"context":t.context})),t.getRegion("searchRegion").show(new u({"context":t.context,"enableEmailSaving":!0,"showSearchFormSelection":f.ShowSearchFormSelection}));var s=w.getSuggestedWkspConfig(t.context.connector);if(s.done(function(e){null==e||null==e.general?(f.SuggestedWkspsView=new h({"error":"NoConfiguration"}),t.getRegion("suggestedRegion").show(f.SuggestedWkspsView)):e.general.showSection?(f.SuggestedWkspsView=new h({"context":t.context,"config":e}),t.getRegion("suggestedRegion").show(f.SuggestedWkspsView)):t.getRegion("suggestedRegion").$el.css("display","none")}),s.fail(function(e){f.SuggestedWkspsView=new h({"error":e}),t.getRegion("suggestedRegion").show(f.SuggestedWkspsView)}),i.searchForm.enabled){var o=w.getSimpleSearchQueries(t.context.connector);o.done(function(i){if(null!=i&&0!==i.length){f.uiShow("customSearchButton");var s="calc(100vh - "+(f.SearchButtonHeight+f.TraceAreaHeight)+"px)";if(e("#customSearchButton").css("top",s),t.getRegion("customSearchRegion").show(new m({"context":t.context,"queries":i})),f.TraceAreaHeight>0){var o=document.querySelectorAll('iframe[id^="log4javascript_"]');if(o.length>0){var n=o[0].contentWindow.hide;"function"==typeof n&&(o[0].contentWindow.hide=function(){e("#customSearchButton").css("top","calc(100vh - "+f.SearchButtonHeight+"px)"),e(".tile-content").css("height","calc(100vh - "+f.SearchFormBottomPadding+"px)"),e("#saveDisplayArea").css("height","calc(100vh - 32px"),f.TraceAreaHeight=0,n()})}}}}),o.fail(function(t){e("#topMessage").html(f.getErrorMessage(t))})}t.context.fetch()}),o.fail(function(t){e("#topMessage").html(t)})}}),e("#conwsoutlook-body").focus()},"constructor":function(e){i.LayoutView.prototype.constructor.call(this,e)},"processKey":function(e){(13===e.which||32===e.which)&&"customerSearchButtonIcon"===e.target.id&&this.showCustomSearch(e)},"showCustomSearch":function(){f.uiHide("standardSections"),f.uiHide("customSearchButton"),f.uiShow("customSearchSection"),f.PreSaveSection="customSearchSection",e("#conwsoutlook-body").focus()}});return x}),csui.define("conws/widgets/configurationvolume/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/configurationvolume/impl/nls/root/lang",{"emptyResultsText":"There are no items to display."}),csui.define("css!conws/widgets/configurationvolume/impl/configurationvolume",[],function(){}),csui.define("conws/widgets/configurationvolume/configurationvolume.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/widgets/shortcuts/shortcuts.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/models/configurationvolume/configurationvolume.factory","i18n!conws/widgets/configurationvolume/impl/nls/lang","css!conws/widgets/configurationvolume/impl/configurationvolume"],function(e,t,i,s,o,n,a,r,l){var c=s.View.extend({"className":"conws-empty-configurevolume-container","onShow":function(){this.$el.text(l.emptyResultsText)}}),d=["shade1","shade2","shade3","shade4"],p=o.extend({"className":"conws-volumeshortcut-container csui-shortcut-container tile","attributes":{"role":"menu"},"constructor":function(e){e||(e={}),e.data||(e.data={}),e.perspectiveMode=!1,e.model=e.context.getModel(r,{}),o.prototype.constructor.call(this,e)},"emptyView":c,"buildChildView":function(e,t,i){return t===c?s.CollectionView.prototype.buildChildView.call(this,e,t,i):o.prototype.buildChildView.apply(this,arguments)},"modelEvents":{"change":"modelChange"},"childEvents":e.extend(o.prototype.childEvents,{"render":"onChildViewRender"}),"onChildViewRender":function(e){e.$el.addClass("csui-configurationvolume-container")},"currentlyFocusedElement":function(){var e=this.children.findByIndex(this._currentShortcutIndex);return e&&e.$el},"modelChange":function(){this.collection.set(this.model.get("shortcutItems")),this._currentShortcutIndex=0},"_getShortcutTheme":function(e,t){var i=this.options.data.shortcutTheme?this.options.data.shortcutTheme:"csui-shortcut-theme-grey";if(t>1){var s=d.length;i+="-"+d[s-1-e%s]}return i},"behaviors":{"PerfectScrolling":{"behaviorClass":n,"suppressScrollX":!0,"scrollYMarginOffset":15},"TabableRegion":{"behaviorClass":a}}});return p}),csui.define("json!conws/widgets/relatedworkspaces/relatedworkspaces.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","properties":{"title":{"type":"object","title":"{{tileTitle}}","description":"{{tileDescription}}"},"workspaceTypeId":{"type":"integer","title":"{{workspacetypeTitle}}","description":"{{workspacetypeDescription}}"},"relationType":{"type":"string","enum":["child","parent"],"title":"{{relationTypeTitle}}","description":"{{relationTypeDescription}}"},"collapsedView":{"type":"object","title":"{{collapsedViewTitle}}","description":"{{collapsedViewDescription}}","properties":{"noResultsPlaceholder":{"type":"object","title":"{{noResultsPlaceholderTitle}}","description":"{{noResultsPlaceholderDescription}}"},"preview":{"type":"object","title":"{{previewPaneTitle}}","description":"{{previewPaneDescription}}","properties":{"typeName":{"type":"object","title":"{{previewTitle}}","description":"{{previewDescription}}"},"noMetadataMessage":{"type":"object","title":"{{noMetadataMessageTitle}}","description":"{{noMetadataMessageDescription}}"},"roleId":{"type":"string","title":"{{roleTitle}}","description":"{{roleDescription}}"},"noRoleMembersMessage":{"type":"object","title":"{{noRoleMembersMessageTitle}}","description":"{{noRoleMembersMessageDesc}}"},"metadata":{"type":"array","title":"{{metadataTitle}}","description":"{{metadataDescription}}","items":{"type":"object","title":"{{CategoryOrAttributeTitle}}","description":"{{CategoryOrAttributeDesc}}"}}}},"orderBy":{"type":"object","title":"{{orderTitle}}","description":"{{orderDescription}}","properties":{"sortColumn":{"type":"string","title":"{{sortColumnTitle}}","description":"{{sortColumnDescription}}"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"{{sortOrderTitle}}","description":"{{sortOrderDescription}}"}}},"title":{"type":"object","title":"{{relatedWorkspaceTitle}}","description":"{{relatedWorkspaceDesc}}","properties":{"value":{"type":"string","title":"{{valueTitle}}","description":"{{valueDescription}}"}}},"description":{"type":"object","title":"{{descriptionSectionTitle}}","description":"{{descriptionSectionDesc}}","properties":{"value":{"type":"string","title":"{{descriptionValueTitle}}","description":"{{descriptionFieldValue}}"}}},"topRight":{"type":"object","title":"{{topRightSectionTitle}}","description":"{{topRightSectionDescription}}","properties":{"label":{"type":"object","title":"{{topRightLabel}}","description":"{{topRightLabelDesc}}"},"value":{"type":"string","title":"{{topRightValue}}","description":"{{topRightValueDesc}}"}}},"bottomLeft":{"type":"object","title":"{{bottomLeftTitle}}","description":"{{bottomLeftTitleDesc}}","properties":{"label":{"type":"object","title":"{{bottomLeftLabelTitle}}","description":"{{bottomLeftLabelDesc}}"},"value":{"type":"string","title":"{{bottomLeftValue}}","description":"{{bottomLeftValueDesc}}"}}},"bottomRight":{"type":"object","title":"{{bottomRightTitle}}","description":"{{bottomRightTitleDesc}}","properties":{"label":{"type":"object","title":"{{bottomRightLabel}}","description":"{{bottomRightLabelDesc}}"},"value":{"type":"string","title":"{{bottomRightValue}}","description":"{{bottomRightValueDesc}}"}}}}},"expandedView":{"type":"object","title":"{{expandedViewSectionTitle}}","description":"{{expandedViewSectionDesc}}","properties":{"orderBy":{"type":"object","title":"{{expandedViewOrderByTitle}}","description":"{{expandedViewOrderByDesc}}","properties":{"sortColumn":{"type":"string","title":"{{expandedViewSortColumnTitle}}","description":"{{expandedViewSortColumnDesc}}"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"Sort order","description":"{{expandedViewSortOrderDesc}}"}}},"customColumns":{"type":"array","title":"{{customColumnsSectionTitle}}","description":"{{customColumnsSectionDesc}}","items":{"type":"object","title":"{{customColumnsItemsTitle}}","description":"{{customColumnsItemsDesc}}","properties":{"key":{"type":"string","title":"{{customColumnsPropertiesTitle}}","description":"{{customColumnsPropertiesDesc}}"}}}}}}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"},"workspaceTypeId":{"type":"otconws_workspacetype_id"},"relationType":{"type":"select","optionLabels":["Child","Parent"]},"collapsedView":{"fields":{"noResultsPlaceholder":{"type":"otcs_multilingual_string"},"preview":{"fields":{"typeName":{"type":"otcs_multilingual_string"},"noMetadataMessage":{"type":"otcs_multilingual_string"},"noRoleMembersMessage":{"type":"otcs_multilingual_string"},"metadata":{"fields":{"item":{"type":"otconws_metadata"}}}}},"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["Ascending","Descending"]}}},"title":{"fields":{"value":{"type":"otconws_customcolumn"}}},"description":{"fields":{"value":{"type":"otconws_customcolumn"}}},"topRight":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}},"bottomLeft":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}},"bottomRight":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}}}},"expandedView":{"fields":{"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["Ascending","Descending"]}}},"customColumns":{"items":{"fields":{"key":{"type":"otconws_customcolumn"}}}}}}}}}),csui.define("json!conws/widgets/header/header.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{tileTitle}}","description":"{{tileDescription}}","schema":{"type":"object","properties":{"workspace":{"type":"object","title":"{{workspaceTitle}}","description":"{{workspaceDescription}}","properties":{"properties":{"type":"object","title":"Properties","description":"{{workspacePropertiesDesc}}","properties":{"title":{"type":"string","title":"{{businessworkspaceTitle}}","default":"{name}","description":"{{businessworkspaceDesc}}"},"type":{"type":"string","title":"{{workspaceTypeTitle}}","default":"{business_properties.workspace_type_name}","description":"{{workspaceTypeDesc}}"},"description":{"type":"string","title":"{{descriptionSectionTitle}}","default":"{description}","description":"{{descriptionSection}}"}}}}},"widget":{"type":"object","title":"{{widgetTitle}}","description":"{{widgetDescription}}","properties":{"type":{"type":"string","enum":["none","activityfeed"],"title":"{{embedWidgetSectionTitle}}","description":"{{embedWidgetSectionDesc}}"}}}}},"options":{"fields":{"workspace":{"fields":{"properties":{"fields":{"title":{"type":"otconws_metadata_string"},"type":{"type":"otconws_metadata_string"},"description":{"type":"otconws_metadata_string"}}}}},"widget":{"fields":{"type":{"type":"select","optionLabels":["None","Activity Feed"]}}}}}}),csui.define("json!conws/widgets/team/team.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","properties":{"title":{"type":"object","title":"{{tileTitle}}","description":"{{tileDescription}}"}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"}}}}),csui.define("json!conws/widgets/myworkspaces/myworkspaces.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{tileTitle}}","description":"{{tileDescription}}","schema":{"type":"object","properties":{"title":{"type":"object","title":"{{titleSection}}","description":"{{titleDescription}}"},"workspaceTypeId":{"type":"integer","title":"Workspace type","description":"{{WorkspaceTypeDesc}}"},"collapsedView":{"type":"object","title":"{{collapsedViewTitle}}","description":"{{collapsedViewDesc}}","properties":{"noResultsPlaceholder":{"type":"object","title":"Message for empty result","description":"{{noResultsPlaceholderDesc}}"}}},"expandedView":{"type":"object","title":"{{expandedViewTitle}}","description":"{{expandedViewDesc}}","properties":{"orderBy":{"type":"object","title":"{{orderBySectionTitle}}","description":"{{orderBySectionDesc}}","properties":{"sortColumn":{"type":"string","title":"{{sortColumnSectionTitle}}","description":"{{sortColumnSectionDesc}}"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"{{sortOrderSectionTitle}}","description":"{{sortOrderSectionDesc}}"}}},"customColumns":{"type":"array","title":"{{customColumnsTitle}}","description":"{{customColumnsDesc}}","items":{"type":"object","title":"{{itemsSectionTitle}}","description":"{{itemsSectionDesc}}","properties":{"key":{"type":"string","title":"{{keyTitle}}","description":"{{keyDescription}}"}}}}}}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"},"workspaceTypeId":{"type":"otconws_workspacetype_id"},"collapsedView":{"fields":{"noResultsPlaceholder":{"type":"otcs_multilingual_string"}}},"expandedView":{"fields":{"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["Ascending","Descending"]}}},"customColumns":{"items":{"fields":{"key":{"type":"otconws_customcolumn"}}}}}}}}}),csui.define("json!conws/widgets/metadata/metadata.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","properties":{"title":{"type":"object","title":"{{tileTitle}}","description":"{{tiledescription}}"},"hideEmptyFields":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"{{hideEmptyFieldsTitle}}","description":"{{hideEmptyFieldsDescription}}"},"metadata":{"type":"array","title":"{{metadataSectionTitle}}","description":"{{metadataSectionDescription}}","items":{"type":"object","title":"{{categoryOrAttributeTitle}}","description":"{{categoryOrAttributeDescription}}"}}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"},"metadata":{"fields":{"item":{"type":"otconws_metadata"}}}}}}),csui.define("json!conws/widgets/configurationvolume/configurationvolume.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","kind":"tile","schema":{"type":"object","properties":{"shortcutTheme":{"title":"{{shortcutThemeTitle}}","description":"{{shortcutThemeDescription}}","type":"string","enum":["csui-shortcut-theme-stone1","csui-shortcut-theme-stone2","csui-shortcut-theme-teal1","csui-shortcut-theme-teal2","csui-shortcut-theme-pink1","csui-shortcut-theme-pink2","csui-shortcut-theme-indigo1","csui-shortcut-theme-indigo2"]}}},"options":{"fields":{"shortcutTheme":{"type":"select","optionLabels":["{{shortcutThemeStone1}}","{{shortcutThemeStone2}}","{{shortcutThemeTeal1}}","{{shortcutThemeTeal2}}","{{shortcutThemePink1}}","{{shortcutThemePink2}}","{{shortcutThemeIndigo1}}","{{shortcutThemeIndigo2}}"]}}}}),csui.define("conws/widgets/configurationvolume/impl/nls/configurationvolume.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/configurationvolume/impl/nls/root/configurationvolume.manifest",{"widgetTitle":"Configuration Volume","widgetDescription":"Tile representing hyperlinks to volumes; it navigates to its page when clicked","shortcutThemeTitle":"Theme","shortcutThemeDescription":"Styling of the volumes","shortcutThemeStone1":"Stone Group 1","shortcutThemeStone2":"Stone Group 2","shortcutThemeTeal1":"Teal Group 1","shortcutThemeTeal2":"Teal Group 2","shortcutThemePink1":"Pink Group 1","shortcutThemePink2":"Pink Group 2","shortcutThemeIndigo1":"Indigo Group 1","shortcutThemeIndigo2":"Indigo Group 2"}),csui.define("conws/widgets/team/impl/nls/team.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/team/impl/nls/root/team.manifest",{"tileTitle":"Title","tileDescription":"Title in collapsed view","widgetTitle":"Team","widgetDescription":"Shows the team members of a business workspace"}),csui.define("conws/widgets/metadata/impl/nls/metadata.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/metadata/impl/nls/root/metadata.manifest",{"tileTitle":"Title","tiledescription":"Title of the Metadata widget","widgetTitle":"Metadata","widgetDescription":"Shows metadata for a business workspace","hideEmptyFieldsTitle":"Hide empty fields","hideEmptyFieldsDescription":"Display only fields with values","metadataSectionTitle":"Metadata","metadataSectionDescription":"Metadata displayed in Metadata widget","categoryOrAttributeTitle":"Category or attribute","categoryOrAttributeDescription":"Category or attribute with metadata"}),csui.define("conws/widgets/relatedworkspaces/impl/nls/relatedworkspaces.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/relatedworkspaces/impl/nls/root/relatedworkspaces.manifest",{"widgetTitle":"Related Workspaces","widgetDescription":"Shows the related business workspaces for a business workspace","tileTitle":"Title","tileDescription":"Title of the Related Workspaces widget","workspacetypeTitle":"Workspace type","workspacetypeDescription":"Workspace type displayed in this widget","relationTypeTitle":"Relation type","relationTypeDescription":"Relation type of the related workspaces","collapsedViewTitle":"Collapsed view","collapsedViewDescription":"Options for the collapsed view of this widget","noResultsPlaceholderTitle":"Message for empty result","noResultsPlaceholderDescription":"Message if there are no related business workspaces to display","previewPaneTitle":"Preview pane","previewPaneDescription":"Options for the preview pane","previewTitle":"Preview title","previewDescription":"Title of the preview pane","noMetadataMessageTitle":"Message for empty metadata","noMetadataMessageDescription":"Message if there is no metadata to display","roleTitle":"Name of role","roleDescription":"The members of the specified role are displayed in the preview","noRoleMembersMessageTitle":"Message for empty role","noRoleMembersMessageDesc":"Message if there are no role members assigned to the specified role","metadataTitle":"Metadata in preview pane","metadataDescription":"Metadata displayed in preview pane","CategoryOrAttributeTitle":"Category or attribute","CategoryOrAttributeDesc":"Category or attribute with metadata","orderTitle":"Order by","orderDescription":"Sort order of the displayed business workspaces","sortColumnTitle":"Column","sortColumnDescription":"Column to order by","sortOrderTitle":"Sort order","sortOrderDescription":"Sort order to be used","relatedWorkspaceTitle":"Related workspace title","relatedWorkspaceDesc":"Title of the related workspace in collapsed view","valueTitle":"Title","valueDescription":"Value for the Title field","descriptionSectionTitle":"Related workspace description","descriptionSectionDesc":"Description of the related workspace in collapsed view","descriptionValueTitle":"Description","descriptionFieldValue":"Value for the description field","topRightSectionTitle":"Top right metadata field","topRightSectionDescription":"Metadata displayed in top right  metadata field in collapsed view","topRightLabel":"Label","topRightLabelDesc":"Label for the metadata field","topRightValue":"Value","topRightValueDesc":"Value for the top right metadata field","bottomLeftTitle":"Bottom left  metadata field","bottomLeftTitleDesc":"Metadata displayed in bottom left  metadata field in collapsed view","bottomLeftLabelTitle":"Label","bottomLeftLabelDesc":"Label for the metadata field","bottomLeftValue":"Value","bottomLeftValueDesc":"Value for the bottom left metadata  metadata field","bottomRightTitle":"Bottom right  metadata field","bottomRightTitleDesc":"Metadata displayed in bottom right  metadata field in collapsed view","bottomRightLabel":"Label","bottomRightLabelDesc":"Label for the metadata field","bottomRightValue":"Value","bottomRightValueDesc":"Value for the bottom right metadata  metadata field","expandedViewSectionTitle":"Expanded view","expandedViewSectionDesc":"Options for the expanded view of this widget","expandedViewOrderByTitle":"Order by","expandedViewOrderByDesc":"Sort order of the displayed business workspaces","expandedViewSortColumnTitle":"Column","expandedViewSortColumnDesc":"Column to order by","expandedViewSortOrderTitle":"Sort order","expandedViewSortOrderDesc":"Sort order to be used","customColumnsSectionTitle":"Custom columns","customColumnsSectionDesc":"Columns displayed in expanded view","customColumnsItemsTitle":"Column description","customColumnsItemsDesc":"Column displayed in expanded view","customColumnsPropertiesTitle":"Column","customColumnsPropertiesDesc":"Name of the custom column"}),csui.define("conws/widgets/header/impl/nls/header.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/header/impl/nls/root/header.manifest",{"tileTitle":"Header","tileDescription":"Header widget for business workspaces","workspaceTitle":"Workspace","workspaceDescription":"Workspace specific options","workspacePropertiesTitle":"Properties","workspacePropertiesDesc":"Configuration properties","businessworkspaceTitle":"Title","businessworkspaceDesc":"Name of the business workspace","workspaceTypeTitle":"Type","workspaceTypeDesc":"Name of the workspace type","descriptionSectionTitle":"Description","descriptionSection":"Description of the business workspace","widgetTitle":"Widget","widgetDescription":"Additional widget that can be embedded in the header widget","embedWidgetSectionTitle":"Embed widget","embedWidgetSectionDesc":"Widget to be embedded in the header widget"}),csui.define("conws/widgets/myworkspaces/impl/nls/myworkspaces.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/myworkspaces/impl/nls/root/myworkspaces.manifest",{"tileTitle":"Workspaces","tileDescription":"Shows business workspaces that are relevant in this perspective and role","titleSection":"Title","titleDescription":"Title of the Workspaces widget","WorkspaceTypeTitle":"Workspace type","WorkspaceTypeDesc":"Workspace type displayed in this widget","collapsedViewTitle":"Collapsed view","collapsedViewDesc":"Options for the collapsed view of the widget","noResultsPlaceholderTitle":"Message for empty result","noResultsPlaceholderDesc":"Message if there are no business workspaces to display","expandedViewTitle":"Expanded view","expandedViewDesc":"Options for the expanded view of this widget","orderBySectionTitle":"Order by","orderBySectionDesc":"Sort order of the displayed business workspaces","sortColumnSectionTitle":"Column","sortColumnSectionDesc":"Column to order by","sortOrderSectionTitle":"Sort order","sortOrderSectionDesc":"Sort order to be used","customColumnsTitle":"Custom columns","customColumnsDesc":"Columns displayed in expanded view","itemsSectionTitle":"Column description","itemsSectionDesc":"Column displayed in expanded view","keyTitle":"Column","keyDescription":"Name of the custom column"}),csui.define("bundles/conws-app",["conws/utils/icons/icons","conws/controls/inlineforms/workspace/workspace.view","conws/controls/inlineforms/conwstemplate/conwstemplate.view","conws/controls/form/fields/alpaca/referencefield","conws/controls/description/description.view","conws/controls/lazyactions/lazyToolbar.view","conws/controls/selectedmetadataform/selectedmetadataform.view","conws/controls/table/cells/role/role.view","conws/controls/table/cells/permission/role.permission.level.view","conws/controls/userpicker/role.view","conws/dialogs/addoreditrole/addoreditrole.wizard","conws/dialogs/applyrolepermissions/apply.role.permissions.view","conws/dialogs/applyrolepermissions/impl/header/apply.role.permissions.header.view","conws/utils/commands/tabletoolbar.extension","conws/utils/commands/permissions/permissions.dropdown.menu.items.extension","conws/utils/commands/permissions/permissions.list.toolbaritems.extension","conws/widgets/header/impl/headertoolbaritems.masks","conws/utils/commands/addconws","conws/utils/commands/addconwstemplate","conws/utils/commands/delete","conws/utils/commands/permissions/addoreditrole","conws/utils/commands/addrelateditem","conws/utils/commands/deleterelateditem","conws/utils/commands/permissions/deleterole","conws/utils/commands/permissions/edit.role.permissions","conws/utils/commands/permissions/edit.role.permission.helper","conws/utils/dragndrop/dragndrop.subtypes","conws/widgets/relatedworkspaces/addrelatedworkspaces.search","conws/widgets/relatedworkspaces/relatedworkspaces.view","conws/widgets/header/header.view","conws/widgets/team/team.view","conws/widgets/myworkspaces/myworkspaces.view","conws/widgets/metadata/metadata.view","conws/widgets/outlook/conwsoutlook.view","conws/widgets/configurationvolume/configurationvolume.view","json!conws/widgets/relatedworkspaces/relatedworkspaces.manifest.json","json!conws/widgets/header/header.manifest.json","json!conws/widgets/team/team.manifest.json","json!conws/widgets/myworkspaces/myworkspaces.manifest.json","json!conws/widgets/metadata/metadata.manifest.json","json!conws/widgets/configurationvolume/configurationvolume.manifest.json","conws/widgets/outlook/impl/utils/emailservice","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/team/impl/nls/team.lang","i18n!conws/utils/previewpane/impl/nls/previewpane.lang","i18n!conws/widgets/outlook/impl/nls/lang","i18n!conws/widgets/configurationvolume/impl/nls/lang","i18n!conws/widgets/configurationvolume/impl/nls/configurationvolume.manifest","i18n!conws/widgets/team/impl/nls/team.manifest","i18n!conws/widgets/metadata/impl/nls/metadata.manifest","i18n!conws/widgets/relatedworkspaces/impl/nls/relatedworkspaces.manifest","i18n!conws/widgets/header/impl/nls/header.manifest","i18n!conws/widgets/myworkspaces/impl/nls/myworkspaces.manifest"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"conws/bundles/conws-app",!0)});
//# sourceMappingURL=conws-app.js.map