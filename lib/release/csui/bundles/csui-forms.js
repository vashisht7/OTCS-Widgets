csui.define("csui/lib/alpaca/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/lib/alpaca/nls/root/lang",{"empty":"","required":"This field is required.","valid":"","invalid":"This field is invalid.","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"timeUnits":{"SECOND":"seconds","MINUTE":"minutes","HOUR":"hours","DAY":"days","MONTH":"months","YEAR":"years"},"notOptional":"This is a required field.","disallowValue":"{0} are disallowed values.","invalidValueOfEnum":"This field should have one of the values in {0}.  Current value is: {1}","notEnoughItems":"The minimum number of items is {0}","tooManyItems":"The maximum number of items is {0}","valueNotUnique":"Values must be unique.","notAnArray":"This value is not an Array","invalidDate":"Invalid date format.","invalidEmail":"Invalid Email format.","stringNotAnInteger":"This value must be an integer.","invalidIPv4":"Invalid IPv4 address. A valid format is 123.456.0.1","stringValueTooSmall":"The minimum value for this field is {0}.","stringValueTooLarge":"The maximum value for this field is {0}.","stringValueTooSmallExclusive":"Enter a value greater than {0}.","stringValueTooLargeExclusive":"Enter a value less than {0}.","stringDivisibleBy":"The value must be divisible by {0}.","stringNotANumber":"This value must be a number.","stringValueNotMultipleOf":"This value must be a multiple of {0}.","invalidPassword":"Invalid Password","invalidPhone":"Invalid Phone Number, e.g. (123) 456-9999","invalidPattern":"This field must have pattern {0}.","stringTooShort":"This field must contain at least {0} numbers or characters.","stringTooLong":"This field must not contain more than {0} characters","noneLabel":"None","addItemButtonLabel":"Add New Item","addButtonLabel":"Add","removeButtonLabel":"Remove","upButtonLabel":"Up","downButtonLabel":"Down","webAddressNeeded":"Web addess needs to be added."}),function(e,i){var t=!0;e&&void 0!==e.umd&&(t=e.umd),t&&"object"==typeof exports?module.exports=i(require("jquery"),require("handlebars"),require("bootstrap")):t&&"function"==typeof csui.define&&csui.define.amd?csui.define("csui/lib/alpaca/js/alpaca",["csui/lib/jquery","csui/lib/handlebars","csui/lib/binf/js/binf","csui/lib/moment","i18n!csui/lib/alpaca/nls/lang"],i):e.Alpaca=i(e.jQuery,e.Handlebars,e.Bootstrap)}(this,function($,Handlebars,Bootstrap,moment,lang){var jQuery=$;return this.HandlebarsPrecompiled=this.HandlebarsPrecompiled||{},this.HandlebarsPrecompiled["web-display"]=this.HandlebarsPrecompiled["web-display"]||{},this.HandlebarsPrecompiled["web-display"]["container-array-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n        ';return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:i.helperMissing,l={"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-array"]=Handlebars.template({"1":function(e,i,t,n){var a,s,l,r="\n            ";return s=null!=(s=i.item||(null!=e?e.item:e))?s:i.helperMissing,l={"name":"item","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.item||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"},"2":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-object-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n        ';return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:i.helperMissing,l={"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-object"]=Handlebars.template({"1":function(e,i,t,n){var a,s,l,r="\n            ";return s=null!=(s=i.item||(null!=e?e.item:e))?s:i.helperMissing,l={"name":"item","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.item||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"},"2":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-table-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <tr>\n        '+(null!=(a=(i.itemField||e&&e.itemField||i.helperMissing).call(e,"td",{"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </tr>\n\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-table"]=Handlebars.template({"1":function(e,i,t,n){return""},"3":function(e,i,t,n){var a;return"                    <th>"+this.escapeExpression(this.lambda(null!=(a=null!=e?e.value:e)?a.title:a,e))+"</th>\n"},"5":function(e,i,t,n){var a;return"\n                "+(null!=(a=(i.item||e&&e.item||i.helperMissing).call(e,"tr",{"name":"item","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r=i.helperMissing,o='<script type="text/x-handlebars-template">\n\n    <div>\n\n        ';return s=null!=(s=i.arrayToolbar||(null!=e?e.arrayToolbar:e))?s:r,l={"name":"arrayToolbar","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayToolbar||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(o+=a),o+"\n\n        <table>\n\n            \x3c!-- table headers --\x3e\n            <thead>\n                <tr>\n"+(null!=(a=(i.eachProperty||e&&e.eachProperty||r).call(e,null!=(a=null!=(a=null!=e?e.schema:e)?a.items:a)?a.properties:a,{"name":"eachProperty","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"                </tr>\n            </thead>\n\n            \x3c!-- table body --\x3e\n            <tbody>\n"+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+"            </tbody>\n\n        </table>\n\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-tablerow-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <td>\n        ';return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:i.helperMissing,l={"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n    </td>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["container-tablerow"]=Handlebars.template({"1":function(e,i,t,n){var a,s,l,r="            ";return s=null!=(s=i.item||(null!=e?e.item:e))?s:i.helperMissing,l={"name":"item","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.item||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n"},"2":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-merge-up">\n\n'+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"].container=Handlebars.template({"1":function(e,i,t,n){var a;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+' alpaca-container-label">'+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))},"4":function(e,i,t,n){var a;return'        <p class="alpaca-helper '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="alpaca-icon-helper"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"5":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"7":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.container||(null!=e?e.container:e))?s:i.helperMissing,l={"name":"container","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.container||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["control-any"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div>'+(null!=(a=(i.str||e&&e.str||i.helperMissing).call(e,null!=e?e.data:e,{"name":"str","hash":{},"data":n}))?a:"")+"</div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["control-checkbox"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div>'+(null!=(a=(i.str||e&&e.str||i.helperMissing).call(e,null!=e?e.data:e,{"name":"str","hash":{},"data":n}))?a:"")+"</div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["control-image"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s=i.helperMissing,l=this.escapeExpression;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-image-display">\n        <img id="'+l((a=null!=(a=i.id||(null!=e?e.id:e))?a:s,"function"==typeof a?a.call(e,{"name":"id","hash":{},"data":n}):a))+'-image" src="'+l((a=null!=(a=i.data||(null!=e?e.data:e))?a:s,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))+'">\n    </div>\n\n<\/script>'},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["control-radio"]=Handlebars.template({"1":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.value:e,null!=s[1]?s[1].data:s[1],{"name":"compare","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"2":function(e,i,t,n){var a,s;return"                "+(null!=(s=null!=(s=i.text||(null!=e?e.text:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"text","hash":{},"data":n}):s)?a:"")+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <div>\n'+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"    </div>\n\n<\/script>\n"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-display"]["control-select"]=Handlebars.template({"1":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.value:e,null!=s[1]?s[1].data:s[1],{"name":"compare","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"2":function(e,i,t,n){var a,s;return"                "+(null!=(s=null!=(s=i.text||(null!=e?e.text:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"text","hash":{},"data":n}):s)?a:"")+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <div>\n'+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"    </div>\n\n<\/script>\n"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-display"]["control-text"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <div>'+(null!=(s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"data","hash":{},"data":n}):s)?a:"")+"</div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["control-textarea"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <p>\n        '+(null!=(s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"data","hash":{},"data":n}):s)?a:"")+"\n    </p>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"]["control-url"]=Handlebars.template({"1":function(e,i,t,n){var a;return'target="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTarget:a,e))+'"'},"3":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitle:a,e))},"5":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))},"7":function(e,i,t,n){var a;return"            "+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitle:a,e))+"\n"},"9":function(e,i,t,n){var a;return"            "+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <a href="'+this.escapeExpression((s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"data","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.anchorTarget:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+' title="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.anchorTitle:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.program(5,n,0),"data":n}))?a:"")+'">\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.anchorTitle:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.program(9,n,0),"data":n}))?a:"")+"    </a>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-display"].control=Handlebars.template({"1":function(e,i,t,n){var a,s;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+' alpaca-control-label" for="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'">'+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))},"4":function(e,i,t,n){return""},"6":function(e,i,t,n){var a;return'        <p class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="info-sign"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"7":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.control||(null!=e?e.control:e))?s:i.helperMissing,l={"name":"control","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.control||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(6,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-display"].form=Handlebars.template({"1":function(e,i,t,n){return""},"3":function(e,i,t,n,a,s){var l;return null!=(l=i.each.call(e,null!=(l=null!=e?e.options:e)?l.buttons:l,{"name":"each","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"4":function(e,i,t,n,a,s){var l,r,o=i.helperMissing,d=this.escapeExpression;return'            <button data-key="'+d((r=null!=(r=i.key||n&&n.key)?r:o,"function"==typeof r?r.call(e,{"name":"key","hash":{},"data":n}):r))+'" '+(null!=(l=(i.compare||e&&e.compare||o).call(e,null!=e?e.type:e,"submit",{"name":"compare","hash":{},"fn":this.program(5,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+" "+(null!=(l=(i.compare||e&&e.compare||o).call(e,null!=e?e.type:e,"reset",{"name":"compare","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+' class="alpaca-form-button alpaca-form-button-'+d((r=null!=(r=i.key||n&&n.key)?r:o,"function"==typeof r?r.call(e,{"name":"key","hash":{},"data":n}):r))+" "+d(this.lambda(null!=(l=null!=(l=null!=s[2]?s[2].view:s[2])?l.styles:l)?l.button:l,e))+'" '+(null!=(l=i.each.call(e,null!=e?e.value:e,{"name":"each","hash":{},"fn":this.program(9,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">"+(null!=(r=null!=(r=i.value||(null!=e?e.value:e))?r:o,l="function"==typeof r?r.call(e,{"name":"value","hash":{},"data":n}):r)?l:"")+"</button>\n"},"5":function(e,i,t,n){return'type="submit"'},"7":function(e,i,t,n){return'type="reset"'},"9":function(e,i,t,n){var a,s=i.helperMissing,l=this.escapeExpression;return l((a=null!=(a=i.key||n&&n.key)?a:s,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+l((a=null!=(a=i.value||(null!=e?e.value:e))?a:s,"function"==typeof a?a.call(e,{"name":"value","hash":{},"data":n}):a))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l,r,o,d='<script type="text/x-handlebars-template">\n\n    <form role="form">\n\n        ';return r=null!=(r=i.formItems||(null!=e?e.formItems:e))?r:i.helperMissing,o={"name":"formItems","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n},l="function"==typeof r?r.call(e,o):r,i.formItems||(l=i.blockHelperMissing.call(e,l,o)),null!=l&&(d+=l),d+'\n\n        <div class="alpaca-form-buttons-container">\n'+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.buttons:l,{"name":"if","hash":{},"fn":this.program(3,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"        </div>\n\n    </form>\n\n<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"]=this.HandlebarsPrecompiled["web-edit"]||{},this.HandlebarsPrecompiled["web-edit"]["container-array-actionbar"]=Handlebars.template({"1":function(e,i,t,n,a,s){var l,r,o=this.escapeExpression;return'        <button  class="alpaca-array-actionbar-action '+o(this.lambda(null!=(l=null!=(l=null!=s[1]?s[1].view:s[1])?l.styles:l)?l.smallButton:l,e))+'" data-alpaca-array-actionbar-action="'+o((r=null!=(r=i.action||(null!=e?e.action:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"action","hash":{},"data":n}):r))+'" title="'+this.escapeExpression(this.lambda(null!=e?e.title:e,e))+'" aria-label="'+s[0].actionAria+'">\n'+(null!=(l=i.if.call(e,null!=e?e.iconClass:e,{"name":"if","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"            "+(null!=(l=i.if.call(e,null!=e?e.label:e,{"name":"if","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n        </button>\n"},"2":function(e,i,t,n){return'            <i class="'+this.escapeExpression(this.lambda(null!=e?e.iconClass:e,e))+'"></i>\n'},"4":function(e,i,t,n){var a,s;return null!=(s=null!=(s=i.label||(null!=e?e.label:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"label","hash":{},"data":n}):s)?a:""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l,r,o=i.helperMissing,d=this.escapeExpression;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-array-actionbar alpaca-array-actionbar-'+d((r=null!=(r=i.actionbarStyle||(null!=e?e.actionbarStyle:e))?r:o,"function"==typeof r?r.call(e,{"name":"actionbarStyle","hash":{},"data":n}):r))+' binf-btn-group" data-alpaca-array-actionbar-parent-field-id="'+d((r=null!=(r=i.parentFieldId||(null!=e?e.parentFieldId:e))?r:o,"function"==typeof r?r.call(e,{"name":"parentFieldId","hash":{},"data":n}):r))+'" data-alpaca-array-actionbar-field-id="'+d((r=null!=(r=i.fieldId||(null!=e?e.fieldId:e))?r:o,"function"==typeof r?r.call(e,{"name":"fieldId","hash":{},"data":n}):r))+'" data-alpaca-array-actionbar-item-index="'+d((r=null!=(r=i.itemIndex||(null!=e?e.itemIndex:e))?r:o,"function"==typeof r?r.call(e,{"name":"itemIndex","hash":{},"data":n}):r))+'">\n'+(null!=(l=i.each.call(e,null!=e?e.actions:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"    </div>\n\n<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"]["container-array-item"]=Handlebars.template({"1":function(e,i,t,n){var a,s,l,r=i.helperMissing,o=i.blockHelperMissing,d='        <div class="binf-pull-left">\n            ';return s=null!=(s=i.arrayActionbar||(null!=e?e.arrayActionbar:e))?s:r,l={"name":"arrayActionbar","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayActionbar||(a=o.call(e,a,l)),null!=a&&(d+=a),d+='\n        </div>\n        <div class="binf-pull-right">\n            ',s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:r,l={"name":"itemField","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=o.call(e,a,l)),null!=a&&(d+=a),d+'\n        </div>\n        <div class="clear"></div>\n'},"2":function(e,i,t,n){return""},"4":function(e,i,t,n){var a;return null!=(a=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.actionbarStyle:e,"right",{"name":"compare","hash":{},"fn":this.program(5,n,0),"inverse":this.program(7,n,0),"data":n}))?a:""},"5":function(e,i,t,n){var a,s,l,r=i.helperMissing,o=i.blockHelperMissing,d='            <div class="binf-pull-left">\n                ';return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:r,l={"name":"itemField","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=o.call(e,a,l)),null!=a&&(d+=a),d+='\n            </div>\n            <div class="binf-pull-right">\n                ',s=null!=(s=i.arrayActionbar||(null!=e?e.arrayActionbar:e))?s:r,l={"name":"arrayActionbar","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayActionbar||(a=o.call(e,a,l)),null!=a&&(d+=a),d+'\n            </div>\n            <div class="alpaca-clear"></div>\n'},"7":function(e,i,t,n){var a,s,l,r=i.helperMissing,o="            <div>\n\n"+(null!=(a=(i.compare||e&&e.compare||r).call(e,null!=e?e.actionbarStyle:e,"top",{"name":"compare","hash":{},"fn":this.program(8,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n                ";return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:r,l={"name":"itemField","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(o+=a),o+"\n\n"+(null!=(a=(i.compare||e&&e.compare||r).call(e,null!=e?e.actionbarStyle:e,"bottom",{"name":"compare","hash":{},"fn":this.program(8,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n            </div>\n"},"8":function(e,i,t,n){var a,s,l,r="                ";return s=null!=(s=i.arrayActionbar||(null!=e?e.arrayActionbar:e))?s:i.helperMissing,l={"name":"arrayActionbar","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayActionbar||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div>\n'+(null!=(a=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.actionbarStyle:e,"left",{"name":"compare","hash":{},"fn":this.program(1,n,0),"inverse":this.program(4,n,0),"data":n}))?a:"")+"    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-array-toolbar"]=Handlebars.template({"1":function(e,i,t,n){return" binf-btn-group"},"3":function(e,i,t,n,a,s){var l,r=i.helperMissing;return"\n"+(null!=(l=(i.compare||e&&e.compare||r).call(e,null!=s[1]?s[1].toolbarStyle:s[1],"link",{"name":"compare","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"+(null!=(l=(i.compare||e&&e.compare||r).call(e,null!=s[1]?s[1].toolbarStyle:s[1],"button",{"name":"compare","hash":{},"fn":this.program(6,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"},"4":function(e,i,t,n,a,s){var l,r=this.lambda;return'                <a href="#" class="alpaca-array-toolbar-action" data-alpaca-array-toolbar-action="'+this.escapeExpression(r(null!=s[1]?s[1].action:s[1],e))+'">'+(null!=(l=r(null!=s[1]?s[1].label:s[1],e))?l:"")+"</a>\n"},"6":function(e,i,t,n,a,s){var l,r=this.lambda,o=this.escapeExpression;return'                <button class="alpaca-array-toolbar-action '+o(r(null!=(l=null!=(l=null!=s[2]?s[2].view:s[2])?l.styles:l)?l.smallButton:l,e))+'" data-alpaca-array-toolbar-action="'+o(r(null!=s[1]?s[1].action:s[1],e))+'">\n'+(null!=(l=i.if.call(e,null!=s[1]?s[1].iconClass:s[1],{"name":"if","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"                    "+(null!=(l=i.if.call(e,null!=s[1]?s[1].label:s[1],{"name":"if","hash":{},"fn":this.program(9,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n                </button>\n"},"7":function(e,i,t,n,a,s){return'                    <i class="'+this.escapeExpression(this.lambda(null!=s[1]?s[1].iconClass:s[1],e))+'"></i>\n'},"9":function(e,i,t,n,a,s){var l;return null!=(l=this.lambda(null!=s[1]?s[1].label:s[1],e))?l:""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l,r,o=i.helperMissing;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-array-toolbar" data-alpaca-array-toolbar-field-id="'+this.escapeExpression((r=null!=(r=i.id||(null!=e?e.id:e))?r:o,"function"==typeof r?r.call(e,{"name":"id","hash":{},"data":n}):r))+'" '+(null!=(l=(i.compare||e&&e.compare||o).call(e,null!=e?e.toolbarStyle:e,"button",{"name":"compare","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">\n\n"+(null!=(l=i.each.call(e,null!=e?e.actions:e,{"name":"each","hash":{},"fn":this.program(3,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n    </div>\n\n<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"]["container-array"]=Handlebars.template({"1":function(e,i,t,n){return""},"3":function(e,i,t,n){var a,s,l,r="\n            ";return s=null!=(s=i.item||(null!=e?e.item:e))?s:i.helperMissing,l={"name":"item","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.item||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n        ';return s=null!=(s=i.arrayToolbar||(null!=e?e.arrayToolbar:e))?s:i.helperMissing,l={"name":"arrayToolbar","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayToolbar||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-object-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n        ';return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:i.helperMissing,l={"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-object"]=Handlebars.template({"1":function(e,i,t,n){var a,s,l,r="\n            ";return s=null!=(s=i.item||(null!=e?e.item:e))?s:i.helperMissing,l={"name":"item","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.item||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"},"2":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-table-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <tr>\n        '+(null!=(a=(i.itemField||e&&e.itemField||i.helperMissing).call(e,"td",{"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </tr>\n\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-table"]=Handlebars.template({"1":function(e,i,t,n){return""},"3":function(e,i,t,n){var a;return"                    <th>"+this.escapeExpression(this.lambda(null!=(a=null!=e?e.value:e)?a.title:a,e))+"</th>\n"},"5":function(e,i,t,n){return"                        <th>Actions</th>\n"},"7":function(e,i,t,n){var a;return"\n                "+(null!=(a=(i.item||e&&e.item||i.helperMissing).call(e,"tr",{"name":"item","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r=i.helperMissing,o='<script type="text/x-handlebars-template">\n\n    <div>\n\n        ';return s=null!=(s=i.arrayToolbar||(null!=e?e.arrayToolbar:e))?s:r,l={"name":"arrayToolbar",
"hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayToolbar||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(o+=a),o+"\n\n        <table>\n\n            \x3c!-- table headers --\x3e\n            <thead>\n                <tr>\n"+(null!=(a=(i.eachProperty||e&&e.eachProperty||r).call(e,null!=(a=null!=(a=null!=e?e.schema:e)?a.items:a)?a.properties:a,{"name":"eachProperty","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.showActionsColumn:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+"                </tr>\n            </thead>\n\n            \x3c!-- table body --\x3e\n            <tbody>\n"+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"            </tbody>\n\n        </table>\n\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-tablerow-item"]=Handlebars.template({"1":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <td>\n        ';return s=null!=(s=i.itemField||(null!=e?e.itemField:e))?s:i.helperMissing,l={"name":"itemField","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.itemField||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n    </td>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["container-tablerow"]=Handlebars.template({"1":function(e,i,t,n){var a,s,l,r="            ";return s=null!=(s=i.item||(null!=e?e.item:e))?s:i.helperMissing,l={"name":"item","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.item||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n"},"2":function(e,i,t,n){return""},"4":function(e,i,t,n){var a,s,l,r='            <div class="alpaca-merge-up">\n                ';return s=null!=(s=i.arrayActionbar||(null!=e?e.arrayActionbar:e))?s:i.helperMissing,l={"name":"arrayActionbar","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.arrayActionbar||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n            </div>\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-merge-up">\n\n'+(null!=(a=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        \x3c!-- actions cell --\x3e\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.showActionsColumn:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"].container=Handlebars.template({"1":function(e,i,t,n){var a;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+' alpaca-container-label">'+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))},"4":function(e,i,t,n){var a;return'        <p class="alpaca-helper '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="alpaca-icon-helper"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"5":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"7":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.container||(null!=e?e.container:e))?s:i.helperMissing,l={"name":"container","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.container||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-any"]=Handlebars.template({"1":function(e,i,t,n){return'readonly="readonly"'},"3":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"5":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <input type="text" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" size="40" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-checkbox"]=Handlebars.template({"1":function(e,i,t,n,a,s){var l;return"\n"+(null!=(l=i.each.call(e,null!=e?e.checkboxOptions:e,{"name":"each","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"},"2":function(e,i,t,n,a,s){var l,r,o=i.helperMissing,d=this.escapeExpression;return'\n            <div>\n\n                <label>\n\n                    <input type="checkbox" data-checkbox-index="'+d((r=null!=(r=i.index||n&&n.index)?r:o,"function"==typeof r?r.call(e,{"name":"index","hash":{},"data":n}):r))+'" data-checkbox-value="'+d((r=null!=(r=i.value||(null!=e?e.value:e))?r:o,"function"==typeof r?r.call(e,{"name":"value","hash":{},"data":n}):r))+'" '+(null!=(l=i.if.call(e,null!=(l=null!=s[2]?s[2].options:s[2])?l.readonly:l,{"name":"if","hash":{},"fn":this.program(3,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+" "+(null!=(l=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(5,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+" "+(null!=(l=i.each.call(e,null!=(l=null!=s[2]?s[2].options:s[2])?l.data:l,{"name":"each","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"/>\n                    "+(null!=(r=null!=(r=i.text||(null!=e?e.text:e))?r:o,l="function"==typeof r?r.call(e,{"name":"text","hash":{},"data":n}):r)?l:"")+"\n\n                </label>\n            </div>\n\n"},"3":function(e,i,t,n){return'readonly="readonly"'},"5":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"7":function(e,i,t,n){var a,s=i.helperMissing,l=this.escapeExpression;return"data-"+l((a=null!=(a=i.key||n&&n.key)?a:s,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+l((a=null!=(a=i.value||(null!=e?e.value:e))?a:s,"function"==typeof a?a.call(e,{"name":"value","hash":{},"data":n}):a))+'"'},"9":function(e,i,t,n){var a;return'\n        <div>\n\n            <label>\n\n                <input type="checkbox" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n                "+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.rightLabel:a,e))?a:"")+"\n            </label>\n\n        </div>\n\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n'+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.multiple:l,{"name":"if","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.program(9,n,0,a,s),"data":n}))?l:"")+"\n<\/script>\n"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"]["control-ckeditor"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <textarea id="'+this.escapeExpression((a=null!=(a=i.id||(null!=e?e.id:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"id","hash":{},"data":n}):a))+'" cols="80" rows="10">\n    </textarea>\n\n<\/script>'},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-editor"]=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<script type="text/x-handlebars-template">\n\n    <div id="'+this.escapeExpression((a=null!=(a=i.id||(null!=e?e.id:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"id","hash":{},"data":n}):a))+'" class="control-field-editor-el"></div>\n\n<\/script>'},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-file"]=Handlebars.template({"1":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"3":function(e,i,t,n){return'readonly="readonly"'},"5":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"7":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <input type="file" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-hidden"]=Handlebars.template({"1":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"3":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <input type="hidden" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-image"]=Handlebars.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){return'readonly="readonly"'},"7":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"9":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l=i.helperMissing,r=this.escapeExpression;return'<script type="text/x-handlebars-template">\n\n    <input type="text" id="'+r((s=null!=(s=i.id||(null!=e?e.id:e))?s:l,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'/>\n\n    <div class="alpaca-image-display">\n        <h5>Preview</h5>\n        <img id="'+r((s=null!=(s=i.id||(null!=e?e.id:e))?s:l,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'-image" src="'+r((s=null!=(s=i.data||(null!=e?e.data:e))?s:l,"function"==typeof s?s.call(e,{"name":"data","hash":{},"data":n}):s))+'">\n    </div>\n\n<\/script>'},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-password"]=Handlebars.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){return'readonly="readonly"'},"7":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"9":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <input type="password" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-radio"]=Handlebars.template({"1":function(e,i,t,n){return""},"3":function(e,i,t,n){var a,s,l=i.helperMissing;return'<div class="binf-radio"><label><input type="radio" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+' name="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:l,"function"==typeof s?s.call(e,{"name":"name","hash":{},"data":n}):s))+'" value=""/>'+(null!=(s=null!=(s=i.noneLabel||(null!=e?e.noneLabel:e))?s:l,a="function"==typeof s?s.call(e,{"name":"noneLabel","hash":{},"data":n}):s)?a:"")+"</label></div>"},"4":function(e,i,t,n){return'readonly="readonly"'},"6":function(e,i,t,n,a,s){var l,r,o=this.escapeExpression,d=i.helperMissing;return'<div class="binf-radio"><label><input type="radio" '+(null!=(l=i.if.call(e,null!=(l=null!=s[1]?s[1].options:s[1])?l.readonly:l,{"name":"if","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+' name="'+o(this.lambda(null!=s[1]?s[1].name:s[1],e))+'" value="'+o((r=null!=(r=i.value||(null!=e?e.value:e))?r:d,"function"==typeof r?r.call(e,{"name":"value","hash":{},"data":n}):r))+'" '+(null!=(l=(i.compare||e&&e.compare||d).call(e,null!=e?e.value:e,null!=s[1]?s[1].data:s[1],{"name":"compare","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"/>"+(null!=(r=null!=(r=i.text||(null!=e?e.text:e))?r:d,l="function"==typeof r?r.call(e,{"name":"text","hash":{},"data":n}):r)?l:"")+"</label></div>"},"7":function(e,i,t,n){return'checked="checked"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">'+(null!=(l=i.if.call(e,null!=e?e.hideNone:e,{"name":"if","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.program(3,n,0,a,s),"data":n}))?l:"")+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(6,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"]["control-select"]=Handlebars.template({"1":function(e,i,t,n){return'readonly="readonly"'},"3":function(e,i,t,n){return'multiple="multiple"'},"5":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"7":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"9":function(e,i,t,n,a,s){var l;return"\n"+(null!=(l=i.if.call(e,null!=e?e.hideNone:e,{"name":"if","hash":{},"fn":this.program(10,n,0,a,s),"inverse":this.program(12,n,0,a,s),"data":n}))?l:"")+"\n"+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(14,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"},"10":function(e,i,t,n){return""},"12":function(e,i,t,n){var a,s;return'        <option value="">'+(null!=(s=null!=(s=i.noneLabel||(null!=e?e.noneLabel:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"noneLabel","hash":{},"data":n}):s)?a:"")+"</option>\n"},"14":function(e,i,t,n,a,s){var l,r,o=i.helperMissing;return'        <option value="'+(null!=(r=null!=(r=i.value||(null!=e?e.value:e))?r:o,l="function"==typeof r?r.call(e,{"name":"value","hash":{},"data":n}):r)?l:"")+'" '+(null!=(l=i.each.call(e,null!=s[1]?s[1].data:s[1],{"name":"each","hash":{},"fn":this.program(15,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">"+this.escapeExpression((r=null!=(r=i.text||(null!=e?e.text:e))?r:o,"function"==typeof r?r.call(e,{"name":"text","hash":{},"data":n}):r))+"</option>\n"},"15":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.value:e,null!=s[2]?s[2].value:s[2],{"name":"compare","hash":{},"fn":this.program(16,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"16":function(e,i,t,n){return'selected="selected"'},"18":function(e,i,t,n,a,s){var l;return"\n"+(null!=(l=i.if.call(e,null!=e?e.hideNone:e,{"name":"if","hash":{},"fn":this.program(10,n,0,a,s),"inverse":this.program(12,n,0,a,s),"data":n}))?l:"")+"\n"+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(19,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"},"19":function(e,i,t,n,a,s){var l,r,o=i.helperMissing;return'        <option value="'+(null!=(r=null!=(r=i.value||(null!=e?e.value:e))?r:o,l="function"==typeof r?r.call(e,{"name":"value","hash":{},"data":n}):r)?l:"")+'" '+(null!=(l=(i.compare||e&&e.compare||o).call(e,null!=e?e.value:e,null!=s[2]?s[2].data:s[2],{"name":"compare","hash":{},"fn":this.program(16,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">"+this.escapeExpression((r=null!=(r=i.text||(null!=e?e.text:e))?r:o,"function"==typeof r?r.call(e,{"name":"text","hash":{},"data":n}):r))+"</option>\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l,r;return'<script type="text/x-handlebars-template">\n\n    <select id="'+this.escapeExpression((r=null!=(r=i.id||(null!=e?e.id:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"id","hash":{},"data":n}):r))+'" '+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.readonly:l,{"name":"if","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+" "+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.multiple:l,{"name":"if","hash":{},"fn":this.program(3,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+" "+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.size:l,{"name":"if","hash":{},"fn":this.program(5,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+" "+(null!=(l=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">\n\n"+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.multiple:l,{"name":"if","hash":{},"fn":this.program(9,n,0,a,s),"inverse":this.program(18,n,0,a,s),"data":n}))?l:"")+"\n    </select>\n\n<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"]["control-text"]=Handlebars.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){return'readonly="readonly"'},"7":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"9":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"11":function(e,i,t,n){var a,s=this.escapeExpression;return s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l=i.helperMissing,r=this.escapeExpression;return'<script type="text/x-handlebars-template">\n\n    <input type="'+r((s=null!=(s=i.inputType||(null!=e?e.inputType:e))?s:l,"function"==typeof s?s.call(e,{"name":"inputType","hash":{},"data":n}):s))+'" id="'+r((s=null!=(s=i.id||(null!=e?e.id:e))?s:l,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.attributes:a,{"name":"each","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-textarea"]=Handlebars.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'rows="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.rows:a,e))+'"'},"5":function(e,i,t,n){var a;return'cols="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.cols:a,e))+'"'},"7":function(e,i,t,n){return'readonly="readonly"'},"9":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"11":function(e,i,t,n){var a,s,l=i.helperMissing;return"data-"+this.escapeExpression((s=null!=(s=i.fieldId||(null!=e?e.fieldId:e))?s:l,"function"==typeof s?s.call(e,{"name":"fieldId","hash":{},"data":n}):s))+'="'+(null!=(s=null!=(s=i.value||(null!=e?e.value:e))?s:l,a="function"==typeof s?s.call(e,{"name":"value","hash":{},"data":n}):s)?a:"")+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <textarea id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.rows:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.cols:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"]["control-url"]=Handlebars.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){return'readonly="readonly"'},"7":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"9":function(e,i,t,n){var a,s=this.escapeExpression;return"data-"+s((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+s(this.lambda(e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <input type="text" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+" "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"].control=Handlebars.template({"1":function(e,i,t,n){var a,s;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+' alpaca-control-label" for="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'">'+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))},"4":function(e,i,t,n){return""},"6":function(e,i,t,n){var a;return'        <p class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="info-sign"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"7":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.control||(null!=e?e.control:e))?s:i.helperMissing,l={"name":"control","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.control||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(6,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"].form=Handlebars.template({"1":function(e,i,t,n){return""},"3":function(e,i,t,n,a,s){var l;return null!=(l=i.each.call(e,null!=(l=null!=e?e.options:e)?l.buttons:l,{"name":"each","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"4":function(e,i,t,n,a,s){var l,r,o=i.helperMissing,d=this.escapeExpression;return'                    <button data-key="'+d((r=null!=(r=i.key||n&&n.key)?r:o,"function"==typeof r?r.call(e,{"name":"key","hash":{},"data":n}):r))+'" type="'+d((r=null!=(r=i.type||(null!=e?e.type:e))?r:o,"function"==typeof r?r.call(e,{"name":"type","hash":{},"data":n}):r))+'" class="alpaca-form-button alpaca-form-button-'+d((r=null!=(r=i.key||n&&n.key)?r:o,
"function"==typeof r?r.call(e,{"name":"key","hash":{},"data":n}):r))+" "+d(this.lambda(null!=(l=null!=(l=null!=s[2]?s[2].view:s[2])?l.styles:l)?l.button:l,e))+'" '+(null!=(l=i.each.call(e,null!=e?e.value:e,{"name":"each","hash":{},"fn":this.program(5,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">"+(null!=(r=null!=(r=i.value||(null!=e?e.value:e))?r:o,l="function"==typeof r?r.call(e,{"name":"value","hash":{},"data":n}):r)?l:"")+"</button>\n"},"5":function(e,i,t,n){var a,s=i.helperMissing,l=this.escapeExpression;return l((a=null!=(a=i.key||n&&n.key)?a:s,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+l((a=null!=(a=i.value||(null!=e?e.value:e))?a:s,"function"==typeof a?a.call(e,{"name":"value","hash":{},"data":n}):a))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l,r,o,d='<script type="text/x-handlebars-template">\n\n    <form role="form">\n\n        ';return r=null!=(r=i.formItems||(null!=e?e.formItems:e))?r:i.helperMissing,o={"name":"formItems","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n},l="function"==typeof r?r.call(e,o):r,i.formItems||(l=i.blockHelperMissing.call(e,l,o)),null!=l&&(d+=l),d+'\n\n        <div class="alpaca-form-buttons-container">\n'+(null!=(l=i.if.call(e,null!=(l=null!=e?e.options:e)?l.buttons:l,{"name":"if","hash":{},"fn":this.program(3,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"        </div>\n\n    </form>\n\n<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["web-edit"].message=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l=i.helperMissing;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-message alpaca-message-'+(null!=(s=null!=(s=i.id||(null!=e?e.id:e))?s:l,a="function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s)?a:"")+'">\n        '+(null!=(s=null!=(s=i.message||(null!=e?e.message:e))?s:l,a="function"==typeof s?s.call(e,{"name":"message","hash":{},"data":n}):s)?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["web-edit"].wizard=Handlebars.template({"1":function(e,i,t,n){var a;return'        <div class="alpaca-wizard-nav">\n            <nav class="binf-navbar binf-navbar-default" role="navigation">\n                <div class="binf-container-fluid alpaca-wizard-back">\n                    <ul class="binf-nav binf-navbar-nav">\n'+(null!=(a=i.each.call(e,null!=e?e.steps:e,{"name":"each","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+"                    </ul>\n                </div>\n            </nav>\n        </div>\n"},"2":function(e,i,t,n){var a,s,l=i.helperMissing;return'                        <li data-alpaca-wizard-step-index="'+this.escapeExpression((s=null!=(s=i.index||n&&n.index)?s:l,"function"==typeof s?s.call(e,{"name":"index","hash":{},"data":n}):s))+'">\n                            <div class="holder">\n                                <div class="title">'+(null!=(s=null!=(s=i.title||(null!=e?e.title:e))?s:l,a="function"==typeof s?s.call(e,{"name":"title","hash":{},"data":n}):s)?a:"")+'</div>\n                                <div class="description">'+(null!=(s=null!=(s=i.description||(null!=e?e.description:e))?s:l,a="function"==typeof s?s.call(e,{"name":"description","hash":{},"data":n}):s)?a:"")+'</div>\n                            </div>\n                            <div class="chevron"></div>\n                        </li>\n'},"4":function(e,i,t,n){return'        <div class="alpaca-wizard-progress-bar">\n            <div class="binf-progress">\n                <div class="binf-progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">\n                </div>\n            </div>\n        </div>\n'},"6":function(e,i,t,n){var a,s;return"            <h3>"+(null!=(s=null!=(s=i.wizardTitle||(null!=e?e.wizardTitle:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"wizardTitle","hash":{},"data":n}):s)?a:"")+"</h3>\n"},"8":function(e,i,t,n){var a,s;return"            <h4>"+(null!=(s=null!=(s=i.wizardDescription||(null!=e?e.wizardDescription:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"wizardDescription","hash":{},"data":n}):s)?a:"")+"</h4>\n"},"10":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.align:e,"left",{"name":"compare","hash":{},"fn":this.program(11,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"11":function(e,i,t,n,a,s){var l,r,o=i.helperMissing,d=this.escapeExpression;return'                        <button type="'+d((r=null!=(r=i.type||(null!=e?e.type:e))?r:o,"function"==typeof r?r.call(e,{"name":"type","hash":{},"data":n}):r))+'" class="'+d(this.lambda(null!=(l=null!=(l=null!=s[2]?s[2].view:s[2])?l.styles:l)?l.button:l,e))+'" data-alpaca-wizard-button-key="'+d((r=null!=(r=i.key||n&&n.key)?r:o,"function"==typeof r?r.call(e,{"name":"key","hash":{},"data":n}):r))+'">'+(null!=(r=null!=(r=i.title||(null!=e?e.title:e))?r:o,l="function"==typeof r?r.call(e,{"name":"title","hash":{},"data":n}):r)?l:"")+"</button>\n"},"13":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.align:e,"right",{"name":"compare","hash":{},"fn":this.program(11,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-wizard">\n\n        \x3c!-- nav bar --\x3e\n'+(null!=(l=i.if.call(e,null!=e?e.showSteps:e,{"name":"if","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n        \x3c!-- wizard progress bar --\x3e\n"+(null!=(l=i.if.call(e,null!=e?e.showProgressBar:e,{"name":"if","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"+(null!=(l=i.if.call(e,null!=e?e.wizardTitle:e,{"name":"if","hash":{},"fn":this.program(6,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+(null!=(l=i.if.call(e,null!=e?e.wizardDescription:e,{"name":"if","hash":{},"fn":this.program(8,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+'\n        \x3c!-- wizard steps --\x3e\n        <div class="alpaca-wizard-steps">\n\n        </div>\n\n        \x3c!-- wizard buttons --\x3e\n        <div class="alpaca-wizard-buttons">\n\n            <div class="binf-pull-left">\n'+(null!=(l=i.each.call(e,null!=e?e.buttons:e,{"name":"each","hash":{},"fn":this.program(10,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+'            </div>\n\n            <div class="binf-pull-right">\n'+(null!=(l=i.each.call(e,null!=e?e.buttons:e,{"name":"each","hash":{},"fn":this.program(13,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+'            </div>\n\n            <div style="clear:both"></div>\n\n        </div>\n\n    </div>\n\n<\/script>'},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["bootstrap-display"]=this.HandlebarsPrecompiled["bootstrap-display"]||{},this.HandlebarsPrecompiled["bootstrap-display"].container=Handlebars.template({"1":function(e,i,t,n){var a;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+'alpaca-container-label">\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.collapsible:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n            "+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"\n\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.collapsible:a,{"name":"if","hash":{},"fn":this.program(6,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        </label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))+" "},"4":function(e,i,t,n){return'            <span data-binf-toggle="collapse">\n'},"6":function(e,i,t,n){return"            </span>\n"},"8":function(e,i,t,n){var a;return'        <p class="alpaca-helper binf-help-block '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="alpaca-icon-16 binf-glyphicon binf-glyphicon-info-sign"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"9":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"11":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(8,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.container||(null!=e?e.container:e))?s:i.helperMissing,l={"name":"container","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.container||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-display"]["control-radio"]=Handlebars.template({"1":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.value:e,null!=s[1]?s[1].data:s[1],{"name":"compare","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"2":function(e,i,t,n){var a,s;return"                "+(null!=(s=null!=(s=i.text||(null!=e?e.text:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"text","hash":{},"data":n}):s)?a:"")+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <div>\n'+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"    </div>\n\n<\/script>\n"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["bootstrap-display"]["control-select"]=Handlebars.template({"1":function(e,i,t,n,a,s){var l;return null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=e?e.value:e,null!=s[1]?s[1].data:s[1],{"name":"compare","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"2":function(e,i,t,n){var a,s;return"            "+(null!=(s=null!=(s=i.text||(null!=e?e.text:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"text","hash":{},"data":n}):s)?a:"")+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <div>\n'+(null!=(l=i.each.call(e,null!=e?e.selectOptions:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"    </div>\n\n<\/script>\n"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["bootstrap-display"].control=Handlebars.template({"1":function(e,i,t,n){var a,s;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+' binf-control-label alpaca-control-label" for="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'">'+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))},"4":function(e,i,t,n){return""},"6":function(e,i,t,n){var a;return'        <p class="binf-help-block '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="binf-glyphicon binf-glyphicon-info-sign"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"7":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div class="binf-form-group">\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.control||(null!=e?e.control:e))?s:i.helperMissing,l={"name":"control","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.control||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(6,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-display"].message=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<script type="text/x-handlebars-template">\n\n    <div class="binf-help-block">\n        <i class="binf-glyphicon binf-glyphicon-exclamation-sign"></i>'+(null!=(s=null!=(s=i.message||(null!=e?e.message:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"message","hash":{},"data":n}):s)?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-edit"]=this.HandlebarsPrecompiled["bootstrap-edit"]||{},this.HandlebarsPrecompiled["bootstrap-edit"]["container-grid"]=Handlebars.template({"1":function(e,i,t,n){return" binf-btn-group"},"3":function(e,i,t,n,a,s){var l,r=i.helperMissing;return"\n"+(null!=(l=(i.compare||e&&e.compare||r).call(e,null!=(l=null!=s[1]?s[1].options:s[1])?l.toolbarStyle:l,"link",{"name":"compare","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"+(null!=(l=(i.compare||e&&e.compare||r).call(e,null!=(l=null!=s[1]?s[1].options:s[1])?l.toolbarStyle:l,"button",{"name":"compare","hash":{},"fn":this.program(6,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n"},"4":function(e,i,t,n){var a=this.lambda,s=this.escapeExpression;return'                <a href="#" class="alpaca-array-toolbar-action" data-array-toolbar-action="'+s(a(null!=e?e.action:e,e))+'">'+s(a(null!=e?e.label:e,e))+"</a>\n"},"6":function(e,i,t,n,a,s){var l,r=this.lambda,o=this.escapeExpression;return'                <button class="alpaca-array-toolbar-action '+o(r(null!=(l=null!=(l=null!=s[2]?s[2].view:s[2])?l.styles:l)?l.button:l,e))+'" data-array-toolbar-action="'+o(r(null!=e?e.action:e,e))+'">\n'+(null!=(l=i.if.call(e,null!=e?e.iconClass:e,{"name":"if","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"                    "+(null!=(l=i.if.call(e,null!=e?e.label:e,{"name":"if","hash":{},"fn":this.program(9,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"\n                </button>\n"},"7":function(e,i,t,n){return'                    <i class="'+this.escapeExpression(this.lambda(null!=e?e.iconClass:e,e))+'"></i>\n'},"9":function(e,i,t,n){var a,s;return null!=(s=null!=(s=i.label||(null!=e?e.label:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"label","hash":{},"data":n}):s)?a:""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <div>\n\n        <div class="alpaca-array-toolbar" '+(null!=(l=(i.compare||e&&e.compare||i.helperMissing).call(e,null!=(l=null!=e?e.options:e)?l.toolbarStyle:l,"button",{"name":"compare","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+">\n\n"+(null!=(l=i.each.call(e,null!=e?e.arrayToolbarActions:e,{"name":"each","hash":{},"fn":this.program(3,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+'\n        </div>\n\n        <div class="alpaca-container-grid-holder"></div>\n\n    </div>\n\n<\/script>'},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["bootstrap-edit"].container=Handlebars.template({"1":function(e,i,t,n){var a;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+'alpaca-container-label">'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.collapsible:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.collapsible:a,{"name":"if","hash":{},"fn":this.program(6,n,0),"inverse":this.noop,"data":n}))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))+" "},"4":function(e,i,t,n){return'            <span data-binf-toggle="collapse">\n'},"6":function(e,i,t,n){return"            </span>\n"},"8":function(e,i,t,n){var a;return'        <p class="alpaca-helper binf-help-block '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="alpaca-icon-16 binf-glyphicon binf-glyphicon-info-sign"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"9":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"11":function(e,i,t,n){return""},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l;return helpersHtml=(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(8,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ",preHelpersHtml="",postHelpersHtml=helpersHtml,buffer='<script type="text/x-handlebars-template">\n\n    <div>\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n"+preHelpersHtml,s=null!=(s=i.container||(null!=e?e.container:e))?s:i.helperMissing,l={"name":"container","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.container||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(buffer+=a),buffer+postHelpersHtml+"\n\n    </div>\n\n<\/script>\n"},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-edit"]["control-upload-partial-download"]=Handlebars.template({"1":function(e,i,t,n){var a,s=this.lambda,l=this.escapeExpression;return'        <td></td>\n        <td class="name">\n            <span>'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'</span>\n        </td>\n        <td class="size">\n            <span>'+l(s(null!=(a=null!=e?e.file:e)?a.size:a,e))+'</span>\n        </td>\n        <td class="error" colspan="2">\n            Error:\n            '+l(s(null!=(a=null!=e?e.file:e)?a.error:a,e))+"\n        </td>\n"},"3":function(e,i,t,n){var a,s=this.lambda,l=this.escapeExpression;return'        <td class="preview">\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.file:e)?a.thumbnailUrl:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n}))?a:"")+'        </td>\n        <td class="name">\n            <a href="'+l(s(null!=(a=null!=e?e.file:e)?a.url:a,e))+'" title="'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'" data-gallery="'+l(s(null!=(a=null!=e?e.file:e)?a.thumbnailUrl:a,e))+'gallery" download="'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'">'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'</a>\n        </td>\n        <td class="size"><span>'+l(s(null!=(a=null!=e?e.file:e)?a.size:a,e))+'</span></td>\n        <td colspan="2"></td>\n'},"4":function(e,i,t,n){var a,s=this.lambda,l=this.escapeExpression;return'            <a href="'+l(s(null!=(a=null!=e?e.file:e)?a.url:a,e))+'" title="'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'" data-gallery="gallery" download="'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'">\n                <img src="'+l(s(null!=(a=null!=e?e.file:e)?a.thumbnailUrl:a,e))+'">\n            </a>\n'},"6":function(e,i,t,n,a,s){var l;return null!=(l=i.each.call(e,null!=e?e.buttons:e,{"name":"each","hash":{},"fn":this.program(7,n,0,a,s),"inverse":this.noop,"data":n}))?l:""},"7":function(e,i,t,n,a,s){var l;return null!=(l=i.if.call(e,null!=e?e.isDelete:e,{"name":"if","hash":{},"fn":this.program(8,n,0,a,s),"inverse":this.program(11,n,0,a,s),"data":n}))?l:""},"8":function(e,i,t,n){var a,s=this.lambda,l=this.escapeExpression;return'                        <button class="delete binf-btn binf-btn-danger" data-type="'+l(s(null!=(a=null!=e?e.file:e)?a.deleteType:a,e))+'" data-file-id="'+l(s(null!=(a=null!=e?e.file:e)?a.id:a,e))+'" data-url="'+l(s(null!=(a=null!=e?e.file:e)?a.deleteUrl:a,e))+'" '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.file:e)?a.deleteWithCredentials:a,{"name":"if","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'>\n                            <i class="binf-glyphicon binf-glyphicon-trash glyphicon-white"></i>\n                        </button>\n'},"9":function(e,i,t,n){return'data-xhr-fields="{\\"withCredentials\\":true}" '},"11":function(e,i,t,n,a,s){var l,r,o=i.helperMissing,d=this.escapeExpression;return'                        <button class="'+d((r=null!=(r=i.key||(null!=e?e.key:e))?r:o,"function"==typeof r?r.call(e,{"name":"key","hash":{},"data":n}):r))+" binf-btn "+d((r=null!=(r=i.buttonClass||(null!=e?e.buttonClass:e))?r:o,"function"==typeof r?r.call(e,{"name":"buttonClass","hash":{},"data":n}):r))+'" data-file-id="'+d(this.lambda(null!=(l=null!=s[2]?s[2].file:s[2])?l.id:l,e))+'">\n'+(null!=(l=i.if.call(e,null!=e?e.iconClass:e,{"name":"if","hash":{},"fn":this.program(12,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+(null!=(l=i.if.call(e,null!=e?e.label:e,{"name":"if","hash":{},"fn":this.program(14,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"                        </button>\n"},"12":function(e,i,t,n){var a;return'                                <i class="'+this.escapeExpression((a=null!=(a=i.iconClass||(null!=e?e.iconClass:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"iconClass","hash":{},"data":n}):a))+'"></i>\n'},"14":function(e,i,t,n){var a;return"                                "+this.escapeExpression((a=null!=(a=i.label||(null!=e?e.label:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"label","hash":{},"data":n}):a))+"\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<script type="text/x-handlebars-template">\n\n    <tr class="template-download">\n'+(null!=(l=i.if.call(e,null!=(l=null!=e?e.file:e)?l.error:l,{"name":"if","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.program(3,n,0,a,s),"data":n}))?l:"")+"        <td>\n"+(null!=(l=i.if.call(e,null!=e?e.buttons:e,{"name":"if","hash":{},"fn":this.program(6,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"        </td>\n    </tr>\n\n<\/script>"},"useData":!0,"useDepths":!0}),this.HandlebarsPrecompiled["bootstrap-edit"]["control-upload-partial-upload"]=Handlebars.template({"1":function(e,i,t,n){return'        <td class="preview">\n            <span class="binf-fade"></span>\n        </td>\n'},"3":function(e,i,t,n){return"        <td></td>\n"},"5":function(e,i,t,n){var a;return'        <td class="error" colspan="2"><span class="binf-label label-important">Error</span> '+this.escapeExpression(this.lambda(null!=(a=null!=e?e.file:e)?a.error:a,e))+"</td>\n"},"7":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=(a=null!=e?e.file:e)?a.valid:a,{"name":"if","hash":{},"fn":this.program(8,n,0),"inverse":this.program(15,n,0),"data":n}))?a:""},"8":function(e,i,t,n){var a;return(null!=(a=(i.compare||e&&e.compare||i.helperMissing).call(e,n&&n.index,0,{"name":"compare","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'            <td class="start">\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.autoUpload:a,{"name":"if","hash":{},"fn":this.program(11,n,0),"inverse":this.program(13,n,0),"data":n}))?a:"")+"            </td>\n"},"9":function(e,i,t,n){return'                <td>\n                    <div class="binf-progress progress-success binf-progress-striped binf-active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">\n                        <div class="binf-progress-bar" style="width:0%;"></div>\n                    </div>\n                </td>\n'},"11":function(e,i,t,n){return""},"13":function(e,i,t,n){return'                <button class="binf-btn binf-btn-primary"> \\\n                    <i class="binf-glyphicon binf-glyphicon-upload glyphicon-white"></i>\n                    <span>Start</span>\n                </button>\n'},"15":function(e,i,t,n){var a;return'            <td></td>\n            <td class="cancel">\n'+(null!=(a=(i.compare||e&&e.compare||i.helperMissing).call(e,n&&n.index,0,{"name":"compare","hash":{},"fn":this.program(16,n,0),"inverse":this.noop,"data":n}))?a:"")+"            </td>\n"},"16":function(e,i,t,n){return'                <button class="binf-btn binf-btn-warning">\n                    <i class="binf-glyphicon binf-glyphicon-ban-circle glyphicon-white"></i>\n                    <span>Cancel</span>\n                </button>\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s=this.lambda,l=this.escapeExpression;return'<script type="text/x-handlebars-template">\n\n    <tr class="template-upload">\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.showUploadPreview:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.program(3,n,0),"data":n}))?a:"")+'\n        <td class="name"><span>'+l(s(null!=(a=null!=e?e.file:e)?a.name:a,e))+'</span></td>\n        <td class="size"><span>'+l(s(null!=(a=null!=e?e.file:e)?a.size:a,e))+"</span></td>\n\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.file:e)?a.error:a,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.program(7,n,0),"data":n}))?a:"")+"        <td></td>\n    </tr>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-edit"]["control-upload"]=Handlebars.template({"1":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.cssClasses||(null!=e?e.cssClasses:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cssClasses","hash":{},"data":n}):a))},"3":function(e,i,t,n){var a;return"                        <thead>\n                            <tr>\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.showUploadPreview:a,{"name":"if","hash":{},"fn":this.program(4,n,0),"inverse":this.program(6,n,0),"data":n}))?a:"")+'                                <td>Name</td>\n                                <td>Size</td>\n                                <td colspan="2"></td>\x3c!-- error or start or progress indicator --\x3e\n                                <td>Actions</td>\n                            </tr>\n                        </thead>\n'},"4":function(e,i,t,n){return"                                    <td>Thumbnail</td>\n"},"6":function(e,i,t,n){return"                                    <td></td>\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l=this.escapeExpression,r=i.helperMissing;return'<script type="text/x-handlebars-template">\n\n    <div class="alpaca-fileupload-container '+(null!=(a=i.if.call(e,null!=e?e.cssClasses:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n        <div class="binf-container-fluid">\n            <div class="binf-row">\n                <div class="binf-col-md-12">\n                    <div class="binf-btn-group">\n                        <span class="'+l(this.lambda(null!=(a=null!=(a=null!=e?e.view:e)?a.styles:a)?a.button:a,e))+' fileinput-button">\n                            <i class="binf-glyphicon binf-glyphicon-upload"></i>\n                            <span class="fileupload-add-button">'+l((s=null!=(s=i.chooseButtonLabel||(null!=e?e.chooseButtonLabel:e))?s:r,"function"==typeof s?s.call(e,{"name":"chooseButtonLabel","hash":{},"data":n}):s))+'</span>\n                            <input class="alpaca-fileupload-input" type="file" name="'+l((s=null!=(s=i.name||(null!=e?e.name:e))?s:r,"function"==typeof s?s.call(e,{"name":"name","hash":{},"data":n}):s))+'_files">\n                            <input class="alpaca-fileupload-input-hidden" type="hidden" name="'+l((s=null!=(s=i.name||(null!=e?e.name:e))?s:r,"function"==typeof s?s.call(e,{"name":"name","hash":{},"data":n}):s))+'_files_hidden">\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="binf-row alpaca-fileupload-well">\n                <div class="binf-col-md-12 fileupload-active-zone">\n                    <table class="binf-table binf-table-striped">\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.showHeaders:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+'                        <tbody class="files">\n                        </tbody>\n                    </table>\n                    <p align="center" class="dropzone-message">'+l((s=null!=(s=i.dropZoneMessage||(null!=e?e.dropZoneMessage:e))?s:r,"function"==typeof s?s.call(e,{"name":"dropZoneMessage","hash":{},"data":n}):s))+'</p>\n                </div>\n            </div>\n            <div class="binf-row">\n                <div class="binf-col-md-12">\n                    <div id="progress" class="binf-progress">\n                        <div class="binf-progress-bar binf-progress-bar-success"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n<\/script>'},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-edit"].control=Handlebars.template({"1":function(e,i,t,n){var a,s;return'        <label class="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.labelClass:a,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop,"data":n}))?a:"")+' binf-control-label alpaca-control-label" for="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'">'+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.label:a,e))?a:"")+"</label>\n"},"2":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.labelClass:a,e))},"4":function(e,i,t,n){return""},"6":function(e,i,t,n){var a;return'        <p class="binf-help-block '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helperClass:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+'">\n            <i class="binf-glyphicon binf-glyphicon-info-sign"></i>\n            '+(null!=(a=this.lambda(null!=(a=null!=e?e.options:e)?a.helper:a,e))?a:"")+"\n        </p>\n"},"7":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.helperClass:a,e))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s,l,r='<script type="text/x-handlebars-template">\n\n    <div class="binf-form-group">\n\n'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.label:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n        ";return s=null!=(s=i.control||(null!=e?e.control:e))?s:i.helperMissing,l={"name":"control","hash":{},"fn":this.program(4,n,0),"inverse":this.noop,"data":n},a="function"==typeof s?s.call(e,l):s,i.control||(a=i.blockHelperMissing.call(e,a,l)),null!=a&&(r+=a),r+"\n\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.helper:a,{"name":"if","hash":{},"fn":this.program(6,n,0),"inverse":this.noop,"data":n}))?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),this.HandlebarsPrecompiled["bootstrap-edit"].message=Handlebars.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){
var a,s,l=i.helperMissing;return'<script type="text/x-handlebars-template">\n\n    <div class="binf-help-block alpaca-message alpaca-message-'+(null!=(s=null!=(s=i.id||(null!=e?e.id:e))?s:l,a="function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s)?a:"")+'">\n        <i class="binf-glyphicon binf-glyphicon-exclamation-sign"></i>'+(null!=(s=null!=(s=i.message||(null!=e?e.message:e))?s:l,a="function"==typeof s?s.call(e,{"name":"message","hash":{},"data":n}):s)?a:"")+"\n    </div>\n\n<\/script>"},"useData":!0}),function(e,i){e.Base=function(){var e=!1,i=["constructor","toString","valueOf"],t=i.length,n=/\bbase\b/,a=function(){},s={"toSource":null,"base":a},l=function(){};return l.extend=function(i,t){var n=l.prototype.extend;e=!0;var a=new this;n.call(a,i),a.base=s.base,e=!1;var r=a.constructor,o=a.constructor=function(){e||(this&&(this._constructing||this.constructor===o)?(this._constructing=!0,r.apply(this,arguments),this._constructing=!1):arguments.length&&l.cast.apply(o,arguments))};return n.call(o,this),o.ancestor=this,o.prototype=a,o.valueOf=function(e){return"object"===e?o:r.valueOf()},n.call(o,t),"function"==typeof o.init&&o.init(),o},l.prototype.extend=function(a,r){if("string"==typeof a&&arguments.length>1){var o=this[a];if(o&&"function"==typeof r&&(!o.valueOf||o.valueOf()!==r.valueOf())&&n.test(r)){var d=r.valueOf();r=function(){var e,i=this.base||s.base;return this.base=o,e=0===arguments.length?d.call(this):d.apply(this,arguments),this.base=i,e},r.valueOf=function(e){return"object"===e?r:d},r.toString=l.toString}this[a]=r}else if(a){var c=l.prototype.extend;e||"function"==typeof this||(c=this.extend||c);for(var u,h=e?0:1;h<t;h++)u=i[h],a[u]!==s[u]&&c.call(this,u,a[u]);for(u in a)s[u]||c.call(this,u,a[u])}return this},l=l.extend({"base":s.base},{"ancestor":Object,"version":"1.1","cast":function(){for(var e,i,t=0,n=arguments.length;t<n;t++)i=arguments[t],e=i.extend||l.prototype.extend,"function"==typeof i?(e=i.prototype.extend||l.prototype.extend,e.call(i.prototype,this.prototype),e.call(i,this),i.ancestor=this):e.call(i,this.prototype);return this},"implement":function(){for(var e=0;e<arguments.length;e++)this.cast.call(arguments[e],this);return this},"toString":function(){return this.valueOf()+""}})}()}(this),function(e){var i=function(){var t=i.makeArray(arguments);if(0===t.length)return i.throwDefaultError("You must supply at least one argument.  This argument can either be a DOM element against which Alpaca will generate a form or it can be a function name.  See http://www.alpacajs.org for more details.");var n=t[0];n&&i.isString(n)&&(n=e("#"+n));var a=null,s=null,l=null,r=null,o=null,d=null,c=null,u=null,h=!1,p={},f=null,m=null,g=null,v=null,b=["get","exists","destroy"],y=t.length>1&&i.isString(t[1])&&b.indexOf(t[1])>-1,w=function(){var t=null,a=e(n).find(":first");if(a.length>0){var s=e(a[0]).attr("data-alpaca-field-id");if(s){var l=i.fieldInstances[s];l&&(t=l)}else{if(e(a[0]).attr("data-alpaca-form-id")){var r=e(a[0]).find(":first");if(r.length>0){var o=e(r[0]).attr("data-alpaca-field-id");if(o){var l=i.fieldInstances[o];l&&(t=l)}}}}}return t}();if(w||y){if(y){var F=t[1];return"get"===F?w:"exists"===F?!!w:"destroy"===F?void w.destroy():i.throwDefaultError("Unknown special function: "+F)}return w}var C=null;if(1===t.length){var k=e(n).text();C=JSON.parse(k),e(n).html("")}else C=i.isObject(t[1])?t[1]:i.isFunction(t[1])?t[1]():{"data":t[1]};if(!C)return i.throwDefaultError("Unable to determine Alpaca configuration");a=C.data,s=C.schema,l=C.options,r=C.view,o=C.render,C.callback&&(o=C.callback),d=C.postRender,c=C.error,u=C.connector,f=C.dataSource,m=C.schemaSource,g=C.optionsSource,v=C.viewSource,C.ui&&(p.ui=C.ui),C.type&&(p.type=C.type),i.isEmpty(C.notTopLevel)||(h=C.notTopLevel),i.isEmpty(c)&&(c=i.defaultErrorCallback);var x="default",E={};i.isString(u)?x=u:i.isObject(u)&&u.id&&(x=u.id,u.config&&(E=u.config));var I=i.getConnectorClass(x);u=new I(x,E);var V=u;if(h){V=new(i.getConnectorClass("default"))("default")}l||(l={});var M=function(e){e.parent||(e.hideInitValidationError||e.refreshValidationState(!0),"view"!==e.view.type&&i.fieldApplyFieldAndChildren(e,function(e){e.hideInitValidationError=!1}))},S=function(e){e.parent||(e.observableScope=i.generateId()),i.isUndefined(l.focus)&&!e.parent&&(l.focus=i.defaultFocus),l&&l.focus?window.setTimeout(function(){var i=function(e){e.suspendBlurFocus=!0,e.trigger("focus"),e.suspendBlurFocus=!1};if(l.focus){if(e.isControlField&&e.isAutoFocusable())i(e);else if(e.isContainerField)if(!0===l.focus){if(e.children&&e.children.length>0)for(var t=0;t<e.children.length;t++)if(e.children[t].isControlField&&e.children[t].isAutoFocusable()&&!e.children[t].options.readonly){i(e.children[t]);break}}else if("string"==typeof l.focus){var n=e.getControlByPath(l.focus);n&&n.isControlField&&n.isAutoFocusable()&&i(n)}M(e)}},500):M(e),d&&d(e)};V.loadAll({"data":a,"schema":s,"options":l,"view":r,"dataSource":f,"schemaSource":m,"optionsSource":g,"viewSource":v},function(e,t,d,h){return e=e||a,d=d||s,t=t||l,h=h||r,i.isEmpty(e)&&i.isEmpty(d)&&(i.isEmpty(t)||i.isEmpty(t.type))&&(e="",i.isEmpty(t)?t="text":l&&i.isObject(l)&&(t.type="text")),t.view&&(h=t.view),i.init(n,e,t,d,h,p,o,S,u,c)},function(e){return c(e),null})};i.Fields={},i.Connectors={},i.Extend=e.extend,i.Create=function(){var i=Array.prototype.slice.call(arguments);return i.unshift({}),e.extend.apply(this,i)},i.Extend(i,{"makeArray":function(e){return Array.prototype.slice.call(e)},"isFunction":function(e){return"[object Function]"===Object.prototype.toString.call(e)},"isString":function(e){return"string"==typeof e},"isObject":function(e){return!i.isUndefined(e)&&"[object Object]"===Object.prototype.toString.call(e)},"isPlainObject":function(i){return e.isPlainObject(i)},"isNumber":function(e){return"number"==typeof e},"isArray":function(e){return e instanceof Array},"isBoolean":function(e){return"boolean"==typeof e},"isUndefined":function(e){return void 0===e},"trim":function(e){var t=e;return t&&i.isString(t)&&(t=t.replace(/^\s+|\s+$/g,"")),t},"safeDomParse":function(t){if(t&&i.isString(t)){t=i.trim(t);var n=null;try{n=e(t)}catch(i){t="<div>"+t+"</div>",n=e(t).children()}return n}return t},"isEmpty":function(e){var t=this;if(i.isUndefined(e))return!0;if(null===e)return!0;if(e&&i.isObject(e)){if(0===t.countProperties(e))return!0}return!1},"countProperties":function(e){var t=0;if(e&&i.isObject(e))for(var n in e)e.hasOwnProperty(n)&&"function"!=typeof e[n]&&t++;return t},"copyOf":function(t){var n=t;if(i.isArray(t)){n=[];for(var a=0;a<t.length;a++)n.push(i.copyOf(t[a]))}else if(i.isObject(t)){if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);if(t.nodeType&&"cloneNode"in t)n=t.cloneNode(!0);else if(e.isPlainObject(t)){n={};for(var s in t)t.hasOwnProperty(s)&&(n[s]=i.copyOf(t[s]))}}return n},"cloneObject":function(e){return i.copyOf(e)},"spliceIn":function(e,i,t){return e.substring(0,i)+t+e.substring(i,e.length)},"compactArray":function(e){var i,t=[],n=e.length;for(i=0;i<n;i++)lang.isNull(e[i])||lang.isUndefined(e[i])||t.push(e[i]);return t},"removeAccents":function(e){return e.replace(/[\xe0\xe1\xe2\xe3\xe4\xe5]/g,"a").replace(/[\xe8\xe9\xea\xeb]/g,"e").replace(/[\xec\xed\xee\xef]/g,"i").replace(/[\xf2\xf3\xf4\xf5\xf6]/g,"o").replace(/[\xf9\xfa\xfb\xfc]/g,"u").replace(/[\xfd\xff]/g,"y").replace(/[\xf1]/g,"n").replace(/[\xe7]/g,"c").replace(/[\u0153]/g,"oe").replace(/[\xe6]/g,"ae")},"indexOf":function(e,t,n){var a,s=t.length;for(i.isFunction(n)||(n=function(e,i){return e===i}),a=0;a<s;a++)if(n.call({},e,t[a]))return a;return-1},"uniqueIdCounter":0,"defaultLocale":"en_US","defaultFocus":!0,"setDefaultLocale":function(e){this.defaultLocale=e},"defaultSchemaFieldMapping":{},"registerDefaultSchemaFieldMapping":function(e,i){e&&i&&(this.defaultSchemaFieldMapping[e]=i)},"defaultFormatFieldMapping":{},"registerDefaultFormatFieldMapping":function(e,i){e&&i&&(this.defaultFormatFieldMapping[e]=i)},"getSchemaType":function(e){var t=null;return i.isEmpty(e)?t="string":i.isArray(e)?t="array":i.isObject(e)?t="object":i.isString(e)?t="string":i.isNumber(e)?t="number":i.isBoolean(e)&&(t="boolean"),t||"object"!=typeof e||(t="object"),t},"views":{},"generateViewId":function(){return"view-"+this.generateId()},"registerView":function(e){var t=e.id;if(!t)return i.throwDefaultError("Cannot register view with missing view id: "+t);var n=this.views[t];if(n)i.mergeObject(n,e);else{this.views[t]=e,e.templates||(e.templates={});for(var a=i.TemplateEngineRegistry.ids(),s=0;s<a.length;s++){var l=a[s],r=i.TemplateEngineRegistry.find(l);if(r)for(var o=r.findCacheKeys(t),d=0;d<o.length;d++){var c=i.splitCacheKey(o[d]);e.templates[c.templateId]={"type":l,"template":!0,"cacheKey":o[d]}}}}},"getNormalizedView":function(e){return this.normalizedViews[e]},"lookupNormalizedView":function(e,i){var t=null;for(var n in this.normalizedViews){var a=this.normalizedViews[n];if(a.ui===e&&a.type===i){t=n;break}}return t},"registerTemplate":function(e,i,t){t||(t="base"),this.views[t]||(this.views[t]={},this.views[t].id=t),this.views[t].templates||(this.views[t].templates={}),this.views[t].templates[e]=i},"registerTemplates":function(e,i){for(var t in e)this.registerTemplate(t,e[t],i)},"registerMessage":function(e,i,t){t||(t="base"),this.views[t]||(this.views[t]={},this.views[t].id=t),this.views[t].messages||(this.views[t].messages={}),this.views[t].messages[e]=i},"registerMessages":function(e,i){for(var t in e)e.hasOwnProperty(t)&&this.registerMessage(t,e[t],i)},"defaultDateFormat":"MM/DD/YYYY","defaultTimeFormat":"HH:SS","regexps":{"email":/^[a-z0-9!\#\$%&'\*\-\/=\?\+\-\^_`\{\|\}~]+(?:\.[a-z0-9!\#\$%&'\*\-\/=\?\+\-\^_`\{\|\}~]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z]{2,6}$/i,"url":/^[a-z0-9]+:\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*(\:[0-9]{1,5})?(([0-9]{1,5})?\/.*)?$/i,"password":/^[0-9a-zA-Z\x20-\x7E]*$/,"date":/^(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.]\d\d$/,"integer":/^([\+\-]?([0-9]\d*)|0)$/,"number":/^([\+\-]?((([0-9]+(\.)?)|([0-9]*\.[0-9]+))([eE][+-]?[0-9]+)?))$/,"phone":/^(\D?(\d{3})\D?\D?(\d{3})\D?(\d{4}))?$/,"ipv4":/^(?:1\d?\d?|2(?:[0-4]\d?|[6789]|5[0-5]?)?|[3-9]\d?|0)(?:\.(?:1\d?\d?|2(?:[0-4]\d?|[6789]|5[0-5]?)?|[3-9]\d?|0)){3}$/,"zipcode-five":/^(\d{5})?$/,"zipcode-nine":/^(\d{5}(-\d{4})?)?$/},"fieldInstances":{},"fieldClassRegistry":{},"registerFieldClass":function(e,i){this.fieldClassRegistry[e]=i},"getFieldClass":function(e){return this.fieldClassRegistry[e]},"getFieldClassType":function(e){for(var i in this.fieldClassRegistry)if(this.fieldClassRegistry.hasOwnProperty(i)&&this.fieldClassRegistry[i]===e)return i;return null},"connectorClassRegistry":{},"registerConnectorClass":function(e,i){this.connectorClassRegistry[e]=i},"getConnectorClass":function(e){return this.connectorClassRegistry[e]},"replaceAll":function(e,i,t){return e.replace(new RegExp(i,"g"),t)},"element":function(i,t,n,a){var s=e("<"+i+"/>");if(t&&s.attr(t),n&&s.css(n),a)for(var l in a)s.addClass(l)},"elementFromTemplate":function(t,n){var a=t;if(n)for(var s in n)a=i.replaceAll(a,"+s+",n[s]);return e(a)},"generateId":function(){return"alpaca"+ ++i.uniqueIdCounter},"later":function(i,t,n,a,s){i=i||0,t=t||{};var l,r,o=n,d=e.makeArray(a);if("string"==typeof n&&(o=t[n]),!o)throw{"name":"TypeError","message":"The function is undefined."};return l=function(){o.apply(t,d)},r=s?setInterval(l,i):setTimeout(l,i),{"id":r,"interval":s,"cancel":function(){this.interval?clearInterval(r):clearTimeout(r)}}},"endsWith":function(e,i){return-1!==e.indexOf(i,e.length-i.length)},"startsWith":function(e,i){return e.substr(0,i.length)===i},"isUri":function(e){return i.isString(e)&&(i.startsWith(e,"http://")||i.startsWith(e,"https://")||i.startsWith(e,"/")||i.startsWith(e,"./")||i.startsWith(e,"../"))},"traverseObject":function(e,t,n){i.isString(t)&&(t=t.split("."));var a=null,s=e,l=null;do{l=t.shift(),n&&l===n&&(l=t.shift()),i.isEmpty(s[l])?t=[]:(s=s[l],0===t.length&&(a=s))}while(t.length>0);return a},"each":function(e,t){if(i.isArray(e))for(var n=0;n<e.length;n++)t.apply(e[n]);else if(i.isObject(e))for(var a in e)t.apply(e[a])},"merge":function(e,t,n){e||(e={});for(var a in t){var s=!0;n&&(s=n(a)),s&&(i.isEmpty(t[a])?e[a]=t[a]:i.isObject(t[a])?(e[a]||(e[a]={}),e[a]=i.merge(e[a],t[a])):e[a]=t[a])}return e},"mergeObject":function(e,i){return e||(e={}),i||(i={}),this.mergeObject2(i,e),e},"mergeObject2":function(t,n){var a=i.isArray,s=i.isObject,l=i.isUndefined,r=i.copyOf,o=function(i,t){return a(i)?a(t)&&e.each(i,function(e){t.push(r(i[e]))}):s(i)?s(t)&&e.each(i,function(e){l(t[e])?t[e]=r(i[e]):t[e]=o(i[e],t[e])}):t=r(i),t};return o(t,n),n},"substituteTokens":function(e,t){if(!i.isEmpty(e))for(var n=0;n<t.length;n++){var a="{"+n+"}",s=e.indexOf(a);if(s>-1){var l=e.substring(0,s)+t[n]+e.substring(s+3);e=l}}return e},"compareObject":function(e,i){return equiv(e,i)},"compareArrayContent":function(i,t){var n=i&&t&&i.length===t.length;if(n)for(var a=i.length-1;a>=0;a--){var s=i[a];if(e.inArray(s,t)<0)return!1}return n},"testRegex":function(e,i){return new RegExp(e).test(i)},"isValEmpty":function(t){var n=!1;return i.isEmpty(t)?n=!0:(i.isString(t)&&""===t&&(n=!0),i.isObject(t)&&e.isEmptyObject(t)&&(n=!0),i.isArray(t)&&0===t.length&&(n=!0),i.isNumber(t)&&isNaN(t)&&(n=!0)),n},"init":function(e,t,n,a,s,l,r,o,d,c){var u=this;if(i.isObject(s)){s.id||(s.id=this.generateViewId());s.parent||(s.parent="bootstrap-edit"),this.registerView(s),s=s.id}this.compile(function(h){if(h.errors&&h.errors.length>0){for(var p=[],f=0;f<h.errors.length;f++){var m=h.errors[f].view,g=h.errors[f].cacheKey,v=h.errors[f].err,b="The template with cache key: "+g+" for view: "+m+" failed to compile";v&&v.message&&(b+=", message: "+v.message,p.push(v.message)),v&&(b+=", err: "+JSON.stringify(v)),i.logError(b),delete u.normalizedViews[m],delete u.views[m]}return i.throwErrorWithCallback("View compilation failed, cannot initialize Alpaca. "+p.join(", "),c)}u._init(e,t,n,a,s,l,r,o,d,c)},c)},"_init":function(t,n,a,s,l,r,o,d,c,u){var h=this,p=i.defaultView||null,f=null;if(e.mobile&&!p&&(p="jquerymobile"),"function"==typeof e.fn.modal&&!p&&(p="bootstrap"),void 0!==e.ui&&!p&&(p="jqueryui"),p&&(f=n?"edit":"create"),!l){var m=r.ui,g=r.type;m||(p||(p=i.defaultUI),p&&(m=p)),m&&(g||(g=f||"edit"),i.logDebug("No view provided but found request for UI: "+m+" and type: "+g),l=this.lookupNormalizedView(m,g),l?i.logDebug("Found view: "+l):i.logDebug("No view found for UI: "+m+" and type: "+g))}if(!l)return i.throwErrorWithCallback("A view was not specified and could not be automatically determined.",u);if(i.isString(l)&&!this.normalizedViews[l])return i.throwErrorWithCallback("The desired view: "+l+" could not be loaded.  Please make sure it is loaded and not misspelled.",u);var v=i.createFieldInstance(t,n,a,s,l,c,u);if(v){e(t).addClass("alpaca-field-rendering"),e(t).addClass("alpaca-hidden"),i.fieldInstances[v.getId()]=v,v.allFieldInstances=function(){return i.fieldInstances},i.isEmpty(o)&&(o=v.view.render),i.isEmpty(d)&&(d=v.view.postRender);var b=function(){v.parent||v.getFieldEl().addClass("alpaca-"+h.getNormalizedView(l).type),v.parent||v.getFieldEl().addClass("alpaca-top"),e(t).removeClass("alpaca-field-rendering"),e(t).removeClass("alpaca-hidden"),v._oldFieldEl&&e(v._oldFieldEl).remove(),d(v)};i.isEmpty(o)?v.render(function(){b()}):o(v,function(){b()}),v.callback=o,v.renderedCallback=d}},"createFieldInstance":function(e,t,n,a,s,l,r){if(i.isValEmpty(n)&&(n={}),i.isValEmpty(a)&&(a={}),n&&i.isString(n)){var o=n;n={},n.type=o}n.type||(a.type||(a.type=i.getSchemaType(t)),a.type||(t&&i.isArray(t)?a.type="array":a.type="object"),a&&a.enum?a.enum.length>3?n.type="select":n.type="radio":n.type=i.defaultSchemaFieldMapping[a.type],a.format&&i.defaultFormatFieldMapping[a.format]&&(n.type=i.defaultFormatFieldMapping[a.format]));var d=i.getFieldClass(n.type);return d?new d(e,t,n,a,s,l,r):(r({"message":"Unable to find field class for type: "+n.type,"reason":"FIELD_INSTANTIATION_ERROR"}),null)},"parseJSON":function(i){return i?e.parseJSON(i):null},"compile":function(t,n){var a=this,s={"errors":[],"count":0,"successCount":0},l=function(e){if(0===s.errors.length)for(var i in e)a.normalizedViews[i]=e[i];t(s)},r=function(e,i,t,n,a){var r=t.id;s.count++,i?s.errors.push({"view":r,"cacheKey":n,"err":i}):s.successCount++,s.count==a&&l(e)},o=function(t,n,a,s,l,o,d){var c=i.makeCacheKey(n.id,a,s,l),u="text/x-handlebars-template";if(o&&i.isObject(o)&&(u=o.type,o.cacheKey&&(c=o.cacheKey),o=o.template),o&&"string"==typeof o){var h=o.toLowerCase();if(0===h.indexOf("http://")||0===h.indexOf("https://")||0===h.indexOf("/")||0===h.indexOf("./"));else if(!o||0!==o.indexOf("#")&&0!==o.indexOf(".")){if(o){var p=n.templates[o];p&&(o=p)}}else{var f=e(o);u=e(f).attr("type"),o=e(f).html()}}if(!u){i.logError("Engine type was empty");var m=new Error("Engine type was empty");return void r(t,m,n,c,d)}var g=i.TemplateEngineRegistry.find(u);if(!g){i.logError("Cannot find template engine for type: "+type);var m=new Error("Cannot find template engine for type: "+type);return void r(t,m,n,c,d)}if(!0===o){if(g.isCached(c))return void r(t,null,n,c,d);var v="View configuration for view: "+n.id+" claims to have precompiled template for cacheKey: "+c+" but it could not be found";return i.logError(v),void r(t,new Error(v),n,c,d)}if(g.isCached(c))return void r(t,null,n,c,d);g.compile(c,o,function(e){r(t,e,n,c,d)})},d=function(e){var i=[];for(var t in e){var n=e[t];if(n.templates)for(var a in n.templates){var s=n.templates[a];i.push(function(e,i,t,n,a,s){return function(t){o(e,i,"view",n,a,s,t)}}(e,n,0,n.id,a,s))}if(n.fields)for(var l in n.fields)if(n.fields[l].templates)for(var a in n.fields[l].templates){var s=n.fields[l].templates[a];i.push(function(e,i,t,n,a,s){return function(t){o(e,i,"field",n,a,s,t)}}(e,n,0,l,a,s))}if(n.layout&&n.layout.template){var s=n.layout.template;i.push(function(e,i,t,n,a,s){return function(t){o(e,i,"layout","layout","layoutTemplate",s,t)}}(e,n,0,0,0,s))}if(n.globalTemplate){var s=n.globalTemplate;i.push(function(e,i,t,n,a,s){return function(t){o(e,i,"global","global","globalTemplate",s,t)}}(e,n,0,0,0,s))}}for(var r=i.length,d=0;d<i.length;d++)i[d](r)};!function(){var e={},t=0;i.normalizedViews||(i.normalizedViews={}),a.normalizedViews=i.normalizedViews;for(var s in a.views)if(!i.normalizedViews[s]){var r=new i.NormalizedView(s);if(!r.normalize(a.views))return i.throwErrorWithCallback("View normalization failed, cannot initialize Alpaca.  Please check the error logs.",n);e[s]=r,t++}t>0?d(e):l(e)}()},"getTemplateDescriptor":function(e,t,n){var a=null,s=null,l=null;if(e.templates&&e.templates[t]){l=i.makeCacheKey(e.id,"view",e.id,t);var r=e.templates[t];i.isObject(r)&&r.cacheKey&&(l=r.cacheKey)}if(n&&n.path){var o=n.path;if(e&&e.fields&&o&&o.length>1){var d=function(n,a,s){if(a!=n.length){var l=n.slice(),r=!1,o=n[a],c=o.indexOf("[");c>-1&&(o=o.substring(0,c),r=!0),l[a]=o;var u=l.join("/");if(e.fields[u]&&e.fields[u].templates&&e.fields[u].templates[t]){var h=i.makeCacheKey(e.id,"field",u,t);h&&s.push({"path":u,"cacheKey":h})}d(n,a+1,s),r&&d(l,a+1,s)}},c=o.split("/"),u=[];d(c,0,u),u.length>0&&(l=u[0].cacheKey)}}if("globalTemplate"!==t&&"global"!==t||(l=i.makeCacheKey(e.id,"global","global","globalTemplate")),"layoutTemplate"!==t&&"layout"!==t||(l=i.makeCacheKey(e.id,"layout","layout","layoutTemplate")),l){for(var h=i.TemplateEngineRegistry.ids(),p=0;p<h.length;p++){var f=h[p];if(i.TemplateEngineRegistry.find(f).isCached(l)){s=f;break}}s&&(a={"engine":s,"cacheKey":l})}return a},"tmpl":function(e,t){var n=i.tmplHtml(e,t);return i.safeDomParse(n)},"tmplHtml":function(e,t){t||(t={});var n=e.engine,a=i.TemplateEngineRegistry.find(n);if(!a)return i.throwDefaultError("Cannot find template engine for type: "+n);var s=e.cacheKey;return a.execute(s,t,function(e){var t=JSON.stringify(e);return e.message&&(t=e.message),i.throwDefaultError("The compiled template: "+s+" failed to execute: "+t)})}}),i.DEBUG=0,i.INFO=1,i.WARN=2,i.ERROR=3,i.logLevel=i.WARN,i.logDebug=function(e){i.log(i.DEBUG,e)},i.logInfo=function(e){i.log(i.INFO,e)},i.logWarn=function(e){i.log(i.WARN,e)},i.logError=function(e){i.log(i.ERROR,e)},i.LOG_METHOD_MAP={"0":"debug","1":"info","2":"warn","3":"error"},i.log=function(e,t){if(i.logLevel<=e){var n=i.LOG_METHOD_MAP[e];"undefined"!=typeof console&&console[n]&&("debug"===n?console.debug(t):"info"===n?console.info(t):"warn"===n?console.warn(t):"error"===n?console.error(t):console.log(t))}},i.checked=function(e,t){return i.attrProp(e,"checked",t)},i.readonly=function(t,n){return e(t).prop("readonly",!1),i.attrProp(t,"readonly",n)},i.disabled=function(e,t){return i.attrProp(e,"disabled",t)},i.attrProp=function(i,t,n){return void 0!==n&&(e(i).prop?e(i).prop(t,n):n?e(i).attr(t,n):e(i).removeAttr(t)),e(i).prop?e(i).prop(t):e(i).attr(t)},i.loadRefSchemaOptions=function(e,t,n){if(t)if("#"===t)n(e.schema,e.options);else if(0===t.indexOf("#/")){for(var a=t.substring(2),s=a.split("/"),l=e.schema,r=0;r<s.length;r++){var o=s[r];if(l[o])l=l[o];else if(l.properties&&l.properties[o])l=l.properties[o];else{if(!l.definitions||!l.definitions[o]){l=null;break}l=l.definitions[o]}}for(var d=e.options,r=0;r<s.length;r++){var o=s[r];if(d[o])d=d[o];else if(d.fields&&d.fields[o])d=d.fields[o];else{if(!d.definitions||!d.definitions[o]){d=null;break}d=d.definitions[o]}}n(l,d)}else if(0===t.indexOf("#")){var c=i.resolveReference(e.schema,e.options,t);c?n(c.schema,c.options):n()}else{var u=i.pathParts(t);e.connector.loadReferenceSchema(u.path,function(t){e.connector.loadReferenceOptions(u.path,function(e){if(u.id){var a=i.resolveReference(t,e,u.id);a&&(t=a.schema,e=a.options)}n(t,e)},function(){n(t)})},function(){n()})}else n()},i.DEFAULT_ERROR_CALLBACK=function(e){if(e&&e.message)throw i.logError(JSON.stringify(e)),new Error("Alpaca caught an error with the default error handler: "+JSON.stringify(e))},i.defaultErrorCallback=i.DEFAULT_ERROR_CALLBACK,i.throwDefaultError=function(e){e&&i.isObject(e)&&(e=JSON.stringify(e));var t={"message":e};i.defaultErrorCallback(t)},i.throwErrorWithCallback=function(e,t){e&&i.isObject(e)&&(e=JSON.stringify(e));var n={"message":e};t?t(n):i.defaultErrorCallback(n)},i.resolveReference=function(e,t,n){if(e.id===n||"#"+e.id===n){var a={};return e&&(a.schema=e),t&&(a.options=t),a}if(e&&e.properties)for(var s in e.properties){var l=e.properties[s],r=null;t&&t.fields&&t.fields[s]&&(r=t.fields[s]);var o=i.resolveReference(l,r,n);if(o)return o}return null},e.alpaca=window.Alpaca=i,e.fn.alpaca=function(){var t=i.makeArray(arguments),n=[].concat(this,t),a=i.apply(this,n);return void 0===a&&(a=e(this)),a},e.fn.outerHTML=function(i){return i?e("<div></div>").append(this).html():e("<div></div>").append(this.clone()).html()},e.fn.swapWith=function(i){return this.each(function(){var t=e(i).clone(),n=e(this).clone();e(i).replaceWith(n),e(this).replaceWith(t)})},e.fn.attrProp=function(t,n){return i.attrProp(e(this),t,n)},e.event.special.destroyed={"remove":function(e){e.handler&&e.handler()}},i.pathParts=function(e){if("string"!=typeof e)return e;var t=e,n=null,a=t.indexOf("#");a>-1&&(n=t.substring(a+1),t=t.substring(0,a)),i.endsWith(t,"/")&&(t=t.substring(0,t.length-1));var s={};return s.path=t,n&&(s.id=n),s},i.resolveField=function(e,t){var n=null;if("string"==typeof t)if(0===t.indexOf("#/")&&propertyId.length>2);else if("#"===t||"#/"===t)n=e;else if(0===t.indexOf("#")){for(var a=e;a.parent;)a=a.parent;var s=t.substring(1);n=i.resolveFieldByReference(a,s)}else n=e.childrenByPropertyId[t];return n},i.resolveFieldByReference=function(e,t){if(e.schema&&e.schema.id==t)return e;if(e.children&&e.children.length>0)for(var n=0;n<e.children.length;n++){var a=e.children[n],s=i.resolveFieldByReference(a,t);if(s)return s}return null},i.anyEquality=function(e,t){var n={};if("object"==typeof e||i.isArray(e))for(var a in e)n[e[a]]=!0;else n[e]=!0;var s=!1;if("object"==typeof t||i.isArray(t))for(var a in t){var l=t[a];if(n[l]){s=!0;break}}else s=n[t];return s},i.series=function(e,i){async.series(e,function(){i()})},i.parallel=function(e,i){async.parallel(e,function(){i()})},i.nextTick=function(e){async.nextTick(function(){e()})},i.compileValidationContext=function(e,i){var t=[],n=e;do{n.isValidationParticipant()||(n=null),n&&t.push(n),n&&(n=n.parent)}while(n);t.reverse();var a=[],s=function(e,i,t){if(!e||0===e.length)return void t();var n=e[0],a={};a.id=n.getId(),a.field=n,a.path=n.path;var l=n.isValid();n.isContainer()&&(l=n.isValid(!0)),a.before=l;var r=function(e,t,n){var a=e._previouslyValidated;e.validate(),e._validateCustomValidator(function(){var s=e.isValid();e.isContainer()&&(s=e.isValid(!0)),t.after=s,t.validated=!1,t.invalidated=!1,!l&&s?t.validated=!0:l&&!s?t.invalidated=!0:a||s||(t.invalidated=!0),t.container=e.isContainer(),t.valid=t.after,i.push(t),n()})};if(e.length>1){var o=e.slice(0);o.shift(),s(o,i,function(){r(n,a,function(){t()})})}else r(n,a,function(){t()})};s(t,a,function(){i(a)})},i.updateValidationStateForContext=function(e,t){for(var n=0;n<t.length;n++){var a=t[n],s=a.field;if(s.getFieldEl().removeClass("alpaca-invalid alpaca-invalid-hidden alpaca-valid"),s.fireCallback("clearValidity"),a.valid)s.getFieldEl().addClass("alpaca-field-valid"),s.fireCallback("valid");else if(s.options.readonly)i.logWarn("The field (id="+s.getId()+", title="+s.getTitle()+", path="+s.path+") is invalid and also read-only");else{var l=!1;s.hideInitValidationError&&(l=!0),s.fireCallback("invalid",l),s.getFieldEl().addClass("alpaca-invalid"),l&&s.getFieldEl().addClass("alpaca-invalid-hidden")}if(a.validated?i.later(25,this,function(){s.trigger("validated")}):a.invalidated&&i.later(25,this,function(){s.trigger("invalidated")}),s.options.showMessages&&!s.initializing&&!s.options.readonly){var r=[];for(var o in s.validation)s.validation[o].status||r.push({"id":o,"message":s.validation[o].message});s.displayMessage(r,s.valid)}}},i.fieldApplyFieldAndChildren=function(e,t){if(t(e),e.children&&e.children.length>0)for(var n=0;n<e.children.length;n++)i.fieldApplyFieldAndChildren(e.children[n],t)},i.replaceAll=function(e,i,t){return e.replace(new RegExp(i,"g"),t)},i.asArray=function(e){if(!i.isArray(e)){var t=[];return t.push(e),t}return e},function(){function e(e){var i=!1;return function(){if(i)throw new Error("Callback was already called.");i=!0,e.apply(n,arguments)}}function i(e){return e.constructor===String?"string":e.constructor===Boolean?"boolean":e.constructor===Number?isNaN(e)?"nan":"number":void 0===e?"undefined":null===e?"null":e instanceof Array?"array":e instanceof Date?"date":e instanceof RegExp?"regexp":"object"==typeof e?"object":e instanceof Function?"function":void 0}function t(e,t,n){var a=i(e);if(a)return"function"===i(t[a])?t[a].apply(t,n):t[a]}var n,a,s={};n=this,null!=n&&(a=n.async),s.noConflict=function(){return n.async=a,s};var l=function(e,i){if(e.forEach)return e.forEach(i);for(var t=0;t<e.length;t+=1)i(e[t],t,e)},r=function(e,i){if(e.map)return e.map(i);var t=[];return l(e,function(e,n,a){t.push(i(e,n,a))}),t},o=function(e,i,t){return e.reduce?e.reduce(i,t):(l(e,function(e,n,a){t=i(t,e,n,a)}),t)},d=function(e){if(Object.keys)return Object.keys(e);var i=[];for(var t in e)e.hasOwnProperty(t)&&i.push(t);return i};"undefined"!=typeof process&&process.nextTick?(s.nextTick=process.nextTick,"undefined"!=typeof setImmediate?s.setImmediate=function(e){setImmediate(e)}:s.setImmediate=s.nextTick):"function"==typeof setImmediate?(s.nextTick=function(e){setImmediate(e)},s.setImmediate=s.nextTick):(s.nextTick=function(e){setTimeout(e,0)},s.setImmediate=s.nextTick),s.each=function(i,t,n){if(n=n||function(){},!i.length)return n();var a=0;l(i,function(s){t(s,e(function(e){e?(n(e),n=function(){}):(a+=1)>=i.length&&n(null)}))})},s.forEach=s.each,s.eachSeries=function(e,i,t){if(t=t||function(){},!e.length)return t();var n=0,a=function(){i(e[n],function(i){i?(t(i),t=function(){}):(n+=1,n>=e.length?t(null):a())})};a()},s.forEachSeries=s.eachSeries,s.eachLimit=function(e,i,t,n){c(i).apply(null,[e,t,n])},s.forEachLimit=s.eachLimit;var c=function(e){return function(i,t,n){if(n=n||function(){},!i.length||e<=0)return n();var a=0,s=0,l=0;!function r(){if(a>=i.length)return n();for(;l<e&&s<i.length;)s+=1,l+=1,t(i[s-1],function(e){e?(n(e),n=function(){}):(a+=1,l-=1,a>=i.length?n():r())})}()}},u=function(e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[s.each].concat(i))}},h=function(e,i){return function(){var t=Array.prototype.slice.call(arguments);return i.apply(null,[c(e)].concat(t))}},p=function(e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[s.eachSeries].concat(i))}},f=function(e,i,t,n){var a=[];i=r(i,function(e,i){return{"index":i,"value":e}}),e(i,function(e,i){t(e.value,function(t,n){a[e.index]=n,i(t)})},function(e){n(e,a)})};s.map=u(f),s.mapSeries=p(f),s.mapLimit=function(e,i,t,n){return m(i)(e,t,n)};var m=function(e){return h(e,f)};s.reduce=function(e,i,t,n){s.eachSeries(e,function(e,n){t(i,e,function(e,t){i=t,n(e)})},function(e){n(e,i)})},s.inject=s.reduce,s.foldl=s.reduce,s.reduceRight=function(e,i,t,n){var a=r(e,function(e){return e}).reverse();s.reduce(a,i,t,n)},s.foldr=s.reduceRight;var g=function(e,i,t,n){var a=[];i=r(i,function(e,i){return{"index":i,"value":e}}),e(i,function(e,i){t(e.value,function(t){t&&a.push(e),i()})},function(e){n(r(a.sort(function(e,i){return e.index-i.index}),function(e){return e.value}))})};s.filter=u(g),s.filterSeries=p(g),s.select=s.filter,s.selectSeries=s.filterSeries;var v=function(e,i,t,n){var a=[];i=r(i,function(e,i){return{"index":i,"value":e}}),e(i,function(e,i){t(e.value,function(t){t||a.push(e),i()})},function(e){n(r(a.sort(function(e,i){return e.index-i.index}),function(e){return e.value}))})};s.reject=u(v),s.rejectSeries=p(v);var b=function(e,i,t,n){e(i,function(e,i){t(e,function(t){t?(n(e),n=function(){}):i()})},function(e){n()})};s.detect=u(b),s.detectSeries=p(b),s.some=function(e,i,t){s.each(e,function(e,n){i(e,function(e){e&&(t(!0),t=function(){}),n()})},function(e){t(!1)})},s.any=s.some,s.every=function(e,i,t){s.each(e,function(e,n){i(e,function(e){e||(t(!1),t=function(){}),n()})},function(e){t(!0)})},s.all=s.every,s.sortBy=function(e,i,t){s.map(e,function(e,t){i(e,function(i,n){i?t(i):t(null,{"value":e,"criteria":n})})},function(e,i){if(e)return t(e);var n=function(e,i){var t=e.criteria,n=i.criteria;return t<n?-1:t>n?1:0};t(null,r(i.sort(n),function(e){return e.value}))})},s.auto=function(e,i){i=i||function(){};var t=d(e);if(!t.length)return i(null);var n={},a=[],r=function(e){a.unshift(e)},c=function(e){for(var i=0;i<a.length;i+=1)if(a[i]===e)return void a.splice(i,1)},u=function(){l(a.slice(0),function(e){e()})};r(function(){d(n).length===t.length&&(i(null,n),i=function(){})}),l(t,function(t){var a=e[t]instanceof Function?[e[t]]:e[t],h=function(e){var a=Array.prototype.slice.call(arguments,1);if(a.length<=1&&(a=a[0]),e){var r={};l(d(n),function(e){r[e]=n[e]}),r[t]=a,i(e,r),i=function(){}}else n[t]=a,s.setImmediate(u)},p=a.slice(0,Math.abs(a.length-1))||[],f=function(){return o(p,function(e,i){return e&&n.hasOwnProperty(i)},!0)&&!n.hasOwnProperty(t)};if(f())a[a.length-1](h,n);else{var m=function(){f()&&(c(m),a[a.length-1](h,n))};r(m)}})},s.waterfall=function(e,i){if(i=i||function(){},e.constructor!==Array){var t=new Error("First argument to waterfall must be an array of functions");return i(t)}if(!e.length)return i();var n=function(e){return function(t){if(t)i.apply(null,arguments),i=function(){};else{var a=Array.prototype.slice.call(arguments,1),l=e.next();l?a.push(n(l)):a.push(i),s.setImmediate(function(){e.apply(null,a)})}}};n(s.iterator(e))()};var y=function(e,i,t){if(t=t||function(){},i.constructor===Array)e.map(i,function(e,i){e&&e(function(e){var t=Array.prototype.slice.call(arguments,1);t.length<=1&&(t=t[0]),i.call(null,e,t)})},t);else{var n={};e.each(d(i),function(e,t){i[e](function(i){var a=Array.prototype.slice.call(arguments,1);a.length<=1&&(a=a[0]),n[e]=a,t(i)})},function(e){t(e,n)
})}};s.parallel=function(e,i){y({"map":s.map,"each":s.each},e,i)},s.parallelLimit=function(e,i,t){y({"map":m(i),"each":c(i)},e,t)},s.series=function(e,i){if(i=i||function(){},e.constructor===Array)s.mapSeries(e,function(e,i){e&&e(function(e){var t=Array.prototype.slice.call(arguments,1);t.length<=1&&(t=t[0]),i.call(null,e,t)})},i);else{var t={};s.eachSeries(d(e),function(i,n){e[i](function(e){var a=Array.prototype.slice.call(arguments,1);a.length<=1&&(a=a[0]),t[i]=a,n(e)})},function(e){i(e,t)})}},s.iterator=function(e){var i=function(t){var n=function(){return e.length&&e[t].apply(null,arguments),n.next()};return n.next=function(){return t<e.length-1?i(t+1):null},n};return i(0)},s.apply=function(e){var i=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,i.concat(Array.prototype.slice.call(arguments)))}};var w=function(e,i,t,n){var a=[];e(i,function(e,i){t(e,function(e,t){a=a.concat(t||[]),i(e)})},function(e){n(e,a)})};s.concat=u(w),s.concatSeries=p(w),s.whilst=function(e,i,t){e()?i(function(n){if(n)return t(n);s.whilst(e,i,t)}):t()},s.doWhilst=function(e,i,t){e(function(n){if(n)return t(n);i()?s.doWhilst(e,i,t):t()})},s.until=function(e,i,t){e()?t():i(function(n){if(n)return t(n);s.until(e,i,t)})},s.doUntil=function(e,i,t){e(function(n){if(n)return t(n);i()?t():s.doUntil(e,i,t)})},s.queue=function(i,t){function n(e,i,n,a){i.constructor!==Array&&(i=[i]),l(i,function(i){var l={"data":i,"callback":"function"==typeof a?a:null};n?e.tasks.unshift(l):e.tasks.push(l),e.saturated&&e.tasks.length===t&&e.saturated(),s.setImmediate(e.process)})}void 0===t&&(t=1);var a=0,r={"tasks":[],"concurrency":t,"saturated":null,"empty":null,"drain":null,"push":function(e,i){n(r,e,!1,i)},"unshift":function(e,i){n(r,e,!0,i)},"process":function(){if(a<r.concurrency&&r.tasks.length){var t=r.tasks.shift();r.empty&&0===r.tasks.length&&r.empty(),a+=1;var n=function(){a-=1,t.callback&&t.callback.apply(t,arguments),r.drain&&r.tasks.length+a===0&&r.drain(),r.process()},s=e(n);i(t.data,s)}},"length":function(){return r.tasks.length},"running":function(){return a}};return r},s.cargo=function(e,i){var t=!1,n=[],a={"tasks":n,"payload":i,"saturated":null,"empty":null,"drain":null,"push":function(e,t){e.constructor!==Array&&(e=[e]),l(e,function(e){n.push({"data":e,"callback":"function"==typeof t?t:null}),a.saturated&&n.length===i&&a.saturated()}),s.setImmediate(a.process)},"process":function s(){if(!t){if(0===n.length)return void(a.drain&&a.drain());var o="number"==typeof i?n.splice(0,i):n.splice(0),d=r(o,function(e){return e.data});a.empty&&a.empty(),t=!0,e(d,function(){t=!1;var e=arguments;l(o,function(i){i.callback&&i.callback.apply(null,e)}),s()})}},"length":function(){return n.length},"running":function(){return t}};return a};var F=function(e){return function(i){var t=Array.prototype.slice.call(arguments,1);i.apply(null,t.concat([function(i){var t=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(i?console.error&&console.error(i):console[e]&&l(t,function(i){console[e](i)}))}]))}};s.log=F("log"),s.dir=F("dir"),s.memoize=function(e,i){var t={},n={};i=i||function(e){return e};var a=function(){var a=Array.prototype.slice.call(arguments),s=a.pop(),l=i.apply(null,a);l in t?s.apply(null,t[l]):l in n?n[l].push(s):(n[l]=[s],e.apply(null,a.concat([function(){t[l]=arguments;var e=n[l];delete n[l];for(var i=0,a=e.length;i<a;i++)e[i].apply(null,arguments)}])))};return a.memo=t,a.unmemoized=e,a},s.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},s.times=function(e,i,t){for(var n=[],a=0;a<e;a++)n.push(a);return s.map(n,i,t)},s.timesSeries=function(e,i,t){for(var n=[],a=0;a<e;a++)n.push(a);return s.mapSeries(n,i,t)},s.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var i=this,t=Array.prototype.slice.call(arguments),n=t.pop();s.reduce(e,t,function(e,t,n){t.apply(i,e.concat([function(){var e=arguments[0],i=Array.prototype.slice.call(arguments,1);n(e,i)}]))},function(e,t){n.apply(i,[e].concat(t))})}};var C=function(e,i){var t=function(){var t=this,n=Array.prototype.slice.call(arguments),a=n.pop();return e(i,function(e,i){e.apply(t,n.concat([i]))},a)};if(arguments.length>2){return t.apply(this,Array.prototype.slice.call(arguments,2))}return t};s.applyEach=u(C),s.applyEachSeries=p(C),s.forever=function(e,i){function t(n){if(n){if(i)return i(n);throw n}e(t)}t()},n.async=s;n.equiv=function(){var e,n=[],a=function(){function t(e,i){return e instanceof i.constructor||i instanceof e.constructor?i==e:i===e}return{"string":t,"boolean":t,"number":t,"null":t,"undefined":t,"nan":function(e){return isNaN(e)},"date":function(e,t){return"date"===i(e)&&t.valueOf()===e.valueOf()},"regexp":function(e,t){return"regexp"===i(e)&&t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline},"function":function(){var e=n[n.length-1];return e!==Object&&void 0!==e},"array":function(t,n){var a,s;if("array"!==i(t))return!1;if((s=n.length)!==t.length)return!1;for(a=0;a<s;a++)if(!e(n[a],t[a]))return!1;return!0},"object":function(i,t){var a,s=!0,l=[],r=[];if(t.constructor!==i.constructor)return!1;n.push(t.constructor);for(a in t)l.push(a),e(t[a],i[a])||(s=!1);n.pop();for(a in i)r.push(a);return s&&e(l.sort(),r.sort())}}}();return e=function(){var e=Array.prototype.slice.apply(arguments);return e.length<2||function(e,n){return e===n||null!==e&&null!==n&&void 0!==e&&void 0!==n&&i(e)===i(n)&&t(e,a,[n,e])}(e[0],e[1])&&arguments.callee.apply(this,e.splice(1,e.length-1))}}()}(),i.MARKER_CLASS_CONTROL_FIELD="alpaca-marker-control-field",i.MARKER_CLASS_CONTAINER_FIELD="alpaca-marker-container-field",i.MARKER_CLASS_CONTAINER_FIELD_ITEM="alpaca-marker-control-field-item",i.MARKER_DATA_CONTAINER_FIELD_ITEM_KEY="data-alpaca-container-field-item-key",i.MARKER_CLASS_FORM_ITEMS_FIELD="alpaca-marker-form-items-field",i.CLASS_CONTAINER="alpaca-container",i.CLASS_CONTROL="alpaca-control",i.MARKER_CLASS_INSERT="alpaca-marker-insert",i.MARKER_DATA_INSERT_KEY="data-alpaca-marker-insert-key",i.MARKER_CLASS_ARRAY_TOOLBAR="alpaca-marker-array-field-toolbar",i.MARKER_DATA_ARRAY_TOOLBAR_FIELD_ID="data-alpaca-array-field-toolbar-field-id",i.MARKER_CLASS_ARRAY_ITEM_ACTIONBAR="alpaca-marker-array-field-item-actionbar",i.MARKER_DATA_ARRAY_ITEM_KEY="data-alpaca-marker-array-field-item-key",i.MARKER_DATA_ARRAY_ITEM_PARENT_FIELD_ID="data-alpaca-marker-array-field-item-parent-field-id",i.MARKER_CLASS_CONTAINER_FIELD_ITEM_FIELD="alpaca-marker-container-field-item-field",i.makeCacheKey=function(e,i,t,n){return e+":"+i+":"+t+":"+n},i.splitCacheKey=function(e){var i={},t=e.indexOf(":"),n=e.lastIndexOf(":");i.viewId=e.substring(0,t),i.templateId=e.substring(n+1);var a=e.substring(t+1,n),s=a.indexOf(":");return i.scopeType=a.substring(0,s),i.scopeId=a.substring(s+1),i},i.createEmptyDataInstance=function(e){return""},i.animatedSwap=function(i,t,n,a){"function"==typeof n&&(a=n,n=500);!function(i,t,n,a){var s=e(i),l=e(t),r=s.offset(),o=l.offset(),d=s.clone(),c=l.clone(),u=o.top+l.height()-r.top,h=0,p=0,f=o.left+l.width()-r.left,m=0,g=0;s.css("opacity",0),l.css("opacity",0),d.insertAfter(s).css({"position":"absolute","width":s.outerWidth(),"height":s.outerHeight()}).offset(r).css("z-index","999"),c.insertAfter(l).css({"position":"absolute","width":l.outerWidth(),"height":l.outerHeight()}).offset(o).css("z-index","999"),r.top!==o.top&&(h=u-s.height()),p=u-l.height(),r.left!==o.left&&(m=f-s.width()),g=f-l.width(),d.animate({"top":"+="+h+"px","left":"+="+m+"px"},n,function(){l.css("opacity",1),e(this).remove()}),c.animate({"top":"-="+p+"px","left":"-="+g+"px"},n,function(){s.css("opacity",1),e(this).remove()}),window.setTimeout(function(){d.remove(),c.remove(),a()},n+1)}(i,t,n,a)},i.readCookie=function(e){var i=null;return"undefined"!=typeof document&&(i=function(e){for(var i=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var a=t[n];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(i))return a.substring(i.length,a.length)}return null}(e)),i},i.CSRF_TOKEN=null,i.CSRF_COOKIE_NAMES=["CSRF-TOKEN","XSRF-TOKEN"],i.CSRF_HEADER_NAME="X-CSRF-TOKEN"}(jQuery),function(e){var i=e.alpaca;i.listenerId=function(){var e=0;return function(){return"listener-"+e++}}(),i.subscribe=function(){var e=i.makeArray(arguments),t=null,n=null,a=null;if(2==e.length?(t="global",n=e.shift(),a=e.shift()):(t=e.shift(),n=e.shift(),a=e.shift()),n&&i.isObject(n)&&(n=n.path),!n)return i.logError("Missing observable subscribe id: "+n),null;var s=a._lfid;s||(s=i.listenerId(),a._lfid=s);var l=function(e){return function(){return a.apply(e,arguments)}}(this);return l._lfid=a._lfid,i.ScopedObservables.get(t).observable(n).subscribe(s,l),{"scope":t,"id":n,"listenerId":s}},i.unsubscribe=function(){var e=i.makeArray(arguments),t=null,n=null,a=null;2==e.length?(t="global",n=e.shift(),a=e.shift()):3==e.length&&(t=e.shift(),n=e.shift(),a=e.shift());var s=a;return i.isFunction(s)&&(s=s._lfid),n&&i.isObject(n)&&(n=n.path),n?(i.ScopedObservables.get(t).observable(n).unsubscribe(s),{"scope":t,"id":n,"listenerId":s}):(i.logError("Missing observable id: "+n),null)},i.observable=function(){var e,t,n=i.makeArray(arguments);if(1==n.length?(e="global",t=n.shift()):2==n.length&&(e=n.shift(),t=n.shift()),t&&i.isObject(t)&&(t=t.path),t){var a=i.ScopedObservables.get(e);observable=a.observable(t)}else i.logError("Missing observable id: "+JSON.stringify(n));return observable},i.clearObservable=function(){var e,t,n=i.makeArray(arguments);1==n.length?(e="global",t=n.shift()):2==n.length&&(e=n.shift(),t=n.shift()),t&&i.isObject(t)&&(t=t.path),t||i.logError("Missing observable id: "+JSON.stringify(n)),i.ScopedObservables.get(e).observable(t).clear()},i.dependentObservable=function(){var e=null,t=null,n=null,a=i.makeArray(arguments);if(2==a.length)e="global",t=a.shift(),n=a.shift();else{if(3!=a.length)return void i.error("Wrong number of arguments");e=a.shift(),t=a.shift(),n=a.shift()}return t&&i.isObject(t)&&(t=t.path),t||i.logError("Missing observable id: "+JSON.stringify(a)),i.ScopedObservables.get(e).dependentObservable(t,n)}}(jQuery),function(e){var i=e.alpaca;i.Observables=Base.extend({"constructor":function(e){this.base(),this.scope=e,this.observables={}},"observable":function(e,t){if(!this.observables[e]){var n=new i.Observable(this.scope,e);t&&n.set(t),this.observables[e]=n}return this.observables[e]},"dependentObservable":function(e,t){var n=this;if(!this.observables[e]){var a=this.observable(e),s=new i.Observables(this.scope);s.observable=function(e,i){var t=n.observable(e,i);return t.markDependentOnUs(a),t};var l=function(){return t.call(s)};a.setValueFunction(l)}return this.observables[e]},"observables":function(){return this.observables}})}(jQuery),function(e){e.alpaca.Observable=Base.extend({"constructor":function(i,t){this.base(),this.id=i+"-"+t,this.value=null,this.subscribers={},this.dependentOnUs={},this.notifySubscribers=function(i){var t=this;e.each(this.subscribers,function(e,n){n(t.value,i)})},this.notifyDependents=function(i){e.each(this.dependentOnUs,function(e,i){i.onDependencyChange()})},this.valueFunction=null},"setValueFunction":function(e){this.valueFunction=e,this.onDependencyChange()},"subscribe":function(e,i){this.isSubscribed(e)||(this.subscribers[e]=i)},"unsubscribe":function(e){delete this.subscribers[e]},"isSubscribed":function(e){return!!this.subscribers[e]},"markDependentOnUs":function(e){this.dependentOnUs[e.id]=e},"onDependencyChange":function(){var e=this.get();if(this.valueFunction){var i=this.valueFunction();e!=i&&this.set(i)}},"set":function(e){var i=this.value;this.value=e,this.notifyDependents(i),this.notifySubscribers(i)},"get":function(e){var i=this.value;return i||(i=e),i},"clear":function(){var e=this.value;delete this.value,this.notifyDependents(e),this.notifySubscribers(e)}})}(jQuery),function(e){var i=e.alpaca;i.ScopedObservables={},i.ScopedObservables.map={},i.ScopedObservables.get=function(e){return i.ScopedObservables.map[e]||(i.ScopedObservables.map[e]=new i.Observables(e)),i.ScopedObservables.map[e]}}(jQuery),function(){Alpaca.TemplateEngineRegistry=function(){var e={};return{"register":function(i,t){e[i]=t,t.init()},"find":function(i){var t=null;if(e[i])t=e[i];else for(var n in e)for(var a=e[n].supportedMimetypes(),s=0;s<a.length;s++)if(i.toLowerCase()===a[s].toLowerCase()){t=e[n];break}return t},"ids":function(){var i=[];for(var t in e)i.push(t);return i}}}()}(),function(e){Alpaca.AbstractTemplateEngine=Base.extend({"constructor":function(e){this.base(),this.id=e,this.cleanup=function(e){if(e){var i=document.createElement("div");i.innerHTML=e;var t=i.children;if(1===t.length){var n=t[0];if("SCRIPT"===n.tagName)return n.innerHTML}}return e}},"compile":function(i,t,n){var a=this,s="html";if(Alpaca.isString(t)){var l=t.toLowerCase();0===l.indexOf("http://")||0===l.indexOf("https://")||0===l.indexOf("./")||0===l.indexOf("/")||0===l.indexOf("../")?s="uri":0!==t.indexOf("#")&&0!==t.indexOf(".")&&0!==t.indexOf("[")||(s="selector")}if("selector"===s)a._compile(i,t,function(e){n(e)});else if("uri"===s){var r=a.fileExtension(),o=t;-1===o.indexOf("."+r)&&(o+="."+r),e.ajax({"url":o,"dataType":"html","success":function(e,t,s){e=a.cleanup(e),a._compile(i,e,function(e){n(e)})},"error":function(e,i){n({"message":e.responseText,"xhr":e,"code":i},null)}})}else if("html"===s){var d=t;d instanceof jQuery&&(d=e(d).outerHTML()),a._compile(i,d,function(e){n(e)})}else n(new Error("Template engine cannot determine how to handle type: "+s))},"_compile":function(e,i,t){Alpaca.isEmpty(i)&&(i=""),i=Alpaca.trim(i),0===i.toLowerCase().indexOf("<script")||(i="<script type='"+this.supportedMimetypes()[0]+"'>"+i+"<\/script>"),Alpaca.logDebug("Compiling template: "+this.id+", cacheKey: "+e+", template: "+i),this.doCompile(e,i,t)},"doCompile":function(e,i,t){},"execute":function(e,i,t){Alpaca.logDebug("Executing template for cache key: "+e);var n=this.doExecute(e,i,t);return n=this.cleanup(n)},"doExecute":function(e,i,t){return null},"fileExtension":function(){return"html"},"supportedMimetypes":function(){return[]},"isCached":function(e){return!1},"findCacheKeys":function(e){return[]}})}(jQuery),function($,Handlebars,HandlebarsPrecompiled){var COMPILED_TEMPLATES={},helpers={};helpers.compare=function(e,i,t){if(arguments.length<3)throw new Error("Handlerbars Helper 'compare' needs 2 parameters");var n=t.hash.operator||"==",a={"==":function(e,i){return e==i},"===":function(e,i){return e===i},"!=":function(e,i){return e!=i},"!==":function(e,i){return e!==i},"<":function(e,i){return e<i},">":function(e,i){return e>i},"<=":function(e,i){return e<=i},">=":function(e,i){return e>=i},"typeof":function(e,i){return typeof e==i}};if(!a[n])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+n);return a[n](e,i)?t.fn(this):t.inverse(this)},helpers.ifnot=function(e,i){return e?i.inverse(this):i.fn(this)},helpers.times=function(e,i){for(var t="",n=0;n<e;++n)t+=i.fn(n);return t},helpers.control=function(e){return"<div class='"+Alpaca.MARKER_CLASS_CONTROL_FIELD+"'></div>"},helpers.container=function(e){return"<div class='"+Alpaca.MARKER_CLASS_CONTAINER_FIELD+"'></div>"},helpers.item=function(e,i){return Alpaca.isObject(e)&&(e,e="div"),"<"+e+" class='"+Alpaca.MARKER_CLASS_CONTAINER_FIELD_ITEM+"' "+Alpaca.MARKER_DATA_CONTAINER_FIELD_ITEM_KEY+"='"+this.name+"'></"+e+">"},helpers.itemField=function(e,i){return Alpaca.isObject(e)&&(e,e="div"),"<"+e+" class='"+Alpaca.MARKER_CLASS_CONTAINER_FIELD_ITEM_FIELD+"'></"+e+">"},helpers.formItems=function(e){return"<div class='"+Alpaca.MARKER_CLASS_FORM_ITEMS_FIELD+"'></div>"},helpers.insert=function(e){return"<div class='"+Alpaca.MARKER_CLASS_INSERT+"' "+Alpaca.MARKER_DATA_INSERT_KEY+"='"+e+"'></div>"},helpers.str=function(e){return!1===e?"false":!0===e?"true":0===e?"0":void 0===e?"":null===e?"":Alpaca.isString(e)?e:Alpaca.isNumber(e)?e:Alpaca.isObject(e)?JSON.stringify(e,null,"  "):Alpaca.isArray(e)?JSON.stringify(e,null,"  "):e},helpers.arrayToolbar=function(e){return"<div class='"+Alpaca.MARKER_CLASS_ARRAY_TOOLBAR+"' "+Alpaca.MARKER_DATA_ARRAY_TOOLBAR_FIELD_ID+"='"+this.id+"'></div>"},helpers.arrayActionbar=function(e){return"<div class='"+Alpaca.MARKER_CLASS_ARRAY_ITEM_ACTIONBAR+"' "+Alpaca.MARKER_DATA_ARRAY_ITEM_KEY+"='"+this.name+"' "+Alpaca.MARKER_DATA_ARRAY_ITEM_PARENT_FIELD_ID+"='"+this.parentFieldId+"'></div>"},Handlebars.registerHelper("arrayToolbar",helpers.arrayToolbar),Handlebars.registerHelper("arrayActionbar",helpers.arrayActionbar),Handlebars.registerHelper("setIndex",function(e){this.index=Number(e)}),Handlebars.registerHelper("eachProperty",function(e,i){var t="";for(var n in e)t+=i.fn({"key":n,"value":e[n]});return t}),Handlebars.registerHelper("uploadErrorMessage",function(e){var i=e;return 1===e?i="File exceeds upload_max_filesize":2===e?i="File exceeds MAX_FILE_SIZE":3===e?i="File was only partially uploaded":4===e?i="No File was uploaded":5===e?i="Missing a temporary folder":6===e?i="Failed to write file to disk":7===e?i="File upload stopped by extension":"maxFileSize"===e?i="File is too big":"minFileSize"===e?i="File is too small":"acceptFileTypes"===e?i="Filetype not allowed":"maxNumberOfFiles"===e?i="Max number of files exceeded":"uploadedBytes"===e?i="Uploaded bytes exceed file size":"emptyResult"===e&&(i="Empty file upload result"),i}),Handlebars.registerHelper("compare",helpers.compare),Handlebars.registerHelper("control",helpers.control),Handlebars.registerHelper("container",helpers.container),Handlebars.registerHelper("item",helpers.item),Handlebars.registerHelper("itemField",helpers.itemField),Handlebars.registerHelper("formItems",helpers.formItems),Handlebars.registerHelper("times",helpers.times),Handlebars.registerHelper("str",helpers.str),Handlebars.registerHelper("with",function(e,i){return i.fn(e)}),Handlebars.registerHelper("ifnot",helpers.ifnot);var partials={};Alpaca.HandlebarsTemplateEngine=Alpaca.AbstractTemplateEngine.extend({"fileExtension":function(){return"html"},"supportedMimetypes":function(){return["text/x-handlebars-template","text/x-handlebars-tmpl"]},"init":function(){if(HandlebarsPrecompiled)for(var e in HandlebarsPrecompiled){var i=HandlebarsPrecompiled[e];for(var t in i){var n=i[t];if("function"==typeof n){var a=Alpaca.makeCacheKey(e,"view",e,t);COMPILED_TEMPLATES[a]=n}}}},"doCompile":function(cacheKey,html,callback){var self=this,template=null;try{var functionString=Handlebars.precompile(html);template=eval("("+functionString+")"),template=Handlebars.template(template),COMPILED_TEMPLATES[cacheKey]=template}catch(e){return void callback(e)}callback()},"doExecute":function(e,i,t){var n=COMPILED_TEMPLATES[e];if(!n)return void t(new Error("Could not find handlebars cached template for key: "+e));var a=null;try{a=n(i)}catch(e){return t(e),null}return a},"isCached":function(e){return!!COMPILED_TEMPLATES[e]},"findCacheKeys":function(e){var i=[];for(var t in COMPILED_TEMPLATES)0===t.indexOf(e+":")&&i.push(t);return i}}),Alpaca.TemplateEngineRegistry.register("handlebars",new Alpaca.HandlebarsTemplateEngine("handlebars"))}(jQuery,void 0!==Handlebars?Handlebars:window.Handlebars,"undefined"!=typeof HandlebarsPrecompiled?HandlebarsPrecompiled:window.HandlebarsPrecompiled),function(e){var i=e.alpaca;i.NormalizedView=Base.extend({"constructor":function(e){this.id=e},"normalize":function(e){var t=e[this.id];if(!t)return i.logError("View compilation failed - view not found: "+this.id),!1;for(var n=[],a=t;a;){n.push(a);var s=a.parent;if(s){var l=e[a.parent];if(!l)return i.logError("View compilation failed - cannot find parent view: "+s+" for view: "+a.id),!1;a=l}else a=null}n=n.reverse();for(var r=function(e,t,n){var a=t[n],s=e[n];i.isUndefined(s)||i.isUndefined(a)||i.logDebug("View property: "+n+" already has value: "+s+" and overwriting to: "+a),i.isUndefined(a)||(e[n]=a)},o=function(e,t,n){var a=t[n],s=e[n];i.isUndefined(s)||i.isUndefined(a)||i.logDebug("View property: "+n+" already has function, overwriting"),i.isUndefined(a)||(e[n]=a)},d=function(e,t,n){var a=t[n];a&&(e[n]||(e[n]={}),i.mergeObject2(a,e[n]))},c=0;c<n.length;c++){var u=n[c];r(this,u,"type"),r(this,u,"ui"),r(this,u,"displayReadonly"),r(this,u,"locale"),o(this,u,"render"),o(this,u,"postRender"),d(this,u,"templates"),d(this,u,"fields"),d(this,u,"layout"),d(this,u,"styles"),d(this,u,"callbacks"),d(this,u,"messages"),r(this,u,"horizontal"),r(this,u,"collapsible"),r(this,u,"labelStyle"),r(this,u,"toolbarStyle"),r(this,u,"buttonStyle"),r(this,u,"toolbarSticky"),r(this,u,"globalTemplate"),d(this,u,"wizard")}return i.logDebug("View compilation complete for view: "+this.id),i.logDebug("Final view: "),i.logDebug(JSON.stringify(this,null,"   ")),!0}})}(jQuery),function(e){var i=e.alpaca;i.RuntimeView=Base.extend({"constructor":function(e,i){this.field=i,this.setView(e)},"setView":function(e){e||(e="web-edit");var t=i.getNormalizedView(e);if(!t)throw new Error("Runtime view for view id: "+e+" could not find a normalized view");for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])},"getWizard":function(){return this.getViewParam("wizard")},"getGlobalTemplateDescriptor":function(){return this.getTemplateDescriptor("globalTemplate")},"getLayout":function(){var e=this;return{"templateDescriptor":this.getTemplateDescriptor("layoutTemplate",e),"bindings":this.getViewParam(["layout","bindings"],!0)}},"getTemplateDescriptor":function(e,t){return i.getTemplateDescriptor(this,e,t)},"getMessage":function(e,t){t||(t=i.defaultLocale);var n=this.getViewParam(["messages",t,e]);return i.isEmpty(n)&&(n=this.getViewParam(["messages",e])),n},"getViewParam":function(e,t){var n=this.field.path;if(this.fields&&this.fields[n]){var a=this._getConfigVal(this.fields[n],e);if(!i.isEmpty(a))return a}if(n&&-1!==n.indexOf("[")&&-1!==n.indexOf("]")&&(n=n.replace(/\[\d+\]/g,"[*]"),this.fields&&this.fields[n])){var a=this._getConfigVal(this.fields[n],e);if(!i.isEmpty(a))return a}return!i.isEmpty(t)&&t&&"/"!==this.field.path?null:this._getConfigVal(this,e)},"_getConfigVal":function(e,t){if(i.isArray(t))for(var n=0;n<t.length&&!i.isEmpty(e);n++)e=e[t[n]];else i.isEmpty(e)||(e=e[t]);return e},"fireCallback":function(e,i,t,n,a,s,l){this.callbacks&&this.callbacks[i]&&this.callbacks[i].call(e,t,n,a,s,l)},"applyStyle":function(i,t){var n=t;n&&n.getFieldEl&&(n=n.getFieldEl()),n&&this.styles&&this.styles[i]&&e(n).addClass(this.styles[i])},"getStyle":function(e){return this.styles[e]?this.styles[e]:""}})}(jQuery),function(e){var i=e.alpaca;i.Field=Base.extend({"constructor":function(e,t,n,a,s,l,r){var o=this;this.initializing=!0,this.domEl=e,this.parent=null,this.data=t,this.options=n,this.schema=a,this.connector=l,this.errorCallback=function(e){r?r(e):i.defaultErrorCallback.call(o,e)},this.singleLevelRendering=!1,this.view=new i.RuntimeView(s,this);this.options||(this.options={}),this.id=this.options.id,this.type=this.options.type,this.id||(this.id=i.generateId());this.schema||(this.schema={}),this.options.label||null===this.schema.title||(this.options.label=this.schema.title),i.isEmpty(this.options.readonly)&&!i.isEmpty(this.schema.readonly)&&(this.options.readonly=this.schema.readonly),i.isValEmpty(this.data)&&!i.isEmpty(this.schema.default)&&(this.data=this.schema.default,this.showingDefaultData=!0),this.path="/",this.validation={},this._events={},this.isDisplayOnly=function(){return"view"===o.view.type||"display"==o.view.type},this.schema&&this.schema.id&&0===this.schema.id.indexOf("#")&&(this.schema.id=this.schema.id.substring(1)),this._previouslyValidated=!1,this.updateObservable=function(){this.data?this.observable(this.path).set(this.data):this.observable(this.path).clear()},this.getObservableScope=function(){for(var e=this;!e.isTop();)e=e.parent;var i=e.observableScope;return i||(i="global"),i},this.ensureProperType=function(e){var t=this;return void 0!==e&&(i.isString(e)?"number"===t.schema.type?e=parseFloat(e):"boolean"===t.schema.type&&(e=""!==e&&"false"!==e.toLowerCase()):i.isNumber(e)&&("string"===t.schema.type?e=""+e:"boolean"===t.schema.type&&(e=-1!==e&&0!==e))),e},this.onConstruct()},"onConstruct":function(){},"isTop":function(){return!this.parent},"getTemplateDescriptorId":function(){throw new Error("Template descriptor ID was not specified")},"initTemplateDescriptor":function(){var e=this,t=this.view.getTemplateDescriptor(this.getTemplateDescriptorId(),this),n=this.view.getGlobalTemplateDescriptor(),a=this.view.getLayout(),s=!1;if(this.isTop()&&(n?(this.setTemplateDescriptor(n),this.singleLevelRendering=!0,s=!0):a&&a.templateDescriptor&&(this.setTemplateDescriptor(a.templateDescriptor),s=!0)),!s&&t&&this.setTemplateDescriptor(t),!this.getTemplateDescriptor())return i.throwErrorWithCallback("Unable to find template descriptor for field: "+e.getFieldType())},"setup":function(){this.initializing||(this.data=this.getValue()),this.initTemplateDescriptor(),i.isUndefined(this.schema.required)&&(this.schema.required=!1),i.isUndefined(this.options.validate)&&(this.options.validate=!0),i.isUndefined(this.options.disabled)&&(this.options.disabled=!1),i.isUndefined(this.options.showMessages)&&(this.options.showMessages=!0)},"on":function(e,t){return i.logDebug("Adding listener for event: "+e),this._events[e]=t,this},"triggerWithPropagation":function(e,i){this.trigger.call(this,e,i),this.parent&&this.parent.triggerWithPropagation.call(this.parent,e,i)},"trigger":function(e,t){var n=this._events[e],a=null;if("function"==typeof n){i.logDebug("Firing event: "+e);try{a=n.call(this,t)}catch(t){i.logDebug("The event handler caught an exception: "+e)}}return a},"bindData":function(){i.isEmpty(this.data)||this.setValue(this.data)},"render":function(e,t){e&&(i.isString(e)||i.isObject(e))?this.view.setView(e):i.isEmpty(t)&&i.isFunction(e)&&(t=e),null===this.options.label&&this.propertyId&&(this.options.label=this.propertyId),this.options.name&&(this.name=this.options.name),this.calculateName(),this.setup(),this._render(t)},"calculateName":function(){if(!this.name||this.name&&this.nameCalculated)if(this.parent&&this.parent.name&&this.path){var e=this.path.substring(this.path.lastIndexOf("/")+1);-1!==e.indexOf("[")&&-1!==e.indexOf("]")&&(e=e.substring(e.indexOf("[")+1,e.indexOf("]"))),e&&(this.name=this.parent.name+"_"+e,this.nameCalculated=!0)}else this.path&&(this.name=this.path.replace(/\//g,"").replace(/\[/g,"_").replace(/\]/g,""),this.nameCalculated=!0)},"_render":function(t){var n=this;if(n.options.form&&i.isObject(n.options.form)){n.options.form.viewType=this.view.type;var a=n.form;a||(a=new i.Form(n.domEl,this.options.form,n.view.id,n.connector,n.errorCallback)),a.render(function(a){var s=e("<div></div>");n._processRender(s,function(){a.formFieldsContainer.before(n.field),a.formFieldsContainer.remove(),a.topControl=n,n.view.type&&"view"!==n.view.type&&a.initEvents(),n.form=a,n.postRender(function(){t&&i.isFunction(t)&&t(n)})})})}else this._processRender(n.domEl,function(){n.postRender(function(){t&&i.isFunction(t)&&t(n)})})},"_processRender":function(e,i){var t=this;t.renderField(e,function(){t.fireCallback("field"),t.renderFieldElements(function(){i()})})},"renderFieldDomElement":function(e){var t=this.getTemplateDescriptor();return i.tmpl(t,{"id":this.getId(),"options":this.options,"schema":this.schema,"data":e,"view":this.view,"path":this.path,"name":this.name})},"renderField":function(i,t){var n=this,a=this.data;this.isDisplayOnly()&&"object"==typeof a&&(a=JSON.stringify(a));var s=n.renderFieldDomElement(a);if(e(s).length>0){for(var l=null,r=0;r<e(s).length;r++){var o=e(s)[r].nodeName;if(o&&("div"===(o=o.toLowerCase())||"span"===o)){l=e(e(s)[r]);break}}l||(l=e(e(s).last())),l&&(s=l)}n._oldFieldEl=n.field,this.field=s,this.field.appendTo(i),t()},"renderFieldElements":function(e){e()},"postRender":function(t){var n=this;if(this.field.addClass("alpaca-field"),this.field.addClass("alpaca-field-"+this.getFieldType()),this.field.attr("data-alpaca-field-id",this.getId()),"view"!==this.view.type){this.isRequired()?(e(this.field).addClass("alpaca-required"),n.fireCallback("required")):(e(this.field).addClass("alpaca-optional"),n.fireCallback("optional"));var a=function(t){t&&(i.disabled(e(":input",n.field),!0),i.disabled(e("select",n.field),!0),i.disabled(e(":radio",n.field),!0),i.disabled(e(":checkbox",n.field),!0)),e(":radio",n.field).off().on("click",function(e){return e.preventDefault(),e.stopImmediatePropagation(),!1}),e(".binf-radio label",n.field).off().on("click",function(e){return e.preventDefault(),e.stopImmediatePropagation(),!1}),e(":input",n.field).off().on("click",function(e){return e.preventDefault(),e.stopImmediatePropagation(),!1})};this.options.readonly&&(e(this.field).addClass("alpaca-readonly"),function(){i.readonly(e('input:not([type="checkbox"])',n.field),!0)}(),a(),n.fireCallback("readonly")),this.options.disabled&&(e(this.field).addClass("alpaca-disabled"),a(this.options.disabled),n.fireCallback("disabled"));!function(e,t){if(t){var n=0,a=null;if(i.isArray(t))for(n=0;n<t.length;n++)e.addClass(t[n]);else if(t.indexOf(",")>-1)for(a=t.split(","),n=0;n<a.length;n++)e.addClass(a[n]);else if(t.indexOf(" ")>-1)for(a=t.split(" "),n=0;n<a.length;n++)e.addClass(a[n]);else e.addClass(t)}}(this.field,this.options.fieldClass),this.options.disabled&&(this.disable(),n.fireCallback("disable")),this.view.type&&"edit"===this.view.type?this.bindData():this.showingDefaultData&&this.bindData(),"create"===this.view.type&&i.logDebug("Skipping data binding for field: "+this.id+" since view mode is 'create'"),this.view.type&&"view"!==this.view.type&&this.initEvents()}this.options.hidden&&this.field.hide(),this.initializing=!1;var s="create"===this.view.type&&!this.refreshed;this.hideInitValidationError=i.isValEmpty(this.options.hideInitValidationError)?s:this.options.hideInitValidationError,this.view.displayReadonly||e(this.field).find(".alpaca-readonly").hide(),this.options.postRender?this.options.postRender.call(this,function(){t()}):t()},"refresh":function(i){var t=this;t.refreshed=!0;var n=e("<div></div>");e(t.field).before(n),t.domEl=e("<div></div>"),t.setup(),t._render(function(){e(t.domEl.children()[0]).find(".alpaca-message").remove(),e(n).before(t.domEl.children()),e(n).remove(),t._oldFieldEl&&e(t._oldFieldEl).remove(),i&&i()})},"refreshContainer":function(i,t){var n=this;n.refreshed=!0;var a=e("<div></div>");e(n.field).before(a),n.domEl=e("<div></div>"),n.setup(),n.data=i,n._render(function(){e(n.domEl.children()[0]).find(".alpaca-message").remove(),e(a).before(n.domEl.children()),e(a).remove(),n._oldFieldEl&&e(n._oldFieldEl).remove(),t&&t()})},"applyStyle":function(e,i){this.view.applyStyle(e,i)},"fireCallback":function(e,i,t,n,a,s){this.view.fireCallback(this,e,i,t,n,a,s)},"getFieldEl":function(){return this.field},"getId":function(){return this.id},"getParent":function(){return this.parent},"isTopLevel":function(){return i.isEmpty(this.parent)},"getValue":function(){var e=this,i=this.data;return i=e.ensureProperType(i)},"setValue":function(e){this.data=e,this.updateObservable(),this.triggerUpdate()},"setDefault":function(){},"getTemplateDescriptor":function(){return this.templateDescriptor},"setTemplateDescriptor":function(e){this.templateDescriptor=e},"displayMessage":function(t,n){var a=this;t&&i.isObject(t)&&(t=[t]),t&&i.isString(t)&&(t=[{"id":"custom","message":t}]),e(this.getFieldEl()).children(".alpaca-message").remove(),a.fireCallback("removeMessages"),t&&t.length>0&&e.each(t,function(t,n){var s=!1;a.hideInitValidationError&&(s=!0);var l=a.view.getTemplateDescriptor("message");if(l){var r=i.tmpl(l,{"id":n.id,"message":n.message,"view":a.view});r.addClass("alpaca-message").attr("role","alert"),s&&r.addClass("alpaca-message-hidden"),e(a.getFieldEl()).append(r)}a.fireCallback("addMessage",t,n.id,n.message,s)})},"refreshValidationState":function(e,t){var n=this,a=[],s=[],l=function(e,t){return function(n){i.compileValidationContext(e,function(e){t.push(e),n()})}};if(e){var r=function(e,i){if(e.isValidationParticipant()){
if(e.children&&e.children.length>0)for(var t=0;t<e.children.length;t++)r(e.children[t],i);s.push(l(e,i))}};r(this,a)}s.push(l(this,a)),i.series(s,function(e){for(var s={},l=[],r=0;r<a.length;r++)for(var o=a[r],d=l.length,c=0;c<o.length;c++){var u=o[c],h=s[u.id];if(h)u.validated&&!h.invalidated&&(h.validated=!0,h.invalidated=!1,h.valid=u.valid),u.invalidated&&(h.invalidated=!0,h.validated=!1,h.valid=u.valid);else{var p={};p.id=u.id,p.path=u.path,p.domEl=u.domEl,p.field=u.field,p.validated=u.validated,p.invalidated=u.invalidated,p.valid=u.valid,l.splice(d,0,p),s[p.id]=p}}l.reverse(),n.hideInitValidationError||i.updateValidationStateForContext(n.view,l),t&&t()})},"getMessage":function(e){return this.view.getMessage(e,this.view.locale)},"validate":function(e){var t=!0;if(!this.initializing&&this.options.validate){if(this.children&&e)for(var n=0;n<this.children.length;n++){var a=this.children[n];a.isValidationParticipant()&&a.validate(e)}if(!(t=this.handleValidate())&&i.logLevel==i.DEBUG){var s=[];for(var l in this.validation)this.validation[l].status||s.push(this.validation[l].message);i.logDebug("Validation failure for field (id="+this.getId()+", path="+this.path+"), messages: "+JSON.stringify(s))}}return this._previouslyValidated=!0,t},"handleValidate":function(){var e=this.validation,t=this._validateOptional();return e.notOptional={"message":t?"":this.getMessage("notOptional"),"status":t},t=this._validateDisallow(),e.disallowValue={"message":t?"":i.substituteTokens(this.getMessage("disallowValue"),[this.schema.disallow.join(", ")]),"status":t},e.notOptional.status&&e.disallowValue.status},"_validateCustomValidator":function(e){var t=this;this.options.validator&&i.isFunction(this.options.validator)?this.options.validator.call(this,function(i){t.validation.custom=i,e()}):e()},"_validateOptional":function(){return!this.isRequired()||!this.isEmpty()},"_validateDisallow":function(){if(!i.isValEmpty(this.schema.disallow)){var t=this.getValue(),n=this.schema.disallow;if(i.isArray(n)){var a=!0;return e.each(n,function(e,n){(i.isObject(t)||i.isArray(t)&&i.isString(n))&&(n=i.parseJSON(n)),i.compareObject(t,n)&&(a=!1)}),a}return(i.isObject(t)||i.isArray(t)&&i.isString(n))&&(n=i.parseJSON(n)),!i.compareObject(t,n)}return!0},"triggerUpdate":function(){e(this.field).trigger("fieldupdate")},"disable":function(){},"enable":function(){},"focus":function(e){e&&e(this)},"destroy":function(){i.observable(this.path).clear(),i&&i.fieldInstances&&i.fieldInstances[this.getId()]&&delete i.fieldInstances[this.getId()],e(this.field).remove()},"show":function(){if(!this.options||!this.options.hidden){var i=e(this.field);if(!i.hasClass("alpaca-container-item")){var t=i.closest(".alpaca-container-item");t.length&&"none"===t[0].style.display&&t.css({"display":""})}i.css({"display":""}),this.standaloneHelper&&this.standaloneHelper.css({"display":""}),this.onShow(),this.fireCallback("show")}},"onShow":function(){},"hide":function(){var i=e(this.field);if(i.css({"display":"none"}),!i.hasClass("alpaca-container-item")){var t=i.closest(".alpaca-container-item");t.length&&t.css({"display":"none"})}this.standaloneHelper&&this.standaloneHelper.css({"display":"none"}),this.onHide(),this.fireCallback("hide")},"onHide":function(){},"isValidationParticipant":function(){return this.isShown()},"isShown":function(){return this.isVisible()},"isVisible":function(){return!this.isHidden()},"isHidden":function(){return"none"===e(this.field).css("display")},"print":function(){this.getFieldEl().printArea&&this.getFieldEl().printArea()},"onDependentReveal":function(){},"onDependentConceal":function(){},"reload":function(){this.initializing=!0,i.isEmpty(this.callback)?this.render(this.renderedCallback):this.callback(this,this.renderedCallback)},"clear":function(){var e=null;this.data&&(e=this.data),this.setValue(e)},"isEmpty":function(){return i.isValEmpty(this.getValue())},"isValid":function(i){if(i&&this.children)for(var t=0;t<this.children.length;t++){var n=this.children[t];if(n.isValidationParticipant()&&!n.isValid(i))return!1}if(e.isEmptyObject(this.validation))return!0;for(var a in this.validation)if(!this.validation[a].status)return!1;return!0},"initEvents":function(){var t=this;this.field&&(this.field.on("mouseover",function(e){t.onMouseOver.call(t,e),t.trigger("mouseover",e)}),this.field.on("mouseout",function(e){t.onMouseOut.call(t,e),t.trigger("mouseout",e)}),e.each(this.options,function(e,n){if(i.startsWith(e,"onField")&&i.isFunction(n)){var a=e.substring(7).toLowerCase();t.field.on(a,function(e){n.call(t,e)})}}),this.options&&this.options.events&&e.each(this.options.events,function(e,n){i.isFunction(n)&&t.field.on(e,function(e){n.call(t,e)})}))},"onFocus":function(i){e(this.field).removeClass("alpaca-field-empty"),e(this.field).addClass("alpaca-field-focused")},"onBlur":function(i){var t=e(this.field).hasClass("alpaca-field-focused");e(this.field).removeClass("alpaca-field-focused"),t&&this.refreshValidationState()},"onChange":function(e){this.data=this.getValue(),this.updateObservable(),this.triggerUpdate()},"onMouseOver":function(e){},"onMouseOut":function(e){},"getControlByPath":function(e){var t=this;if(e){for(var n=e.split("/"),a=0;a<n.length;a++){if(i.isValEmpty(n[a]))return null;if(!t||!t.childrenByPropertyId)return null;if(!t.childrenByPropertyId[n[a]])return null;t=t.childrenByPropertyId[n[a]]}return t}},"subscribe":function(){var e=i.makeArray(arguments);return e.unshift(this.getObservableScope()),i.subscribe.apply(this,e)},"unsubscribe":function(){var e=i.makeArray(arguments);return e.unshift(this.getObservableScope()),i.unsubscribe.apply(this,e)},"observable":function(){var e=i.makeArray(arguments);return e.unshift(this.getObservableScope()),i.observable.apply(this,e)},"clearObservable":function(){var e=i.makeArray(arguments);return e.unshift(this.getObservableScope()),i.clearObservable.apply(this,e)},"dependentObservable":function(){var e=i.makeArray(arguments);return e.unshift(this.getObservableScope()),i.dependentObservable.apply(this,e)},"getType":function(){},"getFieldType":function(){return""},"getBaseFieldType":function(){var e=null,i=this.constructor.ancestor.prototype;return i&&i.getFieldType&&(e=i.getFieldType()),e},"isContainer":function(){return!1},"isRequired":function(){var e=!1;if("boolean"==typeof this.schema.required&&(e=this.schema.required),this.parent&&this.parent.schema.required&&i.isArray(this.parent.schema.required)){var t=this.parent.schema.required;if(t)for(var n=0;n<t.length;n++)if(t[n]===this.propertyId){e=!0;break}}return e},"getTitle":function(){},"getDescription":function(){},"getSchemaOfSchema":function(){var e={"title":this.getTitle(),"description":this.getDescription(),"type":"object","properties":{"title":{"title":"Title","description":"Short description of the property.","type":"string"},"description":{"title":"Description","description":"Detailed description of the property.","type":"string"},"readonly":{"title":"Readonly","description":"Indicates that the field is read-only.  A read-only field cannot have it's value changed.  Read-only fields render in a grayed-out or disabled control.  If the field is rendered using a view with the <code>displayReadonly</code> attribute set to false, the read-only field will not appear.","type":"boolean","default":!1},"required":{"title":"Required","description":"Indicates whether the field's value is required.  If set to true, the field must take on a valid value and cannnot be left empty or unassigned.","type":"boolean","default":!1},"default":{"title":"Default","description":"The default value to be assigned for this property.  If the data for the field is empty or not provided, this default value will be plugged in for you.  Specify a default value when you want to pre-populate the field's value ahead of time.","type":"any"},"type":{"title":"Type","description":"Data type of the property.","type":"string","readonly":!0},"format":{"title":"Format","description":"Data format of the property.","type":"string"},"disallow":{"title":"Disallowed Values","description":"List of disallowed values for the property.","type":"array"},"dependencies":{"title":"Dependencies","description":"List of property dependencies.","type":"array"}}};return this.getType&&!i.isValEmpty(this.getType())&&(e.properties.type.default=this.getType(),e.properties.type.enum=[this.getType()]),e},"getOptionsForSchema":function(){return{"fields":{"title":{"helper":"Field short description","type":"text"},"description":{"helper":"Field detailed description","type":"textarea"},"readonly":{"helper":"Field will be read only if checked","rightLabel":"This field is read-only","type":"checkbox"},"required":{"helper":"Field value must be set if checked","rightLabel":"This field is required","type":"checkbox"},"default":{"helper":"Field default value","type":"textarea"},"type":{"helper":"Field data type","type":"text"},"format":{"type":"select","dataSource":function(e){for(var t in i.defaultFormatFieldMapping)this.selectOptions.push({"value":t,"text":t});e()}},"disallow":{"helper":"Disallowed values for the field","itemLabel":"Value","type":"array"},"dependencies":{"helper":"Field Dependencies","multiple":!0,"size":3,"type":"select","dataSource":function(e,i){if(e.parent&&e.parent.schemaParent&&e.parent.schemaParent.parent)for(var t in e.parent.schemaParent.parent.childrenByPropertyId)t!=e.parent.schemaParent.propertyId&&e.selectOptions.push({"value":t,"text":t});i&&i()}}}}},"getSchemaOfOptions":function(){var e={"title":"Options for "+this.getTitle(),"description":this.getDescription()+" (Options)","type":"object","properties":{"form":{},"id":{"title":"Field Id","description":"Unique field id. Auto-generated if not provided.","type":"string"},"type":{"title":"Field Type","description":"Field type.","type":"string","default":this.getFieldType(),"readonly":!0},"validate":{"title":"Validation","description":"Field validation is required if true.","type":"boolean","default":!0},"showMessages":{"title":"Show Messages","description":"Display validation messages if true.","type":"boolean","default":!0},"disabled":{"title":"Disabled","description":"Field will be disabled if true.","type":"boolean","default":!1},"readonly":{"title":"Readonly","description":"Field will be readonly if true.","type":"boolean","default":!1},"hidden":{"title":"Hidden","description":"Field will be hidden if true.","type":"boolean","default":!1},"label":{"title":"Label","description":"Field label.","type":"string"},"helper":{"title":"Helper","description":"Field help message.","type":"string"},"fieldClass":{"title":"CSS class","description":"Specifies one or more CSS classes that should be applied to the dom element for this field once it is rendered.  Supports a single value, comma-delimited values, space-delimited values or values passed in as an array.","type":"string"},"hideInitValidationError":{"title":"Hide Initial Validation Errors","description":"Hide initial validation errors if true.","type":"boolean","default":!1},"focus":{"title":"Focus","description":"If true, the initial focus for the form will be set to the first child element (usually the first field in the form).  If a field name or path is provided, then the specified child field will receive focus.  For example, you might set focus to 'name' (selecting the 'name' field) or you might set it to 'client/name' which picks the 'name' field on the 'client' object.","type":"checkbox","default":!0},"optionLabels":{"title":"Enumerated Value Labels","description":"An array of string labels for items in the enum array","type":"array"},"view":{"title":"Override of the view for this field","description":"Allows for this field to be rendered with a different view (such as 'display' or 'create')","type":"string"}}};return this.isTopLevel()?e.properties.form={"title":"Form","description":"Options for rendering the FORM tag.","type":"object","properties":{"attributes":{"title":"Form Attributes","description":"List of attributes for the FORM tag.","type":"object","properties":{"id":{"title":"Id","description":"Unique form id. Auto-generated if not provided.","type":"string"},"action":{"title":"Action","description":"Form submission endpoint","type":"string"},"method":{"title":"Method","description":"Form submission method","enum":["post","get"],"type":"string"},"rubyrails":{"title":"Ruby On Rails","description":"Ruby on Rails Name Standard","enum":["true","false"],"type":"string"},"name":{"title":"Name","description":"Form name","type":"string"},"focus":{"title":"Focus","description":"Focus Setting","type":"any"}}},"buttons":{"title":"Form Buttons","description":"Configuration for form-bound buttons","type":"object","properties":{"submit":{"type":"object","title":"Submit Button","required":!1},"reset":{"type":"object","title":"Reset button","required":!1}}},"toggleSubmitValidState":{"title":"Toggle Submit Valid State","description":"Toggle the validity state of the Submit button","type":"boolean","default":!0}}}:delete e.properties.form,e},"getOptionsForOptions":function(){var e={"type":"object","fields":{"id":{"type":"text","readonly":!0},"type":{"type":"text"},"validate":{"rightLabel":"Enforce validation","type":"checkbox"},"showMessages":{"rightLabel":"Show validation messages","type":"checkbox"},"disabled":{"rightLabel":"Disable this field","type":"checkbox"},"hidden":{"type":"checkbox","rightLabel":"Hide this field"},"label":{"type":"text"},"helper":{"type":"textarea"},"fieldClass":{"type":"text"},"hideInitValidationError":{"rightLabel":"Hide initial validation errors","type":"checkbox"},"focus":{"type":"checkbox","rightLabel":"Auto-focus first child field"},"optionLabels":{"type":"array","items":{"type":"string"}},"view":{"type":"text"}}};return this.isTopLevel()&&(e.fields.form={"type":"object","fields":{"attributes":{"type":"object","fields":{"id":{"type":"text","readonly":!0},"action":{"type":"text"},"method":{"type":"select"},"name":{"type":"text"}}}}}),e}}),i.registerMessages({"disallowValue":lang.disallowValue,"notOptional":lang.notOptional})}(jQuery),function(e){var i=e.alpaca;i.ControlField=i.Field.extend({"onConstruct":function(){var i=this;this.isControlField=!0,this._getControlVal=function(t){var n=null;return this.control&&(n=e(this.control).val(),t&&(n=i.ensureProperType(n))),n}},"setup":function(){var e=this;this.base();var t=e.resolveControlTemplateType();if(!t)return i.throwErrorWithCallback("Unable to find template descriptor for control: "+e.getFieldType());this.controlDescriptor=this.view.getTemplateDescriptor("control-"+t,e)},"getControlEl":function(){return this.control},"resolveControlTemplateType":function(){var e=this,i=!1,t=null,n=this;do{if(n.getFieldType){var a=this.view.getTemplateDescriptor("control-"+n.getFieldType(),e);a?(t=n.getFieldType(),i=!0):n=n.constructor.ancestor.prototype}else i=!0}while(!i);return t},"onSetup":function(){},"isAutoFocusable":function(){return!0},"getTemplateDescriptorId":function(){return"control"},"renderFieldElements":function(t){var n=this;this.control=e(this.field).find("."+i.MARKER_CLASS_CONTROL_FIELD),this.control.removeClass(i.MARKER_CLASS_CONTROL_FIELD),n.prepareControlModel(function(e){n.beforeRenderControl(e,function(){n.renderControl(e,function(a){a&&(n.control.replaceWith(a),n.control=a,n.control.addClass(i.CLASS_CONTROL)),n.fireCallback("control"),n.afterRenderControl(e,function(){t()})})})})},"prepareControlModel":function(e){var i={};i.id=this.getId(),i.name=this.name,i.options=this.options,i.schema=this.schema,i.data=this.data,i.required=this.isRequired(),i.view=this.view,e(i)},"beforeRenderControl":function(e,i){i()},"afterRenderControl":function(e,i){var t=this;t.firstUpdateObservableFire||void 0===t.data||null==t.data||(t.firstUpdateObservableFire=!0,t.updateObservable()),i()},"renderControl":function(e,t){var n=null;this.controlDescriptor&&(n=i.tmpl(this.controlDescriptor,e)),t(n)},"postRender":function(e){this.base(function(){e()})},"setDefault":function(){var e=i.isEmpty(this.schema.default)?"":this.schema.default;this.setValue(e)},"_validateEnum":function(){if(this.schema.enum){var t=this.data;return t=this.getValue(),!(this.isRequired()||!i.isValEmpty(t))||e.inArray(t,this.schema.enum)>-1}return!0},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateEnum();return t.invalidValueOfEnum={"message":n?"":i.substituteTokens(this.getMessage("invalidValueOfEnum"),[this.schema.enum.join(", "),this.data]),"status":n},e&&t.invalidValueOfEnum.status},"initEvents":function(){this.base(),this.control&&this.control.length>0&&this.initControlEvents()},"initControlEvents":function(){var e=this,i=this.control;i.on("click",function(i){e.onClick.call(e,i),e.trigger("click",i)}),i.on("change",function(i){setTimeout(function(){e.onChange.call(e,i),e.triggerWithPropagation("change",i)},250)}),i.on("focus",function(i){if(e.wasFocused=!0,!e.suspendBlurFocus){var t=e.onFocus.call(e,i);return!1!==t&&(t=e.trigger("focus",i)),t}}),i.on("blur",function(i){if(e.wasBlurred=!0,!e.suspendBlurFocus){var t=e.onBlur.call(e,i);return!1!==t&&(t=e.trigger("blur",i)),t}}),i.on("keypress",function(i){var t=e.onKeyPress.call(e,i);return!1!==t&&(t=e.trigger("keypress",i)),t}),i.on("keyup",function(i){var t=e.onKeyUp.call(e,i);return!1!==t&&(t=e.trigger("keyup",i)),t}),i.on("keydown",function(i){var t=e.onKeyDown.call(e,i);return!1!==t&&(t=e.trigger("keydown",i)),t})},"onKeyPress":function(e){var i=this,t=!1;if(i.view.type&&"edit"===i.view.type){var n=this.isValid();n||(t=!0)}else if(i.view.type&&"create"===i.view.type){var n=this.isValid();!n&&i.wasBlurred&&(t=!0)}t&&window.setTimeout(function(){i.refreshValidationState()},50)},"onKeyDown":function(e){},"onKeyUp":function(e){},"onClick":function(e){},"disable":function(){this.base(),this.control&&this.control.length>0&&e(this.control).prop("disabled",!0)},"enable":function(){this.base(),this.control&&this.control.length>0&&e(this.control).prop("disabled",!1)},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{"enum":{"title":"Enumerated Values","description":"List of specific values for this property","type":"array"}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"enum":{"itemLabel":"Value","type":"array"}}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"name":{"title":"Field Name","description":"Field Name.","type":"string"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"name":{"type":"text"}}})}}),i.registerMessages({"invalidValueOfEnum":lang.invalidValueOfEnum})}(jQuery),function(e){var i=e.alpaca;i.ContainerField=i.Field.extend({"onConstruct":function(){this.isContainerField=!0},"isContainer":function(){return!0},"getContainerEl":function(){return this.container},"getTemplateDescriptorId":function(){return"container"},"resolveContainerTemplateType":function(){var e=!1,i=null,t=this;do{if(t.getFieldType){var n=this.view.getTemplateDescriptor("container-"+t.getFieldType(),this);n?(i=t.getFieldType(),e=!0):t=t.constructor.ancestor.prototype}else e=!0}while(!e);return i},"resolveContainerItemTemplateType":function(){var e=!1,i=null,t=this;do{if(t.getFieldType){var n=this.view.getTemplateDescriptor("container-"+t.getFieldType()+"-item",this);n?(i=t.getFieldType(),e=!0):t=t.constructor.ancestor.prototype}else e=!0}while(!e);return i},"setup":function(){var e=this;this.base();var t=e.resolveContainerTemplateType();if(!t)return i.throwErrorWithCallback("Unable to find template descriptor for container: "+e.getFieldType());this.containerDescriptor=this.view.getTemplateDescriptor("container-"+t,e);var n=!0;i.isEmpty(this.view.collapsible)||(n=this.view.collapsible),i.isEmpty(this.options.collapsible)||(n=this.options.collapsible),this.options.collapsible=n;var a="button";i.isEmpty(this.view.labelStyle)||(a=this.view.labelStyle),i.isEmpty(this.options.labelStyle)||(a=this.options.labelStyle),this.options.labelStyle=a,this.lazyLoading=!1,i.isEmpty(this.options.lazyLoading)||(this.lazyLoading=this.options.lazyLoading,this.lazyLoading&&(this.options.collapsed=!0)),this.children=[],this.childrenById={},this.childrenByPropertyId={}},"destroy":function(){this.form&&(this.form.destroy(!0),delete this.form),i.each(this.children,function(){this.destroy()}),this.base()},"renderFieldElements":function(t){var n=this;this.container=e(this.field).find("."+i.MARKER_CLASS_CONTAINER_FIELD),this.container.removeClass(i.MARKER_CLASS_CONTAINER_FIELD),n.prepareContainerModel(function(e){n.beforeRenderContainer(e,function(){n.renderContainer(e,function(a){a&&(n.container.replaceWith(a),n.container=a,n.container.addClass(i.CLASS_CONTAINER)),n.view.horizontal?n.container.addClass("alpaca-horizontal"):n.container.addClass("alpaca-vertical"),n.fireCallback("container"),n.afterRenderContainer(e,function(){t()})})})})},"prepareContainerModel":function(e){var i=this,t={"id":this.getId(),"name":this.name,"schema":this.schema,"options":this.options,"view":this.view};i.createItems(function(i){i||(i=[]);for(var n=0;n<i.length;n++)i[n].containerItemEl||(i[n].containerItemEl=i[n].getFieldEl());t.items=i,e(t)})},"beforeRenderContainer":function(e,i){i()},"renderContainer":function(e,t){var n=null;this.containerDescriptor&&(n=i.tmpl(this.containerDescriptor,e)),t(n)},"afterRenderContainer":function(e,i){var t=this;t.beforeApplyCreatedItems(e,function(){t.applyCreatedItems(e,function(){t.afterApplyCreatedItems(e,function(){i()})})})},"postRender":function(e){this.base(function(){e()})},"initEvents":function(){this.base()},"createItems":function(e){e()},"beforeApplyCreatedItems":function(e,i){i()},"applyCreatedItems":function(t,n){var a=this,s=null;if(a.isTopLevel()&&a.view.getLayout()&&!(s=a.view.getLayout().bindings)&&a.view.getLayout().templateDescriptor&&t.items.length>0){s={};for(var l=0;l<t.items.length;l++){var r=t.items[l].name;s[r]="[data-alpaca-layout-binding='"+r+"']"}}t.items.length>0?(e(a.container).addClass("alpaca-container-has-items"),e(a.container).attr("data-alpaca-container-item-count",t.items.length)):(e(a.container).removeClass("alpaca-container-has-items"),e(a.container).removeAttr("data-alpaca-container-item-count"));for(var l=0;l<t.items.length;l++){var o=t.items[l],d=e(a.container).find("."+i.MARKER_CLASS_CONTAINER_FIELD_ITEM+"["+i.MARKER_DATA_CONTAINER_FIELD_ITEM_KEY+"='"+o.name+"']");if(s){var c=s[o.name];if(c){var u=e(c,a.field);if(0==u.length)try{u=e("#"+c,a.field)}catch(e){}u.length>0&&(e(o.containerItemEl).appendTo(u),o.domEl=u)}e(d).remove()}else{var u=e(d).parent();e(d).replaceWith(o.containerItemEl),o.domEl=u}e(o.containerItemEl).addClass("alpaca-container-item"),0===l&&e(o.containerItemEl).addClass("alpaca-container-item-first"),l+1===t.items.length&&e(o.containerItemEl).addClass("alpaca-container-item-last"),e(o.containerItemEl).attr("data-alpaca-container-item-index",l),e(o.containerItemEl).attr("data-alpaca-container-item-name",o.name),e(o.containerItemEl).attr("data-alpaca-container-item-parent-field-id",a.getId()),a.registerChild(o,l)}a.options.collapsible&&a.fireCallback("collapsible"),a.triggerUpdate(),n()},"afterApplyCreatedItems":function(e,i){i()},"registerChild":function(e,t){i.isEmpty(t)?this.children.push(e):this.children.splice(t,0,e),this.childrenById[e.getId()]=e,e.propertyId&&(this.childrenByPropertyId[e.propertyId]=e),e.parent=this},"unregisterChild":function(e){var t=this.children[e];t&&(i.isEmpty(e)||this.children.splice(e,1),delete this.childrenById[t.getId()],t.propertyId&&delete this.childrenByPropertyId[t.propertyId],t.parent=null)},"updateChildDOMElements":function(){var i=this,t=null;if(i.view.getLayout()&&(t=i.view.getLayout().bindings),!t){i.children.length>0?(e(i.getContainerEl()).addClass("alpaca-container-has-items"),e(i.getContainerEl()).attr("data-alpaca-container-item-count",i.children.length)):(e(i.getContainerEl()).removeClass("alpaca-container-has-items"),e(i.getContainerEl()).removeAttr("data-alpaca-container-item-count"));for(var n=0;n<i.children.length;n++){var a=i.children[n];a.path=i.path+"["+n+"]",a.calculateName(),e(a.containerItemEl).removeClass("alpaca-container-item-first"),e(a.containerItemEl).removeClass("alpaca-container-item-last"),e(a.containerItemEl).removeClass("alpaca-container-item-index"),e(a.containerItemEl).removeClass("alpaca-container-item-key"),e(a.containerItemEl).addClass("alpaca-container-item"),0===n&&e(a.containerItemEl).addClass("alpaca-container-item-first"),n+1===i.children.length&&e(a.containerItemEl).addClass("alpaca-container-item-last"),e(a.containerItemEl).attr("data-alpaca-container-item-index",n),e(a.containerItemEl).attr("data-alpaca-container-item-name",a.name),e(a.containerItemEl).attr("data-alpaca-container-item-parent-field-id",i.getId())}}},"onDependentReveal":function(){for(var e=0;e<this.children.length;e++)this.children[e].onDependentReveal()},"onDependentConceal":function(){for(var e=0;e<this.children.length;e++)this.children[e].onDependentConceal()},"focus":function(e){this.base();for(var i=-1,t=0;t<this.children.length;t++)if(!this.children[t].isValid(!0)){i=t;break}-1===i&&this.children.length>0&&(i=0),i>-1&&(this.children[i].trigger("focus"),e&&e(this.children[i]))},"disable":function(){this.base();for(var e=0;e<this.children.length;e++)this.children[e].disable()},"enable":function(){this.base();for(var e=0;e<this.children.length;e++)this.children[e].enable()},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"lazyLoading":{"title":"Lazy Loading","description":"Child fields will only be rendered when the fieldset is expanded if this option is set true.","type":"boolean","default":!1},"collapsible":{"title":"Collapsible","description":"Field set is collapsible if true.","type":"boolean","default":!0},"collapsed":{"title":"Collapsed","description":"Field set is initially collapsed if true.","type":"boolean","default":!1},"labelStyle":{"title":"label Style","description":"Field set label style.","type":"string","enum":["button","link"],"default":"button"},"animate":{"title":"Animate movements and transitions","description":"Up and down transitions will be animated","type":"boolean","default":!0}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"lazyLoading":{"rightLabel":"Lazy loading child fields ?","helper":"Lazy loading will be enabled if checked.","type":"checkbox"},"collapsible":{"rightLabel":"Field set collapsible ?","helper":"Field set is collapsible if checked.","type":"checkbox"},"collapsed":{"rightLabel":"Field set initially collapsed ?","description":"Field set is initially collapsed if checked.","type":"checkbox"},"labelStyle":{"type":"select"},"animate":{"rightLabel":"Animate movements and transitions","type":"checkbox"}}})}})}(jQuery),function(e){var i=e.alpaca;i.Form=Base.extend({"constructor":function(e,t,n,a,s){if(this.domEl=e,this.parent=null,this.connector=a,this.errorCallback=s,this.options=t,this.options.attributes?this.attributes=this.options.attributes:this.attributes={},this.options.buttons){this.options.buttons.submit&&(this.options.buttons.submit.type||(this.options.buttons.submit.type="submit"),this.options.buttons.submit.name||(this.options.buttons.submit.name="submit"),this.options.buttons.submit.value||(this.options.buttons.submit.value="Submit")),this.options.buttons.reset&&(this.options.buttons.reset.type||(this.options.buttons.reset.type="reset"),this.options.buttons.reset.name||(this.options.buttons.reset.name="reset"),this.options.buttons.reset.value||(this.options.buttons.reset.value="Reset"));for(var l in this.options.buttons)this.options.buttons[l].label&&(this.options.buttons[l].value=this.options.buttons[l].label),this.options.buttons[l].title&&(this.options.buttons[l].value=this.options.buttons[l].title),this.options.buttons[l].type||(this.options.buttons[l].type="button")}this.attributes.id?this.id=this.attributes.id:(this.id=i.generateId(),this.attributes.id=this.id),this.options.buttons&&this.options.buttons.submit&&i.isUndefined(this.options.toggleSubmitValidState)&&(this.options.toggleSubmitValidState=!0),this.viewType=t.viewType,this.view=new i.RuntimeView(n,this)},"render":function(e){var i=this;this.form&&this.form.remove(),this.processRender(this.domEl,function(){i.form.appendTo(i.container),i.form.addClass("alpaca-form"),i.fireCallback("form"),e(i)})},"isFormValid":function(){return this.topControl.validate(!0),this.topControl.isValid(!0)},"isValid":function(){return this.isFormValid()},"validate":function(e){return this.topControl.validate(e)},"enableSubmitButton":function(){if(e(".alpaca-form-button-submit").attrProp("disabled",!1),e.mobile)try{e(".alpaca-form-button-submit").button("refresh")}catch(e){}},"disableSubmitButton":function(){if(e(".alpaca-form-button-submit").attrProp("disabled",!0),e.mobile)try{e(".alpaca-form-button-submit").button("refresh")}catch(e){}},"adjustSubmitButtonState":function(){this.disableSubmitButton(),this.isFormValid()&&this.enableSubmitButton()},"processRender":function(t,n){var a=this;if(this.formDescriptor=this.view.getTemplateDescriptor("form"),!this.formDescriptor)return i.throwErrorWithCallback("Could not find template descriptor: form");var s=i.tmpl(this.formDescriptor,{"id":this.getId(),"options":this.options,"view":this.view});s.appendTo(t),this.form=s,this.formFieldsContainer=e(this.form).find("."+i.MARKER_CLASS_FORM_ITEMS_FIELD),this.formFieldsContainer.removeClass(i.MARKER_CLASS_FORM_ITEMS_FIELD),i.isEmpty(this.form.attr("id"))&&this.form.attr("id",this.getId()+"-form-outer"),i.isEmpty(this.form.attr("data-alpaca-form-id"))&&this.form.attr("data-alpaca-form-id",this.getId()),t.find("form").attr(this.attributes),this.buttons={},e(t).find(".alpaca-form-button").each(function(){e(this).on("click",function(i){e(this).attr("button-pushed",!0)});var i=e(this).attr("data-key");if(i){var t=a.options.buttons[i];t&&t.click&&e(this).on("click",function(e,i){return function(t){t.preventDefault(),i.call(e,t)}}(a,t.click))}}),n()},"getId":function(){return this.id},"getType":function(){return this.type},"getParent":function(){return this.parent},"getValue":function(){return this.topControl.getValue()},"setValue":function(e){this.topControl.setValue(e)},"initEvents":function(){var i=this,t=e(this.domEl).find("form"),n=this.getValue();e(t).on("submit",n,function(e){return i.onSubmit(e,i)}),this.options.toggleSubmitValidState&&(e(i.topControl.getFieldEl()).on("fieldupdate",function(){i.adjustSubmitButtonState()}),this.adjustSubmitButtonState())},"getButtonEl":function(i){return e(this.domEl).find(".alpaca-form-button-"+i)},"onSubmit":function(e,t){if(!this.isFormValid())return e.stopPropagation(),this.refreshValidationState(!0),!1;if(this.submitHandler){e.stopPropagation();var n=this.submitHandler(e,t);return i.isUndefined(n)&&(n=!1),n}},"registerSubmitHandler":function(e){i.isFunction(e)&&(this.submitHandler=e)},"refreshValidationState":function(e,i){this.topControl.refreshValidationState(e,i)},"disable":function(){this.topControl.disable()},"enable":function(){this.topControl.enable()},"focus":function(e){this.topControl.on("focus",function(i){e(i)})},"destroy":function(e){this.getFormEl().remove(),!e&&this.parent&&this.parent.destroy()},"show":function(){this.getFormEl().css({"display":""})},"hide":function(){this.getFormEl().css({"display":"none"})},"clear":function(e){this.topControl.clear(e)},"isEmpty":function(){return this.topControl.isEmpty()},"fireCallback":function(e,i,t,n,a,s){this.view.fireCallback(this,e,i,t,n,a,s)},"getFormEl":function(){return this.form},"submit":function(){this.form.submit()},"ajaxSubmit":function(){var i=this;return e.ajax({"data":this.getValue(),"url":i.options.attributes.action,"type":i.options.attributes.method,"dataType":"json"})}})}(jQuery),function(e){var i=e.alpaca;i.Connector=Base.extend({"constructor":function(e,n){this.id=e,this.config=n,this.isUri=function(e){return!i.isEmpty(e)&&i.isUri(e)},this.cache=new t("URL",!0,36e5)},"connect":function(e,i){e()},"loadTemplate":function(e,t,n){
i.isEmpty(e)?n({"message":"Empty data source.","reason":"TEMPLATE_LOADING_ERROR"}):i.isUri(e)?this.loadUri(e,!1,function(e){t&&i.isFunction(t)&&t(e)},function(e){n&&i.isFunction(n)&&n(e)}):t(e)},"loadData":function(e,i,t){return this._handleLoadJsonResource(e,i,t)},"loadSchema":function(e,i,t){return this._handleLoadJsonResource(e,i,t)},"loadOptions":function(e,i,t){return this._handleLoadJsonResource(e,i,t)},"loadView":function(e,i,t){return this._handleLoadJsonResource(e,i,t)},"loadAll":function(e,t,n){var a=this,s=function(){var s=e.dataSource,l=e.schemaSource,r=e.optionsSource,o=e.viewSource;l||"string"!=typeof e.schema||(l=e.schema),r||"string"!=typeof e.options||(r=e.options),o||"string"!=typeof e.view||(o=e.view);var d={},c=0,u=0,h=function(){c===u&&t&&i.isFunction(t)&&t(d.data,d.options,d.schema,d.view)},p=function(e){n&&i.isFunction(n)&&n(e)};if(s&&u++,l&&u++,r&&u++,o&&u++,0===u)return void h();var f=function(e,t,n){d[e]=t,n&&("object"==typeof d[e]&&"object"==typeof n?i.mergeObject(d[e],n):d[e]=n)};s&&a.loadData(s,function(i){f("data",e.data,i),c++,h()},p),l&&a.loadSchema(l,function(i){f("schema",e.schema,i),c++,h()},p),r&&a.loadOptions(r,function(i){f("options",e.options,i),c++,h()},p),o&&a.loadView(o,function(i){f("view",e.view,i),c++,h()},p)},l=function(e){n&&i.isFunction(n)&&n(e)};a.connect(s,l)},"loadJson":function(e,i,t){this.loadUri(e,!0,i,t)},"buildAjaxConfig":function(e,i){var t={"url":e,"type":"get"};return t.dataType=i?"json":"text",t},"loadUri":function(t,n,a,s){var l=this,r=l.buildAjaxConfig(t,n);r.success=function(e){l.cache.put(t,e),a&&i.isFunction(a)&&a(e)},r.error=function(e,n,a){s&&i.isFunction(s)&&s({"message":"Unable to load data from uri : "+t,"stage":"DATA_LOADING_ERROR","details":{"jqXHR":e,"textStatus":n,"errorThrown":a}})};var o=l.cache.get(t);!1!==o&&a&&i.isFunction(a)?a(o):e.ajax(r)},"loadReferenceSchema":function(e,i,t){return this._handleLoadJsonResource(e,i,t)},"loadReferenceOptions":function(e,i,t){return this._handleLoadJsonResource(e,i,t)},"_handleLoadJsonResource":function(e,i,t){this.isUri(e)?this.loadJson(e,function(e){i(e)},t):i(e)}}),i.registerConnectorClass("default",i.Connector);var t=function(e,i,t){switch(this.on=!!i,null!=t&&(this.defaultLifetime=t),this.type=e,this.type){case"URL":this.put=this.put_url;break;case"GET":this.put=this.put_GET}};t.prototype.on=!1,t.prototype.type=void 0,t.prototype.defaultLifetime=18e5,t.prototype.items={},t.prototype.put_url=function(e,i,t){null==t&&(t=this.defaultLifetime);var n=this.make_key(e);return this.items[n]={},this.items[n].key=n,this.items[n].url=e,this.items[n].response=i,this.items[n].expire=(new Date).getTime()+t,!0},t.prototype.put_GET=function(e,i,t,n){null==n&&(n=this.defaultLifetime);var a=this.make_key(e,[i]);return this.items[a]={},this.items[a].key=a,this.items[a].url=e,this.items[a].data=i,this.items[a].response=t,this.items[a].expire=(new Date).getTime()+n,!0},t.prototype.get=function(e,i){var t=this.make_key(e,i);return null!=this.items[t]&&(!(this.items[t].expire<(new Date).getTime())&&this.items[t].response)},t.prototype.make_key=function(e,i){var t=e;switch(this.type){case"URL":break;case"GET":t+=this.stringify(i[0])}return t},t.prototype.flush=function(){return cache.items={},!0},t.prototype.stringify=function(e,i,t){var n;if(gap="",indent="","number"==typeof t)for(n=0;n<t;n+=1)indent+=" ";else"string"==typeof t&&(indent=t);if(rep=i,i&&"function"!=typeof i&&("object"!=typeof i||"number"!=typeof i.length))throw new Error("JSON.stringify");return this.str("",{"":e})},t.prototype.quote=function(e){var i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;return i.lastIndex=0,i.test(e)?'"'+e.replace(i,function(e){var i=meta[e];return"string"==typeof i?i:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},t.prototype.str=function(e,i){var t,n,a,s,l,r=gap,o=i[e];switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(e)),"function"==typeof rep&&(o=rep.call(i,e,o)),typeof o){case"string":return this.quote(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(gap+=indent,l=[],"[object Array]"===Object.prototype.toString.apply(o)){for(s=o.length,t=0;t<s;t+=1)l[t]=this.str(t,o)||"null";return a=0===l.length?"[]":gap?"[\n"+gap+l.join(",\n"+gap)+"\n"+r+"]":"["+l.join(",")+"]",gap=r,a}if(rep&&"object"==typeof rep)for(s=rep.length,t=0;t<s;t+=1)"string"==typeof(n=rep[t])&&(a=this.str(n,o))&&l.push(this.quote(n)+(gap?": ":":")+a);else for(n in o)Object.hasOwnProperty.call(o,n)&&(a=this.str(n,o))&&l.push(this.quote(n)+(gap?": ":":")+a);return a=0===l.length?"{}":gap?"{\n"+gap+l.join(",\n"+gap)+"\n"+r+"}":"{"+l.join(",")+"}",gap=r,a}}}(jQuery),function(e){var i=e.alpaca;i.CloudCmsConnector=i.Connector.extend({"connect":function(e,i){var t=this;Gitana.connect(this.config,function(n){if(n)return void i(n);t.gitana=this,t.gitana.datastore("content").readBranch("master").then(function(){t.branch=this,e()})})},"loadData":function(e,i,t){Chain(this.branch).trap(function(e){return t(e),!1}).readNode(e).then(function(){var e=JSON.parse(JSON.stringify(this));i(e)})},"loadSchema":function(e,i,t){Chain(this.branch).trap(function(e){return t(e),!1}).readDefinition(e).then(function(){var e=JSON.parse(JSON.stringify(this));i(e)})},"loadOptions":function(e,i,t){Chain(this.branch).trap(function(e){return t(e),!1}).readNode(e).then(function(){var e=JSON.parse(JSON.stringify(this));i(e)})},"loadReferenceSchema":function(e,i,t){Chain(this.branch).trap(function(e){return t(e),!1}).readDefinition(e).then(function(){var e=JSON.parse(JSON.stringify(this));i(e)})},"loadReferenceOptions":function(e,i,t){i({})}}),i.registerConnectorClass("cloudcms",i.CloudCmsConnector)}(jQuery),function(e){var i=e.alpaca;i.Fields.TextField=i.ControlField.extend({"getFieldType":function(){return"text"},"setup":function(){this.base(),this.inputType||(this.inputType="text"),this.options.inputType&&(this.inputType=this.options.inputType),this.options.data||(this.options.data={}),this.options.attributes||(this.options.attributes={}),void 0===this.options.allowOptionalEmpty&&(this.options.allowOptionalEmpty=!0),this.options.autocomplete&&"string"==typeof this.options.autocomplete&&("on"===this.options.autocomplete.toLowerCase()?this.options.autocomplete=!0:"true"===this.options.autocomplete.toLowerCase()?this.options.autocomplete=!0:"yes"===this.options.autocomplete.toLowerCase()?this.options.autocomplete=!0:this.options.autocomplete=!1),void 0===this.options.autocomplete&&(this.options.autocomplete=!1),void 0===this.options.disallowEmptySpaces&&(this.options.disallowEmptySpaces=!1)},"destroy":function(){this.base(),this.control&&this.control.typeahead&&this.options.typeahead&&e(this.control).typeahead("destroy")},"postRender":function(e){var i=this;this.base(function(){i.control&&(i.applyAutocomplete(),i.applyMask(),i.applyTypeAhead(),i.updateMaxLengthIndicator()),e()})},"applyAutocomplete":function(){var i=this;i.options.autocomplete&&(e(i.field).addClass("alpaca-autocomplete"),e(i.control).attr("autocomplete",i.options.autocomplete?"on":"off"),i.fireCallback("autocomplete"))},"applyMask":function(){var e=this;e.control.mask&&e.options.maskString&&e.control.mask(e.options.maskString)},"applyTypeAhead":function(){var t=this;if(t.control.typeahead&&t.options.typeahead&&!i.isEmpty(t.options.typeahead)){var n=t.options.typeahead.config;n||(n={});var a=t.options.typeahead.datasets;a||(a={}),a.name||(a.name=t.getId());var s=t.options.typeahead.events;if(s||(s={}),"local"===a.type||"remote"===a.type||"prefetch"===a.type){var l={"datumTokenizer":function(e){return Bloodhound.tokenizers.whitespace(e.value)},"queryTokenizer":Bloodhound.tokenizers.whitespace};if("local"===a.type){var r=[];if("function"==typeof a.source)l.local=a.source;else{for(var o=0;o<a.source.length;o++){var d=a.source[o];"string"==typeof d&&(d={"value":d}),r.push(d)}l.local=r}a.local&&(l.local=a.local)}"prefetch"===a.type&&(l.prefetch={"url":a.source},a.filter&&(l.prefetch.filter=a.filter)),"remote"===a.type&&(l.remote={"url":a.source},a.filter&&(l.remote.filter=a.filter),a.replace&&(l.remote.replace=a.replace));var c=new Bloodhound(l);c.initialize(),a.source=c.ttAdapter()}if(a.templates)for(var u in a.templates){var h=a.templates[u];"string"==typeof h&&(a.templates[u]=Handlebars.compile(h))}e(t.control).typeahead(n,a),e(t.control).on("typeahead:autocompleted",function(i,n){t.setValue(n.value),e(t.control).trigger("change")}),e(t.control).on("typeahead:selected",function(i,n){t.setValue(n.value),e(t.control).trigger("change")}),s&&(s.autocompleted&&e(t.control).on("typeahead:autocompleted",function(e,i){s.autocompleted(e,i)}),s.selected&&e(t.control).on("typeahead:selected",function(e,i){s.selected(e,i)}));var p=e(t.control);e(t.control).on("change",function(){var i=e(this).val(),t=e(p).typeahead("val");t!==i&&e(p).typeahead("val",t)}),e(t.field).find("span.twitter-typeahead").first().css("display","block"),e(t.field).find("span.twitter-typeahead input.tt-input").first().css("background-color","")}},"prepareControlModel":function(e){var i=this;this.base(function(t){t.inputType=i.inputType,e(t)})},"updateMaxLengthIndicator":function(){var t=this,n=!1,a="";if(!i.isEmpty(t.schema.maxLength)&&t.options.showMaxLengthIndicator){var s=t.getValue()||"",l=t.schema.maxLength-s.length;l>=0?a="You have "+l+" characters remaining":(a="Your message is too long by "+-1*l+" characters",n=!0);var r=e(t.field).find(".alpaca-field-text-max-length-indicator");0===r.length&&(r=e("<p class='alpaca-field-text-max-length-indicator'></p>"),e(t.control).after(r)),e(r).html(a),e(r).removeClass("err"),n&&e(r).addClass("err")}},"getValue":function(){var i=this,t=null;if(!this.isDisplayOnly()&&this.control&&this.control.length>0){if(t=this._getControlVal(!0),i.control.mask&&i.options.maskString){var n=e(this.control).data(e.mask.dataName);n&&(t=n(),t=i.ensureProperType(t))}}else t=this.base();return t},"setValue":function(e){this.control&&this.control.length>0&&(i.isEmpty(e)?this.control.val(""):this.control.val(e)),this.base(e),this.updateMaxLengthIndicator()},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validatePattern();return t.invalidPattern={"message":n?"":i.substituteTokens(this.getMessage("invalidPattern"),[this.schema.pattern]),"status":n},n=this._validateMaxLength(),t.stringTooLong={"message":n?"":i.substituteTokens(this.getMessage("stringTooLong"),[this.schema.maxLength]),"status":n},n=this._validateMinLength(),t.stringTooShort={"message":n?"":i.substituteTokens(this.getMessage("stringTooShort"),[this.schema.minLength]),"status":n},e&&t.invalidPattern.status&&t.stringTooLong.status&&t.stringTooShort.status},"_validatePattern":function(){if(this.schema.pattern){var e=this.getValue();if(""===e&&this.options.allowOptionalEmpty&&!this.isRequired())return!0;if(i.isEmpty(e)&&(e=""),this.fieldView&&"url"===this.fieldView.alpacaField.type){var t=/^((http||https):\/\/)/;e.match(/^\?func=[a-z0-9]/i)?this.schema.pattern=/^\?func=[a-z0-9]/i:"writeonly"===this.fieldView.mode&&this.schema.pattern&&!t.test(e)?this.schema.pattern=/^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*(\:[0-9]{1,5})?(([0-9]{1,5})?\/.*)?$/i:this.schema.pattern=/^[a-z0-9]+:\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*(\:[0-9]{1,5})?(([0-9]{1,5})?\/.*)?$/i}if(!e.match(this.schema.pattern))return!1}return!0},"_validateMinLength":function(){if(!i.isEmpty(this.schema.minLength)){var e=this.getValue();if(""===e&&this.options.allowOptionalEmpty&&!this.isRequired())return!0;if(i.isEmpty(e)&&(e=""),e.length<this.schema.minLength)return!1}return!0},"_validateMaxLength":function(){if(!i.isEmpty(this.schema.maxLength)){var e=this.getValue();if(""===e&&this.options.allowOptionalEmpty&&!this.isRequired())return!0;if(i.isEmpty(e)&&(e=""),e.length>this.schema.maxLength)return!1}return!0},"focus":function(i){if(this.control&&this.control.length>0){var t=e(this.control).get(0);try{var n=t.value?t.value.length:0;t.selectionStart=n,t.selectionEnd=n}catch(e){}t.focus(),i&&i(this)}},"getType":function(){return"string"},"onKeyDown":function(e){var t=this;if(8===e.keyCode){if(!i.isEmpty(t.schema.minLength)&&(t.options.constrainLengths||t.options.constrainMinLength)){var n=t.getValue()||"";n.length<=t.schema.minLength&&(e.preventDefault(),e.stopImmediatePropagation())}}else if(!i.isEmpty(t.schema.maxLength)&&(t.options.constrainLengths||t.options.constrainMaxLength)){var n=t.getValue()||"";n.length>=t.schema.maxLength&&(e.preventDefault(),e.stopImmediatePropagation())}32===e.keyCode&&t.options.disallowEmptySpaces&&(e.preventDefault(),e.stopImmediatePropagation())},"onKeyUp":function(e){this.updateMaxLengthIndicator()},"getTitle":function(){return"Single-Line Text"},"getDescription":function(){return"Text field for single-line text."},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{"minLength":{"title":"Minimal Length","description":"Minimal length of the property value.","type":"number"},"maxLength":{"title":"Maximum Length","description":"Maximum length of the property value.","type":"number"},"pattern":{"title":"Pattern","description":"Regular expression for the property value.","type":"string"}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"default":{"helper":"Field default value","type":"text"},"minLength":{"type":"integer"},"maxLength":{"type":"integer"},"pattern":{"type":"text"}}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"size":{"title":"Field Size","description":"Field size.","type":"number","default":40},"maskString":{"title":"Mask Expression","description":"Expression for the field mask. Field masking will be enabled if not empty.","type":"string"},"placeholder":{"title":"Field Placeholder","description":"Field placeholder.","type":"string"},"typeahead":{"title":"Type Ahead","description":"Provides configuration for the $.typeahead plugin if it is available.  For full configuration options, see: https://github.com/twitter/typeahead.js"},"allowOptionalEmpty":{"title":"Allow Optional Empty","description":"Allows this non-required field to validate when the value is empty"},"inputType":{"title":"HTML5 Input Type","description":"Allows for the override of the underlying HTML5 input type.  If not specified, an assumed value is provided based on the kind of input control (i.e. 'text', 'date', 'email' and so forth)","type":"string"},"data":{"title":"Data attributes for the underlying DOM input control","description":"Allows you to specify a key/value map of data attributes that will be added as DOM attribuets for the underlying input control.  The data attributes will be added as data-{name}='{value}'.","type":"object"},"autocomplete":{"title":"HTML autocomplete attribute for the underlying DOM input control","description":"Allows you to specify the autocomplete attribute for the underlying input control whether or not field should have autocomplete enabled.","type":"string"},"disallowEmptySpaces":{"title":"Disallow Empty Spaces","description":"Whether to disallow the entry of empty spaces in the text","type":"boolean","default":!1}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"size":{"type":"integer"},"maskString":{"helper":"a - an alpha character;9 - a numeric character;* - an alphanumeric character","type":"text"},"typeahead":{"type":"object"},"allowOptionalEmpty":{"type":"checkbox"},"inputType":{"type":"text"},"data":{"type":"object"}}})}}),i.registerMessages({"invalidPattern":lang.invalidPattern,"stringTooShort":lang.stringTooShort,"stringTooLong":lang.stringTooLong}),i.registerFieldClass("text",i.Fields.TextField),i.registerDefaultSchemaFieldMapping("string","text")}(jQuery),function(e){var i=e.alpaca;i.Fields.TextAreaField=i.Fields.TextField.extend({"getFieldType":function(){return"textarea"},"setup":function(){this.base(),this.options.rows||(this.options.rows=5),this.options.cols||(this.options.cols=40)},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateWordCount();return t.wordLimitExceeded={"message":n?"":i.substituteTokens(this.getMessage("wordLimitExceeded"),[this.options.wordlimit]),"status":n},e&&t.wordLimitExceeded.status},"_validateWordCount":function(){if(this.options.wordlimit&&this.options.wordlimit>-1){var e=this.data;if(e){if(e.split(" ").length>this.options.wordlimit)return!1}}return!0},"getTitle":function(){return"Multi-Line Text"},"getDescription":function(){return"Textarea field for multiple line text."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"rows":{"title":"Rows","description":"Number of rows","type":"number","default":5},"cols":{"title":"Columns","description":"Number of columns","type":"number","default":40},"wordlimit":{"title":"Word Limit","description":"Limits the number of words allowed in the text area.","type":"number","default":-1}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"rows":{"type":"integer"},"cols":{"type":"integer"},"wordlimit":{"type":"integer"}}})}}),i.registerMessages({"wordLimitExceeded":"The maximum word limit of {0} has been exceeded."}),i.registerFieldClass("textarea",i.Fields.TextAreaField)}(jQuery),function(e){var i=e.alpaca;i.Fields.CheckBoxField=i.ControlField.extend({"getFieldType":function(){return"checkbox"},"setup":function(){var t=this;t.base(),this.options.rightLabel||(this.options.rightLabel=""),void 0===t.options.multiple&&("array"===t.schema.type?t.options.multiple=!0:void 0!==t.schema.enum&&(t.options.multiple=!0)),t.checkboxOptions=[],t.options.multiple&&e.each(t.getEnum(),function(e,n){var a=n;t.options.optionLabels&&(i.isEmpty(t.options.optionLabels[e])?i.isEmpty(t.options.optionLabels[n])||(a=t.options.optionLabels[n]):a=t.options.optionLabels[e]),t.checkboxOptions.push({"value":n,"text":a})})},"getEnum":function(){var e=[];return this.schema&&this.schema.enum&&(e=this.schema.enum),e},"onClick":function(e){this.refreshValidationState()},"prepareControlModel":function(e){var i=this;this.base(function(t){t.checkboxOptions=i.checkboxOptions,e(t)})},"postRender":function(i){var t=this;this.base(function(){if(t.data&&void 0!==t.data&&t.setValue(t.data),e(t.getFieldEl()).find("input:checkbox").on("change",function(e){t.triggerWithPropagation("change")}),t.options.multiple&&(e(t.getFieldEl()).find("input:checkbox").prop("checked",!1),t.data)){var n=t.data;if("string"==typeof t.data){n=t.data.split(",");for(var a=0;a<n.length;a++)n[a]=e.trim(n[a])}for(var s in n)e(t.getFieldEl()).find('input:checkbox[data-checkbox-value="'+n[s]+'"]').prop("checked",!0)}i()})},"getValue":function(){var t=this,n=null;if(t.options.multiple){for(var a=[],s=0;s<t.checkboxOptions.length;s++){var l=e(t.getFieldEl()).find("input[data-checkbox-index='"+s+"']");if(i.checked(l)){var r=e(l).attr("data-checkbox-value");a.push(r)}}"array"===t.schema.type?n=a:"string"===t.schema.type&&(n=a.join(","))}else{var o=e(t.getFieldEl()).find("input");n=o.length>0&&i.checked(e(o[0]))}return n},"setValue":function(t){var n=this,a=function(t){i.isString(t)&&(t="true"===t);var a=e(n.getFieldEl()).find("input");a.length>0&&i.checked(e(a[0]),t)},s=function(a){"string"==typeof a&&(a=a.split(","));for(var s=0;s<a.length;s++)a[s]=i.trim(a[s]);for(var l=0;l<a.length;l++){var r=e(n.getFieldEl()).find('input[data-checkbox-value="'+a[l]+'"]');r.length>0&&i.checked(e(r[0]),t)}},l=!1;n.options.multiple?"string"==typeof t?(s(t),l=!0):i.isArray(t)&&(s(t),l=!0):"boolean"==typeof t?(a(t),l=!0):"string"==typeof t&&(a(t),l=!0),!l&&t&&i.logError("CheckboxField cannot set value for schema.type="+n.schema.type+" and value="+t),this.base(t)},"_validateEnum":function(){var e=this;if(!e.options.multiple)return!0;var t=e.getValue();return!(e.isRequired()||!i.isValEmpty(t))||("string"==typeof t&&(t=t.split(",")),i.anyEquality(t,e.schema.enum))},"disable":function(){e(this.control).find("input").each(function(){e(this).disabled=!0})},"enable":function(){e(this.control).find("input").each(function(){e(this).disabled=!1})},"getType":function(){return"boolean"},"getTitle":function(){return"Checkbox Field"},"getDescription":function(){return"Checkbox Field for boolean (true/false), string ('true', 'false' or comma-delimited string of values) or data array."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"rightLabel":{"title":"Option Label","description":"Optional right-hand side label for single checkbox field.","type":"string"},"multiple":{"title":"Multiple","description":"Whether to render multiple checkboxes for multi-valued type (such as an array or a comma-delimited string)","type":"boolean"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"rightLabel":{"type":"text"},"multiple":{"type":"checkbox"}}})}}),i.registerFieldClass("checkbox",i.Fields.CheckBoxField),i.registerDefaultSchemaFieldMapping("boolean","checkbox")}(jQuery),function(e){var i=e.alpaca;i.Fields.FileField=i.Fields.TextField.extend({"getFieldType":function(){return"file"},"setValue":function(e){this.data=e,this.data=e,this.updateObservable(),this.triggerUpdate()},"getValue":function(){return this.data},"onChange":function(e){this.base(e),this.options.selectionHandler&&this.processSelectionHandler(e.target.files)},"processSelectionHandler":function(e){if(e&&e.length>0&&"undefined"!=typeof FileReader){var i=[],t=0,n=new FileReader;n.onload=function(){var n=this;return function(a){var s=a.target.result;i.push(s),++t===e.length&&n.options.selectionHandler.call(n,e,i)}}.call(this);for(var a=0;a<e.length;a++)n.readAsDataURL(e[a])}},"getTitle":function(){return"File Field"},"getDescription":function(){return"Field for uploading files."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"selectionHandler":{"title":"Selection Handler","description":"Function that should be called when files are selected.  Requires HTML5.","type":"boolean","default":!1}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"selectionHandler":{"type":"checkbox"}}})}}),i.registerFieldClass("file",i.Fields.FileField)}(jQuery),function(e){var i=e.alpaca;i.Fields.ListField=i.ControlField.extend({"setup":function(){var t=this;t.base(),t.selectOptions=[],t.getEnum()&&e.each(t.getEnum(),function(e,n){var a=n;t.options.optionLabels&&(i.isEmpty(t.options.optionLabels[e])?i.isEmpty(t.options.optionLabels[n])||(a=t.options.optionLabels[n]):a=t.options.optionLabels[e]),t.selectOptions.push({"value":n,"text":a})}),t.isRequired()&&!t.data&&!0===t.options.removeDefaultNone&&t.schema.enum&&t.schema.enum.length>0&&(t.data=t.schema.enum[0])},"prepareControlModel":function(e){var i=this;this.base(function(t){t.noneLabel=i.getMessage("noneLabel"),void 0!==i.options.noneLabel&&(t.noneLabel=i.options.noneLabel),t.hideNone=i.isRequired(),void 0!==i.options.removeDefaultNone&&(t.hideNone=i.options.removeDefaultNone),e(t)})},"getEnum":function(){if(this.schema&&this.schema.enum)return this.schema.enum},"getValue":function(t){var n=this;return i.isArray(t)?e.each(t,function(i,a){e.each(n.selectOptions,function(e,n){n.value===a&&(t[i]=n.value)})}):e.each(this.selectOptions,function(e,i){i.value===t&&(t=i.value)}),t},"beforeRenderControl":function(t,n){var a=this;this.base(t,function(){if(a.options.dataSource){a.selectOptions=[];var s=function(){a.schema.enum=[],a.options.optionLabels=[];for(var e=0;e<a.selectOptions.length;e++)a.schema.enum.push(a.selectOptions[e].value),a.options.optionLabels.push(a.selectOptions[e].text);t.selectOptions=a.selectOptions,n()};if(i.isFunction(a.options.dataSource))a.options.dataSource.call(a,function(e){if(i.isArray(e)){for(var t=0;t<e.length;t++)"string"==typeof e[t]?a.selectOptions.push({"text":e[t],"value":e[t]}):i.isObject(e[t])&&a.selectOptions.push(e[t]);s()}else if(i.isObject(e)){for(var n in e)a.selectOptions.push({"text":n,"value":e[n]});s()}else s()});else if(i.isUri(a.options.dataSource))e.ajax({"url":a.options.dataSource,"type":"get","dataType":"json","success":function(t){var n=t;a.options.dsTransformer&&i.isFunction(a.options.dsTransformer)&&(n=a.options.dsTransformer(n)),n&&(i.isObject(n)?(e.each(n,function(e,i){a.selectOptions.push({"value":e,"text":i})}),s()):i.isArray(n)&&(e.each(n,function(e,i){a.selectOptions.push({"value":i.value,"text":i.text})}),s()))},"error":function(e,i,t){a.errorCallback({"message":"Unable to load data from uri : "+_this.options.dataSource,"stage":"DATASOURCE_LOADING_ERROR","details":{"jqXHR":e,"textStatus":i,"errorThrown":t}})}});else if(i.isArray(a.options.dataSource)){for(var l=0;l<a.options.dataSource.length;l++)"string"==typeof a.options.dataSource[l]?a.selectOptions.push({"text":a.options.dataSource[l],"value":a.options.dataSource[l]}):i.isObject(a.options.dataSource[l])&&a.selectOptions.push(a.options.dataSource[l]);s()}else n()}else n()})},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{"enum":{"title":"Enumeration","description":"List of field value options","type":"array","required":!0}}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"optionLabels":{"title":"Option Labels","description":"Labels for options. It can either be a map object or an array field that maps labels to items defined by enum schema property one by one.","type":"array"},"dataSource":{"title":"Option Datasource","description":"Datasource for generating list of options.  This can be a string or a function.  If a string, it is considered to be a URI to a service that produces a object containing key/value pairs or an array of elements of structure {'text': '', 'value': ''}.  This can also be a function that is called to produce the same list.","type":"string"},"removeDefaultNone":{"title":"Remove Default None","description":"If true, the default 'None' option will not be shown.","type":"boolean","default":!1},"noneLabel":{"title":"None Label","description":"The label to use for the 'None' option in a list (select, radio or otherwise).","type":"string","default":"None"},"hideNone":{"title":"Hide None","description":"Whether to hide the None option from a list (select, radio or otherwise).  This will be true if the field is required and false otherwise.","type":"boolean","default":!1}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"optionLabels":{"itemLabel":"Label","type":"array"},"dataSource":{"type":"text"},"removeDefaultNone":{"type":"checkbox","rightLabel":"Remove Default None"},"noneLabel":{"type":"text"},"hideNone":{"type":"checkbox","rightLabel":"Hide the 'None' option from the list"}}})}}),i.registerMessages({"noneLabel":lang.noneLabel})}(jQuery),function(e){var i=e.alpaca;i.Fields.RadioField=i.Fields.ListField.extend({"getFieldType":function(){return"radio"},"setup":function(){this.base(),this.options.name?this.name=this.options.name:this.name||(this.name=this.getId()+"-name"),i.isUndefined(this.options.emptySelectFirst)&&(this.options.emptySelectFirst=!1),i.isUndefined(this.options.vertical)&&(this.options.vertical=!0)},"getValue":function(){var i=this,t=null;return e(this.control).find(":checked").each(function(){t=e(this).val(),t=i.ensureProperType(t)}),t},"setValue":function(t){var n=this;e(this.control).find("input").each(function(){i.checked(e(this),null)}),void 0!==t&&i.checked(e(n.control).find('input[value="'+t+'"]'),"checked"),this.options.emptySelectFirst&&0===e(this.control).find("input:checked").length&&i.checked(e(n.control).find("input:radio").first(),"checked"),this.base(t)},"initControlEvents":function(){var i=this;i.base();var t=e(this.control).find("input");t.on("focus",function(e){i.suspendBlurFocus||(i.onFocus.call(i,e),i.trigger("focus",e))}),t.on("blur",function(e){i.suspendBlurFocus||(i.onBlur.call(i,e),i.trigger("blur",e))})},"prepareControlModel":function(e){var i=this;this.base(function(t){t.selectOptions=i.selectOptions,t.removeDefaultNone=i.options.removeDefaultNone,e(t)})},"afterRenderControl":function(t,n){var a=this;this.base(t,function(){a.options.emptySelectFirst&&a.selectOptions&&a.selectOptions.length>0&&(a.data=a.selectOptions[0].value,0===e("input:radio:checked",a.control).length&&i.checked(e(a.control).find('input:radio[value="'+a.data+'"]'),"checked")),a.options.vertical?e(a.control).css("display","block"):e(a.control).css("display","inline-block"),n()})},"onClick":function(i){this.base(i);var t=this,n=e(i.currentTarget).find("input").val();void 0!==n&&(t.setValue(n),t.refreshValidationState())},"getTitle":function(){return"Radio Group Field"},"getDescription":function(){return"Radio Group Field with list of options."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"name":{"title":"Field name","description":"Field name.","type":"string"},"emptySelectFirst":{"title":"Empty Select First","description":"If the data is empty, then automatically select the first item in the list.","type":"boolean","default":!1},"vertical":{"title":"Position the radio selector items vertically","description":"By default, radio controls are stacked vertically.  Set to false if you'd like radio controls to lay out horizontally.","type":"boolean","default":!0}}})}}),i.registerFieldClass("radio",i.Fields.RadioField)}(jQuery),function(e){var i=e.alpaca;i.Fields.SelectField=i.Fields.ListField.extend({"getFieldType":function(){return"select"},"setup":function(){this.base()},"getValue":function(){if(this.control&&this.control.length>0){var e=this._getControlVal(!0);return void 0===e&&(e=this.data),this.base(e)}},"setValue":function(e){i.isArray(e)?i.compareArrayContent(e,this.getValue())||(!i.isEmpty(e)&&this.control&&this.control.val(e),this.base(e)):e!==this.getValue()&&(this.control&&void 0!==e&&null!=e&&this.control.val(e),this.base(e))},"getEnum":function(){if(this.schema){if(this.schema.enum)return this.schema.enum;if(this.schema.type&&"array"===this.schema.type&&this.schema.items&&this.schema.items.enum)return this.schema.items.enum}},"initControlEvents":function(){var e=this;if(e.base(),e.options.multiple){var i=this.control.parent().find("button.multiselect");i.on("focus",function(i){e.suspendBlurFocus||(e.onFocus.call(e,i),e.trigger("focus",i))}),i.on("blur",function(i){e.suspendBlurFocus||(e.onBlur.call(e,i),e.trigger("blur",i))})}},"beforeRenderControl":function(e,i){var t=this;this.base(e,function(){t.schema.type&&"array"===t.schema.type&&(t.options.multiple=!0),i()})},"prepareControlModel":function(e){var i=this;this.base(function(t){t.selectOptions=i.selectOptions,e(t)})},"afterRenderControl":function(t,n){var a=this;this.base(t,function(){if(i.isUndefined(a.data)&&a.options.emptySelectFirst&&a.selectOptions&&a.selectOptions.length>0&&(a.data=a.selectOptions[0].value),a.data&&a.setValue(a.data),a.options.multiple&&e.fn.multiselect){var t=null;t=a.options.multiselect?a.options.multiselect:{},t.nonSelectedText||(t.nonSelectedText="None",a.options.noneLabel&&(t.nonSelectedText=a.options.noneLabel)),a.options.hideNone&&delete t.nonSelectedText,e(a.getControlEl()).multiselect(t)}n()})},"_validateEnum":function(){var t=this;if(this.schema.enum){var n=this.data;if(!this.isRequired()&&i.isValEmpty(n))return!0;if(this.options.multiple){var a=!0;return n||(n=[]),i.isArray(n)||i.isObject(n)||(n=[n]),e.each(n,function(i,n){if(e.inArray(n,t.schema.enum)<=-1)return a=!1,!1}),a}return e.inArray(n,this.schema.enum)>-1}return!0},"onChange":function(e){this.base(e);var t=this;i.later(25,this,function(){var e=t.getValue();t.setValue(e),t.refreshValidationState()})},"_validateMinItems":function(){return!(this.schema.items&&this.schema.items.minItems&&e(":selected",this.control).length<this.schema.items.minItems)},"_validateMaxItems":function(){return!(this.schema.items&&this.schema.items.maxItems&&e(":selected",this.control).length>this.schema.items.maxItems)},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateMaxItems();return t.tooManyItems={
"message":n?"":i.substituteTokens(this.getMessage("tooManyItems"),[this.schema.items.maxItems]),"status":n},n=this._validateMinItems(),t.notEnoughItems={"message":n?"":i.substituteTokens(this.getMessage("notEnoughItems"),[this.schema.items.minItems]),"status":n},e&&t.tooManyItems.status&&t.notEnoughItems.status},"getTitle":function(){return"Select Field"},"getDescription":function(){return"Select Field"},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"multiple":{"title":"Mulitple Selection","description":"Allow multiple selection if true.","type":"boolean","default":!1},"size":{"title":"Displayed Options","description":"Number of options to be shown.","type":"number"},"emptySelectFirst":{"title":"Empty Select First","description":"If the data is empty, then automatically select the first item in the list.","type":"boolean","default":!1},"multiselect":{"title":"Multiselect Plugin Settings","description":"Multiselect plugin properties - http://davidstutz.github.io/bootstrap-multiselect","type":"any"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"multiple":{"rightLabel":"Allow multiple selection ?","helper":"Allow multiple selection if checked","type":"checkbox"},"size":{"type":"integer"},"emptySelectFirst":{"type":"checkbox","rightLabel":"Empty Select First"},"multiselect":{"type":"object","rightLabel":"Multiselect plugin properties - http://davidstutz.github.io/bootstrap-multiselect"}}})}}),i.registerFieldClass("select",i.Fields.SelectField)}(jQuery),function(e){var i=e.alpaca;i.Fields.NumberField=i.Fields.TextField.extend({"setup":function(){this.base()},"getFieldType":function(){return"number"},"getValue":function(){var e=this._getControlVal(!0);return void 0===e||""==e?e:parseFloat(e)},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateNumber();return t.stringNotANumber={"message":n?"":this.getMessage("stringNotANumber"),"status":n},n=this._validateDivisibleBy(),t.stringDivisibleBy={"message":n?"":i.substituteTokens(this.getMessage("stringDivisibleBy"),[this.schema.divisibleBy]),"status":n},n=this._validateMaximum(),t.stringValueTooLarge={"message":"","status":n},n||(this.schema.exclusiveMaximum?t.stringValueTooLarge.message=i.substituteTokens(this.getMessage("stringValueTooLargeExclusive"),[this.schema.maximum]):t.stringValueTooLarge.message=i.substituteTokens(this.getMessage("stringValueTooLarge"),[this.schema.maximum])),n=this._validateMinimum(),t.stringValueTooSmall={"message":"","status":n},n||(this.schema.exclusiveMinimum?t.stringValueTooSmall.message=i.substituteTokens(this.getMessage("stringValueTooSmallExclusive"),[this.schema.minimum]):t.stringValueTooSmall.message=i.substituteTokens(this.getMessage("stringValueTooSmall"),[this.schema.minimum])),n=this._validateMultipleOf(),t.stringValueNotMultipleOf={"message":"","status":n},n||(t.stringValueNotMultipleOf.message=i.substituteTokens(this.getMessage("stringValueNotMultipleOf"),[this.schema.multipleOf])),e&&t.stringNotANumber.status&&t.stringDivisibleBy.status&&t.stringValueTooLarge.status&&t.stringValueTooSmall.status&&t.stringValueNotMultipleOf.status},"_validateNumber":function(){var e=this._getControlVal();if("number"==typeof e&&(e=""+e),i.isValEmpty(e))return!0;if(!i.testRegex(i.regexps.number,e))return!1;var t=this.getValue();return!isNaN(t)},"_validateDivisibleBy":function(){var e=this.getValue();return!(!i.isEmpty(this.schema.divisibleBy)&&e%this.schema.divisibleBy!=0)},"_validateMaximum":function(){var e=this.getValue();if(!i.isEmpty(this.schema.maximum)){if(e>this.schema.maximum)return!1;if(!i.isEmpty(this.schema.exclusiveMaximum)&&e==this.schema.maximum&&this.schema.exclusiveMaximum)return!1}return!0},"_validateMinimum":function(){var e=this.getValue();if(!i.isEmpty(this.schema.minimum)){if(e<this.schema.minimum)return!1;if(!i.isEmpty(this.schema.exclusiveMinimum)&&e==this.schema.minimum&&this.schema.exclusiveMinimum)return!1}return!0},"_validateMultipleOf":function(){var e=this.getValue();return!(!i.isEmpty(this.schema.multipleOf)&&e&&0!==this.schema.multipleOf)},"getType":function(){return"number"},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{"multipleOf":{"title":"Multiple Of","description":"Property value must be a multiple of the multipleOf schema property such that division by this value yields an interger (mod zero).","type":"number"},"minimum":{"title":"Minimum","description":"Minimum value of the property.","type":"number"},"maximum":{"title":"Maximum","description":"Maximum value of the property.","type":"number"},"exclusiveMinimum":{"title":"Exclusive Minimum","description":"Property value can not equal the number defined by the minimum schema property.","type":"boolean","default":!1},"exclusiveMaximum":{"title":"Exclusive Maximum","description":"Property value can not equal the number defined by the maximum schema property.","type":"boolean","default":!1}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"multipleOf":{"title":"Multiple Of","description":"The value must be a integral multiple of the property","type":"number"},"minimum":{"title":"Minimum","description":"Minimum value of the property","type":"number"},"maximum":{"title":"Maximum","description":"Maximum value of the property","type":"number"},"exclusiveMinimum":{"rightLabel":"Exclusive minimum ?","helper":"Field value must be greater than but not equal to this number if checked","type":"checkbox"},"exclusiveMaximum":{"rightLabel":"Exclusive Maximum ?","helper":"Field value must be less than but not equal to this number if checked","type":"checkbox"}}})},"getTitle":function(){return"Number Field"},"getDescription":function(){return"Field for float numbers."}}),i.registerMessages({"stringValueTooSmall":lang.stringValueTooSmallExclusive,"stringValueTooLarge":lang.stringValueTooLarge,"stringValueTooSmallExclusive":lang.stringValueTooSmallExclusive,"stringValueTooLargeExclusive":lang.stringValueTooLargeExclusive,"stringDivisibleBy":lang.stringDivisibleBy,"stringNotANumber":lang.stringNotANumber,"stringValueNotMultipleOf":lang.stringValueNotMultipleOf}),i.registerFieldClass("number",i.Fields.NumberField),i.registerDefaultSchemaFieldMapping("number","number")}(jQuery),function(e){var i=e.alpaca;i.Fields.ArrayField=i.ContainerField.extend({"getFieldType":function(){return"array"},"setup":function(){var t=this;this.base();var n=t.resolveContainerItemTemplateType();if(!n)return i.throwErrorWithCallback("Unable to find template descriptor for container item: "+t.getFieldType());this.containerItemTemplateDescriptor=t.view.getTemplateDescriptor("container-"+n+"-item",t),this.options.toolbarStyle||(this.options.toolbarStyle=i.isEmpty(this.view.toolbarStyle)?"button":this.view.toolbarStyle),this.options.toolbarStyle||(this.options.toolbarStyle="button"),this.options.actionbarStyle||(this.options.actionbarStyle=i.isEmpty(this.view.actionbarStyle)?"top":this.view.actionbarStyle),this.options.actionbarStyle||(this.options.actionbarStyle="top"),this.schema.items&&(this.schema.items.maxItems&&(this.schema.maxItems=this.schema.items.maxItems,delete this.schema.items.maxItems),this.schema.items.minItems&&(this.schema.minItems=this.schema.items.minItems,delete this.schema.items.minItems),this.schema.items.uniqueItems&&(this.schema.uniqueItems=this.schema.items.uniqueItems,delete this.schema.items.uniqueItems)),this.options.rubyrails=!1,this.parent&&this.parent.options&&this.parent.options.form&&this.parent.options.form.attributes&&(i.isEmpty(this.parent.options.form.attributes.rubyrails)||(this.options.rubyrails=!0)),this.options.items||(this.options.items={});var a=void 0;if(i.isEmpty(this.view.toolbarSticky)||(a=this.view.toolbarSticky),i.isEmpty(this.options.toolbarSticky)||(a=this.options.toolbarSticky),this.options.toolbarSticky=a,this.schema.items&&this.schema.uniqueItems&&i.mergeObject(this.options,{"forceRevalidation":!0}),void 0===this.data&&(this.data=[]),null==this.data&&(this.data=[]),""===this.data&&(this.data=[]),i.isString(this.data))try{var s=i.parseJSON(this.data);if(!i.isArray(s)&&!i.isObject(s))return void i.logWarn("ArrayField parsed string data but it was not an array: "+this.data);this.data=s}catch(e){this.data=[this.data]}if(!i.isArray(this.data)&&!i.isObject(this.data))return void i.logWarn("ArrayField data is not an array: "+JSON.stringify(this.data,null,"  "));var l=function(e,i,n){var a=t.findAction(e,i);a||(a={"core":!0},e.push(a));for(var s in n)a[s]||(a[s]=n[s])},r=function(e,i){var t=0;do{void 0===e[t].enabled&&(e[t].enabled=!0),i||delete e[t].label,e[t].enabled?t++:e.splice(t,1)}while(t<e.length);e.sort(function(e,i){return e.core&&!i.core?-1:!e.core&&i.core?1:0})};if(t.toolbar={},t.options.toolbar)for(var o in t.options.toolbar)t.toolbar[o]=t.options.toolbar[o];if(void 0===t.toolbar.showLabels&&(t.toolbar.showLabels=!0),t.toolbar.actions||(t.toolbar.actions=[]),l(t.toolbar.actions,"add",{"label":t.getMessage("addItemButtonLabel"),"action":"add","iconClass":t.view.getStyle("addIcon"),"click":function(e,n){t.resolveItemSchemaOptions(function(e,n,a){if(a)return i.throwErrorWithCallback("Circular reference detected for schema: "+JSON.stringify(e),t.errorCallback);var s=i.createEmptyDataInstance(e);t.addItem(0,e,n,s,function(){})})}}),r(t.toolbar.actions,t.toolbar.showLabels),t.actionbar={},t.options.actionbar)for(var d in t.options.actionbar)t.actionbar[d]=t.options.actionbar[d];void 0===t.actionbar.showLabels&&(t.actionbar.showLabels=!1),t.actionbar.actions||(t.actionbar.actions=[]),l(t.actionbar.actions,"add",{"label":t.getMessage("addButtonLabel"),"action":"add","iconClass":t.view.getStyle("addIcon"),"click":function(e,n,a){t=this,t.resolveItemSchemaOptions(function(e,n,s){if(s)return i.throwErrorWithCallback("Circular reference detected for schema: "+JSON.stringify(e),t.errorCallback);var l=i.createEmptyDataInstance(e);t.addItem(a+1,e,n,l,function(){})})}}),l(t.actionbar.actions,"remove",{"label":t.getMessage("removeButtonLabel"),"action":"remove","iconClass":t.view.getStyle("removeIcon"),"click":function(e,i,n){t=this,t.removeItem(n,function(){})}}),l(t.actionbar.actions,"up",{"label":t.getMessage("upButtonLabel"),"action":"up","iconClass":t.view.getStyle("upIcon"),"click":function(e,i,n){t.moveItem(n,n-1,t.options.animate,function(){})}}),l(t.actionbar.actions,"down",{"label":t.getMessage("downButtonLabel"),"action":"down","iconClass":t.view.getStyle("downIcon"),"click":function(e,i,n){t.moveItem(n,n+1,t.options.animate,function(){})}}),r(t.actionbar.actions,t.actionbar.showLabels);var c=this.data.length,u=e.extend(!0,{},this.data);u.length=c,this.data=Array.prototype.slice.call(u)},"setValue":function(e){var t=this;if(e&&i.isArray(e)){var n=0;do{if(n<t.children.length){var a=t.children[n];e.length>n?(a.setValue(e[n]),n++):t.removeItem(n)}}while(n<t.children.length);n<e.length&&t.resolveItemSchemaOptions(function(a,s,l){if(a||i.logDebug("Unable to resolve schema for item: "+n),l)return i.throwErrorWithCallback("Circular reference detected for schema: "+JSON.stringify(a),t.errorCallback);for(var r=[];n<e.length;){var o=function(e,n){return function(l){t.addItem(e,a,s,n[e],function(){i.nextTick(function(){l()})})}}(n,e[n]);r.push(o),n++}i.series(r,function(){})})}},"getValue":function(){var e=this.view.field.schema.items.minItems&&0!==this.view.field.schema.items.minItems?0:this.view.field.schema.items.minItems-1;if(this.children.length!==e||this.isRequired()){for(var i=[],t=0;t<this.children.length;t++){var n=this.children[t].getValue();void 0!==n&&i.push(n)}return i}},"createItems":function(e){var t=this,n=[];t.data&&t.data.length>0?t.resolveItemSchemaOptions(function(a,s,l){if(l)return i.throwErrorWithCallback("Circular reference detected for schema: "+JSON.stringify(a),t.errorCallback);for(var r=[],o=0;o<t.data.length;o++){var d=t.data[o],c=function(e,l){return function(r){t.createItem(e,a,s,l,function(e){n.push(e),i.nextTick(function(){r()})})}}(o,d);r.push(c)}i.series(r,function(i){e(n)})}):e(n)},"createItem":function(t,n,a,s,l){var r=this;if(r._validateEqualMaxItems()){e("<div></div>").alpaca({"data":s,"options":a,"schema":n,"view":this.view.id?this.view.id:this.view,"connector":this.connector,"error":function(e){r.destroy(),r.errorCallback.call(r,e)},"notTopLevel":!0,"render":function(e,i){e.parent=r,e.path=r.path+"["+t+"]",e.render(null,function(){r.refreshValidationState(),r.updatePathAndName(),r.triggerUpdate(),i&&i()})},"postRender":function(t){var n=i.tmpl(r.containerItemTemplateDescriptor,{"id":r.getId(),"name":t.name,"parentFieldId":r.getId(),"actionbarStyle":r.options.actionbarStyle,"view":r.view,"data":s}),a=e(n).find("."+i.MARKER_CLASS_CONTAINER_FIELD_ITEM_FIELD);if(0===a.length&&e(n).hasClass(i.MARKER_CLASS_CONTAINER_FIELD_ITEM_FIELD)&&(a=e(n)),0===a.length)return void r.errorCallback.call(r,{"message":"Cannot find insertion point for field: "+r.getId()});e(a).before(t.getFieldEl()),e(a).remove(),t.containerItemEl=n,i.fieldApplyFieldAndChildren(t,function(e){e.hideInitValidationError=!1}),i.isFunction(r.options.items.postRender)&&r.options.items.postRender.call(t,a),l&&l(t)}})}},"resolveItemSchemaOptions":function(e){var t,n=this,a=function(i,t,a){n.options.readonly&&(t.readonly=!0),e(i,t,a)};!t&&n.options&&n.options.fields&&n.options.fields.item&&(t=n.options.fields.item),!t&&n.options&&n.options.items&&(t=n.options.items);var s;if(n.schema&&n.schema.items&&(s=n.schema.items),s&&s.$ref){for(var l=s.$ref,r=this,o=[r];r.parent;)r=r.parent,o.push(r);var d=s,c=t;i.loadRefSchemaOptions(r,l,function(e,t){for(var n=0,s=0;s<o.length;s++)o[s].schema&&(o[s].schema.id===l||o[s].schema.id==="#"+l?n++:o[s].schema.$ref===l&&n++);var r=n>10,u={};d&&i.mergeObject(u,d),e&&i.mergeObject(u,e),delete u.id;var h={};c&&i.mergeObject(h,c),t&&i.mergeObject(h,t),i.nextTick(function(){a(u,h,r)})})}else i.nextTick(function(){a(s,t)})},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateUniqueItems();return t.valueNotUnique={"message":n?"":this.getMessage("valueNotUnique"),"status":n},n=this._validateMaxItems(),t.tooManyItems={"message":n?"":i.substituteTokens(this.getMessage("tooManyItems"),[this.schema.maxItems]),"status":n},n=this._validateMinItems(),t.notEnoughItems={"message":n?"":i.substituteTokens(this.getMessage("notEnoughItems"),[this.schema.minItems]),"status":n},e&&t.valueNotUnique.status&&t.tooManyItems.status&&t.notEnoughItems.status},"_validateEqualMaxItems":function(){return!(this.schema.maxItems&&this.schema.maxItems>=0&&this.getSize()>=this.schema.maxItems)},"_validateEqualMinItems":function(){return!(this.schema.minItems&&this.schema.minItems>=0&&this.getSize()<=this.schema.minItems)},"_validateMinItems":function(){return!(this.schema.minItems&&this.schema.minItems>=0&&1!==this.getSize()&&this.getSize()<this.schema.minItems)},"_validateMaxItems":function(){return!(this.schema.maxItems&&this.schema.maxItems>=0&&this.getSize()>this.schema.maxItems)},"_validateUniqueItems":function(){if(this.schema.items&&this.schema.uniqueItems)for(var e={},i=0,t=this.children.length;i<t;++i){if(e.hasOwnProperty(this.children[i]))return!1;e[this.children[i]]=!0}return!0},"findAction":function(i,t){var n=null;return e.each(i,function(e,i){i.action==t&&(n=i)}),n},"postRender":function(e){var i=this;this.base(function(){i.updateToolbars(),e()})},"getSize":function(){return this.children.length},"updatePathAndName":function(){var t=function(n){n.children&&e.each(n.children,function(a,s){n.prePath&&i.startsWith(s.path,n.prePath)&&(s.prePath=s.path,s.path=s.path.replace(n.prePath,n.path)),n.preName&&i.startsWith(s.name,n.preName)&&(s.preName=s.name,s.name=s.name.replace(n.preName,n.name),s.field&&e(s.field).attr("data-name",s.name)),t(s)})};this.children&&this.children.length>0&&e.each(this.children,function(i,n){var a=n.path.lastIndexOf("/"),s=n.path.substring(a+1);s.indexOf("[")<0&&s.indexOf("]")<0&&(s=s.substring(s.indexOf("[")+1,s.indexOf("]"))),s!==i&&(n.prePath=n.path,n.path=n.path.substring(0,a)+"/["+i+"]"),n.nameCalculated&&(n.preName=n.name,n.parent&&n.parent.name&&n.path?n.name=n.parent.name+"_"+i:n.path&&(n.name=n.path.replace(/\//g,"").replace(/\[/g,"_").replace(/\]/g,"")),this.parent.options.rubyrails?e(n.field).attr("data-name",n.parent.name):e(n.field).attr("data-name",n.name)),n.prePath||(n.prePath=n.path),t(n)})},"updateToolbars":function(){var i=this;if("display"!==this.view.type&&!this.schema.readonly){i.toolbar&&(i.fireCallback("arrayToolbar",!0),i.fireCallback("arrayToolbar")),i.actionbar&&(i.fireCallback("arrayActionbars",!0),i.fireCallback("arrayActionbars"));var t=e(this.getFieldEl()).find(".alpaca-array-toolbar[data-alpaca-array-toolbar-field-id='"+i.getId()+"']");if(this.children.length>0?e(t).hide():(e(t).show(),e(t).find("[data-alpaca-array-toolbar-action]").each(function(){var t=e(this).attr("data-alpaca-array-toolbar-action"),n=i.findAction(i.toolbar.actions,t);n&&e(this).off().on("click",function(e){e.preventDefault(),n.click.call(i,t,n)})})),void 0===this.options.toolbarSticky){var n=this.getFieldEl().find(".alpaca-container-item");e(n).each(function(t){var n=e(i.getFieldEl()).find(".alpaca-array-actionbar[data-alpaca-array-actionbar-parent-field-id='"+i.getId()+"'][data-alpaca-array-actionbar-item-index='"+t+"']");n&&n.length>0&&(e(this).hover(function(){e(n).show()},function(){e(n).hide()}),e(n).hide())})}else this.options.toolbarSticky?e(i.getFieldEl()).find(".alpaca-array-actionbar[data-alpaca-array-actionbar-parent-field-id='"+i.getId()+"']").show():this.options.toolbarSticky||e(i.getFieldEl()).find(".alpaca-array-actionbar[data-alpaca-array-actionbar-parent-field-id='"+i.getId()+"']").hide();var a=e(i.getFieldEl()).find(".alpaca-array-actionbar[data-alpaca-array-actionbar-parent-field-id='"+i.getId()+"']");e(a).each(function(){var t=e(this).attr("data-alpaca-array-actionbar-item-index");"string"==typeof t&&(t=parseInt(t,10)),e(this).find("[data-alpaca-array-actionbar-action]").each(function(){var n=e(this).attr("data-alpaca-array-actionbar-action"),a=i.findAction(i.actionbar.actions,n);a&&e(this).off().on("click",function(e){e.preventDefault(),a.click.call(i,n,a,t)})}),i._validateEqualMaxItems()?e(this).find("[data-alpaca-array-actionbar-action='add']").each(function(t){e(this).removeClass("alpaca-button-disabled"),i.fireCallback("enableButton",this)}):e(this).find("[data-alpaca-array-actionbar-action='add']").each(function(t){e(this).addClass("alpaca-button-disabled"),i.fireCallback("disableButton",this)}),i._validateEqualMinItems()?e(this).find("[data-alpaca-array-actionbar-action='remove']").each(function(t){e(this).removeClass("alpaca-button-disabled"),i.fireCallback("enableButton",this)}):e(this).find("[data-alpaca-array-actionbar-action='remove']").each(function(t){e(this).addClass("alpaca-button-disabled"),i.fireCallback("disableButton",this)})}),e(a).first().find("[data-alpaca-array-actionbar-action='up']").each(function(){e(this).addClass("alpaca-button-disabled"),i.fireCallback("disableButton",this)}),e(a).last().find("[data-alpaca-array-actionbar-action='down']").each(function(){e(this).addClass("alpaca-button-disabled"),i.fireCallback("disableButton",this)})}},"doResolveItemContainer":function(){return e(this.container)},"doAddItem":function(i,t){var n=this,a=n.doResolveItemContainer();if(0===i)e(a).append(t.containerItemEl);else{var s=a.children("[data-alpaca-container-item-index='"+(i-1)+"']");s&&s.length>0&&s.after(t.containerItemEl)}n.doAfterAddItem(t)},"doAfterAddItem":function(e){},"addItem":function(e,i,t,n,a){var s=this;s._validateEqualMaxItems()&&s.createItem(e,i,t,n,function(i){s.registerChild(i,e),s.doAddItem(e,i),s.updateChildDOMElements(),s.updateToolbars(),s.refreshValidationState(),s.triggerUpdate(),a&&a()})},"doRemoveItem":function(e){this.doResolveItemContainer().children(".alpaca-container-item[data-alpaca-container-item-index='"+e+"']").remove()},"removeItem":function(e,i){var t=this;this._validateEqualMinItems()&&(t.unregisterChild(e),t.doRemoveItem(e),t.updateChildDOMElements(),t.updateToolbars(),t.refreshValidationState(),t.triggerUpdate(),i&&i())},"moveItem":function(t,n,a,s){var l=this;if("function"==typeof a&&(s=a,a=l.options.animate),void 0===a&&(a=!l.options.animate||l.options.animate),"string"==typeof t&&(t=parseInt(t,10)),"string"==typeof n&&(n=parseInt(n,10)),n<0&&(n=0),n>=l.children.length&&(n=l.children.length-1),-1!==n&&t!==n){if(l.children[n]){var r=l.getId(),o=l.getContainerEl().find(".alpaca-container-item[data-alpaca-container-item-index='"+t+"'][data-alpaca-container-item-parent-field-id='"+r+"']"),d=l.getContainerEl().find(".alpaca-container-item[data-alpaca-container-item-index='"+n+"'][data-alpaca-container-item-parent-field-id='"+r+"']"),c=e("<div class='tempMarker1'></div>");o.before(c);var u=e("<div class='tempMarker2'></div>");d.before(u);var h=function(){for(var i=[],a=0;a<l.children.length;a++)i[a]=a===t?l.children[n]:a===n?l.children[t]:l.children[a];l.children=i,c.replaceWith(d),u.replaceWith(o),l.updateChildDOMElements(),e(o).find(".alpaca-container-item[data-alpaca-array-actionbar-item-index='"+t+"']").attr("data-alpaca-array-actionbar-item-index",n),e(d).find(".alpaca-container-item[data-alpaca-array-actionbar-item-index='"+n+"']").attr("data-alpaca-array-actionbar-item-index",t),l.updateToolbars(),l.refreshValidationState(),l.triggerUpdate(),s&&s()},p=0;a&&(p=500),i.animatedSwap(o,d,p,function(){h()})}}},"getType":function(){return"array"},"getTitle":function(){return"Array Field"},"getDescription":function(){return"Field for list of items with same data type or structure."},"getSchemaOfSchema":function(){var e={"properties":{"items":{"title":"Array Items","description":"Schema for array items.","type":"object"},"minItems":{"title":"Minimum Items","description":"Minimum number of items.","type":"number"},"maxItems":{"title":"Maximum Items","description":"Maximum number of items.","type":"number"},"uniqueItems":{"title":"Items Unique","description":"Item values should be unique if true.","type":"boolean","default":!1}}};return this.children&&this.children[0]&&i.merge(e.properties.items.properties,this.children[0].getSchemaOfSchema()),i.merge(this.base(),e)},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"items":{"type":"object"},"minItems":{"type":"integer"},"maxItems":{"type":"integer"},"uniqueItems":{"type":"checkbox"}}})},"getSchemaOfOptions":function(){var e={"properties":{"toolbarSticky":{"title":"Sticky Toolbar","description":"If true, the array item toolbar will always be enabled.  If false, the toolbar is always disabled.  If undefined or null, the toolbar will appear when hovered over.","type":"boolean","default":void 0},"toolbarStyle":{"title":"Toolbar Style","description":"The kind of top-level toolbar to render for the array field.  Either 'button' or 'link'.","type":"string","default":"button"},"actionbarStyle":{"title":"Actionbar Style","description":"The kind of actionbar to render for each item in the array.  Either 'top', 'bottom', 'left', or 'right'.","type":"string","default":"top"},"toolbar":{"type":"object","title":"Toolbar Configuration","properties":{"showLabels":{"type":"boolean","default":!0,"title":"Whether to show labels next to actions"},"actions":{"type":"array","title":"Toolbar Actions Configuration","items":{"action":{"type":"string","title":"Action Key"},"label":{"type":"string","title":"Action Label"},"iconClass":{"type":"string","title":"Action CSS Classes for Icon"},"click":{"type":"function","title":"Action Click Handler"},"enabled":{"type":"boolean","title":"Whether to enable the action","default":!0}}}}},"actionbar":{"type":"object","properties":{"showLabels":{"type":"boolean","default":!1,"title":"Whether to show labels next to actions"},"actions":{"type":"array","title":"Actions Bar Actions Configuration","items":{"action":{"type":"string","title":"Action Key"},"label":{"type":"string","title":"Action Label"},"iconClass":{"type":"string","title":"Action CSS Classes for Icon"},"click":{"type":"function","title":"Action Click Handler"},"enabled":{"type":"boolean","title":"Whether to enable the action","default":!0}}}}}}};return this.children&&this.children[0]&&i.merge(e.properties.items.properties,this.children[0].getSchemaOfSchema()),i.merge(this.base(),e)},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"toolbarSticky":{"type":"checkbox"},"items":{"type":"object","fields":{}}}})}}),i.registerMessages({"notEnoughItems":lang.notEnoughItems,"tooManyItems":lang.tooManyItems,"valueNotUnique":lang.valueNotUnique,"notAnArray":lang.notAnArray}),i.registerFieldClass("array",i.Fields.ArrayField),i.registerDefaultSchemaFieldMapping("array","array"),i.registerMessages({"addItemButtonLabel":lang.addItemButtonLabel,"addButtonLabel":lang.addButtonLabel,"removeButtonLabel":lang.removeButtonLabel,"upButtonLabel":lang.upButtonLabel,"downButtonLabel":lang.downButtonLabel})}(jQuery),function(e){var i=e.alpaca;i.Fields.ObjectField=i.ContainerField.extend({"getFieldType":function(){return"object"},"setup":function(){var e=this;this.base();var t=e.resolveContainerItemTemplateType();if(!t){e.resolveContainerItemTemplateType();return i.throwErrorWithCallback("Unable to find template descriptor for container item: "+e.getFieldType())}if(this.containerItemTemplateDescriptor=e.view.getTemplateDescriptor("container-"+t+"-item",e),!i.isEmpty(this.data)&&""!==this.data&&!i.isObject(this.data)){if(!i.isString(this.data))return;try{if(this.data=i.parseJSON(this.data),!i.isObject(this.data))return void i.logWarn("ObjectField parsed data but it was not an object: "+JSON.stringify(this.data))}catch(e){return}}},"setValue":function(e){if(e||(e={}),i.isObject(e)){var t={};for(var n in this.childrenById){var a=this.childrenById[n].propertyId;t[a]=this.childrenById[n]}var s={};for(var l in e)e.hasOwnProperty(l)&&(s[l]=e[l]);for(var a in s){var r=t[a];r&&(r.setValue(s[a]),delete t[a],delete s[a])}for(var a in t){var r=t[a];r.setValue(null)}}},"getValue":function(){if(0===this.children.length&&!this.isRequired())return{};for(var e={},t=0;t<this.children.length;t++){var n=this.children[t].propertyId,a=this.children[t].getValue();if(void 0!==a&&this.determineAllDependenciesValid(n)){var s=null;"boolean"==typeof a?s=!!a:i.isArray(a)||i.isObject(a)||i.isNumber(a)?s=a:a&&(s=a),null!==s&&(e[n]=s)}}return e},"afterRenderContainer":function(e,t){var n=this;this.base(e,function(){if(n.isTopLevel()&&n.view){n.wizardConfigs=n.view.getWizard(),void 0!==n.wizardConfigs&&(n.wizardConfigs&&!0!==n.wizardConfigs||(n.wizardConfigs={}));var e=n.view.getLayout().templateDescriptor;n.wizardConfigs&&i.isObject(n.wizardConfigs)&&(!e||n.wizardConfigs.bindings?n.autoWizard():n.wizard())}t()})},"createItems":function(e){var t=this,n=[],a={};for(var s in t.data)a[s]=s;var l=t.data;t.schema&&t.schema.properties&&(l=t.schema.properties);var r=function(){var t=[];for(var s in a)t.push(s);t.length>0&&i.logDebug("There were "+t.length+" extra data keys that were not part of the schema "+JSON.stringify(t)),e(n)},o=[];for(var d in l){var c=null;t.data&&(c=t.data[d]);var u=function(e,a,s){return function(l){t.resolvePropertySchemaOptions(e,function(r,o,d){if(d)return i.throwErrorWithCallback("Circular reference detected for schema: "+JSON.stringify(r),_this.errorCallback);r||i.logDebug("Unable to resolve schema for property: "+e),t.createItem(e,r,o,a,null,function(t){o.hasOwnProperty("order")?(order=parseInt(o.order,10),order===order?n.splice(order,0,t):n.push(t)):n.push(t),delete s[e],i.nextTick(function(){l()})})})}}(d,c,a);o.push(u)}i.series(o,function(e){for(var i=!1,t=n.length,a=0;a<t;a++)if(void 0!==n[a].options.order){i=!0;break}i&&n.sort(function(e,i){return(e.options.order?e.options.order:0)-(i.options.order?i.options.order:0)}),r()})},"createItem":function(t,n,a,s,l,r){var o=this;e("<div></div>").alpaca({"data":s,"options":a,"schema":n,"view":this.view.id?this.view.id:this.view,"connector":this.connector,"error":function(e){o.destroy(),o.errorCallback.call(o,e)},"notTopLevel":!0,"render":function(e,i){e.parent=o,e.propertyId=t,"/"!==o.path?e.path=o.path+"/"+t:e.path=o.path+t,e.render(null,function(){i()})},"postRender":function(t){var n=i.tmpl(o.containerItemTemplateDescriptor,{"id":o.getId(),"name":t.name,"parentFieldId":o.getId(),"actionbarStyle":o.options.actionbarStyle,"view":o.view,"data":s}),a=e(n).find("."+i.MARKER_CLASS_CONTAINER_FIELD_ITEM_FIELD);if(0===a.length&&e(n).hasClass(i.MARKER_CLASS_CONTAINER_FIELD_ITEM_FIELD)&&(a=e(n)),0===a.length)return void o.errorCallback.call(o,{"message":"Cannot find insertion point for field: "+o.getId()});e(a).before(t.getFieldEl()),e(a).remove();var l=e(n).find(".alpaca-field > .binf-help-block"),d="";if(l.length){var c=l.attr("id");c||(c=i.generateId(),l.attr("id",c),t.options&&(t.options.descriptionId=c),l.hasClass("binf-help-block-standalone")&&(d=l[0].outerHTML,l.remove(),t.standaloneHelper=e(d),n.append(t.standaloneHelper)))}t.containerItemEl=n,i.fieldApplyFieldAndChildren(t,function(e){e.hideInitValidationError=!1}),r&&r(t)}})},"resolvePropertySchemaOptions":function(e,t){var n=this,a=function(e,i,a){n.options.readonly&&(i.readonly=!0),t(e,i,a)},s=null;n.schema&&n.schema.properties&&n.schema.properties[e]&&(s=n.schema.properties[e]);var l={};if(n.options&&n.options.fields&&n.options.fields[e]&&(l=n.options.fields[e]),s&&s.$ref){for(var r=s.$ref,o=this,d=[o];o.parent;)o=o.parent,d.push(o);var c=s,u=l;i.loadRefSchemaOptions(o,r,function(e,t){for(var n=0,s=0;s<d.length;s++)d[s].schema&&(d[s].schema.id===r||d[s].schema.id==="#"+r?n++:d[s].schema.$ref===r&&n++);var l=n>1,o={};c&&i.mergeObject(o,c),e&&i.mergeObject(o,e),c&&c.id&&(o.id=c.id);var h={};u&&i.mergeObject(h,u),t&&i.mergeObject(h,t),i.nextTick(function(){a(o,h,l)})})}else i.nextTick(function(){a(s,l)})},"applyCreatedItems":function(e,i){var t=this;this.base(e,function(){var n=function(a){if(a===e.items.length)return void i();var s=e.items[a],l=s.propertyId;t.showOrHidePropertyBasedOnDependencies(l),t.bindDependencyFieldUpdateEvent(l),t.refreshDependentFieldStates(l),n(a+1)};n(0)})},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateMaxProperties();return t.tooManyProperties={"message":n?"":i.substituteTokens(this.getMessage("tooManyProperties"),[this.schema.maxProperties]),"status":n},n=this._validateMinProperties(),t.tooFewProperties={"message":n?"":i.substituteTokens(this.getMessage("tooManyItems"),[this.schema.items.minProperties]),"status":n},e&&t.tooManyProperties.status&&t.tooFewProperties.status},"_validateMaxProperties":function(){if(void 0===this.schema.maxProperties)return!0;var e=this.schema.maxProperties,i=0;for(var t in this.data)i++;return i<=e},"_validateMinProperties":function(){if(void 0===this.schema.minProperties)return!0;var e=this.schema.minProperties,i=0;for(var t in this.data)i++;return i>=e},"showOrHidePropertyBasedOnDependencies":function(e){var t=this,n=this.childrenByPropertyId[e];if(!n)return i.throwErrorWithCallback("Missing property: "+e,t.errorCallback);this.determineAllDependenciesValid(e)?(n.show(),n.onDependentReveal()):(n.hide(),n.onDependentConceal()),n.getFieldEl().trigger("fieldupdate")},"determineAllDependenciesValid":function(t){var n=this,a=this.childrenByPropertyId[t];if(!a)return i.throwErrorWithCallback("Missing property: "+t,n.errorCallback);var s=a.schema.dependencies;if(!s)return!0;var l=!0;return i.isString(s)?l=n.determineSingleDependencyValid(t,s):i.isArray(s)&&e.each(s,function(e,i){l=l&&n.determineSingleDependencyValid(t,i)}),l},"bindDependencyFieldUpdateEvent":function(t){var n=this,a=this.childrenByPropertyId[t];if(!a)return i.throwErrorWithCallback("Missing property: "+t,n.errorCallback);var s=a.schema.dependencies;if(!s)return!0;var l=function(e,t){var s=i.resolveField(n,t);s&&(s.getFieldEl().on("fieldupdate",function(e,i,t,a){return function(i){n.showOrHidePropertyBasedOnDependencies(t),e.getFieldEl().trigger("fieldupdate")}}(a,0,e)),
s.getFieldEl().trigger("fieldupdate"))};i.isString(s)?l(t,s):i.isArray(s)&&e.each(s,function(e,i){l(t,i)})},"refreshDependentFieldStates":function(t){var n=this,a=this.childrenByPropertyId[t];if(!a)return i.throwErrorWithCallback("Missing property: "+t,n.errorCallback);var s=a.schema.dependencies;if(!s)return!0;var l=function(e){var t=i.resolveField(n,e);t&&t.getFieldEl().trigger("fieldupdate")};i.isString(s)?l(s):i.isArray(s)&&e.each(s,function(e,i){l(i)})},"determineSingleDependencyValid":function(e,t){var n=this,a=i.resolveField(n,t);if(!a)return!1;var s=a.data,l=!1,r=this.childrenByPropertyId[e].options.dependencies;if(r&&0!==r.length){"boolean"!==a.getType()||s||(s=!1);var o=r[t];!i.isEmpty(o)&&i.isFunction(o)?l=o.call(this,s):(l=!0,i.isArray(o)?i.anyEquality(s,o)||(l=!1):i.isEmpty(o)||i.anyEquality(o,s)||(l=!1))}else l=!("boolean"===a.getType()&&!this.childrenByPropertyId[e].options.dependencies&&!s)&&!i.isValEmpty(a.data);return a&&a.isHidden()&&(l=!1),l},"getIndex":function(e){if(i.isEmpty(e))return-1;for(var t=0;t<this.children.length;t++){if(this.children[t].propertyId==e)return t}return-1},"addItem":function(i,t,n,a,s,l){var r=this;this.createItem(i,t,n,a,s,function(i){var t=null;if(s&&r.childrenById[s])for(var n=0;n<r.children.length;n++)if(r.children[n].getId()==s){t=n;break}if(r.registerChild(i,null!=t?t+1:null),t){var a=r.getContainerEl().children("[data-alpaca-container-item-index='"+t+"']");a&&a.length>0&&a.after(i.getFieldEl())}else e(r.container).append(i.getFieldEl());r.updateChildDOMElements(),r.refreshValidationState(!0,function(){r.triggerUpdate(),l&&l()})})},"removeItem":function(i,t){var n=this;this.children=e.grep(this.children,function(e,t){return e.getId()!=i});var a=this.childrenById[i];delete this.childrenById[i],a.propertyId&&delete this.childrenByPropertyId[a.propertyId],a.destroy(),this.refreshValidationState(!0,function(){n.triggerUpdate(),t&&t()})},"wizard":function(){var t=this,n=this.wizardConfigs.steps;n||(n=[]);var a=this.wizardConfigs.title,s=this.wizardConfigs.description,l=this.wizardConfigs.buttons;l||(l={}),l.previous||(l.previous={}),l.previous.title||(l.previous.title="Previous"),l.previous.align||(l.previous.align="left"),l.previous.type||(l.previous.type="button"),l.next||(l.next={}),l.next.title||(l.next.title="Next"),l.next.align||(l.next.align="right"),l.next.type||(l.next.type="button"),this.wizardConfigs.hideSubmitButton||(l.submit||(l.submit={}),l.submit.title||(l.submit.title="Submit"),l.submit.align||(l.submit.align="right"),l.submit.type||(l.submit.type="button"));for(var r in l)l[r].type||(l[r].type="button");var o=this.wizardConfigs.showSteps;void 0===o&&(o=!0);var d=this.wizardConfigs.showProgressBar,c=this.wizardConfigs.validation;void 0===c&&(c=!0);var a=e(this.field).attr("data-alpaca-wizard-title"),s=e(this.field).attr("data-alpaca-wizard-description"),u=e(this.field).attr("data-alpaca-wizard-validation");void 0!==u&&(c=!!u);var h=e(this.field).attr("data-alpaca-wizard-show-steps");void 0!==h&&(o=!!h);var p=e(this.field).attr("data-alpaca-wizard-show-progress-bar");void 0!==p&&(d=!!p);var f=e(this.field).find("[data-alpaca-wizard-role='step']");0==n.length&&f.each(function(i){var t={},a=e(this).attr("data-alpaca-wizard-step-title");void 0!==a&&(t.title=a),t.title||(t.title="Step "+i);var s=e(this).attr("data-alpaca-wizard-step-description");void 0!==s&&(t.description=s),t.description||(t.description="Step "+i),n.push(t)}),void 0===d&&n.length>1&&(d=!0);var m={};m.wizardTitle=a,m.wizardDescription=s,m.showSteps=o,m.performValidation=c,m.steps=n,m.buttons=l,m.schema=t.schema,m.options=t.options,m.data=t.data,m.showProgressBar=d,m.markAllStepsVisited=this.wizardConfigs.markAllStepsVisited,m.view=t.view;var g=t.view.getTemplateDescriptor("wizard",t);if(g){var v=i.tmpl(g,m);e(t.field).append(v);var b=e(v).find(".alpaca-wizard-nav"),y=e(v).find(".alpaca-wizard-steps"),w=e(v).find(".alpaca-wizard-buttons"),F=e(v).find(".alpaca-wizard-progress-bar");e(y).append(f),function(n,a,s,l){var r=0,o=e(s).find("[data-alpaca-wizard-button-key='previous']"),d=e(s).find("[data-alpaca-wizard-button-key='next']"),c=e(s).find("[data-alpaca-wizard-button-key='submit']"),u=function(){if(l.showSteps){if(l.visits||(l.visits={}),l.markAllStepsVisited)for(var i=e(n).find("[data-alpaca-wizard-step-index]"),t=0;t<i.length;t++)l.visits[t]=!0;l.visits[r]=!0;var i=e(n).find("[data-alpaca-wizard-step-index]");e(i).removeClass("binf-disabled"),e(i).removeClass("completed"),e(i).removeClass("binf-active"),e(i).removeClass("visited");for(var t=0;t<i.length;t++)t<r?e(n).find("[data-alpaca-wizard-step-index='"+t+"']").addClass("completed"):t===r?e(n).find("[data-alpaca-wizard-step-index='"+t+"']").addClass("binf-active"):l.visits&&l.visits[t]||e(n).find("[data-alpaca-wizard-step-index='"+t+"']").addClass("binf-disabled"),l.visits&&l.visits[t]&&e(n).find("[data-alpaca-wizard-step-index='"+t+"']").addClass("visited")}if(l.showProgressBar){var s=r+1,u=l.steps.length+1,h=parseInt(s/u*100,10)+"%";e(F).find(".binf-progress-bar").attr("aria-valuemax",u),e(F).find(".binf-progress-bar").attr("aria-valuenow",s),e(F).find(".binf-progress-bar").css("width",h)}o.hide(),d.hide(),c.hide(),1==l.steps.length?c.show():l.steps.length>1&&(r>0&&o.show(),d.show(),0==r?d.show():r==l.steps.length-1&&(d.hide(),c.show())),e(a).find("[data-alpaca-wizard-role='step']").hide(),e(e(a).find("[data-alpaca-wizard-role='step']")[r]).show()},h=function(n,s){if(!l.performValidation)return void s(!0);var o=[],d=e(e(a).find("[data-alpaca-wizard-role='step']")[r]);e(d).find(".alpaca-field").each(function(){var i=e(this).attr("data-alpaca-field-id");if(i){var n=t.childrenById[i];n&&o.push(n)}});for(var c=[],u=0;u<o.length;u++)c.push(function(e){return function(i){e.refreshValidationState(!0,function(){i()})}}(o[u]));i.series(c,function(){for(var e=!0,i=0;i<o.length;i++)e=e&&o[i].isValid(!0);var a=l.buttons[n];a&&a.validate?a.validate.call(t,function(i){e=e&&i,s(e)}):s(e)})};e(o).on("click",function(e){if(e.preventDefault(),r>=1){var i=l.buttons.previous;i&&i.click&&i.click.call(t,e),r--,u()}}),e(d).on("click",function(e){e.preventDefault(),r+1<=l.steps.length-1&&h("next",function(i){if(i){var n=l.buttons.next;n&&n.click&&n.click.call(t,e),r++,u()}})}),e(c).on("click",function(e){e.preventDefault(),r===l.steps.length-1&&h("submit",function(i){if(i){var n=l.buttons.submit;n&&(n.click?n.click.call(t,e):t.form&&t.form.submit())}})}),e(s).find("[data-alpaca-wizard-button-key]").each(function(){var i=e(this).attr("data-alpaca-wizard-button-key");if("submit"!=i&&"next"!=i&&"previous"!=i){var n=l.buttons[i];n&&n.click&&e(this).on("click",function(e){return function(i){e.click.call(t,i)}}(n))}}),e(n).find("[data-alpaca-wizard-step-index]").on("click",function(i){i.preventDefault();var t=e(this).attr("data-alpaca-wizard-step-index");t&&((t=parseInt(t,10))==r||l.visits&&l.visits[t])&&(t<r?(r=t,u()):t>r&&h(null,function(e){e&&(r=t,u())}))}),t.on("moveToStep",function(e){var i=e.index,t=e.skipValidation;void 0!==i&&i<=l.steps.length-1&&(t?(r=i,u()):h(null,function(e){e&&(r=i,u())}))}),t.on("advanceOrSubmit",function(i){h(null,function(i){i&&(r===l.steps.length-1?e(c).trigger("click"):e(d).trigger("click"))})}),u()}(b,y,w,m)}},"autoWizard":function(){var i=this.wizardConfigs.bindings;i||(i={});for(var t in this.childrenByPropertyId)i.hasOwnProperty(t)||(i[t]=1);var n=!0;e(this.field).find("[data-alpaca-wizard-role='step']").length>0&&(n=!1);var a=1,s=[];do{s=[];for(var t in i)i[t]==a&&this.childrenByPropertyId&&this.childrenByPropertyId[t]&&s.push(this.childrenByPropertyId[t].field);if(s.length>0){var l=null;n?(l=e('<div data-alpaca-wizard-role="step"></div>'),e(this.field).append(l)):l=e(e(this.field).find("[data-alpaca-wizard-role='step']")[a-1]);for(var r=0;r<s.length;r++)e(l).append(s[r]);a++}}while(s.length>0);this.wizard()},"getType":function(){return"object"},"moveItem":function(t,n,a,s){var l=this;if("function"==typeof a&&(s=a,a=l.options.animate),void 0===a&&(a=!l.options.animate||l.options.animate),"string"==typeof t&&(t=parseInt(t,10)),"string"==typeof n&&(n=parseInt(n,10)),n<0&&(n=0),n>=l.children.length&&(n=l.children.length-1),-1!==n){if(l.children[n]){var r=l.getContainerEl().children("[data-alpaca-container-item-index='"+t+"']"),o=l.getContainerEl().children("[data-alpaca-container-item-index='"+n+"']"),d=e("<div class='tempMarker1'></div>");r.before(d);var c=e("<div class='tempMarker2'></div>");o.before(c);var u=function(){for(var i=[],a=0;a<l.children.length;a++)i[a]=a===t?l.children[n]:a===n?l.children[t]:l.children[a];l.children=i,d.replaceWith(o),c.replaceWith(r),l.updateChildDOMElements(),e(r).find("[data-alpaca-array-actionbar-item-index='"+t+"']").attr("data-alpaca-array-actionbar-item-index",n),e(o).find("[data-alpaca-array-actionbar-item-index='"+n+"']").attr("data-alpaca-array-actionbar-item-index",t),l.refreshValidationState(),l.triggerUpdate(),s&&s()};a?i.animatedSwap(r,o,500,function(){u()}):u()}}},"getTitle":function(){return"Object Field"},"getDescription":function(){return"Object field for containing other fields"},"getSchemaOfSchema":function(){var e={"properties":{"properties":{"title":"Properties","description":"List of child properties.","type":"object"},"maxProperties":{"type":"number","title":"Maximum Number Properties","description":"The maximum number of properties that this object is allowed to have"},"minProperties":{"type":"number","title":"Minimum Number of Properties","description":"The minimum number of properties that this object is required to have"}}},t=e.properties.properties;if(t.properties={},this.children)for(var n=0;n<this.children.length;n++){var a=this.children[n].propertyId;t.properties[a]=this.children[n].getSchemaOfSchema(),t.properties[a].title=a+" :: "+t.properties[a].title}return i.merge(this.base(),e)},"getSchemaOfOptions":function(){var e=i.merge(this.base(),{"properties":{},"order":{"type":"number","title":"Order","description":"Allows for optional specification of the index of this field in the properties array."}}),t={"properties":{"fields":{"title":"Field Options","description":"List of options for child fields.","type":"object"}}},n=t.properties.fields;if(n.properties={},this.children)for(var a=0;a<this.children.length;a++){var s=this.children[a].propertyId;n.properties[s]=this.children[a].getSchemaOfOptions(),n.properties[s].title=s+" :: "+n.properties[s].title}return i.merge(e,t)}}),i.registerMessages({"tooManyProperties":"The maximum number of properties ({0}) has been exceeded.","tooFewProperties":"There are not enough properties ({0} are required)"}),i.registerFieldClass("object",i.Fields.ObjectField),i.registerDefaultSchemaFieldMapping("object","object")}(jQuery),function(e){var i=e.alpaca;i.Fields.AnyField=i.ControlField.extend({"getFieldType":function(){return"any"},"setup":function(){this.base()},"getValue":function(){return this._getControlVal(!0)},"setValue":function(e){i.isEmpty(e)?this.control.val(""):this.control.val(e),this.base(e)},"disable":function(){this.control.disabled=!0},"enable":function(){this.control.disabled=!1},"focus":function(e){this.control.trigger("focus"),e&&e(this)},"getType":function(){return"any"},"getTitle":function(){return"Any Field"},"getDescription":function(){return"Any field."},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{}})}}),i.registerFieldClass("any",i.Fields.AnyField),i.registerDefaultSchemaFieldMapping("any","any")}(jQuery),function(e){var i=e.alpaca;i.Fields.HiddenField=i.ControlField.extend({"getFieldType":function(){return"hidden"},"setup":function(){this.base()},"getValue":function(){return this._getControlVal(!0)},"setValue":function(e){i.isEmpty(e)?this.getControlEl().val(""):this.getControlEl().val(e),this.base(e)},"getType":function(){return"string"},"getTitle":function(){return"Hidden"},"getDescription":function(){return"Field for a hidden HTML input"}}),i.registerFieldClass("hidden",i.Fields.HiddenField)}(jQuery),function(e){var i=e.alpaca;i.Fields.AddressField=i.Fields.ObjectField.extend({"getFieldType":function(){return"address"},"setup":function(){this.base(),void 0===this.data&&(this.data={"street":["",""]}),this.schema={"title":"Home Address","type":"object","properties":{"street":{"title":"Street","type":"array","items":{"type":"string","maxLength":30,"minItems":0,"maxItems":3}},"city":{"title":"City","type":"string"},"state":{"title":"State","type":"string","enum":["AL","AK","AS","AZ","AR","CA","CO","CT","DE","DC","FM","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"]},"zip":{"title":"Zip Code","type":"string","pattern":/^(\d{5}(-\d{4})?)?$/}}},i.merge(this.options,{"fields":{"zip":{"maskString":"99999","size":5},"state":{"optionLabels":["ALABAMA","ALASKA","AMERICANSAMOA","ARIZONA","ARKANSAS","CALIFORNIA","COLORADO","CONNECTICUT","DELAWARE","DISTRICTOFCOLUMBIA","FEDERATEDSTATESOFMICRONESIA","FLORIDA","GEORGIA","GUAM","HAWAII","IDAHO","ILLINOIS","INDIANA","IOWA","KANSAS","KENTUCKY","LOUISIANA","MAINE","MARSHALLISLANDS","MARYLAND","MASSACHUSETTS","MICHIGAN","MINNESOTA","MISSISSIPPI","MISSOURI","MONTANA","NEBRASKA","NEVADA","NEWHAMPSHIRE","NEWJERSEY","NEWMEXICO","NEWYORK","NORTHCAROLINA","NORTHDAKOTA","NORTHERNMARIANAISLANDS","OHIO","OKLAHOMA","OREGON","PALAU","PENNSYLVANIA","PUERTORICO","RHODEISLAND","SOUTHCAROLINA","SOUTHDAKOTA","TENNESSEE","TEXAS","UTAH","VERMONT","VIRGINISLANDS","VIRGINIA","WASHINGTON","WESTVIRGINIA","WISCONSIN","WYOMING"]}}}),i.isEmpty(this.options.addressValidation)&&(this.options.addressValidation=!0)},"isContainer":function(){return!1},"getAddress":function(){var i=this.getValue();"view"===this.view.type&&(i=this.data);var t="";return i&&(i.street&&e.each(i.street,function(e,i){t+=i+" "}),i.city&&(t+=i.city+" "),i.state&&(t+=i.state+" "),i.zip&&(t+=i.zip)),t},"afterRenderContainer":function(i,t){var n=this;this.base(i,function(){var i=n.getContainerEl();if(e(i).addClass("alpaca-addressfield"),n.options.addressValidation&&!n.isDisplayOnly()){e('<div style="clear:both;"></div>').appendTo(i);var a=e('<div class="alpaca-form-button">Show Google Map</div>').appendTo(i);a.button&&a.button({"text":!0}),a.on("click",function(){if(google&&google.maps){var i=new google.maps.Geocoder,t=n.getAddress();i&&i.geocode({"address":t},function(i,t){if(t===google.maps.GeocoderStatus.OK){var a=n.getId()+"-map-canvas";0===e("#"+a).length&&e("<div id='"+a+"' class='alpaca-field-address-mapcanvas'></div>").appendTo(n.getFieldEl());var s=new google.maps.Map(document.getElementById(n.getId()+"-map-canvas"),{"zoom":10,"center":i[0].geometry.location,"mapTypeId":google.maps.MapTypeId.ROADMAP});new google.maps.Marker({"map":s,"position":i[0].geometry.location})}else n.displayMessage("Geocoding failed: "+t)})}else n.displayMessage("Google Map API is not installed.")}).wrap("<small/>"),n.options.showMapOnLoad&&a.trigger("click")}t()})},"getType":function(){return"any"},"getTitle":function(){return"Address"},"getDescription":function(){return"Standard US Address with Street, City, State and Zip. Also comes with support for Google map."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"validateAddress":{"title":"Address Validation","description":"Enable address validation if true","type":"boolean","default":!0},"showMapOnLoad":{"title":"Whether to show the map when first loaded","type":"boolean"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"validateAddress":{"helper":"Address validation if checked","rightLabel":"Enable Google Map for address validation?","type":"checkbox"}}})}}),i.registerFieldClass("address",i.Fields.AddressField)}(jQuery),function(e){var i=e.alpaca;i.Fields.CKEditorField=i.Fields.TextAreaField.extend({"getFieldType":function(){return"ckeditor"},"setup":function(){this.data||(this.data=""),this.base(),void 0===this.options.ckeditor&&(this.options.ckeditor={})},"afterRenderControl":function(i,t){var n=this;this.base(i,function(){!n.isDisplayOnly()&&n.control&&"undefined"!=typeof CKEDITOR&&setTimeout(function(){n.editor=CKEDITOR.replace(e(n.control)[0],n.options.ckeditor)},500),e(n.control).on("destroyed",function(){n.editor&&(n.editor.removeAllListeners(),n.editor.destroy(!1),n.editor=null)}),t()})},"initControlEvents":function(){var e=this;setTimeout(function(){e.editor.on("click",function(i){e.onClick.call(e,i),e.trigger("click",i)}),e.editor.on("change",function(i){e.onChange(),e.triggerWithPropagation("change",i)}),e.editor.on("blur",function(i){e.onBlur(),e.trigger("blur",i)}),e.editor.on("focus",function(i){e.onFocus.call(e,i),e.trigger("focus",i)}),e.editor.on("key",function(i){e.onKeyPress.call(e,i),e.trigger("keypress",i)})},525)},"setValue":function(e){var i=this;this.base(e),i.editor&&i.editor.setData(e)},"getValue":function(){var e=this,i=this.base();return e.editor&&(i=e.editor.getData()),i},"destroy":function(){this.editor&&(this.editor.destroy(),this.editor=null),this.base()},"getTitle":function(){return"CK Editor"},"getDescription":function(){return"Provides an instance of a CK Editor control for use in editing HTML."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"ckeditor":{"title":"CK Editor options","description":"Use this entry to provide configuration options to the underlying CKEditor plugin.","type":"any"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"ckeditor":{"type":"any"}}})}}),i.registerFieldClass("ckeditor",i.Fields.CKEditorField)}(jQuery),function(e){var i=e.alpaca;i.Fields.ColorField=i.Fields.TextField.extend({"setup":function(){this.inputType="color",this.base()},"getFieldType":function(){return"color"},"getType":function(){return"string"},"getTitle":function(){return"Color Field"},"getDescription":function(){return"A color picker for selecting hexadecimal color values"}}),i.registerFieldClass("color",i.Fields.ColorField),i.registerDefaultSchemaFieldMapping("color","color")}(jQuery),function(e){var i=e.alpaca;i.Fields.CountryField=i.Fields.SelectField.extend({"getFieldType":function(){return"country"},"setup":function(){i.isUndefined(this.options.capitalize)&&(this.options.capitalize=!1),this.schema.enum=[],this.options.optionLabels=[];var e=this.getMessage("countries");if(e)for(var t in e){this.schema.enum.push(t);var n=e[t];this.options.capitalize&&(n=n.toUpperCase()),this.options.optionLabels.push(n)}this.base()},"getTitle":function(){return"Country Field"},"getDescription":function(){return"Provides a dropdown selector of countries keyed by their ISO3 code.  The names of the countries are read from the I18N bundle for the current locale."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"capitalize":{"title":"Capitalize","description":"Whether the values should be capitalized","type":"boolean","default":!1,"readonly":!0}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"capitalize":{"type":"checkbox"}}})}}),i.registerFieldClass("country",i.Fields.CountryField),i.registerDefaultFormatFieldMapping("country","country")}(jQuery),function(e){var i=function(){var e={"up":Math.ceil,"down":function(e){return~~e},"nearest":Math.round};return function(i){return e[i]}}(),t=e.alpaca;t.Fields.CurrencyField=t.Fields.TextField.extend({"constructor":function(e,i,t,n,a,s,l){t=t||{};var r=this.getSchemaOfPriceFormatOptions().properties;for(var o in r){var d=r[o];o in t||(t[o]=d.default||void 0)}void 0!==i&&(i=""+parseFloat(i).toFixed(t.centsLimit)),this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"currency"},"afterRenderControl":function(i,t){var n=this,a=this.getControlEl();this.base(i,function(){e(a).priceFormat(n.options),t()})},"getValue":function(){var t=this.getControlEl(),n=e(t).is("input")?t.val():t.hmtl();if(this.options.unmask||"none"!==this.options.round){var a=function(){var e="";for(var i in n){var t=n[i];isNaN(t)?t===this.options.centsSeparator&&(e+="."):e+=t}return parseFloat(e)}.bind(this)();if("none"!==this.options.round&&(a=i(this.options.round)(a),!this.options.unmask)){for(var s=[],l=""+a,r=0,o=0;r<n.length;r++)isNaN(n[r])?s.push(n[r]):s.push(l[o++]||0);return s.join("")}return a}return n},"getTitle":function(){return"Currency Field"},"getDescription":function(){return"Provides an automatically formatted and configurable input for entering currency amounts."},"getSchemaOfPriceFormatOptions":function(){return{"properties":{"allowNegative":{"title":"Allow Negative","description":"Determines if negative numbers are allowed.","type":"boolean","default":!1},"centsLimit":{"title":"Cents Limit","description":"The limit of fractional digits.","type":"number","default":2,"minimum":0},"centsSeparator":{"title":"Cents Separator","description":"The separator between whole and fractional amounts.","type":"text","default":"."},"clearPrefix":{"title":"Clear Prefix","description":"Determines if the prefix is cleared on blur.","type":"boolean","default":!1},"clearSuffix":{"title":"Clear Suffix","description":"Determines if the suffix is cleared on blur.","type":"boolean","default":!1},"insertPlusSign":{"title":"Plus Sign","description":"Determines if a plus sign should be inserted for positive values.","type":"boolean","default":!1},"limit":{"title":"Limit","description":"A limit of the length of the field.","type":"number","default":void 0,"minimum":0},"prefix":{"title":"Prefix","description":"The prefix if any for the field.","type":"text","default":"$"},"round":{"title":"Round","description":"Determines if the field is rounded. (Rounding is done when getValue is called and is not reflected in the UI)","type":"string","enum":["up","down","nearest","none"],"default":"none"},"suffix":{"title":"Suffix","description":"The suffix if any for the field.","type":"text","default":""},"thousandsSeparator":{"title":"Thousands Separator","description":"The separator between thousands.","type":"string","default":","},"unmask":{"title":"Unmask","description":"If true then the resulting value for this field will be unmasked.  That is, the resulting value will be a float instead of a string (with the prefix, suffix, etc. removed).","type":"boolean","default":!0}}}},"getSchemaOfOptions":function(){return t.merge(this.base(),this.getSchemaOfPriceFormatOptions())},"getOptionsForOptions":function(){return t.merge(this.base(),{"fields":{"allowNegative":{"type":"checkbox"},"centsLimit":{"type":"number"},"centsSeparator":{"type":"text"},"clearPrefix":{"type":"checkbox"},"clearSuffix":{"type":"checkbox"},"insertPlusSign":{"type":"checkbox"},"limit":{"type":"number"},"prefix":{"type":"text"},"round":{"type":"select"},"suffix":{"type":"text"},"thousandsSeparator":{"type":"string"},"unmask":{"type":"checkbox"}}})}}),t.registerFieldClass("currency",t.Fields.CurrencyField)}(jQuery),function(e){var i=e.alpaca;i.Fields.DateField=i.Fields.TextField.extend({"getFieldType":function(){return"date"},"getDefaultFormat":function(){return"MM/DD/YYYY"},"getDefaultExtraFormats":function(){return[]},"setup":function(){var e=this;if(this.base(),e.options.picker||(e.options.picker={}),void 0===e.options.picker.useCurrent&&(e.options.picker.useCurrent=!1),e.options.picker.format&&(e.options.dateFormat=e.options.picker.format),e.options.dateFormat||(e.options.dateFormat=e.getDefaultFormat()),e.options.picker.format||(e.options.picker.format=e.options.dateFormat),!e.options.picker.extraFormats){var i=e.getDefaultExtraFormats();i&&(e.options.picker.extraFormats=i)}},"afterRenderControl":function(i,t){var n=this;this.base(i,function(){"display"!==n.view.type&&e.fn.datetimepicker&&(n.getControlEl().datetimepicker(n.options.picker),n.picker=n.getControlEl().data("DateTimePicker"),n.picker&&n.options.dateFormat&&n.picker.format(n.options.dateFormat),n.picker&&(n.options.dateFormat=n.picker.format())),t()})},"getDate":function(){var e=this,i=null;try{i=e.picker?e.picker.date()?e.picker.date()._d:null:new Date(this.getValue())}catch(e){console.error(e)}return i},"date":function(){return this.getDate()},"onChange":function(e){this.base(),this.refreshValidationState()},"isAutoFocusable":function(){return!1},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateDateFormat();return t.invalidDate={"message":n?"":i.substituteTokens(this.getMessage("invalidDate"),[this.options.dateFormat]),"status":n},e&&t.invalidDate.status},"_validateDateFormat":function(){var e=this,i=!0;if(e.options.dateFormat){var t=e.getValue();if(t||e.isRequired()){var n=[];if(n.push(e.options.dateFormat),e.options.picker&&e.options.picker.extraFormats)for(var a=0;a<e.options.picker.extraFormats.length;a++)n.push(e.options.picker.extraFormats[a]);for(var a=0;a<n.length;a++)i=i&&moment(t,e.options.dateFormat,!0).isValid()}}return i},"setValue":function(e){var i=this;this.base(e),this.picker&&moment(e,i.options.dateFormat,!0).isValid()&&this.picker.date(e)},"getValue":function(){return this.base()},"destroy":function(){this.base(),this.picker=null},"getTitle":function(){return"Date Field"},"getDescription":function(){return"Date Field"},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{"format":{"title":"Format","description":"Property data format","type":"string","default":"date","enum":["date"],"readonly":!0}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"}}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"dateFormat":{"title":"Date Format","description":"Date format (using moment.js format)","type":"string"},"picker":{"title":"DatetimePicker options","description":"Options that are supported by the <a href='http://eonasdan.github.io/bootstrap-datetimepicker/'>Bootstrap DateTime Picker</a>.","type":"any"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"dateFormat":{"type":"text"},"picker":{"type":"any"}}})}}),i.registerMessages({"invalidDate":lang.invalidDate}),i.registerFieldClass("date",i.Fields.DateField),i.registerDefaultFormatFieldMapping("date","date")}(jQuery),function(e){var i=e.alpaca;i.Fields.DatetimeField=i.Fields.DateField.extend({"getFieldType":function(){return"datetime"},"getDefaultFormat":function(){return"MM/DD/YYYY HH:mm:ss"},"getDefaultExtraFormats":function(){return["MM/DD/YYYY hh:mm:ss a","MM/DD/YYYY HH:mm","MM/DD/YYYY"]},"setup":function(){this.base()},"getTitle":function(){return"Datetime Field"},"getDescription":function(){return"Datetime Field based on <a href='http://eonasdan.github.io/bootstrap-datetimepicker/'>Bootstrap DateTime Picker</a>."}}),i.registerFieldClass("datetime",i.Fields.DatetimeField),i.registerDefaultFormatFieldMapping("datetime","datetime"),i.registerDefaultFormatFieldMapping("date-time","datetime")}(jQuery),function(e){var i=e.alpaca;i.Fields.EditorField=i.Fields.TextField.extend({"getFieldType":function(){return"editor"},"setup":function(){var e=this;this.base(),e.options.aceTheme||(e.options.aceTheme="ace/theme/chrome"),e.options.aceMode||(e.options.aceMode="ace/mode/json"),void 0===e.options.beautify&&(e.options.beautify=!0),e.options.beautify&&this.data&&("ace/mode/json"===e.options.aceMode&&(i.isObject(this.data)?this.data=JSON.stringify(this.data,null,"    "):i.isString(this.data)&&(this.data=JSON.stringify(JSON.parse(this.data),null,"    "))),"ace/mode/html"===e.options.aceMode&&"undefined"!=typeof html_beautify&&(this.data=html_beautify(this.data)),"ace/mode/css"===e.options.aceMode&&"undefined"!=typeof css_beautify&&(this.data=css_beautify(this.data)),"ace/mode/javascript"===e.options.aceMode&&"undefined"!=typeof js_beautify&&(this.data=js_beautify(this.data))),"ace/mode/json"===e.options.aceMode&&(this.data&&"{}"!==this.data||(this.data="{\n\t\n}"))},"afterRenderControl":function(t,n){var a=this;this.base(t,function(){if(a.control){var t=a.options.aceHeight;t&&e(a.control).css("height",t);var s=a.options.aceWidth;s||(s="100%"),e(a.control).css("width",s)}var l=e(a.control)[0];if(!ace&&window.ace&&(ace=window.ace),ace){a.editor=ace.edit(l),a.editor.setOptions({"maxLines":1/0}),a.editor.getSession().setUseWrapMode(!0);var r=a.options.aceTheme;a.editor.setTheme(r);var o=a.options.aceMode;if(a.editor.getSession().setMode(o),a.editor.renderer.setHScrollBarAlwaysVisible(!1),a.editor.setShowPrintMargin(!1),a.editor.setValue(a.data),a.editor.clearSelection(),a.editor.getSession().getUndoManager().reset(),a.options.aceFitContentHeight){var d=function(){var i=!1;0===a.editor.renderer.lineHeight&&(i=!0,a.editor.renderer.lineHeight=16);var t=a.editor.getSession().getScreenLength()*a.editor.renderer.lineHeight+a.editor.renderer.scrollBar.getWidth();e(a.control).height(t.toString()+"px"),a.editor.resize(),i&&window.setTimeout(function(){a.editor.clearSelection()},100)};d(),a.editor.getSession().on("change",d)}a.schema.readonly&&a.editor.setReadOnly(!0),e(l).on("destroyed",function(){a.editor&&(a.editor.destroy(),a.editor=null)})}else i.logError("Editor Field is missing the 'ace' Cloud 9 Editor");n()})},"destroy":function(){this.editor&&(this.editor.destroy(),this.editor=null),this.base()},"getEditor":function(){return this.editor},"handleValidate":function(){var e=this.base(),t=this.validation,n=this._validateWordCount();t.wordLimitExceeded={"message":n?"":i.substituteTokens(this.getMessage("wordLimitExceeded"),[this.options.wordlimit]),"status":n};var a=this._validateEditorAnnotations();return t.editorAnnotationsExist={"message":a?"":this.getMessage("editorAnnotationsExist"),"status":a},e&&t.wordLimitExceeded.status&&t.editorAnnotationsExist.status},"_validateEditorAnnotations":function(){if(this.editor){var e=this.editor.getSession().getAnnotations();if(e&&e.length>0)return!1}return!0},"_validateWordCount":function(){if(this.options.wordlimit&&this.options.wordlimit>-1){var e=this.editor.getValue();if(e){if(e.split(" ").length>this.options.wordlimit)return!1}}return!0},"onDependentReveal":function(){this.editor&&this.editor.resize()},"setValue":function(e){var t=this;this.editor&&("object"==t.schema.type&&i.isObject(e)&&(e=JSON.stringify(e,null,"    ")),this.editor.setValue(e),t.editor.clearSelection()),this.base(e)},"getValue":function(){var e=null;return this.editor&&(e=this.editor.getValue()),"object"==this.schema.type&&(e=e?JSON.parse(e):{}),e},"getTitle":function(){return"Editor"},"getDescription":function(){return"Editor"},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"aceTheme":{"title":"ACE Editor Theme","description":"Specifies the theme to set onto the editor instance","type":"string","default":"ace/theme/twilight"},"aceMode":{"title":"ACE Editor Mode","description":"Specifies the mode to set onto the editor instance","type":"string","default":"ace/mode/javascript"},"aceWidth":{"title":"ACE Editor Height","description":"Specifies the width of the wrapping div around the editor","type":"string","default":"100%"},"aceHeight":{"title":"ACE Editor Height","description":"Specifies the height of the wrapping div around the editor","type":"string","default":"300px"},"aceFitContentHeight":{"title":"ACE Fit Content Height","description":"Configures the ACE Editor to auto-fit its height to the contents of the editor","type":"boolean","default":!1},"wordlimit":{"title":"Word Limit","description":"Limits the number of words allowed in the text area.","type":"number","default":-1}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"aceTheme":{"type":"text"},"aceMode":{"type":"text"},"wordlimit":{"type":"integer"}}})}}),i.registerMessages({"wordLimitExceeded":"The maximum word limit of {0} has been exceeded.",
"editorAnnotationsExist":"The editor has errors in it that must be corrected"}),i.registerFieldClass("editor",i.Fields.EditorField)}(jQuery),function(e){var i=e.alpaca;i.Fields.EmailField=i.Fields.TextField.extend({"getFieldType":function(){return"email"},"setup":function(){this.inputType="email",this.base(),this.schema.pattern||(this.schema.pattern=i.regexps.email)},"handleValidate":function(){var e=this.base(),i=this.validation;return i.invalidPattern.status||(i.invalidPattern.message=this.getMessage("invalidEmail")),e},"getTitle":function(){return"Email Field"},"getDescription":function(){return"Email Field."},"getSchemaOfSchema":function(){var e=this.schema&&this.schema.pattern?this.schema.pattern:i.regexps.email;return i.merge(this.base(),{"properties":{"pattern":{"title":"Pattern","description":"Field Pattern in Regular Expression","type":"string","default":e,"enum":[e],"readonly":!0},"format":{"title":"Format","description":"Property data format","type":"string","default":"email","enum":["email"],"readonly":!0}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"}}})}}),i.registerMessages({"invalidEmail":lang.invalidEmail}),i.registerFieldClass("email",i.Fields.EmailField),i.registerDefaultFormatFieldMapping("email","email")}(jQuery),function(e){var i=e.alpaca;i.Fields.GridField=i.Fields.ArrayField.extend({"getFieldType":function(){return"grid"},"setup":function(){this.base(),void 0===this.options.grid&&(this.options.grid={})},"afterRenderContainer":function(i,t){var n=this;this.base(i,function(){var i=[],a=[];for(var s in n.options.fields){var l=n.options.fields[s],r=s;l.label&&(r=l.label),a.push(r)}i.push(a);for(var o=0;o<n.data.length;o++){var d=[];for(var c in n.data[o])d.push(n.data[o][c]);i.push(d)}var u=e(n.container).find(".alpaca-container-grid-holder"),h=n.options.grid;h.data=i,e(u).handsontable(h),t()})},"getType":function(){return"array"},"getTitle":function(){return"Grid Field"},"getDescription":function(){return"Renders array items into a grid"}}),i.registerFieldClass("grid",i.Fields.GridField)}(jQuery),function(e){var i=e.alpaca;i.Fields.ImageField=i.Fields.TextField.extend({"getFieldType":function(){return"image"},"getTitle":function(){return"Image Field"},"getDescription":function(){return"Image Field."}}),i.registerFieldClass("image",i.Fields.ImageField)}(jQuery),function(e){var i=e.alpaca;i.Fields.IntegerField=i.Fields.NumberField.extend({"getFieldType":function(){return"integer"},"getValue":function(){var e=this.base();return void 0===e||""==e?e:parseInt(e,10)},"onChange":function(e){this.base(),this.slider&&this.slider.slider("value",this.getValue())},"postRender":function(t){var n=this;this.base(function(){n.options.slider&&(i.isEmpty(n.schema.maximum)||i.isEmpty(n.schema.minimum)||n.control&&(n.control.after('<div id="slider"></div>'),n.slider=e("#slider",n.control.parent()).slider({"value":n.getValue(),"min":n.schema.minimum,"max":n.schema.maximum,"slide":function(e,i){n.setValue(i.value),n.refreshValidationState()}}))),t()})},"handleValidate":function(){var e=this.base(),i=this.validation,t=this._validateInteger();return i.stringNotANumber={"message":t?"":this.getMessage("stringNotAnInteger"),"status":t},e&&t},"_validateInteger":function(){var e=this._getControlVal();if("number"==typeof e&&(e=""+e),i.isValEmpty(e))return!0;if(!i.testRegex(i.regexps.integer,e))return!1;var t=this.getValue();return!isNaN(t)},"getType":function(){return"integer"},"getTitle":function(){return"Integer Field"},"getDescription":function(){return"Field for integers."},"getSchemaOfSchema":function(){return i.merge(this.base(),{"properties":{"minimum":{"title":"Minimum","description":"Minimum value of the property.","type":"integer"},"maximum":{"title":"Maximum","description":"Maximum value of the property.","type":"integer"},"divisibleBy":{"title":"Divisible By","description":"Property value must be divisible by this number.","type":"integer"}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"minimum":{"helper":"Minimum value of the field.","type":"integer"},"maximum":{"helper":"Maximum value of the field.","type":"integer"},"divisibleBy":{"helper":"Property value must be divisible by this number.","type":"integer"}}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"slider":{"title":"Slider","description":"Generate jQuery UI slider control with the field if true.","type":"boolean","default":!1}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"slider":{"rightLabel":"Slider control ?","helper":"Generate slider control if selected.","type":"checkbox"}}})}}),i.registerMessages({"stringNotAnInteger":lang.stringNotAnInteger}),i.registerFieldClass("integer",i.Fields.IntegerField),i.registerDefaultSchemaFieldMapping("integer","integer")}(jQuery),function(e){var i=e.alpaca;i.Fields.IPv4Field=i.Fields.TextField.extend({"getFieldType":function(){return"ipv4"},"setup":function(){this.base(),this.schema.pattern||(this.schema.pattern=i.regexps.ipv4)},"handleValidate":function(){var e=this.base(),i=this.validation;return i.invalidPattern.status||(i.invalidPattern.message=this.getMessage("invalidIPv4")),e},"getTitle":function(){return"IP Address Field"},"getDescription":function(){return"IP Address Field."},"getSchemaOfSchema":function(){var e=this.schema&&this.schema.pattern?this.schema.pattern:i.regexps.ipv4;return i.merge(this.base(),{"properties":{"pattern":{"title":"Pattern","description":"Field Pattern in Regular Expression","type":"string","default":e,"readonly":!0},"format":{"title":"Format","description":"Property data format","type":"string","enum":["ip-address"],"default":"ip-address","readonly":!0}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"}}})}}),i.registerMessages({"invalidIPv4":lang.invalidIPv4}),i.registerFieldClass("ipv4",i.Fields.IPv4Field),i.registerDefaultFormatFieldMapping("ip-address","ipv4")}(jQuery),function(e){function i(e){if("string"==typeof e.data){var i=e.handler,t=e.data.toLowerCase().split(" ");e.handler=function(e){if(this===e.target||!/textarea|select/i.test(e.target.nodeName)&&"text"!==e.target.type){var n="keypress"!==e.type&&jQuery.hotkeys.specialKeys[e.which],a=String.fromCharCode(e.which).toLowerCase(),s="",l={};e.altKey&&"alt"!==n&&(s+="alt+"),e.ctrlKey&&"ctrl"!==n&&(s+="ctrl+"),e.metaKey&&!e.ctrlKey&&"meta"!==n&&(s+="meta+"),e.shiftKey&&"shift"!==n&&(s+="shift+"),n?l[s+n]=!0:(l[s+a]=!0,l[s+jQuery.hotkeys.shiftNums[a]]=!0,"shift+"===s&&(l[jQuery.hotkeys.shiftNums[a]]=!0));for(var r=0,o=t.length;r<o;r++)if(l[t[r]])return i.apply(this,arguments)}}}}var t=e.alpaca;t.Fields.JSONField=t.Fields.TextAreaField.extend({"getFieldType":function(){return"json"},"setValue":function(e){(t.isObject(e)||"object"==typeof e)&&(e=JSON.stringify(e,null,3)),this.base(e)},"getValue":function(){var e=this.base();return e&&t.isString(e)&&(e=JSON.parse(e)),e},"handleValidate":function(){var e=this.base(),i=this.validation,t=this._validateJSON();return i.stringNotAJSON={"message":t.status?"":this.getMessage("stringNotAJSON")+" "+t.message,"status":t.status},e&&i.stringNotAJSON.status},"_validateJSON":function(){var e=this.control.val();if(t.isValEmpty(e))return{"status":!0};try{var i=JSON.parse(e);return this.setValue(JSON.stringify(i,null,3)),{"status":!0}}catch(e){return{"status":!1,"message":e.message}}},"afterRenderControl":function(e,i){var t=this;this.base(e,function(){t.control&&(t.control.on("keypress",function(e){var i=e.keyCode||e.wich;34===i&&t.control.insertAtCaret('"'),123===i&&t.control.insertAtCaret("}"),91===i&&t.control.insertAtCaret("]")}),t.control.on("keypress","Ctrl+l",function(){t.getFieldEl().removeClass("alpaca-field-focused"),t.refreshValidationState()}),t.control.attr("title","Type Ctrl+L to format and validate the JSON string.")),i()})},"getTitle":function(){return"JSON Editor"},"getDescription":function(){return"Editor for JSON objects with basic validation and formatting."}}),t.registerMessages({"stringNotAJSON":"This value is not a valid JSON string."}),t.registerFieldClass("json",t.Fields.JSONField),e.fn.insertAtCaret=function(e){return this.each(function(){if(document.selection)this.trigger("focus"),sel=document.selection.createRange(),sel.text=e,this.trigger("focus");else if(this.selectionStart||"0"==this.selectionStart){var i=this.selectionStart,t=this.selectionEnd,n=this.scrollTop;this.value=this.value.substring(0,i)+e+this.value.substring(t,this.value.length),this.trigger("focus"),this.selectionStart=i,this.selectionEnd=i,this.scrollTop=n}else this.value+=e,this.trigger("focus")})},jQuery.hotkeys={"version":"0.8","specialKeys":{"8":"backspace","9":"tab","13":"return","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capslock","27":"esc","32":"space","33":"pageup","34":"pagedown","35":"end","36":"home","37":"left","38":"up","39":"right","40":"down","45":"insert","46":"del","96":"0","97":"1","98":"2","99":"3","100":"4","101":"5","102":"6","103":"7","104":"8","105":"9","106":"*","107":"+","109":"-","110":".","111":"/","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numlock","145":"scroll","191":"/","224":"meta"},"shiftNums":{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={"add":i}})}(jQuery),function(e){var i=e.alpaca;i.Fields.LowerCaseField=i.Fields.TextField.extend({"getFieldType":function(){return"lowercase"},"setValue":function(e){var i=e.toLowerCase();i!=this.getValue()&&this.base(i)},"onKeyPress":function(e){this.base(e);var t=this;i.later(25,this,function(){var e=t.getValue();t.setValue(e)})},"getTitle":function(){return"Lowercase Text"},"getDescription":function(){return"Text field for lowercase text."}}),i.registerFieldClass("lowercase",i.Fields.LowerCaseField),i.registerDefaultFormatFieldMapping("lowercase","lowercase")}(jQuery),function(e){var i=e.alpaca;i.Fields.MapField=i.Fields.ArrayField.extend({"getFieldType":function(){return"map"},"getType":function(){return"object"},"setup":function(){if(this.data&&i.isObject(this.data)){var t=[];e.each(this.data,function(e,n){var a=i.copyOf(n);a._key=e,t.push(a)}),this.data=t}this.base(),i.mergeObject(this.options,{"forceRevalidation":!0}),i.isEmpty(this.data)},"getValue":function(){if(0!==this.children.length||this.isRequired()){for(var e={},i=0;i<this.children.length;i++){var t=this.children[i].getValue(),n=t._key;n&&(delete t._key,e[n]=t)}return e}},"handleValidate":function(){var e=this.base(),i=this.validation,t=this._validateMapKeysNotEmpty();i.keyMissing={"message":t?"":this.getMessage("keyMissing"),"status":t};var n=this._validateMapKeysUnique();return i.keyNotUnique={"message":n?"":this.getMessage("keyNotUnique"),"status":n},e&&i.keyMissing.status&&i.keyNotUnique.status},"_validateMapKeysNotEmpty":function(){for(var e=!0,i=0;i<this.children.length;i++){if(!this.children[i].getValue()._key){e=!1;break}}return e},"_validateMapKeysUnique":function(){for(var e=!0,i={},t=0;t<this.children.length;t++){var n=this.children[t].getValue(),a=n._key;i[a]&&(e=!1),i[a]=a}return e},"getTitle":function(){return"Map Field"},"getDescription":function(){return"Field for objects with key/value pairs that share the same schema for values."}}),i.registerFieldClass("map",i.Fields.MapField),i.registerMessages({"keyNotUnique":"Keys of map field are not unique.","keyMissing":"Map contains an empty key."})}(jQuery),function(e){var i=e.alpaca;i.Fields.PasswordField=i.Fields.TextField.extend({"getFieldType":function(){return"password"},"setup":function(){this.base(),this.schema.pattern||(this.schema.pattern=i.regexps.password)},"handleValidate":function(){var e=this.base(),i=this.validation;return i.invalidPattern.status||(i.invalidPattern.message=this.getMessage("invalidPassword")),e},"getTitle":function(){return"Password Field"},"getDescription":function(){return"Password Field."},"getSchemaOfSchema":function(){var e=this.schema&&this.schema.pattern?this.schema.pattern:/^[0-9a-zA-Z\x20-\x7E]*$/;return i.merge(this.base(),{"properties":{"pattern":{"title":"Pattern","description":"Field Pattern in Regular Expression","type":"string","default":this.schema.pattern,"enum":[e],"readonly":!0},"format":{"title":"Format","description":"Property data format","type":"string","default":"password","enum":["password"],"readonly":!0}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"}}})}}),i.registerMessages({"invalidPassword":lang.invalidPassword}),i.registerFieldClass("password",i.Fields.PasswordField),i.registerDefaultFormatFieldMapping("password","password")}(jQuery),function(e){var i=e.alpaca;i.Fields.PersonalNameField=i.Fields.TextField.extend({"getFieldType":function(){return"personalname"},"setValue":function(e){for(var i="",t=0;t<e.length;t++)0===t?i+=e.charAt(t).toUpperCase():" "===e.charAt(t-1)||"-"===e.charAt(t-1)||"'"===e.charAt(t-1)?i+=e.charAt(t).toUpperCase():i+=e.charAt(t);i!=this.getValue()&&this.base(i)},"onKeyPress":function(e){this.base(e);var t=this;i.later(25,this,function(){var e=t.getValue();t.setValue(e)})},"getTitle":function(){return"Personal Name"},"getDescription":function(){return"Text Field for personal name with captical letter for first letter & after hyphen, space or apostrophe."}}),i.registerFieldClass("personalname",i.Fields.PersonalNameField)}(jQuery),function(e){var i=e.alpaca;i.Fields.PhoneField=i.Fields.TextField.extend({"setup":function(){this.inputType="tel",this.base(),this.schema.pattern||(this.schema.pattern=i.regexps.phone),i.isEmpty(this.options.maskString)&&(this.options.maskString="(999) 999-9999")},"postRender":function(e){this.base(function(){e()})},"handleValidate":function(){var e=this.base(),i=this.validation;return i.invalidPattern.status||(i.invalidPattern.message=this.getMessage("invalidPhone")),e},"getFieldType":function(){return"phone"},"getTitle":function(){return"Phone Field"},"getDescription":function(){return"Phone Field."},"getSchemaOfSchema":function(){var e=this.schema&&this.schema.pattern?this.schema.pattern:i.regexps.phone;return i.merge(this.base(),{"properties":{"pattern":{"title":"Pattern","description":"Field Pattern in Regular Expression","type":"string","default":e,"enum":[e],"readonly":!0},"format":{"title":"Format","description":"Property data format","type":"string","default":"phone","enum":["phone"],"readonly":!0}}})},"getOptionsForSchema":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"}}})},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"maskString":{"title":"Field Mask String","description":"Expression for field mask","type":"string","default":"(999) 999-9999"}}})}}),i.registerMessages({"invalidPhone":lang.invalidPhone}),i.registerFieldClass("phone",i.Fields.PhoneField),i.registerDefaultFormatFieldMapping("phone","phone")}(jQuery),function(e){var i=e.alpaca;i.Fields.SearchField=i.Fields.TextField.extend({"setup":function(){this.inputType="search",this.base(),this.options.attributes.results=5},"getFieldType":function(){return"search"},"getType":function(){return"string"},"getTitle":function(){return"Search Field"},"getDescription":function(){return"A search box field"}}),i.registerFieldClass("search",i.Fields.SearchField),i.registerDefaultSchemaFieldMapping("search","search")}(jQuery),function(e){var i=e.alpaca;i.usHoldings={},i.usHoldings.territories={"American Samoa":"AS","District Of Columbia":"DC","Federated States Of Micronesia":"FM","Guam":"GU","Marshall Islands":"MH","Northern Mariana Islands":"MP","Palau":"PW","Puerto Rico":"PR","Virgin Islands":"VI"},i.usHoldings.states={"Alabama":"AL","Alaska":"AK","Arizona":"AZ","Arkansas":"AR","California":"CA","Colorado":"CO","Connecticut":"CT","Delaware":"DE","Florida":"FL","Georgia":"GA","Hawaii":"HI","Idaho":"ID","Illinois":"IL","Indiana":"IN","Iowa":"IA","Kansas":"KS","Kentucky":"KY","Louisiana":"LA","Maine":"ME","Maryland":"MD","Massachusetts":"MA","Michigan":"MI","Minnesota":"MN","Mississippi":"MS","Missouri":"MO","Montana":"MT","Nebraska":"NE","Nevada":"NV","New Hampshire":"NH","New Jersey":"NJ","New Mexico":"NM","New York":"NY","North Carolina":"NC","North Dakota":"ND","Ohio":"OH","Oklahoma":"OK","Oregon":"OR","Pennsylvania":"PA","Rhode Island":"RI","South Carolina":"SC","South Dakota":"SD","Tennessee":"TN","Texas":"TX","Utah":"UT","Vermont":"VT","Virginia":"VA","Washington":"WA","West Virginia":"WV","Wisconsin":"WI","Wyoming":"WY"},i.Fields.StateField=i.Fields.SelectField.extend({"getFieldType":function(){return"state"},"setup":function(){i.isUndefined(this.options.capitalize)&&(this.options.capitalize=!1),i.isUndefined(this.options.includeStates)&&(this.options.includeStates=!0),i.isUndefined(this.options.includeTerritories)&&(this.options.includeTerritories=!0),i.isUndefined(this.options.format)&&(this.options.format="name"),"name"===this.options.format||"code"===this.options.format||(i.logError("The configured state format: "+this.options.format+" is not a legal value [name, code]"),this.options.format="name");var e=i.retrieveUSHoldings(this.options.includeStates,this.options.includeTerritories,"code"===this.options.format,this.options.capitalize);this.schema.enum=e.keys,this.options.optionLabels=e.values,this.base()},"getTitle":function(){return"State Field"},"getDescription":function(){return"Provides a dropdown selector of states and/or territories in the United States, keyed by their two-character code."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"format":{"title":"Format","description":"How to represent the state values in the selector","type":"string","default":"name","enum":["name","code"],"readonly":!0},"capitalize":{"title":"Capitalize","description":"Whether the values should be capitalized","type":"boolean","default":!1,"readonly":!0},"includeStates":{"title":"Include States","description":"Whether to include the states of the United States","type":"boolean","default":!0,"readonly":!0},"includeTerritories":{"title":"Include Territories","description":"Whether to include the territories of the United States","type":"boolean","default":!0,"readonly":!0}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"},"capitalize":{"type":"checkbox"},"includeStates":{"type":"checkbox"},"includeTerritories":{"type":"checkbox"}}})}}),i.registerFieldClass("state",i.Fields.StateField),i.registerDefaultFormatFieldMapping("state","state"),i.retrieveUSHoldings=function(){return function(t,n,a,s){var l={"keys":[],"values":[]},r=e.extend({},t?i.usHoldings.states:{},n?i.usHoldings.territories:{}),o=Object.keys(r);o.sort();for(var d in o){var c=o[d],u=r[c],h=a?u:c;s&&(h=h.toUpperCase()),l.keys.push(u),l.values.push(h)}return l}}()}(jQuery),function(e){var i=e.alpaca;i.Fields.TableField=i.Fields.ArrayField.extend({"setup":function(){var e=this;e.options||(e.options={}),void 0===e.options.animate&&(e.options.animate=!1),this.base(),this.options.items.type||(this.options.items.type="tablerow"),this.options.datatable&&(this.options.datatables=this.options.datatable),void 0===this.options.datatables&&(this.options.datatables={"paging":!1,"lengthChange":!1,"info":!1,"searching":!1,"ordering":!0}),void 0===this.options.showActionsColumn&&(this.options.showActionsColumn=!0,this.options.readonly&&(this.options.showActionsColumn=!1),this.isDisplayOnly()&&(this.options.showActionsColumn=!1))},"getFieldType":function(){return"table"},"afterRenderContainer":function(i,t){var n=this;this.base(i,function(){n.cleanupDomInjections();var i=e(this.container).find("table");n.applyStyle("table",i),n.options.datatables&&e.fn.DataTable&&e(this.container).find("table").DataTable(n.options.datatables),t()}.bind(n))},"cleanupDomInjections":function(){var t=function(i){var t=e(i).parent(),n=e(i).children(),a=e(i).attr("class").split(/\s+/);e.each(a,function(i,n){"alpaca-merge-up"===n||e(t).addClass(n)}),e.each(e(i)[0].attributes,function(){this.name&&0===this.name.indexOf("data-")&&e(t).attr(this.name,this.value)}),n.length>0?e(i).replaceWith(n):e(i).remove()};this.getFieldEl().find("tr > .alpaca-field").each(function(){t(this)}),this.getFieldEl().find("tr > .alpaca-container").each(function(){t(this)});var n=this.getFieldEl().find("."+i.MARKER_CLASS_ARRAY_ITEM_ACTIONBAR);n.length>0&&n.each(function(){var i=e("<td class='actionbar' nowrap='nowrap'></td>");e(this).before(i),e(i).append(this)}),this.getFieldEl().find(".alpaca-merge-up").each(function(){t(this)})},"doResolveItemContainer":function(){return e(this.container).find("table tbody")},"doAfterAddItem":function(e){this.cleanupDomInjections()},"doAfterRemoveItem":function(e){this.cleanupDomInjections()},"getType":function(){return"array"},"getTitle":function(){return"Table Field"},"getDescription":function(){return"Renders array items into a table"},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"datatables":{"title":"DataTables Configuration","description":"Optional configuration to be passed to the underlying DataTables Plugin.","type":"object"},"showActionsColumn":{"title":"Show Actions Column","default":!0,"description":"Whether to show or hide the actions column.","type":"boolean"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"datatables":{"type":"object"},"showActionsColumn":{"type":"checkbox"}}})}}),i.registerFieldClass("table",i.Fields.TableField)}(jQuery),function(e){var i=e.alpaca;i.Fields.TableRowField=i.Fields.ObjectField.extend({"prepareContainerModel":function(e){var i=this;this.base(function(t){t.options.showActionsColumn=i.parent.options.showActionsColumn,e(t)})},"getFieldType":function(){return"tablerow"},"getType":function(){return"object"},"getTitle":function(){return"Table Row Field"},"getDescription":function(){return"Renders object items into a table row"}}),i.registerFieldClass("tablerow",i.Fields.TableRowField)}(jQuery),function(e){var i=e.alpaca;i.Fields.TagField=i.Fields.LowerCaseField.extend({"getFieldType":function(){return"tag"},"setup":function(){this.base(),this.options.separator||(this.options.separator=",")},"getValue":function(){var e=this.base();return""===e?[]:e.split(this.options.separator)},"setValue":function(e){if(""!==e)return e?void this.base(e.join(this.options.separator)):void this.base("")},"onBlur":function(i){this.base(i);var t=this.getValue(),n=[];e.each(t,function(e,i){""!==i.trim()&&n.push(i.trim())}),this.setValue(n)},"getTitle":function(){return"Tag Field"},"getDescription":function(){return"Text field for entering list of tags separated by delimiter."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"separator":{"title":"Separator","description":"Separator used to split tags.","type":"string","default":","}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"separator":{"type":"text"}}})}}),i.registerFieldClass("tag",i.Fields.TagField)}(jQuery),function(e){var i=e.alpaca;i.Fields.TimeField=i.Fields.DateField.extend({"getFieldType":function(){return"time"},"getDefaultFormat":function(){return"h:mm:ss a"},"setup":function(){this.base()},"getTitle":function(){return"Time Field"},"getDescription":function(){return"Time Field"}}),i.registerMessages({"invalidTime":"Invalid time"}),i.registerFieldClass("time",i.Fields.TimeField),i.registerDefaultFormatFieldMapping("time","time")}(jQuery),function(e){var i=e.alpaca;i.Fields.TinyMCEField=i.Fields.TextAreaField.extend({"getFieldType":function(){return"tinymce"},"setup":function(){var e=this;this.data||(this.data=""),e.options.toolbar||(e.options.toolbar="insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"),this.base()},"setValue":function(e){var i=this;this.base(e),i.editor&&i.editor.setContent(e)},"getValue":function(){var e=this,i=null;return e.editor&&(i=e.editor.getContent()),i},"initControlEvents":function(){var e=this;setTimeout(function(){e.editor.on("click",function(i){e.onClick.call(e,i),e.trigger("click",i)}),e.editor.on("change",function(i){e.onChange(),e.triggerWithPropagation("change",i)}),e.editor.on("blur",function(i){e.onBlur(),e.trigger("blur",i)}),e.editor.on("focus",function(i){e.onFocus.call(e,i),e.trigger("focus",i)}),e.editor.on("keypress",function(i){e.onKeyPress.call(e,i),e.trigger("keypress",i)}),e.editor.on("keyup",function(i){e.onKeyUp.call(e,i),e.trigger("keyup",i)}),e.editor.on("keydown",function(i){e.onKeyDown.call(e,i),e.trigger("keydown",i)})},525)},"afterRenderControl":function(e,i){var t=this;this.base(e,function(){if(!t.isDisplayOnly()&&t.control){var e=t.control[0].id;setTimeout(function(){tinyMCE.init({"init_instance_callback":function(e){t.editor=e,i()},"selector":"#"+e,"toolbar":t.options.toolbar})},500)}})},"destroy":function(){this.editor&&(this.editor.remove(),this.editor=null),this.base()},"getTitle":function(){return"TinyMCE Editor"},"getDescription":function(){return"Provides an instance of a TinyMCE control for use in editing HTML."},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"toolbar":{"title":"TinyMCE toolbar options","description":"Toolbar options for TinyMCE plugin.","type":"string"}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"toolbar":{"type":"text"}}})}}),i.registerFieldClass("tinymce",i.Fields.TinyMCEField)}(jQuery),function(e){var i=e.alpaca;i.Fields.UploadField=i.Fields.TextField.extend({"constructor":function(t,n,a,s,l,r){var o=this;this.base(t,n,a,s,l,r),this.wrapTemplate=function(t){return function(n){for(var a=n.files,s=n.formatFileSize,l=n.options,r=[],d=0;d<a.length;d++){var c={};c.options=o.options,c.file=i.cloneObject(a[d]),c.size=s(c.size),c.buttons=o.options.buttons,c.view=o.view;var u=i.tmpl(o.view.getTemplateDescriptor(t),c,o);r.push(u[0])}return r=e(r),e(r).each(function(){l.fileupload&&l.fileupload.autoUpload&&e(this).find("button.start").css("display","none"),o.handleWrapRow(this,l),e(this).find("button.delete").on("destroyed",function(){setTimeout(function(){o.onFileDelete(u),o.triggerWithPropagation("change"),o.refreshUIState()},400)})}),e(r)}}},"getFieldType":function(){return"upload"},"setup":function(){var e=this;this.base(),e.options.buttons||(e.options.buttons=[]),e.options.hideDeleteButton||e.options.buttons.push({"key":"delete","isDelete":!0}),void 0===e.options.multiple&&(e.options.multiple=!1),void 0===e.options.showUploadPreview&&(e.options.showUploadPreview=!0),void 0===e.options.showHeaders&&(e.options.showHeaders=!0),e.data||(e.data=[]),e.options.upload||(e.options.upload={}),void 0===e.options.maxNumberOfFiles&&(e.options.upload.maxNumberOfFiles?(e.options.maxNumberOfFiles=e.options.upload.maxNumberOfFiles,1===e.options.maxNumberOfFiles?e.options.multiple=!1:e.options.maxNumberOfFiles>1&&(e.options.multiple=!0)):(e.options.maxNumberOfFiles=1,"boolean"==typeof e.options.multiple&&e.options.multiple&&(e.options.maxNumberOfFiles=-1)),e.options.maxNumberOfFiles&&(e.options.upload.maxNumberOfFiles=e.options.maxNumberOfFiles)),void 0===e.options.maxFileSize&&(e.options.upload.maxFileSize?e.options.maxFileSize=e.options.upload.maxFileSize:e.options.maxFileSize=-1,e.options.maxFileSize&&(e.options.upload.maxFileSize=e.options.maxFileSize)),void 0===e.options.fileTypes&&(e.options.upload.acceptFileTypes?e.options.fileTypes=e.options.upload.acceptFileTypes:e.options.fileTypes=null,e.options.fileTypes&&(e.options.upload.acceptFileTypes=e.options.fileTypes)),e.options.errorHandler||(e.options.errorHandler=function(e){alert(e.join("\n"))});var t=e.determineCsrfToken();t&&(e.options.upload||(e.options.upload={}),e.options.upload.headers||(e.options.upload.headers={}),e.options.upload.headers[i.CSRF_HEADER_NAME]=t)},"determineCsrfToken":function(){var e=i.CSRF_TOKEN;if(!e)for(var t=0;t<i.CSRF_COOKIE_NAMES.length;t++){var n=i.CSRF_COOKIE_NAMES[t],a=i.readCookie(n);if(a){e=a;break}}return e},"prepareControlModel":function(e){var i=this;i.base(function(t){t.chooseButtonLabel=i.options.chooseButtonLabel,t.chooseButtonLabel||(t.chooseButtonLabel=i.getMessage("chooseFiles"),1===i.options.maxNumberOfFiles&&(t.chooseButtonLabel=i.getMessage("chooseFile"))),t.dropZoneMessage=i.options.dropZoneMessage,t.dropZoneMessage||(t.dropZoneMessage=i.getMessage("dropZoneSingle"),1===t.maxNumberOfFiles&&(t.dropZoneMessage=i.getMessage("dropZoneMultiple"))),e(t)})},"afterRenderControl":function(e,i){var t=this;this.base(e,function(){t.handlePostRender(function(){i()})})},"getUploadTemplate":function(){return this.wrapTemplate("control-upload-partial-upload")},"getDownloadTemplate":function(){return this.wrapTemplate("control-upload-partial-download")},"handlePostRender":function(i){var t=this,n=this.control,a={};if(a.dataType="json",a.uploadTemplateId=null,a.uploadTemplate=this.getUploadTemplate(),a.downloadTemplateId=null,a.downloadTemplate=this.getDownloadTemplate(),a.filesContainer=e(n).find(".files"),a.dropZone=e(n).find(".fileupload-active-zone"),a.url="/",a.method="post",a.showUploadPreview=t.options.showUploadPreview,t.options.upload)for(var s in t.options.upload)a[s]=t.options.upload[s];t.options.multiple&&(e(n).find(".alpaca-fileupload-input").attr("multiple",!0),e(n).find(".alpaca-fileupload-input").attr("name",t.name+"_files[]")),e(n).find(".binf-progress").css("display","none"),a.progressall=function(i,t){var a=!1;if(t.loaded<t.total&&(a=!0),a){e(n).find(".binf-progress").css("display","block");var s=parseInt(t.loaded/t.total*100,10);e("#progress .binf-progress-bar").css("width",s+"%")}else e(n).find(".binf-progress").css("display","none")},a.add=function(e,i){for(var n=[],a=0;a<i.originalFiles.length;a++){if(t.options.fileTypes){var s=t.options.fileTypes;"string"==typeof t.options.fileTypes&&(s=new RegExp(t.options.fileTypes)),s.test(i.originalFiles[a].type)||n.push("Not an accepted file type: "+i.originalFiles[a].type)}t.options.maxFileSize>-1&&i.originalFiles[a].size>t.options.maxFileSize&&n.push("Filesize is too big: "+i.originalFiles[a].size)}n.length>0?t.options.errorHandler(n):i.submit()},t.applyConfiguration(a);var l=t.fileUpload=e(n).find(".alpaca-fileupload-input").fileupload(a);l.bindFirst("fileuploaddone",function(e,i){var n=t.options.enhanceFiles;n?n(a,i):t.enhanceFiles(a,i),i.files=i.result.files,setTimeout(function(){t.refreshUIState()},250)}),l.bindFirst("fileuploadsubmit",function(i,n){t.options.properties&&e.each(n.files,function(e,i){for(var a in t.options.properties){var s="property"+e+"__"+a,l=t.options.properties[a];l=t.applyTokenSubstitutions(l,e,i),n.formData||(n.formData={}),n.formData[s]=l}}),t.options.parameters&&e.each(n.files,function(e,i){for(var a in t.options.parameters){var s="param"+e+"__"+a,l=t.options.parameters[a];l=t.applyTokenSubstitutions(l,e,i),n.formData||(n.formData={}),n.formData[s]=l}})}),l.on("fileuploaddone",function(e,i){var n=t.getValue(),a=function(e){if(e===i.files.length)return void t.setValue(n);t.convertFileToDescriptor(i.files[e],function(i,t){t&&n.push(t),a(e+1)})};a(0)}),l.on("fileuploadfail",function(e,i){i.errorThrown&&t.onUploadFail(i)}),l.on("fileuploadalways",function(e,i){t.refreshUIState()}),t.applyBindings(l,n),t.preload(l,n,function(a){if(a){var s=e(t.control).find(".alpaca-fileupload-input");e(s).fileupload("option","done").call(s,e.Event("done"),{"result":{"files":a}}),t.afterPreload(l,n,a,function(){i()})}else i()}),"undefined"!=typeof document&&e(document).on("drop dragover",function(e){e.preventDefault()})},"handleWrapRow":function(e,i){},"applyTokenSubstitutions":function(e,i,t){var n={"index":i,"name":t.name,"size":t.size,"url":t.url,"thumbnailUrl":t.thumbnailUrl},a=-1,s=0;do{if((a=e.indexOf("{",s))>-1){var l=e.indexOf("}",a);if(l>-1){
var r=e.substring(a+car.length,l),o=n[r];o&&(e=e.substring(0,a)+o+e.substring(l+1)),s=l+1}}}while(a>-1);return e},"removeValue":function(e){for(var i=this,t=i.getValue(),n=0;n<t.length;n++)if(t[n].id==e){t.splice(n,1);break}i.setValue(t)},"applyConfiguration":function(e){},"applyBindings":function(e){},"convertFileToDescriptor":function(e,i){i(null,{"id":e.id,"name":e.name,"size":e.size,"url":e.url,"thumbnailUrl":e.thumbnailUrl,"deleteUrl":e.deleteUrl,"deleteType":e.deleteType})},"convertDescriptorToFile":function(e,i){i(null,{"id":e.id,"name":e.name,"size":e.size,"url":e.url,"thumbnailUrl":e.thumbnailUrl,"deleteUrl":e.deleteUrl,"deleteType":e.deleteType})},"enhanceFiles":function(e,i){},"preload":function(e,i,t){var n=this,a=[],s=n.getValue(),l=function(e){if(e==s.length)return void t(a);n.convertDescriptorToFile(s[e],function(i,t){t&&a.push(t),l(e+1)})};l(0)},"afterPreload":function(e,i,t,n){this.refreshUIState(),n()},"getValue":function(){return this.data},"setValue":function(e){e||(e=[]),this.data=e,this.updateObservable(),this.triggerUpdate()},"reload":function(i){var t=this,n=this.getValue(),a=[],s=function(l){if(l===n.length){var r=e(t.control).find(".alpaca-fileupload-input");return e(r).fileupload("option","done").call(r,e.Event("done"),{"result":{"files":a}}),t.refreshValidationState(),void i()}t.convertDescriptorToFile(n[l],function(e,i){i&&a.push(i),s(l+1)})};s(0)},"plugin":function(){return e(this.control).find(".alpaca-fileupload-input").data().blueimpFileupload},"refreshUIState":function(){var e=this,i=e.plugin();if(i){var t=e.options.maxNumberOfFiles;i.options.getNumberOfFiles&&i.options.getNumberOfFiles()>=t?e.refreshButtons(!1):e.refreshButtons(!0)}},"refreshButtons":function(i){var t=this;e(t.control).find(".binf-btn.fileinput-button").prop("disabled",!0),e(t.control).find(".binf-btn.fileinput-button").attr("disabled","disabled"),e(t.control).find(".fileupload-active-zone p.dropzone-message").css("display","none"),i&&(e(t.control).find(".binf-btn.fileinput-button").prop("disabled",!1),e(t.control).find(".binf-btn.fileinput-button").attr("disabled",null),e(t.control).find(".fileupload-active-zone p.dropzone-message").css("display","block"))},"onFileDelete":function(e){},"onUploadFail":function(e){for(var i=this,t=0;t<e.files.length;t++)e.files[t].error=e.errorThrown;i.options.uploadFailHandler&&i.options.uploadFailHandler.call(i,e)},"getTitle":function(){return"Upload Field"},"getDescription":function(){return"Provides an upload field with support for thumbnail preview"},"getType":function(){return"array"},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"maxNumberOfFiles":{"title":"Maximum Number of Files","description":"The maximum number of files to allow to be uploaded.  If greater than zero, the maximum number will be constrained.  If -1, then no limit is imposed.","type":"number","default":1},"maxFileSize":{"title":"Maximum File Size (in bytes)","description":"The maximum file size allowed per upload.  If greater than zero, the maximum file size will be limited to the given size in bytes.  If -1, then no limit is imposed.","type":"number","default":-1},"fileTypes":{"title":"File Types","description":"A regular expression limiting the file types that can be uploaded based on filename","type":"string"},"multiple":{"title":"Multiple","description":"Whether to allow multiple file uploads.  If maxNumberOfFiles is not specified, multiple will toggle between 1 and unlimited.","type":"boolean","default":!1},"showUploadPreview":{"title":"Show Upload Preview","description":"Whether to show thumbnails for uploaded assets (requires preview support)","type":"boolean","default":!0},"errorHandler":{"title":"Error Handler","description":"Optional function handler to be called when there is an error uploading one or more files.  This handler is typically used to instantiate a modal or other UI element to inform the end user.","type":"function"},"uploadFailHandler":{"title":"Upload Fail Handler","description":"Optional function handler to be called when one or more files fails to upload.  This function is responsible for parsing the underlying xHR request and populating the error message state.","type":"function"}}})}}),i.registerFieldClass("upload",i.Fields.UploadField),i.registerMessages({"chooseFile":"Choose file...","chooseFiles":"Choose files...","dropZoneSingle":"Click the Choose button or Drag and Drop a file here to upload...","dropZoneMultiple":"Click the Choose button or Drag and Drop files here to upload..."}),function(e){function i(i){return r?i.data("events"):e._data(i[0]).events}function t(e,t,n){var a=i(e),s=a[t];if(!r){var l=n?s.splice(s.delegateCount-1,1)[0]:s.pop();return void s.splice(n?0:s.delegateCount||0,0,l)}n?a.live.unshift(a.live.pop()):s.unshift(s.pop())}function n(i,n,a){var s=n.split(/\s+/);i.each(function(){for(var i=0;i<s.length;++i){var n=e.trim(s[i]).match(/[^\.]+/i)[0];t(e(this),n,a)}})}var a=e.fn.jquery.split("."),s=parseInt(a[0]),l=parseInt(a[1]),r=s<1||1===s&&l<7;e.fn.bindFirst=function(){var i=e.makeArray(arguments),t=i.shift();return t&&(e.fn.bind.apply(this,arguments),n(this,t)),this}}(e)}(jQuery),function(e){var i=e.alpaca;i.Fields.UpperCaseField=i.Fields.TextField.extend({"getFieldType":function(){return"uppercase"},"setValue":function(e){var i=e.toUpperCase();i!=this.getValue()&&this.base(i)},"onKeyPress":function(e){this.base(e);var t=this;i.later(25,this,function(){var e=t.getValue();t.setValue(e)})},"getTitle":function(){return"Uppercase Text"},"getDescription":function(){return"Text field for uppercase text."}}),i.registerFieldClass("uppercase",i.Fields.UpperCaseField),i.registerDefaultFormatFieldMapping("uppercase","uppercase")}(jQuery),function(e){var i=e.alpaca;i.Fields.URLField=i.Fields.TextField.extend({"getFieldType":function(){return"url"},"setup":function(){this.inputType="url",this.base(),this.schema.pattern=i.regexps.url,this.schema.format="uri"},"handleValidate":function(){var e=this.validation,i=this._validateOptional();return e.notOptional={"message":i?"":lang.webAddressNeeded,"status":i},i?(i=this._validatePattern(),e.invalidPattern={"message":i?"":this.getMessage("invalidURLFormat"),"status":i}):e.invalidPattern={"message":"","status":!0},i},"getTitle":function(){return"URL Field"},"getDescription":function(){return"Provides a text control with validation for an internet web address."}}),i.registerMessages({"invalidURLFormat":"The URL provided is not a valid web address."}),i.registerFieldClass("url",i.Fields.URLField),i.registerDefaultFormatFieldMapping("url","url")}(jQuery),function(e){var i=e.alpaca;i.Fields.ZipcodeField=i.Fields.TextField.extend({"getFieldType":function(){return"zipcode"},"setup":function(){this.base(),this.options.format=this.options.format?this.options.format:"nine","nine"===this.options.format?this.schema.pattern=i.regexps["zipcode-nine"]:"five"===this.options.format?this.schema.pattern=i.regexps["zipcode-five"]:(i.logError("The configured zipcode format: "+this.options.format+" is not a legal value [five, nine]"),this.options.format="nine",this.schema.pattern=i.regexps["zipcode-nine"]),"nine"===this.options.format?this.options.maskString="99999-9999":"five"===this.options.format&&(this.options.maskString="99999")},"handleValidate":function(){var e=this.base(),i=this.validation;return i.invalidPattern.status||("nine"===this.options.format?i.invalidPattern.message=this.getMessage("invalidZipcodeFormatNine"):"five"===this.options.format&&(i.invalidPattern.message=this.getMessage("invalidZipcodeFormatFive"))),e},"getSchemaOfOptions":function(){return i.merge(this.base(),{"properties":{"format":{"title":"Format","description":"How to represent the zipcode field","type":"string","default":"five","enum":["five","nine"],"readonly":!0}}})},"getOptionsForOptions":function(){return i.merge(this.base(),{"fields":{"format":{"type":"text"}}})},"getTitle":function(){return"Zipcode Field"},"getDescription":function(){return"Provides a five or nine-digital US zipcode control with validation."}}),i.registerMessages({"invalidZipcodeFormatFive":"Invalid Five-Digit Zipcode (#####)","invalidZipcodeFormatNine":"Invalid Nine-Digit Zipcode (#####-####)"}),i.registerFieldClass("zipcode",i.Fields.ZipcodeField),i.registerDefaultFormatFieldMapping("zipcode","zipcode")}(jQuery),function(e){e.alpaca.registerView({"id":"base","title":"Abstract base view","messages":{"countries":{"afg":"Afghanistan","ala":"Aland Islands","alb":"Albania","dza":"Algeria","asm":"American Samoa","and":"Andorra","ago":"Angola","aia":"Anguilla","ata":"Antarctica","atg":"Antigua and Barbuda","arg":"Argentina","arm":"Armenia","abw":"Aruba","aus":"Australia","aut":"Austria","aze":"Azerbaijan","bhs":"Bahamas","bhr":"Bahrain","bgd":"Bangladesh","brb":"Barbados","blr":"Belarus","bel":"Belgium","blz":"Belize","ben":"Benin","bmu":"Bermuda","btn":"Bhutan","bol":"Bolivia","bih":"Bosnia and Herzegovina","bwa":"Botswana","bvt":"Bouvet Island","bra":"Brazil","iot":"British Indian Ocean Territory","brn":"Brunei Darussalam","bgr":"Bulgaria","bfa":"Burkina Faso","bdi":"Burundi","khm":"Cambodia","cmr":"Cameroon","can":"Canada","cpv":"Cape Verde","cym":"Cayman Islands","caf":"Central African Republic","tcd":"Chad","chl":"Chile","chn":"China","cxr":"Christmas Island","cck":"Cocos (Keeling), Islands","col":"Colombia","com":"Comoros","cog":"Congo","cod":"Congo, the Democratic Republic of the","cok":"Cook Islands","cri":"Costa Rica","hrv":"Croatia","cub":"Cuba","cyp":"Cyprus","cze":"Czech Republic","civ":"Cote d'Ivoire","dnk":"Denmark","dji":"Djibouti","dma":"Dominica","dom":"Dominican Republic","ecu":"Ecuador","egy":"Egypt","slv":"El Salvador","gnq":"Equatorial Guinea","eri":"Eritrea","est":"Estonia","eth":"Ethiopia","flk":"Falkland Islands (Malvinas),","fro":"Faroe Islands","fji":"Fiji","fin":"Finland","fra":"France","guf":"French Guiana","pyf":"French Polynesia","atf":"French Southern Territories","gab":"Gabon","gmb":"Gambia","geo":"Georgia","deu":"Germany","gha":"Ghana","gib":"Gibraltar","grc":"Greece","grl":"Greenland","grd":"Grenada","glp":"Guadeloupe","gum":"Guam","gtm":"Guatemala","ggy":"Guernsey","gin":"Guinea","gnb":"Guinea-Bissau","guy":"Guyana","hti":"Haiti","hmd":"Heard Island and McDonald Islands","vat":"Holy See (Vatican City State),","hnd":"Honduras","hkg":"Hong Kong","hun":"Hungary","isl":"Iceland","ind":"India","idn":"Indonesia","irn":"Iran, Islamic Republic of","irq":"Iraq","irl":"Ireland","imn":"Isle of Man","isr":"Israel","ita":"Italy","jam":"Jamaica","jpn":"Japan","jey":"Jersey","jor":"Jordan","kaz":"Kazakhstan","ken":"Kenya","kir":"Kiribati","prk":"Korea, Democratic People's Republic of","kor":"Korea, Republic of","kwt":"Kuwait","kgz":"Kyrgyzstan","lao":"Lao People's Democratic Republic","lva":"Latvia","lbn":"Lebanon","lso":"Lesotho","lbr":"Liberia","lby":"Libyan Arab Jamahiriya","lie":"Liechtenstein","ltu":"Lithuania","lux":"Luxembourg","mac":"Macao","mkd":"Macedonia, the former Yugoslav Republic of","mdg":"Madagascar","mwi":"Malawi","mys":"Malaysia","mdv":"Maldives","mli":"Mali","mlt":"Malta","mhl":"Marshall Islands","mtq":"Martinique","mrt":"Mauritania","mus":"Mauritius","myt":"Mayotte","mex":"Mexico","fsm":"Micronesia, Federated States of","mda":"Moldova, Republic of","mco":"Monaco","mng":"Mongolia","mne":"Montenegro","msr":"Montserrat","mar":"Morocco","moz":"Mozambique","mmr":"Myanmar","nam":"Namibia","nru":"Nauru","npl":"Nepal","nld":"Netherlands","ant":"Netherlands Antilles","ncl":"New Caledonia","nzl":"New Zealand","nic":"Nicaragua","ner":"Niger","nga":"Nigeria","niu":"Niue","nfk":"Norfolk Island","mnp":"Northern Mariana Islands","nor":"Norway","omn":"Oman","pak":"Pakistan","plw":"Palau","pse":"Palestinian Territory, Occupied","pan":"Panama","png":"Papua New Guinea","pry":"Paraguay","per":"Peru","phl":"Philippines","pcn":"Pitcairn","pol":"Poland","prt":"Portugal","pri":"Puerto Rico","qat":"Qatar","rou":"Romania","rus":"Russian Federation","rwa":"Rwanda","reu":"Reunion","blm":"Saint Barthelemy","shn":"Saint Helena","kna":"Saint Kitts and Nevis","lca":"Saint Lucia","maf":"Saint Martin (French part)","spm":"Saint Pierre and Miquelon","vct":"Saint Vincent and the Grenadines","wsm":"Samoa","smr":"San Marino","stp":"Sao Tome and Principe","sau":"Saudi Arabia","sen":"Senegal","srb":"Serbia","syc":"Seychelles","sle":"Sierra Leone","sgp":"Singapore","svk":"Slovakia","svn":"Slovenia","slb":"Solomon Islands","som":"Somalia","zaf":"South Africa","sgs":"South Georgia and the South Sandwich Islands","esp":"Spain","lka":"Sri Lanka","sdn":"Sudan","sur":"Suriname","sjm":"Svalbard and Jan Mayen","swz":"Swaziland","swe":"Sweden","che":"Switzerland","syr":"Syrian Arab Republic","twn":"Taiwan, Province of China","tjk":"Tajikistan","tza":"Tanzania, United Republic of","tha":"Thailand","tls":"Timor-Leste","tgo":"Togo","tkl":"Tokelau","ton":"Tonga","tto":"Trinidad and Tobago","tun":"Tunisia","tur":"Turkey","tkm":"Turkmenistan","tca":"Turks and Caicos Islands","tuv":"Tuvalu","uga":"Uganda","ukr":"Ukraine","are":"United Arab Emirates","gbr":"United Kingdom","usa":"United States","umi":"United States Minor Outlying Islands","ury":"Uruguay","uzb":"Uzbekistan","vut":"Vanuatu","ven":"Venezuela","vnm":"Viet Nam","vgb":"Virgin Islands, British","vir":"Virgin Islands, U.S.","wlf":"Wallis and Futuna","esh":"Western Sahara","yem":"Yemen","zmb":"Zambia","zwe":"Zimbabwe"}}})}(jQuery),function(e){var i=e.alpaca,t={};t.field=function(){},t.control=function(){},t.container=function(){},t.form=function(){},t.required=function(){},t.optional=function(){},t.readonly=function(){},t.disabled=function(){},t.enabled=function(){},t.clearValidity=function(){},t.invalid=function(e){},t.valid=function(){},t.addMessage=function(e,i,t,n){},t.removeMessages=function(){},t.enableButton=function(e){},t.disableButton=function(e){},t.arrayToolbar=function(t){var n=this;if(t){var a=e(n.getFieldEl()).find(".alpaca-array-toolbar[data-alpaca-array-toolbar-field-id='"+n.getId()+"']");if(a.length>0){var s=e("<div class='"+i.MARKER_CLASS_ARRAY_TOOLBAR+"' "+i.MARKER_DATA_ARRAY_TOOLBAR_FIELD_ID+"='"+n.getId()+"'></div>");a.before(s),a.remove()}}else{var s=e(n.getContainerEl()).find("."+i.MARKER_CLASS_ARRAY_TOOLBAR+"["+i.MARKER_DATA_ARRAY_TOOLBAR_FIELD_ID+"='"+n.getId()+"']");if(s.length>0){var l=n.view.getTemplateDescriptor("container-array-toolbar",n);if(l){var r=i.tmpl(l,{"actions":n.toolbar.actions,"id":n.getId(),"toolbarStyle":n.options.toolbarStyle,"view":n.view});e(s).before(r),e(s).remove()}}}},t.arrayActionbars=function(t){for(var n=this,a=0;a<n.children.length;a++){var s=n.children[a],l=s.getId();if(t){var r=e(n.getFieldEl()).find(".alpaca-array-actionbar[data-alpaca-array-actionbar-field-id='"+l+"']");if(r.length>0){var o=e("<div class='"+i.MARKER_CLASS_ARRAY_ITEM_ACTIONBAR+"' "+i.MARKER_DATA_ARRAY_ITEM_KEY+"='"+s.name+"'></div>");r.before(o),r.remove()}}else{var o=e(n.getFieldEl()).find("."+i.MARKER_CLASS_ARRAY_ITEM_ACTIONBAR+"["+i.MARKER_DATA_ARRAY_ITEM_KEY+"='"+s.name+"']");if(o.length>0){var d=n.view.getTemplateDescriptor("container-array-actionbar",n);if(d){var c=i.tmpl(d,{"actions":n.actionbar.actions,"name":s.name,"parentFieldId":n.getId(),"fieldId":s.getId(),"itemIndex":a,"actionbarStyle":n.options.actionbarStyle,"view":n.view});e(o).before(c),e(o).remove()}}}}},t.autocomplete=function(){};var n={};n.button="",n.smallButton="",n.addIcon="",n.removeIcon="",n.upIcon="",n.downIcon="",n.expandedIcon="",n.collapsedIcon="",n.table="",i.registerView({"id":"web-display","parent":"base","type":"display","ui":"web","title":"Default HTML5 display view","displayReadonly":!0,"templates":{},"callbacks":t,"styles":n,"horizontal":!1}),i.registerView({"id":"web-display-horizontal","parent":"web-display","horizontal":!0}),i.registerView({"id":"web-edit","parent":"base","type":"edit","ui":"web","title":"Default HTML5 edit view","displayReadonly":!0,"templates":{},"callbacks":t,"styles":n,"horizontal":!1}),i.registerView({"id":"web-edit-horizontal","parent":"web-edit","horizontal":!0}),i.registerView({"id":"web-create","parent":"web-edit","type":"create","title":"Default HTML5 create view","displayReadonly":!1,"templates":{},"horizontal":!1}),i.registerView({"id":"web-create-horizontal","parent":"web-create","horizontal":!0})}(jQuery),function(e){var i=e.alpaca,t={};t.button="binf-btn binf-btn-default",t.smallButton="binf-btn binf-btn-default binf-btn-sm",t.addIcon="binf-glyphicon binf-glyphicon-plus-sign",t.removeIcon="binf-glyphicon binf-glyphicon-minus-sign",t.upIcon="binf-glyphicon binf-glyphicon-chevron-up",t.downIcon="binf-glyphicon binf-glyphicon-chevron-down",t.expandedIcon="binf-glyphicon binf-glyphicon-circle-arrow-down",t.collapsedIcon="binf-glyphicon binf-glyphicon-circle-arrow-right",t.table="binf-table binf-table-striped binf-table-bordered binf-table-hover";var n={};n.required=function(){var i=this.getFieldEl(),t=e(i).find("label.alpaca-control-label");e('<span class="alpaca-icon-required binf-glyphicon binf-glyphicon-star"></span>').prependTo(t)},n.invalid=function(){this.isControlField&&e(this.getFieldEl()).addClass("binf-has-error")},n.valid=function(){e(this.getFieldEl()).removeClass("binf-has-error")},n.control=function(){var i=this.getFieldEl(),t=this.getControlEl();if(e(i).find("input").addClass("binf-form-control"),e(i).find("textarea").addClass("binf-form-control"),e(i).find("select").addClass("binf-form-control"),e(i).find("input[type=checkbox]").removeClass("binf-form-control"),e(i).find("input[type=file]").removeClass("binf-form-control"),e(i).find("input[type=radio]").removeClass("binf-form-control"),"color"===this.inputType&&e(i).find("input").removeClass("binf-form-control"),e(i).find("input[type=checkbox]").parent().parent().addClass("binf-checkbox"),e(i).find("input[type=radio]").parent().parent().addClass("binf-radio"),e(i).parents("form").hasClass("binf-form-inline")&&(e(i).find("input[type=checkbox]").parent().addClass("binf-checkbox-inline"),e(i).find("input[type=radio]").parent().addClass("binf-radio-inline")),e(i).find("label.alpaca-control-label").addClass("binf-control-label"),this.view.horizontal){e(i).find("label.alpaca-control-label").addClass("binf-col-sm-3");var n=e("<div></div>");n.addClass("binf-col-sm-9"),e(t).after(n),n.append(t),e(i).append("<div style='clear:both;'></div>"),e(i).find(".binf-help-block").length&&e(i).find(".binf-help-block").addClass("binf-help-block-standalone")}},n.container=function(){var i=this.getContainerEl();this.view.horizontal&&e(i).addClass("binf-form-horizontal")},n.form=function(){this.getFormEl()},n.enableButton=function(i){e(i).prop("disabled",!1)},n.disableButton=function(i){e(i).attr("disabled",!0)},n.collapsible=function(){var t=this.getFieldEl(),n=e(t).find("label").first(),a=e("[data-binf-toggle='collapse']",n);if(e(a).length>0){var s=this.getContainerEl(),l=e(s).attr("id");l||(l=i.generateId(),e(s).attr("id",l)),e(s).addClass("binf-collapse binf-in"),e(a).attr("data-binf-target")||e(a).attr("data-binf-target","#"+l),e(a).on("mouseover",function(i){e(this).css("cursor","pointer")})}},i.registerView({"id":"bootstrap-display","parent":"web-display","type":"display","ui":"bootstrap","title":"Display View for Bootstrap 3","displayReadonly":!0,"callbacks":n,"styles":t,"templates":{}}),i.registerView({"id":"bootstrap-display-horizontal","parent":"bootstrap-display","horizontal":!0}),i.registerView({"id":"bootstrap-edit","parent":"web-edit","type":"edit","ui":"bootstrap","title":"Edit View for Bootstrap 3","displayReadonly":!0,"callbacks":n,"styles":t,"templates":{}}),i.registerView({"id":"bootstrap-edit-horizontal","parent":"bootstrap-edit","horizontal":!0}),i.registerView({"id":"bootstrap-create","parent":"bootstrap-edit","title":"Create View for Bootstrap 3","type":"create","displayReadonly":!1}),i.registerView({"id":"bootstrap-create-horizontal","parent":"bootstrap-create","horizontal":!0})}(jQuery),Alpaca.defaultView="bootstrap",Alpaca}),csui.define("hbs!csui/controls/form/impl/templates/form",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<div id="'+this.escapeExpression((a=null!=(a=i.id||(null!=e?e.id:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"id","hash":{}}):a))+'" role="'+this.escapeExpression((a=null!=(a=i.role||(null!=e?e.role:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"role","hash":{}}):a))+'" class="cs-form-inner">\r\n  \x3c!-- Specific tab pane. ID is the name of the href --\x3e\r\n  <div id="form-pane" class="">\r\n\r\n    <span class="title">Description</span>\r\n        <span class="general-body">\r\n            This static content has to be replaced by a dynamically rendered form. The form is rendered from the form\r\n          description given through the constructor, which comprises data, schema and options in the alpaca style. When\r\n          this is done, most of the hbs and css can be thrown away. The markup generated by the full implementation\r\n          of this control should resemble the current static content.\r\n        </span>\r\n\r\n    <div class="general-information">\r\n      <div class="data-line">\r\n        <span class="title">Created</span><span class="label-data">2015-02-06 07:24 PM</span>\r\n      </div>\r\n      <div class="data-line">\r\n        <span class="title">Created by</span><span class="label-data">Jean-Pierre Martin</span>\r\n      </div>\r\n      <div class="data-line">\r\n        <span class="title">Modified</span><span class="label-data">2015-02-14 14:24 PM</span>\r\n      </div>\r\n      <div class="data-line">\r\n        <span class="title">Owner</span><span class="label-data">Clare Fallon</span>\r\n      </div>\r\n      <div class="data-line">\r\n        <span class="title">Type</span><span class="label-data">PDF</span>\r\n      </div>\r\n      <div class="data-line">\r\n        <span class="title">Size</span><span class="label-data">1.2Mb</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="general-extensions">\r\n      <span class="title">Extensions</span>\r\n\r\n      <div class="extensions-wrap">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="extensions-body">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tStandard classification\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br/><br/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBrava\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n'}});return t.registerPartial("csui_controls_form_impl_templates_form",n),n}),csui.define("hbs!csui/controls/form/impl/templates/formsinglecol",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n,a,s){var l;return null!=(l=i.if.call(e,null!=e?e.isSetType:e,{"name":"if","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.program(4,n,0,a,s),"data":n}))?l:""},"2":function(e,i,t,n,a,s){var l;return'      <div class="binf-col-md-12 cs-form-singlecolumn csui-form-set-array-wrapper cs-form-set"\r\n           id="csfSingleCol_'+this.escapeExpression(this.lambda(null!=s[2]?s[2].modelId:s[2],e))+this.escapeExpression((l=null!=(l=i.index||n&&n.index)?l:i.helperMissing,"function"==typeof l?l.call(e,{"name":"index","hash":{},"data":n}):l))+'"></div>\r\n'},"4":function(e,i,t,n,a,s){var l;return'      <div class="binf-col-md-12 cs-form-doublecolumn" id="csfLeftCol_'+this.escapeExpression(this.lambda(null!=s[2]?s[2].modelId:s[2],e))+this.escapeExpression((l=null!=(l=i.index||n&&n.index)?l:i.helperMissing,"function"==typeof l?l.call(e,{"name":"index","hash":{},"data":n}):l))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<div class="binf-row">\r\n  {{#if options.label}}\r\n  <div class="binf-col-md-12 alpaca-container-label">\r\n    <h4>{{options.label}}</h4>\r\n  </div>\r\n  {{/if}}\r\n'+(null!=(l=i.each.call(e,null!=e?e.fields:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"</div>\r\n"},"useData":!0,"useDepths":!0});return t.registerPartial("csui_controls_form_impl_templates_formsinglecol",n),n}),csui.define("hbs!csui/controls/form/impl/templates/formdoublecol",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n,a,s){var l;return null!=(l=i.if.call(e,null!=e?e.isSetType:e,{"name":"if","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.program(4,n,0,a,s),"data":n}))?l:""},"2":function(e,i,t,n,a,s){var l;return'      <div class="binf-col-md-12 cs-form-singlecolumn csui-form-set-array-wrapper cs-form-set"\r\n           id="csfSingleCol_'+this.escapeExpression(this.lambda(null!=s[2]?s[2].modelId:s[2],e))+this.escapeExpression((l=null!=(l=i.index||n&&n.index)?l:i.helperMissing,"function"==typeof l?l.call(e,{"name":"index","hash":{},"data":n}):l))+'"></div>\r\n'},"4":function(e,i,t,n,a,s){var l;return'      <div class="binf-col-md-6 cs-form-doublecolumn cs-form-leftcolumn"\r\n           id="csfLeftCol_'+this.escapeExpression(this.lambda(null!=s[2]?s[2].modelId:s[2],e))+this.escapeExpression((l=null!=(l=i.index||n&&n.index)?l:i.helperMissing,"function"==typeof l?l.call(e,{"name":"index","hash":{},"data":n}):l))+'"></div>\r\n      <div class="binf-col-md-6 cs-form-doublecolumn cs-form-rightcolumn"\r\n           id="csfRightCol_'+this.escapeExpression(this.lambda(null!=s[2]?s[2].modelId:s[2],e))+this.escapeExpression((l=null!=(l=i.index||n&&n.index)?l:i.helperMissing,"function"==typeof l?l.call(e,{"name":"index","hash":{},"data":n}):l))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l;return'<div class="binf-row">\r\n  {{#if options.label}}\r\n  <div class="binf-col-md-12 alpaca-container-label">\r\n    <h4>{{options.label}}</h4>\r\n  </div>\r\n  {{/if}}\r\n'+(null!=(l=i.each.call(e,null!=e?e.fields:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop,"data":n}))?l:"")+"</div>\r\n"},"useData":!0,"useDepths":!0});return t.registerPartial("csui_controls_form_impl_templates_formdoublecol",n),n}),csui.define("txt!csui/controls/form/impl/templates/alpaca.container.array.txt",[],function(){return'{{#if options.canWrite}}\r\n  {{#if options.isMultiRowSetEnabled}}\r\n    <div class="icon-container csui-array-bulk-edit csui-array-bulk-edit-set binf-hidden">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit csui-bulk-edit csui-bulk-edit-{{options\r\n      .uniqueId}}" title="{{options.messages.editFields}}" aria-label="{{options.messages.editFields}}" tabindex="0" data-cstabindex="0"></div>\r\n      <div>\r\n        <span class="csui-bulk-edit-cancel-{{options.uniqueId}} csui-icon-edit inline-edit-icon\r\n        edit-cancel csui-bulk-edit-cancel binf-hidden" title="{{options.messages.cancel}}" aria-label="{{options.messages.cancel}}"\r\n        tabindex="-1" data-cstabindex="-1"></span>\r\n      </div>\r\n    </div>\r\n  {{else}}\r\n  {{/if}}\r\n{{/if}}\r\n<div class="{{#if options.isMultiRowSetEnabled}} cs-form-set {{else}}csui-multivalue-container {{#if options\r\n.isEditMode}} csui-multivalue-block csui-multivalue-read-block {{/if}} {{/if}} cs-form-set-container\r\ncs-form-set-container-{{options.uniqueId}}" {{#if options.isTabable}}tabindex="0"{{/if}}\r\ndata-alpaca-container-item-name={{options.uniqueId}}>\r\n  {{#each items}}\r\n    {{#item}}{{/item}}\r\n  {{/each}}\r\n</div>\r\n{{#if options.canWrite}}\r\n  {{#if options.isMultiRowSetEnabled}}\r\n   {{#if options.applyFlag}}\r\n      <div class="icon-container apply-set binf-hidden">\r\n         <button class="csui-icon apply-all block binf-hidden" title="{{options.messages.titleApplyAll}}"\r\n         aria-label="{{options.messages.titleApplyAll}}" tabindex="0" data-cstabindex="0">\r\n         </button>\r\n      </div>\r\n   {{/if}}\r\n  {{else}}\r\n    {{#if options.isMultiFieldItem}}\r\n    {{else}}\r\n      {{#if options.applyFlag}}\r\n        <div class="icon-container apply-mv binf-hidden">\r\n           <button class="csui-icon apply-all block binf-hidden" title="{{options.messages.titleApplyAll}}"\r\n           aria-label="{{options.messages.titleApplyAll}}" tabindex="0" data-cstabindex="0">\r\n           </button>\r\n        </div>\r\n      {{/if}}\r\n\r\n      <div class="icon-container csui-array-bulk-edit binf-hidden csui-array-bulk-edit-noset">\r\n        <div class="csui-icon-edit inline-edit-icon icon-edit csui-bulk-edit csui-bulk-edit-{{options\r\n        .uniqueId}}" title="{{options.messages.editFields}}" aria-label="{{options.messages.editFields}}"></div>\r\n        <div>\r\n          <span class="csui-bulk-edit-cancel-{{options.uniqueId}} csui-icon-edit inline-edit-icon\r\n          edit-cancel csui-bulk-edit-cancel binf-hidden" title="{{options.messages.cancel}}"\r\n          aria-label="{{options.messages.cancel}}" tabindex="-1" data-cstabindex="-1"></span>\r\n        </div>\r\n      </div>\r\n    {{/if}}\r\n  {{/if}}\r\n{{/if}}\r\n'}),csui.define("txt!csui/controls/form/impl/templates/alpaca.container.array.item.txt",[],function(){return'<div class="cs-array">\r\n    <div class="cs-pull-left cs-array-item-field-wrapper">\r\n        {{#itemField}}{{/itemField}}\r\n    </div>\r\n    <div class="cs-pull-right">\r\n        {{#arrayActionbar}}{{/arrayActionbar}}\r\n    </div>\r\n    <div class="alpaca-clear"></div>\r\n</div>\r\n'}),csui.define("csui/controls/form/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/form/impl/nls/root/lang",{"nodePickerDialogTitle":"Select {0}","noValue":"(no value)","edit":"Edit","cancel":"Cancel","editFields":"Edit fields","fieldEditAria":"{0}: {1}, Click to Edit","fieldReadOnlyAria":"{0}: {1}","userFieldReadOnlyAria":"{0}: {1}, Click to view profile","emptyUserFieldReadOnlyAria":"{0}: {1}","requiredField":", Required","addField":"Add new field","removeField":"Remove field","addRow":"Add row","removeRow":"Remove row","selectFieldDefaultLabel":"None","selectValueLabel":"Select value","addFieldAria":"Add {0} field","removeFieldAria":"Remove {0} field","datePickerIcon":"Date picker","originalNodeUnavailable":"Unavailable node","originalNodeUnavailableTooltip":"The original node is unavailable or you do not have permission to access it.","invalidItem":"Invalid item","invalidUser":"Invalid User","invalidTkl":"Invalid Value","alpacaPlaceholderNotAvailable":"n/a","alpacaPlaceholderGeneric":"Add value","alpacaPlaceholderNumber":"Add value","alpacaPlaceholderText":"Add text","alpacaPlaceholderTime":"Add time","alpacaPlaceholderDate":"Add date","alpacaPlaceholderDateTime":"Add date and time","alpacaPlaceholderEmail":"Add email","alpacaPlaceholderFile":"Select file","alpacaPlaceholderPassword":"Add password","alpacaPlaceholderPhone":"Add phone number","alpacaPlaceholderSearch":"Enter search","alpacaPlaceholderUrl":"Add web address","alpacaPlaceholderIPv4":"Add IP address","alpacaPlaceholderOTUserPicker":"Add user","alpacaPlaceholderOTUserGroupPicker":"Add user or group","alpacaPlaceholderOTNodePicker":"Select object","titleApplyAll":"Apply to all selected items","confirmApplyNotification":"Applied to all selected documents","seeMore":"See more","seeLess":"See less","tklFieldNone":"None","noResultFound":"No Result Found","noOwner":"<No Owner>","noValueSet":"No value","radioFieldValidationErrorInvalidValue":"The selected value does not exist anymore.","showMore":"Show more","showLess":"Show less","showMoreAria":"Show more rows","showLessAria":"Show less rows"}),csui.define("csui/controls/form/fields/alpaca/alpcsuipickerfield.mixin",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette"],function(e,i,t,n){return{"mixin":function(a){return e.extend(a,{"makeAlpCsuiPickerField":function(){},"getFieldType":function(){return this.options.alpacaFieldType},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType()),this.field.parent().addClass(this.options.alpacaFieldClasses||"csui-field-otcs_csuipicker")},"showField":function(){
var a,s=this.id,l=this.options?this.options.descriptionId:"",r=i(this.field[0]).find("label");r&&1==r.length&&(a=r.attr("for")+"Label",r.attr("id",a)),this.fieldView=new this.options.PickerFieldView({"context":this.connector.config.context,"formView":this.connector.config.formView,"model":new t.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":s}),"id":e.uniqueId(s),"alpacaField":this,"labelId":a,"descriptionId":l,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var o=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(o),this.region=new n.Region({"el":o}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.$el.trigger("focus")},"destroy":function(){this.base(),this.region&&this.region.destroy()}})}}}),csui.define("csui/controls/form/fields/base/csformfield.states.behavior",["csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/marionette","csui/utils/log","csui/controls/form/pub.sub","csui/utils/base"],function(e,i,t,n,a,s,l){return n.Behavior.extend({"constructor":function(i,t){n.Behavior.prototype.constructor.apply(this,arguments),this.view=t,this.view.getStatesBehavior=e.bind(function(){return this},this)},"ui":function(){return e.extend({"readArea":".cs-field-read","readAreaInner":".cs-field-read-inner > .btn-container","writeArea":".cs-field-write"},this.view.ui)},"onRender":function(){var e=this.view.model.get("options");e&&e.readonly&&(this.view.mode="readonly"),this.state?this.setStateFromMode(this.state,!1,!1):this.setStateFromMode(this.view.mode,!1,!1)},"isMultiFieldView":function(e){return!e.isTKLField&&!e.isNonTKLField||e.alpacaField.options.isMultiFieldItem&&!!e.alpacaField.parent&&!!e.alpacaField.parent.schema.maxItems&&e.alpacaField.parent.schema.maxItems>1},"setViewStateWriteAndEnterEditMode":function(){var e="--{0}:setViewStateWriteAndEnterEditMode {1} {2}";if(a.debug(e,this.constructor.name,"enter")&&console.log(a.last),!this.isReadOnly()){this.setStateWrite(!0,!0),"writeonly"!==this.mode&&this.view.childTKLViews.map(function(e){this.buildHelpers(),this.isMultiFieldView(e)?e._showItemsInWriteMode():"write"!==e.getStatesBehavior().state&&(e.isMultiFieldView(e)?e.alpacaField.parent._showItemsInWriteMode():(e.valuesPulled=!0,e.getStatesBehavior().setViewStateWriteAndEnterEditMode(!1,!1)))},this),a.debug(e,this.constructor.name,"return")&&console.log(a.last)}},"trySetValueAndLeaveEditMode":function(e){this.trySetValue()&&this.setViewReadOnlyAndLeaveEditMode(e,!0)},"setViewReadOnlyAndLeaveEditMode":function(e,i){var t="{0}:setViewReadOnlyAndLeaveEditMode {1} {2}";a.debug(t,this.constructor.name,"enter")&&console.log(a.last),this.isWriteOnly()||(this.setStateRead(e,i),a.debug(t,this.constructor.name,"return")&&console.log(a.last))},"setStateFromMode":function(e,i,t){switch(e){case"read":case"readonly":this.setStateRead(i,t);break;case"write":case"writeonly":this.setStateWrite(i,t);break;default:this.setStateRead(i,t)}},"buildHelpers":function(){s.tklHelpers||(s.tklHelpers={},s.tklHelpers.viewsInWriteMode=[]),this.isMultiFieldView(this.view)?this.view.alpacaField.parent._updateViewsInWriteMode(this.view):this.view.getEditableBehavior()._updateViewsInWriteMode(this.view),s.tklHelpers.tabInView||(s.tklHelpers.tabInView=this.view)},"setStateWrite":function(e,i){var t="---{0}:setStateWrite {1} {2} {3}";a.debug(t,this.constructor.name,"enter",e,i)&&console.log(a.last);var n=this.state;this.state="write",this.view.setStateWrite(e,i,n)||this._setStateWrite(e,i),l.isLandscape()&&this.$el.find(".icon-date_picker").length>0&&this.view.$el.find(".icon-date_picker ").focus(),(this.view.childTKLViews&&this.view.childTKLViews.length||this.view.alpacaField&&this.view.alpacaField.parent&&(this.view.alpacaField.parent.childRelations&&this.view.alpacaField.parent.childRelations.length||this.view.alpacaField.parent.parentRelations&&this.view.alpacaField.parent.parentRelations.length))&&this.buildHelpers(),a.debug(t,this.constructor.name,"return")&&console.log(a.last)},"_setStateWrite":function(e,i){var t="----{0}:_setStateWrite {1} {2} {3}";a.debug(t,this.constructor.name,"enter",e,i)&&console.log(a.last),this.ui.readArea.addClass("binf-hidden"),this.ui.writeArea.removeClass("binf-hidden"),i&&!this.hasWriteFocus()&&this.view.ui.writeField.trigger("focus").trigger("focus"),i&&this.view.ui.writeField.trigger("select"),a.debug(t,this.constructor.name,"return")&&console.log(a.last)},"setStateRead":function(e){if(this.view.options.model.attributes.options&&this.view.options.model.attributes.options.isMultiFieldItem){this.view.$el.closest(".cs-form-set-container.csui-multivalue-block").addClass("csui-multivalue-read-block");var i=this.view.$el.closest(".cs-form-set-container").is("visible");i.length>0&&i.removeClass("csui-multivalue-set-write-mode")}var t="---{0}:setStateRead {1} {2}";a.debug(t,this.constructor.name,"enter")&&console.log(a.last),this.state="read",this.view.setStateRead(e)||this._setStateRead(e),s.tklHelpers&&s.tklHelpers.viewsInWriteMode.length>0&&(-1!==s.tklHelpers.viewsInWriteMode.indexOf(this.view)&&s.tklHelpers.viewsInWriteMode.splice(s.tklHelpers.viewsInWriteMode.indexOf(this.view),1),0===s.tklHelpers.viewsInWriteMode.length&&delete s.tklHelpers),a.debug(t,this.constructor.name,"return")&&console.log(a.last)},"_setStateRead":function(e){var i="----{0}:_setStateRead {1} {2}";a.debug(i,this.constructor.name,"enter")&&console.log(a.last),this.ui.writeArea.addClass("binf-hidden"),this.ui.readArea.removeClass("binf-hidden"),e&&this.view.ui.readField.trigger("focus"),a.debug(i,this.constructor.name,"return")&&console.log(a.last)},"isReadOnly":function(){return this.view.$el.hasClass("cs-booleanfield")?"readonly"===this.view.mode:this.view.options.alpacaField?this.view.options.alpacaField.schema.readonly:"readonly"===this.view.mode},"isWriteOnly":function(){return"writeonly"===this.view.mode},"isStateRead":function(){return"read"===this.state},"isStateWrite":function(){return"write"===this.state},"hasReadFocus":function(){return this.ui.readField.is(":focus")},"hasReadHover":function(){return this.ui.readField.is(":hover")},"hasWriteFocus":function(){return this.ui.writeField.is(":focus")}})}),csui.define("csui/controls/form/impl/fields/csformfield.states.behavior",["csui/controls/form/fields/base/csformfield.states.behavior"],function(e){return e}),csui.define("csui/controls/form/fields/base/csformfield.editable.behavior",["csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/marionette","csui/controls/form/pub.sub","csui/utils/log","i18n!csui/controls/form/impl/nls/lang","csui/utils/base"],function(e,i,t,n,a,s,l,r){return n.Behavior.extend({"constructor":function(i,t){if(n.Behavior.prototype.constructor.apply(this,arguments),this.view=t,this.isIE11=r.isIE11(),this.view.childTKLViews=[],this.view.parentViews=[],this.view.cancelClicked=!1,this.view.isTKLField||(this.view.isNonTKLField=!0),this.tabableElements=[],this.tabContentSelectors="input:visible, .cs-field-write button:visible:not(:disabled),textarea:visible, .icon-date_picker:visible",i.tabContentSelectors&&(i.overrideTabContentSelectors?this.tabContentSelectors=i.tabContentSelectors:this.tabContentSelectors+=", "+i.tabContentSelectors),this.view.formView=this.view.options.alpacaField&&this.view.options.alpacaField.connector.config.formView,this.view.isCustomView=!(!this.view.formView||!this.view.formView.options.customView),!this.view.isBooleanField&&this.view.options.alpacaField){var s,l;this.view.isCustomView?s=this.view.options.alpacaField.schema.fieldID:(l=this.view.options.alpacaField.parent&&this.view.options.alpacaField.parent.parent,l&&(l=l.parent&&l.parent.options.isSetType),s=this.view.options.alpacaField.propertyId||this.view.options.alpacaField.parent&&this.view.options.alpacaField.parent.propertyId),s&&(l&&(this.isMultiFieldView()?s+="_"+this.view.options.alpacaField.parent.parent.name.split("_").pop():s+="_"+this.view.options.alpacaField.parent.name.split("_").pop()),a.off(s+"tkl:buildRelation"),this.listenTo(a,s+"tkl:buildRelation",this.buildRelation)),this.listenTo(this.view,"selection:changed",function(){this.view.trigger("parenttkl:changed",this.view.childTKLViews)}),this.listenTo(this.view,"parenttkl:changed",this.changeChildrenValues)}this.view.getEditableBehavior=e.bind(function(){return this},this),this.listenTo(this.view,"field:changed",function(){this.view.isValidField=!1}),this.view.listenTo(this.view,"render disable:field",e.bind(function(){this.disableField()},this)),this.view.listenTo(this.view.formView,"request:completed",e.bind(function(){this.view.formView&&this.view.formView.propagatedView&&this.isEventPending&&(this.view=this.view.formView.propagatedView,this.setViewStateWriteAndEnterEditMode())},this))},"ui":function(){return e.extend({"editIcon":".csui-icon-edit.icon-edit","cancelIcon":".edit-cancel","icons":".inline-edit-icon","readArea":".cs-field-read","readAreaInner":".cs-field-read-inner","writeArea":".cs-field-write","applyAll":".apply-all"},this.view.ui)},"events":{"click @ui.editIcon":"onEditIconClicked","mouseleave @ui.editIcon":"onMouseOutRead","mousedown @ui.applyAll":"onApplyAllClicked","keydown @ui.applyAll":"onApplyAllClicked","click @ui.cancelIcon":"onCancelClicked","mousedown @ui.cancelIcon":"onMouseDownCancel","touchend @ui.cancelIcon":"onMouseDownCancel","mouseup @ui.readField":"onMouseupRead","click @ui.readArea":"onReadAreaClicked","mouseleave @ui.readArea":"onMouseOutRead","mouseover @ui.readArea":"onMouseOverRead","focusout @ui.writeField":"onFocusOutWrite","focusout @ui.writeArea":"onFocusOutWriteArea","focusin @ui.writeField":"onFocusInWrite","focusin @ui.subInputField":"actionOnFocusIn","focusout @ui.readField":"onFocusOutRead","focusin @ui.readField":"onFocusInRead","keypress @ui.writeField":"onChangeWriteField","input @ui.writeField":"onChangeWriteField","change @ui.writeField":"onChangeWriteField","paste":"onKeyPress","keypress":"onKeyPress","keydown":"onKeyDown","mousedown":"onMouseDown","touchend":"onMouseDown"},"onRender":function(){this.hasReadFocus()?this._showEditIcon():this._hideEditIcon(),"writeonly"===this.view.mode&&this._hideCancelIcon(),this.mouseDownCancel=!1},"disableField":function(){this.view.ui.writeField&&this.view&&this.view.alpacaField&&this.view.alpacaField.schema&&this.view.alpacaField.schema.disabled&&(this.view.ui.writeField.prop("disabled",!1),this.view.ui.writeField.attr("readonly",!0),this.view.ui.writeField.attr("aria-disabled",!0),this.view.ui.writeField.addClass("csui-formfield-disabled"))},"onDestroy":function(){this.unsetCheckShowEditIcon()},"buildRelation":function(e){this.isMultiFieldView(e)?(-1===this.view.childTKLViews.indexOf(e.alpacaField.parent)&&this.view.childTKLViews.push(e.alpacaField.parent),e.alpacaField.parent.parentRelations=e.alpacaField.parent.parentRelations?e.alpacaField.parent.parentRelations:[],-1===e.alpacaField.parent.parentRelations.indexOf(this.view)&&e.alpacaField.parent.parentRelations.push(this.view)):-1===this.view.childTKLViews.push(e)&&this.view.childTKLViews.push(e),e.parentViews=e.parentViews?e.parentViews:[],-1===e.parentViews.indexOf(this.view)&&e.parentViews.push(this.view)},"isMultiFieldView":function(e){e||(e=this.view);var i=e.alpacaField||e.options.alpacaField;return!e.isTKLField&&!e.isNonTKLField||i.options.isMultiFieldItem&&!!i.parent&&!!i.parent.schema.maxItems&&i.parent.schema.maxItems>1},"isDropDownOpen":function(){return void 0!==this.view.alpacaField&&("select"!==this.view.alpacaField.type&&this.view.options.isDropDownOpen||"select"===this.view.alpacaField.type&&!!this.view.isDropdownOpen&&this.view.isDropdownOpen())},"onMouseDown":function(){this.escapePressed=!1,this.mouseDownCancel=!1,this.view.cancelClicked=!1,this.view.alpacaField&&(this.view.alpacaField.parent.cancelClicked=!1),this.isIE11&&(this.ui.writeField&&!this.ui.writeField.val()?this.tabPressed=void 0:this.tabPressed=!1)},"cancelViewInEditMode":function(e){e._resetOldValue();var i=e.view.alpacaField,t=!(!i||!i.schema.required||i.options.validate),n=this.view.$el.find(".binf-datetimepicker-widget");r.isLandscape()&&n.length>0&&n.hide(),t&&(i.schema.required=!1,i.options.validate=!0),i&&i.setValueAndValidate(e.view.oldVal,!0),t&&(i.schema.required=!0,i.options.validate=!1),this.escapePressed||e.setViewReadOnlyAndLeaveEditMode(!0,!0),this.escapePressed=!1,e.$el.removeClass("cs-formfield-invalid")},"onCancelClicked":function(){var e=this;if(a.tklHelpers&&a.tklHelpers.viewsInWriteMode.length>0)for(var i,t=a.tklHelpers.viewsInWriteMode.length-1;t>=0&&a.tklHelpers;t--)(i=a.tklHelpers.viewsInWriteMode[t])&&(i.alpacaField.parent.cancelClicked=!0,e.isMultiFieldView(i)?i.alpacaField.parent.getFieldEl().find(".csui-bulk-edit-cancel").trigger("click"):i.getEditableBehavior().cancelViewInEditMode(i.getEditableBehavior()),i.cancelClicked=!1);else this.view.cancelClicked=!0,this.cancelViewInEditMode(this),this.view.cancelClicked=!1;a.tklHelpers&&0===a.tklHelpers.viewsInWriteMode.length&&delete a.tklHelpers},"onMouseDownCancel":function(e){this.mouseDownCancel=!0,e.stopPropagation()},"onKeyPress":function(e){if(!this.view.onKeyPress||!this.view.onKeyPress(e))return 13===e.keyCode&&(this.view.getStatesBehavior().isStateRead()&&this.view.allowEditOnEnter()?this.setViewStateWriteAndEnterEditMode():this.view.getStatesBehavior().isStateWrite()&&this.view.allowSaveOnEnter()&&(e.preventDefault(),e.stopPropagation(),this.trySetValueAndLeaveEditMode(!0,!0))),!0},"onKeyDown":function(e){if(this.escapePressed=!1,this.tabPressed=!1,27===e.keyCode)this.view.getStatesBehavior().isStateWrite()&&(e.preventDefault(),e.stopPropagation(),this.escapePressed=!0,"writeonly"!==this.view.mode?this.cancelViewInEditMode(this):"writeonly"===this.view.mode&&this.trySetValue(),this.isDropDownOpen()||this.setViewReadOnlyAndLeaveEditMode(!0,!0));else if(113===e.keyCode)this.view.getStatesBehavior().isStateRead()?this.setViewStateWriteAndEnterEditMode():this.view.getStatesBehavior().isStateWrite()&&((null!==this.view.getOldValue()?this.view.getOldValue().toString():"")!==this.view.getEditValue()&&this.changeChildrenValues(this.view.childTKLViews),this.validateRelatedFields(),this.trySetValueAndLeaveEditMode(!0,!0));else if(9===e.keyCode){if(this.view.alpacaField&&"create"===this.view.alpacaField.options.mode){var t=i.Event("tab:content:field:changed");this.view.$el.trigger(t)}var n=this.view.options.mode||this.view.alpacaField&&this.view.alpacaField.options.mode;"create"!==n&&this.view.getStatesBehavior().isStateWrite()&&this.moveTab(e),this.tabPressed=!0}},"_updateTabableElements":function(e){this.tabableElements.length=0;var t=this.view.alpacaField?this.view.alpacaField.containerItemEl.closest(".cs-form"):this.view.$el.closest(".cs-form");this.tabableElements=t.find(this.tabContentSelectors).filter(function(t,n){var a=!0;return i(e.target).closest(".cs-form-set")[0]?a=i(e.target).closest(".cs-form-set")[0]===i(n).closest(".cs-form-set")[0]:i(n).is(":checkbox")&&(a=!1),a})},"moveTab":function(e){this._updateTabableElements(e);var t=i(this.tabableElements).index(e.target),n=(t===this.tabableElements.length-1||e.shiftKey&&0===t)&&"writeonly"===this.view.mode;return e.shiftKey?t>0?t-=1:t=this.tabableElements.length-1:t>=this.tabableElements.length-1?t=0:t+=1,n||(this.tabableElements[t].focus(),e.preventDefault(),e.stopPropagation()),this.tabableElements[t]},"_showApplyAll":function(e){var t=this.$el.find(".icon-container");if(t.hasClass("binf-hidden")&&(t.first().removeClass("binf-hidden"),t.removeAttr("data-cstabindex"),t.removeAttr("tabindex")),this.view.options.alpaca&&"create"===this.view.options.alpaca.options.mode&&0===this.view.$el.closest(".csui-general-form").length){var n=this.$(e.target).parents(".cs-field-write").parent().find(".csui-icon.apply-all"),a=this.$el.closest(".cs-metadata-properties").find(".csui-icon.apply-all").not(".binf-hidden");if(a=a.filter(function(e,i){return i=i!==n[0]?i:void 0}),a&&a.length>0&&(a.addClass("binf-hidden"),a.parent().addClass("binf-hidden")),n.hasClass("binf-hidden")){n.removeAttr("style"),n.removeClass("binf-hidden"),n.prop("tabindex","0"),n.parent().hasClass("binf-hidden")&&n.parent().removeClass("binf-hidden");var s=i.Event("tab:content:field:changed");this.view.$el.trigger(s)}}},"_hideApplyAll":function(e){if(this.$el&&0===this.$el.find(".apply-all").not(".binf-hidden").length){var i=document.querySelectorAll(".cs-form .apply-all:not(.binf-hidden)");i.length>0&&i[0].classList.add("binf-hidden")}else if(this.escapePressed){var t=this.$el.find(".icon-container");t[0].classList.add("binf-hidden"),t.attr("data-cstabindex",-1),t.attr("tabindex",-1)}},"_updateTabPositionFocus":function(e){var t,n,a,s,l;for(t=i(document.querySelectorAll(".binf-tab-content")).children(),n=t.find("input, textarea, button.binf-dropdown-toggle"),s=n.length,l=0;l<s&&(!(a=n[l])||!i(a).is(i(e.currentTarget).find("input,textarea,button:not(:disabled)").first()));)l++;l<=s&&i(n[l+1]).trigger("focus")},"showAppliedTick":function(e,t){var n=e.target;n.callback=t,n.eve=e,i(n).fadeOut(100,function(){i(this).removeClass(),i(this).addClass("csui-icon applied_done"),i(this).fadeIn(100,function(){setTimeout(function(e){i(e).fadeOut(800,function(){i(this).removeClass(),i(this).addClass("csui-icon apply-all binf-hidden"),this.callback(this.eve)})},1e3,this)})}),i(".metadata-sidebar .metadata-sidebar-fadeout").fadeOut(2e3,function(){i(".metadata-sidebar .cs-list-group .arrow-overlay").removeClass("metadata-sidebar-arrow-overlay"),i(".metadata-sidebar .cs-list-group").removeClass("metadata-sidebar-cs-list-group"),i(this).remove()})},"onApplyAllClicked":function(t){("keydown"===t.type&&13===t.keyCode||"mousedown"===t.type)&&(this.view.selectField&&(this.view.trySetValue()?this.$el.removeClass("cs-formfield-invalid"):this.$el.addClass("cs-formfield-invalid")),setTimeout(function(n){if(i(t.currentTarget).parents(".alpaca-container-item")&&0===i(t.currentTarget).parents(".alpaca-container-item").find(".cs-formfield-invalid").length){var a=n.view.getValue();a instanceof Object&&(a=a.id);var s={"fieldvalue":null===a?"":a.toString(),"fieldpath":n.view.alpacaField&&n.view.alpacaField.name,"action":n.showAppliedTick,"fieldevent":t,"callback":n._updateTabPositionFocus};i(".metadata-sidebar .cs-list-group").addClass("metadata-sidebar-cs-list-group"),i(".metadata-sidebar .cs-list-group .arrow-overlay").addClass("metadata-sidebar-arrow-overlay"),i("<div/>",{"class":"metadata-sidebar-fadeout"}).appendTo(i(".metadata-sidebar .cs-list-group"));var l=i.Event("click:applyAll");if(e.extend(l,s),n.$el.trigger(l),n.view&&n.view.alpacaField&&"tkl"===n.view.alpacaField.type){var r=function(i){i.parentViews.length>0&&e.each(i.parentViews,function(i){n.view.isMultiFieldView(i)?(s.fieldpath=i.propertyId,s.fieldvalue=i.getValue(),e.extend(l,s),n.$el.trigger(l),r(i.children[0].fieldView)):(s.fieldpath=i.alpacaField?i.alpacaField.name:i.view.field.name,s.fieldvalue=i.getValue()instanceof Object?i.getValue().id:i.getValue().toString(),e.extend(l,s),n.$el.trigger(l),r(i))})};r(n.view);var o=function(i){i.children.length>0&&e.each(i.children,function(i){n.view.isMultiFieldView(i)?(s.fieldpath=i.propertyId,s.fieldvalue=i.getValue(),e.extend(l,s),n.$el.trigger(l),r(i.children[0].fieldView)):(s.fieldpath=i.alpacaField?i.alpacaField.name:i.view.field.name,s.fieldvalue=i.getValue()instanceof Object?i.getValue().id:i.getValue().toString(),e.extend(l,s),n.$el.trigger(l),o(i))})};o(n.view)}}},100,this))},"onChangeWriteField":function(i){(this.isIE11||"keypress"!==i.type)&&(this.isIE11&&"input"===i.type&&(void 0===this.tabPressed||this.tabPressed)||("write"===this.view.getStatesBehavior().state&&(this._showApplyAll(i),setTimeout(e.bind(this.adjustSetRows,this),100)),this.escapePressed&&"write"===this.view.getStatesBehavior().state&&this._hideApplyAll(i)))},"onFocusInWrite":function(e){return this.checkAndScrollElemToViewport(e.currentTarget),this.isIE11&&(""===this.ui.writeField.val()?this.tabPressed=void 0:void 0===this.ui.writeField.val()?this.tabPressed=void 0:this.tabPressed=!1),this._hideApplyAll(e),!1},"onFocusOutWrite":function(e){var t;if(i(e.target).parents(".csui-normal-scrolling").css("overflow","auto"),!this.view.selectField){if(""!==e.target.value){if(void 0!==this.view.userPicked){if(!this.view.userPicked)return this.view.alpacaField&&this.view.alpacaField.refreshValidationState(!1),this.$el.addClass("cs-formfield-invalid"),void this.$el.trigger(i.Event("field:invalid"));this.$el.removeClass("cs-formfield-invalid")}}else this.isIE11&&(""===this.ui.writeField.val()?this.tabPressed=void 0:void 0===this.ui.writeField.val()?this.tabPressed=void 0:this.tabPressed=!1);if("writeonly"!==this.view.mode){if(this.view.cancelClicked=this.view.alpacaField?this.isCancelClicked(this.view.alpacaField.parent):this.view.cancelClicked,!this.view.isReadyToSave()||this.escapePressed||this.mouseDownCancel)return void(this.mouseDownCancel=!1);if(this.view.cancelClicked)return void this.onCancelClicked();if(this.view.isValidField=!this.view.$el.closest(".csui-custom-view-search").length&&!!this.view.oldVal&&this.view.curVal===this.view.getEditValue()&&!this.view.$el.closest(".alpaca-field").find(".binf-help-block").length,this.view.isValidField?t=this.view.isValidField&&this.validateRelatedFields()&&this.trySetValue():this.isRelatedFieldInFocus(e.relatedTarget)?this.view.oldVal=this.view.curVal:(this.changeChildrenValues(this.view.childTKLViews,this.view,(null!==this.view.getOldValue()?this.view.getOldValue().toString():"")!==this.view.getEditValue()),t=this.validateRelatedFields()&&this.trySetValue()),this.isRelatedFieldInFocus(e.relatedTarget)&&(this.view.alpacaField&&"select"!==this.view.alpacaField.type||this.view.alpacaField&&"otcs_user"!==this.view.alpacaField.type))return void(this.view.getOldValue()&&this.view.getOldValue().toString()!==this.view.getEditValue().toString()?this.changeChildrenValues(this.view.childTKLViews):this.changeChildrenValues(this.view.childTKLViews,void 0,!1))}else t=this.trySetValue();return t&&(this.$el.removeClass("cs-formfield-invalid"),this.setViewReadOnlyAndLeaveEditMode(!0,!1),"writeonly"===this.view.mode&&0===document.querySelectorAll(".binf-has-error").length&&(i(".metadata-validation-error").hide(),i("div").removeClass("show-validation-error"))),this.view.getOldValue()&&this.view.getOldValue()!==this.view.getEditValue()&&this.view.getEditableBehavior().changeChildrenValues(this.view.childTKLViews),void(a.tklHelpers&&0===a.tklHelpers.viewsInWriteMode.length&&delete a.tklHelpers)}var n=this;setTimeout(function(){if(n.view.isReadyToSave()||n.escapePressed||n.mouseDownCancel)return void(n.mouseDownCancel=!1);if(n.isRelatedFieldInFocus(e.relatedTarget)||(t=n.validateRelatedFields()&&n.trySetValue()),t){if(n.$el.removeClass("cs-formfield-invalid"),n.isRelatedFieldInFocus(e.relatedTarget))return void(n.view.getOldValue()&&n.view.getOldValue()!==n.view.getEditValue()&&n.changeChildrenValues(n.view.childTKLViews,void 0,!1));n.setViewReadOnlyAndLeaveEditMode(!0,!1),"writeonly"===n.view.mode&&0===document.querySelectorAll(".binf-has-error").length&&(i(".metadata-validation-error").hide(),i("div").removeClass("show-validation-error"))}else n.isRelatedFieldInFocus(e.relatedTarget)||n.$el.addClass("cs-formfield-invalid");a.tklHelpers&&0===a.tklHelpers.viewsInWriteMode.length&&delete a.tklHelpers},0)},"validateRelatedFields":function(){var e,i=!0;if(a.tklHelpers&&a.tklHelpers.viewsInWriteMode.length>0&&this.view.childTKLViews.length||this.view.parentViews.length)for(var t=0;t<a.tklHelpers.viewsInWriteMode.length;t++)e=a.tklHelpers.viewsInWriteMode[t],a.tklHelpers.viewsInWriteMode[t]!==this.view&&(i?i=e.alpacaField.setValueAndValidate(e.getEditValue(),!0):e.alpacaField.setValueAndValidate(e.getEditValue(),!0));return i},"isCancelClicked":function(e,t){for(var n=t&&t.relatedTarget&&i(t.relatedTarget).hasClass("csui-icon-edit"),s=[],l=0;a.tklHelpers&&l<a.tklHelpers.viewsInWriteMode.length;l++){var r=a.tklHelpers.viewsInWriteMode[l];if(r.$el.is(":visible")){if(this.isMultiFieldView(r)){if(r.alpacaField.parent.cancelClicked){n=!0;break}}else if(r.getEditableBehavior().mouseDownCancel){n=!0;break}}else s.push(r)}return a.tklHelpers&&s.length&&(a.tklHelpers.viewsInWriteMode=a.tklHelpers.viewsInWriteMode.filter(function(e){return-1===s.indexOf(e)})),n||e&&e.cancelClicked},"getFieldIndex":function(e){if(e.alpacaField&&e.alpacaField.options.isMultiFieldItem&&e.alpacaField.parent.schema.maxItems&&1!==e.alpacaField.parent.schema.maxItems)return e.alpacaField.parent.children.indexOf(e.alpacaField)},"getRowIndex":function(e){e||(e=this.view.alpacaField.parent),this.isMultiFieldView(e)||(e=e.alpacaField.parent);var i=e.parent;return i&&i.parent?i.parent.children.indexOf(i):-1},"changeChildrenValues":function(i,t,n){var a,s,l=this.options.dataId?this:this.view,r=!1,o=-1!==l.options.dataId.indexOf("x")&&1===l.options.dataId.match(/x/g).length;e.each(i,function(e){if(!o||this.getEditableBehavior().getRowIndex()===this.getEditableBehavior().getRowIndex(e))if(this.getEditableBehavior().isMultiFieldView(this)){if(a=this.getEditableBehavior().getFieldIndex(this),s=this.getEditableBehavior().normalizeViews(e),o&&parseInt(this.options.dataId.split("_")[2])!==parseInt(s[0].options.dataId.split("_")[2]))return;s[0].alpacaField.options.isMultiFieldItem?(s.forEach(function(e){e.getEditableBehavior().changeChildrenValues(e.children,e,!1),e.valuesPulled=!1}),s[a]&&(e=s[a],r=void 0===n||n,this.getEditableBehavior().changeChildrenValues(e.children,e))):0===a&&(e=s[a],r=!0,this.getEditableBehavior().changeChildrenValues(e.children,e)),r&&(e.valuesPulled=!1,e.ui.writeField.val(""),e.setValue("",!0),e.needRerender=!0,e.options.enum.length=0,e.trigger("tkl:refresh"))}else{if(s=this.getEditableBehavior().normalizeViews(e),o&&parseInt(this.options.dataId.split("_")[2])!==parseInt(s[0].options.dataId.split("_")[2]))return;var i=this;r=void 0===n||n,s.forEach(function(e){i.getEditableBehavior().changeChildrenValues(e.children,e,n),e.valuesPulled=!1,r&&(e.isValidTKLState=!0,e.options.alpacaField.isRequired()?e.isValidTKLState=!1:(e.$el.parents(".binf-form-group.alpaca-field").removeClass("binf-has-error alpaca-invalid"),e.$el.removeClass("cs-formfield-invalid")),e.$el.parents(".binf-form-group.alpaca-field").find(".binf-help-block.alpaca-message.alpaca-message-custom").hide(),e.setValue(""),e.options.alpaca.schema.enum.length=0,e.trigger("tkl:refresh"))})}},t||l)},"isRelatedFieldInFocus":function(e){return e=e||document.activeElement,a.tklHelpers?a.tklHelpers.viewsInWriteMode.some(function(i){return i.ui.writeField[0]===e}):i.contains(this.view.$el[0],e)},"normalizeViews":function(e){var i=[];return e.isTKLField||e.isNonTKLField?i.push(e):this.isMultiFieldView(e)?e.children.map(function(e){i.push(e.fieldView)}):i.push(e.children[0].fieldView),i},"onFocusOutWriteArea":function(e){var t=i(e.delegateTarget);r.isLandscape()&&t.find(".binf-datetimepicker-widget").length>0&&t.find(".binf-datetimepicker-widget").hide()},"onFocusInRead":function(e){this.checkAndScrollElemToViewport(e.currentTarget),this._showEditIcon()},"actionOnFocusIn":function(e){this.checkAndScrollElemToViewport(e.currentTarget)},"checkAndScrollElemToViewport":function(e){r.checkAndScrollElemToViewport(e)},"onFocusOutRead":function(e){if(this.view.isBooleanField||e.stopPropagation(),!this.view.getStatesBehavior().isReadOnly()&&!this.view.getStatesBehavior().isWriteOnly()){if(this._hideEditIcon(),this.$el.closest(".alpaca-container-item-last").length>0){this.$el.closest(".alpaca-field-array").find(".csui-array-bulk-edit-noset").not(".binf-hidden").addClass("binf-hidden")}clearTimeout(this.mouseOverTimeout),this.mouseOverTimeout=null}},"onMouseOverRead":function(){this.view.getStatesBehavior().isReadOnly()||"create"===this.options.mode||this.mouseOverTimeout||0!==document.querySelectorAll(".cs-form .cs-formfield-invalid").length||(this.mouseOverTimeout=setTimeout(e.bind(this._showEditIcon,this),300))},"onMouseOutRead":function(){this.hasReadFocus()||this.view.getStatesBehavior().isWriteOnly()||(this._hideEditIcon(),clearTimeout(this.mouseOverTimeout),this.mouseOverTimeout=null)},"onEditIconClicked":function(e){e.stopImmediatePropagation(),this.setViewStateWriteAndEnterEditMode()},"onReadAreaClicked":function(e){return!this.view.isBooleanField&&("create"===this.options.mode||0!==document.querySelectorAll(".cs-form .cs-formfield-invalid").length?(document.querySelector(".cs-form .cs-formfield-invalid input, .cs-form .cs-formfield-invalid .cs-field-write button").focus(),!1):!!(!this.view.getStatesBehavior().isReadOnly()||this.view.alpacaField&&this.view.alpacaField.options&&"url"===this.view.alpacaField.options.type)&&void((e.target.classList.contains("icon-edit")||this.view.allowEditOnClickReadArea(e))&&(e.stopImmediatePropagation(),e.preventDefault(),this.setViewStateWriteAndEnterEditMode())))},"onMouseupRead":function(e){e.stopPropagation(),e.preventDefault(),this.view.ui.readField.trigger("focus")},"setCheckShowEditIcon":function(){this.checkShowEditIcon=setInterval(e.bind(this.checkShowEditIcon,this),10)},"unsetCheckShowEditIcon":function(){clearInterval(this.checkShowEditIcon)},"checkShowEditIcon":function(){this.view.getStatesBehavior().isStateRead()&&this.hasReadFocus()},"buildHelpers":function(){a.tklHelpers||(a.tklHelpers={},a.tklHelpers.viewsInWriteMode=[]),this._updateViewsInWriteMode(this.view),a.tklHelpers.tabInView||(a.tklHelpers.tabInView=this.view)},"setViewStateWriteAndEnterEditMode":function(e){if(this.view.cancelClicked=!1,this.view.formView&&(this.view.formView.isDataUpdating||(this.isEventPending=!1),this.view.formView.isDataUpdating))return this.view.formView.options.metadataView&&!this.view.formView.options.metadataView.blockingView.$el.is(":visible")&&(this.view.formView.options.metadataView.blockActions(),this.isEventPending=!0,this.view.formView.triggerMethod("request:processing",this.view)),!1;if(!this.view.getStatesBehavior().isReadOnly()){var i=!1!==e||e;if(this.view.getStatesBehavior().setStateWrite(!1,i),r.isLandscape()&&this.$el.find(".icon-date_picker").length>0&&this.view.$el.find(".icon-date_picker").focus(),this.view.handleToggle&&this.view.handleToggle(),"writeonly"!==this.mode){(this.view.alpacaField&&"tkl"===this.view.alpacaField.type?this.view.children:this.view.childTKLViews).map(function(e){this.buildHelpers(),this.isMultiFieldView(e)?(e=e._showItemsInWriteMode?e:e.alpacaField.parent,e._showItemsInWriteMode(),e.getFieldEl().find(".csui-array-bulk-edit").removeClass("binf-hidden"),e.getFieldEl().find(".csui-bulk-edit-cancel").removeClass("binf-hidden"),e.getFieldEl().find(".csui-bulk-edit-submit").removeClass("binf-hidden"),e.getFieldEl().find(".csui-bulk-edit").addClass("binf-hidden")):"write"!==e.getStatesBehavior().state&&(e.isMultiFieldView(e)?e.alpacaField.parent._showItemsInWriteMode():e.getEditableBehavior().setViewStateWriteAndEnterEditMode(!1))},this)}this.view._beforeTurnsToWriteMode&&this.view._beforeTurnsToWriteMode()}},"trySetValueAndLeaveEditMode":function(e,i){var t=null!==this.view.getOldValue()&&void 0!==this.view.getOldValue()?this.view.getOldValue().toString():"";this.changeChildrenValues(this.view.childTKLViews,this.view,t!==this.view.getEditValue());var n=!0,s=this;(a.tklHelpers&&a.tklHelpers.viewsInWriteMode.length?a.tklHelpers.viewsInWriteMode:this.view.childTKLViews).map(function(e){e!==s.view&&(n=e.alpacaField&&e.alpacaField.setValueAndValidate(e.getEditValue(),!0)&&n)}),n&&this.trySetValue()&&this.setViewReadOnlyAndLeaveEditMode(e,i)},"setViewReadOnlyAndLeaveEditMode":function(e,i){if(!this.view.getStatesBehavior().isWriteOnly()){this.view._beforeTurnsToReadMode&&this.view._beforeTurnsToReadMode(),this.view.getStatesBehavior().setStateRead(i)
;var t,n,s=a.tklHelpers&&a.tklHelpers.viewsInWriteMode.length?a.tklHelpers.viewsInWriteMode:this.view.childTKLViews;if(s&&s.length>0){t=this.isCancelClicked(this.view.alpacaField.parent)||this.escapePressed;for(var l=s.length-1;l>=0;l--)(n=s[l])&&(this.isMultiFieldView(n)?(n=n.alpacaField?n.alpacaField.parent:n,t?(n.getFieldEl().find(".csui-bulk-edit-cancel").trigger("click"),n.cancelClicked=!1,this.view.alpacaField.parent&&(this.view.alpacaField.parent.cancelClicked=!1)):n.children[0]&&"tkl"===n.children[0].type?n._doBulkSubmitActionTKL(!0):n._doBulkSubmitAction()):((n.alpacaField.parent.cancelClicked||this.escapePressed)&&"write"===n.getStatesBehavior().state&&(n.getEditableBehavior().escapePressed=!1,n.cancelClicked=!1,n.getEditableBehavior()._resetOldValue(),"tkl"===n.alpacaField.type&&(n.isValidTKLState=!0),n.alpacaField.refreshValidationState(),n.$el.removeClass("cs-formfield-invalid")),n.isTKLField&&(n.oldVal=n.curVal),n.getStatesBehavior().setStateRead(i)))}this.view.cancelClicked=!1}},"trySetValue":function(){var e=this.view.trySetValue?this.view.trySetValue():this._trySetValue();return this.view.isValidField=e,e},"_showCancelIcon":function(){this.ui.cancelIcon.show()},"_hideCancelIcon":function(){this.ui.cancelIcon.hide()},"_showEditIcon":function(){this.view.getStatesBehavior().isReadOnly()||this._isEditIconVisible()||this.ui.editIcon.removeClass("binf-hidden")},"_hideEditIcon":function(){this.ui.editIcon.addClass("binf-hidden")},"_isEditIconVisible":function(){return!this.view.getStatesBehavior().isStateWrite()&&!this.ui.editIcon.hasClass("binf-hidden")},"_isCancelIconVisible":function(){return this.ui.cancelIcon.is(":visible")},"hasReadFocus":function(){return this.ui.readField.is(":focus")},"hasReadHover":function(){return this.ui.readField.is(":hover")},"hasWriteFocus":function(){return this.ui.writeField.is(":focus")},"_updateViewsInWriteMode":function(e){setTimeout(function(){a.tklHelpers||(a.tklHelpers={},a.tklHelpers.viewsInWriteMode=[]),e.isCustomView||-1!==a.tklHelpers.viewsInWriteMode.indexOf(e)||(e.cancelClicked=!1,e.alpacaField.parent&&(e.alpacaField.parent.cancelClicked=!1),a.tklHelpers.viewsInWriteMode.push(e)),a.tklHelpers.tabInView||(a.tklHelpers.tabInView=e)},151)},"_trySetValue":function(){var e=null!==this.view.getEditValue()&&void 0!==this.view.getEditValue()?this.view.getEditValue():"",i=null!==this.view.getValue()&&void 0!==this.view.getValue()?this.view.getValue().toString():"",t=!0,n=this.view.$el.hasClass("cs-formfield-invalid"),s=this.view.isReadyToSave(),l=this.view.alpacaField&&this.view.alpacaField.schema.required,r=this.view.alpacaField&&this.view.alpacaField.options.validate,o="writeonly"===this.view.mode,d=""===i;return this.view.alpacaField&&"otcs_user"===this.view.alpacaField.type&&(t=this.view.userPicked),s&&(e!==i||o||n||!o&&l&&r&&d)&&(t=this.view.setValue(e,!0),t&&a.tklHelpers&&a.tklHelpers.viewsInWriteMode.map(function(e){e.isTKLField&&(e.oldVal=e.curVal,e.valuesPulled=!1)}),!t&&this.view.ui.writeField.select),t},"_resetOldValue":function(){if(!this.view.resetOldValueAfterCancel()){var e=this.view.getValue();!1!==this.view.userPicked&&(e=e instanceof Object?e.display_name:e,this.ui.writeField.val(e)),void 0!==this.view.userPicked&&(this.view.userPicked=!0)}this.$el.hasClass("cs-formfield-invalid")&&this.$el.removeClass("cs-formfield-invalid")},"adjustSetRows":function(){var e=this.$el.parents(".cs-form-set-container.csui-hoveredScrollable").find(".csui-set-scroll-container-child"),i=this.$el.parents().closest(".cs-form-set-container.csui-hoveredScrollable .csui-scrollablecols");void 0!==e&&void 0!==i&&e.scrollLeft(i.scrollLeft())}})}),csui.define("csui/controls/form/impl/fields/csformfield.editable.behavior",["csui/controls/form/fields/base/csformfield.editable.behavior"],function(e){return e}),csui.define("csui/controls/form/fields/base/csformarrayfield.editable.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.editable.behavior","csui/controls/form/pub.sub","csui/utils/log","csui/utils/base"],function(e,i,t,n,a,s,l,r,o){"use strict";return s.extend({"jQuery":t,"constructor":function(e,t){s.prototype.constructor.apply(this,arguments),this.view=t,this.tabContentSelectors+=", button.alpaca-array-actionbar-action:visible:not(:disabled),button.csui-icon.apply-all:visible",e.tabContentSelectors&&(e.overrideTabContentSelectors?this.tabContentSelectors=e.tabContentSelectors:this.tabContentSelectors+=", "+e.tabContentSelectors);var n=this.view.options.alpacaField.name.split("_")[0]+"_"+this.view.options.alpacaField.name.split("_")[1];l.off(n+"tkl:buildRelation"),this.listenTo(l,n+"tkl:buildRelation",this.buildRelation),this.view.listenTo(this.view.formView,"request:completed",i.bind(function(){this.view.formView&&this.view.formView.propagatedView&&this.view.formView.propagatedView.isEventPending&&this.propagatedEvent&&(this.view=this.view.formView.propagatedView,this.onReadAreaClicked(this.propagatedEvent))},this)),this.view.getEditableBehavior=i.bind(function(){return this},this)},"ui":function(){return i.extend({},{"editIcon":".csui-icon-edit.icon-edit","cancelIcon":".edit-cancel","icons":".inline-edit-icon","readArea":".cs-field-read","readAreaInner":".cs-field-read-inner","writeArea":".cs-field-write"},this.view.ui)},"events":function(){return i.extend({},s.prototype.events,{"mouseenter @ui.writeArea":"mouseInFieldArea","focusin @ui.flagWriteField":"actionOnFocusIn","mouseleave @ui.writeArea":"mouseOutFieldArea","focusin @ui.subInputField":"actionOnFocusIn"})},"buildRelation":function(e){this.view.alpacaField.parent.childRelations||(this.view.alpacaField.parent.childRelations=[]),this.view.getEditableBehavior().isMultiFieldView(e)&&!e.alpacaField.parent.parentRelations&&(e.alpacaField.parent.parentRelations=[]),this.view.alpacaField.parent.children.forEach(function(i){if(this.view.getEditableBehavior().isMultiFieldView(e)){if(-1===this.view.alpacaField.parent.childRelations.indexOf(e.alpacaField.parent)&&this.view.alpacaField.parent.childRelations.push(e.alpacaField.parent),i.fieldView)i.fieldView.childTKLViews.push(e.alpacaField.parent);else var t=setInterval(function(){i.fieldView&&(i.fieldView.childTKLViews.push(e.alpacaField.parent),clearInterval(t))},10);-1===e.alpacaField.parent.parentRelations.indexOf(this.view.alpacaField.parent)&&e.alpacaField.parent.parentRelations.push(this.view.alpacaField.parent)}else-1===this.view.alpacaField.parent.childRelations.indexOf(e)&&this.view.alpacaField.parent.childRelations.push(e),i.fieldView&&i.fieldView.childTKLViews.push(e),-1===e.parentViews.indexOf(this.view.alpacaField.parent)&&e.parentViews.push(this.view.alpacaField.parent)},this),-1===e.parentViews.indexOf(this.view.alpacaField.parent)&&e.parentViews.push(this.view.alpacaField.parent)},"onMouseOverRead":function(){this.view.getStatesBehavior().isReadOnly()||"create"===this.options.mode||this.mouseOverTimeout||0!==this.jQuery(".cs-form .cs-formfield-invalid").length||(this.mouseOverTimeout=setTimeout(i.bind(this._showEditIcon,this),300))},"onFocusInWrite":function(e){this.checkAndScrollElemToViewport(e.currentTarget);var n=this.$el.find("input").length;if("radio"===this.view.alpacaField.type&&n>1?t(this.$el).find('input[type="radio"]').each(function(){t(this).is(":checked")&&t(this).parent().parent().parent().trigger("focus")}):this.$el.find("input").trigger("select"),this.$el.find("textarea").trigger("select"),this.$el.closest(".cs-form-set-container:not(.csui-multivalue-container)").length>0){var a=this.$el.closest(".cs-form-set-container:not(.csui-multivalue-container)").find(".csui-current-focused");a.length>0&&a.removeClass("csui-current-focused"),t(e.target).addClass("csui-current-focused")}if((this.view.alpacaField&&"otcs_user_picker"===this.view.alpacaField.schema.type||this.view.alpacaField&&"otcs_member_picker"===this.view.alpacaField.schema.type)&&e.target!==e.relatedTarget){var s=this.$el.closest(".cs-form-set-container:not(.csui-multivalue-container)").find(".binf-open");s.length>0&&s.find(".binf-dropdown-toggle").binf_dropdown("toggle")}if("write"===this.view.getStatesBehavior().state&&this._showOrHideInlineActionButtons(e),!this.view.getStatesBehavior().isReadOnly()){if(this.view.options.path&&2===this.view.options.path.split("/").length){var l=this.$el.parents(".cs-form-set-container").find(".alpaca-array-actionbar");l.off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),l.off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this))}else{var r=this.jQuery(e.target).closest(".cs-form-set-container").parent().closest(".cs-pull-left");0===r.length&&(r=this.jQuery(e.target).closest(".cs-pull-left")),r.parent().siblings().off("mouseenter").on("mouseenter",i.bind(this.mouseInArrayActionArea,this)),r.parent().siblings().off("mouseleave").on("mouseleave",i.bind(this.mouseOutArrayActionArea,this)),r.parent().off("mouseenter").on("mouseenter",i.bind(this.mouseInArrayActionArea,this)),r.parent().off("mouseleave").on("mouseleave",i.bind(this.mouseOutArrayActionArea,this)),0===r.find(".alpaca-array-actionbar").length?(r.parent().find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),r.parent().find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this))):(r.find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),r.find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this))),r.parent().siblings().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),r.parent().siblings().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this)),r.parent().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),r.parent().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this)),r.siblings(".cs-pull-right").length>0&&(r.siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&r.siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")?r.siblings(".cs-pull-right").removeClass("csui-set-action-bar"):r.siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&r.siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")||r.siblings(".cs-pull-right").addClass("csui-set-action-bar"))}return!1}},"actionOnFocusIn":function(e){if(this.checkAndScrollElemToViewport(e.currentTarget),"write"===this.view.getStatesBehavior().state&&this._showOrHideInlineActionButtons(e),!this.view.getStatesBehavior().isReadOnly()&&"read"!==this.view.getStatesBehavior().state)if(this.view.options.path&&2===this.view.options.path.split("/").length){var t=this.$el.parents(".cs-form-set-container").find(".alpaca-array-actionbar");t.off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),t.off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this))}else{var n=this.jQuery(e.target).closest(".cs-form-set-container").parent().closest(".cs-pull-left");0===n.length&&(n=this.jQuery(e.target).closest(".cs-pull-left")),0===n.find(".alpaca-array-actionbar").length?(n.parent().find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),n.parent().find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this))):(n.find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),n.find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this))),n.parent().siblings().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),n.parent().siblings().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this)),n.parent().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseenter").on("mouseenter",i.bind(this.mouseInActionArea,this)),n.parent().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseleave").on("mouseleave",i.bind(this.mouseOutActionArea,this)),n.siblings(".cs-pull-right").length>0&&(n.siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&n.siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")?n.siblings(".cs-pull-right").removeClass("csui-set-action-bar"):n.siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&n.siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")||n.siblings(".cs-pull-right").addClass("csui-set-action-bar"))}},"_showOrHideInlineActionButtons":function(e){var i=this.$el.parents(".cs-form-set-container"),n=i[i.length-1],a=this.jQuery(n),s=this.jQuery(e.target).closest(".cs-form-set-container");this.isDropDownOpen()||(a.find(".cs-array .cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden"),a.find(".cs-array .cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),s.find(".circle_add_grey").parent().addClass("binf-hidden"),this.$el.parent().closest(".cs-form-set-container").find(".circle_delete_grey").parent().addClass("binf-hidden"));if(this.view.options.path&&2===this.view.options.path.split("/").length)a.length>0?t(a.find(".cs-array .cs-pull-left").find(".cs-field-write-inner").first()):s.length>0&&t(s.find(".cs-array .cs-pull-left").find(".cs-field-write-inner").first());else{a.length>0?t(a.find(".cs-array .cs-pull-left").find(".cs-field-write-inner").first()):s.length>0&&t(s.find(".cs-array .cs-pull-left").find(".cs-field-write-inner").first());var l=s.parents(".cs-array").height();s.parent().hasClass("cs-form-multi-action-container")&&(s.parents(".cs-array").find(">.cs-pull-right").find("button[data-alpaca-array-actionbar-action*='add']").css("top",parseInt(l)/2),s.parents(".cs-form-set-container").not(".csui-multivalue-block").find(">.cs-array:first-child").find(">.cs-pull-right").find("button[data-alpaca-array-actionbar-action*='remove']").css("top",14)),s.parents(".cs-array").find(">.cs-pull-right").find("button[data-alpaca-array-actionbar-action*='remove']").addClass("cs-array-set-remove-align")}var r=parseInt(this.$el.outerHeight()),o=this.$el.parent().closest(".alpaca-container-item");this.isDropDownOpen()||(o.find(".circle_delete_grey").parent().removeClass("binf-hidden"),o.find(".circle_add_grey").removeClass("alpaca-button-disabled").parent().removeClass("binf-hidden")),(o.hasClass("cs-form-multi-action-container")||o.parent().hasClass("cs-form-multi-action-container"))&&(o.find(".circle_delete_grey").parent().css("top",r/2-7),o.find(".circle_add_grey").parent().css("top",r-7)),o=this.$el.closest(".cs-pull-left").siblings(".cs-pull-right"),this.isDropDownOpen()||(o.find(".circle_delete_grey").parent().removeClass("binf-hidden"),o.find(".circle_add_grey").removeClass("alpaca-button-disabled").parent().removeClass("binf-hidden")),s.parent().closest(".cs-pull-left")&&(o=s.parent().closest(".cs-pull-left").siblings(".cs-pull-right"),this.isDropDownOpen()||(o.find(".circle_delete_grey").parent().removeClass("binf-hidden"),o.find(".circle_add_grey").removeClass("alpaca-button-disabled").parent().removeClass("binf-hidden")),o.find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")||o.find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled"))},"onFocusOutWrite":function(e){if(t(e.target).parents(".csui-normal-scrolling").css("overflow","auto"),void 0!==this.view.isFocusedOut&&this.view.isFocusedOut(e))return!1;if(this.view.options.path&&2===this.view.options.path.split("/").length){var i=this.$el.parents(".cs-form-set-container").find(".alpaca-array-actionbar");i.off("mouseenter"),i.off("mouseleave")}else a=this.jQuery(e.target).closest(".cs-form-set-container").parent().closest(".cs-pull-left"),0===a.length&&(a=this.jQuery(e.target).closest(".cs-pull-left")),a.parent().siblings().off("mouseenter"),a.parent().siblings().off("mouseleave"),a.parent().off("mouseenter"),a.parent().off("mouseleave"),0===a.find(".alpaca-array-actionbar").length?(a.parent().find(".alpaca-array-actionbar").off("mouseenter"),a.parent().find(".alpaca-array-actionbar").off("mouseleave")):(a.find(".alpaca-array-actionbar").off("mouseenter"),a.find(".alpaca-array-actionbar").off("mouseleave")),a.parent().siblings().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseenter"),a.parent().siblings().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseleave"),a.parent().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseenter"),a.parent().find(".cs-pull-left").find(".alpaca-array-actionbar").off("mouseleave"),a.siblings(".cs-pull-right").length>0&&(a.siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&a.siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")?a.siblings(".cs-pull-right").removeClass("csui-set-action-bar"):a.siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&a.siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")||a.siblings(".cs-pull-right").addClass("csui-set-action-bar"));var n=this.jQuery(e.target).closest(".cs-form-set-container"),a=n.parent().closest(".cs-pull-left").siblings(".cs-pull-right"),s=this.$el.closest(".cs-pull-left").siblings(".cs-pull-right");if(void 0!==this.view.userPicked&&(this.view.options.isDropDownOpen=!1,""!==e.target.value)){if(!this.view.userPicked)return this.view.alpacaField&&this.view.alpacaField.refreshValidationState(!1),this.$el.addClass("cs-formfield-invalid"),void this.$el.trigger(t.Event("field:invalid"));this.$el.removeClass("cs-formfield-invalid")}if(this.view.isReadyToSave()&&!this.escapePressed&&!this.mouseDownCancel&&!this.jQuery(e.relatedTarget).hasClass("csui-icon-edit")||"select"===this.view.alpacaField.type||"tkl"===this.view.alpacaField.type){var l=this.view.getEditValue(),r=this.view.getValue(),o=l!==r;t.contains(this.view.alpacaField.parent.getFieldEl()[0],e.relatedTarget);if(this.view.alpacaField&&"select"===this.view.alpacaField.type)this.view.oldVal=this.view.curVal,o=this.trySetValue();else if(this.view.alpacaField&&"tkl"===this.view.alpacaField.type)o=this.trySetValue();else{var d=this.view.alpacaField.options.validate;if(this.view.alpacaField.options.inContainer)if(null!=l&&l.trim&&l.trim())this.view.alpacaField.options.validate=!0;else{var c=this.view.alpacaField.validation;for(var u in c)void 0!==c[u]&&(c[u].status=!0,c[u].message="")}o=this.view.alpacaField.setValueAndValidate(l,!0),this.view.alpacaField.options.validate=d}var h="integer"===this.view.alpacaField.type&&null!==this.view.curVal?this.view.curVal.toString():this.view.curVal,p=this.view.getEditValue();"select"===this.view.alpacaField.type&&(h=this.view.curVal.get("id"),p=this.view.getEditValue().get("id"));var f=this.view.getEditableBehavior().isRelatedFieldInFocus(e.relatedTarget);return h!==p&&this.view.getEditableBehavior().changeChildrenValues(this.view.alpacaField.parent.childRelations),!this.options.isSetType&&f||t(e.relatedTarget).closest(".cs-tkl-options").length>0?(this.view.alpacaField.parent.turnToReadMode=!1,void(this.view.isTKLField&&!t.contains(this.view.ui.tklOptions[0],e.relatedTarget)&&this.view.hideDropdown())):(this.view.alpacaField.parent.turnToReadMode=!0,"create"!==this.view.alpacaField.options.mode||this.jQuery(e.relatedTarget).parent().hasClass("alpaca-array-actionbar")||!e.relatedTarget||e.relatedTarget.classList.contains("icon-date_picker")||(a=this.jQuery(e.target).closest(".cs-form-set-container").find(".cs-pull-left"),s=this.jQuery(e.target).closest(".cs-form-set-container").find(".cs-pull-left").find(".cs-pull-right"),a.find(".circle_delete_grey").parent().addClass("binf-hidden"),a.find(".circle_add_grey").parent().addClass("binf-hidden"),s.find(".circle_delete_grey").parent().addClass("binf-hidden"),s.find(".circle_add_grey").parent().addClass("binf-hidden")),void(o?(this.$el.removeClass("cs-formfield-invalid"),o=this.view.alpacaField.setValueAndValidate(p,!0),l&&!l.toString().length&&o&&this.view.isTKLField&&this.view.changeChildrenValues(this.view.children)):(this.$el.addClass("cs-formfield-invalid"),this.$el.trigger(t.Event("field:invalid")))))}this.mouseDownCancel=!1,this.view.alpacaField&&"create"===this.view.alpacaField.options.mode&&(a.find(".circle_delete_grey").parent().addClass("binf-hidden"),a.find(".circle_add_grey").parent().addClass("binf-hidden"));var m=t(e.target).closest(".csui-scrollable-writemode");m&&m.hasClass("csui-dropdown-open")&&m.removeClass("csui-dropdown-open")},"_showApplyAll":function(e){if(this.view.options.alpaca&&"create"===this.view.options.alpaca.options.mode){var i=this.$(e.target).closest(".alpaca-field-array").find(".csui-icon.apply-all.block:first").length>0?this.$(e.target).closest(".alpaca-field-array").find(".csui-icon.apply-all.block:first"):this.$(e.target).closest(".alpaca-field-array").children(".cs-form-set-container").length>0?this.$(e.target).closest(".alpaca-field-array").parents(".alpaca-field-array").find(".csui-icon.apply-all.block:first"):this.$(e.target).closest(".alpaca-field-array").closest(".csui-form-set-array-wrapper").find(".csui-icon.apply-all.block:first"),t=this.$el.closest(".cs-metadata-properties").find(".csui-icon.apply-all").not(".binf-hidden");t=t.filter(function(e,t){return t=t!==i[0]?t:void 0}),t&&t.length>0&&(t.addClass("binf-hidden"),t.parent().addClass("binf-hidden")),i.parent().hasClass("binf-hidden")&&i.parent().removeClass("binf-hidden alpaca-container"),i.hasClass("binf-hidden")&&(i.removeAttr("style"),i.removeClass("binf-hidden"),i.prop("tabindex","0"))}},"onReadAreaClicked":function(e){if(this.view.formView.propagatedEvent=null,this.view.isEventaPropagated=!1,this.propagatedEvent=null,this.view.isEventPending=!1,"create"===this.options.mode||0!==t(".cs-form .cs-formfield-invalid").length)return void t(t(".cs-form .cs-formfield-invalid")[0]).find(":input").trigger("focus").trigger("focus");if(!this.view.getStatesBehavior().isReadOnly()){var i=e.target.classList.contains("icon-edit");if("writeonly"!==this.view.mode&&(i||this.view.allowEditOnClickReadArea(e))){e.stopImmediatePropagation(),e.preventDefault();var n=e,a=t(".csui-bulk-edit-"+this.view.options.dataId.slice(0,this.view.options.dataId.indexOf("_",this.view.options.dataId.indexOf("_")+1)));if(a.length>1&&(a=a.parent()&&a.parent().not(".binf-hidden").find(".csui-bulk-edit-"+this.view.options.dataId.slice(0,this.view.options.dataId.indexOf("_",this.view.options.dataId.indexOf("_")+1)))),a&&0===a.length&&(a=this.jQuery(n.target).closest(".cs-form-set-container").parent().find(".csui-bulk-edit")),this.view.isEventPending=!1,this.view.formView.isDataUpdating)return this.view.formView.options.metadataView&&!this.view.formView.options.metadataView.blockingView.$el.is(":visible")&&(this.view.formView.options.metadataView.blockActions(),this.view.isEventPending=!0,this.propagatedEvent=event,this.view.formView.triggerMethod("request:processing",this.view)),!1;t(a).closest(".csui-array-bulk-edit").removeClass("binf-hidden"),t(a).trigger("click"),this.setViewStateWriteAndEnterEditMode()}}},"setViewStateWriteAndEnterEditMode":function(){if(!this.view.getStatesBehavior().isReadOnly()){this.view.alpacaField&&!this.view.alpacaField.options.isMultiFieldItem&&"select"===this.view.alpacaField.type&&this.view.$el.find(".binf-dropdown-toggle").trigger("click"),this.view.getStatesBehavior().setStateWrite(!1,!0),o.isLandscape()&&this.$el.find(".icon-date_picker").length>0&&this.view.$el.find(".icon-date_picker").trigger("focus"),this.adjustSetRows()}},"setViewReadOnlyAndLeaveEditMode":function(e,i){this.view.getStatesBehavior().isWriteOnly()||this.view.getStatesBehavior().setStateRead(i)},"onKeyDown":function(e){if(this.escapePressed=!1,this.tabPressed=!1,27===e.keyCode){var i=t(".csui-bulk-edit-cancel-"+this.view.options.dataId.slice(0,this.view.options.dataId.indexOf("_",this.view.options.dataId.indexOf("_")+1)));i&&0===i.length&&(i=this.jQuery(e.target).closest(".cs-form-set-container").parent().find(".csui-bulk-edit-cancel")),"writeonly"!==this.view.mode&&(this.isDropDownOpen()||t(i).trigger("click"))}else 9===e.keyCode&&(this.tabPressed=!0,!!this.view.handleTabKey&&this.view.handleTabKey(e),"create"!==(this.view.options.mode||this.view.alpacaField&&this.view.alpacaField.options.mode)&&this.view.getStatesBehavior().isStateWrite()&&this.moveTab(e))},"normalizeViews":function(e){var i=[];return e.isTKLField||e.isNonTKLField?i.push(e):this.isMultiFieldView(e)?e.children.map(function(e){i.push(e.fieldView)}):i.push(e.children[0].fieldView),i},"mouseInFieldArea":function(e){if(e.preventDefault(),e.stopPropagation(),"write"===this.view.getStatesBehavior().state&&this.$el.closest(".cs-array").find(".csui-shadowright-container").off("mouseenter").on("mouseenter",i.bind(this.mouseInFieldArea,this)),!this.view.getStatesBehavior().isStateRead()){var t,n=this.$el.closest(".cs-pull-left");return(this.$el.parents(".cs-form-set-container").find(document.activeElement).length<=1||this.$el.find(document.activeElement).length<=1)&&(n.siblings(".cs-pull-right").find(".circle_add_grey").parent().removeClass("binf-hidden"),n.siblings(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden")),this.view.options.path&&this.view.options.path.split("/").length>2&&this.$el.find(document.activeElement).length>0&&(n.siblings(".cs-pull-right").find(".circle_add_grey").parent().removeClass("binf-hidden"),n.siblings(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden"),n.parents(".cs-pull-left").siblings(".cs-pull-right").find(".circle_add_grey").parent().removeClass("binf-hidden"),n.parents(".cs-pull-left").siblings(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden"),t=n.parents(".cs-pull-left").length>0?n.parents(".cs-pull-left"):n,this._alignSetContainerActionButtons(t)),this.view.options.path&&2===this.view.options.path.split("/").length?this._alignMultiFieldContainerActionButtons(n):(this._alignMultiFieldContainerActionButtons(n),t=n.parents(".cs-pull-left").length>0?n.parents(".cs-pull-left"):n,t.siblings(".cs-pull-right").find(".circle_delete_grey").parent().addClass("cs-array-set-remove-align"),this._alignSetContainerActionButtons(t)),"select"!==this.view.alpacaField.type&&this.view.options.isDropDownOpen?this.hideActions(e):"select"===this.view.alpacaField.type&&this.view.isDropdownOpen&&this.view.isDropdownOpen()?this.hideActions(e):this.showActions(e),!0}},"_alignMultiFieldContainerActionButtons":function(e){var i=this.$el.height(),t=e.siblings(".cs-pull-right");e.parent().hasClass("cs-form-multi-action-container")&&(t.find(".circle_add_grey").parent().css("top",i-7),t.find(".circle_delete_grey").parent().css("top",i/2-7))},"_alignSetContainerActionButtons":function(e){var i=e.siblings(".cs-pull-right");i.find(".circle_add_grey").parent().removeClass("binf-hidden"),i.find(".circle_delete_grey").parent().removeClass("binf-hidden"),i.find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&i.find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")||i.addClass("csui-set-action-bar"),i.find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")||i.find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")},"mouseOutFieldArea":function(e){if(e.preventDefault(),e.stopPropagation(),!this.view.getStatesBehavior().isStateRead()){var i=this.$el.closest(".cs-pull-left"),t=i.siblings(".cs-pull-right"),n=i.parents(".cs-pull-left").length>0?i.parents(".cs-pull-left"):i,a=n.siblings(".cs-pull-right");return 0!==this.$el.parents(".cs-form-set-container").find(document.activeElement).length&&0!==this.$el.find(document.activeElement).length||0!==t.find(document.activeElement).length||(t.find(".circle_add_grey").parent().addClass("binf-hidden"),t.find(".circle_delete_grey").parent().addClass("binf-hidden")),a.is(":visible")||a.removeClass("csui-set-action-bar"),!0}},"mouseInActionArea":function(e){e.preventDefault(),e.stopPropagation(),this.view.getStatesBehavior().isStateRead()||(this.jQuery(e.target).closest(".cs-pull-right").find(".circle_add_grey").parent().removeClass("binf-hidden"),this.jQuery(e.target).closest(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden"))},"mouseOutActionArea":function(e){e.preventDefault(),e.stopPropagation(),this.view.getStatesBehavior().isStateRead()||(0===this.jQuery(document.activeElement).parents(".cs-pull-right").length?0===this.jQuery(document.activeElement).parent().closest(".cs-pull-left").siblings(".cs-pull-right").find(e.target).length&&(this.jQuery(e.target).closest(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),this.jQuery(e.target).closest(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden")):1===this.jQuery(document.activeElement).parents(".cs-pull-right").length&&0===this.jQuery(document.activeElement).parent().closest(".cs-pull-right").find(e.target).length&&(this.jQuery(e.target).closest(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),this.jQuery(e.target).closest(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden")))},"mouseInArrayActionArea":function(e){if(e.preventDefault(),e.stopPropagation(),!this.view.getStatesBehavior().isStateRead()){var i=this.jQuery(e.target).closest(".cs-array");if(0===i.find(document.activeElement).length&&(i.children(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden"),i.children(".cs-pull-right").find(".circle_add_grey").removeClass("alpaca-button-disabled").parent().removeClass("binf-hidden")),i.children(".cs-pull-right").is(":visible")){var t=i.children(".cs-pull-right");t.find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&t.find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")||t.addClass("csui-set-action-bar")}}},"mouseOutArrayActionArea":function(e){if(e.preventDefault(),e.stopPropagation(),!this.view.getStatesBehavior().isStateRead()){var i=this.jQuery(e.target).closest(".cs-array");0===i.find(document.activeElement).length?(i.children(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden"),i.children(".cs-pull-right").find(".circle_add_grey").removeClass("alpaca-button-disabled").parent().addClass("binf-hidden")):(i.children(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden"),i.children(".cs-pull-right").find(".circle_add_grey").removeClass("alpaca-button-disabled").parent().removeClass("binf-hidden")),i.children(".cs-pull-right").removeClass("csui-set-action-bar")}},"showActions":function(e){this.$el.closest(".cs-pull-left")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("binf-hidden")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_add_grey").parent().removeClass("binf-hidden"),this.$el.closest(".cs-pull-left")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("binf-hidden")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_delete_grey").parent().removeClass("binf-hidden")},
"hideActions":function(e){this.$el.closest(".cs-form-set-container").hasClass("csui-multivalue-container")&&(this.$el.closest(".cs-pull-left")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right")&&!this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_add_grey").parent().hasClass("binf-hidden")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),this.$el.closest(".cs-pull-left")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right")&&!this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_delete_grey").parent().hasClass("binf-hidden")&&this.$el.closest(".cs-pull-left").siblings(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden"))}})}),csui.define("csui/controls/form/impl/array/csformarrayfield.editable.behavior",["csui/controls/form/fields/base/csformarrayfield.editable.behavior"],function(e){return e}),csui.define("csui/controls/form/fields/base/csformarrayfield.states.behavior",["csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.states.behavior","csui/utils/log","csui/utils/base"],function(e,i,t,n,a,s,l){"use strict";return a.extend({"constructor":function(e,i){a.apply(this,arguments)},"_setStateWrite":function(e,i){var t="----{0}:_setStateWrite {1} {2} {3}";s.debug(t,this.constructor.name,"enter",e,i)&&console.log(s.last),this.ui.readArea.addClass("binf-hidden"),this.ui.writeArea.removeClass("binf-hidden"),this.view.options.model.attributes.options.isMultiFieldItem&&this.ui.writeArea.find(".icon-container").addClass("binf-hidden"),!i||this.hasWriteFocus()||l.isLandscape()&&this.$el.find(".icon-date_picker").length>0?l.isLandscape()&&this.$el.find(".icon-date_picker").length>0&&this.$el.find(".icon-date_picker").trigger("focus"):this.view.ui.writeField.trigger("focus").trigger("focus"),i&&!this.view.options.model.attributes.options.isMultiFieldItem&&this.view.ui.writeField.select(),s.debug(t,this.constructor.name,"return")&&console.log(s.last)}})}),csui.define("csui/controls/form/impl/array/csformarrayfield.states.behavior",["csui/controls/form/fields/base/csformarrayfield.states.behavior"],function(e){return e}),csui.define("css!csui/controls/form/impl/fields/csformfield",[],function(){}),csui.define("csui/controls/form/fields/base/csformfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/controls/form/impl/fields/csformfield.editable.behavior","csui/controls/form/impl/fields/csformfield.states.behavior","csui/controls/form/impl/array/csformarrayfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.states.behavior","csui/behaviors/default.action/default.action.behavior","csui/controls/form/pub.sub","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/csformfield","csui/lib/binf/js/binf"],function(e,i,t,n,a,s,l,r,o,d,c,u){"use strict";return n.ItemView.extend({"constructor":function(i){this.options=i||{},i.model.attributes.options&&i.model.attributes.options.isMultiFieldItem?this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":r},"FormFieldStates":{"behaviorClass":o}},this.behaviors):this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":s},"FormFieldStates":{"behaviorClass":l}},this.behaviors),n.ItemView.apply(this,arguments),void 0!==this.options.alpacaField&&(this.alpacaField=this.options.alpacaField),this.options.dataId||(this.options.dataId=this.options.id),this.listenTo(this.model,"change",this._render),this.listenTo(this.model,"change",this._raiseValueChanged);var t=this.model.attributes.schema,a=this.model.attributes.options;t?t.readonly?(this.mode="readonly",this.$el.addClass("cs-formfield-readonly")):a.setRequiredFieldsEditable?this.mode="writeonly":this.mode="read":(this.mode=this.options.mode||"read",this.model.set("schema",{"readonly":"readonly"===this.options.mode},{"silent":!0})),this.curVal=this.oldVal=this.model.get("data")},"behaviors":{"DefaultAction":{"behaviorClass":d}},"ui":{"writeArea":".cs-field-write","writeField":".cs-field-write input","writeDateField":".cs-field-write .csui-datefield-input","readArea":".cs-field-read","readField":".cs-field-read button"},"templateHelpers":function(){var e=this.curVal,i=this._getPlaceHolder(),t=(this.options.alpaca&&this.options.alpaca.schema&&this.options.alpaca.schema.tooltip?this.options.alpaca.schema.tooltip:void 0)||e;return{"emptyLabel":"readonly"==this.mode?u.noValueSet:i,"hasData":""!==e&&null!==e,"noValue":"","edit":u.edit,"cancel":u.cancel,"mode":this.mode,"tooltip":t,"titleApplyAll":u.titleApplyAll,"datePickerIcon":u.datePickerIcon}},"className":"cs-formfield","_render":function(){(this.alpacaField&&"create"!==this.alpacaField.options.mode||this.model.get("options")&&"create"!==this.model.get("options").mode)&&!this.silentRender&&(this.render(),this.isValidField=!1),setTimeout(e.bind(function(){var e=i.Event("tab:content:field:changed");this.$el.trigger(e)},this),100)},"setMode":function(e){this.mode=e,this.getStatesBehavior().state=void 0},"getOldValue":function(){return this.oldVal},"isMultiFieldView":function(e){return!e.isTKLField&&!e.isNonTKLField||e.alpacaField.options.isMultiFieldItem&&!!e.alpacaField.parent&&!!e.alpacaField.parent.schema.maxItems&&e.alpacaField.parent.schema.maxItems>1},"isReadyToSave":function(){return!0},"getEditValue":function(){return this.ui.writeField.val()},"getValue":function(){return this.model.get("data")},"normalizeViews":function(e){var i=[];return e.isTKLField||e.isNonTKLField?i.push(e):this.isMultiFieldView(e)?e.children.map(function(e){i.push(e.fieldView)}):i.push(e.children[0].fieldView),i},"getFieldIndex":function(e){if(e.alpacaField.options.isMultiFieldItem&&e.alpacaField.parent.schema.maxItems&&1!==e.alpacaField.parent.schema.maxItems)return e.alpacaField.parent.children.indexOf(e.alpacaField)},"changeChildrenValues":function(i,t,n){var a,s,l=this.options.dataId?this:this.view,r=!1,o=-1!==l.options.dataId.indexOf("x")&&1===l.options.dataId.match(/x/g).length;e.each(i,function(e){if(this.isMultiFieldView(this)){if(a=this.getFieldIndex(this),s=this.normalizeViews(e),o&&parseInt(this.options.dataId.split("_")[2])!==parseInt(s[0].options.dataId.split("_")[2]))return;s[0].alpacaField.options.isMultiFieldItem?(s.forEach(function(e){e.changeChildrenValues(e.children,e,!1),e.valuesPulled=!1}),s[a]&&(e=s[a],r=void 0===n||n,this.changeChildrenValues(e.children,e))):0===a&&(e=s[a],r=!0,this.changeChildrenValues(e.children,e)),r&&(e.valuesPulled=!1,e.setValue(""),e.options.alpaca.schema.enum.length=0,e.trigger("tkl:refresh"))}else{if(s=this.normalizeViews(e),o&&parseInt(this.options.dataId.split("_")[2])!==parseInt(s[0].options.dataId.split("_")[2]))return;var i=this;s.forEach(function(e){r=!0,i.changeChildrenValues(e.children,e),r&&(e.valuesPulled=!1,e.isValidTKLState=!0,e.options.alpacaField.isRequired()?e.isValidTKLState=!1:(e.$el.parents(".binf-form-group.alpaca-field").removeClass("binf-has-error alpaca-invalid"),e.$el.removeClass("cs-formfield-invalid")),e.$el.parents(".binf-form-group.alpaca-field").find(".binf-help-block.alpaca-message.alpaca-message-custom").hide(),e.setValue(""),e.options.alpaca.schema.enum.length=0,e.trigger("tkl:refresh"))})}},t||l)},"setValue":function(e,t,n){var a=!0;if(t&&this.alpacaField){this.oldVal=this.curVal;var s=this.alpacaField.options.validate;if(this.alpacaField.options.inContainer){var l=this.getEditValue();if(null!=l&&l.trim&&l.trim())this.alpacaField.options.validate=!0;else{var r=this.alpacaField.validation;for(var o in r)void 0!==r[o]&&(r[o].status=!0,r[o].message="")}}a=this.alpacaField.setValueAndValidate(e,t),this.alpacaField.options.validate=s}if(a)this.$el.removeClass("cs-formfield-invalid"),e!==this.curVal&&(this.curVal=e),this.model.set("data",e,{"silent":!!n}),this.$el.trigger(i.Event("field:valid"),this);else{this.$el.addClass("cs-formfield-invalid");var d=i.Event("field:invalid");this.$el.trigger(d,this)}return a},"validate":function(e){e()},"allowEditOnClickReadArea":function(){return!0},"allowSaveOnEnter":function(){return!0},"allowEditOnEnter":function(){return!0},"setFocus":function(){this.ui.readField.is(":visible")?this.ui.readField.trigger("focus"):this.ui.writeField.is(":visible")&&this.ui.writeField.trigger("focus")},"setStateWrite":function(e,i){this.childTKLViews.length||this.parentViews.length||this.setValue(this.curVal,e);return!1},"setStateRead":function(e,i){return!1},"getEditableBehavior":function(){return this._behaviors[0]},"getStatesBehavior":function(){return this._behaviors[1]},"_raiseValueChanged":function(){var t=this._getChangeEventValue(),n={"fieldvalue":t,"fieldid":this.options.dataId,"fieldpath":this.options.path,"targetfieldpath":this.options.path,"fieldView":this};this.trigger("field:changed",n),c.trigger(this.options.dataId+"dependentattrchanged",this);var a=i.Event("field:changed");e.extend(a,n),this.$el.trigger(a)},"_getChangeEventValue":function(){return this.getValue()},"onKeyPress":function(e){return!1},"resetOldValueAfterCancel":function(){return!1},"_getPlaceHolder":function(){var e,i=this.model.get("options"),t=this.model.get("schema");if(i&&i.placeholder)e=i.placeholder;else if(t&&t.disabled)e=u.noValueSet;else if(i){switch(i.type){case"number":case"integer":e=u.alpacaPlaceholderNumber;break;case"text":case"textarea":e=u.alpacaPlaceholderText;break;case"time":e=u.alpacaPlaceholderTime;break;case"date":e=u.alpacaPlaceholderDate;break;case"datetime":e=u.alpacaPlaceholderDateTime;break;case"email":e=u.alpacaPlaceholderEmail;break;case"file":e=u.alpacaPlaceholderFile;break;case"password":e=u.alpacaPlaceholderPassword;break;case"phone":e=u.alpacaPlaceholderPhone;break;case"search":e=u.alpacaPlaceholderSearch;break;case"url":e=u.alpacaPlaceholderUrl;break;case"ipv4":e=u.alpacaPlaceholderIPv4;break;case"otcs_user_picker":e=u.alpacaPlaceholderOTUserPicker;break;case"otcs_member_picker":e=u.alpacaPlaceholderOTUserGroupPicker;break;case"otcs_user":e="otcs_user_picker"===this.model.get("schema").type?u.alpacaPlaceholderOTUserPicker:u.alpacaPlaceholderOTUserGroupPicker;break;case"otcs_node_picker":e=u.alpacaPlaceholderOTNodePicker;break;default:e=u.alpacaPlaceholderGeneric}i.placeholder=e}return e}})}),csui.define("csui/controls/form/impl/fields/csformfield.view",["csui/controls/form/fields/base/csformfield.view"],function(e){return e}),csui.define("hbs!csui/controls/form/impl/fields/nodepicker/nodepicker",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"7":function(e,i,t,n){var a;return"data-"+this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'"'},"9":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'"'},"11":function(e,i,t,n){var a;return'\r\n    aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{},"data":n}):a))+'" '},"13":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{},"data":n}):a))+'" '},"15":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{},"data":n}):a))+'"'},"17":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{},"data":n}):a))+'"></div>\r\n      </div>\r\n'},"19":function(e,i,t,n){var a;return'      <div class="icon-container binf-hidden">\r\n        <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{},"data":n}):a))+'" tabindex="0"\r\n             data-cstabindex="0"></div>\r\n      </div>\r\n'},"21":function(e,i,t,n){return" csui-nodepicker-readonly "},"23":function(e,i,t,n){return"disabled"},"25":function(e,i,t,n){var a,s;return'              aria-label="'+this.escapeExpression((s=null!=(s=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"multiFieldLabel","hash":{},"data":n}):s))+" "+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitleShort:a,e))+'"\r\n'},"27":function(e,i,t,n){var a,s;return'              aria-label="'+this.escapeExpression((s=null!=(s=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"idBtnLabel","hash":{},"data":n}):s))+" "+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitleShort:a,e))+'" '},"29":function(e,i,t,n){var a;return'             <span class="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.disabledClass:a,e))+'"\r\n                title="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitle:a,e))+'">'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitleShort:a,e))+"</span>\r\n"},"31":function(e,i,t,n){var a,s;return'             <span class="placeholder" title="'+this.escapeExpression((s=null!=(s=i.noValue||(null!=e?e.noValue:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"noValue","hash":{},"data":n}):s))+'"\r\n                '+(null!=(a=i.unless.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"unless","hash":{},"fn":this.program(32,n,0),"inverse":this.noop,"data":n}))?a:"")+">\r\n             "+(null!=(a=i.unless.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"unless","hash":{},"fn":this.program(34,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n             </span>\r\n"},"32":function(e,i,t,n){return'data-cstabindex="0"'},"34":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{},"data":n}):a))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n  <input type="'+this.escapeExpression((s=null!=(s=i.inputType||(null!=e?e.inputType:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"inputType","hash":{},"data":n}):s))+'" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'"\r\n         '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.attributes:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'\r\n    value="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitleShort:a,e))+'" '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(13,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(15,n,0),"inverse":this.noop,"data":n}))?a:"")+'\r\n    title="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitle:a,e))+'" />\r\n'+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":this.program(17,n,0),"inverse":this.noop,"data":n}))?a:"")+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.applyFlag:a,{"name":"if","hash":{},"fn":this.program(19,n,0),"inverse":this.noop,"data":n}))?a:"")+'  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <a href="javascript:void(0);" tabindex="0" data-cstabindex="0" class="'+(null!=(a=i.if.call(e,null!=e?e.asReadonly:e,{"name":"if","hash":{},"fn":this.program(21,n,0),"inverse":this.noop,"data":n}))?a:"")+'"\r\n              '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.buttonDisabled:a,{"name":"if","hash":{},"fn":this.program(23,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n"+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(25,n,0),"inverse":this.program(27,n,0),"data":n}))?a:"")+">\r\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.anchorTitle:a,{"name":"if","hash":{},"fn":this.program(29,n,0),"inverse":this.program(31,n,0),"data":n}))?a:"")+'      </a>\r\n    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{},"data":n}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'},"useData":!0});return t.registerPartial("csui_controls_form_impl_fields_nodepicker_nodepicker",n),n}),csui.define("css!csui/controls/form/impl/fields/nodepicker/nodepicker",[],function(){}),csui.define("csui/controls/form/fields/nodepickerfield.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/models/node/node.model","csui/models/nodeancestors","csui/controls/form/impl/fields/csformfield.states.behavior","csui/controls/form/impl/fields/csformfield.view","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/node","hbs!csui/controls/form/impl/fields/nodepicker/nodepicker","csui/controls/form/impl/array/csformarrayfield.states.behavior","csui/utils/commands","csui/utils/defaultactionitems","csui/utils/node.links/node.links","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/nodepicker/nodepicker","csui/lib/binf/js/binf"],function(e,i,t,n,a,s,l,r,o,d,c,u,h,p,f,m,g,v){"use strict";var b=e.config();return i.defaults(b,{"maxDesciptLines":5}),d.extend({"constructor":function(e){d.apply(this,arguments),this.behaviors=i.extend({"defaultAction":{"behaviorClass":c}},this.behaviors);var t=this.options.context;this.connector=t.getObject(s);var n=this.model.get("data");this.node=new l(void 0,{"connector":this.connector,"autofetch":!0,"commands":m.getAllCommandSignatures(f)}),this.listenTo(this.node,"sync",this._renderNode).listenTo(this.node,"error",this._renderError),this.ancestors=new r(void 0,{"node":this.node,"autofetch":!0}),this.listenTo(this.ancestors,"sync",this._renderNode).listenTo(this.ancestors,"error",this._renderError),this.options.alpacaField&&this.options.alpacaField.options.mode&&(this.options.alpacaField.options.anchorTitle="",this.options.alpacaField.options.anchorTitleShort=""),n&&this.mapFieldValueToNodeId(n).then(i.bind(function(e){if(e){var i=this.options.context.getModel(u,{"attributes":{"id":e},"temporary":!0});this.node.set(i.attributes)}},this)),this._isReadyToSave=!0,this.editVal=n,this.oldVal=n},"mapFieldValueToNodeId":function(e){return t.Deferred().resolve(e).promise()},"mapNodeIdToFieldValue":function(e){return t.Deferred().resolve(e).promise()},"ui":{"readArea":".cs-field-read","readField":".cs-field-read a","writeArea":".cs-field-write","writeField":".cs-field-write input","searchIcon":".cs-search-icon","button":".cs-field-read a"},"events":{"keydown @ui.writeArea":"onKeyDown","mousedown @ui.writeField":"onClickWriteField","click @ui.searchIcon":"onSearchIconClicked","click @ui.button":"onClickButton"},"className":"cs-formfield cs-nodepicker","template":h,"templateHelpers":function(){var e="";this.options.alpacaField&&this.options.alpacaField.isRequired();return this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(e=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),i.extend(d.prototype.templateHelpers.apply(this),{"asReadonly":"create"===(this.options.formView?this.options.formView.mode:this.mode),"inputType":"text","idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"multiFieldLabel":e})},"onRender":function(){this.ui.writeField.on("change",i.bind(function(){this._isReadyToSave=!0},this)),setTimeout(i.bind(function(){var e=t.Event("tab:content:field:changed");this.$el.trigger(e)},this),100)},"allowEditOnClickReadArea":function(){return!1},"allowEditOnEnter":function(){return!1},"_getNodePicker":function(){var e=t.Deferred(),n=this,a=this.model.get("options")||{},s=this.model.get("schema")||{},l=a.label||s.title,r=this.node.parent&&this.node.parent.attributes||a.type_control&&a.type_control.parameters.parent||this.alpacaField&&this.alpacaField.parent.data[0]||void 0,o=r&&r.id||r;return(!o||o<0)&&(o=this.node.attributes.id),csui.require(["csui/dialogs/node.picker/node.picker"],function(t,s){var r=a.type_control.parameters,d={"connector":n.connector,"dialogTitle":i.str.sformat(v.nodePickerDialogTitle,l),"selectableTypes":r.select_types,"unselectableTypes":r.nonselect_types,"globalSearch":!1!==r.globalSearch,"context":n.options.context,"initialContainer":{"id":o},"initialSelection":[n.node],"unselectableNodes":[n.node],"resolveShortcuts":!0,"resultOriginalNode":!0};r.startLocation&&(d.startLocation=r.startLocation),r.startLocations&&(d.startLocations=r.startLocations);var c=new t(d);e.resolve(c)},function(i){e.reject(i)}),e.promise()},"_showNodePicker":function(){this._isReadyToSave&&(this._isReadyToSave=!1,this._getNodePicker().then(i.bind(function(e){e.show().done(i.bind(function(e){var t=e.nodes[0],n=t.get("id");this.mapNodeIdToFieldValue(n).then(i.bind(function(e){this.getStatesBehavior().isWriteOnly()||this.getStatesBehavior().isStateWrite()?this.editVal=e:this.getStatesBehavior().setStateRead(!1,!0),this.setValue(e,!0),this.node.set(t.attributes),this.options.context.getModel(u,{"attributes":{"id":n},"temporary":!0}).set(t.attributes)},this))},this)).fail(i.bind(function(){},this)).always(i.bind(function(){this.ui.writeField.trigger("focus"),this._isReadyToSave=!0},this))},this)))},"getEditValue":function(){return this.editVal},"getOldValue":function(){return this.oldVal},"isReadyToSave":function(){return this._isReadyToSave},"onKeyDown":function(e){40===e.keyCode&&this._showNodePicker()},"onClickWriteField":function(e){this._showNodePicker()},"onClickButton":function(e){e.preventDefault(),"create"!==(this.options.formView?this.options.formView.mode:this.mode)&&this.node.get("id")&&this.triggerMethod("execute:defaultAction",this.node)},"setStateWrite":function(e,i){return this.getStatesBehavior().isWriteOnly()||this.getStatesBehavior().isStateWrite()?(this.ui.readArea.addClass("binf-hidden"),this.ui.writeArea.removeClass("binf-hidden"),this.ui.writeField.trigger("focus")):this._showNodePicker(),!0},"_prepareFieldText":function(){var e,i=this.ancestors.pluck("name");if(this.$el.width()>0&&i.length>0){var t=this._getLocationElement(),n=this._getElementHeightWithXLines(t,b.maxDesciptLines);e=this._truncateAncestorsToFit(i,t,n).join(" > ")}else e=i.join(" > ");return e},"_getLocationElement":function(){var e=this.$el,i=e.find("> .cs-field-read .btn-container span");return i=i.length>0?i:e.find("> .cs-field-read .btn-container a")},"_getElementHeightWithXLines":function(e,i){var t=e.css("line-height");return parseInt(t)*i},"_truncateAncestorsToFit":function(e,i,t){var n,a,s=this._removeAncestorsToFit(e,i,t);if(n=this._checkAncestorsFit(s,i,t),!0==(s.length>1&&"..."===s[1])&&!0===n.underflow){var l=e.length-s.length+1,r=e[l];1===l?(s[1]=r,a=1):(s.splice(2,0,r),a=2),s=this._truncateNameToFit(s,i,t,a)}return n=this._checkAncestorsFit(s,i,t),!0===n.overflow&&(a=0,s=this._truncateNameToFit(s,i,t,a)),n=this._checkAncestorsFit(s,i,t),!0===n.overflow&&(a=s.length-1,s=this._truncateNameToFit(s,i,t,a)),s},"_removeAncestorsToFit":function(e,i,t){var n,a,s=[].concat(e),l=2;for(a=!1,n=this._checkAncestorsFit(s,i,t);!0===n.overflow&&s.length>l;)!1===a?(s.splice(1,1,"..."),a=!0,l=3):s.splice(2,1),n=this._checkAncestorsFit(s,i,t);return s},"_truncateNameToFit":function(e,i,t,n){var a,s=[].concat(e),l=s[n];for(a=this._checkAncestorsFit(s,i,t);!0===a.overflow&&l.length>1;)l=l.substr(0,l.length-1),s[n]=l+"...",a=this._checkAncestorsFit(s,i,t);return s},"_checkAncestorsFit":function(e,i,t){i.text(e.join(" > "));var n=i.height();return{"overflow":n>t,"underflow":n<t}},"_renderNode":function(){var e=g.getUrl(this.node),i=this.defaultActionController.hasAction(this.node),t=this.ancestors.pluck("name").join(" > "),n=this._prepareFieldText();this._renderField(e,i,t,n)},"_renderError":function(){this._renderField("#",!1,v.originalNodeUnavailableTooltip,v.originalNodeUnavailable)},"_renderField":function(e,t,n,a){var s,l;window.csui&&window.csui.mobile?(s=this.model.attributes.options.buttonDisabled,l=this.model.attributes.options.disabledClass):(s=!t,l=t?"":"binf-disabled"),i.extend(this.model.attributes.options,{"url":e,"buttonDisabled":s,"disabledClass":l,"anchorTitle":n,"anchorTitleShort":a}),this.render()},"onKeyPress":function(e){13===e.keyCode&&this._showNodePicker(),9!==e.keyCode&&(e.preventDefault(),e.stopPropagation())},"resetOldValueAfterCancel":function(){return!0},"isFocusedOut":function(e){return t(".target-browse").length>0}})}),csui.define("csui/controls/form/fields/alpaca/alpnodepickerfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/alpaca/js/alpaca","csui/utils/namedsessionstorage","csui/controls/form/fields/alpaca/alpcsuipickerfield.mixin","csui/controls/form/fields/nodepickerfield.view"],function(e,i,t,n,a,s,l){var r=(new a(e.id),s.mixin({"constructor":function(e,t,n,a,s,r,o){n=i.extend(n||{},{"alpacaFieldType":"otcs_node_picker","PickerFieldView":l}),this.base(e,t,n,a,s,r,o),this.makeAlpCsuiPickerField()}}));return n.Fields.CsuiNodePickerField=n.Fields.IntegerField.extend(r),n.registerFieldClass("otcs_node_picker",n.Fields.CsuiNodePickerField,"bootstrap-csui"),n.registerFieldClass("otcs_node_picker",n.Fields.CsuiNodePickerField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiNodePickerField}),csui.define("hbs!csui/controls/form/impl/fields/datefield/datefield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return' step="'+this.escapeExpression((a=null!=(a=i.inputStep||(null!=e?e.inputStep:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"inputStep","hash":{},"data":n}):a))+'"'},"3":function(e,i,t,n){var a;return' size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){var a;return' name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"7":function(e,i,t,n){var a;return' aria-required="'+this.escapeExpression((a=null!=(a=i.ariaRequired||(null!=e?e.ariaRequired:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"ariaRequired","hash":{},"data":n}):a))+'" '},"9":function(e,i,t,n){var a;return" data-"+this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'" '},"11":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'" '},"13":function(e,i,t,n){var a;return'aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{},"data":n}):a))+'" '},"15":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{},"data":n}):a))+'" '},"17":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{},"data":n}):a))+'" '},"19":function(e,i,t,n){return"cs-icon-disabled\r\n      "},"21":function(e,i,t,n){var a;return'" tabindex="0" aria-label="'+this.escapeExpression((a=null!=(a=i.datePickerIconAria||(null!=e?e.datePickerIconAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"datePickerIconAria","hash":{},"data":n}):a))},"23":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{},"data":n}):a))+'"></div>\r\n      </div>\r\n'},"25":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.applyFlag:a,{"name":"if","hash":{},"fn":this.program(26,n,0),"inverse":this.noop,"data":n}))?a:""},"26":function(e,i,t,n){var a;return'        <div class="icon-container binf-hidden">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{},"data":n}):a))+'" tabindex="0"\r\n               data-cstabindex="0"></div>\r\n        </div>\r\n'},"28":function(e,i,t,n){return' aria-disabled="true" '},"30":function(e,i,t,n){var a;return'            aria-label="'+this.escapeExpression((a=null!=(a=i.readModeMultiFieldAria||(null!=e?e.readModeMultiFieldAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeMultiFieldAria","hash":{},"data":n}):a))+'" data-multi="true"\r\n'},"32":function(e,i,t,n){var a;return'            aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{},"data":n}):a))+'"\r\n'},"34":function(e,i,t,n){var a;return'          <span title="'+this.escapeExpression((a=null!=(a=i.readData||(null!=e?e.readData:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readData","hash":{},"data":n}):a))+'">'+this.escapeExpression((a=null!=(a=i.readData||(null!=e?e.readData:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readData","hash":{},"data":n}):a))+"</span>\r\n"},
"36":function(e,i,t,n){var a;return'          <span class="placeholder" title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{},"data":n}):a))+'">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{},"data":n}):a))+"</span>\r\n"},"38":function(e,i,t,n){return""},"40":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon icon-date_picker1 icon-edit" title="'+this.escapeExpression((a=null!=(a=i.edit||(null!=e?e.edit:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"edit","hash":{},"data":n}):a))+'"></div>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <div class="binf-input-group csui-datefield-input">\r\n    <input type="'+this.escapeExpression((s=null!=(s=i.inputType||(null!=e?e.inputType:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"inputType","hash":{},"data":n}):s))+'" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" placeholder="'+this.escapeExpression((s=null!=(s=i.placeholder||(null!=e?e.placeholder:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"placeholder","hash":{},"data":n}):s))+'"\r\n      '+(null!=(a=i.if.call(e,null!=e?e.inputStep:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.ariaRequired:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.attributes:a,{"name":"each","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n}))?a:"")+'\r\n      value="'+this.escapeExpression((s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"data","hash":{},"data":n}):s))+'"\r\n      '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(13,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(15,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(17,n,0),"inverse":this.noop,"data":n}))?a:"")+'/>\r\n      <span class="input-group-">\r\n          <span tabindex="0" title="'+this.escapeExpression((s=null!=(s=i.datePickerIcon||(null!=e?e.datePickerIcon:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"datePickerIcon","hash":{},"data":n}):s))+'" aria-label="'+this.escapeExpression((s=null!=(s=i.datePickerIcon||(null!=e?e.datePickerIcon:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"datePickerIcon","hash":{},"data":n}):s))+'"\r\n                role="button" class="icon-date_picker '+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(19,n,0),"inverse":this.program(21,n,0),"data":n}))?a:"")+'"></span>\r\n      </span>\r\n    </div>\r\n\r\n'+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":this.program(23,n,0),"inverse":this.program(25,n,0),"data":n}))?a:"")+'  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <button\r\n          '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(28,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n"+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(30,n,0),"inverse":this.program(32,n,0),"data":n}))?a:"")+"      >\r\n"+(null!=(a=i.if.call(e,null!=e?e.readData:e,{"name":"if","hash":{},"fn":this.program(34,n,0),"inverse":this.program(36,n,0),"data":n}))?a:"")+"      </button>\r\n    </div>\r\n"+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(38,n,0),"inverse":this.program(40,n,0),"data":n}))?a:"")+"  </div>\r\n</div>\r\n"},"useData":!0});return t.registerPartial("csui_controls_form_impl_fields_datefield_datefield",n),n}),csui.define("css!csui/controls/form/impl/fields/datefield/datefield",[],function(){}),csui.define("csui/lib/binf/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/lib/binf/nls/root/lang",{"previousDecade":"Previous Decade","selectDecade":"Select Decade","nextDecade":"Next Decade","previousCentury":"Previous Century","nextCentury":"Next Century","previousMonth":"Previous Month","selectMonth":"Select Month","nextMonth":"Next Month","incrementHour":"Increment Hour","pickHour":"Pick Hour","decrementHour":"Decrement Hour","incrementMinute":"Increment Minute","pickMinute":"Pick Minute","decrementMinute":"Decrement Minute","incrementSecond":"Increment Second","pickSecond":"Pick Second","decrementSecond":"Decrement Second","togglePeriod":"Toggle Period","goToToday":"Go to today","selectTime":"Select Time","selectDate":"Select Date","clearSelection":"Clear selection","closeThePicker":"Close the picker","previousYear":"Previous Year","selectYear":"Select Year","nextYear":"Next Year"}),csui.define("css!csui/lib/binf/css/binf-datetimepicker",[],function(){}),function(e){"use strict";if("function"==typeof csui.define&&csui.define.amd)csui.define("csui/lib/binf/js/binf-datetimepicker",["csui/lib/jquery","csui/lib/moment","i18n!csui/lib/binf/nls/lang","css!csui/lib/binf/css/binf-datetimepicker","csui/lib/binf/js/binf"],e);else if("object"==typeof exports)e(require("jquery"),require("moment"));else{if("undefined"==typeof jQuery)throw"binf-datetimepicker requires jQuery to be loaded first";if("undefined"==typeof moment)throw"binf-datetimepicker requires Moment.js to be loaded first";e(jQuery,moment)}}(function(e,i,t){"use strict";if(!i)throw new Error("binf-datetimepicker requires Moment.js to be loaded first");var n=function(n,a){var s,l,r,o,d,c={},u=i().startOf("d"),h=u.clone(),p=!0,f=!1,m=!1,g=0,v=[{"clsName":"days","navFnc":"M","navStep":1},{"clsName":"months","navFnc":"y","navStep":1},{"clsName":"years","navFnc":"y","navStep":10},{"clsName":"decades","navFnc":"y","navStep":100}],b=["days","months","years","decades"],y=["top","bottom","auto"],w=["left","right","auto"],F=["default","top","bottom"],C={"up":38,"38":"up","down":40,"40":"down","left":37,"37":"left","right":39,"39":"right","tab":9,"9":"tab","escape":27,"27":"escape","enter":13,"13":"enter","pageUp":33,"33":"pageUp","pageDown":34,"34":"pageDown","shift":16,"16":"shift","control":17,"17":"control","space":32,"32":"space","t":84,"84":"t","delete":46,"46":"delete"},k={},x=!1,E=function(e){if("string"!=typeof e||e.length>1)throw new TypeError("isEnabled expects a single character string parameter");switch(e){case"y":return-1!==r.indexOf("Y");case"M":return-1!==r.indexOf("M");case"d":return-1!==r.toLowerCase().indexOf("d");case"h":case"H":return-1!==r.toLowerCase().indexOf("h");case"m":return-1!==r.indexOf("m");case"s":return-1!==r.indexOf("s");default:return!1}},I=function(){return E("h")||E("m")||E("s")},V=function(){return E("y")||E("M")||E("d")},M=function(){var i=e("<thead>").append(e("<tr>").append(e("<th>").addClass("binf-prev").attr("data-action","previous").append(e("<span>").addClass(a.icons.previous))).append(e("<th>").addClass("picker-switch").attr("data-action","pickerSwitch").attr("colspan",a.calendarWeeks?"6":"5")).append(e("<th>").addClass("binf-next").attr("data-action","next").append(e("<span>").addClass(a.icons.next)))),t=e("<tbody>").append(e("<tr>").append(e("<td>").attr("colspan",a.calendarWeeks?"8":"7")));return[e("<div>").addClass("datepicker-days").append(e("<table>").addClass("binf-table-condensed").append(i).append(e("<tbody>"))),e("<div>").addClass("datepicker-months").append(e("<table>").addClass("binf-table-condensed").append(i.clone()).append(t.clone())),e("<div>").addClass("datepicker-years").append(e("<table>").addClass("binf-table-condensed").append(i.clone()).append(t.clone())),e("<div>").addClass("datepicker-decades").append(e("<table>").addClass("binf-table-condensed").append(i.clone()).append(t.clone()))]},S=function(){var i=e("<tr>"),n=e("<tr>"),s=e("<tr>");return E("h")&&(i.append(e("<td>").append(e("<a>").attr({"href":"#","tabindex":"-1","title":t.incrementHour}).addClass("binf-btn").attr("data-action","incrementHours").append(e("<span>").addClass(a.icons.up)))),n.append(e("<td>").append(e("<span>").addClass("timepicker-hour").attr({"data-time-component":"hours","title":t.pickHour}).attr("data-action","showHours"))),s.append(e("<td>").append(e("<a>").attr({"href":"#","tabindex":"-1","title":t.decrementHour}).addClass("binf-btn").attr("data-action","decrementHours").append(e("<span>").addClass(a.icons.down))))),E("m")&&(E("h")&&(i.append(e("<td>").addClass("separator")),n.append(e("<td>").addClass("separator").html(":")),s.append(e("<td>").addClass("separator"))),i.append(e("<td>").append(e("<a>").attr({"href":"#","tabindex":"-1","title":t.incrementMinute}).addClass("binf-btn").attr("data-action","incrementMinutes").append(e("<span>").addClass(a.icons.up)))),n.append(e("<td>").append(e("<span>").addClass("timepicker-minute").attr({"data-time-component":"minutes","title":t.pickMinute}).attr("data-action","showMinutes"))),s.append(e("<td>").append(e("<a>").attr({"href":"#","tabindex":"-1","title":t.decrementMinute}).addClass("binf-btn").attr("data-action","decrementMinutes").append(e("<span>").addClass(a.icons.down))))),E("s")&&(E("m")&&(i.append(e("<td>").addClass("separator")),n.append(e("<td>").addClass("separator").html(":")),s.append(e("<td>").addClass("separator"))),i.append(e("<td>").append(e("<a>").attr({"href":"#","tabindex":"-1","title":t.incrementSecond}).addClass("binf-btn").attr("data-action","incrementSeconds").append(e("<span>").addClass(a.icons.up)))),n.append(e("<td>").append(e("<span>").addClass("timepicker-second").attr({"data-time-component":"seconds","title":t.pickSecond}).attr("data-action","showSeconds"))),s.append(e("<td>").append(e("<a>").attr({"href":"#","tabindex":"-1","title":t.decrementSecond}).addClass("binf-btn").attr("data-action","decrementSeconds").append(e("<span>").addClass(a.icons.down))))),l||(i.append(e("<td>").addClass("separator")),n.append(e("<td>").append(e("<button>").addClass("binf-btn binf-btn-primary").attr({"data-action":"togglePeriod","tabindex":"-1","title":t.togglePeriod}))),s.append(e("<td>").addClass("separator"))),e("<div>").addClass("timepicker-picker").append(e("<table>").addClass("binf-table-condensed").append([i,n,s]))},A=function(){var i=e("<div>").addClass("timepicker-hours").append(e("<table>").addClass("binf-table-condensed")),t=e("<div>").addClass("timepicker-minutes").append(e("<table>").addClass("binf-table-condensed")),n=e("<div>").addClass("timepicker-seconds").append(e("<table>").addClass("binf-table-condensed")),a=[S()];return E("h")&&a.push(i),E("m")&&a.push(t),E("s")&&a.push(n),a},T=function(){var i=[];return a.showTodayButton&&i.push(e("<td>").append(e("<a>").attr({"data-action":"today","title":t.goToToday}).append(e("<span>").addClass(a.icons.today)))),!a.sideBySide&&V()&&I()&&i.push(e("<td>").append(e("<a>").attr({"data-action":"togglePicker","title":t.selectTime}).append(e("<span>").addClass(a.icons.time)))),a.showClear&&i.push(e("<td>").append(e("<a>").attr({"data-action":"clear","title":t.clearSelection}).append(e("<span>").addClass(a.icons.clear)))),a.showClose&&i.push(e("<td>").append(e("<a>").attr({"data-action":"close","title":t.closeThePicker}).append(e("<span>").addClass(a.icons.close)))),e("<table>").addClass("binf-table-condensed").append(e("<tbody>").append(e("<tr>").append(i)))},_=function(){var i=e("<div>").addClass("binf-datetimepicker-widget binf-dropdown-menu"),t=e("<div>").addClass("datepicker").append(M()),n=e("<div>").addClass("timepicker").append(A()),s=e("<ul>").addClass("binf-list-unstyled"),r=e("<li>").addClass("picker-switch"+(a.collapse?" accordion-toggle":"")).append(T());return a.inline&&i.removeClass("binf-dropdown-menu"),l&&i.addClass("usetwentyfour"),E("s")&&!l&&i.addClass("wider"),a.sideBySide&&V()&&I()?(i.addClass("timepicker-sbs"),i.append(e("<div>").addClass("binf-row").append(t.addClass("binf-col-sm-6")).append(n.addClass("binf-col-sm-6"))),i.append(r),i):("top"===a.toolbarPlacement&&s.append(r),V()&&s.append(e("<li>").addClass(a.collapse&&I()?"binf-collapse binf-in":"").append(t)),"default"===a.toolbarPlacement&&s.append(r),I()&&s.append(e("<li>").addClass(a.collapse&&V()?"binf-collapse":"").append(n)),"bottom"===a.toolbarPlacement&&s.append(r),i.append(s))},O=function(){var i,t,s,l=(f||n).position(),r=(f||n).offset(),o=a.widgetPositioning.vertical,d=a.widgetPositioning.horizontal;if(a.widgetParent)i=a.widgetParent.append(m);else if(n.is("input"))i=n.after(m).parent();else{if(a.inline)return void(i=n.append(m));i=n,n.children().first().after(m)}if(t=i.closest(".cs-form").length?i.closest(".cs-form").offset().top:i.offset().top,s=i.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",i.closest(s)&&i.closest(s).offset()&&(t=i.closest(s).offset().top),"auto"===o&&(o=r.top-t>250?"top":"bottom"),"auto"===d&&(d=i.width()<r.left+m.outerWidth()/2&&r.left+m.outerWidth()>e(window).width()?"right":"left"),"top"===o?m.addClass("binf-top").removeClass("binf-bottom"):m.addClass("binf-bottom").removeClass("binf-top"),"right"===d?m.addClass("binf-pull-right"):m.removeClass("binf-pull-right"),"relative"!==i.css("position")&&(i=i.parents().filter(function(){return"relative"===e(this).css("position")}).first()),0===i.length)throw new Error("datetimepicker component should be placed within a relative positioned container");m.css({"top":"top"===o?l.top+i.scrollTop()-m.height()-n.outerHeight():l.top+n.outerHeight()+i.scrollTop(),"bottom":"auto","left":"left"===d?0:"auto","right":"left"===d?"auto":i.outerWidth()-n.outerWidth()-(i===n?0:l.left)}),D({"type":"dp.place"})},D=function(e){"dp.change"===e.type&&(e.date&&e.date.isSame(e.oldDate)||!e.date&&!e.oldDate)||n.trigger(e)},R=function(e){"y"===e&&(e="YYYY"),D({"type":"dp.update","change":e,"viewDate":h.clone()})},P=function(e){m&&(e&&(d=Math.max(g,Math.min(3,d+e))),m.find(".datepicker > div").hide().filter(".datepicker-"+v[d].clsName).show())},L=function(){var i=e("<tr>"),t=h.clone().startOf("w").startOf("d");for(!0===a.calendarWeeks&&i.append(e("<th>").addClass("cw").text("#"));t.isBefore(h.clone().endOf("w"));)i.append(e("<th>").addClass("dow").text(t.format("dd"))),t.add(1,"d");m.find(".datepicker-days thead").append(i)},B=function(e){return!0===a.disabledDates[e.format("YYYY-MM-DD")]},N=function(e){return!0===a.enabledDates[e.format("YYYY-MM-DD")]},H=function(e){return!0===a.disabledHours[e.format("H")]},j=function(e){return!0===a.enabledHours[e.format("H")]},W=function(i,t){if(!i.isValid())return!1;if(a.disabledDates&&"d"===t&&B(i))return!1;if(a.enabledDates&&"d"===t&&!N(i))return!1;if(a.minDate&&i.isBefore(a.minDate,t))return!1;if(a.maxDate&&i.isAfter(a.maxDate,t))return!1;if(a.daysOfWeekDisabled&&"d"===t&&-1!==a.daysOfWeekDisabled.indexOf(i.day()))return!1;if(a.disabledHours&&("h"===t||"m"===t||"s"===t)&&H(i))return!1;if(a.enabledHours&&("h"===t||"m"===t||"s"===t)&&!j(i))return!1;if(a.disabledTimeIntervals&&("h"===t||"m"===t||"s"===t)){var n=!1;if(e.each(a.disabledTimeIntervals,function(){if(i.isBetween(this[0],this[1]))return n=!0,!1}),n)return!1}return!0},z=function(){for(var i=[],t=h.clone().startOf("y").startOf("d");t.isSame(h,"y");)i.push(e("<span>").attr("data-action","selectMonth").addClass("month").text(t.format("MMM"))),t.add(1,"M");m.find(".datepicker-months td").empty().append(i)},q=function(){var i=m.find(".datepicker-months"),n=i.find("th"),a=i.find("tbody").find("span");n.eq(0).find("span").attr("title",t.previousYear),n.eq(1).attr("title",t.selectYear),n.eq(2).find("span").attr("title",t.nextYear),i.find("binf-disabled").removeClass("binf-disabled"),W(h.clone().subtract(1,"y"),"y")||n.eq(0).addClass("binf-disabled"),n.eq(1).text(h.year()),W(h.clone().add(1,"y"),"y")||n.eq(2).addClass("binf-disabled"),a.removeClass("binf-active"),u.isSame(h,"y")&&!p&&a.eq(u.month()).addClass("binf-active"),a.each(function(i){W(h.clone().month(i),"M")||e(this).addClass("binf-disabled")})},U=function(){var e=m.find(".datepicker-years"),i=e.find("th"),n=h.clone().subtract(5,"y"),s=h.clone().add(6,"y"),l="";for(i.eq(0).find("span").attr("title",t.previousDecade),i.eq(1).attr("title",t.selectDecade),i.eq(2).find("span").attr("title",t.nextDecade),e.find(".binf-disabled").removeClass("binf-disabled"),a.minDate&&a.minDate.isAfter(n,"y")&&i.eq(0).addClass("binf-disabled"),i.eq(1).text(n.year()+"-"+s.year()),a.maxDate&&a.maxDate.isBefore(s,"y")&&i.eq(2).addClass("binf-disabled");!n.isAfter(s,"y");)l+='<span data-action="selectYear" class="year'+(n.isSame(u,"y")&&!p?" binf-active":"")+(W(n,"y")?"":" binf-disabled")+'">'+n.year()+"</span>",n.add(1,"y");e.find("td").html(l)},$=function(){var e=m.find(".datepicker-decades"),n=e.find("th"),s=i(h.isBefore(i({"y":1999}))?{"y":1899}:{"y":1999}),l=s.clone().add(100,"y"),r="";for(n.eq(0).find("span").attr("title",t.previousCentury),n.eq(2).find("span").attr("title",t.nextCentury),e.find(".binf-disabled").removeClass("binf-disabled"),(s.isSame(i({"y":1900}))||a.minDate&&a.minDate.isAfter(s,"y"))&&n.eq(0).addClass("binf-disabled"),n.eq(1).text(s.year()+"-"+l.year()),(s.isSame(i({"y":2e3}))||a.maxDate&&a.maxDate.isBefore(l,"y"))&&n.eq(2).addClass("binf-disabled");!s.isAfter(l,"y");)r+='<span data-action="selectDecade" class="decade'+(s.isSame(u,"y")?" binf-active":"")+(W(s,"y")?"":" binf-disabled")+'" data-selection="'+(s.year()+6)+'">'+(s.year()+1)+" - "+(s.year()+12)+"</span>",s.add(12,"y");r+="<span></span><span></span><span></span>",e.find("td").html(r)},K=function(){var n,s,l,r,o=m.find(".datepicker-days"),d=o.find("th"),c=[];if(V()){for(d.eq(0).find("span").attr("title",t.previousMonth),d.eq(1).attr("title",t.selectMonth),d.eq(2).find("span").attr("title",t.nextMonth),o.find(".binf-disabled").removeClass("binf-disabled"),d.eq(1).text(h.format(a.dayViewHeaderFormat)),W(h.clone().subtract(1,"M"),"M")||d.eq(0).addClass("binf-disabled"),W(h.clone().add(1,"M"),"M")||d.eq(2).addClass("binf-disabled"),n=h.clone().startOf("M").startOf("w").startOf("d"),r=0;r<42;r++)0===n.weekday()&&(s=e("<tr>"),a.calendarWeeks&&s.append('<td class="cw">'+n.week()+"</td>"),c.push(s)),l="",n.isBefore(h,"M")&&(l+=" old"),n.isAfter(h,"M")&&(l+=" new"),n.isSame(u,"d")&&!p&&(l+=" binf-active"),W(n,"d")||(l+=" binf-disabled"),n.isSame(i(),"d")&&(l+=" today"),0!==n.day()&&6!==n.day()||(l+=" weekend"),s.append('<td data-action="selectDay" data-day="'+n.format("L")+'" class="day'+l+'">'+n.date()+"</td>"),n.add(1,"d");o.find("tbody").empty().append(c),q(),U(),$()}},Q=function(){var i=m.find(".timepicker-hours table"),t=h.clone().startOf("d"),n=[],a=e("<tr>");for(h.hour()>11&&!l&&t.hour(12);t.isSame(h,"d")&&(l||h.hour()<12&&t.hour()<12||h.hour()>11);)t.hour()%4==0&&(a=e("<tr>"),n.push(a)),a.append('<td data-action="selectHour" class="hour'+(W(t,"h")?"":" binf-disabled")+'">'+t.format(l?"HH":"hh")+"</td>"),t.add(1,"h");i.empty().append(n)},Y=function(){for(var i=m.find(".timepicker-minutes table"),t=h.clone().startOf("h"),n=[],s=e("<tr>"),l=1===a.stepping?5:a.stepping;h.isSame(t,"h");)t.minute()%(4*l)==0&&(s=e("<tr>"),n.push(s)),s.append('<td data-action="selectMinute" class="minute'+(W(t,"m")?"":" binf-disabled")+'">'+t.format("mm")+"</td>"),t.add(l,"m");i.empty().append(n)},J=function(){for(var i=m.find(".timepicker-seconds table"),t=h.clone().startOf("m"),n=[],a=e("<tr>");h.isSame(t,"m");)t.second()%20==0&&(a=e("<tr>"),n.push(a)),a.append('<td data-action="selectSecond" class="second'+(W(t,"s")?"":" binf-disabled")+'">'+t.format("ss")+"</td>"),t.add(5,"s");i.empty().append(n)},G=function(){var e,i,t=m.find(".timepicker span[data-time-component]");l||(e=m.find(".timepicker [data-action=togglePeriod]"),i=u.clone().add(u.hours()>=12?-12:12,"h"),e.text(u.format("A")),W(i,"h")?e.removeClass("binf-disabled"):e.addClass("binf-disabled")),t.filter("[data-time-component=hours]").text(u.format(l?"HH":"hh")),t.filter("[data-time-component=minutes]").text(u.format("mm")),t.filter("[data-time-component=seconds]").text(u.format("ss")),Q(),Y(),J()},Z=function(){m&&(K(),G())},X=function(e){var i=p?null:u;if(!e)return p=!0,s.val(""),n.data("date",""),D({"type":"dp.change","date":!1,"oldDate":i}),void Z();e=e.clone().locale(a.locale),1!==a.stepping&&e.minutes(Math.round(e.minutes()/a.stepping)*a.stepping%60).seconds(0),W(e)?(u=e,h=u.clone(),s.val(u.format(a.format)),n.data("date",u.format(a.format)),p=!1,Z(),D({"type":"dp.change","date":u.clone(),"oldDate":i})):(a.keepInvalid||s.val(p?"":u.format(r)),D({"type":"dp.error","date":e}))},ee=function(){var i=!1;return m?(m.find(".binf-collapse").each(function(){var t=e(this).data("collapse");return!t||!t.transitioning||(i=!0,!1)}),i?c:(f&&f.hasClass("binf-btn")&&f.toggleClass("binf-active"),m.hide(),e(window).off("resize",ee),m.off("click touchend","[data-action]"),m.off("mousedown touchstart",!1),m.remove(),m=!1,D({"type":"dp.hide","date":u.clone()}),c)):c},ie=function(){X(null)},te={"next":function(){var e=v[d].navFnc;h.add(v[d].navStep,e),K(),R(e)},"previous":function(){var e=v[d].navFnc;h.subtract(v[d].navStep,e),K(),R(e)},"pickerSwitch":function(){P(1)},"selectMonth":function(i){var t=e(i.target).closest("tbody").find("span").index(e(i.target));h.month(t),d===g?(X(u.clone().year(h.year()).month(h.month())),a.inline||ee()):(P(-1),K()),R("M")},"selectYear":function(i){var t=parseInt(e(i.target).text(),10)||0;h.year(t),d===g?(X(u.clone().year(h.year())),a.inline||ee()):(P(-1),K()),R("YYYY")},"selectDecade":function(i){var t=parseInt(e(i.target).data("selection"),10)||0;h.year(t),d===g?(X(u.clone().year(h.year())),a.inline||ee()):(P(-1),K()),R("YYYY")},"selectDay":function(i){var t=h.clone();e(i.target).is(".old")&&t.subtract(1,"M"),e(i.target).is(".new")&&t.add(1,"M"),X(t.date(parseInt(e(i.target).text(),10))),I()||a.keepOpen||a.inline||ee(),e(window).off("resize",ee)},"incrementHours":function(){var e=u.clone().add(1,"h");W(e,"h")&&X(e)},"incrementMinutes":function(){var e=u.clone().add(a.stepping,"m");W(e,"m")&&X(e)},"incrementSeconds":function(){var e=u.clone().add(1,"s");W(e,"s")&&X(e)},"decrementHours":function(){var e=u.clone().subtract(1,"h");W(e,"h")&&X(e)},"decrementMinutes":function(){var e=u.clone().subtract(a.stepping,"m");W(e,"m")&&X(e)},"decrementSeconds":function(){var e=u.clone().subtract(1,"s");W(e,"s")&&X(e)},"togglePeriod":function(){X(u.clone().add(u.hours()>=12?-12:12,"h"))},"togglePicker":function(i){var n,s=e(i.target),l=s.closest("ul"),r=l.find(".binf-in"),o=l.find(".binf-collapse:not(.binf-in)");if(r&&r.length){if((n=r.data("collapse"))&&n.transitioning)return;r.binf_collapse?(r.binf_collapse("hide"),o.binf_collapse("show")):(r.removeClass("binf-in"),o.addClass("binf-in")),s.hasClass("binf-glyphicon binf-glyphicon-calendar")?r.siblings().find("a:not(.binf-btn)").attr("title",t.selectTime):r.siblings().find("a:not(.binf-btn)").attr("title",t.selectDate),s.is("span")?s.toggleClass(a.icons.time+" "+a.icons.date):s.find("span").toggleClass(a.icons.time+" "+a.icons.date)}},"showPicker":function(){m.find(".timepicker > div:not(.timepicker-picker)").hide(),m.find(".timepicker .timepicker-picker").show()},"showHours":function(){m.find(".timepicker .timepicker-picker").hide(),m.find(".timepicker .timepicker-hours").show()},"showMinutes":function(){m.find(".timepicker .timepicker-picker").hide(),m.find(".timepicker .timepicker-minutes").show()},"showSeconds":function(){m.find(".timepicker .timepicker-picker").hide(),m.find(".timepicker .timepicker-seconds").show()},"selectHour":function(i){var t=parseInt(e(i.target).text(),10);l||(u.hours()>=12?12!==t&&(t+=12):12===t&&(t=0)),X(u.clone().hours(t)),te.showPicker.call(c)},"selectMinute":function(i){X(u.clone().minutes(parseInt(e(i.target).text(),10))),te.showPicker.call(c)},"selectSecond":function(i){X(u.clone().seconds(parseInt(e(i.target).text(),10))),te.showPicker.call(c)},"clear":ie,"today":function(){W(i(),"d")&&X(i())},"close":ee},ne=function(i){return!e(i.currentTarget).is(".binf-disabled")&&(te[e(i.currentTarget).data("action")].apply(c,arguments),!1)},ae=function(){var t,n={"year":function(e){return e.month(0).date(1).hours(0).seconds(0).minutes(0)},"month":function(e){return e.date(1).hours(0).seconds(0).minutes(0)},"day":function(e){return e.hours(0).seconds(0).minutes(0)},"hour":function(e){return e.seconds(0).minutes(0)},"minute":function(e){return e.seconds(0)}};if(""!==s.val()||p||(p=!0),s.prop("disabled")||!a.ignoreReadonly&&s.prop("readonly")||m)return c;void 0!==s.val()&&0!==s.val().trim().length?X(oe(s.val().trim())):a.useCurrent&&p&&(s.is("input")&&0===s.val().trim().length||a.inline)&&(t=i(),"string"==typeof a.useCurrent&&(t=n[a.useCurrent](t)),X(t)),m=_(),L(),z(),m.find(".timepicker-hours").hide(),m.find(".timepicker-minutes").hide(),m.find(".timepicker-seconds").hide(),Z(),P(),e(window).on("resize",ee),m.on("click touchend","[data-action]",ne),m.on("mousedown touchstart",!1),f&&f.hasClass("binf-btn")&&f.toggleClass("binf-active");var l=e("body").find(".binf-datetimepicker-widget");return se()&&l.length>0&&l.hide(),m.show(),""===m.css("display")&&m.css("display","block"),O(),!a.focusOnShow||s.is(":focus")||se()?se()&&(e(s.context).find(".icon-date_picker").trigger("focus"),ae()):s.trigger("focus"),D({"type":"dp.show"}),c},se=function(){return le()&&window.matchMedia("(orientation: landscape)").matches},le=function(){if(navigator&&null!=navigator.userAgent){return null!=navigator.userAgent.match(/(iPad)/i)}return!0},re=function(){return m?ee():ae()},oe=function(e){return e=void 0===a.parseInputDate?i.isMoment(e)||e instanceof Date?i(e):i(e,o,a.useStrict):a.parseInputDate(e),e.locale(a.locale),e},de=function(e){var i,t,n,s,l=null,r=[],o={},d=e.which;k[d]="p";for(i in k)k.hasOwnProperty(i)&&"p"===k[i]&&(r.push(i),parseInt(i,10)!==d&&(o[i]=!0));for(i in a.keyBinds)if(a.keyBinds.hasOwnProperty(i)&&"function"==typeof a.keyBinds[i]&&(n=i.split(" "),n.length===r.length&&C[d]===n[n.length-1])){for(s=!0,t=n.length-2;t>=0;t--)if(!(C[n[t]]in o)){s=!1;break}if(s){l=a.keyBinds[i];break}}x=!1,l&&(l.call(c,m)||(e.stopPropagation(),e.preventDefault(),x=!0)),9!==e.which&&13!==e.which&&16!==e.which&&27!==e.which||(k[e.which]="r")},ce=function(e){k[e.which]="r",x&&(e.stopPropagation(),e.preventDefault())},ue=function(i){var t=e(i.target).val().trim(),n=t?oe(t):null;return X(n),i.stopImmediatePropagation(),!1},he=function(){s.off({"change":ue,"blur":ee,"keydown":de,"keyup":ce,"focus":a.allowInputToggle?ee:""}),n.is("input")?s.off({"focus":ae}):f&&(f.off("click touchend",re),f.off("mousedown touchstart",!1))},pe=function(i){var t={};return e.each(i,function(){var e=oe(this);e.isValid()&&(t[e.format("YYYY-MM-DD")]=!0)}),!!Object.keys(t).length&&t},fe=function(i){var t={};return e.each(i,function(){t[this]=!0}),!!Object.keys(t).length&&t},me=function(){var e=a.format||"L LT";r=e.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(e){return(u.localeData().longDateFormat(e)||e).replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(e){return u.localeData().longDateFormat(e)||e})}),o=a.extraFormats?a.extraFormats.slice():[],o.indexOf(e)<0&&o.indexOf(r)<0&&o.push(r),l=r.toLowerCase().indexOf("a")<1&&r.replace(/\[.*?\]/g,"").indexOf("h")<1,E("y")&&(g=2),E("M")&&(g=1),E("d")&&(g=0),d=Math.max(g,d),p||X(u)};if(c.destroy=function(){ee(),he(),n.removeData("DateTimePicker"),n.removeData("date")},c.toggle=re,c.show=ae,c.hide=ee,c.disable=function(){return ee(),f&&f.hasClass("binf-btn")&&f.addClass("binf-disabled"),s.prop("disabled",!0),c},c.enable=function(){return f&&f.hasClass("binf-btn")&&f.removeClass("binf-disabled"),s.prop("disabled",!1),c},c.ignoreReadonly=function(e){if(0===arguments.length)return a.ignoreReadonly;if("boolean"!=typeof e)throw new TypeError("ignoreReadonly () expects a boolean parameter");return a.ignoreReadonly=e,c},c.options=function(i){if(0===arguments.length)return e.extend(!0,{},a);if(!(i instanceof Object))throw new TypeError("options() options parameter should be an object");return e.extend(!0,a,i),e.each(a,function(e,i){if(void 0===c[e])throw new TypeError("option "+e+" is not recognized!");c[e](i)}),c},c.date=function(e){if(0===arguments.length)return p?null:u.clone();if(!(null===e||"string"==typeof e||i.isMoment(e)||e instanceof Date))throw new TypeError("date() parameter must be one of [null, string, moment or Date]");return X(null===e?null:oe(e)),c},c.format=function(e){if(0===arguments.length)return a.format;if("string"!=typeof e&&("boolean"!=typeof e||!1!==e))throw new TypeError("format() expects a sting or boolean:false parameter "+e);return a.format=e,r&&me(),c},c.dayViewHeaderFormat=function(e){if(0===arguments.length)return a.dayViewHeaderFormat;if("string"!=typeof e)throw new TypeError("dayViewHeaderFormat() expects a string parameter");return a.dayViewHeaderFormat=e,c},c.extraFormats=function(e){if(0===arguments.length)return a.extraFormats;if(!1!==e&&!(e instanceof Array))throw new TypeError("extraFormats() expects an array or false parameter");return a.extraFormats=e,o&&me(),c},c.disabledDates=function(i){if(0===arguments.length)return a.disabledDates?e.extend({},a.disabledDates):a.disabledDates;if(!i)return a.disabledDates=!1,Z(),c;if(!(i instanceof Array))throw new TypeError("disabledDates() expects an array parameter");return a.disabledDates=pe(i),a.enabledDates=!1,Z(),c},c.enabledDates=function(i){if(0===arguments.length)return a.enabledDates?e.extend({},a.enabledDates):a.enabledDates;if(!i)return a.enabledDates=!1,Z(),c;if(!(i instanceof Array))throw new TypeError("enabledDates() expects an array parameter");return a.enabledDates=pe(i),a.disabledDates=!1,Z(),c},c.daysOfWeekDisabled=function(e){if(0===arguments.length)return a.daysOfWeekDisabled.splice(0);if("boolean"==typeof e&&!e)return a.daysOfWeekDisabled=!1,Z(),c;if(!(e instanceof Array))throw new TypeError("daysOfWeekDisabled() expects an array parameter");if(a.daysOfWeekDisabled=e.reduce(function(e,i){return(i=parseInt(i,10))>6||i<0||isNaN(i)?e:(-1===e.indexOf(i)&&e.push(i),e)},[]).sort(),a.useCurrent&&!a.keepInvalid){for(var i=0;!W(u,"d");){if(u.add(1,"d"),7===i)throw"Tried 7 times to find a valid date";i++}X(u)}return Z(),c},c.maxDate=function(e){if(0===arguments.length)return a.maxDate?a.maxDate.clone():a.maxDate;if("boolean"==typeof e&&!1===e)return a.maxDate=!1,Z(),c;"string"==typeof e&&("now"!==e&&"moment"!==e||(e=i()));var t=oe(e);if(!t.isValid())throw new TypeError("maxDate() Could not parse date parameter: "+e);if(a.minDate&&t.isBefore(a.minDate))throw new TypeError("maxDate() date parameter is before options.minDate: "+t.format(r));return a.maxDate=t,a.useCurrent&&!a.keepInvalid&&u.isAfter(e)&&X(a.maxDate),h.isAfter(t)&&(h=t.clone()),Z(),c},c.minDate=function(e){if(0===arguments.length)return a.minDate?a.minDate.clone():a.minDate;if("boolean"==typeof e&&!1===e)return a.minDate=!1,Z(),c;"string"==typeof e&&("now"!==e&&"moment"!==e||(e=i()));var t=oe(e);if(!t.isValid())throw new TypeError("minDate() Could not parse date parameter: "+e)
;if(a.maxDate&&t.isAfter(a.maxDate))throw new TypeError("minDate() date parameter is after options.maxDate: "+t.format(r));return a.minDate=t,a.useCurrent&&!a.keepInvalid&&u.isBefore(e)&&X(a.minDate),h.isBefore(t)&&(h=t.clone()),Z(),c},c.defaultDate=function(e){if(0===arguments.length)return a.defaultDate?a.defaultDate.clone():a.defaultDate;if(!e)return a.defaultDate=!1,c;"string"==typeof e&&("now"!==e&&"moment"!==e||(e=i()));var t=oe(e);if(!t.isValid())throw new TypeError("defaultDate() Could not parse date parameter: "+e);if(!W(t))throw new TypeError("defaultDate() date passed is invalid according to component setup validations");return a.defaultDate=t,(a.defaultDate&&a.inline||""===s.val().trim()&&void 0===s.attr("placeholder"))&&X(a.defaultDate),c},c.locale=function(e){if(0===arguments.length)return a.locale;if(!i.localeData(e))throw new TypeError("locale() locale "+e+" is not loaded from moment locales!");return a.locale=e,u.locale(a.locale),h.locale(a.locale),r&&me(),m&&(ee(),ae()),c},c.stepping=function(e){return 0===arguments.length?a.stepping:(e=parseInt(e,10),(isNaN(e)||e<1)&&(e=1),a.stepping=e,c)},c.useCurrent=function(e){var i=["year","month","day","hour","minute"];if(0===arguments.length)return a.useCurrent;if("boolean"!=typeof e&&"string"!=typeof e)throw new TypeError("useCurrent() expects a boolean or string parameter");if("string"==typeof e&&-1===i.indexOf(e.toLowerCase()))throw new TypeError("useCurrent() expects a string parameter of "+i.join(", "));return a.useCurrent=e,c},c.collapse=function(e){if(0===arguments.length)return a.collapse;if("boolean"!=typeof e)throw new TypeError("collapse() expects a boolean parameter");return a.collapse===e?c:(a.collapse=e,m&&(ee(),ae()),c)},c.icons=function(i){if(0===arguments.length)return e.extend({},a.icons);if(!(i instanceof Object))throw new TypeError("icons() expects parameter to be an Object");return e.extend(a.icons,i),m&&(ee(),ae()),c},c.useStrict=function(e){if(0===arguments.length)return a.useStrict;if("boolean"!=typeof e)throw new TypeError("useStrict() expects a boolean parameter");return a.useStrict=e,c},c.sideBySide=function(e){if(0===arguments.length)return a.sideBySide;if("boolean"!=typeof e)throw new TypeError("sideBySide() expects a boolean parameter");return a.sideBySide=e,m&&(ee(),ae()),c},c.viewMode=function(e){if(0===arguments.length)return a.viewMode;if("string"!=typeof e)throw new TypeError("viewMode() expects a string parameter");if(-1===b.indexOf(e))throw new TypeError("viewMode() parameter must be one of ("+b.join(", ")+") value");return a.viewMode=e,d=Math.max(b.indexOf(e),g),P(),c},c.toolbarPlacement=function(e){if(0===arguments.length)return a.toolbarPlacement;if("string"!=typeof e)throw new TypeError("toolbarPlacement() expects a string parameter");if(-1===F.indexOf(e))throw new TypeError("toolbarPlacement() parameter must be one of ("+F.join(", ")+") value");return a.toolbarPlacement=e,m&&(ee(),ae()),c},c.widgetPositioning=function(i){if(0===arguments.length)return e.extend({},a.widgetPositioning);if("[object Object]"!=={}.toString.call(i))throw new TypeError("widgetPositioning() expects an object variable");if(i.horizontal){if("string"!=typeof i.horizontal)throw new TypeError("widgetPositioning() horizontal variable must be a string");if(i.horizontal=i.horizontal.toLowerCase(),-1===w.indexOf(i.horizontal))throw new TypeError("widgetPositioning() expects horizontal parameter to be one of ("+w.join(", ")+")");a.widgetPositioning.horizontal=i.horizontal}if(i.vertical){if("string"!=typeof i.vertical)throw new TypeError("widgetPositioning() vertical variable must be a string");if(i.vertical=i.vertical.toLowerCase(),-1===y.indexOf(i.vertical))throw new TypeError("widgetPositioning() expects vertical parameter to be one of ("+y.join(", ")+")");a.widgetPositioning.vertical=i.vertical}return Z(),c},c.calendarWeeks=function(e){if(0===arguments.length)return a.calendarWeeks;if("boolean"!=typeof e)throw new TypeError("calendarWeeks() expects parameter to be a boolean value");return a.calendarWeeks=e,Z(),c},c.showTodayButton=function(e){if(0===arguments.length)return a.showTodayButton;if("boolean"!=typeof e)throw new TypeError("showTodayButton() expects a boolean parameter");return a.showTodayButton=e,m&&(ee(),ae()),c},c.showClear=function(e){if(0===arguments.length)return a.showClear;if("boolean"!=typeof e)throw new TypeError("showClear() expects a boolean parameter");return a.showClear=e,m&&(ee(),ae()),c},c.widgetParent=function(i){if(0===arguments.length)return a.widgetParent;if("string"==typeof i&&(i=e(i)),null!==i&&"string"!=typeof i&&!(i instanceof e))throw new TypeError("widgetParent() expects a string or a jQuery object parameter");return a.widgetParent=i,m&&(ee(),ae()),c},c.keepOpen=function(e){if(0===arguments.length)return a.keepOpen;if("boolean"!=typeof e)throw new TypeError("keepOpen() expects a boolean parameter");return a.keepOpen=e,c},c.focusOnShow=function(e){if(0===arguments.length)return a.focusOnShow;if("boolean"!=typeof e)throw new TypeError("focusOnShow() expects a boolean parameter");return a.focusOnShow=e,c},c.inline=function(e){if(0===arguments.length)return a.inline;if("boolean"!=typeof e)throw new TypeError("inline() expects a boolean parameter");return a.inline=e,c},c.clear=function(){return ie(),c},c.keyBinds=function(e){return a.keyBinds=e,c},c.debug=function(e){if("boolean"!=typeof e)throw new TypeError("debug() expects a boolean parameter");return a.debug=e,c},c.allowInputToggle=function(e){if(0===arguments.length)return a.allowInputToggle;if("boolean"!=typeof e)throw new TypeError("allowInputToggle() expects a boolean parameter");return a.allowInputToggle=e,c},c.showClose=function(e){if(0===arguments.length)return a.showClose;if("boolean"!=typeof e)throw new TypeError("showClose() expects a boolean parameter");return a.showClose=e,c},c.keepInvalid=function(e){if(0===arguments.length)return a.keepInvalid;if("boolean"!=typeof e)throw new TypeError("keepInvalid() expects a boolean parameter");return a.keepInvalid=e,c},c.datepickerInput=function(e){if(0===arguments.length)return a.datepickerInput;if("string"!=typeof e)throw new TypeError("datepickerInput() expects a string parameter");return a.datepickerInput=e,c},c.parseInputDate=function(e){if(0===arguments.length)return a.parseInputDate;if("function"!=typeof e)throw new TypeError("parseInputDate() sholud be as function");return a.parseInputDate=e,c},c.disabledTimeIntervals=function(i){if(0===arguments.length)return a.disabledTimeIntervals?e.extend({},a.disabledTimeIntervals):a.disabledTimeIntervals;if(!i)return a.disabledTimeIntervals=!1,Z(),c;if(!(i instanceof Array))throw new TypeError("disabledTimeIntervals() expects an array parameter");return a.disabledTimeIntervals=i,Z(),c},c.disabledHours=function(i){if(0===arguments.length)return a.disabledHours?e.extend({},a.disabledHours):a.disabledHours;if(!i)return a.disabledHours=!1,Z(),c;if(!(i instanceof Array))throw new TypeError("disabledHours() expects an array parameter");if(a.disabledHours=fe(i),a.enabledHours=!1,a.useCurrent&&!a.keepInvalid){for(var t=0;!W(u,"h");){if(u.add(1,"h"),24===t)throw"Tried 24 times to find a valid date";t++}X(u)}return Z(),c},c.enabledHours=function(i){if(0===arguments.length)return a.enabledHours?e.extend({},a.enabledHours):a.enabledHours;if(!i)return a.enabledHours=!1,Z(),c;if(!(i instanceof Array))throw new TypeError("enabledHours() expects an array parameter");if(a.enabledHours=fe(i),a.disabledHours=!1,a.useCurrent&&!a.keepInvalid){for(var t=0;!W(u,"h");){if(u.add(1,"h"),24===t)throw"Tried 24 times to find a valid date";t++}X(u)}return Z(),c},c.viewDate=function(e){if(0===arguments.length)return h.clone();if(!e)return h=u.clone(),c;if(!("string"==typeof e||i.isMoment(e)||e instanceof Date))throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");return h=oe(e),R(),c},n.is("input"))s=n;else if(s=n.find(a.datepickerInput),0===s.length)s=n.find("input");else if(!s.is("input"))throw new Error('CSS class "'+a.datepickerInput+'" cannot be applied to non input element');if(n.hasClass("binf-input-group")&&(f=0===n.find(".datepickerbutton").length?n.find('[class^="input-group-"]'):n.find(".datepickerbutton")),!a.inline&&!s.is("input"))throw new Error("Could not initialize DateTimePicker without an input element");return e.extend(!0,a,function(){var i,t={};return i=n.is("input")||a.inline?n.data():n.find("input").data(),i.dateOptions&&i.dateOptions instanceof Object&&(t=e.extend(!0,t,i.dateOptions)),e.each(a,function(e){var n="date"+e.charAt(0).toUpperCase()+e.slice(1);void 0!==i[n]&&(t[e]=i[n])}),t}()),c.options(a),me(),function(){s.on({"change":ue,"blur":a.debug?"":ee,"keydown":de,"keyup":ce,"focus":a.allowInputToggle?ae:""}),n.is("input")?s.on({"focus":ae}):f&&(f.on("click touchend",re),f.on("mousedown touchstart",!1))}(),s.prop("disabled")&&c.disable(),s.is("input")&&0!==s.val().trim().length?X(oe(s.val().trim())):a.defaultDate&&void 0===s.attr("placeholder")&&X(a.defaultDate),a.inline&&ae(),c};e.fn.datetimepicker=function(i){return this.each(function(){var t=e(this);t.data("DateTimePicker")||(i=e.extend(!0,{},e.fn.datetimepicker.defaults,i),t.data("DateTimePicker",n(t,i)))})},e.fn.datetimepicker.defaults={"format":!1,"dayViewHeaderFormat":"MMMM YYYY","extraFormats":!1,"stepping":1,"minDate":!1,"maxDate":!1,"useCurrent":!0,"collapse":!0,"locale":i.locale(),"defaultDate":!1,"disabledDates":!1,"enabledDates":!1,"icons":{"time":"binf-glyphicon binf-glyphicon-time","date":"binf-glyphicon binf-glyphicon-calendar","up":"binf-glyphicon binf-glyphicon-chevron-up","down":"binf-glyphicon binf-glyphicon-chevron-down","previous":this&&this.i18n.settings.rtl?"binf-glyphicon binf-glyphicon-chevron-right":"binf-glyphicon binf-glyphicon-chevron-left","next":this&&this.i18n.settings.rtl?"binf-glyphicon binf-glyphicon-chevron-left":"binf-glyphicon binf-glyphicon-chevron-right","today":"binf-glyphicon binf-glyphicon-screenshot","clear":"binf-glyphicon binf-glyphicon-trash","close":"binf-glyphicon binf-glyphicon-remove"},"useStrict":!1,"sideBySide":!1,"daysOfWeekDisabled":!1,"calendarWeeks":!1,"viewMode":"days","toolbarPlacement":"default","showTodayButton":!1,"showClear":!1,"showClose":!1,"widgetPositioning":{"horizontal":"auto","vertical":"auto"},"widgetParent":null,"ignoreReadonly":!1,"keepOpen":!1,"focusOnShow":!0,"inline":!1,"keepInvalid":!1,"datepickerInput":".datepickerinput","keyBinds":{"up":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")?this.date(t.clone().subtract(7,"d")):this.date(t.clone().add(1,"m"))}},"down":function(e){if(!e)return void this.show();var t=this.date()||i();e.find(".datepicker").is(":visible")?this.date(t.clone().add(7,"d")):this.date(t.clone().subtract(1,"m"))},"control up":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")?this.date(t.clone().subtract(1,"y")):this.date(t.clone().add(1,"h"))}},"control down":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")?this.date(t.clone().add(1,"y")):this.date(t.clone().subtract(1,"h"))}},"left":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")&&this.date(t.clone().subtract(1,"d"))}},"right":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")&&this.date(t.clone().add(1,"d"))}},"pageUp":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")&&this.date(t.clone().subtract(1,"M"))}},"pageDown":function(e){if(e){var t=this.date()||i();e.find(".datepicker").is(":visible")&&this.date(t.clone().add(1,"M"))}},"enter":function(e){if(!e)return!0;this.hide()},"escape":function(e){if(!e)return!0;this.hide()},"tab":function(e){if(e&&e.find(".datepicker").is(":visible")){var i=e.find('.picker-switch a[data-action="togglePicker"]');i.length>0&&i.click()}else{if(!e)return!0;this.hide()}},"shift tab":function(e){if(e&&e.find(".timepicker").is(":visible")){var i=e.find('.picker-switch a[data-action="togglePicker"]');i.length>0&&i.click()}},"control space":function(e){e.find(".timepicker").is(":visible")&&e.find('.binf-btn[data-action="togglePeriod"]').click()},"t":function(){this.date(i())},"delete":function(){this.clear()}},"debug":!1,"allowInputToggle":!1,"disabledTimeIntervals":!1,"disabledHours":!1,"enabledHours":!1,"viewDate":!1}}),csui.define("csui/controls/form/fields/impl/datebasefield.view",["i18n","csui/lib/underscore","csui/utils/base","csui/lib/jquery","csui/lib/marionette","csui/utils/types/date","csui/controls/form/impl/fields/csformfield.view","i18n!csui/controls/form/impl/nls/lang","hbs!csui/controls/form/impl/fields/datefield/datefield","css!csui/controls/form/impl/fields/datefield/datefield","csui/lib/binf/js/binf","csui/lib/binf/js/binf-datetimepicker"],function(e,i,t,n,a,s,l,r,o){"use strict";return l.extend({"constructor":function(e){this.ui.subInputField=".icon-date_picker",l.apply(this,arguments),this.curVal=this.model.get("data")},"inputType":null,"inputStep":null,"className":"cs-formfield cs-datefield","template":o,"events":{"change @ui.writeField":"onChangeWriteField","keydown .icon-date_picker":"onDateIconKeyDown","keydown @ui.writeField":"onWriteFieldKeyDown"},"onChangeWriteField":function(e){return!0},"onWriteFieldKeyDown":function(e){if(27===e.keyCode){this.$el.find(".icon-container")[0].classList.add("binf-hidden")}},"onDateIconKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||(e.stopPropagation(),e.preventDefault(),this.$el.find(".icon-date_picker").trigger("click"))},"templateHelpers":function(){var e=this.getValue(),t=this._convertFromModelToInput(e),n="",a="",s="readonly"===this.mode,o="",d=!1,c=!1,u="";if(d=this.options.alpacaField&&this.options.alpacaField.isRequired(),c=!(!this.options.alpacaField||!this.options.alpacaField.schema.disabled),u=d?r.requiredField:"",this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(n=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),this.model.get("options")){var h=t||r.noValue;a=s?i.str.sformat(r.fieldReadOnlyAria,this.model.get("options").label,h)+u:i.str.sformat(r.fieldEditAria,this.model.get("options").label,h)+u}return o=s?i.str.sformat(r.fieldReadOnlyAria,n,t)+u:i.str.sformat(r.fieldEditAria,n,t)+u,i.extend(l.prototype.templateHelpers.apply(this),{"data":t,"readData":t,"placeholder":c?r.noValueSet:this.format.toLowerCase(),"inputType":"text","idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"readModeAria":a,"readModeMultiFieldAria":o,"multiFieldLabel":n,"ariaRequired":d,"disabled":c})},"setStateWrite":function(){if(this.initialValue=this.getValue(),n.fn.datetimepicker){var i=this;this.ui.writeDateField.datetimepicker({"format":this.format,"keepInvalid":!0,"useStrict":!0,"widgetParent":this.$el,"showClear":t.isTouchBrowser(),"widgetPositioning":{"vertical":"auto","horizontal":e.settings.rtl?"right":"left"}}).on("dp.change",function(e){i.getEditableBehavior()._showApplyAll(e),e.stopImmediatePropagation(),n(e.target).parents(".csui-normal-scrolling").css("overflow","auto")}).on("dp.place",function(a){if(t.isMSBrowser()||t.isTouchBrowser()&&e&&e.settings.rtl){var s=n(a.target),l=i.$el.find(".binf-datetimepicker-widget");t.adjustDropDownField(s,l,!1,i,i.hideDateTimePicker),a.stopImmediatePropagation()}}).on("dp.show",function(a){if(i.getEditableBehavior().hideActions){i.options.isDropDownOpen=!0;var s=i.$el.closest(".csui-scrollable-writemode");s&&!s.hasClass("csui-dropdown-open")&&s.addClass("csui-dropdown-open"),i.getEditableBehavior().hideActions(a)}if(!t.isMSBrowser()||!(t.isTouchBrowser()&&e&&e.settings.rtl)){var l=n(a.target),r=i.$el.find(".binf-datetimepicker-widget");t.adjustDropDownField(l,r,!1,i,i.hideDateTimePicker)}a.stopImmediatePropagation()}).on("dp.hide",function(e){if(i.getEditableBehavior().showActions){i.options.isDropDownOpen=!1;var t=i.$el.closest(".csui-scrollable-writemode");t&&t.hasClass("csui-dropdown-open")&&t.removeClass("csui-dropdown-open"),i.getEditableBehavior().showActions(e)}e.stopImmediatePropagation(),n(e.target).parents(".csui-normal-scrolling").css("overflow","auto")})}},"hideDateTimePicker":function(e){if(e.$el.find(".icon-date_picker").trigger("click"),e.getEditableBehavior().showActions){e.options.isDropDownOpen=!1;var i=e.$el.closest(".csui-scrollable-writemode");i&&i.hasClass("csui-dropdown-open")&&i.removeClass("csui-dropdown-open"),e.getEditableBehavior().showActions()}},"getEditValue":function(){var e=this.ui.writeField.val();return this._convertFromInputToModel(e)},"resetOldValueAfterCancel":function(){return this.ui.writeField.val(this._convertFromModelToInput(this.getValue())),!0},"_convertFromInputToModel":function(e){return e?s.serializeDateTime(e,void 0,function(){return!1}):null},"_convertFromModelToInput":function(e){return e?s.formatExactDateTime(s.deserializeDate(e)):""}})}),csui.define("csui/controls/form/fields/datefield.view",["csui/utils/types/date","csui/controls/form/fields/impl/datebasefield.view"],function(e,i){"use strict";return i.extend({"format":e.exactDateFormat,"inputType":"date","constructor":function(e){i.apply(this,arguments)},"getDisplayValue":function(){return this.$el.find(":input")[0].value},"getValue":function(){var e=this.model.get("data"),i=this._convertFromModelToInput(e);return this._convertFromInputToModel(i)},"_convertFromInputToModel":function(i){return i?e.serializeDate(i,void 0,function(){return!1}):null},"_convertFromModelToInput":function(i){return i?e.formatExactDate(e.deserializeDate(i)):""}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuidateonlyfield",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/utils/types/date","csui/controls/form/fields/datefield.view"],function(e,i,t,n,a,s,l){"use strict";return a.Fields.CsuiDateOnlyField=a.Fields.DateField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var a,s=this.id,r=this.options?this.options.descriptionId:"",o=i(this.field[0]).find("label");o&&1==o.length&&(a=o.attr("for")+"Label",o.attr("id",a)),this.fieldView=new l({"model":new t.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":s}),"id":e.uniqueId(s),"alpacaField":this,"labelId":a,"descriptionId":r,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var d=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(d),this.region=new n.Region({"el":d}),this.region.show(this.fieldView)},"getValue":function(){var e=this.base();return e||null},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"_validateDateFormat":function(){var e=this.containerItemEl.find("input").val();return!(!e&&this.isRequired())&&(!e||s.validateDate(e))},"focus":function(){this.fieldView.setFocus()},"handleValidate":function(){var e=this.base();if(!e){var i=this.validation;if(""!==this.fieldView.ui.writeField.val())return i.notOptional.status=!0,i.notOptional.message="",e;for(var t in i)!1===i[t].status&&"notOptional"!==t&&(i[t].status=!0,i[t].message="")}return e}}),a.registerFieldClass("date",a.Fields.CsuiDateOnlyField,"bootstrap-csui"),a.registerFieldClass("date",a.Fields.CsuiDateOnlyField,"bootstrap-edit-horizontal"),a.registerDefaultFormatFieldMapping("date","date"),a.Fields.CsuiDateOnlyField}),csui.define("csui/controls/form/fields/datetimefield.view",["csui/utils/types/date","csui/controls/form/fields/impl/datebasefield.view"],function(e,i){"use strict";return i.extend({"className":i.prototype.className+" cs-datetime","format":e.exactDateTimeFormat,"inputType":"datetime-local","inputStep":"1","constructor":function(e){i.apply(this,arguments)},"getDisplayValue":function(){return this.$el.find(":input")[0].value}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuidatetimefield",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/utils/types/date","csui/controls/form/fields/datetimefield.view"],function(e,i,t,n,a,s,l){"use strict";return a.Fields.CsuiDateTimeField=a.Fields.DatetimeField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var a,s=this.id,r=this.options?this.options.descriptionId:"",o=i(this.field[0]).find("label");o&&1==o.length&&(a=o.attr("for")+"Label",o.attr("id",a)),this.fieldView=new l({"model":new t.Model({"data":this.data,"options":this.options,"schema":this.schema,"inputType":"text","id":s}),"id":e.uniqueId(s),"alpacaField":this,"labelId":a,"descriptionId":r,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var d=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(d),this.region=new n.Region({"el":d}),this.region.show(this.fieldView)},"getValue":function(){var e=this.base();return e||null},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"_validateDateFormat":function(){var e=this.containerItemEl.find("input").val();return!(!e&&this.isRequired())&&(!e||s.validateDateTime(e))},"focus":function(){this.fieldView.setFocus()},"handleValidate":function(){var e=this.base();if(!e){var i=this.validation;if(""!==this.fieldView.ui.writeField.val())return i.notOptional.status=!0,i.notOptional.message="",e;for(var t in i)!1===i[t].status&&"notOptional"!==t&&(i[t].status=!0,i[t].message="")}return e}}),a.registerFieldClass("datetime",a.Fields.CsuiDateTimeField),a.registerFieldClass("datetime",a.Fields.CsuiDateTimeField,"bootstrap-csui"),a.registerFieldClass("datetime",a.Fields.CsuiDateTimeField,"bootstrap-edit-horizontal"),a.registerDefaultFormatFieldMapping("datetime","datetime"),a.Fields.CsuiDateTimeField}),csui.define("hbs!csui/controls/form/impl/fields/booleanfield/booleanfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return' aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{}}):a))+'" '},"3":function(e,i,t,n){return" aria-checked=true"},"5":function(e,i,t,n){return"\r\n             aria-checked=false"},"7":function(e,i,t,n){var a;return'      <div class="icon-container binf-hidden">\r\n        <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{}}):a))+'" tabindex="0"\r\n             data-cstabindex="0"></div>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write csui-unedited">\r\n  <div class="cs-field-inner">\r\n    <div class="control-area">\r\n      <input type="checkbox" name="'+this.escapeExpression((s=null!=(s=i.checkboxName||(null!=e?e.checkboxName:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"checkboxName","hash":{}}):s))+'" aria-labelledby="'+this.escapeExpression((s=null!=(s=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"idBtnLabel","hash":{}}):s))+'"\r\n            '+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n        "+(null!=(a=i.if.call(e,null!=e?e.value:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.program(5,n,0)}))?a:"")+' id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'">\r\n    </div>\r\n'+(null!=(a=i.if.call(e,null!=e?e.applyFlag:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop}))?a:"")+"  </div>\r\n</div>\r\n"}});return t.registerPartial("csui_controls_form_impl_fields_booleanfield_booleanfield",n),n}),csui.define("css!csui/controls/form/impl/fields/booleanfield/booleanfield",[],function(){}),csui.define("csui/controls/form/fields/booleanfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/form/impl/fields/csformfield.states.behavior","csui/controls/form/impl/fields/csformfield.view","hbs!csui/controls/form/impl/fields/booleanfield/booleanfield","csui/controls/form/impl/fields/csformfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.states.behavior","csui/lib/binf/js/binf-switch","css!csui/controls/form/impl/fields/booleanfield/booleanfield"],function(e,i,t,n,a,s,l,r,o,d,c){return l.extend({"className":"cs-formfield cs-booleanfield","template":r,"templateHelpers":function(){return{"value":this.model.get("data"),"applyFlag":!(!this.model.get("options")||!this.model.get("options").applyFlag)&&this.model.get("options").applyFlag,"id":this.model&&this.model.get("id")?this.model.get("id"):e.uniqueId("input"),"idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"checkboxName":e.uniqueId("csui-checkbox")}},"ui":{"flagWriteField":".cs-field-write input","readField":".cs-field-write input","readArea":".cs-field-write","subInputField":".cs-field-write input"},"events":{"click @ui.flagWriteField":"onClickWriteField","keydown @ui.flagWriteField":"onWriteFieldKeyDown"},"isBooleanField":!0,"silentRender":!0,"constructor":function(i){i.model.attributes.options&&(i.model.attributes.options.isMultiFieldItem?this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":d},"FormFieldStates":{"behaviorClass":c}},this.behaviors):this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":o},"FormFieldStates":{"behaviorClass":s}},this.behaviors)),this.setMode(i.mode),l.apply(this,arguments),this.listenTo(this.formView,"request:completed",e.bind(function(){this.isEventPropageted&&this.ui.flagWriteField.binfSwitch("toggleState")},this))},"errorExists":!1,"checkErrorExists":function(e){this.errorExists=!1;var t=i(".cs-form .cs-formfield-invalid");return t.length>0?this.$el.parents(".alpaca-container-item").last().find(".binf-has-error").length>0?this.errorExists=!1:"writeonly"!==this.mode?(t.find(":input").first().trigger("focus"),this.errorExists=!0):this.errorExists=!1:this.errorExists=!1,this.errorExists},"onRender":function(){var t=!this.model.get("data");this.ui.flagWriteField[0].checked=!t,this.ui.flagWriteField.binfSwitch({"state":t,"size":"mini","onText":"&nbsp;","offText":"&nbsp;","labelText":"&nbsp;","disabled":!!(this.alpacaField&&this.alpacaField.schema&&this.alpacaField.schema.disabled),"readonly":"readonly"===this.mode,"isValidChange":e.bind(function(){if("writeonly"!==this.mode&&document.querySelectorAll(".binf-has-error").length>0){var e=i(i(document.querySelectorAll(".binf-has-error")).find(":input")[0]),t=e.parents(".cs-form-set.cs-form-set-container"),n=this.$el.parents(".cs-form-set.cs-form-set-container");if(!t.is(n))return e.trigger("focus"),!1}return!0},this),"onBeforeChange":e.bind(this.options.onBeforeChange||this._onBeforeChange,this),"onSwitchChange":e.bind(function(e,t){if(this.$el.find(".binf-switch-wrapper").addClass("binf-switch-disabled"),this.checkErrorExists())return!1;this.model.get("options")&&this.model.get("options").isMultiFieldItem?("create"!==this.model.get("options").mode?(this.getEditValue()===this.getValue()?this.$el.find(".cs-field-write").addClass("csui-unedited"):this.$el.find(".cs-field-write").removeClass("csui-unedited"),i(this.ui.readArea).trigger("click")):this.setValue(!t,!0),this.showApplyAll(e,!0)):(this.showApplyAll(e,!1),this.setValue(!t,!0)),this.$el.find(".binf-switch-wrapper").removeClass("binf-switch-disabled"),this.ui.flagWriteField.trigger("focus"),this.ui.flagWriteField.attr("aria-checked",!t),this.ui.flagWriteField[0].checked=!t},this)})},"showApplyAll":function(e,i){var t=this.$el.find(".icon-container");if(t.hasClass("binf-hidden")&&(t[0].classList.remove("binf-hidden"),t.removeAttr("data-cstabindex"),t.removeAttr("tabindex")),i)this.getEditableBehavior()._showApplyAll(e);else if(this.options.alpaca&&"create"===this.options.alpaca.options.mode&&0===this.$el.closest(".csui-general-form").length){var n=this.$(e.target).parents(".cs-field-write").parent().find(".csui-icon.apply-all"),a=this.$el.closest(".cs-metadata-properties").find(".csui-icon.apply-all").not(".binf-hidden");a=a.filter(function(e,i){return i=i!==n[0]?i:void 0}),a&&a.length>0&&(a.addClass("binf-hidden"),a.parent().addClass("binf-hidden"),a.parent().find(".cs-icon-applied")&&a.parent().find(".cs-icon-applied").remove()),n.parent().hasClass("binf-hidden")&&n.parent().removeClass("binf-hidden alpaca-container"),n.hasClass("binf-hidden")&&(n.removeAttr("style"),n.removeClass("binf-hidden"),n.prop("tabindex","0"))}},"onClickWriteField":function(e){e.preventDefault(),e.stopPropagation(),this.ui.flagWriteField.binfSwitch("toggleState")},"onWriteFieldKeyDown":function(e){if(27===e.keyCode&&this.model.get("options")&&"create"===this.model.get("options").mode){var i=this.$el.find(".icon-container");i.length>0&&(i[0].classList.add("binf-hidden"),i.attr("data-cstabindex",-1),i.attr("tabindex",-1))}13!==e.keyCode&&32!==e.keyCode||(this.onClickWriteField(e),e.preventDefault(),e.stopPropagation())},"getEditValue":function(){return this.errorExists?this.getValue():this.$el.find(".binf-switch").hasClass("binf-switch-off")},"setMode":function(e){var i=e;"readonly"!==e&&(i="write"),this.mode=i,this.getStatesBehavior()&&(this.getStatesBehavior().state=void 0)},"setStateRead":function(e){return this.ui.flagWriteField.binfSwitch({"readonly":!0}),e&&this.ui.flagWriteField.trigger("focus"),!0},"setStateWrite":function(e,i){return this.ui.flagWriteField.binfSwitch({"readonly":!1}),this.ui.flagWriteField.trigger("focus").trigger("focus"),!0},"getStatesBehavior":function(){var e;return this._behaviors&&(e=this._behaviors[0]),e},"_onBeforeChange":function(e){return this.formView&&this.formView.isDataUpdating?(this.isEventPropageted=!0,this.formView.options.metadataView.blockingView.$el.is(":visible")||this.formView.options.metadataView.blockActions(),!1):(this.isEventPropageted=!1,!0)}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuibooleanfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/booleanfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r){return s.Fields.CsuiBooleanField=s.Fields.CheckBoxField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"setup":function(){this.base(),this.csuiValue=this.data,this.setValue(this.data)},"getFieldType":function(){return"checkbox"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e,s=this.id,r=this.options?this.options.descriptionId:"",o=t(this.field[0]).find("label");o&&1==o.length&&(e=o.attr("for")+"Label",o.attr("id",e)),this.fieldView=new l({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":s}),"id":i.uniqueId(s),"alpacaField":this,"labelId":e,"descriptionId":r,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}}),this.region=new a.Region({"el":t(".alpaca-control",this.containerItemEl)}),this.containerItemEl.find(".alpaca-control").empty(),this.region.show(this.fieldView),this.options.setRequiredFieldsEditable&&this.schema.required&&this.fieldView.setStateRead(!1)},
"setValueAndValidate":function(e,i){return this.setValue(e),this.csuiValue=e,!0},"getValue":function(){return this.csuiValue},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("checkbox",s.Fields.CsuiBooleanField,"bootstrap-csui"),t.alpaca.Fields.CsuiBooleanField}),csui.define("hbs!csui/controls/form/impl/fields/textfield/textfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return'maxlength="'+this.escapeExpression((a=null!=(a=i.maxLength||(null!=e?e.maxLength:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"maxLength","hash":{},"data":n}):a))+'"'},"3":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"\r\n         '},"5":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{},"data":n}):a))+'"'},"7":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"9":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"11":function(e,i,t,n){var a;return"data-"+this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'"'},"13":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'"'},"15":function(e,i,t,n){var a;return'aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{},"data":n}):a))+'" '},"17":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{},"data":n}):a))+'" '},"19":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{},"data":n}):a))+'"'},"21":function(e,i,t,n){var a;return' aria-required="'+this.escapeExpression((a=null!=(a=i.ariaRequired||(null!=e?e.ariaRequired:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"ariaRequired","hash":{},"data":n}):a))+'"'},"23":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{},"data":n}):a))+'"></div>\r\n      </div>\r\n'},"25":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.applyFlag:a,{"name":"if","hash":{},"fn":this.program(26,n,0),"inverse":this.noop,"data":n}))?a:""},"26":function(e,i,t,n){var a;return'        <div class="icon-container binf-hidden">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{},"data":n}):a))+'" tabindex="0"></div>\r\n        </div>\r\n'},"28":function(e,i,t,n){var a;return"          "+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(29,n,0),"inverse":this.program(31,n,0),"data":n}))?a:"")+'\r\n              target="_blank" title="'+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.anchorTitle:a,{"name":"if","hash":{},"fn":this.program(33,n,0),"inverse":this.program(35,n,0),"data":n}))?a:"")+'"\r\n        '+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(37,n,0),"inverse":this.program(39,n,0),"data":n}))?a:"")+">\r\n"+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(41,n,0),"inverse":this.program(43,n,0),"data":n}))?a:"")+"        </a>\r\n"},"29":function(e,i,t,n){var a;return' <a href="'+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))+'" '},"31":function(e,i,t,n){return' <a href="#" '},"33":function(e,i,t,n){var a;return this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.anchorTitle:a,e))},"35":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))},"37":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.readModeMultiFieldAria||(null!=e?e.readModeMultiFieldAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeMultiFieldAria","hash":{},"data":n}):a))+'" '},"39":function(e,i,t,n){var a;return'\r\n          aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{},"data":n}):a))+'"'},"41":function(e,i,t,n){var a;return"          <span>"+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))+"</span>\r\n"},"43":function(e,i,t,n){var a;return'          <span class="placeholder" title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{},"data":n}):a))+'">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{},"data":n}):a))+"</span>\r\n"},"45":function(e,i,t,n){var a,s;return'        <button title="'+this.escapeExpression((s=null!=(s=i.tooltip||(null!=e?e.tooltip:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"tooltip","hash":{},"data":n}):s))+'"\r\n          '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(46,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n          "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(37,n,0),"inverse":this.program(48,n,0),"data":n}))?a:"")+"        >\r\n"+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(50,n,0),"inverse":this.program(52,n,0),"data":n}))?a:"")+"        </button>\r\n"},"46":function(e,i,t,n){return' aria-disabled="true" '},"48":function(e,i,t,n){var a;return'\r\n                aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{},"data":n}):a))+'"\r\n'},"50":function(e,i,t,n){var a;return"            <span>"+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{},"data":n}):a))+"</span>\r\n"},"52":function(e,i,t,n){var a;return'            <span class="placeholder" title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{},"data":n}):a))+'">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{},"data":n}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n  <input type="'+this.escapeExpression((s=null!=(s=i.inputType||(null!=e?e.inputType:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"inputType","hash":{},"data":n}):s))+'" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=e?e.maxLength:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.program(5,n,0),"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.attributes:a,{"name":"each","hash":{},"fn":this.program(13,n,0),"inverse":this.noop,"data":n}))?a:"")+'\r\n    value="'+this.escapeExpression((s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"data","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(15,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(17,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(19,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.ariaRequired:e,{"name":"if","hash":{},"fn":this.program(21,n,0),"inverse":this.noop,"data":n}))?a:"")+"/>\r\n"+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":this.program(23,n,0),"inverse":this.program(25,n,0),"data":n}))?a:"")+'\r\n  </div>\r\n</div>\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n'+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.options && this.options.type === 'url'",{"name":"xif","hash":{},"fn":this.program(28,n,0),"inverse":this.program(45,n,0),"data":n}))?a:"")+'    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{},"data":n}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'},"useData":!0});return t.registerPartial("csui_controls_form_impl_fields_textfield_textfield",n),n}),csui.define("css!csui/controls/form/impl/fields/textfield/textfield",[],function(){}),csui.define("csui/controls/form/fields/textfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","csui/utils/url","csui/utils/contexts/factories/connector","i18n!csui/controls/form/impl/nls/lang","hbs!csui/controls/form/impl/fields/textfield/textfield","css!csui/controls/form/impl/fields/textfield/textfield","csui/lib/binf/js/binf","csui/lib/handlebars.helpers.xif"],function(e,i,t,n,a,s,l,r,o){"use strict";var d=a.extend({"constructor":function(e){(a.apply(this,arguments),!e.model.get("options")||!e.model.get("options").type||"url"!==e.model.get("options").type)||(this.model.get("data"),"read"===this.mode&&this.getUpdatedUrlWithPatterns(this.model.get("data"))&&(this.curVal=this.getUpdatedUrlWithPatterns(this.model.get("data"))))},"events":{"keypress @ui.readField":"onKeyPressRead"},"getDisplayValue":function(){return this.getEditValue()},"getAbsoluteUrl":function(e){var i=e;return d.urlFuncProtocolPattern.test(e)&&(this.connector=this.options.context.getObject(l),i=s.combine(this.connector.connection.url.replace("/api/v1","")+this.curVal)),i&&(i=encodeURIComponent(i)),i},"className":"cs-formfield cs-textfield","template":o,"templateHelpers":function(){var i="",t=r.noValue,n="",s="",l=!1,o="readonly"===this.mode,d="",c="",u=this.options.alpacaField&&this.options.alpacaField.schema&&this.options.alpacaField.schema.maxLength;return l=this.options.alpacaField&&this.options.alpacaField.isRequired(),d=l?r.requiredField:"",this.model.get("data")&&(t=this.model.get("data")),c=this.getAbsoluteUrl(t),this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(i=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),this.model.get("options")&&(n=o?e.str.sformat(r.fieldReadOnlyAria,this.model.get("options").label,t)+d:e.str.sformat(r.fieldEditAria,this.model.get("options").label,t)+d),s=o?e.str.sformat(r.fieldReadOnlyAria,i,t)+d:e.str.sformat(r.fieldEditAria,i,t)+d,e.extend(a.prototype.templateHelpers.apply(this),{"absUrl":c,"inputType":"text","idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"readModeAria":n,"readModeMultiFieldAria":s,"multiFieldLabel":i,"ariaRequired":l,"maxLength":u})},"onKeyPressRead":function(e){13===e.keyCode&&this.model.attributes.options&&"url"===this.model.attributes.options.type&&window.open(this.model.attributes.data,"_blank")},"allowEditOnEnter":function(){var e=!0;return this.model.attributes.options&&(e="url"!==this.model.attributes.options.type),e},"allowEditOnClickReadArea":function(){var e=!0;return this.model.attributes.options&&(e="url"!==this.model.attributes.options.type),e},"getEditValue":function(){var e=this.model.attributes.options&&"url"===this.model.attributes.options.type,i=this.ui.writeField.val();return e&&(i=this.getUpdatedUrlWithPatterns(i)),i},"getUpdatedUrlWithPatterns":function(e){return!e||d.urlFuncProtocolPattern.test(e)||d.urlProtocolPattern.test(e)||(e="http://"+e),e}},{"urlProtocolPattern":/^[a-z0-9]+:\/\//i,"urlFuncProtocolPattern":/^\?func=[a-z0-9]/i});return d}),csui.define("csui/controls/form/fields/alpaca/alpcsuitextfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","csui/controls/form/fields/textfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r,o){return s.Fields.CsuiTextField=s.Fields.TextField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"text"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e,s=this.id,l=this.options?this.options.descriptionId:"",o=t(this.field[0]).find("label");o&&1==o.length&&(e=o.attr("for")+"Label",o.attr("id",e)),this.fieldView=new r({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"inputType":"text","id":s}),"id":i.uniqueId(s),"alpacaField":this,"labelId":e,"descriptionId":l,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var d=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(d),this.region=new a.Region({"el":d}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("text",s.Fields.CsuiTextField,"bootstrap-csui"),s.registerFieldClass("text",s.Fields.CsuiTextField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiTextField}),csui.define("hbs!csui/controls/form/impl/fields/textareafield/textareafield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return'maxlength="'+this.escapeExpression((a=null!=(a=i.maxLength||(null!=e?e.maxLength:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"maxLength","hash":{}}):a))+'"'},"3":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"\r\n              '},"5":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{}}):a))+'"'},"7":function(e,i,t,n){var a;return'rows="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.rows:a,e))+'"'},"9":function(e,i,t,n){return"readonly"},"11":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+'"'},"13":function(e,i,t,n){var a;return' aria-required="'+this.escapeExpression((a=null!=(a=i.ariaRequired||(null!=e?e.ariaRequired:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"ariaRequired","hash":{}}):a))+'"'},"15":function(e,i,t,n){var a;return"data-"+this.escapeExpression((a=null!=(a=i.fieldId||(null!=e?e.fieldId:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"fieldId","hash":{}}):a))+'="'+this.escapeExpression((a=null!=(a=i.value||(null!=e?e.value:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"value","hash":{}}):a))+'" '},"17":function(e,i,t,n){var a;return' aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{}}):a))+'"'},"19":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{}}):a))+'" '},"21":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{}}):a))+'" '},"23":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{}}):a))+'"></div>\r\n      </div>\r\n'},"25":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.applyFlag:a,{"name":"if","hash":{},"fn":this.program(26,n,0),"inverse":this.noop}))?a:""},"26":function(e,i,t,n){var a;return'        <div class="icon-container binf-hidden">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{}}):a))+'" tabindex="0"></div>\r\n        </div>\r\n'},"28":function(e,i,t,n){return' aria-disabled="true" '},"30":function(e,i,t,n){var a;return'              aria-label="'+this.escapeExpression((a=null!=(a=i.readModeMultiFieldAria||(null!=e?e.readModeMultiFieldAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeMultiFieldAria","hash":{}}):a))+'" data-multi="true"\r\n'},"32":function(e,i,t,n){var a;return'              aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{}}):a))+'"\r\n        '},"34":function(e,i,t,n){var a;return'          <span class="csui-ellipsis-area"><span><span\r\n              class="cs-field-textarea-data">'+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{}}):a))+"</span></span>\r\n          </span>\r\n"},"36":function(e,i,t,n){var a;return'          <span class="placeholder" title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{}}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="control-area cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <textarea id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'" class="editable cs-no-resize" '+(null!=(a=i.if.call(e,null!=e?e.maxLength:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n              "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.program(5,n,0)}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.rows:a,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(9,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(11,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.ariaRequired:e,{"name":"if","hash":{},"fn":this.program(13,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(15,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(17,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(19,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(21,n,0),"inverse":this.noop}))?a:"")+">"+this.escapeExpression((s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"data","hash":{}}):s))+"</textarea>\r\n\r\n"+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":this.program(23,n,0),"inverse":this.program(25,n,0)}))?a:"")+'\r\n  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <button title="'+this.escapeExpression((s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"data","hash":{}}):s))+'"\r\n        '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(28,n,0),"inverse":this.noop}))?a:"")+"\r\n"+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(30,n,0),"inverse":this.program(32,n,0)}))?a:"")+">\r\n"+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.data !== '' && this.data !== null",{"name":"xif","hash":{},"fn":this.program(34,n,0),"inverse":this.program(36,n,0)}))?a:"")+'      </button>\r\n\r\n    </div>\r\n    <div class="icon-container">\r\n      <div title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'" aria-label="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'" role="button"\r\n           class="csui-icon-edit inline-edit-icon icon-edit"></div>\r\n    </div>\r\n    <div tabindex="0" class="cs-icon icon-expandArrowDown binf-hidden cs-icon-exp-col"\r\n         aria-label="'+this.escapeExpression((s=null!=(s=i.seeMore||(null!=e?e.seeMore:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"seeMore","hash":{}}):s))+'" role="button"></div>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_form_impl_fields_textareafield_textareafield",n),n}),csui.define("css!csui/controls/form/impl/fields/textareafield/textareafield",[],function(){}),csui.define("csui/controls/form/fields/textareafield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","csui/utils/base","csui/controls/form/pub.sub","hbs!csui/controls/form/impl/fields/textareafield/textareafield","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/textareafield/textareafield","csui/lib/binf/js/binf"],function(e,i,t,n,a,s,l,r,o){"use strict";return a.extend({"constructor":function(e){a.apply(this,arguments),this.listenTo(this.formView,"thumbnail:show:image",this.render)},"ui":{"writeField":".cs-field-write textarea","readField":".cs-field-read button","moreLink":".icon-expandArrowDown","lessLink":".icon-expandArrowUp","expColLink":".cs-icon-exp-col","ellipsisField":".csui-ellipsis-area"},"events":{"keydown @ui.writeField":"onKeyDown","keydown @ui.lessLink":"showLessTextFromKeyboard","keydown @ui.moreLink":"showMoreTextFromKeyboard","click @ui.moreLink":"showMoreText","click @ui.lessLink":"showLessText"},"className":"cs-formfield cs-textareafield","template":r,"templateHelpers":function(){var i="readonly"===this.mode,t=this.options.alpacaField&&this.options.alpacaField.schema&&this.options.alpacaField.schema.maxLength,n="",s="",l=!1,r="",d="",c="",u="";return l=this.options.alpacaField&&this.options.alpacaField.isRequired(),r=l?o.requiredField:"",this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(d=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),this.model.get("options")&&(n=this.model.get("options").label),s=this.model.get("data")?this.model.get("data"):o.noValue,c=i?e.str.sformat(o.fieldReadOnlyAria,n,s)+r:e.str.sformat(o.fieldEditAria,n,s)+r,u=i?e.str.sformat(o.fieldReadOnlyAria,d,s)+r:e.str.sformat(o.fieldEditAria,d,s)+r,e.extend(a.prototype.templateHelpers.apply(this),{"inputType":"text","idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"multiFieldLabel":d,"readModeAria":c,"readModeMultiFieldAria":u,"ariaRequired":l,"maxLength":t,"seeMore":o.seeMore})},"allowSaveOnEnter":function(){return!1},"onRender":function(){this._ele=this.$el.find(".cs-field-textarea-data"),this.model.attributes.data&&0!==this.model.attributes.data.trim().length&&this._applyEllipses(),this.ui.writeField.val(this.curVal)},"_applyEllipses":function(){if(this._ele&&this._ele.height()>0){var e=this._isTextOverflown(this._ele),i=this.$el.find("textarea").val(),t=i.indexOf(" ")>=0;0===(i.match(/\n/g)||[]).length?t?this.$el.parent().removeClass("cs-field-text-nospace"):this.$el.parent().addClass("cs-field-text-nospace"):this.$el.parent().removeClass("cs-field-text-nospace"),e?(this.ui.ellipsisField.parent().addClass("adjustWidth"),this.ui.ellipsisField.addClass("binf-line-clamp"),this.$el.closest(".binf-col-sm-9").addClass("cs-text-area-field-width"),this.ui.expColLink.removeClass("binf-hidden"),this.ui.expColLink.attr("title",o.seeMore).attr("aria-label",o.seeMore).attr("aria-expanded","false")):(this.ui.ellipsisField.addClass("no-ellipsis"),this.ui.ellipsisField.parent().removeClass("adjustWidth"))}else{var n=this;setTimeout(function(){n._applyEllipses()},50)}},"_isTextOverflown":function(e){return e.height()>this.ui.readField.height()},"showMoreText":function(e){e.preventDefault(),e.stopPropagation(),this.$el.closest(".cs-formfield.cs-textareafield").addClass("csui-textareafield-reset"),this.ui.readField.addClass("csui-textareafield-reset-button"),this.ui.expColLink.removeClass("binf-hidden").removeClass("icon-expandArrowDown").addClass("icon-expandArrowUp"),this.ui.ellipsisField.removeClass("binf-line-clamp"),this.ui.expColLink.attr("title",o.seeLess).attr("aria-label",o.seeLess).attr("aria-expanded","true")},"showLessTextFromKeyboard":function(e){13!==e.keyCode&&32!==e.keyCode||this.showLessText(e)},"showMoreTextFromKeyboard":function(e){13!==e.keyCode&&32!==e.keyCode||this.showMoreText(e)},"showLessText":function(e){e.preventDefault(),e.stopPropagation(),this.ui.expColLink.removeClass("icon-expandArrowUp").addClass("icon-expandArrowDown"),this.$el.closest(".cs-formfield.cs-textareafield").removeClass("csui-textareafield-reset"),this.ui.readField.removeClass("csui-textareafield-reset-button"),this.ui.expColLink.attr("title",o.seeMore).attr("aria-label",o.seeMore).attr("aria-expanded","false"),this.ui.ellipsisField.addClass("binf-line-clamp")},"onKeyDown":function(e){13===e.keyCode&&e.stopPropagation()},"getDisplayValue":function(){return this.getEditValue()},"_beforeTurnsToWriteMode":function(){this.$el.closest(".binf-col-sm-9").removeClass("cs-text-area-field-width")},"_beforeTurnsToReadMode":function(){this.$el.closest(".binf-col-sm-9").addClass("cs-text-area-field-width")}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuitextareafield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","csui/controls/form/fields/textareafield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r,o){return s.Fields.CsuiTextAreaField=s.Fields.TextAreaField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"textarea"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e,s=this.id,l=this.options?this.options.descriptionId:"",o=t(this.field[0]).find("label");o&&1==o.length&&(e=o.attr("for")+"Label",o.attr("id",e)),this.fieldView=new r({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":s}),"id":i.uniqueId(s),"alpacaField":this,"labelId":e,"descriptionId":l,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var d=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(d),this.region=new a.Region({"el":d}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("textarea",s.Fields.CsuiTextAreaField,"bootstrap-csui"),s.registerFieldClass("textarea",s.Fields.CsuiTextAreaField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiTextAreaField}),csui.define("hbs!csui/controls/form/impl/fields/selectfield/selectfielditem",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<a role="menuitem" tabindex="-1" data-cstabindex="-1" href="#">\r\n    <span class="cs-label">'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+"</span>\r\n</a>\r\n"}});return t.registerPartial("csui_controls_form_impl_fields_selectfield_selectfielditem",n),n}),csui.define("hbs!csui/controls/form/impl/fields/selectfield/selectfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){return' binf-dropdown-toggle"'},"3":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{}}):a))+'" '},"5":function(e,i,t,n){return"cs-icon-disabled "},"7":function(e,i,t,n){var a
;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{}}):a))+'"></div>\r\n      </div>\r\n'},"9":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=e?e.applyFlag:e,{"name":"if","hash":{},"fn":this.program(10,n,0),"inverse":this.noop}))?a:""},"10":function(e,i,t,n){var a;return'        <div class="icon-container binf-hidden">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{}}):a))+'" tabindex="0"\r\n               data-cstabindex="0"></div>\r\n        </div>\r\n'},"12":function(e,i,t,n){var a;return'            title="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+'"\r\n'},"14":function(e,i,t,n){var a;return'            title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{}}):a))+'"\r\n'},"16":function(e,i,t,n){return' aria-disabled="true" '},"18":function(e,i,t,n){var a;return"          <span>"+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+"</span>\r\n"},"20":function(e,i,t,n){var a;return'          <span class="placeholder">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{}}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner cs-drop-down">\r\n    <div id="'+this.escapeExpression((s=null!=(s=i.idValueDiv||(null!=e?e.idValueDiv:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"idValueDiv","hash":{}}):s))+'"></div>\r\n    <button id="'+this.escapeExpression((s=null!=(s=i.idBtn||(null!=e?e.idBtn:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"idBtn","hash":{}}):s))+'" aria-label="'+this.escapeExpression((s=null!=(s=i.writeModeAria||(null!=e?e.writeModeAria:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"writeModeAria","hash":{}}):s))+'" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'" type="button"\r\n            class="binf-btn binf-btn-default '+(null!=(a=i.unless.call(e,null!=e?e.disabled:e,{"name":"unless","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+'\r\n            data-binf-toggle="dropdown"\r\n            aria-haspopup="true"\r\n      '+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop}))?a:"")+'>\r\n      <span class="cs-label">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'</span>\r\n      <span class="cs-icon icon-caret-down '+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+'"></span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((s=null!=(s=i.idBtn||(null!=e?e.idBtn:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"idBtn","hash":{}}):s))+'"></ul>\r\n'+(null!=(a=i.if.call(e,null!=e?e.isNotWriteOnly:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.program(9,n,0)}))?a:"")+'  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <button aria-label="'+this.escapeExpression((s=null!=(s=i.readModeAria||(null!=e?e.readModeAria:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"readModeAria","hash":{}}):s))+'"\r\n'+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(12,n,0),"inverse":this.program(14,n,0)}))?a:"")+"          "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(16,n,0),"inverse":this.noop}))?a:"")+"\r\n        >\r\n"+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(18,n,0),"inverse":this.program(20,n,0)}))?a:"")+'      </button>\r\n    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_form_impl_fields_selectfield_selectfield",n),n}),csui.define("css!csui/controls/form/impl/fields/selectfield/selectfield",[],function(){}),csui.define("csui/controls/form/fields/selectfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.editable.behavior","csui/controls/form/impl/fields/csformfield.states.behavior","csui/controls/form/impl/array/csformarrayfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.states.behavior","csui/controls/form/pub.sub","csui/utils/base","hbs!csui/controls/form/impl/fields/selectfield/selectfielditem","hbs!csui/controls/form/impl/fields/selectfield/selectfield","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/selectfield/selectfield","csui/lib/binf/js/binf"],function(e,i,t,n,a,s,l,r,o,d,c,u,h){"use strict";var p=n.ItemView.extend({"tagName":"li","template":c,"events":{"click >a":"onClicked","keydown >a":"onKeyInView","keyup >a":"onKeyUp","mouseenter >a":"showTitle","mouseover >a":"showTitle"},"constructor":function(e){n.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render),this.dropdownMenuVisible=!1},"showTitle":function(e){e.preventDefault(),e.stopPropagation();var i=this.$(e.target).closest("a").width();this.$(e.target).width()>i&&this.$(e.target).attr("title",this.model.get("name"))},"activate":function(e){var i=e.charCode||e.which;this.triggerMethod("click:link",i)},"onClicked":function(e){e.preventDefault(),e.stopPropagation(),this.activate(e)},"onKeyInView":function(i){var t=i.charCode||i.which;13===t?(i.preventDefault(),i.stopPropagation(),this.onClicked(i)):27===t?(i.preventDefault(),i.stopPropagation()):32===t||9===t?(i.preventDefault(),i.stopPropagation(),setTimeout(e.bind(function(){this.onClicked(i)},this),200)):this.triggerMethod("dropdown:scroll",i)},"onKeyUp":function(e){27===(e.charCode||e.which)&&(this._parent.escapePressed=!0,e.preventDefault(),e.stopPropagation(),this.triggerMethod("keypress:escape"))}});return n.CompositeView.extend({"constructor":function(i){i.model.attributes.options.isMultiFieldItem?this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":l},"FormFieldStates":{"behaviorClass":r}},this.behaviors):this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":a},"FormFieldStates":{"behaviorClass":s}},this.behaviors),n.CompositeView.prototype.constructor.apply(this,arguments),this.model=new t.Model,this.options.selected?this._setSelection(this.options.selected):this.resetSelection(),this.listenTo(this.collection,"change",this._refreshSelection),this.listenTo(this.model,"change",this._updateSelection),this.listenTo(this.model,"change",this.render),this.listenTo(this,"dropdown:scroll",this._dropdownScroll),this.options.dataId||(this.options.dataId=this.options.id),this.mode=this.options.mode,this.mode=this.options.alpaca&&this.options.alpaca.schema.readonly?"readonly":"read",this.$el.addClass("readonly"===this.mode?"cs-formfield-readonly":""),this.curVal=this.model.clone(),this.oldVal=this.model.clone(),this.alpacaField=this.options.alpacaField,this.options.alpaca&&i.alpaca.options.setRequiredFieldsEditable&&"readonly"!==this.mode&&(this.mode="writeonly"),this.model.set("schema",{"readonly":"readonly"===this.mode},{"silent":!0})},"onChildviewDropdownScroll":function(e,i){this._dropdownScroll(i)},"_dropdownScroll":function(e){var t=[],n="",a=!1,s=[],l=[];"SelectFieldItemView"==e.constructor.name&&(e=arguments[1]),n=e.key,a=e.shiftKey,this.$el.find("li").each(function(e,i){var t="";(t=a?i.textContent.trim().charAt(0).toUpperCase():i.textContent.trim().charAt(0).toLowerCase())==n&&(s.push(i.textContent.trim()),l.push(e))});var r=this.$el.find("li.binf-active").text().trim();this.$el.find("li.binf-active").removeClass();var o=i.inArray(r,s);t=-1!=o?this.$el.find("li").eq(l[o+1]):this.$el.find("li").eq(l[0]),t.length>0&&(this.ui.dropdown.scrollTop(0),this.ui.dropdown.scrollTop(t.position().top),t.find("a").trigger("focus"),t.addClass("binf-active"),this.ui.dropdown.perfectScrollbar("update"))},"className":"cs-formfield cs-selectfield binf-dropdown","template":u,"templateHelpers":function(){var i,t,n,a=h.selectValueLabel,s="",l=(h.noValue,""),r="",o="readonly"===this.mode,d=!1,c="";d=this.options.alpacaField&&this.options.alpacaField.isRequired(),c=d?h.requiredField:"",this.alpacaField&&(n=this.options.model.get("options")?this.options.model.get("options").label:this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),this.options.model.get("data")&&this.options.model.get("data"),this.options.model&&(i=this.options.model.get("options"),t=this.options.model.get("data")),i&&i.label&&(a=h.selectValueLabel),this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(s=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),s&&(n=s);var u=""!==t&&null!==t&&this.options.hasValue,p=u?this.model.get("name"):h.noValue;l=o?e.str.sformat(h.fieldReadOnlyAria,n,p):e.str.sformat(h.fieldEditAria,n,p)+c,r=e.str.sformat(h.fieldReadOnlyAria,n,p)+c;var f=this.options.alpacaField?this.options.alpacaField.id:e.uniqueId("empty"),m=this.alpacaField?!!this.alpacaField.schema.disabled:this.options.alpaca.schema.disabled;return{"hasData":u,"isNotWriteOnly":"writeonly"!==this.mode,"mode":this.mode,"emptyLabel":m||o?h.noValueSet:a,"idBtn":f,"idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"idValueDiv":f+"ValueDiv","applyFlag":i.applyFlag,"isReadOnly":o,"noValue":h.noValue,"readModeAria":l,"writeModeAria":r,"isRequired":d,"disabled":m,"titleApplyAll":h.titleApplyAll}},"childView":p,"childViewContainer":"ul","ui":{"toggle":".binf-dropdown-toggle","dropdown":".binf-dropdown-menu","selectedLabel":".binf-dropdown-toggle >.cs-label","caret":".icon-caret-down","writeField":".cs-field-write button","readField":".cs-field-read button"},"events":{"keydown @ui.writeField":"onKeyInView","keyup @ui.writeField":"onKeyUp","shown.binf.dropdown":"onShowDropDown","show.binf.dropdown":"onBeforeShowDropDown","hidden.binf.dropdown":"onHideDropDown"},"setMode":function(e){this.mode=e,this.getStatesBehavior().state=void 0},"selectField":!0,"onRender":function(){this.ui.selectedLabel.text(this.model.get("title")),this.ui.toggle.off("click"),setTimeout(e.bind(function(){var e=i.Event("tab:content:field:changed");this.$el.trigger(e)},this),100),this.alpacaField&&this.alpacaField.setValue(this.model.id)},"onBeforeShowDropDown":function(){if(d.isMSBrowser()||d.isTouchBrowser()&&d.i18n&&d.i18n.settings.rtl){var e=this.$el.find(".cs-drop-down");d.adjustDropDownField(e,this.ui.dropdown,!0,this,this.hideDropdown,this.ui.dropdown)}},"handleToggle":function(){this.alpacaField&&this.alpacaField.options&&!this.alpacaField.options.isMultiFieldItem&&(this.isDropdownOpen()||(this._handleToggleEvent=!0,this.$el.find(".binf-dropdown-toggle").trigger("click")))},"onShowDropDown":function(){var i=this.$el.closest(".csui-scrollable-writemode");if(i&&!i.hasClass("csui-dropdown-open")&&i.addClass("csui-dropdown-open"),this.ui.dropdown.removeClass("dropup-menu"),this.ui.dropdown.css({"overflow":"hidden","max-height":"auto"}),this.ui.dropdown.perfectScrollbar({"suppressScrollX":!0}),!d.isMSBrowser()||!(d.isTouchBrowser()&&d.i18n&&d.i18n.settings.rtl)){var t=this.$el.find(".cs-drop-down");d.adjustDropDownField(t,this.ui.dropdown,!0,this,this.hideDropdown,this.ui.dropdown)}if(this.options.isDropDownOpen=!0,this._handleToggleEvent){var n=this.getEditableBehavior();this.ui.dropdown.on("focusout",e.bind(n.onFocusOutWrite,n))}this.getEditableBehavior().hideActions&&this.getEditableBehavior().hideActions();var a=this;setTimeout(function(){a.ui.dropdown.perfectScrollbar("update")},1)},"onHideDropDown":function(){this.ui.dropdown.off("focusout"),this.options.isDropDownOpen=!1;var e=this.$el.closest(".csui-scrollable-writemode");e&&e.hasClass("csui-dropdown-open")&&e.removeClass("csui-dropdown-open"),this.getStatesBehavior().isStateWrite()&&this.getStatesBehavior().hasWriteFocus()&&this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(),0!==this.$el.parents(".csui-multivalue-container").length||this.$el.find(".binf-dropdown-toggle")[0]==document.activeElement||this.escapePressed||this.getEditableBehavior().trySetValueAndLeaveEditMode(!0,!0),this.escapePressed=!1},"onKeyUp":function(e){e.charCode||e.which;if(27==e.keyCode&&"create"===this.options.mode){this.dropdownMenuVisible&&(e.preventDefault(),e.stopPropagation());var i=this.$el.find(".icon-container");i[0].classList.add("binf-hidden"),i.attr("data-cstabindex",-1),i.attr("tabindex",-1)}this.dropdownMenuVisible=!1},"onKeyInView":function(e){var i=e.charCode||e.which;27===i||9===i?this.isDropdownOpen()&&(this.dropdownMenuVisible=this.isDropdownOpen(),e.preventDefault(),e.stopPropagation(),this.hideDropdown(this)):this.trigger("dropdown:scroll",e)},"onChildviewKeypressEscape":function(e){this.isDropdownOpen()&&(this.hideDropdown(this),this.ui.toggle.trigger("focus"))},"onChildviewClickLink":function(e,i){if(this.getValue().id===e.model.get("id"))this.options.isDropDownOpen=!1,this.hideDropdown(this),this.ui.toggle.trigger("focus");else{if(this._setSelection(e.model),this.ui.writeField.trigger("focus"),this.alpacaField&&this.alpacaField.setValue(this.model.id),this.ui.writeField.trigger("change"),this.getValue().id===this.curVal.id&&this.getEditableBehavior()&&this.getEditableBehavior().hideActions){var t=t||arguments[0];this.getEditableBehavior().hideActions(t)}if(this.isDropdownOpen())this.options.isDropDownOpen=!0;else{this.options.isDropDownOpen=!1;var n=this.$el.closest(".csui-scrollable-writemode");n&&n.hasClass("csui-dropdown-open")&&n.removeClass("csui-dropdown-open"),this.$el.parents(".csui-normal-scrolling").css("overflow","auto")}}this.options.alpacaField&&this.options.alpacaField.refreshValidationState(!1)},"getDisplayValue":function(){return this.getValue().get("name")},"onChildviewClearActiveTab":function(e){this.children.each(function(e){e.$el.hasClass("binf-active")&&e.$el.removeClass("binf-active")})},"resetSelection":function(){this.model.set({"id":null,"name":"<"+h.selectFieldDefaultLabel+">","icon":""})},"_setSelection":function(e){var i=e.pick("id","name");this.options.model.attributes.data=i.id,this.model.set(i)},"_updateSelection":function(){this.ui.selectedLabel.text(this.model.get("name")),this.trigger("selection:changed"),this.options.hasValue=!0},"_refreshSelection":function(e){e.get("id")===this.model.get("id")&&this._setSelection(e)},"serializeData":function(){return e.defaults({"id":e.uniqueId()},this.model.toJSON())},"_raiseValueChanged":function(){var t={"fieldvalue":this.getValue().id,"fieldid":this.options.dataId,"fieldpath":this.options.path,"targetfieldpath":this.options.path,"fieldView":this};this.trigger("field:changed",t),o.trigger(this.options.dataId+"dependentattrchanged",this);var n=i.Event("field:changed");e.extend(n,t),this.$el.trigger(n)},"isReadyToSave":function(){return!i(document.activeElement).hasClass("csui-icon apply-all")&&i.contains(i(this.$el)[0],document.activeElement)},"isDropdownOpen":function(){return!this.ui.dropdown.is(":hidden")},"hideDropdown":function(e){if(e=e.originalEvent instanceof Event?this:e,e.isDropdownOpen()&&(e.ui.writeField.trigger("focus"),e.ui.toggle.binf_dropdown("toggle"),e.getEditableBehavior().showActions)){e.options.isDropDownOpen=!1;var i=e.$el.closest(".csui-scrollable-writemode");i&&i.hasClass("csui-dropdown-open")&&i.removeClass("csui-dropdown-open"),e.getEditableBehavior().showActions()}},"getEditValue":function(){return this.getValue()},"getOldValue":function(){return this.oldVal},"getValue":function(){return this.model},"setValue":function(e,i){this.oldVal=this.curVal,this.curVal=e,this._setSelection(e),!i&&this._raiseValueChanged()},"allowEditOnClickReadArea":function(){return!0},"allowEditOnEnter":function(){return!0},"allowSaveOnEnter":function(){return!0},"setStateRead":function(e){return this.curVal.id!==this.getValue().id&&(this._setSelection(this.curVal),this.alpacaField&&this.alpacaField.setValue(this.curVal.id),this.alpacaField&&this.alpacaField.validate()&&this.alpacaField.refreshValidationState(!1)),!1},"setStateWrite":function(){return!1},"trySetValue":function(){this._setSelection(this.getValue());var t=this.getValue().id!==this.curVal.id,n=t;return this.alpacaField&&(n=this.alpacaField.setValueAndValidate(this.model.id,n)),t?n?(this.curVal=this.getValue().clone(),this._raiseValueChanged()):this.alpacaField.schema.required&&!n?this.$el.trigger(i.Event("field:invalid")):this.alpacaField.schema.required||(this.curVal=this.getValue().clone(),this._raiseValueChanged()):(this.alpacaField&&this.alpacaField.schema&&this.alpacaField.schema.required&&!t&&this.$el.trigger(i.Event("field:invalid")),setTimeout(e.bind(function(){var e=i.Event("tab:content:field:changed");this.$el.trigger(e)},this),100)),n},"setFocus":function(){},"getEditableBehavior":function(){return this._behaviors[0]},"getStatesBehavior":function(){return this._behaviors[1]},"resetOldValueAfterCancel":function(){return!1}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuiselectfield",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/selectfield.view","csui/utils/types/date","i18n!csui/controls/form/impl/nls/lang","csui/lib/underscore.string"],function(e,i,t,n,a,s,l,r){"use strict";function o(i){e.each(i,function(e){var i,t=e.id;"string"==typeof t&&(i=d(t),i?e.name=i:(i=c(t))&&(e.name=i))})}function d(e){if(/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\dZ?$/.test(e))return l.formatExactDate(e)}function c(i){function t(i){return e.str.lpad(i,2,"0")}if(/^D\/\d\d\d\d\/\d+\/\d+:\d+:\d+:\d+$/.test(i)){var n=/^D\/(\d\d\d\d)\/(\d+)\/(\d+):(\d+):(\d+):(\d+)$/.exec(i),a=e.str.sformat("{0}-{1}-{2}T{3}:{4}:{5}",n[1],t(n[2]),t(n[3]),t(n[4]),t(n[5]),t(n[6]));return l.formatExactDate(a)}}return a.Fields.CsuiSelectField=a.Fields.SelectField.extend({"constructor":function(e,i,t,n,a,s,l){this.excludeNoneOption=void 0!==t.removeDefaultNone&&t.removeDefaultNone,this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"select"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var a=[],l=!1;this.options.optionLabels?(a=e.zip(this.schema.enum,this.options.optionLabels).map(function(e){return l=l||null===e[0]||""===e[0],{"id":e[0],"name":e[1]}}),o(a)):this.schema.enum?a=this.schema.enum.map(function(e){return l=l||null===e[0]||""===e[0],{"id":e,"name":e}}):this.options.dataSource&&(a=i.map(this.options.dataSource,function(e,i){return{"id":i,"name":e}})),l||this.excludeNoneOption||a.splice(0,0,{"id":null,"name":"<"+r.selectFieldDefaultLabel+">"});var d=new t.Collection(a),c={},u=!0,h="number"!==this.schema.type||!isNaN(this.data);null!==this.data&&""!==this.data&&h?c=new t.Model({"id":this.data,"name":d.get(this.data)&&d.get(this.data).get("name")}):this.excludeNoneOption?(c=new t.Model({"id":"create"===this.options.mode?d.models[0].attributes.id:null,"name":d.models[0].attributes.name}),u="create"===this.options.mode):c=new t.Model({"id":null,"name":"<"+r.selectFieldDefaultLabel+">"});var p,f=this.options?this.options.descriptionId:"",m=i(this.field[0]).find("label");m&&1==m.length&&(p=m.attr("for")+"Label",m.attr("id",p));var g=this.id;this.fieldView=new s({"model":new t.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":g}),"id":e.uniqueId(g),"alpacaField":this,"labelId":p,"descriptionId":f,"selected":c,"collection":d,"mode":this.options.mode,"path":this.path,"dataId":this.name,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema},"hasValue":u});var v=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(v),this.region=new n.Region({"el":v}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){"writeonly"!==this.fieldView.mode&&e instanceof Object&&null===e.id?this.setValue(e.id):this.setValue(e);var t=!0;return i&&(t=this.validate()),this.refreshValidationState(!1),t},"_validator":function(e){var i=this.getValue();e(this.schema.required&&""===i?{"status":!1,"message":"This field is required"}:{"status":!0})},"validate":function(){var i=this.base();return this.validation=e.omit(this.validation,"invalidValueOfEnum"),i},"setValue":function(e){null===e?this.base(""):this.base(e)},"getValue":function(){return this.base()},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),a.registerFieldClass("select",a.Fields.CsuiSelectField,"bootstrap-csui"),a.Fields.CsuiSelectField}),csui.define("hbs!csui/controls/form/impl/fields/radiofield/radiofield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n,a,s){var l,r;return'        <li>\r\n          <div class="cs-radio-item-container">\r\n          <label class="cs-label" for="w'+this.escapeExpression((r=null!=(r=i.radioId||(null!=e?e.radioId:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"radioId","hash":{}}):r))+'">'+this.escapeExpression((r=null!=(r=i.name||(null!=e?e.name:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"name","hash":{}}):r))+"\r\n            <input "+(null!=(l=i.if.call(e,null!=e?e.isReadOnly:e,{"name":"if","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop}))?l:"")+' type="radio" class="radio-item" name="w'+this.escapeExpression(this.lambda(null!=s[1]?s[1].radioGroupName:s[1],e))+'" id="w'+this.escapeExpression((r=null!=(r=i.radioId||(null!=e?e.radioId:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"radioId","hash":{}}):r))+'" value="'+this.escapeExpression((r=null!=(r=i.id||(null!=e?e.id:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"id","hash":{}}):r))+'"  '+this.escapeExpression((r=null!=(r=i.checked||(null!=e?e.checked:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"checked","hash":{}}):r))+'>\r\n            <span class="cs-radio-container"><span class="outer"><span class="inner"></span></span></span>\r\n          </label>\r\n          </div>          \r\n        </li>\r\n'},"2":function(e,i,t,n){return" readonly "},"4":function(e,i,t,n){return""},"6":function(e,i,t,n){return"binf-hidden"},"8":function(e,i,t,n,a,s){var l,r;return'        <li>\r\n          <div class="cs-radio-item-container">\r\n          <label class="cs-label" for="r'+this.escapeExpression((r=null!=(r=i.radioId||(null!=e?e.radioId:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"radioId","hash":{}}):r))+'">'+this.escapeExpression((r=null!=(r=i.name||(null!=e?e.name:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"name","hash":{}}):r))+"\r\n            <input "+(null!=(l=i.if.call(e,null!=e?e.isReadOnly:e,{"name":"if","hash":{},"fn":this.program(2,n,0,a,s),"inverse":this.noop}))?l:"")+' type="radio" class="radio-item" name="r'+this.escapeExpression(this.lambda(null!=s[1]?s[1].radioGroupName:s[1],e))+'" id="r'+this.escapeExpression((r=null!=(r=i.radioId||(null!=e?e.radioId:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"radioId","hash":{}}):r))+'" value="'+this.escapeExpression((r=null!=(r=i.id||(null!=e?e.id:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"id","hash":{}}):r))+'" '+this.escapeExpression((r=null!=(r=i.checked||(null!=e?e.checked:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"checked","hash":{}}):r))+'>\r\n            <span class="cs-radio-container"><span class="outer"><span class="inner"></span></span></span>\r\n          </label>\r\n          </div>\r\n        </li>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n,a,s){var l,r;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <ul>\r\n'+(null!=(l=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(1,n,0,a,s),"inverse":this.noop}))?l:"")+'    </ul>\r\n    <span class="validation-error-message '+(null!=(l=i.if.call(e,null!=e?e.validationErrorMsg:e,{"name":"if","hash":{},"fn":this.program(4,n,0,a,s),"inverse":this.program(6,n,0,a,s)}))?l:"")+'">'+this.escapeExpression((r=null!=(r=i.validationErrorMsg||(null!=e?e.validationErrorMsg:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"validationErrorMsg","hash":{}}):r))+'</span>\r\n  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <ul>\r\n'+(null!=(l=i.each.call(e,null!=e?e.items:e,{"name":"each","hash":{},"fn":this.program(8,n,0,a,s),"inverse":this.noop}))?l:"")+"    </ul>    \r\n  </div>\r\n</div>\r\n"},"useDepths":!0});return t.registerPartial("csui_controls_form_impl_fields_radiofield_radiofield",n),n}),csui.define("css!csui/controls/form/impl/fields/radiofield/radiofield",[],function(){}),csui.define("csui/controls/form/fields/radiofield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","csui/controls/form/fields/base/csformfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.states.behavior","csui/controls/form/fields/base/csformfield.states.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/form/impl/fields/radiofield/radiofield","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/radiofield/radiofield"],function(e,i,t,n,a,s,l,r,o,d,c,u){"use strict";return a.extend({"ui":{"writeField":".cs-field-write","readField":".cs-field-read","iconContainer":".cs-radio-container"},"events":{"focusout":"onFocusOutWriteArea",'keyup input[type="radio"]':"focusElement","click @ui.iconContainer":"clickRadio",'change input[type="radio"]':"onSelectionChange",'click input[type="radio"]':"updateWriteField"},"constructor":function(i){a.prototype.constructor.apply(this,arguments),i.model.attributes.options&&(i.model.attributes.options.isMultiFieldItem?this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":l},"FormFieldStates":{"behaviorClass":r}},this.behaviors):this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":s},"FormFieldStates":{"behaviorClass":o}},this.behaviors)),this.model=new t.Model,this.options.selected?this._setSelection(this.options.selected):this.resetSelection(),this.listenTo(this.model,"change",this._raiseValueChanged),this.options.dataId||(this.options.dataId=this.options.id),this.mode=this.options.mode,this.mode=this.options.alpaca&&this.options.alpaca.schema.readonly?"readonly":"read",this.$el.addClass("readonly"===this.mode?"cs-formfield-readonly":""),this.curVal=this.oldVal=this.model.clone(),this.alpacaField=this.options.alpacaField,this.options.alpaca&&(!i.alpaca.options.setRequiredFieldsEditable&&i.model.attributes.options.isMultiFieldItem||"readonly"===this.mode||(this.mode="writeonly"))},"className":"cs-formfield cs-radio-group","template":c,"templateHelpers":function(){var i,t,n;this.options.model&&(i=this.options.model.get("options"),t=this.options.model.get("data"));var a=this.collection.map(function(e){return e.attributes});e.each(a,function(i){t===i.id&&(i.checked="checked='checked''"),e.isString(i.category)&&/Error/.test(i.category)&&(i.class="radio-item-error",n||(n=u.radioFieldValidationErrorInvalidValue))});var s=this.options.dataId,l=this.options.alpacaField?this.options.alpacaField.id:e.uniqueId("empty");return{"items":a,"radioGroupName":s,"hasData":""!==t&&null!==t&&this.options.hasValue,"writeonlyMode":"writeonly"===this.mode,"mode":this.mode,"emptyLabel":u.noValueSet,"idBtn":l,"idBtnLabel":this.options.labelId?this.options.labelId:"","idValueDiv":l+"ValueDiv","applyFlag":i.applyFlag,"isReadOnly":"readonly"===this.mode,"validationErrorMsg":n}},"onRender":function(){this.alpacaField&&this.alpacaField.setValue(this.model.get("data"))},"clickRadio":function(e){if("readonly"===this.mode)return e.preventDefault(),void e.stopPropagation();this.updateWriteField(e);var t=i(e.target).closest(".cs-radio-item-container").find("input");t.trigger("click",function(){t.trigger("focus")}),this.loadActiveRadioElement(),this.trySetValue()},"onSelectionChange":function(e){if("readonly"===this.mode)return e.preventDefault(),void e.stopPropagation();this.loadActiveRadioElement(),this.trySetValue()},"updateWriteField":function(e){this.ui.readField.has(e.target)&&this.ui.writeField.find("#w"+i(e.target).closest(".cs-radio-item-container").find("input").attr("id").substring(1)).prop("checked",!0)},"loadActiveRadioElement":function(){i(".cs-active-radio").removeClass("cs-active-radio"),i(this.$el).find('input[type="radio"]').each(function(){i(this).is(":focus")&&i(this).parent().parent().parent().addClass("cs-active-radio")})},"trySetValue":function(){var e=this.getEditValue(),i=!0;this.isReadyToSave()&&(i=this.setValue(e,!0)),this._setSelection(e),this._updateSelection();var t=this.collection.where({"id":this.model.get("data")});return t.length>0&&this.ui.writeField.find("#w"+t[0].get("radioId")).prop("checked",!0),i},"getEditValue":function(){if(this.$el.find("input:checked").length>0){var i=this.$el.find("input:checked").get(0).value;if(i&&""!==i){var t=e.find(this.collection.models,function(e){if(e.id.toString()===i)return e}),n=t.get("category"),a=!1;return a||(a=e.isString(n)&&/Error/.test(n)),a?this.$el.find(".validation-error-message").removeClass("binf-hidden"):this.$el.find(".validation-error-message").addClass("binf-hidden"),t.id}}return this.getValue().id},"_setSelection":function(e){var i;i=e instanceof t.Model?e.pick("id").id:e,this.options.model.attributes.data=i,this.model.set("data",i)},"_updateSelection":function(){var e=this.collection.where({"id":this.model.get("data")});e.length>0&&(this.ui.readField.find("#r"+e[0].get("radioId")).prop("checked",!0),this.options.hasValue=!0)},"getDisplayValue":function(){var i=e.findWhere(this.collection.models,{"id":this.model.get("data")});return i?i.get("name"):""},"serializeData":function(){return e.defaults({"id":e.uniqueId(),"name":this.getDisplayValue()},this.model.toJSON())},"_raiseValueChanged":function(){var t={"fieldvalue":this.getValue().get("data"),"fieldid":this.options.dataId,"fieldpath":this.options.path,"targetfieldpath":this.options.path};this.trigger("field:changed",t);var n=i.Event("field:changed");e.extend(n,t),this.$el.trigger(n)},"getOldValue":function(){return this.oldVal.get("data")},"setValue":function(e,t,n){var a=!0;if(t&&this.alpacaField&&(a=this.alpacaField.setValueAndValidate(e,t)),a)this.$el.removeClass("cs-formfield-invalid"),e!==this.curVal&&(this.curVal=e),this.model.set("data",e,{"silent":!!n}),this.$el.trigger(i.Event("field:valid"),this);else{this.$el.addClass("cs-formfield-invalid");var s=i.Event("field:invalid");this.$el.trigger(s)}return a},"getValue":function(){return this.model},"onFocusOutWriteArea":function(e){
e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),i(".cs-active-radio").removeClass("cs-active-radio"),this.getEditableBehavior().onFocusOutWrite(e)},"focusElement":function(e){e.preventDefault(),e.stopPropagation(),i(".cs-active-radio").removeClass("cs-active-radio"),i(e.target).parent().parent().parent().addClass("cs-active-radio")}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuiradiofield",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/radiofield.view","i18n!csui/controls/form/impl/nls/lang"],function(e,i,t,n,a,s,l){"use strict";return a.Fields.CsuiRadioField=a.Fields.RadioField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"radio"},"setup":function(){var e=this.data;this.base(),e!==this.data&&this.isRequired()&&!0===this.options.removeDefaultNone&&(this.data=e)},"postRender":function(e){this.base(e),this.showField(),this.removeExtraDivs()},"removeExtraDivs":function(){this.fieldView.$el.closest(".binf-col-sm-9").siblings().each(function(i,t){"DIV"===this.tagName&&"binf-col-sm-9"===this.className&&e.isNull(t.firstChild)&&("function"==typeof t.remove?t.remove():t.parentNode.removeChild(t))})},"showField":function(){var a=[];this.options.optionLabels?a=e.zip(this.schema.enum,this.options.optionLabels,e.pluck(this.options.enum,"category")).map(function(i){return{"id":i[0],"name":i[1],"category":i[2],"radioId":e.uniqueId("radio")}}):this.schema.enum&&(a=this.schema.enum.map(function(i){return{"id":i,"name":i,"radioId":e.uniqueId("radio")}}));var r=new t.Collection(a),o={};o=null!==this.data&&""!==this.data?new t.Model({"id":this.data,"name":r.get(this.data)&&r.get(this.data).get("name")}):new t.Model({"id":null,"name":"<"+l.selectFieldDefaultLabel+">"});var d,c=i(this.field[0]).find("label");c&&1===c.length&&(d=c.attr("for")+"Label",c.attr("id",d));var u=this.id;this.fieldView=new s({"model":new t.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":u}),"id":e.uniqueId(u),"alpacaField":this,"labelId":d,"selected":o,"collection":r,"mode":this.options.mode,"path":this.path,"dataId":this.name,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema},"hasValue":!0});var h=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(h),this.region=new n.Region({"el":h}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"_validator":function(e){var i=this.getValue();e(this.schema.required&&""===i?{"status":!1,"message":"This field is required"}:{"status":!0})},"validate":function(){var i=this.base();return this.validation=e.omit(this.validation,"invalidValueOfEnum"),i},"setValue":function(e){null===e?this.base(""):this.base(e)},"getValue":function(){return this.data},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),a.registerFieldClass("radio",a.Fields.CsuiRadioField,"bootstrap-csui"),a.Fields.CsuiRadioField}),csui.define("csui/controls/form/fields/alpaca/alpcsuiintegerfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/utils/types/number","csui/models/form","csui/controls/form/fields/textfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r,o,d){return s.Fields.CsuiIntegerField=s.Fields.IntegerField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"text"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e,s=this.id,r=this.options?this.options.descriptionId:"",d=t(this.field[0]).find("label");d&&1==d.length&&(e=d.attr("for")+"Label",d.attr("id",e)),this.schema.maximum=this.schema.maximum&&this.schema.maximum<l.MAX_SAFE_INTEGER?this.schema.maximum:l.MAX_SAFE_INTEGER,this.schema.minimum=this.schema.minimum&&this.schema.minimum>l.MIN_SAFE_INTEGER?this.schema.minimum:l.MIN_SAFE_INTEGER,this.fieldView=new o({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":s}),"id":i.uniqueId(s),"alpacaField":this,"labelId":e,"descriptionId":r,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var c=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(c),this.region=new a.Region({"el":c}),this.region.show(this.fieldView)},"getValue":function(){var e=this._getControlVal(!0);return null===e||""===e?null:parseInt(e)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"handleValidate":function(){var e=this.base();if(!e){var i=this.validation;if(""!==this.fieldView.ui.writeField.val())return i.notOptional.status=!0,i.notOptional.message="",e;for(var t in i)!1===i[t].status&&"notOptional"!==t&&(i[t].status=!0,i[t].message="")}return e},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("integer",s.Fields.CsuiIntegerField,"bootstrap-csui"),s.registerFieldClass("integer",s.Fields.CsuiIntegerField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiIntegerField}),csui.define("hbs!csui/controls/form/impl/fields/passwordfield/passwordfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return' placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+'"'},"5":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{}}):a))+'" '},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="control-area cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <input type="password" title="'+this.escapeExpression((s=null!=(s=i.title||(null!=e?e.title:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'" class="cs-formfield cs-passwordfield-input\r\n    cs-passwordfield-write"\r\n      '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop}))?a:"")+' id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'"\r\n      '+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+'>\r\n    </input>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((s=null!=(s=i.cancel||(null!=e?e.cancel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cancel","hash":{}}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <input type="password" title="'+this.escapeExpression((s=null!=(s=i.title||(null!=e?e.title:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'" class="cs-formfield cs-passwordfield-input\r\n    cs-passwordfield-read"\r\n      '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop}))?a:"")+' >\r\n    </input>\r\n\r\n    <div class="icon-container">\r\n      <div title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'" aria-label="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'" role="button"\r\n           class="csui-icon-edit inline-edit-icon icon-edit"></div>\r\n    </div>\r\n  </div>\r\n</div>'}});return t.registerPartial("csui_controls_form_impl_fields_passwordfield_passwordfield",n),n}),csui.define("csui/controls/form/impl/fields/passwordfield/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/form/impl/fields/passwordfield/nls/root/lang",{"title":"Enter password"}),csui.define("css!csui/controls/form/impl/fields/passwordfield/passwordfield",[],function(){}),csui.define("csui/controls/form/fields/passwordfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","hbs!csui/controls/form/impl/fields/passwordfield/passwordfield","i18n!csui/controls/form/impl/fields/passwordfield/nls/lang","css!csui/controls/form/impl/fields/passwordfield/passwordfield"],function(e,i,t,n,a,s,l){"use strict";return a.extend({"constructor":function(e){a.apply(this,arguments)},"className":"cs-formfield cs-passwordfield","template":s,"templateHelpers":function(){return e.extend(a.prototype.templateHelpers.apply(this),{"inputType":"password","title":l.title,"idBtnDescription":this.options.descriptionId})}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuipasswordfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/utils/base","csui/controls/form/fields/passwordfield.view","i18n!csui/controls/form/impl/fields/passwordfield/nls/lang"],function(e,i,t,n,a,s,l,r,o){return s.Fields.CsuiPasswordField=s.Fields.PasswordField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"password"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e,s=this.id,l=this.options?this.options.descriptionId:"",o=t(this.field[0]).find("label");o&&1==o.length&&(e=o.attr("for")+"Label",o.attr("id",e)),this.fieldView=new r({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":s}),"id":i.uniqueId(s),"alpacaField":this,"labelId":e,"descriptionId":l,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var d=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(d),this.region=new a.Region({"el":d}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("password",s.Fields.CsuiPasswordField),s.registerDefaultFormatFieldMapping("password","password"),t.alpaca.Fields.CsuiPasswordField}),csui.define("csui/controls/form/fields/alpaca/alpcsuiurlfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","csui/controls/form/fields/textfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r,o){return s.Fields.CsuiUrlField=s.Fields.URLField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"url"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e=this.id;this.fieldView=new r({"context":this.connector.config.context,"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":e}),"id":i.uniqueId(e),"alpacaField":this,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var s=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(s),this.region=new a.Region({"el":s}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"handleValidate":function(){var e=this.base();if(!e){var i=this.validation;if(this.fieldView.cancelClicked||this.fieldView.getEditableBehavior().escapePressed)return i.invalidPattern.status=!0,i.invalidPattern.message="",!0}return e},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("url",s.Fields.CsuiUrlField,"bootstrap-csui"),s.registerFieldClass("url",s.Fields.CsuiUrlField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiUrlField}),csui.define("csui/controls/form/fields/alpaca/alpcsuiarrayfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/jsonpath","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","csui/controls/form/fields/textfield.view","csui/utils/base","csui/lib/jsonpath","i18n!csui/controls/form/impl/nls/lang","csui/controls/form/pub.sub","i18n"],function(e,i,t,n,a,s,l,r,o,d,c,u,h,p){return l.Fields.CsuiArrayField=l.Fields.ArrayField.extend({"constructor":function(e,t,n,a,s,l,r){if(t||(t=new Array(a.maxItems)),i.has(a.items,"properties")){var o=!1;i.each(a.items.properties,function(e){i.has(e,"readonly")&&(o=e.readonly)}),o&&(a.readonly=!0)}a.required&&i.has(a,"items")&&(a.items.required=!0),a.readonly&&i.has(a,"items")&&(a.items.readonly=!0),a.disabled&&i.has(a,"items")&&(a.items.disabled=!0),this.formView=l.config.formView,this.formView.listenTo(this.formView,"request:completed",i.bind(function(){this.formView&&this.propagatedEvent&&this._doEditActions(this.propagatedEvent)},this)),this.base(e,t,n,a,s,l,r),this.tabContentSelectors="input, button:not(:disabled), textarea, .icon-date_picker",this.tabableRegions=[],this.tabableElements=[],this.currentTabPosition=0,this.isWriteMode=!1,this.turnToReadMode=!0},"addItem":function(e,t,n,a,s){if(this.options.prevChildData||(this.options.prevChildData=!!this.children&&this.children.slice()),this.options.isSetType&&(this.addItemCount=this.addItemCount?this.addItemCount+1:1),this.options.isBlockModified=!0,this.options.isSetType){a=this.parent.options.defaultData?JSON.parse(JSON.stringify(this.parent.options.defaultData[this.name])):"";var l=c(a,"$..[?(@.toolbarSticky===true)]");i.each(l,function(e){i.extend(e,{"actionbar":{"actions":[{"action":"remove","enabled":!0,"iconClass":"csui-icon circle_delete_grey csui-array-icon-delete-"+e.uniqueId},{"action":"add","enabled":!0,"iconClass":"csui-icon circle_add_grey csui-array-icon-add-"+e.uniqueId},{"action":"up","enabled":!1},{"action":"down","enabled":!1}]}})})}else this.children.length>0&&1===this.field.parents(".cs-form-set-container .csui-scrollablecols").length&&this.adjustPartiallyVisibleElement();this.options&&this.options.descriptionId&&(n=n||{},n.descriptionId=this.options.descriptionId),this.base(e,t,n,a,i.bind(function(){"create"===this.options.mode&&this._raiseValueChanged(this.getValue(),this.name,this.path,this.getValue(),this.name,this.path),s(),this.options.isSetType&&(this.parent.restructureSetContainer(this.$(this.field[0]).find(".cs-form-set-container"),this.parent,e),this._hideSetActionIcon(),this._showItemsInWriteMode(e,this.parent.options.isSetType),this.options.isSetType&&this.options.rows_to_display&&this.updateShowMoreIndexes(this.$(this.field[0]).find(".cs-form-set-container")),n.isArraySchemaChanged=!0)},this)),this.options.isSetType||(this._showItemsInWriteMode(e),n.isArraySchemaChanged=!0),this.children[0]&&this.children[0].parent.parent&&this.children[0].parent.parent.options.isSetType||this.parent.parent&&this.parent.parent.options.isSetType?this.showApplyAll(!0):this.showApplyAll(!1)},"removeItem":function(e,t){this.options.prevChildData||(this.options.prevChildData=!!this.children&&this.children.slice()),this.options.isSetType&&(this.deletedItemCount=this.deletedItemCount?this.deletedItemCount+1:1),this.children.length>0?"tkl"===this.children[0].type?this.children[e].fieldView.changeChildrenValues(this.children[e].fieldView.children):this.children[e].fieldView&&this.children[e].fieldView.getEditableBehavior().changeChildrenValues(this.childRelations):this.children.length>0&&1===this.field.parents(".cs-form-set-container .csui-scrollablecols").length&&this.adjustPartiallyVisibleElement(),h.tklHelpers&&h.tklHelpers.viewsInWriteMode.length&&h.tklHelpers.viewsInWriteMode.splice(h.tklHelpers.viewsInWriteMode.indexOf(this.children[e].fieldView),1),this.base(e,i.bind(function(){"create"===this.options.mode&&this._raiseValueChanged(this.getValue(),this.name,this.path,this.getValue(),this.name,this.path);var e=void 0!==this.view.field.schema.items.minItems?this.view.field.schema.items.minItems:1;this.getFieldEl().find(".cs-pull-left .cs-field-write").length===e&&"otcs_node_picker"===this.options.fields.item.type&&this._raiseValueChanged(this.getValue(),this.name,this.path,this.getValue(),this.name,this.path),t&&t()},this)),this.parent.options&&this.parent.options.isSetType&&(this.parent.restructureSetContainer(this.$(this.field[0]).find(".cs-form-set-container"),this.parent),this._hideSetActionIcon());var n=this.container.parent().find(".cs-form-set-container-"+this.propertyId)[0].children,a=e===n.length?e-1:e;this._showItemsInWriteMode(a,this.parent.options.isSetType||this.parent.options.isMultiFieldItem),this.options.isSetType&&this.options.rows_to_display&&this.updateShowMoreIndexes(this.$(this.field[0]).find(".cs-form-set-container")),this.options.isArraySchemaChanged=!0,this.children[0]&&this.children[0].parent.parent&&this.children[0].parent.parent.options.isSetType||this.parent.parent&&this.parent.parent.options.isSetType?(this.showApplyAll(!0),this.children[e-1]&&this.children[e-1].field.closest(".cs-array").hasClass("alpaca-container-item-last")&&(this.$(this.children[e-1].getFieldEl().find(".cs-field-write-inner:first input")).length>0?this.$(this.children[e-1].getFieldEl().find(".cs-field-write-inner:first input")).trigger("focus"):this.$(this.children[e-1].getFieldEl().find(".cs-field-write-inner:first").children().first()).trigger("focus"))):this.showApplyAll(!1)},"adjustPartiallyVisibleElement":function(){var e,i,t=p&&p.settings.rtl,n=this.field.find(".cs-formfield").first(),a=n.parents(".csui-scrollablecols").parents(".cs-form-set-container").find(".ps-container.ps-active-x"),s=n.offset().left,l=n.parents(".csui-scrollablecols").siblings(".csui-lockedcols").find(".csui-shadowleft-container"),r=l.offset().left;if(t){var o=r+l.outerWidth();i=s+n.outerWidth()-o}else i=r-s;i>0&&(t?(e=a.scrollLeftRtl(),a.scrollLeftRtl(e+i)):(e=a.scrollLeft(),a.scrollLeft(e-i)))},"postRender":function(e){if(this.base(e),this.options&&this.options.descriptionId){this.container.find(".cs-field-write-inner button:not(:disabled), .cs-field-write-inner input, .cs-field-write-inner textarea").attr("aria-describedby",this.options.descriptionId)}if(this.$=t,this.field.on("field:changed",i.bind(this._onFieldChanged,this)),this.container.on("click",i.bind(this._doEditActions,this)),this.container.on("mouseenter",i.bind(this._mouseInArrayBlock,this)),this.container.on("mouseleave",i.bind(this._mouseOutArrayBlock,this)),this.container.parent().on("focusout",i.bind(this._mouseOutArrayBlock,this)),this.container.on("focusin",i.bind(this._hideApplyAll,this)),this.container.find(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),this.container.find(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden"),this.container.find(".csui-icon.apply-all.block").on("click",i.bind(this.onClickApplyAll,this)),this.container.find(".csui-icon.apply-all.block").on("keypress",i.bind(this.onClickApplyAll,this)),!this.parent.parent||"create"===this.options.mode&&this.parent.parent?(this.registered=!0,this._registerBulkSubmitAction()):this.parent.parent&&void 0===this.parent.parent.options.isSetType?this._registerBulkSubmitAction():this.parent.parent&&!0===this.parent.parent.options.isSetType&&this.parent.options.isMultiField&&(this.registered=!0,this._registerBulkSubmitAction()),this.schema.required){var n=this.getFieldEl().find("label.alpaca-container-label");t('<span class="alpaca-icon-required binf-glyphicon binf-glyphicon-star"></span>').prependTo(n)}if(this.options.setRequiredFieldsEditable&&this.getFieldEl().find(".cs-pull-right").removeClass("binf-hidden"),this.options.isSetType){0===this.getFieldEl().find(".cs-pull-left .cs-field-write").length&&(this.getFieldEl().find(".cs-pull-right .circle_add_grey").parent().addClass("binf-hidden"),this.getFieldEl().find(".cs-pull-right .circle_delete_grey").parent().addClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit").addClass("binf-hidden"))}else this.getFieldEl().find(".cs-array").addClass("cs-form-multi-action-container");this.tabableRegions.push(this.container);var a=this;i.each(this.container.find(this.tabContentSelectors),function(e){a.tabableElements.push(e)}),"create"!==this.options.mode&&this.container.on("focusin",function(){a.field.find(".csui-array-bulk-edit").removeClass("binf-hidden")}),this.field.parent().addClass("csui-field-"+this.getFieldType())},"_showActionIcons":function(e){for(var i=e.currentTarget.parentElement.children,t=0;t<i.length;t++)i[t].className.indexOf("cs-pull-right")>=0&&(this.$(i[t]).find(".circle_add_grey").parent().hasClass("binf-hidden")&&this.$(i[t]).find(".circle_add_grey").parent().removeClass("binf-hidden"),this.$(i[t]).find(".circle_delete_grey").parent().hasClass("binf-hidden")&&this.$(i[t]).find(".circle_delete_grey").parent().removeClass("binf-hidden"))},"_showActionIconsForSets":function(e){for(var i=e.currentTarget.parentElement,t=e.currentTarget.parentElement.children,n=0;n<t.length;n++)t[n].className.indexOf("cs-pull-right")>=0&&(this.$(t[n]).find(".circle_add_grey").parent().hasClass("binf-hidden")&&this.$(t[n]).find(".circle_add_grey").parent().removeClass("binf-hidden"),this.$(t[n]).find(".circle_delete_grey").parent().hasClass("binf-hidden")&&this.$(t[n]).find(".circle_delete_grey").parent().removeClass("binf-hidden"),this.options.isSetType&&!i.classList.contains("cs-form-multi-action-container")&&(this.$(t[n]).find(".circle_add_grey").parent().hasClass("alpaca-button-disabled")&&this.$(t[n]).find(".circle_delete_grey").parent().hasClass("alpaca-button-disabled")||this.$(t[n]).addClass("csui-set-action-bar")))},"_hideActionIcons":function(e){if(0===this.$(e.currentTarget).find(document.activeElement).length)for(var i=e.currentTarget.parentElement.children,t=0;t<i.length;t++)i[t].className.indexOf("cs-pull-right")>=0&&(this.$(i[t]).find(".circle_add_grey").parent().hasClass("binf-hidden")||this.$(i[t]).find(".circle_add_grey").parent().addClass("binf-hidden"),this.$(i[t]).find(".circle_delete_grey").parent().hasClass("binf-hidden")||this.$(i[t]).find(".circle_delete_grey").parent().addClass("binf-hidden"),this.$(i[t]).removeClass("csui-set-action-bar"))},"_hideActions":function(e){0===this.$(document.activeElement).parent().closest(".cs-pull-left").siblings(".cs-pull-right").find(this.$(e.target).closest(".cs-pull-right").find(".circle_add_grey")).length&&this.$(e.target).closest(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),0===this.$(document.activeElement).parent().closest(".cs-pull-left").siblings(".cs-pull-right").find(this.$(e.target).closest(".cs-pull-right").find(".circle_delete_grey")).length&&this.$(e.target).closest(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden")},"onShow":function(e){if("create"===this.options.mode){var n=this.getFieldEl().find(".cs-form-set-container").parents(".cs-form-set-container");if(this.options.isSetType&&0===n.length&&(n=this.getFieldEl().find(".cs-form-set-container")),this.options.isSetType&&void 0===this.data[0]&&(t(this.domEl).find(".cs-pull-left").addClass("csui-emptyset"),t(this.domEl).find(".cs-pull-right").removeClass("cs-pull-right")),n.length>0)n.find(".cs-array >.cs-pull-left").on("mouseenter",i.bind(this._showActionIconsForSets,this)),n.find(".cs-array >.cs-pull-left").on("mouseleave",i.bind(this._hideActionIcons,this)),n.find(".cs-array >.cs-pull-right").on("mouseenter",i.bind(this._showActionIconsForSets,this)),n.find(".cs-array >.cs-pull-right").on("mouseleave",i.bind(this._hideActions,this));else{var a=this.getFieldEl().find(".cs-form-set-container");a.length>0&&(a.find(".cs-array >.cs-pull-right").on("mouseenter",i.bind(this._showActionIcons,this)),a.find(".cs-array >.cs-pull-right").on("mouseleave",i.bind(this._hideActions,this)))}}"update"===this.options.mode&&this.options.isSetType&&void 0===this.data[0]&&t(this.domEl).find(".cs-pull-left").addClass("csui-emptyset")},"_registerBulkSubmitAction":function(){var e=this.container.parent(),n=this;n.focusedOnDocument=!1,e.off("keydown").off("focusout").on("focusout",function(a){t(a.relatedTarget).hasClass("csui-bulk-edit-cancel")||t(a.target).hasClass("csui-set-show-more-icon")||t(a.relatedTarget).hasClass("csui-set-show-more-icon")||n.isRelatedFieldInFocus(a.relatedTarget)||setTimeout(function(){if(0===e.find(":focus").length&&0===e.find(document.activeElement).length)if(n.focusedOnDocument=!!document.activeElement&&("BODY"===document.activeElement.tagName||"DIV"===document.activeElement.tagName),n.getFieldEl().find(".cs-pull-left .cs-field-write:not(.csui-unedited)").is(":visible")){var a=n.getFieldEl().find(".cs-formfield.cs-booleanfield .cs-field-write:not(.csui-unedited)");if(a.length>0&&a.addClass("csui-unedited"),n.children.length>0&&"tkl"===n.children[0].type){if(h.tklHelpers){for(var s=!1,l=h.tklHelpers.viewsInWriteMode.length-1;!s&&l>=0;l--)s=h.tklHelpers.viewsInWriteMode[l].getEditableBehavior().mouseDownCancel;s||n._doBulkSubmitActionTKL()}}else n._doBulkSubmitAction();"create"===n.options.mode&&(n.hideApplyAll(n.getFieldEl()),n._hideInlineAddIcon(),n._hideInlineDeleteIcon())}else 0!==n.view.field.schema.items.minItems||i.isEqual(n.getPreviousData(),n.getValue())?n.getFieldEl().find(".cs-pull-left .cs-field-write").length===n.getFieldEl().find(".cs-formfield.cs-booleanfield .cs-field-write").length&&(0===e.find(".csui-bulk-edit-cancel.binf-hidden").length?(n._showItemsInReadMode(),n._showBulkEditAction(),n._hideInlineAddIcon(),n._hideInlineDeleteIcon()):"create"===n.options.mode&&(n.hideApplyAll(n.getFieldEl()),n._hideInlineAddIcon(),n._hideInlineDeleteIcon())):n.cancelClicked||n._doBulkSubmitAction(!0);var r=n.$(".cs-form-set-container").find(".binf-popover .csui-colout-formitems"),o=r.parents(".cs-form-set-container");r.find(document.activeElement).length>0&&o.trigger("focus"),("BODY"===document.activeElement.tagName||document.activeElement!==o[0]&&(o.find(document.activeElement).hasClass("csui-colout-icon")&&!t(document.activeElement).data("binf.popover")||o.find(document.activeElement).length<1))&&n.hidePopover()},50)}).on("keydown",t,function(e){var i,a=function(e){if("otcs_user_picker"===n.schema.items.type||"otcs_member_picker"===n.schema.items.type){var i=n.getFieldEl().find(".cs-pull-left .cs-field-read");e.arrayFieldIndex=t(i).index(t(e.target).closest(".cs-field-read"))}};if(!n.options.readonly)if(27===e.keyCode){if("create"===n.options.mode)return!1;!t(document.activeElement).hasClass("cs-search")||"otcs_member_picker"!==n.schema.items.type&&"otcs_user_picker"!==n.schema.items.type?n._changeBlockToWriteMode(e,!1):n._changeBlockToWriteMode(e,!0)}else if(13===e.keyCode){if(n.turnToReadMode=!0,t(document.activeElement).is(".binf-btn:not(.binf-dropdown-toggle)")||n.$(".cs-form-set-container").find(".binf-popover .csui-colout-formitems").length>0)return;if(t(document.activeElement).hasClass("cs-form-set-container")&&!n.isWriteMode)return t(document.activeElement).siblings(".csui-array-bulk-edit").find(".csui-bulk-edit").trigger("click"),e.preventDefault(),void e.stopPropagation();if(n.options.isSetType){t(e.target).hasClass("esoc-user-container esoc-user-mini-profile")||(e.preventDefault(),e.stopPropagation());var s=n.getFieldEl().find(".cs-pull-left .cs-field-read");s.hasClass("binf-hidden")?e.data(".cs-field-write-inner.binf-open").length>0?e.data(document.activeElement).trigger("click"):(e.data(".csui-user-picker-no-results")&&(e.preventDefault(),e.stopPropagation()),e.target.classList.contains("apply-all")&&n.onClickApplyAll(e),setTimeout(function(){n.children.length>0&&"tkl"===n.children[0].type?n._doBulkSubmitActionTKL(!0,e):n._doBulkSubmitAction(!0)},20)):(a(e),"create"===n.options.mode||t(e.target).hasClass("esoc-user-container esoc-user-mini-profile")||n._changeBlockToWriteMode(e,!0))}else{var l=n.view.field.children[0].fieldView;if("select"===l.alpacaField.type){var r=e.data.inArray(e.target,e.data(e.target).closest(".cs-form-set-container").find("button.binf-dropdown-toggle"));-1!==r&&(l=n.view.field.children[r].fieldView,l.isDropdownOpen()?(e.preventDefault(),e.stopPropagation(),e.data(document.activeElement).trigger("click")):(e.preventDefault(),e.stopPropagation(),setTimeout(function(){n.children.length>0&&"tkl"===n.children[0].type?n._doBulkSubmitActionTKL(!0,e):n._doBulkSubmitAction(!0)},20)))}else l.getStatesBehavior().isStateRead()&&l.allowEditOnEnter()?(a(e),"create"===n.options.mode||t(e.target).hasClass("esoc-user-container esoc-user-mini-profile")||n._changeBlockToWriteMode(e,!0)):l.getStatesBehavior().isStateWrite()&&l.allowSaveOnEnter()&&(e.data(".csui-user-picker-no-results")&&(e.preventDefault(),e.stopPropagation()),e.target.classList.contains("apply-all")&&n.onClickApplyAll(e),n.children.length>0&&"tkl"!==n.children[0].type&&(i=n.children[n._getFieldIndex(e.target)].fieldView,i.getOldValue()!==i.getEditValue()&&i.changeChildrenValues(n.childRelations)),setTimeout(function(){n.children.length>0&&"tkl"===n.children[0].type?n._doBulkSubmitActionTKL(!0,e):0===n.container.find("ul.typeahead:visible").length&&n._doBulkSubmitAction(!0)},20))}}else if(9===e.keyCode)if(n.isWriteMode||"create"===n.options.mode){if("create"===n.options.mode){var o=t.Event("tab:content:field:changed");n.field.trigger(o)}if(n.options.isSetType){var d=n.children[0].children[0];d.fieldView?d.fieldView.getEditableBehavior().moveTab(e):d.children[0].fieldView.getEditableBehavior().moveTab(e)}else n.children[0].fieldView.getEditableBehavior().moveTab(e)}else n.getFieldEl().find(".csui-array-bulk-edit").addClass("binf-hidden");else if(113===e.keyCode){if(n.turnToReadMode=!0,!n.isWriteMode)return a(e),void("create"!==n.options.mode&&n._changeBlockToWriteMode(e,!0));e.stopPropagation(),e.preventDefault(),n.children.length>0&&!n.options.isSetType&&"tkl"!==n.children[0].type&&(i=n.children[n._getFieldIndex(e.target)]&&n.children[n._getFieldIndex(e.target)].fieldView)&&i.getOldValue()!==i.getEditValue()&&i.getEditableBehavior()&&i.getEditableBehavior().changeChildrenValues(n.childRelations),n.children.length&&"tkl"===n.children[0].type?n._doBulkSubmitActionTKL(!0,e):n._doBulkSubmitAction(!0),n.childRelations&&n.childRelations.length>0&&n.childRelations.forEach(function(i){n.isMultiFieldView(i)?i._doBulkSubmitActionTKL(!0,e):"write"===i.getStatesBehavior().state&&i.getEditableBehavior().trySetValueAndLeaveEditMode(!0,!1)})}else 32===e.keyCode&&(n.isWriteMode||(a(e),"create"!==n.options.mode&&n._changeBlockToWriteMode(e,!0)))})},"_moveTab":function(e,i,n){if(this._updateTabableElements(),this.currentTabPosition=t(this.tabableElements).index(i),"create"===this.options.mode){if(this.currentTabPosition===this.tabableElements.length-1||-1===this.currentTabPosition)return
}else if(-1===this.currentTabPosition)return;n?this.currentTabPosition>0?this.currentTabPosition-=1:this.currentTabPosition=this.tabableElements.length-1:this.currentTabPosition>=this.tabableElements.length-1?this.currentTabPosition=0:this.currentTabPosition+=1,this.tabableElements[this.currentTabPosition].focus(),e.preventDefault(),e.stopPropagation()},"_updateTabableElements":function(){this.tabableElements.length=0;var e=this;this.options.mode&&"create"===this.options.mode?t(this.domEl.closest(".alpaca-container-item").length>0?this.domEl.closest(".alpaca-container-item"):this.domEl).find(this.tabContentSelectors).each(function(){t(this).is(":visible")&&e.tabableElements.push(this)}):t(this.tabableRegions).each(function(){t(this).find(e.tabContentSelectors).each(function(){t(this).is(":visible")&&e.tabableElements.push(this)})})},"_updateTabablePositionOnApplyAllClick":function(e,i){i._updateTabableElements(),i.currentTabPosition=t(i.tabableElements).index(e.target);var n,a,s,l,r,o;if(o=e.shiftKey,"create"===i.options.mode){if(i.currentTabPosition===i.tabableElements.length-1||-1===i.currentTabPosition){for(n=t(document.querySelectorAll(".binf-tab-content")).children(),a=n.find(i.tabContentSelectors),i.tabableElements=a,i.tabableRegions=t(i.tabableElements),l=a.length,r=0;r<l&&(!(s=i.tabableElements[r])||!t(s).is(e.target));)r++;r>=0&&r<l&&(i.currentTabPosition=r)}}else if(-1===i.currentTabPosition){for(n=t(document.querySelectorAll(".binf-tab-content")).children(),a=n.find(i.tabContentSelectors),i.tabableElements=a,i.tabableRegions=t(i.tabableElements),l=a.length,r=0;r<l&&(!(s=i.tabableElements[r])||!t(s).is(e.target));)r++;r>=0&&r<l&&(i.currentTabPosition=r)}o?i.currentTabPosition>0?i.currentTabPosition-=1:i.currentTabPosition=i.tabableElements.length-1:i.currentTabPosition>=i.tabableElements.length-1?i.currentTabPosition=0:i.currentTabPosition+=1,t(i.tabableElements[i.currentTabPosition]).prop("tabindex","0").trigger("focus")},"_changeBlockToWriteMode":function(e,i){if(i){if(0===this.field.find(".csui-bulk-edit-cancel:visible").length){e.preventDefault(),e.stopPropagation(),this.field.find(".csui-array-bulk-edit-set").length>0?t(this.field.find(".csui-array-bulk-edit-set .csui-bulk-edit")).trigger("click"):(t(this.field.find(".csui-bulk-edit")).trigger("click"),t(this.field.find(".csui-array-bulk-edit")).removeClass("binf-hidden"));var n=0;if("otcs_user_picker"===this.schema.items.type||"otcs_member_picker"===this.schema.items.type)n=e.arrayFieldIndex;else{var a=this.getFieldEl().find(".cs-pull-left .cs-field-read, .cs-booleanfield .cs-field-write");n=t(a).index(t(e.target).closest(".cs-field-read"))}var s=this.getFieldEl().find(".cs-pull-left .cs-field-write");t(s[n]).find(":input").trigger("focus")}}else this.children.length>0&&"tkl"===this.children[0].type&&this.getFieldEl().is(":visible")&&(this.parentRelations&&this.parentRelations.map(function(e){t(e.field.find(".csui-bulk-edit-cancel:visible")).trigger("click")}),this.childRelations&&this.childRelations.map(function(e){t(e.field.find(".csui-bulk-edit-cancel:visible")).trigger("click")})),t(this.field.find(".csui-bulk-edit-cancel:visible")).trigger("click")},"_showAddIconForLastElement":function(){this.container.find(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden"),this.container.find(".cs-pull-right").find(".circle_add_grey").last().parent().removeClass("binf-hidden")},"_hideInlineAddIcon":function(){this.container.find(".cs-pull-right").find(".circle_add_grey").parent().addClass("binf-hidden")},"_hideInlineDeleteIcon":function(){this.container.find(".cs-pull-right").find(".circle_delete_grey").parent().addClass("binf-hidden")},"_showSetDeleteIcon":function(){this.container.find(".cs-pull-right").find(".circle_delete_grey").removeClass("binf-hidden").parent().removeClass("binf-hidden")},"_hideSetActionIcon":function(){var e=t(this.container[0]).find(".cs-array .cs-pull-right");e.find(".circle_delete_grey").parent().addClass("binf-hidden"),e.find(".circle_add_grey").parent().addClass("binf-hidden")},"_doEditActions":function(e,n){var a,s;if(this.propagatedEvent=e,this.formView.isDataUpdating)return this.formView.options.metadataView.blockingView.$el.is(":visible")||(this.formView.options.metadataView.blockActions(),this.formView.propagatedEvent=e),!1;if(this.propagatedEvent=null,n||e&&t(e.target).hasClass("csui-bulk-edit")){if(0!==t(".cs-form .cs-formfield-invalid").length)return void t(t(".cs-form .cs-formfield-invalid")[0]).find(":input").trigger("focus").trigger("focus");if(this.getFieldEl().find(".csui-array-bulk-edit").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit-cancel").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit-submit").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit").addClass("binf-hidden"),this.registered||!this.parent.parent&&!this.parent.options.isSetType||this._registerBulkSubmitAction(),this.children.length>0){var l=function(e){!!e&&e.map(function(e){if(!e.isWriteMode)if(e.alpacaField)"read"===e.getStatesBehavior().state&&e.getEditableBehavior().setViewStateWriteAndEnterEditMode();else{var i=e.getFieldEl();i.is(":visible")&&(i.find(".icon-container.csui-array-bulk-edit").removeClass("binf-hidden"),i.find(".csui-bulk-edit-cancel").removeClass("binf-hidden"),i.find(".csui-bulk-edit-submit").removeClass("binf-hidden"),i.find(".csui-bulk-edit").addClass("binf-hidden"),e.registered||!e.parent.parent&&!e.parent.options.isSetType||e._registerBulkSubmitAction(),e._showItemsInWriteMode(),!!e.childRelations&&l(e.childRelations))}})};l(this.childRelations)}this.showMoreOrLessColumns(!1),this._showItemsInWriteMode(),a=this.getFieldEl().find(".cs-pull-left .cs-field-write"),a.length>0&&t(a.first()).find(":input").trigger("focus").trigger("focus")}else if(e&&t(e.target).hasClass("csui-bulk-edit-cancel"))if(this.cancelClicked=!0,h.tklHelpers&&h.tklHelpers.viewsInWriteMode.length>0&&!this.options.isSetType)for(var r=h.tklHelpers.viewsInWriteMode.length-1;h.tklHelpers&&r>=0;r--){var o=h.tklHelpers.viewsInWriteMode[r];if(o&&"write"===o.getStatesBehavior().state)if(o.getEditableBehavior().isMultiFieldView(o)){o=o.alpacaField.parent;var d=o.getFieldEl();d.find(".csui-bulk-edit-cancel").is(":visible")&&(d.find(".csui-bulk-edit").removeClass("binf-hidden"),d.find(".csui-bulk-edit-cancel").addClass("binf-hidden"),d.find(".csui-bulk-edit-submit").addClass("binf-hidden"),o._hideInlineDeleteIcon(),o._hideInlineAddIcon(),o.options.prevChildData&&(o.children={},o.children=o.options.prevChildData),s=o.getPreviousData(),o.refreshContainer(s,i.bind(function(){this.options.prevChildDom=void 0,this.options.prevData=void 0,this.isWriteMode=!1;var e=this;"create"!==this.options.mode&&setTimeout(i.bind(function(){var i=t.Event("tab:content:field:changed");e.field.trigger(i)},e),300)},o)))}else"write"===o.getStatesBehavior().state&&(o.isTKLField?(o.setValue(o.getOldValue()),o.ui.writeField.val(o.getOldValue()),o.isValidTKLState=!0):o.ui.writeField.val(o.getValue()),o.alpacaField.refreshValidationState(),o.$el.removeClass("cs-formfield-invalid"),o.getEditableBehavior().setViewReadOnlyAndLeaveEditMode(!1,!1))}else{this.getFieldEl().find(".csui-bulk-edit").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit-cancel").addClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit-submit").addClass("binf-hidden");var c=!1;this.getFieldEl().hasClass("cs-adjust-width")&&(c=!0),this._hideInlineDeleteIcon(),this._hideInlineAddIcon();var u=this;u.$=t,this.options.prevChildData&&(this.children={},this.children=this.options.prevChildData),s=this.getPreviousData(),this.refreshContainer(s,function(){var e=u.getFieldEl();u.container.trigger("focus"),u.options.prevChildDom=void 0,u.options.prevData=void 0,c&&e.addClass("cs-adjust-width"),u.parent.restructureSetContainer(u.$(u.field[0]).find(".cs-form-set-container"),u.parent),setTimeout(i.bind(function(){var e=t.Event("tab:content:field:changed");u.field.trigger(e),u.field.find(".csui-array-bulk-edit").removeClass("binf-hidden")},u),300),u.isWriteMode=!1})}},"showMoreOrLessColumns":function(e){var i=this.container.closest(".cs-form-set.cs-form-set-container");t(i).find(".set-row-show").length&&e?(t(i).parent().find(".csui-show-more").removeClass("binf-hidden"),t(i).parent().find(".icon-expandArrowUp")&&(t(i).parent().find(".csui-set-show-more-icon").removeClass("icon-expandArrowDown").addClass("icon-expandArrowUp"),t(i).parent().find(".csui-set-show-more-label").html(u.showLess))):(t(i).find(".set-row-hidden").addClass("set-row-show"),t(i).parent().find(".csui-show-more").addClass("binf-hidden"))},"getPreviousData":function(){var e={};if(this.options.submittedData&&this.options.submittedData.length){if(this.children[0]&&"select"===this.children[0].type&&!this.options.isSetType){var i=[];t.each(this.options.submittedData,function(e,t){t instanceof Object?i.push(parseInt(t.get("id"))):""===t||null===t?i.push(""):i.push(t)}),e=JSON.parse(JSON.stringify(i.slice()))}else e=JSON.parse(JSON.stringify(this.options.submittedData));this.options.submitArray=!1}else this.options.prevData?(e=this.options.prevData,this.options.prevData=void 0):e=JSON.parse(JSON.stringify(this.data.slice()));return e},"showAppliedTick":function(e,i,n){var a=e.target;a.callback=i,a.eve=e,t(a).fadeOut(100,function(){t(this).removeClass(),t(this).addClass("csui-icon block applied_done"),t(this).fadeIn(100,function(){setTimeout(function(e){t(e).fadeOut(800,function(){t(this).removeClass(),t(this).addClass("csui-icon apply-all block binf-hidden"),t(this).parent().addClass("binf-hidden"),this.callback(this.eve,n)})},1e3,this)})}),t(".metadata-sidebar .metadata-sidebar-fadeout").fadeOut(2e3,function(){t(".metadata-sidebar .cs-list-group .arrow-overlay").removeClass("metadata-sidebar-arrow-overlay"),t(".metadata-sidebar .cs-list-group").removeClass("metadata-sidebar-cs-list-group"),t(this).remove()})},"onClickApplyAll":function(e){if(this._doBulkSubmitAction(),t(e.currentTarget).parents(".alpaca-container-item")&&0===t(e.currentTarget).parents(".alpaca-container-item").find(".cs-formfield-invalid").length){this.updateData(this.data);var n=JSON.parse(JSON.stringify(this.data.slice())),a=this.updateData(n),s={"fieldvalue":a,"fieldpath":this.name,"action":this.showAppliedTick,"fieldevent":e,"callback":this._updateTabablePositionOnApplyAllClick,"view":this};t(".metadata-sidebar .cs-list-group").addClass("metadata-sidebar-cs-list-group"),t(".metadata-sidebar .cs-list-group .arrow-overlay").addClass("metadata-sidebar-arrow-overlay"),t("<div/>",{"class":"metadata-sidebar-fadeout"}).appendTo(t(".metadata-sidebar .cs-list-group"));var l=t.Event("click:applyAll");i.extend(l,s),this.field.trigger(l);var r=this,o=i.where(this.children,{"type":"tkl"});if(o.length>0){var d=function(e){e.children.length>0&&i.each(e.children,function(e){o[0].fieldView.isMultiFieldView(e)?(s.fieldpath=e.propertyId,s.fieldvalue=e.getValue(),i.extend(l,s),r.field.trigger(l),d(e.children[0].fieldView)):(s.fieldpath=e.alpacaField?e.alpacaField.name:e.view.field.name,s.fieldvalue=e.getValue().toString(),i.extend(l,s),r.field.trigger(l),d(e))})};d(o[0].fieldView);var c=function(e){e.parentViews.length>0&&i.each(e.parentViews,function(e){o[0].fieldView.isMultiFieldView(e)?(s.fieldpath=e.propertyId,s.fieldvalue=e.getValue(),i.extend(l,s),r.field.trigger(l),c(e.children[0].fieldView)):(s.fieldpath=e.alpacaField?e.alpacaField.name:e.view.field.name,s.fieldvalue=e.getValue().toString(),i.extend(l,s),r.field.trigger(l),c(e))})};c(o[0].fieldView)}}},"showApplyAll":function(e){if("create"===this.options.mode){var i,n=this.getFieldEl().find(".csui-icon.apply-all");e&&(i=this.getFieldEl().find(">.apply-set").length>0?this.getFieldEl().find(">.apply-set").children():this.container.parents(".cs-form-set-container").siblings(".apply-set").find(".csui-icon.apply-all"),n=i.length>0?i:n);var a=this.getFieldEl().parents(".cs-metadata-properties").find(".csui-icon.apply-all").not(".binf-hidden");if(a=a.filter(function(e,i){return i=i!==n[0]?i:void 0}),a&&a.length>0&&(a.addClass("binf-hidden"),a.parent().addClass("binf-hidden")),n.hasClass("binf-hidden")){n.removeAttr("style"),n.removeClass("binf-hidden"),n.prop("tabindex","0"),n.parent().hasClass("binf-hidden")&&n.parent().removeClass("binf-hidden");var s=t.Event("tab:content:field:changed");this.field.trigger(s)}}},"hideApplyAll":function(e){var i=e.find(".apply-all:first");0===e.find(".alpaca-message").length&&(i.hasClass("binf-hidden")||i.addClass("binf-hidden"),i.parent().hasClass("binf-hidden")||setTimeout(function(){i.parent().addClass("binf-hidden")},1100))},"_hideApplyAll":function(e){if(!(this.parent.parent&&this.parent.parent.options.isSetType||"create"!==this.options.mode||0!==this.getFieldEl().find(".apply-all").not(".binf-hidden").length)){var i=t(".cs-form .apply-all").not(".binf-hidden");i.length>0&&i.addClass("binf-hidden")}},"updateData":function(e){return t.each(e,function(e,i){if(i instanceof Object)for(var t in i)i.hasOwnProperty(t)&&i[t]instanceof Object&&void 0!==i[t].id&&(i[t]=""+i[t].id)}),e},"_showItemsInReadMode":function(){this._showBulkEditAction(),this.showInReadMode(this.children),this.focusedOnDocument&&(this.container.parent().find(".cs-form-set-container").length>0?this.container.parent().find(".cs-form-set-container").first().trigger("focus"):this.container.parents(".cs-form").find(".cs-form-set-container").length>0&&this.container.parents(".cs-form").find(".cs-form-set-container").first().trigger("focus")),this._adjustScrollContainerWidth(!1),this.isWriteMode=!1},"showInReadMode":function(e){var i=this;t.each(e,function(e,n){n.fieldView?!t.isEmptyObject(n.fieldView._behaviors)&&n.fieldView.getStatesBehavior()&&"create"!==n.options.mode&&n.fieldView.getStatesBehavior().setStateRead(!1):n.children&&i.showInReadMode(n.children)})},"_showItemsInWriteMode":function(e,i){if(!this.options.prevData)if(this.options.isSetType){var n=t.map(this.data.slice(),function(e){return t.extend(!0,{},e)});this.options.prevData=n}else this.options.prevData=this.data.slice();this.options.isSetType||this.field.find(".cs-form-set-container .cs-array").removeClass("cs-form-multi-action-container").addClass("cs-form-multi-action-container"),"create"!==this.options.mode&&this._hideBulkEditAction(),this.showInWriteMode(this.children,e);var a=this.getFieldEl().find(".cs-pull-left .cs-field-write");if(i&&void 0!==e&&null!==e){var s=this.container.parent().find(".cs-form-set-container").first();t(t(s).children().get(e)).find(".cs-pull-left .cs-field-write").first().find(":input").trigger("focus")}else void 0!==e&&null!==e&&t(a.get(e)).find(":input").trigger("focus");this.field.find(".csui-set-scroll-container-parent").length>0&&(t(this.field).find(".csui-set-scroll-container-child").perfectScrollbar("update"),t(this.field).find(".cs-form-set-container").addClass("csui-hoveredScrollable")),this._adjustScrollContainerWidth(!0),this.isWriteMode=!0},"_adjustScrollContainerWidth":function(e){var i=this.container.parent().find(".csui-set-scroll-container-parent");if((!this.isWriteMode||!e)&&i.length>0&&"create"!==this.options.mode&&(this.isWriteMode||e)){var t=this.container.find(".csui-lockedcols").width();e&&(p&&p.settings.rtl?(this.container.parent().find(".csui-set-scroll-container-parent").css("padding-Right",t+"px"),this.container.parent().find(".csui-set-scroll-container-parent").css("padding-Left","0px")):this.container.parent().find(".csui-set-scroll-container-parent").css("padding-Left",t+"px")),this.container.parent().find(".csui-set-scroll-container-child").perfectScrollbar("update")}},"showInWriteMode":function(e,i){var n=this;if(t.each(e,function(e,a){a.fieldView?((a.options.customField||"otcs_user_picker"===a.schema.type||"otcs_member_picker"===a.schema.type||"otcs_node_picker"===a.schema.type)&&a.fieldView&&i&&!t.isEmptyObject(a.fieldView._behaviors)&&i!==e&&a.fieldView.getEditableBehavior().trySetValue(),t.isEmptyObject(a.fieldView._behaviors)||!a.fieldView.getStatesBehavior()||"write"===a.fieldView.getStatesBehavior().state||this.schema.readonly||(a.fieldView.getStatesBehavior().setStateWrite(!1,!1),(a.fieldView.childTKLViews.length||a.fieldView.parentViews.length||a.fieldView.children||a.parentRelations||a.childRelations)&&h.tklHelpers&&h.tklHelpers.viewsInWriteMode.length>0&&n._updateViewsInWriteMode(a.fieldView))):a.children&&n.showInWriteMode(a.children)}),this.options.fields.item.isMultiFieldItem){this.field.find(".cs-form-set-container.csui-multivalue-block").removeClass("csui-multivalue-read-block");var a=this.field.children(".cs-form-set-container").is("visible");a.length>0&&a.addClass("csui-multivalue-set-write-mode")}this.hideColout()},"hideColout":function(){this.container.parent().find(".cs-form-set-container").find(".csui-show-colout").addClass("binf-hidden"),this.container.parent().find(".cs-form-set-container").find(".csui-show-colout").parent(".csui-lockedcols").removeClass("csui-colout-visible"),this.container.parent().find(".csui-scrollablecols").addClass("csui-scrollable-writemode"),this.hidePopover()},"hidePopover":function(){t(".csui-colout-icon").each(function(){t(this).data("binf.popover")&&t(this).binf_popover("destroy")})},"validateContainer":function(e){var i=this,n=!0;t.each(e,function(e,a){a.fieldView?!t.isEmptyObject(a.fieldView._behaviors)&&a.fieldView.getStatesBehavior()&&("select"===a.fieldView.alpacaField.type?(a.fieldView.getEditValue().get("id")!==a.fieldView.getOldValue().get("id")&&(i.options.isBlockModified=!0),n=a.fieldView.trySetValue(),a.fieldView.ui.writeField.select()):"otcs_user_picker"===a.schema.type||"otcs_member_picker"===a.schema.type?(a.fieldView.getEditValue().id!==a.fieldView.getValue().id&&(""===a.fieldView.getEditValue().id&&null===a.fieldView.getValue().id||(i.options.isBlockModified=!0)),a.fieldView.userPicked?n=a.fieldView.setValue(a.fieldView.getEditValue(),!0):(a.fieldView.alpacaField.refreshValidationState(!1),n=!1)):a.options.customField||"otcs_node_picker"===a.schema.type?a.fieldView.getEditValue()===a.fieldView.getOldValue()&&""!==a.fieldView.getEditValue()||(i.options.isBlockModified=!0,n=a.fieldView.setValue(a.fieldView.getEditValue(),!0)):"tkl"===a.fieldView.alpacaField.type?(a.fieldView.getEditValue()!==a.fieldView.getOldValue()&&(i.options.isBlockModified=!0),n=a.fieldView.trySetValue(),a.fieldView.needRerender&&(a.fieldView.render(),delete a.fieldView.needRerender)):(a.fieldView.getEditValue()!==a.fieldView.getValue()&&(""===a.fieldView.getEditValue()&&null===a.fieldView.getValue()||(i.options.isBlockModified=!0)),n=a.fieldView.setValue(a.fieldView.getEditValue(),!0)),n?(a.fieldView.$el.removeClass("cs-formfield-invalid"),i.isContainerValid=!0):(a.fieldView.$el.addClass("cs-formfield-invalid"),i.isContainerValid=!1)):a.children&&n&&i.validateContainer(a.children)})},"isMultiFieldView":function(e){return!e.isTKLField&&!e.isNonTKLField||e.alpacaField.options.isMultiFieldItem&&!!e.alpacaField.parent&&!!e.alpacaField.parent.schema.maxItems&&e.alpacaField.parent.schema.maxItems>1},"validateChildRelations":function(e){e&&(this.validateContainer(e),e.map(function(e){e.childRelations&&e.childRelations.length&&this.validateChildRelations(e.childRelations)},this))},"_getFieldIndex":function(e){var i=this.containerItemEl.find("input").index(e);return-1===i&&(i=this.containerItemEl.find(".cs-field-write button").index(e)),i},"_doBulkSubmitAction":function(e){var n,a,s=!1;if(this.isContainerValid=!0,this.validateContainer(this.children),this.validateChildRelations(this.childRelations),"create"===this.options.mode&&0===document.querySelectorAll(".binf-has-error").length&&(t(".metadata-validation-error").hide(),t("div").removeClass("show-validation-error")),0===t(".cs-form .cs-formfield-invalid").length){var l=this.getFieldEl().find(".cs-pull-left .cs-field-write"),r=void 0!==this.view.field.schema.items.minItems?this.view.field.schema.items.minItems:1;if(l.length>=r&&(this.options.isSetType?i.flatten(i.map(this.data,i.values)).length!==l.length&&(s=!0):this.data.length!==l.length&&(s=!0)),this.isRelatedFieldInFocus(document.activeElement)&&!e)return;if(this.isContainerValid){if(s||this.options.isBlockModified){var o={"fieldvalue":this.getValue(),"fieldid":this.name||this.id,"fieldpath":this.path,"targetfieldvalue":this.getValue(),"targetfieldid":this.name,"targetfieldpath":this.path};this.options.submitArray=!0,this.options.submittedData=this.getValue().slice(),this.options.prevData=void 0,this.options.prevChildData=void 0;var d=t.Event("field:changed");i.extend(d,o),this._onFieldChanged(d)}this.showMoreOrLessColumns(!0)}else{var c=t.Event("field:invalid");this.$el.trigger(c)}if(h.tklHelpers&&h.tklHelpers.viewsInWriteMode.length>0)for(var u,f=h.tklHelpers.viewsInWriteMode.length-1;h.tklHelpers&&f>=0;f--)(u=h.tklHelpers.viewsInWriteMode[f])&&(u===this.view,u&&(u.getEditableBehavior().isMultiFieldView(u)?"write"===u.getStatesBehavior().state&&(u=u.alpacaField.parent,u.options.submittedData=u.getValue().slice(),u._showItemsInReadMode(),u._hideInlineDeleteIcon(),u._hideInlineAddIcon(),u._showBulkEditAction()):u.getEditableBehavior().setViewReadOnlyAndLeaveEditMode(!0,!1)));"create"!==this.options.mode&&(this.focusedOnDocument=!0,this._showItemsInReadMode(),this._hideInlineDeleteIcon(),this._hideInlineAddIcon(),this._showBulkEditAction(),this.options.isSetType||t(document.activeElement).closest(".csui-multivalue-block")||t(document.activeElement).closest(".cs-form-set")||this.containerItemEl.find(".csui-multivalue-block").trigger("focus")),"create"!==this.options.mode&&(this.container.parent().find(".cs-form-set-container").find(".csui-show-colout").removeClass("binf-hidden"),this.container.parent().find(".cs-form-set-container").find(".csui-show-colout").parent(".csui-lockedcols").addClass("csui-colout-visible"),n=this.container.find(".csui-lockedcols").width(),a=this.container.find(".csui-lockedcols").find(".csui-show-colout").length>0?0:this.container.find(".csui-show-colout").width(),p&&p.settings.rtl?(this.container.parent().find(".csui-set-scroll-container-parent").css("padding-Right",n+a+"px"),this.container.parent().find(".csui-set-scroll-container-parent").css("padding-Left","0px")):this.container.parent().find(".csui-set-scroll-container-parent").css("padding-Left",n+a+"px"),this.container.parent().find(".csui-set-scroll-container-child").perfectScrollbar("update"),this.container.parent().find(".cs-form-set-container").hasClass("csui-hoveredScrollable")&&this.container.parent().find(".cs-form-set-container").removeClass("csui-hoveredScrollable"))}else this.hideColout();"create"!==this.options.mode&&(this.options.isBlockModified||this.options.isSetType||t(document.activeElement).closest(".csui-multivalue-block")||t(document.activeElement).closest(".cs-form-set")||this.containerItemEl.find(".csui-multivalue-block").trigger("focus")),this.options.isBlockModified=!1,this.options.submitArray=void 0},"_doBulkSubmitActionTKL":function(e,n){var a=this,s=void 0!==n&&n;setTimeout(function(){var n,l,r=!0,o=!1,d=a.children[0]&&a.children[0].fieldView.isReadyToSave();if((e||!d)&&(e||!a.isRelatedFieldInFocus(document.activeElement)||s&&113===s.keyCode)){if(h.tklHelpers)for(var c=h.tklHelpers.viewsInWriteMode.length-1;h.tklHelpers&&c>=0;c--){if(!h.tklHelpers.viewsInWriteMode[c])return;n=h.tklHelpers.viewsInWriteMode[c].isNonTKLField?h.tklHelpers.viewsInWriteMode[c].getEditableBehavior():h.tklHelpers.viewsInWriteMode[c],r?r=n.trySetValue():n.trySetValue(),o||(l=h.tklHelpers.viewsInWriteMode[c],a.isMultiFieldView(l)?(l=l.alpacaField.parent,o=!i.isEqual(l.getPreviousData(),l.getValue())):o=h.tklHelpers.viewsInWriteMode[c].getOldValue()!==h.tklHelpers.viewsInWriteMode[c].getValue())}if(r){if(o){var u={"fieldvalue":a.getValue(),"fieldid":a.id,"fieldpath":a.path,"targetfieldvalue":a.getValue(),"targetfieldid":a.name,"targetfieldpath":a.path};a.options.submitArray=!0,a.options.submittedData=a.getValue().slice(),a.options.prevData=void 0,a.options.prevChildData=void 0;var p=t.Event("field:changed");i.extend(p,u),a._onFieldChanged(p)}if(a.showMoreOrLessColumns(!0),"create"!==a.options.mode&&h.tklHelpers)for(var f,m=h.tklHelpers.viewsInWriteMode.length-1;m>=0&&h.tklHelpers;m--)(f=h.tklHelpers.viewsInWriteMode[m])&&(f.getEditableBehavior().isMultiFieldView(f)?(f=f.alpacaField.parent,f.children.map(function(e){e.fieldView.needRerender&&e.fieldView.render()}),f.isWriteMode&&(f.options.submittedData=f.getValue().slice(),a.focusedOnDocument=t(s.currentTarget).find(".csui-multivalue-container")[0]===f.container[0],f._showItemsInReadMode(),f._hideInlineDeleteIcon(),f._hideInlineAddIcon(),f._showBulkEditAction())):f.isTKLField?(a.focusedOnDocument=!0,f.getEditableBehavior().trySetValueAndLeaveEditMode(!1,!1)):(f.setValue(f.getEditValue(),!0,!0),f.render(),"write"===f.getStatesBehavior().state&&f.getStatesBehavior().setStateRead(!1)));a.options.submitArray=void 0,"create"!==a.options.mode&&h.tklHelpers&&0===h.tklHelpers.viewsInWriteMode.length&&delete h.tklHelpers}}},50)},"_updateViewsInWriteMode":function(e){setTimeout(function(){h.tklHelpers||(h.tklHelpers={},h.tklHelpers.viewsInWriteMode=[]),!e.isCustomView&&-1===h.tklHelpers.viewsInWriteMode.indexOf(e)&&e.$el.is(":visible")&&(e.cancelClicked=!1,e.alpacaField.parent&&(e.alpacaField.parent.cancelClicked=!1),h.tklHelpers.viewsInWriteMode.push(e)),h.tklHelpers.tabInView||(h.tklHelpers.tabInView=e)},101)},"isRelatedFieldInFocus":function(e){return h.tklHelpers&&h.tklHelpers.viewsInWriteMode.some(function(i){return i.ui.writeField[0]===e})},"_showBulkEditAction":function(){this.getFieldEl().find(".csui-bulk-edit").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit-cancel").addClass("binf-hidden"),this.getFieldEl().find(".csui-array-bulk-edit").addClass("binf-hidden")},"_hideBulkEditAction":function(){this.getFieldEl().find(".csui-array-bulk-edit").hasClass("binf-hidden")&&this.getFieldEl().find(".csui-array-bulk-edit").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit-cancel").removeClass("binf-hidden"),this.getFieldEl().find(".csui-bulk-edit").addClass("binf-hidden")},"_mouseInArrayBlock":function(e){"create"===this.options.mode||this.schema.readonly||0!==t(".cs-form .cs-formfield-invalid").length||this.getFieldEl().find(".csui-array-bulk-edit").removeClass("binf-hidden")},"_mouseOutArrayBlock":function(e){this.getFieldEl().find(".csui-bulk-edit-cancel").hasClass("binf-hidden")&&this.getFieldEl().find(".csui-array-bulk-edit").addClass("binf-hidden"),this.getFieldEl().find(".csui-set-action-bar").removeClass("csui-set-action-bar")},"updateToolbars":function(){this.base(),this.schema.readonly&&this.getFieldEl().find(".cs-pull-right").hide(),d.isTouchBrowser()&&this.field.find(".cs-pull-left").trigger("click",function(){});this.field.find(".cs-alp-array-buttons").parent().width("2.5em").css("min-width",0);this.parent.options&&!this.parent.options.isSetType&&this.field.find(".alpaca-field-otcs_array_buttons").parent().css("min-width","3em"),0===this.field.find(".cs-alp-array-buttons").length&&this.field.find(".cs-pull-right").attr("title","")},"_onFieldChanged":function(e){if(e.stopPropagation(),!this.options.submitArray){var i=/\[([^\]]+)\]\/?([^\]]*)$/,t=i.exec(e.fieldpath);t&&4===t.length&&t[2]?this.data[parseInt(t[1])][t[2]]=e.fieldvalue:this.data[parseInt(t[1])]=e.fieldvalue}(this.options.submitArray||"create"===this.options.mode)&&(this._raiseValueChanged("create"===this.options.mode?this.getValue():e.fieldvalue,this.name,this.path,e.fieldvalue,e.fieldid,e.fieldpath),this.options.submitArray=!1,this._updateSet())},"_updateSet":function(){var e=this.containerItemEl.alpaca("get");if(e&&e.options.isSetType&&e.parent){var i=e.parent;if(e.deletedItemCount){var t=e.children.length,n=t+e.deletedItemCount;e.deletedItemCount=0;for(var a=t+1;a<=n;a++){var s=i.childrenByPropertyId[e.propertyId+"_"+a];if(!s)break;i.removeItem(s.id)}}if(e.addItemCount){var l=e.children.length,r=l-e.addItemCount;e.addItemCount=0;var o,d={"type":"string"},c={"hidden":!0};if(e.children.length){var u=i.childrenByPropertyId[e.propertyId+"_1"];u&&(d=u.schema,c=u.options,o=u.data)}for(var h=r+1;h<=l;h++)i.addItem(e.propertyId+"_"+h,d,c,o)}}},"_raiseValueChanged":function(e,n,a,s,l,r){var o={"fieldvalue":e,"fieldid":n,"fieldpath":a,"targetfieldvalue":s,"targetfieldid":l,"targetfieldpath":r},d=t.Event("field:changed");if(i.extend(d,o),this.containerItemEl.trigger(d),"create"===this.options.mode)this.parent.data[this.propertyId]=this.getValue(),this.data=e;else if(this.parent.data[this.propertyId]=e,this.data=e.slice(),this.options&&this.options.isSetType&&this.children.length===this.data.length)for(var c=0;c<this.children.length;c++)this.children[c].data=this.data[c]},"_validateAllFieldsFilled":function(){var e=!0;return this.schema.required&&i.each(this.data,function(i){i||(e=!1)}),e},"getFieldType":function(){return"array"},"updateShowMoreIndexes":function(e){var n=this,a=t(e[0]).find(">.cs-array.alpaca-container-item");a.length&&i.each(a,function(e,i){n.options.rows_to_display&&i<n.options.rows_to_display?(n.$(e).hasClass("set-row-show")&&n.$(e).removeClass("set-row-show"),n.$(e).hasClass("set-row-hidden")&&n.$(e).removeClass("set-row-hidden")):(n.$(e).removeClass("set-row-show"),n.$(e).addClass("set-row-hidden set-row-show"))})}}),l.registerFieldClass("array",l.Fields.CsuiArrayField,"bootstrap-csui"),l.registerFieldClass("array",l.Fields.CsuiArrayField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiArrayField}),csui.define("csui/controls/form/fields/alpaca/alpcsuiobjectfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/jsonpath","csui/lib/alpaca/js/alpaca","i18n!csui/controls/form/impl/nls/lang","csui/utils/base","i18n"],function(e,i,t,n,a,s,l,r){return a.Fields.CsuiObjectField=a.Fields.ObjectField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"postRender":function(e){if(this.base(e),this.options&&this.options.descriptionId){this.container.find(".cs-field-write-inner button:not(:disabled), .cs-field-write-inner input, .cs-field-write-inner textarea").attr("aria-describedby",this.options.descriptionId)}this.field.on("field:changed",i.bind(this._onFieldChanged,this))},"_onFieldChanged":function(e){if(this.containerItemEl){var n=this.containerItemEl.parent();e.stopPropagation();var a=e.fieldpath.split("/").pop();this.data[a]=e.fieldvalue;var s={"fieldvalue":this.data,"fieldid":this.name,"fieldpath":this.path,"targetfieldvalue":void 0!==e.targetfieldvalue?e.targetfieldvalue:e.fieldvalue,"targetfieldid":e.targetfieldid?e.targetfieldid:e.fieldid,"targetfieldpath":e.targetfieldpath?e.targetfieldpath:e.fieldpath},l=t.Event("field:changed");i.extend(l,s),n.trigger(l)}},"bindData":function(){},"getFieldType":function(){return"object"},"showColout":function(e){if(!t(e.target).data("binf.popover")){var n=e.target.getAttribute("data-csui-name"),a=t(e.target).closest(".cs-array.alpaca-container-item").attr("data-alpaca-container-item-index"),s=e.data.data[n]?n:n.substr(0,n.lastIndexOf("_")),r=t.extend(!0,[],e.data.data[s][a]),o=t.extend(!0,[],e.data.options.fields[s].fields.item),d=t.extend(!0,[],e.data.schema.properties[s].items);e.target.setAttribute("data-csui-row-index",a),i.each(o.fields,function(e){e.readonly||(e.readonly=!0),e.isMultiFieldItem&&delete e.isMultiFieldItem}),i.each(d.properties,function(e){e.readonly||(e.readonly=!0)});var c={"targetEl":t(e.target),"coloutContainer":t(e.target).parents(".cs-form-set-container"),"formdata":r,"formoptions":{"fields":o.fields},"formschema":{"properties":d.properties}},u=t.Event("show:colout");return i.extend(u,c),e.data.domEl.trigger(u),!1}var h=t(e.target).parents(".cs-form-set-container"),p=h.closest(".ps-container").length>0?h.closest(".ps-container"):h.closest(".csui-normal-scrolling");e.preventDefault(),t(e.target).binf_popover("destroy"),l.isTouchBrowser()&&p.css({"-webkit-overflow-scrolling":"touch"})},"keyDown":function(e){var i=e.data
;13===e.keyCode&&(i.showColout(e),e.stopPropagation()),9===e.keyCode&&(e.preventDefault(),t(e.target).binf_popover("destroy"))},"restructureAllSetContainer":function(e){var i=e.data.self,t=i.field.find(".csui-form-set-array-wrapper.cs-form-set").length>0||i.field.hasClass("csui-form-set-array-wrapper cs-form-set");if(i.eventType=e.type,t){var n;i.field.hasClass("cs-form-set-container")?n=i.field:i.field.find(".cs-form-set-container:not(.csui-multivalue-block )").length>0&&(n=i.field.find(".cs-form-set-container:not(.csui-multivalue-block )")),n&&1===n.length?i.restructureSetContainer(n,i):n&&n.length>1&&n.each(function(e,t){i.restructureSetContainer(t,i)})}},"restructureSetContainer":function(e,n,a){function o(e){N||(T=R?t(e).find(".csui-lockedcols").width():t(e).find(".csui-lockedcols:first").width()),T>0?(t(e).parents(".csui-perfect-scrolling").length>0?d():t(e).addClass("csui-native-scrollbar"),N&&clearInterval(N)):T=R?t(e).find(".csui-lockedcols").width():t(e).find(".csui-lockedcols:first").width()}function d(){T>0&&P&&P.find(".csui-set-scroll-container-parent").each(function(e,i){if(i=i instanceof t?i:t(i),"0px"===i.css(V)){i.css(V,"block"===i.parent().find(".csui-show-colout").css("display")?T:T-L);var n,a=t(i.parent(".cs-form-set-container").find(".csui-scrollablecols")[0]).children();A=0;for(var s=0;s<a.length;s++)n=t(t(i.parent(".cs-form-set-container").find(".csui-scrollablecols")[0]).children()[s]).width(),A+=n;i.find(".csui-scrollable-content").css("width",A),i.find(".csui-set-scroll-container-child").hasClass("ps-container")||(i.find(".csui-set-scroll-container-child").perfectScrollbar({"suppressScrollY":!0}),i.find(".csui-set-scroll-container-child").perfectScrollbar("update")),i.closest(".cs-form-set-container").find(".csui-scrollablecols").prop("scrollLeft",i.find(".ps-container").scrollLeft()),i.find(".csui-set-scroll-container-child").on("scroll",function(){t(this).parents(".cs-form-set-container").children().find(".csui-scrollablecols").prop("scrollLeft",t(this).scrollLeft());var e=t(this).parents(".cs-form-set-container").find(".ps-container.ps-active-x"),i=t.Event("set:scrolled");e.trigger(i)})}})}function c(){t(".csui-colout-icon").each(function(){t(this).data("binf.popover")&&t(this).binf_popover("destroy")})}function u(e,t){i.each(e,function(e,i){h||(i===t?h=e:e instanceof Object&&(e.fields&&e.fields.item&&e.fields.item.fields?u(e.fields.item.fields,t):u(e,t)))})}var h,p=!1;t(e).find(".alpaca-container-item-last .csui-scrollablecols").perfectScrollbar("update");var f=0,m=t(e).closest(".binf-tab-content .cs-form").length>0?t(e).closest(".binf-tab-content .cs-form"):void 0!==t(e).closest(".cs-form.cs-form-update")&&t(e).closest(".cs-form.cs-form-update").length>0?t(e).closest(".cs-form.cs-form-update"):t(e).closest(".cs-form.cs-form-create");if(void 0!==m&&m.length>0){var g=m.parent();if(void 0!==g&&g.length>0){var v=g.css("padding-right"),b=parseInt(void 0!==v?v:0),y=g.css("padding-left"),w=parseInt(void 0!==y?y:0);f=b+w+30}}var F=t("<div/>",{"class":"csui-shadowright-container"}),C=t("<div/>",{"class":"csui-shadowleft-container"}),k=t(e).attr("data-alpaca-container-item-name");u(n.options.fields,k);var x=h&&h.rows_to_display,E=h&&h.showExpanded,I=!1;if(t(e).children(":not('.binf-popover'):not('.csui-set-scroll-container-parent')").each(function(l,o){t(this).find(".csui-current-focused").trigger("focus");var d,c=[],u=[],h=t(o).find(".alpaca-container-item:not(.cs-form-multi-action-container)"),m=t(o).closest(".cs-form-set>.alpaca-container-item").attr("data-alpaca-container-item-name"),g=t(o).find(".cs-field-read").hasClass("binf-hidden"),v=g?" binf-hidden":"",b=!1,y=t("<div/>",{"class":"csui-show-colout"+v}),w=t("<div/>",{"class":"csui-icon-container"}),k=t("<div/>",{"class":"csui-icon-container"}),V=t("<span/>",{"tabindex":0,"data-csui-name":m,"data-csui-row-index":l,"data-toggle":"popover","role":"link","aria-label":s.titleColoutView,"class":"csui-button-icon icon-toolbar-more csui-colout-icon csui-show-colout-"+m+"_"+l});I=g;var M=0,S=h.length,A=0===t(o).width()?t(o).closest(".cs-metadata-properties").length>0?t(o).closest(".cs-metadata-properties").width()<=100?t(o).closest(".cs-metadata-properties").parents(".cs-dialog").width():t(o).closest(".cs-metadata-properties").width():t(o).closest(".form-metadata").width():t(o).width()<=100?t(o).parents(".metadata-inner-wrapper").length>0?t(o).parents(".metadata-inner-wrapper").width():t(o).parents(".cs-dialog").width():t(o).width();S<3&&t(o).closest(".alpaca-field-array").addClass("cs-single-field"),S===t(o).find(".csui-field-checkbox").length&&t(o).closest(".alpaca-field-array").addClass("cs-adjust-Checkbox-width");for(var T=0;T<h.length;T++){M+=parseInt(t(t(o).find(".alpaca-container-item")[T]).css("min-width"))}if(M<A/2&&!t(o).closest(".alpaca-field-array").hasClass("cs-adjust-width")&&t(o).closest(".alpaca-field-array").addClass("cs-adjust-width"),n.uniqueId=m,h&&h.length>0){if(t(o).closest(".cs-formview-wrapper").length){d=Math.floor(t(o).closest(".cs-formview-wrapper").width()-f+5)}else d=Math.floor((t(o).closest(".cs-metadata-properties").length>0?t(o).closest(".cs-metadata-properties").width()<=100?t(o).closest(".cs-metadata-properties").parents(".cs-dialog").width():t(o).closest(".cs-metadata-properties").width():t(o).closest(".form-metadata").width())-f);if(d<M&&(b=!0),!g&&x&&l>x-1&&(t(o).addClass("set-row-hidden"),E&&t(o).addClass("set-row-show")),!b)return(g?h.parent().parent():h.parent()).find(".csui-show-colout").remove(),h.closest(".cs-form-set-container").find(".binf-popover").remove(),t(this).parent().parent(".alpaca-field-array").removeClass("csui-set-locked-container"),t(this).parents(".alpaca-field-array").removeClass("csui-container-lockedcols"),void(t(this).find(".csui-lockedcols").length>0&&(t(e).find(".csui-set-scroll-container-parent").remove(),t(this).find(".csui-lockedcols").children().unwrap(),t(this).find(".csui-scrollablecols").children().unwrap(),t(this).find(".csui-shadowright-container").remove(),t(this).find(".csui-shadowleft-container").remove()));if(0===h.parent().find(".csui-show-colout").length&&h.length>=2){0===l?(t(y).append(w),t(w).append(V)):(t(y).append(k),t(k).append(V)),p=!0,g&&y.addClass("binf-hidden"),0===h.parent(".csui-lockedcols").length&&h.parent().prepend(y),t(o).find(".csui-show-colout-"+m+"_"+l).off("click keydown").on({"click":i.bind(n.showColout,n),"keydown":i.bind(n.keyDown,n)},n);var _=h.parent().children(),O=h;if(c=g?O.splice(0,1):_.splice(0,2),u=g?O:_,0===h.parent(".csui-lockedcols").length){var D=t("<div/>",{"id":i.uniqueId("lockedcols"),"class":"csui-lockedcols csui-colout-visible"});0===t(c).parent(".csui-lockedcols").length&&t(c).wrapAll(D),t(this).parent().parent(".alpaca-field-array").addClass("csui-set-locked-container");var R=t("<div/>",{"id":i.uniqueId("scrollablecols"),"class":"csui-scrollablecols csui-scrollable-"+m});0===u.parent(".csui-scrollablecols").length&&t(u).wrapAll(R),t(this).parents(".alpaca-field-array").addClass("csui-container-lockedcols"),l>0&&(r&&r.settings.rtl||(t(e).find(".csui-scrollablecols").scrollLeft(0),t(e).find(".csui-set-scroll-container-child").scrollLeft(0))),g&&(t(e).find(".csui-scrollablecols").addClass("csui-scrollable-writemode"),t(e).find(".csui-lockedcols").addClass("csui-lockedWriteMode"),t(this).parents(".cs-form-set-container").children().find(".csui-scrollablecols").prop("scrollLeft",0))}var P;P=g?c[0].classList[0]:c[1].classList[0],t(e).find(".csui-lockedcols").addClass(P+"-lockedcolumn")}else h.parent().find(".csui-show-colout.binf-hidden").length>0&&(p=!0)}if(r&&r.settings.rtl){var L=t(e).find(".csui-set-scroll-container-child");L.scrollLeft(L.scrollLeft()-1),L.scrollLeft(L.scrollLeft()+1)}t(e).find(".csui-set-scroll-container-child").perfectScrollbar("update"),t(e).on({"mouseenter":function(){t(this).hasClass("csui-hoveredScrollable")||(t(this).find(".csui-set-scroll-container-child").perfectScrollbar("update"),t(this).addClass("csui-hoveredScrollable"))},"mouseleave":function(){t(this).hasClass("csui-hoveredScrollable")&&t(this).removeClass("csui-hoveredScrollable")}}),l===a&&0===t(t(e).find(".csui-lockedcols")[a]).find(".csui-shadowleft-container").length&&t(t(e).find(".csui-lockedcols")[a]).append(C),l===a&&0===t(t(e).find(".csui-scrollablecols")[a]).closest(".cs-array").find(".csui-shadowright-container").length&&t(t(e).find(".csui-scrollablecols")[a]).closest(".cs-array").append(F)},n,t),p){if(l.isTouchBrowser()){t(e).addClass("is-touch");t(e).find(".alpaca-container-item .csui-scrollable-"+n.uniqueId);t(e).find(".csui-scrollable-"+n.uniqueId).scroll(function(){t(".csui-colout-formitems").is(":visible")&&c(),t(this).parents(".cs-form-set-container").children().find(".csui-scrollablecols").prop("scrollLeft",t(this).scrollLeft()),t(this).parents(".cs-form-set-container").children().find(".csui-scrollablecols").hasClass("csui-dropdown-open")&&t(this).parents(".cs-form-set-container").children().find(".csui-scrollablecols").removeClass("csui-dropdown-open")})}t(e).children(":not('.binf-popover')").each(function(i,n){t(this).find(".csui-current-focused").trigger("focus");var a=t(n).closest(".cs-form-set>.alpaca-container-item").attr("data-alpaca-container-item-name");t(e).find(".csui-scrollable-"+a).on("scroll",function(){t(".csui-colout-formitems").is(":visible")&&c(),r&&r.settings.rtl||(t(this).parents(".cs-form-set-container").children().find(".csui-scrollablecols").prop("scrollLeft",t(this).scrollLeft()),t(this).parents(".cs-form-set-container").find(".csui-set-scroll-container-child").prop("scrollLeft",t(this).scrollLeft()))})});var V="rtl"===n.domEl.css("direction")?"padding-right":"padding-left",M=t(e).find(".csui-scrollablecols").closest(".cs-array").find(".csui-shadowright-container").length,S=0!==t(e).find(".csui-set-scroll-container-parent").length;if(0===M)if(0===t(e).find(".csui-scrollablecols").closest(".cs-array").find(".csui-shadowright-container").length&&t(e).find(".csui-scrollablecols").closest(".cs-array").append(F),0===t(e).find(".csui-lockedcols").find(".csui-shadowleft-container").length&&t(e).find(".csui-lockedcols").append(C),S)t(e).find(".csui-set-scroll-container-child").perfectScrollbar({"suppressScrollY":!0}),t(e).find(".csui-set-scroll-container-child").perfectScrollbar("update");else{var A,T,_=t("<div/>",{"class":"csui-set-scroll-container-parent"}),O=t("<div/>",{"class":"csui-set-scroll-container-child"}),D=t("<div/>",{"class":"csui-scrollable-content .csui-scrollable-"+n.uniqueId}),R="update"===this.connector.config.formView.mode,P=t(e).closest(".binf-tab-content .cs-form").length>0?t(e).closest(".binf-tab-content .cs-form"):void 0!==t(e).closest(".cs-form.cs-form-update")&&t(e).closest(".cs-form.cs-form-update").length>0?t(e).closest(".cs-form.cs-form-update"):t(e).closest(".cs-form.cs-form-create"),L=parseInt(t(e).find(".csui-colout-icon:first").parent().parent().css("width").match(/\d/g).join(""));t(O).append(D),t(_).append(O),t(e).append(_),t(e).find(".csui-scrollablecols").prop("scrollLeft",0),t(e).find(".csui-set-scroll-container-child").prop("scrollLeft",0);var B=this;if(B.setEl=e,"resize"===n.eventType)o(e);else var N=setInterval(function(){o(e)},100);t(e).find(".csui-set-scroll-container-child").perfectScrollbar("update")}}else t(e).find(".csui-set-scroll-container-child").hasClass("ps-container")&&t(e).find(".csui-set-scroll-container-child").perfectScrollbar("update");var H=t(e).closest(".cs-form-set.cs-form-set-container").find(">.cs-array.alpaca-container-item");if("create"!==i.find(n.options.fields,function(e,i){return""!==e.mode}).mode&&x&&x>0&&H.length>x&&0===t(e).closest(".cs-form-set.cs-form-set-container").parent().find(".csui-show-more").length){var j,W,z=t("<div/>",{"class":"csui-show-more","aria-label":s.showMoreAria,"tabindex":0,"id":n.uniqueId});E?(t(e).closest(".cs-form-set.cs-form-set-container").addClass("set-row-show"),j=t("<label/>",{"class":"csui-set-show-more-label"}).text(s.showLess),W=t("<button/>",{"class":"csui-set-show-more-icon icon-expandArrowUp","aria-label":s.showLessAria})):(t(e).closest(".cs-form-set.cs-form-set-container").removeClass("set-row-show"),j=t("<label/>",{"class":"csui-set-show-more-label","title":s.showMore}).text(s.showMore),W=t("<button/>",{"class":"csui-set-show-more-icon icon-expandArrowDown","aria-label":s.showMoreAria,"title":s.showMore})),t(j).appendTo(z),t(W).appendTo(z),t(e).closest(".cs-form-set.cs-form-set-container").parent().append(z),E&&t(e).closest(".cs-form-set.cs-form-set-container").addClass("set-row-show"),t(z).off("click").on("click",n,n.showMoreOrLessColumns),t(z).off("keydown").on("keydown",n,function(e){13!==e.keyCode&&32!==e.keyCode||n.showMoreOrLessColumns(e)})}},"showMoreOrLessColumns":function(e){if(e.data&&!e.data.checkForFieldErrors(e)){var i=t(e.target).parents(".alpaca-field-array").find(".cs-form-set.cs-form-set-container"),n=t(e.target).parent();t(i).find(".set-row-show").length?(t(i).find(".set-row-hidden").removeClass("set-row-show"),t(n).find(".csui-set-show-more-icon").removeClass("icon-expandArrowUp").addClass("icon-expandArrowDown"),t(n).find(".csui-set-show-more-icon").attr({"aria-label":s.showMoreAria,"title":s.showMore}),t(n).find(".csui-set-show-more-label").html(s.showMore),t(n).find(".csui-set-show-more-label").attr({"aria-label":s.showMoreAria,"title":s.showMore})):(t(i).find(".set-row-hidden").addClass("set-row-show"),t(n).find(".csui-set-show-more-icon").removeClass("icon-expandArrowDown").addClass("icon-expandArrowUp"),t(n).find(".csui-set-show-more-icon").attr({"aria-label":s.showLessAria,"title":s.showLess}),t(n).find(".csui-set-show-more-label").html(s.showLess),t(n).find(".csui-set-show-more-label").attr({"aria-label":s.showLessAria,"title":s.showLess}))}e.preventDefault(),e.stopPropagation()},"checkForFieldErrors":function(e){var i=t(".cs-form .cs-formfield-invalid"),n=!1;return i.length>0&&(i.find(":input")[0].focus(),n=!0),n},"applyCreatedItems":function(e,i){var n=this.domEl.closest(".cs-metadata, .cs-formview-wrapper"),a=this,s={"data":{"model":e,"elements":e.items,"self":this}};this.base(e,i),this.restructureAllSetContainer(s),t(window).on("resize",{"model":e,"elements":e.items,"self":this},this.restructureAllSetContainer),n.on("toggled:navigationbar refresh:setcontainer",function(){a.restructureAllSetContainer(s)})},"getValue":function(){if(0===this.children.length&&!this.isRequired())return{};for(var e={},i=0;i<this.children.length;i++){var t=this.children[i].propertyId,n=this.children[i].getValue();if(void 0!==n&&this.determineAllDependenciesValid(t)){var s=void 0;s="boolean"==typeof n?!!n:(a.isArray(n)||a.isObject(n)||a.isNumber(n),n),void 0!==s&&(e[t]=s)}}return e}}),a.registerFieldClass("object",a.Fields.CsuiObjectField,"bootstrap-csui"),a.registerFieldClass("object",a.Fields.CsuiObjectField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiObjectField}),csui.define("csui/controls/form/impl/fields/arraybuttonsfield/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/form/impl/fields/arraybuttonsfield/nls/root/lang",{"title":"Remove Row"}),csui.define("hbs!csui/controls/form/impl/fields/arraybuttonsfield/arraybuttonsfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return'<button title="'+this.escapeExpression((a=null!=(a=i.title||(null!=e?e.title:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"title","hash":{}}):a))+'" class="binf-btn binf-btn-default binf-btn-sm removebtn binf-hidden">\r\n  <i class="csui-icon circle_delete"></i>\r\n</button>\r\n\r\n'}});return t.registerPartial("csui_controls_form_impl_fields_arraybuttonsfield_arraybuttonsfield",n),n}),csui.define("css!csui/controls/form/impl/fields/arraybuttonsfield/arraybuttonsfield",[],function(){}),csui.define("csui/controls/form/fields/arraybuttonsfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","i18n!csui/controls/form/impl/fields/arraybuttonsfield/nls/lang","hbs!csui/controls/form/impl/fields/arraybuttonsfield/arraybuttonsfield","css!csui/controls/form/impl/fields/arraybuttonsfield/arraybuttonsfield"],function(e,i,t,n,a,s){"use strict";return n.ItemView.extend({"constructor":function(e){n.ItemView.apply(this,arguments)},"className":"cs-formfield cs-arraybuttonsfield","template":s,"templateHelpers":function(){return{"title":a.title}},"ui":{"addButton":".addbtn","removeButton":".removebtn"},"events":{"click @ui.addButton":"onAddButtonClicked","click @ui.removeButton":"onRemoveButtonClicked"},"onAddButtonClicked":function(){},"onRemoveButtonClicked":function(){this.$el.closest(".cs-pull-left").parent().find(".cs-pull-right .circle_delete").parent().trigger("click")}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuiarraybuttonsfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/arraybuttonsfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r){return s.Fields.CsuiArrayButtonsField=s.Fields.TextField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"otcs_array_buttons"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"getValue":function(){return null},"showField":function(){this.fieldView=new l;var e=t("<div>").addClass("alpaca-control cs-alp-array-buttons");this.getControlEl().replaceWith(e),this.region=new a.Region({"el":e}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("otcs_array_buttons",s.Fields.CsuiArrayButtonsField,"bootstrap-csui"),t.alpaca.Fields.CsuiArrayButtonsField}),csui.define("csui/controls/form/impl/fields/reservebuttonfield/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/form/impl/fields/reservebuttonfield/nls/root/lang",{"reserved":"Reserved","unreserved":"Unreserved","unreserve":"Unreserve","reservedByUnreserve":"Reserved by {0}, Press to unreserve","reservedBy":"Reserved by {0}"}),csui.define("hbs!csui/controls/form/impl/fields/reservebuttonfield/reservebuttonfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a,s;return'  <div class="cs-field-read">\r\n    <div class="cs-field-read-inner">\r\n      <div class="btn-container">\r\n        <span class="csui-btn-reserve-status '+this.escapeExpression((s=null!=(s=i.noActionCSS||(null!=e?e.noActionCSS:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"noActionCSS","hash":{}}):s))+'">\r\n          <span tabindex="'+this.escapeExpression((s=null!=(s=i.tabIndex||(null!=e?e.tabIndex:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"tabIndex","hash":{}}):s))+'" data-cstabindex="'+this.escapeExpression((s=null!=(s=i.tabIndex||(null!=e?e.tabIndex:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"tabIndex","hash":{}}):s))+'"\r\n                class="csui-btn-reserve-status-action csui-icon '+this.escapeExpression((s=null!=(s=i.icon||(null!=e?e.icon:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"icon","hash":{}}):s))+'" role="button"\r\n                title="'+this.escapeExpression((s=null!=(s=i.tooltip||(null!=e?e.tooltip:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"tooltip","hash":{}}):s))+'" '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+'></span>\r\n          <span\r\n              class="csui-reserveby-status cs-formfield cs-userfield cs-formfield-readonly"></span>\r\n           <input id="'+this.escapeExpression((s=null!=(s=i.reserveid||(null!=e?e.reserveid:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"reserveid","hash":{}}):s))+'" class="binf-hidden" value="reserved" type="button">\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n'},"2":function(e,i,t,n){var a;return'aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{}}):a))+'"\r\n          '},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=e?e.reserved:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:""}});return t.registerPartial("csui_controls_form_impl_fields_reservebuttonfield_reservebuttonfield",n),n}),csui.define("css!csui/controls/form/impl/fields/reservebuttonfield/reservebuttonfield",[],function(){}),csui.define("csui/controls/form/fields/reservebuttonfield.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/models/nodes","csui/utils/commands","csui/utils/commands/unreserve","csui/utils/commandhelper","csui/utils/contexts/factories/user","csui/utils/contexts/factories/member","i18n!csui/controls/form/impl/fields/reservebuttonfield/nls/lang","hbs!csui/controls/form/impl/fields/reservebuttonfield/reservebuttonfield","css!csui/controls/form/impl/fields/reservebuttonfield/reservebuttonfield"],function(e,i,t,n,a,s,l,r,o,d,c,u,h){"use strict";return a.ItemView.extend({"constructor":function(e){if(e.data){this.connector=e.data?e.data.connector:void 0,this.unreserveCommand=new r,this.commandStatus={"nodes":new s([e.data.node])},this.canUnreserve=this.unreserveCommand.enabled(this.commandStatus);var i=e.data.node;i&&this.listenTo(i,"sync",this._checkEnabledAction)}if(a.ItemView.apply(this,arguments),this.options.data){if(this.reserved=this.options.data.node.get("reserved"),this.reservedSharedCollaboration=this.options.data.node.get("reserved_shared_collaboration"),this.options.data.options.context){var t=this.options.data.options.context.getModel(d);this.userId=t.get("id")}var n=this.options.data.attributes.data.reserved_user_id;this.reservedUser=this.options.connector.config.context.getModel(c,{"attributes":{"id":n},"options":{"id":n,"connector":this.options.connector},"temporary":!0}),this.reservedUser.ensureFetched(),this.reservedUser.on("change",this.render,this)}else this.reserved=!1,this.canUnreserve=!1,this.reservedSharedCollaboration=!1},"_checkEnabledAction":function(){this.canUnreserve=this.unreserveCommand.enabled(this.commandStatus),this.render()},"ui":{"btnReserveAction":".csui-btn-reserve-status-action"},"events":{"mousedown @ui.btnReserveAction":"onMouseDown","mouseup @ui.btnReserveAction":"onMouseUp","click @ui.btnReserveAction":"reserveAction"},"onMouseDown":function(e){this.canUnreserve&&(this.options.data.attributes.data.reserved_user_id===this.userId?t(this.$el.find(".csui-icon")).addClass("icon-reserved_self_md"):t(this.$el.find(".csui-icon")).addClass("icon-reserved_other_md"))},"onMouseUp":function(e){this.canUnreserve&&(this.options.data.attributes.data.reserved_user_id===this.userId?t(this.$el.find(".csui-icon")).removeClass("icon-reserved_self_md"):t(this.$el.find(".csui-icon")).removeClass("icon-reserved_other_md"))},"reserveAction":function(e){this.canUnreserve&&(this.options.data.beforeAction&&i.isFunction(this.options.data.beforeAction)&&this.options.data.beforeAction(),this.reserved?this.unreserve():this.reserve(),this.canUnreserve&&this.options.data.afterAction&&i.isFunction(this.options.data.afterAction)&&this.options.data.afterAction())},"onChange":function(){this.options.data.actionOnce&&(this.$el.off("click",".csui-btn-reserve-status"),this.$el.off("mouseover",".csui-btn-reserve-status"))},"reserve":function(){},"unreserve":function(){var e;this.canUnreserve&&(e=this.unreserveCommand.execute(this.commandStatus),o.handleExecutionResults(e,{"command":this.unreserveCommand,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage}))},"template":h,"templateHelpers":function(){var e,t="",n="",a=0;return this.reservedSharedCollaboration?e=this.options.data.attributes.data.reserved_user_id===this.userId?"icon-shared_collaborate_self":"icon-shared_collaborate_other":this.canUnreserve?e=this.options.data.attributes.data.reserved_user_id===this.userId?"icon-reserved_metadata_self":"icon-reserved_metadata_other":this.options.data&&this.options.data.attributes.data.reserved_user_id!==this.userId?e="icon-reserved_metadata_other":this.options.data&&this.options.data.attributes.data.reserved_user_id===this.userId&&(e="icon-reserved_metadata_self"),this.canUnreserve&&this.reserved?(t=u.unreserve,this.reservedUser&&(t=i.str.sformat(u.reservedByUnreserve,this.reservedUser.get("display_name")))):a=-1,this.canUnreserve||(n="csui-btn-reserve-no-action"),{"noActionCSS":n,"icon":e,"tooltip":t,"reserved":this.reserved,"reserveid":this.id,"reservedSharedCollaboration":this.reservedSharedCollaboration,"idBtnLabel":this.options.labelId,"tabIndex":a}},"onRender":function(){if(this.reserved){var e=this,n=this.$el.find(".csui-reserveby-status");csui.require(["esoc/controls/userwidget/userwidget.view"],function(s){var l={"userid":e.options.data.attributes.data.reserved_user_id,"context":e.options.connector.config.context,"baseElement":n,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.userId,"connector":e.connector,"prettyScrolling":!0,"source":"extendedInfoText","parentView":e};e.region=new a.Region({"el":n});var r=function(){e.reservedUser&&n.find("a.esoc-user-container").attr("aria-label",i.str.sformat(u.reservedBy,e.reservedUser.get("display_name")))};e.listenToOnce(e,"view:shown",function(){r()});var o=new s(l);o.listenToOnce(o,"attach",function(){var i=t.Event("tab:content:field:changed");e.$el.trigger(i),r()}),e.region.show(o)})}}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuireservebuttonfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/reservebuttonfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r){return s.Fields.CsuiReserveButtonField=s.Fields.TextField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"otcs_reserve_button"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"getValue":function(){var e=this,i=this.data;return i=e.ensureProperType(i)},"showField":function(){var e,n=(this.id,t(this.field[0]).find("label"));n&&1==n.length&&(e=n.attr("for")+"Label",n.attr("id",e)),this.options.labelId=e,this.fieldView=new l(i.extend(this)),this.fieldView.$el.attr("id",i.uniqueId(this.id));var s=t("<div>").addClass("alpaca-control");this.containerItemEl.find(".alpaca-control").replaceWith(s),this.region=new a.Region({"el":s}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("otcs_reserve_button",s.Fields.CsuiReserveButtonField,"bootstrap-csui"),t.alpaca.Fields.CsuiReserveButtonField}),csui.define("hbs!csui/controls/form/impl/fields/tklfield/tklfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return'aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{}}):a))+'"'},"3":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{}}):a))+'" '},"5":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{}}):a))+'" '},"7":function(e,i,t,n){var a;return'aria-required="'+this.escapeExpression((a=null!=(a=i.ariaRequired||(null!=e?e.ariaRequired:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"ariaRequired","hash":{}}):a))+'"'},"9":function(e,i,t,n){var a;return'              <li id="'+this.escapeExpression((a=null!=(a=i.id||(null!=e?e.id:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"id","hash":{}}):a))+'" role="option"><a tabindex="-1" title="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+"</a></li>\r\n"},"11":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{}}):a))+'"></div>\r\n      </div>\r\n'},"13":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=e?e.applyFlag:e,{"name":"if","hash":{},"fn":this.program(14,n,0),"inverse":this.noop}))?a:""},"14":function(e,i,t,n){var a;return'        <div class="icon-container">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{}}):a))+'" tabindex="0"\r\n               data-cstabindex="0"></div>\r\n        </div>\r\n'},"16":function(e,i,t,n){return' aria-disabled="true" '},"18":function(e,i,t,n){var a;return'aria-label="'+this.escapeExpression((a=null!=(a=i.readModeMultiFieldAria||(null!=e?e.readModeMultiFieldAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeMultiFieldAria","hash":{}}):a))+'"'},"20":function(e,i,t,n){var a;return'aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{}}):a))+'"'},"22":function(e,i,t,n){var a;return'          <span title="'+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=i.data||(null!=e?e.data:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"data","hash":{}}):a))+"</span>\r\n"},"24":function(e,i,t,n){var a;return'          <span class="placeholder" title="'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{}}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <div class="cs-tklfield-select">\r\n      <div class="cs-tkl-search-box">\r\n        <input type="text" placeholder="'+this.escapeExpression((s=null!=(s=i.emptyLabel||(null!=e?e.emptyLabel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"emptyLabel","hash":{}}):s))+'" value="'+this.escapeExpression((s=null!=(s=i.data||(null!=e?e.data:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"data","hash":{}}):s))+'"\r\n          '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n          "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop
}))?a:"")+"\r\n          "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+' aria-owns="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'"\r\n          '+(null!=(a=i.if.call(e,null!=e?e.ariaRequired:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop}))?a:"")+' id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'" aria-autocomplete="list" role="combobox" autocomplete="off">\r\n      </div>\r\n      <div class="cs-tkl-options-container">\r\n        <div>\r\n          <ul class="cs-tkl-options" role="listbox">\r\n            <li id="'+this.escapeExpression((s=null!=(s=i.noneOptionId||(null!=e?e.noneOptionId:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"noneOptionId","hash":{}}):s))+'" role="option"><a tabindex="-1" title="'+this.escapeExpression((s=null!=(s=i.emptyLabel||(null!=e?e.emptyLabel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"emptyLabel","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.emptyLabel||(null!=e?e.emptyLabel:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"emptyLabel","hash":{}}):s))+"</a></li>\r\n"+(null!=(a=i.each.call(e,null!=e?e.options:e,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop}))?a:"")+"          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"+(null!=(a=i.if.call(e,null!=e?e.isNotWriteOnly:e,{"name":"if","hash":{},"fn":this.program(11,n,0),"inverse":this.program(13,n,0)}))?a:"")+'  </div>\r\n</div>\r\n\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <button '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(16,n,0),"inverse":this.noop}))?a:"")+"\r\n          "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(18,n,0),"inverse":this.program(20,n,0)}))?a:"")+" >\r\n"+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(22,n,0),"inverse":this.program(24,n,0)}))?a:"")+'      </button>\r\n    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_form_impl_fields_tklfield_tklfield",n),n}),csui.define("csui/controls/form/impl/tkl/cstklfield.editable.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.editable.behavior","csui/controls/form/pub.sub","csui/utils/log"],function(e,i,t,n,a,s,l,r,o){"use strict";return l.extend({"constructor":function(e,t){l.prototype.constructor.apply(this,arguments),this.view=t,this.view.getEditableBehavior=i.bind(function(){return this},this),this.isValidTKLState=!0},"updateNonTKLSilently":function(){r.tklHelpers&&r.tklHelpers.viewsInWriteMode.map(function(e){e.isNonTKLField&&(e.setValue(e.getEditValue(),!0,!0),e.render())})},"isRelatedFieldInFocus":function(e){return e=e||document.activeElement,r.tklHelpers&&r.tklHelpers.viewsInWriteMode.some(function(i){return i.ui.writeField[0]===e})},"onFocusOutWrite":function(e){t(e.target).parents(".csui-normal-scrolling").css("overflow","auto"),this.view.resetHelpers(!0);var i=this,n=!1;if(r.tklHelpers)for(var a=0;!n&&a<r.tklHelpers.viewsInWriteMode.length;a++)n=r.tklHelpers.viewsInWriteMode[a].getEditableBehavior().mouseDownCancel||r.tklHelpers.viewsInWriteMode[a].getEditableBehavior().escapePressed;var s=this.isRelatedFieldInFocus(e.relatedTarget);setTimeout(function(){if(!i.view.shouldValidate()||n||i.isRelatedFieldInFocus(e.relatedTarget))return void(t.contains(i.view.ui.tklOptions[0],e.relatedTarget)||i.view.hideDropdown());var a,l=!0,o=!1;if(r.tklHelpers)for(var d,c=0;r.tklHelpers&&c<r.tklHelpers.viewsInWriteMode.length;c++)a=r.tklHelpers.viewsInWriteMode[c],r.tklHelpers.viewsInWriteMode[c].isNonTKLField?r.tklHelpers.viewsInWriteMode[c].getEditableBehavior():r.tklHelpers.viewsInWriteMode[c],d="select"===a.alpacaField.type?a.getEditValue().get("id"):a.getEditValue(),l&&(l=a.alpacaField.setValueAndValidate(d,!0)),o||(o=!!r.tklHelpers&&r.tklHelpers.viewsInWriteMode[c].getEditValue()!==r.tklHelpers.viewsInWriteMode[c].getOldValue());if(i.view.isReadyToSave()||n||s)return void(i.mouseDownCancel=!1);if(l){if("writeonly"===i.view.mode&&0===document.querySelectorAll(".binf-has-error").length&&(t(".metadata-validation-error").hide(),t("div").removeClass("show-validation-error")),o){if("writeonly"===i.view.mode&&r.tklHelpers)for(var u=0;u<r.tklHelpers.viewsInWriteMode.length;u++)r.tklHelpers.viewsInWriteMode[u]._raiseValueChanged(),i.updateNonTKLSilently();else i.view._raiseValueChanged(),i.updateNonTKLSilently();i.view&&i.view.formView&&i.view.formView.trigger("disable:active:item")}if(i.$el.removeClass("cs-formfield-invalid"),"writeonly"!==i.view.mode){if(r.tklHelpers){for(var h=r.tklHelpers.viewsInWriteMode.length-1;r.tklHelpers&&h>=0;h--){var p=r.tklHelpers.viewsInWriteMode[h];p&&(p===i.view,p.getEditableBehavior().isMultiFieldView(p)?"write"===p.getStatesBehavior().state&&(p=p.alpacaField.parent,p.options.submittedData=p.getValue().slice(),p._showItemsInReadMode(),p._hideInlineDeleteIcon(),p._hideInlineAddIcon(),p._showBulkEditAction()):(p.oldVal=p.curVal,p.getStatesBehavior().setStateRead()))}delete r.tklHelpers}document.activeElement===document.body&&i.view.ui.readField.trigger("focus").trigger("focus")}i.view.alpacaField.domEl.find(".cs-formfield-invalid").removeClass("cs-formfield-invalid"),"writeonly"===i.view.mode&&0===document.querySelectorAll(".binf-has-error").length&&(t(".metadata-validation-error").hide(),t("div").removeClass("show-validation-error")),i.view.needRerender&&i.view.render()}else"write"===i.view.getStatesBehavior().state&&(i.isValidTKLState=!1,i.$el.addClass("cs-formfield-invalid"))},0)},"onReadAreaClicked":function(e){var i=this,n=this.view.allowEditOnClickReadArea(e);i.view.alpacaField.parent.cancelClicked=!1,(t(e.target).hasClass("icon-edit")||n)&&(e.stopImmediatePropagation(),e.preventDefault()),setTimeout(function(){return"create"===i.options.mode||0!==document.querySelectorAll(".cs-form .cs-formfield-invalid").length?(document.querySelector(".cs-form .cs-formfield-invalid input, .cs-form .cs-formfield-invalid .cs-field-write button").focus(),!1):!i.view.getStatesBehavior().isReadOnly()&&void((t(e.target).hasClass("icon-edit")||n)&&i.setViewStateWriteAndEnterEditMode())},100)},"trySetValueAndLeaveEditMode":function(e,i){var t=this.areAllFieldsValid();if(t){if(this.isValidTKLState=!0,"writeonly"!==this.view.mode){this.updateNonTKLSilently();for(var n,a=r.tklHelpers.viewsInWriteMode.length-1;r.tklHelpers&&a>=0;a--)(n=r.tklHelpers.viewsInWriteMode[a])&&(n&&n.getEditableBehavior().isMultiFieldView(n)?"write"===n.getStatesBehavior().state&&(n=n.alpacaField.parent,n.options.submittedData=n.getValue().slice(),n._showItemsInReadMode(),n._hideInlineDeleteIcon(),n._hideInlineAddIcon(),n._showBulkEditAction()):(n.oldVal=n.curVal,n.getEditableBehavior().setViewReadOnlyAndLeaveEditMode(e,!1)))}!!i&&this.view.ui.readField.trigger("focus")}else this.isValidTKLState=!1},"onCancelClicked":function(){this.view.resetOldValueAfterCancel(),r.tklHelpers&&0===r.tklHelpers.viewsInWriteMode.length&&delete r.tklHelpers},"onMouseDown":function(){r.tklHelpers&&i.each(r.tklHelpers.viewsInWriteMode,function(e){e.cancelClicked=!1,e.alpacaField.parent.cancelClicked=!1,e.getEditableBehavior().escapePressed=!1,e.getEditableBehavior().mouseDownCancel=!1})},"onKeyDown":function(e){r.tklHelpers&&i.each(r.tklHelpers.viewsInWriteMode,function(e){e.getEditableBehavior().escapePressed=!1,e.getEditableBehavior().tabPressed=!1}),27==e.keyCode?this.view.getStatesBehavior().isStateWrite()&&(e.preventDefault(),e.stopPropagation(),this.escapePressed=!0,this.view.$el.find(".csui-icon-edit.edit-cancel").trigger("click")):113===e.keyCode?this.view.getStatesBehavior().isStateRead()?this.setViewStateWriteAndEnterEditMode():this.view.getStatesBehavior().isStateWrite()&&(this.trySetValueAndLeaveEditMode(!0,!0),this.isValidTKLState&&this.areAllFieldsValid()&&this.view._raiseValueChanged()):9===e.keyCode&&("create"!==this.view.alpacaField.options.mode&&this.view.getStatesBehavior().isStateWrite()&&this.moveTab(e),this.tabPressed=!0,r.tklHelpers&&i.each(r.tklHelpers.viewsInWriteMode,function(e){e.getEditableBehavior().tabPressed=!0}))},"onKeyPress":function(e){if(!this.view.onKeyPress||!this.view.onKeyPress(e))return 13===e.keyCode&&(this.view.getStatesBehavior().isStateRead()&&this.view.allowEditOnEnter()?this.setViewStateWriteAndEnterEditMode():this.view.getStatesBehavior().isStateWrite()&&this.view.allowSaveOnEnter()&&(e.preventDefault(),e.stopPropagation(),this.trySetValueAndLeaveEditMode(!0,!0),this.isValidTKLState&&this.view._raiseValueChanged())),!0},"areAllFieldsValid":function(){var e,i=!0;return r.tklHelpers&&r.tklHelpers.viewsInWriteMode.map(function(t){e="select"===t.alpacaField.type?t.getEditValue().get("id"):t.getEditValue(),i=t.alpacaField.setValueAndValidate(e,!0)&&i}),i}})}),csui.define("csui/controls/form/impl/tkl/tklinfinite.scrolling.behavior",["csui/lib/underscore","csui/lib/jquery","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/utils/base"],function(e,i,t,n){return t.extend({"constructor":function(e,i){t.prototype.constructor.apply(this,arguments),this.eventsName="scroll."+this.view.cid,void 0!==window.onwheel?this.eventsName+=" wheel.":void 0!==window.onmousewheel&&(this.eventsName+=" mousewheel."),this.eventsName+=this.view.cid},"_bindScrollingEvents":function(){var i=this.options.contentParent;this._contentParent=i?this.view.$(i):this.view.$el,this._contentParent.on(this.eventsName,e.bind(this._checkScrollPosition,this)),n.isTouchBrowser()&&this._contentParent.one("touchstart."+this.view.cid,e.bind(this._checkScrollPosition,this));var t=this.options.content;this._content=t?this.view.$(t):i?this._contentParent.children().first():this.view.$el},"_checkScrollPosition":function(t){if(this.view.fetchMore){var n,a=this.options.fetchMoreItemsThreshold;n=1===this._content.length?this._content.height():e.reduce(this._content,function(e,t){return e+i(t).height()},0);var s=n-this._contentParent.height();(100*this._contentParent.scrollTop()/s>=a||this._contentParent.outerHeight()>n)&&this._checkScrollPositionFetch(t),t.stopPropagation()}},"_checkScrollPositionFetch":function(e){this.view.isPullingValues||this.view.pullValidValues(null,!0)},"_unbindScrollingEvents":function(){this._contentParent&&this._contentParent.off(this.eventsName)}})}),csui.define("hbs!csui/controls/form/impl/fields/tklfield/tkloptions.loading",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){return'<li role="menuitem" class="csui-loading-parent-wrapper binf-disabled">\r\n  <span class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </span>\r\n</li>'}});return t.registerPartial("csui_controls_form_impl_fields_tklfield_tkloptions.loading",n),n}),csui.define("css!csui/controls/form/impl/fields/tklfield/tklfield",[],function(){}),csui.define("csui/controls/form/fields/tklfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","hbs!csui/controls/form/impl/fields/tklfield/tklfield","csui/controls/form/impl/array/csformarrayfield.editable.behavior","csui/controls/form/impl/array/csformarrayfield.states.behavior","csui/controls/form/impl/tkl/cstklfield.editable.behavior","csui/controls/form/impl/fields/csformfield.states.behavior","csui/controls/form/pub.sub","csui/utils/base","csui/utils/url","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/form/impl/tkl/tklinfinite.scrolling.behavior","i18n!csui/controls/form/impl/nls/lang","hbs!csui/controls/form/impl/fields/tklfield/tkloptions.loading","css!csui/controls/form/impl/fields/tklfield/tklfield"],function(e,i,t,n,a,s,l,r,o,d,c,u,h,p,f,m,g){"use strict";return a.extend({"constructor":function(t){this.dropdownMenuVisible=!1,t.model.attributes.options&&t.model.attributes.options.isMultiFieldItem?this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":l},"FormFieldStates":{"behaviorClass":r}},this.behaviors):this.behaviors=e.extend({"FormFieldEditable":{"behaviorClass":o},"FormFieldStates":{"behaviorClass":d}},this.behaviors),this.alpacaField=t.alpacaField,this.isServerTypeahead=-1===["NONE",null].indexOf(this.alpacaField.schema.typeAheadSearch),this.isServerTypeahead&&(this.pageIndex=0,this.fetchMore=!0,this.behaviors=e.extend({"TKLInfiniteScrollingBehavior":{"behaviorClass":f,"contentParent":".cs-tkl-options-container > div","fetchMoreItemsThreshold":98,"content":".cs-tkl-options"}},this.behaviors)),n.ItemView.prototype.constructor.apply(this,arguments),this.mode=this.options.mode,this.mode=this.options.alpaca&&this.options.alpaca.schema.readonly?"readonly":"read",this.options.alpaca&&t.alpaca.options.setRequiredFieldsEditable&&"readonly"!==this.mode&&(this.mode="writeonly"),this.alpacaField=this.options.alpacaField,this.curVal=this.options.alpaca.data||"",this.options.hasValue=0===this.curVal||!!this.curVal,this.oldVal=this.curVal,this.valuesPulled=!1,this.isPullingValues=!1,this.options.enum=[],this.options.alpacaField.connector.config.formView.options&&this.options.alpacaField.connector.config.formView.options.node?this.node=this.options.alpacaField.connector.config.formView.options.node:this.node=this.options.alpacaField.connector.config.formView.node,this.formView=this.alpacaField.connector.config.formView,this.isCustomView=!!this.formView.options.customView,this.isCustomView&&(this.templateId=this.formView.options.templateId),this.connector=this.isCustomView?this.formView.model.connector:this.node?this.node.connector:this.options.alpacaField.connector,this.catId=this.isCustomView?this.options.alpaca.schema.fieldID.split("_")[0]:this.options.dataId.split("_")[0],this.parentViews=[],this.children=[];var a;if(this.isSetType=this.alpacaField.parent&&this.alpacaField.parent.parent,this.isSetType&&(this.isSetType=this.isSetType.parent&&this.isSetType.parent.options.isSetType),this.alpacaField.options.isMultiFieldItem&&this.alpacaField.parent.schema.maxItems>1?(a=this.alpacaField.parent.propertyId,this.isSetType&&a&&a.indexOf("x")>-1&&(a+="_"+this.alpacaField.parent.parent.name.split("_").pop()),c.off(a+"tkl:buildRelation"),this.listenTo(c,a+"tkl:buildRelation",this.buildRelation),c.trigger(a+"tkl:rebuildRelation",this)):(a=this.isCustomView?this.alpacaField.schema.fieldID:this.alpacaField.propertyId)&&(this.isSetType&&(a+="_"+this.alpacaField.parent.name.split("_").pop()),c.off(a+"tkl:buildRelation"),this.listenTo(c,a+"tkl:buildRelation",this.buildRelation)),this.formView){var s=e.bind(function(){e.each(this.options.alpaca.schema.parents,function(e){-1!==e.indexOf("_x_")&&(this.isMultiFieldView()?e+="_"+this.alpacaField.parent.parent.name.split("_").pop():e+="_"+this.alpacaField.parent.name.split("_").pop()),c.trigger(e+"tkl:buildRelation",this),this.listenTo(c,e+"tkl:rebuildRelation",this.rebuildRelation,e),this.listenTo(c,e+"tkl:asyncBuildRelation",this.asyncBuildRelation)},this)},this);this.formView.isRenderFinished()?s():this.listenTo(this.formView,"render:form",s)}this.listenTo(this,"tkl:refresh",this.refresh),this.listenTo(this.model,"change",this.render),this.relationsFiltered=!1,i.expr.pseudos.ibegins=function(e,t,n){var a=i(e),s=a.text().toString().toUpperCase();return s.startsWith?s.startsWith(n[3].toUpperCase()):0===s.indexOf(n[3].toUpperCase())},this.isValidTKLState=!0},"className":"cs-formfield cs-tklfield","template":s,"templateHelpers":function(){var i="",t=m.noValue,n=this.options.alpacaField&&this.options.alpacaField.isRequired(),a="readonly"===this.mode,s="";s=n?m.requiredField:"",this.model.get("data")&&(t=this.model.get("data")),this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(i=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:"");var l=e.uniqueId("tklitem");return{"options":this.options.enum.map(function(i){return{"name":i,"id":e.uniqueId("tklitem")}}),"noneOptionId":l,"isNotWriteOnly":"writeonly"!==this.mode,"hasData":this.options.hasValue,"notRequired":!this.options.alpaca.schema.required,"data":this.curVal,"emptyLabel":m.tklFieldNone,"applyFlag":this.options.model.get("options")?this.options.model.get("options").applyFlag:void 0,"writeonlyMode":"writeonly"===this.mode,"idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"multiFieldLabel":i,"readModeAria":a?e.str.sformat(m.fieldReadOnlyAria,this.model.get("options").label,t)+s:e.str.sformat(m.fieldEditAria,this.model.get("options").label,t)+s,"readModeMultiFieldAria":e.str.sformat(m.fieldEditAria,i,t)+s,"ariaRequired":n}},"behaviors":{"PerfectScrolling":{"behaviorClass":p,"contentParent":".cs-tkl-options-container > div","suppressScrollX":!0}},"ui":{"writeField":".cs-field-write input","readField":".cs-field-read button","tklOptionsContainer":".cs-tkl-options-container","tklOptions":".cs-tkl-options"},"events":function(){return this.alpacaField&&this.alpacaField.schema.disabled?{}:{"click @ui.readField":"pullValidValues","click @ui.tklOptions a":"onClick","keyup @ui.writeField":e.debounce(this.isServerTypeahead?this.pullValidValues:this.search,800),"mouseup @ui.writeField":"_onMouseUpWriteField","keydown .cs-tklfield-select":"accessibility","change .cs-tklfield-select ":"inputValidations"}},"setFocus":function(){return!0},"onRender":function(){this.searchBase=this.ui.tklOptions.find("li");var i=this;this.$el.on("csui.document.active.tkl",function(e,t){t.documentActiveTKL=i});var t=e.uniqueId("tklOptionsContainer");this.ui.tklOptions.attr("id",t)},"onDestroy":function(){this.$el.off("csui.document.active.tkl")},"_onMouseUpWriteField":function(e){if(this.ui.tklOptionsContainer.hasClass("binf-show"))this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(e);else{this.ui.tklOptions.find(".active").removeClass("active"),this.searchBase.first().addClass("active"),this.showOptions(e);var i=this.searchBase.not(':ibegins("'+e.target.value.toLowerCase()+'")');i=i.not(":first").addClass("binf-hidden"),this.searchBase.not(i).removeClass("binf-hidden"),this.ui.writeField.attr("aria-activedescendant",this.searchBase.first().attr("id"))}},"search":function(e){var t,n=i(e.target).val(),a=[9,13,16,32,38,40,113,27];if(n&&-1===a.indexOf(e.keyCode)){this.ui.tklOptions.find(".cs-tkl-no-result").remove(),this.showOptions();var s=this.searchBase.not(':ibegins("'+n.toLowerCase()+'")');if(s.addClass("binf-hidden"),this.searchBase.not(s).removeClass("binf-hidden"),this.triggerMethod("update:scrollbar"),t=this.searchBase.filter(":visible"),0===t.length)this.ui.tklOptions.append(i('<li class="cs-tkl-no-result"><a tabindex="-1">'+m.noResultFound+"</a></li>"));else{s.first().removeClass("binf-hidden").addClass("active"),this.ui.tklOptions.find(".active").removeClass("active");var l=t.first();l.addClass("active"),this.ui.writeField.attr("aria-activedescendant",l.attr("id"))}}else if(e.target.value)this.isMultiFieldView(this)||-1!==i.inArray(e.keyCode,[13,113])&&this.trySetValue();else if(this.ui.tklOptions.find(".cs-tkl-no-result").remove(),this.searchBase.removeClass("binf-hidden"),-1===[38,40].indexOf(e.keyCode)){this.ui.tklOptions.find(".active").removeClass("active");var r=this.searchBase.first();r.addClass("active"),this.ui.writeField.attr("aria-activedescendant",r.attr("id"))}if(27===e.keyCode&&"create"===this.options.mode){this.dropdownMenuVisible&&(e.preventDefault(),e.stopPropagation());var o=this.$el.find(".icon-container");o.first().addClass("binf-hidden"),o.attr("data-cstabindex",-1),o.attr("tabindex",-1)}this.dropdownMenuVisible=!1},"showOptions":function(t){var n=this.$el.closest(".csui-scrollable-writemode");n&&!n.hasClass("csui-dropdown-open")&&n.addClass("csui-dropdown-open"),!this.isPullingValues&&this.pullValidValues(),this.adjustPosition(),this.ui.tklOptionsContainer.addClass("binf-show"),this.searchBase.filter(":visible").length>0&&this.getEditableBehavior().hideActions?(this.options.isDropDownOpen=!0,this.getEditableBehavior().hideActions(t)):this.options.isDropDownOpen=!1,!!t&&t.stopPropagation(),this.ui.writeField.attr("aria-expanded",!0),i(document).on("mouseup.tkl.options",e.bind(this.hideOptions,this))},"adjustPosition":function(){var i=this.$el.find("input");setTimeout(e.bind(function(){u.adjustDropDownField(i,this.ui.tklOptionsContainer,!0,this,this.hideDropdown,this.ui.tklOptions.parent())},this),200)},"hideDropdown":function(e){e||(e=this),e.hideOptions(),e.getEditableBehavior().showActions&&e.getEditableBehavior().showActions(),e.options.isDropDownOpen=!1;var i=e.$el.closest(".csui-scrollable-writemode");i&&i.hasClass("csui-dropdown-open")&&i.removeClass("csui-dropdown-open")},"hideOptions":function(e){e&&i(document.activeElement).is(i(e.target))||i(".cs-tkl-options-container.binf-show").removeClass("binf-show"),this.ui.writeField.attr("aria-expanded",!1),this.options.isDropDownOpen=!1,i(document).off("mouseup.tkl.options",this.hideOptions)},"accessibility":function(e){if(-1!==[38,40,113,13].indexOf(e.keyCode)){if((13===e.keyCode||113===e.keyCode)&&!this.$el.find(".cs-tkl-options").is(":visible"))return void(e.target.value.length||(this.setValue(""),this.changeChildrenValues(this.children)));this.isServerTypeahead||this.showOptions();var t=this.searchBase.filter(":visible"),n=t.index(t.filter(".active")),a=!1,s=this.$el.parents(".binf-form-group.alpaca-field");if(t.filter(".active").removeClass("active"),38===e.keyCode)n=-1===n||0===n?t.length-1:n-1;else if(40===e.keyCode)n=-1===n||n===t.length-1?0:n+1;else if(13===e.keyCode||113===e.keyCode){if(t[n]&&t[n].children[0]&&(i(t[n].children[0]).trigger("click"),a=!0),this.options.alpacaField.isRequired()){var l=this.curVal;""!==l?(this.isValidTKLState=!0,s.removeClass("binf-has-error alpaca-invalid"),this.$el.removeClass("cs-formfield-invalid"),s.find(".binf-help-block.alpaca-message.alpaca-message-notOptional").hide()):this.isValidTKLState=!1}else this.isValidTKLState=!0,s.removeClass("binf-has-error alpaca-invalid"),this.$el.removeClass("cs-formfield-invalid");this.inputValidations(e)}if(this.ui.writeField.attr("aria-activedescendant",i(t[n]).attr("id")),i(t[n]).addClass("active"),38===e.keyCode||40===e.keyCode||a){var r=t[n]&&i(t[n].children[0]).parent();r&&!a&&this._scrollIntoView(r),e.stopPropagation(),e.preventDefault()}}else 27===e.keyCode&&this.ui.tklOptionsContainer.is(":visible")&&(e.preventDefault(),e.stopPropagation(),this.dropdownMenuVisible=this.ui.tklOptionsContainer.is(":visible"),this.hideOptions(),this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(e),this.options.isDropDownOpen=!1),9===e.keyCode&&this.$el.find(".cs-tkl-options").is(":visible")&&(e.preventDefault(),e.stopPropagation(),this.dropdownMenuVisible=this.ui.tklOptionsContainer.is(":visible"),this.hideOptions(),this.options.isDropDownOpen=!1)},"_scrollIntoView":function(e){var i=e,t=e.parent().parent(),n=i.height(),a=i.offset().top-t.offset().top,s=t.scrollTop(),l=t.height();a<0?t.scrollTop(s+a):a+n>l&&t.scrollTop(s+a+2*n-l)},"inputValidations":function(t){var n=this.ui.writeField.val(),a=this.options.enum;""===n?(this.setValue(n,!0),this.setSelection(i(t.target).closest("li"),!1,!0),this.isValidTKLState=!0,this.needRerender=!0):("number"==typeof a[0]&&(n=Number(n)),e.contains(a,n)||(this.isValidTKLState=!1),delete this.needRerender)},"buildRelation":function(e,i){this.isMultiFieldView(this)?(-1===e.parentViews.indexOf(this.alpacaField.parent)&&(this.pushView(e.parentViews,this.alpacaField.parent),e.alpacaField.parent.parentRelations||(e.alpacaField.parent.parentRelations=[]),-1===e.alpacaField.parent.parentRelations.indexOf(this.alpacaField.parent)&&this.pushView(e.alpacaField.parent.parentRelations,this.alpacaField.parent)),this.alpacaField.parent.children.map(function(e){e.fieldView.children=this.children},this)):this.pushView(e.parentViews,i||this),this.isMultiFieldView(e)?-1===this.children.indexOf(e.alpacaField.parent)&&(this.pushView(this.children,e.alpacaField.parent),this.alpacaField.parent.childRelations||(this.alpacaField.parent.childRelations=[]),-1===this.alpacaField.parent.childRelations.indexOf(e.alpacaField.parent)&&this.pushView(this.alpacaField.parent.childRelations,e.alpacaField.parent)):this.pushView(this.children,e)},"pushView":function(e,i){-1===e.indexOf(i)&&e.push(i)},"rebuildRelation":function(e){this.isMultiFieldView(this)?(this.pushView(e.children,this.alpacaField.parent),this.pushView(this.parentViews,e.alpacaField.parent)):(this.pushView(e.children,this),this.pushView(this.parentViews,e))},"asyncBuildRelation":function(e){this.parentViews=this.parentViews?this.parentViews:[],this.pushView(this.parentViews,e),this.pushView(e.childTKLViews,this)},"filterRelations":function(){if(!this.relationsFiltered&&"writeonly"!==this.mode){var i,t,n,a=[],s=[];e.each(this.children,function(e){for(t=!1,i=this.normalizeViews(e),n=0;n<i.length&&!t;n++)i[n]&&i[n].$el.is(":visible")&&(t=!0);t&&this.pushView(s,e)},this),this.children=s,e.each(this.parentViews,function(e){for(t=!1,i=this.normalizeViews(e),n=0;n<i.length&&!t;n++)i[n].$el.is(":visible")&&(t=!0);t&&this.pushView(a,e)},this),this.parentViews=a,this.relationsFiltered=!0}},"isTKLField":!0,"setValue":function(e,i){"write"===this.getStatesBehavior().state&&this.ui.writeField.val(e),this.options.alpacaField.setValue(e),this.curVal=e,this.options.alpaca.data=e,this.options.hasValue=0===e||!!e,this.model.set("data",e,{"silent":!!i})},"getOldValue":function(){return this.oldVal},"getEditValue":function(){return this.curVal},"getValue":function(){return this.curVal},"setMode":function(e){this.mode=e,this.getStatesBehavior().state=void 0},"getEditableBehavior":function(){return this._behaviors[0]},"getStatesBehavior":function(){return this._behaviors[1]},"getDocumentActiveTKL":function(){var e={"documentActiveTKL":void 0},t="BODY"===document.activeElement.tagName?void 0:i(document.activeElement);if(t&&!t.hasClass("cs-tklfield")){var n=t.closest(".cs-formfield.cs-tklfield");n.length>0?t=n:(n=t.closest(".cs-pull-right").siblings(".cs-pull-left").find(".cs-formfield.cs-tklfield"),0===n.length&&(n=t.find(".cs-pull-left .cs-formfield.cs-tklfield")),t=n)}return!!t&&t.hasClass("cs-tklfield")&&t.trigger("csui.document.active.tkl",[e]),e.documentActiveTKL},"shouldValidate":function(){return!i.contains(this.$el[0],document.activeElement)},"isReadyToSave":function(){for(var e=i.contains(this.$el[0],document.activeElement),t=0;!e&&c.tklHelpers&&t<c.tklHelpers.viewsInWriteMode.length;t++)e=this.isMultiFieldView(c.tklHelpers.viewsInWriteMode[t])?i.contains(c.tklHelpers.viewsInWriteMode[t].alpacaField.parent.getFieldEl()[0],document.activeElement):i.contains(c.tklHelpers.viewsInWriteMode[t].$el[0],document.activeElement);return e},"trySetValue":function(e){var t;return t=!this.$el.is(":visible")||this.options.alpacaField.setValueAndValidate(this.curVal,!0),t?(this.curVal===this.oldVal&&""!==this.curVal||(this.setValue(this.curVal,e),this.isMultiFieldView(this)&&this._raiseValueChanged()),this.$el.removeClass("cs-formfield-invalid")):(this.$el.addClass("cs-formfield-invalid"),this.$el.trigger(i.Event("field:invalid"))),t},"setStateRead":function(e){if(c.tklHelpers&&c.tklHelpers.viewsInWriteMode){var i=c.tklHelpers.viewsInWriteMode.indexOf(this);-1!==i&&c.tklHelpers.viewsInWriteMode.splice(i,1)}return this.curVal!==this.getValue()&&(this.options.alpacaField.setValue(this.curVal),this.options.alpacaField.validate()&&this.options.alpacaField.refreshValidationState(!1)),this.valuesPulled=!1,this.hideOptions(),this.isServerTypeahead&&(this.pageIndex=0,this.fetchMore=!0),!1},"setStateWrite":function(){return this.filterRelations(),this.buildHelpers(),"writeonly"===this.mode||this.getEditableBehavior().escapePressed||this.children.map(function(e){this.isMultiFieldView(e)?e.isWriteMode||-1!==this.parentViews.indexOf(e)||e._showItemsInWriteMode():"write"===e.getStatesBehavior().state||e.alpacaField.parent.cancelClicked||e.getStatesBehavior().setStateWrite(!1,!1)},this),!1},"buildHelpers":function(){c.tklHelpers||(c.tklHelpers={},c.tklHelpers.viewsInWriteMode=[]),this.isMultiFieldView(this)?this.alpacaField.parent._updateViewsInWriteMode(this):this.getEditableBehavior()._updateViewsInWriteMode(this),c.tklHelpers.tabInView||(c.tklHelpers.tabInView=this)},"resetHelpers":function(i){if(c.tklHelpers)if(i){var t=[];e.each(c.tklHelpers.viewsInWriteMode,function(e){e&&e.$el.is(":visible")&&this.pushView(t,e)},this),c.tklHelpers.viewsInWriteMode=t}else c.tklHelpers.viewsInWriteMode.length=0},"allowEditOnClickReadArea":function(){return!0},"_raiseValueChanged":function(){c.tklHelpers&&!this.isMultiFieldView(this)?e.each(c.tklHelpers.viewsInWriteMode,function(e){this.isMultiFieldView(e)||(e.oldVal=e.curVal)},this):this.isMultiFieldView(this)||(this.oldVal=this.curVal);var t={"fieldvalue":this.getValue(),"fieldid":this.options.dataId,"fieldpath":this.options.path,"targetfieldpath":this.options.path,"fieldView":this};c.trigger(this.options.dataId+"dependentattrchanged",this);var n=i.Event("field:changed");e.extend(n,t),this.$el.trigger(n)},"pullValidValues":function(t,n){var a=[9,13,17,18,20,27,32,37,38,39,113,40];if(["STARTWITH","CONTAINS"].indexOf(this.alpacaField.schema.typeAheadSearch)>-1&&!this.ui.tklOptionsContainer.is(":visible")&&a.pop(),t&&"keyup"===t.type){if(t.ctrlKey||-1!==a.indexOf(t.keyCode))return;this.isServerTypeahead&&(this.fetchMore=!0,this.pageIndex=0)}if(!this.alpacaField.schema.readonly&&(this.relationsFiltered||this.isServerTypeahead||this.filterRelations(),!this.valuesPulled||this.isServerTypeahead&&t&&"keyup"===t.type||n)){this.isPullingValues=!0,n||(this.options.enum=[]),this.trigger("tkl:refresh"),!this.isCustomView&&this.node.attributes&&this.node.attributes.fileObject&&this.node.attributes.fileObject.attributes&&this.node.attributes.fileObject.attributes.collection&&this.node.attributes.fileObject.attributes.collection.node&&(this.parentId=this.node.attributes.fileObject.attributes.collection.node.get("id"));var s,l,r,o,d=this.connector,c=this.isCustomView?this.catId:void 0===this.node.get("id")?this.parentId||this.node.get("parent_id"):this.node.get("id"),u={"id":c,"attribute_key":this.isCustomView?this.options.alpaca.schema.fieldID:this.alpacaField.name},h=0,p=!0,f=this,m=this.formView.alpaca.data[this.catId+"_1"];if(u.version_number=m&&m.version_number?m.version_number:void 0,this.parentViews.length>0){var g={},v=-1!==this.options.dataId.indexOf("x")&&1===this.options.dataId.match(/x/g).length,b=!1;if(v||(b=v=this.options.dataId.match(new RegExp(this.options.dataId.substring(0,this.options.dataId.indexOf("_")),"g")).length>1),this.alpacaField.options.isMultiFieldItem)v||(u.attribute_key=(this.alpacaField.propertyId||this.alpacaField.parent.propertyId)+"_"+this.getFieldIndex(this)),o=e.filter(this.parentViews,function(e){return!!f.isMultiFieldView(e)}),this.alpacaField.options&&(h=this.alpacaField.parent.schema.maxItems&&1!==this.alpacaField.parent.schema.maxItems&&0!==o.length?this.getFieldIndex(this):0,this.parentViews.map(function(e){if(r=this.normalizeViews(e),
0===h&&v)for(var i=this.alpacaField.schema.parents.slice(),t=-1,n=0;n<r.length&&(t=i.indexOf(r[n].options.alpacaField.propertyId||r[n].options.alpacaField.parent.propertyId),-1!==t&&(l=r[n].alpacaField.name,g[l]=this.getFieldValue(r[n]),i.splice(t,1)),i.length);n++);else r[h]?(l=r[h].alpacaField.name,g[l]=this.getFieldValue(r[h])):this.isMultiFieldView(e)?p=!1:(l=e.alpacaField.propertyId||e.alpacaField.parent.propertyId,g[l]=this.getFieldValue(r[0]))},this));else{u.attribute_key=this.isCustomView?this.alpacaField.schema.fieldID:this.options.dataId;var y;for(h=0;h<this.parentViews.length;h++)r=this.normalizeViews(this.parentViews[h]),y=r[0].options.dataId.split("_"),b&&y[1]===this.options.dataId.split("_")[1]?(l=y.slice(0,2).join("_")+"_",l+=r[0].alpacaField.propertyId||r[0].alpacaField.parent.propertyId):l=this.isCustomView?r[0].alpacaField.schema.fieldID:r[0].alpacaField.name,g[l]=this.getFieldValue(r[0])}g=JSON.stringify(g),u.attribute_values=g}else this.alpacaField.schema.parents.length&&(p=!1);if(!this.isCustomView&&this.node&&this.node.get("subprocess_id")&&(u.subwork_id=this.node.get("subprocess_id")),p){this.isCustomView&&(u.version_number=this.formView.alpaca.schema.properties.Category.properties["Category_"+this.catId].OTCatVerNum,u.is_search=!0),u.typeAheadSearch=this.alpacaField.schema.typeAheadSearch||"NONE",u.typeAheadSearch&&(u.FilterData=this.ui.writeField.val().trim()),this.isServerTypeahead&&(u.PageIndex=this.pageIndex),s=d.connection.url+"/tklattribute/validvalues";var w={"type":"POST","url":s,"data":u};d.extendAjaxOptions(w),i.ajax(w).done(e.bind(function(e,i){this.isServerTypeahead?i[e].length?(this.options.enum=this.options.enum.concat(i[e]),this.pageIndex++):this.fetchMore=!1:this.options.enum=i[e],this.curVal&&"number"==typeof this.options.enum[0]&&(this.curVal=Number(this.curVal),this.oldVal=Number(this.oldVal)),f.isPullingValues=!1,this.trigger("tkl:refresh"),this.showOptions()},this,u.attribute_key)).fail(function(e){f.valuesPulled=!1,e.responseJSON&&e.responseJSON.error&&(f.modalAlert?f.modalAlert.showError(e.responseJSON.error):csui.require(["csui/dialogs/modal.alert/modal.alert"],function(i){f.modalAlert=i,f.modalAlert.showError(e.responseJSON.error)}))}).always(function(){f.isPullingValues=!1}),this.valuesPulled=!0}else this.options.enum.length=0,this.isPullingValues=!1,this.trigger("tkl:refresh")}},"refresh":function(){var t=this.ui.tklOptions;t.empty(),this.options.enum.length?(t.append(i('<li id="'+e.uniqueId("tklitem")+'" role="option" class="active"><a title="'+m.tklFieldNone+'" tabindex="-1">'+m.tklFieldNone+"</a></li>")),this.tklOptionsTemplate||(this.tklOptionsTemplate=e.template('<li id="" role="option"><a title="[object Object]" tabindex="-1">[object Object]</a></li><li id="" role="option"><a title="false" tabindex="-1">false</a></li><li id="" role="option"><a title="[object Object]" tabindex="-1">[object Object]</a></li><li id="" role="option"><a title="C:\CSUI-sdk\generator csui sdk\app\index.js" tabindex="-1">C:\CSUI-sdk\generator csui sdk\app\index.js</a></li><li id="" role="option"><a title="csui-extension:app" tabindex="-1">csui-extension:app</a></li><li id="" role="option"><a title="" tabindex="-1"></a></li><li id="" role="option"><a title="" tabindex="-1"></a></li><li id="" role="option"><a title="" tabindex="-1"></a></li><li id="" role="option"><a title="false" tabindex="-1">false</a></li><li id="" role="option"><a title="" tabindex="-1"></a></li>')),t.append(this.tklOptionsTemplate({"options":this.options.enum})),this.isPullingValues&&(t.append(this.tklOptionsLoadingTemplate),t.parent().scrollTop(t.outerHeight()))):this.isPullingValues?(this.tklOptionsLoadingTemplate||(this.tklOptionsLoadingTemplate=i(g())),this.ui.tklOptions.append(this.tklOptionsLoadingTemplate),this.showOptions()):this.ui.tklOptions.append(i('<li class="cs-tkl-no-result"><a tabindex="-1">'+m.noResultFound+"</a></li>")),this.searchBase=t.find("li"),this.$el.is(":visible")&&this.adjustPosition(),this.trigger("dom:refresh")},"onClick":function(e){var t=i(e.target).closest("li").index(),n="",a=i(e.target).closest("li"),s=this.$el.parents(".binf-form-group.alpaca-field");n=0===t?"":this.options.enum[t-1],a.hasClass("cs-tkl-no-result")?this.ui.writeField.trigger("focus"):(this.options.alpacaField.isRequired()?""!==n?(this.isValidTKLState=!0,s.removeClass("binf-has-error alpaca-invalid"),this.$el.removeClass("cs-formfield-invalid"),s.find(".binf-help-block.alpaca-message").hide()):this.isValidTKLState=!1:(this.isValidTKLState=!0,s.removeClass("binf-has-error alpaca-invalid"),this.$el.removeClass("cs-formfield-invalid"),s.find(".binf-help-block.alpaca-message").hide()),this.setValue(n),this.setSelection(a,!0))},"setSlectionRange":function(e,t,n){if(e.setSelectionRange)i(e).trigger("focus"),e.setSelectionRange(t,t);else if(e.createTextRange){var a=e.createTextRange();a.collapse(!0).moveEnd("character",n).moveStart("character",t).select()}},"getFieldValue":function(i){i.fieldView&&(i=i.fieldView);var n=i.getEditValue();return n instanceof t.Model?n=n.get("id"):e.isObject(n)&&(n=n.id),null!==n&&void 0!==n||(n=""),n.toString()},"setSelection":function(t,n,a){this.ui.writeField.val(this.getValue()),u.isMSBrowser()&&!this.ui.writeField[0].setSlectionRange&&this.setSlectionRange(this.ui.writeField[0],this.ui.writeField.val().length,this.ui.writeField.val().length),this.ui.tklOptions.find(".cs-tkl-selected").removeClass("cs-tkl-selected"),t.addClass("cs-tkl-selected"),a||(this.ui.writeField.trigger("focus"),this.ui.tklOptionsContainer.removeClass("binf-show"));var s,l={};this.isMultiFieldView(this)&&(s=this.alpacaField.parent.children.indexOf(this.alpacaField)),this.isCustomView?l[this.alpacaField.schema.fieldID]=this.getValue().toString():l[this.alpacaField.name]=this.getValue().toString(),this.getAllParents(l,this.parentViews,s),this.getAllChildren(l,this.children,s);var r=h.combine(this.connector.getConnectionUrl().getApiBase("v2"),"/tklattribute/defaultvalues"),o={"type":"POST","url":r,"data":{"attribute_key":this.isCustomView?this.options.alpaca.schema.fieldID:this.alpacaField.name,"is_search":this.isCustomView,"id":this.isCustomView?this.templateId:this.node.get("id")||this.node.get("parent_id"),"attribute_values":JSON.stringify(l)}};if(!this.isCustomView&&this.node&&this.node.get("subprocess_id")&&(o.data.subwork_id=this.node.get("subprocess_id")),this.connector.extendAjaxOptions(o),i.ajax(o).done(e.bind(function(e){this.autoPopulateChildrenValues(e.results.data,this.children,s)},this)),n&&"create"===this.options.mode){var d=this;setTimeout(function(e){d.ui.writeField.trigger("change"),d.getEditableBehavior().showActions&&d.getEditableBehavior().showActions(e),d.options.isDropDownOpen=!1},110)}else this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(this),this.options.isDropDownOpen=!1;this.isValidTKLState=!0,delete this.needRerender},"getAllParents":function(i,t,n){var a,s;t.map(function(t){this.isMultiFieldView(t)?(t.parentRelations&&t.parentRelations.length&&!e.has(i,t.name+"_"+(void 0===n?0:n))&&this.getAllParents(i,t.parentRelations,n),void 0===n?t.children.map(function(e){s=this.getFieldValue(e),i[e.name]=s},this):(s=t.getValue()[n],i[t.name+"_"+n]=null!==s&&void 0!==s?s.toString():"")):(a=this.isCustomView?t.alpacaField.schema.fieldID:t.alpacaField.name,t.parentViews.length&&!e.has(i,a)&&t.getAllParents(i,t.parentViews,n),s=this.getFieldValue(t),i[a]=s)},this)},"getAllChildren":function(i,t,n){var a;t.map(function(t){this.isMultiFieldView(t)?e.has(i,t.name+"_"+(void 0===n?0:n))||(this.getAllParents(i,t.parentRelations||[],n),t.childRelations&&t.childRelations.length?this.getAllChildren(i,t.childRelations,n):t.children[n]&&t.children[n].fieldView.children.length&&(this.getAllParents(i,t.parentViews,n),this.getAllChildren(i,t.children[n].fieldView.children,n)),void 0===n?t.children.map(function(e){i[e.name]=""}):i[t.name+"_"+n]=""):(a=this.isCustomView?t.alpacaField.schema.fieldID:t.alpacaField.name,this.getAllParents(i,t.parentViews||[],n),t.children.length&&!e.has(i,a)&&t.getAllChildren(i,t.children,n),-1===this.parentViews.indexOf(t)&&(i[a]=""))},this)},"autoPopulateChildrenValues":function(e,i,t,n){var a;n||(n=[]),i.map(function(i){!this.isCustomView&&this.isSetType&&this.getRowIndex()!==this.getRowIndex(i)||(this.isMultiFieldView(i)?(-1===n.indexOf(i.name)&&(i.childRelations&&i.childRelations.length?(n.push(i.name),this.autoPopulateChildrenValues(e,i.childRelations,t,n)):i.children[t]&&i.children[t].fieldView.children.length&&this.autoPopulateChildrenValues(e,i.children[t].fieldView.children,t)),void 0===t&&i.children.map(function(i){i.getValue().toString()!==(e[i.name]||"").toString()&&(i.fieldView.setValue(e[i.name]),i.fieldView.valuesPulled=!1,i.fieldView.alpacaField.refreshValidationState())}),i.children[t]&&i.children[t].name in e&&i.children[t].fieldView.getValue().toString()!==(e[i.children[t].name]||"").toString()&&(i.children[t].fieldView.valuesPulled=!1,i.children[t].fieldView.setValue(e[i.children[t].name]),i.children[t].fieldView.alpacaField.refreshValidationState())):t||(a=this.isCustomView?i.alpacaField.schema.fieldID:i.alpacaField.name,i.children.length&&-1===n.indexOf(a)&&(n.push(a),i.autoPopulateChildrenValues(e,i.children,t,n)),i.getValue().toString()!==(e[a]||"").toString()&&(i.setValue(e[a]),i.valuesPulled=!1,i.alpacaField.refreshValidationState())))},this)},"changeChildrenValues":function(i,t,n){var a,s,l=!1,r=-1!==this.options.dataId.indexOf("x")&&1===this.options.dataId.match(/x/g).length;e.each(i,function(e){if(this.isMultiFieldView(this)){if(a=this.getFieldIndex(this),s=this.normalizeViews(e),r&&parseInt(this.options.dataId.split("_")[2])!==parseInt(s[0].options.dataId.split("_")[2]))return;s[0].alpacaField.options.isMultiFieldItem?(s.forEach(function(e){e.changeChildrenValues(e.children,e,!1),e.valuesPulled=!1}),s[a]&&(e=s[a],l=void 0===n||n,this.changeChildrenValues(e.children,e))):0===a&&(e=s[a],l=!0,this.changeChildrenValues(e.children,e)),l&&(e.valuesPulled=!1,e.setValue(""),e.options.enum.length=0,e.trigger("tkl:refresh"))}else{if(s=this.normalizeViews(e),r&&parseInt(this.options.dataId.split("_")[2])!==parseInt(s[0].options.dataId.split("_")[2]))return;var i=this;s.forEach(function(e){l=!0,i.changeChildrenValues(e.children,e),l&&(e.valuesPulled=!1,e.isValidTKLState=!0,e.options.alpacaField.isRequired()?e.isValidTKLState=!1:(e.$el.parents(".binf-form-group.alpaca-field").removeClass("binf-has-error alpaca-invalid"),e.$el.removeClass("cs-formfield-invalid")),e.$el.parents(".binf-form-group.alpaca-field").find(".binf-help-block.alpaca-message.alpaca-message-custom").hide(),e.setValue(""),e.options.enum.length=0,e.trigger("tkl:refresh"))})}},t||this)},"normalizeViews":function(e){var i=[];return e.isTKLField||e.isNonTKLField?this.pushView(i,e):this.isMultiFieldView(e)?e.children.map(function(e){this.pushView(i,e.fieldView)},this):this.pushView(i,e.children[0].fieldView),i},"isMultiFieldView":function(e){return e||(e=this),!e.isTKLField&&!e.isNonTKLField||e.alpacaField.options.isMultiFieldItem&&!!e.alpacaField.parent&&!!e.alpacaField.parent.schema.maxItems&&e.alpacaField.parent.schema.maxItems>1},"getFieldIndex":function(e){if(e||(e=this),e.alpacaField.options.isMultiFieldItem&&e.alpacaField.parent.schema.maxItems&&1!==e.alpacaField.parent.schema.maxItems)return e.alpacaField.parent.children.indexOf(e.alpacaField)},"getRowIndex":function(e){e||(e=this.alpacaField.parent),this.isMultiFieldView(e)||(e=e.alpacaField.parent);var i=e.parent;return i&&i.parent?i.parent.children.indexOf(i):-1},"resetOldValueAfterCancel":function(){if(c.tklHelpers)for(var e,i,t=c.tklHelpers.viewsInWriteMode.length-1;c.tklHelpers&&t>=0;t--)if(i=c.tklHelpers.viewsInWriteMode[t])if(i.isValidTKLState=!0,this.isMultiFieldView(i)){if("write"===i.getStatesBehavior().state&&(i=i.alpacaField.parent,e=i.getFieldEl(),e.find(".csui-bulk-edit-cancel").is(":visible"))){e.find(".csui-bulk-edit").removeClass("binf-hidden"),e.find(".csui-bulk-edit-cancel").addClass("binf-hidden"),e.find(".csui-bulk-edit-submit").addClass("binf-hidden"),i._hideInlineDeleteIcon(),i._hideInlineAddIcon(),i.options.prevChildData&&(i.children={},i.children=i.options.prevChildData);var n=i.getPreviousData();i.refreshContainer(n,function(){i.options.prevChildDom=void 0,i.options.prevData=void 0,i.isWriteMode=!1})}}else i.alpacaField.parent.cancelClicked=!0,"tkl"===i.alpacaField.type?i.setValue(i.getOldValue()):i.getEditableBehavior()._resetOldValue(),i.alpacaField.refreshValidationState(),i.$el.removeClass("cs-formfield-invalid"),i.getEditableBehavior().setViewReadOnlyAndLeaveEditMode(!1,!1),this.ui.readField.trigger("focus")}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuitklfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","csui/controls/form/fields/tklfield.view","csui/utils/base","i18n!csui/controls/form/impl/nls/lang"],function(e,i,t,n,a,s,l,r,o,d){return s.Fields.CsuiTKLField=s.Fields.SelectField.extend({"constructor":function(e,i,t,n,a,s,l){this.excludeNoneOption=void 0!==t.removeDefaultNone&&t.removeDefaultNone,this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"tkl"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e=!0;null!==this.data&&""!==this.data||(e="create"===this.options.mode);var s,l=this.id,o=this.options?this.options.descriptionId:"",c=t(this.field[0]).find("label");c&&1==c.length&&(s=c.attr("for")+"Label",c.attr("id",s)),this.fieldView=new r({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":l}),"id":i.uniqueId(l),"alpacaField":this,"labelId":s,"descriptionId":o,"mode":this.options.mode,"path":this.path,"dataId":this.name,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema},"hasValue":e}),this.options.validator=function(e){e({"status":this.fieldView.isValidTKLState,"message":this.fieldView.isValidTKLState?"":d.invalidTkl})};var u=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(u),this.region=new a.Region({"el":u}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e),""===this.fieldView.ui.writeField.val()&&(this.fieldView.isValidTKLState=!0);var t=!0;return i&&(t=this.validate()&&this.fieldView.isValidTKLState,this.refreshValidationState(!1)),t},"_validator":function(e){var i=this.getValue();e(this.schema.required&&""===i?{"status":!1,"message":"This is a required field."}:{"status":!0})},"validate":function(){var e=this.base();this.validation.invalidValueOfEnum&&!this.validation.invalidValueOfEnum.status&&(this.validation.invalidValueOfEnum.message="",this.validation.invalidValueOfEnum.status=!0,e=this.validation.notOptional.status);for(var i in this.validation)!1===this.validation[i].status&&("notOptional"!==i?(this.validation[i].status=!0,this.validation[i].message=""):this.fieldView.isValidTKLState||(this.validation.notOptional.status=!0));return e},"setValue":function(e){null===e?this.base(""):this.base(e)},"getValue":function(){return this.base()},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("tkl",s.Fields.CsuiTKLField,"bootstrap-csui"),t.alpaca.Fields.CsuiTKLField}),csui.define("hbs!csui/controls/form/impl/fields/multilingual.textfield/multilingual.textfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return'placeholder="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.placeholder:a,e))+'"'},"3":function(e,i,t,n){var a;return'size="'+this.escapeExpression(this.lambda(null!=(a=null!=e?e.options:e)?a.size:a,e))+'"'},"5":function(e,i,t,n){var a;return'name="'+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{},"data":n}):a))+'"'},"7":function(e,i,t,n){var a;return"data-"+this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'"'},"9":function(e,i,t,n){var a;return this.escapeExpression((a=null!=(a=i.key||n&&n.key)?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"key","hash":{},"data":n}):a))+'="'+this.escapeExpression(this.lambda(e,e))+'"'},"11":function(e,i,t,n){var a;return'aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{},"data":n}):a))+'" '},"13":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{},"data":n}):a))+'" '},"15":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{},"data":n}):a))+'"'},"17":function(e,i,t,n){var a;return' aria-required="'+this.escapeExpression((a=null!=(a=i.ariaRequired||(null!=e?e.ariaRequired:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"ariaRequired","hash":{},"data":n}):a))+'"'},"19":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{},"data":n}):a))+'"></div>\r\n      </div>\r\n'},"21":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.applyFlag:a,{"name":"if","hash":{},"fn":this.program(22,n,0),"inverse":this.noop,"data":n}))?a:""},"22":function(e,i,t,n){var a;return'        <div class="icon-container binf-hidden">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{},"data":n}):a))+'" tabindex="0"></div>\r\n        </div>\r\n'},"24":function(e,i,t,n){return' aria-disabled="true" '},"26":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.readModeMultiFieldAria||(null!=e?e.readModeMultiFieldAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeMultiFieldAria","hash":{},"data":n}):a))+'" '},"28":function(e,i,t,n){var a;return'\r\n              aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{},"data":n}):a))+'"\r\n'},"30":function(e,i,t,n){var a;return"          <span>"+this.escapeExpression((a=null!=(a=i.multilangEnValue||(null!=e?e.multilangEnValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multilangEnValue","hash":{},"data":n}):a))+"</span>\r\n"},"32":function(e,i,t,n){var a;return'          <span class="placeholder" title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{},"data":n}):a))+'">'+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{},"data":n}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <span class="icon multilingual-icon url1"></span>\r\n      <input type="'+this.escapeExpression((s=null!=(s=i.inputType||(null!=e?e.inputType:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"inputType","hash":{},"data":n}):s))+'" id="'+this.escapeExpression((s=null!=(s=i.id||(null!=e?e.id:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{},"data":n}):s))+'"\r\n             '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.placeholder:a,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.size:a,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.data:a,{"name":"each","hash":{},"fn":this.program(7,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.each.call(e,null!=(a=null!=e?e.options:e)?a.attributes:a,{"name":"each","hash":{},"fn":this.program(9,n,0),"inverse":this.noop,"data":n}))?a:"")+'\r\n    value="'+this.escapeExpression((s=null!=(s=i.multilangEnValue||(null!=e?e.multilangEnValue:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"multilangEnValue","hash":{},"data":n}):s))+'" '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(11,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(13,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(15,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.ariaRequired:e,{"name":"if","hash":{},"fn":this.program(17,n,0),"inverse":this.noop,"data":n}))?a:"")+" readonly />\r\n"+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":this.program(19,n,0),"inverse":this.program(21,n,0),"data":n}))?a:"")+'\r\n  </div>\r\n</div>\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <button title="'+this.escapeExpression((s=null!=(s=i.tooltip||(null!=e?e.tooltip:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"tooltip","hash":{},"data":n}):s))+'"\r\n        '+(null!=(a=i.if.call(e,null!=(a=null!=e?e.schema:e)?a.readonly:a,{"name":"if","hash":{},"fn":this.program(24,n,0),"inverse":this.noop,"data":n}))?a:"")+"\r\n        "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(26,n,0),"inverse":this.program(28,n,0),"data":n}))?a:"")+"      >\r\n"+(null!=(a=i.if.call(e,null!=e?e.hasData:e,{"name":"if","hash":{},"fn":this.program(30,n,0),"inverse":this.program(32,n,0),"data":n}))?a:"")+'      </button>\r\n    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{},"data":n}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'},"useData":!0});return t.registerPartial("csui_controls_form_impl_fields_multilingual.textfield_multilingual.textfield",n),n}),csui.define("css!csui/controls/form/impl/fields/multilingual.textfield/multilingual.textfield",[],function(){}),csui.define("csui/controls/form/fields/multilingual.textfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","csui/utils/url","csui/utils/contexts/factories/connector","i18n!csui/controls/form/impl/nls/lang","hbs!csui/controls/form/impl/fields/multilingual.textfield/multilingual.textfield","css!csui/controls/form/impl/fields/multilingual.textfield/multilingual.textfield","csui/lib/binf/js/binf","csui/lib/handlebars.helpers.xif"],function(e,i,t,n,a,s,l,r,o){"use strict";var d=csui.require.s.contexts._.config.config.i18n,c=d&&d.locale||"en-US";return a.extend({"constructor":function(e){a.apply(this,arguments);var i=this.model.get("data");this.editVal=i||{},this.oldVal=i,this._isReadyToSave=!0},"getDisplayValue":function(){return this.getEditValue()},"className":"cs-formfield cs-multilingualfield","template":o,"events":{"keypress @ui.readField":"onKeyPressRead","click @ui.writeField":"onWiteFieldClick","click .multilingual-icon":"onWiteFieldClick","keydown @ui.writeField":"onKeyDownWrite"},"templateHelpers":function(){var i="",t=r.noValue,n="",s="",l="readonly"===this.mode,o="",d=this.options.alpacaField&&this.options.alpacaField.isRequired();return o=d?r.requiredField:"",this.model.get("data")&&(t=this.model.get("data")),this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(i=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:""),this.model.get("options")&&(n=l?e.str.sformat(r.fieldReadOnlyAria,this.model.get("options").label,t[c])+o:e.str.sformat(r.fieldEditAria,this.model.get("options").label,t[c])+o),s=l?e.str.sformat(r.fieldReadOnlyAria,i,t[c])+o:e.str.sformat(r.fieldEditAria,i,t[c])+o,e.extend(a.prototype.templateHelpers.apply(this),{"inputType":"text","idBtnLabel":this.options.labelId,"idBtnDescription":this.options.descriptionId,"readModeAria":n,"readModeMultiFieldAria":s,"multiFieldLabel":i,"ariaRequired":d,"multilangEnValue":t[c]})},"getEditValue":function(){return this.editVal},"getOldValue":function(){return this.oldVal},"isReadyToSave":function(){return this._isReadyToSave},"onKeyDownWrite":function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this._showLanguageTextPicker())},"onWiteFieldClick":function(e){e.preventDefault(),e.stopPropagation(),this._showLanguageTextPicker()},"_showLanguageTextPicker":function(){if(this._isReadyToSave){this._isReadyToSave=!1;var i=this;csui.require(["csui/dialogs/multilingual.text.picker/multilingual.text.picker"],function(t){new t({"connector":i.connector,"data":i.model.get("data")}).show().done(e.bind(i._handlePickerSuccess,i)).fail(e.bind(i._handlePickerCancel,i)).always(function(){i.ui.writeField.trigger("focus"),i._isReadyToSave=!0})})}},"_handlePickerSuccess":function(e){this.editVal=e,this.setValue(e,!0),this.render()},"_handlePickerCancel":function(e){}})}),csui.define("csui/controls/form/fields/alpaca/alpcsuimultilingual.textfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","csui/controls/form/fields/multilingual.textfield.view","csui/utils/base"],function(e,i,t,n,a,s,l,r,o){return s.Fields.CsuiMultilingualTextField=s.Fields.TextField.extend({"constructor":function(e,i,t,n,a,s,l){this.base(e,i,t,n,a,s,l)},"getFieldType":function(){return"otcs_multilingual_string"},"postRender":function(e){this.base(e),this.showField(),this.field.parent().addClass("csui-field-"+this.getFieldType())},"showField":function(){var e,s=this.id,l=this.options?this.options.descriptionId:"",o=t(this.field[0]).find("label");o&&1==o.length&&(e=o.attr("for")+"Label",o.attr("id",e)),this.fieldView=new r({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"inputType":"text","id":s}),"id":i.uniqueId(s),"alpacaField":this,"labelId":e,"descriptionId":l,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var d=t("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(d),this.region=new a.Region({"el":d}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,i){this.setValue(e);var t=!0;return i&&(t=this.validate(),this.refreshValidationState(!1)),t},"getValue":function(){return this.data},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("otcs_multilingual_string",s.Fields.CsuiMultilingualTextField,"bootstrap-csui"),s.registerFieldClass("otcs_multilingual_string",s.Fields.CsuiMultilingualTextField,"bootstrap-edit-horizontal"),t.alpaca.Fields.CsuiMultilingualTextField}),csui.define("css!csui/lib/alpaca/css/alpaca",[],function(){}),csui.define("csui/controls/form/form.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/url","csui/utils/log","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/models/form","hbs!csui/controls/form/impl/templates/form","hbs!csui/controls/form/impl/templates/formsinglecol","hbs!csui/controls/form/impl/templates/formdoublecol","txt!csui/controls/form/impl/templates/alpaca.container.array.txt","txt!csui/controls/form/impl/templates/alpaca.container.array.item.txt","csui/utils/non-attaching.region/non-attaching.region","i18n!csui/controls/form/impl/nls/lang","csui/controls/form/fields/alpaca/alpnodepickerfield","csui/controls/form/fields/alpaca/alpcsuidateonlyfield","csui/controls/form/fields/alpaca/alpcsuidatetimefield","csui/controls/form/fields/alpaca/alpcsuibooleanfield","csui/controls/form/fields/alpaca/alpcsuitextfield","csui/controls/form/fields/alpaca/alpcsuitextareafield","csui/controls/form/fields/alpaca/alpcsuiselectfield","csui/controls/form/fields/alpaca/alpcsuiradiofield","csui/controls/form/fields/alpaca/alpcsuiintegerfield","csui/controls/form/fields/alpaca/alpcsuipasswordfield","csui/controls/form/fields/alpaca/alpcsuiurlfield","csui/controls/form/fields/alpaca/alpnodepickerfield","csui/controls/form/fields/alpaca/alpcsuiarrayfield","csui/controls/form/fields/alpaca/alpcsuiobjectfield","csui/controls/form/fields/alpaca/alpcsuiarraybuttonsfield","csui/controls/form/fields/alpaca/alpcsuireservebuttonfield","csui/controls/form/fields/alpaca/alpcsuitklfield","csui/controls/form/fields/tklfield.view","csui/controls/form/fields/alpaca/alpcsuimultilingual.textfield","css!csui/controls/form/impl/form","css!csui/lib/alpaca/css/alpaca","csui/lib/binf/js/binf-datetimepicker","csui/lib/handlebars.helpers.xif","csui-ext!csui/controls/form/form.view","csui/lib/jquery.when.all"],function(e,i,t,n,a,s,l,r,o,d,c,u,h,p,f){l.registerView({"id":"bootstrap-csui","parent":"bootstrap-edit-horizontal","type":"edit","ui":"bootstrap","title":"","displayReadonly":!0,"templates":{"control-textarea":"<div></div>","control-checkbox":"<div></div>","control-select":"<div></div>"},"callbacks":{},"styles":{},"horizontal":!0,"collapsible":!1}),l.registerTemplate("container-array",u),l.registerTemplate("container-array-item",h);var m=s.ItemView.extend({"className":function(){var e="cs-form";switch(this.mode){case"create":e+=" cs-form-create cs-form-show-helper";break;case"read":e+=" cs-form-read";break;case"update":e+=" cs-form-update"}return e},"constructor":function(i){if(i=e.extend({},i),this.breakFieldsAt=t.isNumeric(i.breakFieldsAt)&&i.breakFieldsAt>0?i.breakFieldsAt:8,this.mode=i.mode||"update","read"!==this.mode&&"update"!==this.mode&&"create"!==this.mode)throw new Error('Invalid form mode: "'+this.mode+'".');s.ItemView.prototype.constructor.call(this,i),this.layoutMode=this.options.layoutMode||"singleCol",this.setRequiredFieldsEditable="create"===this.mode,this.listenTo(this.model,"change",this.updateForm),this.listenTo(this.model,"reset",this.render),this.listenTo(this,"before:destroy",this._beforeDestroy),t(window).on("resize resize.tableview",{"view":this},this._onWindowResize)},"_onWindowResize":function(e){if(e&&e.data&&e.data.view){var i=e.data.view;i.adjustLayout(i)}},"adjustLayout":function(e){var i=e.$el.closest(".cs-metadata-properties");i.length&&(i.outerWidth()<768?i.addClass("csui-metadata-low-resolution"):i.removeClass("csui-metadata-low-resolution"))},"updateForm":function(){return this.render()},"render":function(){return this.renderFinished=!1,this.triggerMethod("before:render",this),this._renderContent(),this},"_renderContent":function(){this.alpaca={"data":this.model.get("data"),"schema":this.model.get("schema"),"options":this.model.get("options")},this._destroyForm(),this._modifyModel(),this.alpaca.view=this.model.get("view")||this._getLayout(),this.$el.addClass("binf-hidden"),e.extend(this.alpaca.options,{"validate":!0,"custom":{"some":"value"}}),this._otcsContextConfig={"context":this.options.context,"formView":this},this.$form=this.$el.alpaca({"connector":{"id":"otcs_context","config":this._otcsContextConfig},"data":this.alpaca.data,"schema":this.alpaca.schema,"view":this.alpaca.view,"options":e.extend({},this.alpaca.options,this._getFormTemplateHelpers()),"postRender":e.bind(this._formRendered,this)}),this.$form.on({"field:changed":e.bind(this._onFieldChanged,this),"show:colout":e.bind(this._onShowColout,this),"field:invalid":e.bind(this._onFieldInvalid,this),
"click:applyAll":e.bind(this.onClickApplyAll,this),"reset":e.bind(this.resetForm,this)})},"_onShowColout":function(e){i.trigger("closeToggleAction"),e.context=this.options.context;var n=t(e.targetEl),a=n.data("binf.popover"),s=this;a||csui.require(["csui/controls/form/colout/colout.view"],function(t){var n=new i.Model({"data":e.formdata,"options":e.formoptions,"schema":e.formschema,"targetEl":e.targetEl,"coloutContainer":e.coloutContainer,"context":e.context}),a=new t(n);s.coloutNonAttachingRegion||(s.coloutNonAttachingRegion=new p({"el":s.el})),s.coloutNonAttachingRegion.show(a,{"render":!1})})},"_onFieldInvalid":function(e){this.triggerMethod("invalid:field",e)},"onClickApplyAll":function(i){var t=this.model.node.collection||this.node.collection;this._=e,this.args=i;var n=this;t&&t.models&&e.each(t.models,function(e){if(-1!==n.args.fieldpath.indexOf("_")){var i=n.args.fieldpath.split("_"),t=n.args.fieldpath,a=t.split("_"),s=a.splice(0,2).join("_"),l=a.join("_");void 0!==e.get("data").roles.categories[i[0]]&&(2===i.length&&void 0!==e.get("data").roles.categories[i[0]][n.args.fieldpath]?e.get("data").roles.categories[i[0]][n.args.fieldpath]=n.args.fieldvalue:e.get("data").roles.categories[i[0]]&&e.get("data").roles.categories[i[0]][s]&&void 0!==e.get("data").roles.categories[i[0]][s][l]&&(e.get("data").roles.categories[i[0]][s][l]=n.args.fieldvalue)),e.newCategories&&e.newCategories.models.length>0&&this._.each(e.newCategories.models,function(e){e.id===parseInt(i[0])&&void 0!==e.get("data")&&(2===i.length&&void 0!==e.get("data")[n.args.fieldpath]?e.get("data")[n.args.fieldpath]=n.args.fieldvalue:e.get("data")[s]&&void 0!==e.get("data")[s][l]&&(e.get("data")[s][l]=n.args.fieldvalue))})}},this),i.action(i.fieldevent,i.callback,i.view),this.trigger("click:applyAll",i)},"resetForm":function(){this.render()},"_getFormTemplateHelpers":function(){var i=this.getOption("formTemplateHelpers");return e.isFunction(i)&&(i=i.call(this)),i},"_onFieldChanged":function(e,i){var t="{0}:_onFieldChanged {1} {2}";a.debug(t,this.constructor.name,"enter",e)&&console.log(a.last),this.triggerMethod("change:field",this._getChangeFieldEventData(e),i),a.debug(t,this.constructor.name,"trigger change:field",e.fieldpath)&&console.log(a.last),a.debug(t,this.constructor.name,"return")&&console.log(a.last)},"_getChangeFieldEventData":function(i){var t=i.targetfieldid?{"parentField":{"name":i.fieldid,"path":i.fieldpath,"value":i.fieldvalue},"targetField":{"name":i.targetfieldid,"path":i.targetfieldpath,"value":i.targetfieldvalue},"name":i.targetfieldid,"path":i.targetfieldpath,"value":i.targetfieldvalue}:{"targetField":{"name":i.fieldid,"path":i.fieldpath,"value":i.fieldvalue},"name":i.fieldid,"path":i.fieldpath,"value":i.fieldvalue};return e.extend(t,{"view":this,"fieldView":i.fieldView,"model":this.model}),t},"_formRendered":function(e){this.form=this._otcsContextConfig.form=e,this.$el.removeClass("binf-hidden");var i=this,n=[],a={"async":function(){var e=t.Deferred();return n.push(e),function(){e.resolve()}}};this.updateRenderedForm(a),i.triggerMethod("render",i),t.whenAll.apply(t,n).always(function(){i.renderFinished=!0,i.triggerMethod("render:form",i)}),this.setTooltipsForLabels(),this.correctLabel4MV(),this.adjustLayout(this)},"isRenderFinished":function(){return!0===this.renderFinished},"setTooltipsForLabels":function(){var e=this.$el.find(".alpaca-container-label, .alpaca-container-item label");t.each(e,function(e,i){i.setAttribute("title",i.textContent.trim())})},"correctLabel4MV":function(){var i=this.$el.find("label.alpaca-container-label");t.each(i,function(i,n){var a=t(n).siblings("div.csui-multivalue-container");if(a.length>0){var s=e.uniqueId("mvLabel");t(n).attr("id",s),t(a).find("input, textarea, button.binf-dropdown-toggle, button.csui-btn-reserve-status-action").attr("aria-labelledby",s)}})},"updateRenderedForm":function(e){this.$(".alpaca-field-object>label").on("click",function(e){e.stopPropagation(),e.preventDefault()})},"_beforeDestroy":function(){this._destroyForm()},"_getLayout":function(){var i=this._splitFields(),t="singleCol"===this.layoutMode,n={},a=e.uniqueId("csform");e.each(i,function(i,s){var l=i.isSetType?"csfSingleCol_"+a+s:"csfLeftCol_"+a+s,r=i.isSetType||t?void 0:"csfRightCol_"+a+s;e.extend(n,this._bindFields(i,l,r))},this);return{"parent":"bootstrap-csui","layout":{"template":(t?d:c).call(this,{"modelId":a,"fields":i}),"bindings":n}}},"_modifyModel":function(){this.alpaca.options=this.alpaca.options||{},this.alpaca.options.focus=!1,this.alpaca.options.hideInitValidationError=!0,"general"===this.model.get("id")&&(this.alpaca.data=e.omit(this.alpaca.data,"name"),this.alpaca.schema.properties=e.omit(this.alpaca.schema.properties,"name"),this.alpaca.options.fields=e.omit(this.alpaca.options.fields,"name")),this.alpaca.data=e.omit(this.alpaca.data,["external_create_date","external_modify_date"]),this.alpaca.schema.properties=e.omit(this.alpaca.schema.properties,["external_create_date","external_modify_date"]),this.alpaca.options.fields=e.omit(this.alpaca.options.fields,["external_create_date","external_modify_date"]);var n=!1;if(this.options.metadataView&&this.options.metadataView.model&&(n=this.options.metadataView.model.get("applyFlag")),n){var a=[];this.options.metadataView&&this.options.metadataView.model.collection.models&&this.options.metadataView.model.collection.models.length>1&&e.each(this.options.metadataView.model.collection.models,function(i,t){if(i.get("data")&&i.get("data").roles){var n=[],s=[],l=[];e.each(i.get("data").roles.categories,function(e,i){n=n.concat(i)},this),i.removedCategories&&i.removedCategories.length>0&&(s=i.removedCategories),i.newCategories&&i.newCategories.models&&i.newCategories.models.length>0&&(l=e.pluck(i.newCategories.models,"id"),l=l.concat(l.map(function(e){return e.toString()}))),l.length>0&&(s=e.difference(s,l),n=e.union(n,l)),n=e.difference(n,s),a.push(n)}},this),this.commonCategories=e.intersection.apply(e,a)}var s=function(i,t){e.extend(i,{"actionbar":{"actions":[{"action":"remove","enabled":!0,"title":i.isSetType?f.removeRow:f.removeField,"aria-label":i.isSetType?f.removeRow:f.removeField,"iconClass":"csui-icon circle_delete_grey csui-array-icon-delete-"+t,"actionAria":e.str.sformat(f.removeFieldAria,i.label)},{"action":"add","enabled":!0,"title":i.isSetType?f.addRow:f.addField,"aria-label":i.isSetType?f.addRow:f.addField,"iconClass":"csui-icon circle_add_grey csui-array-icon-add-"+t,"actionAria":e.str.sformat(f.addFieldAria,i.label)},{"action":"up","enabled":!1},{"action":"down","enabled":!1}]}})},l=function(t){if(!(t instanceof i.Model))for(var n in t)if(t.hasOwnProperty(n)){var a;e.isObject(t[n])?(a=t[n].type,"otcs_user_picker"!==a&&"otcs_member_picker"!==a||(t[n].fields?(t[n].type=void 0,t[n].fields.type="otcs_user"):t[n].type="otcs_user"),t[n]&&!0===t[n].toolbarSticky&&s(t[n],n),l(t[n])):(a=t[n],"type"===n&&("otcs_user_picker"!==a&&"otcs_member_picker"!==a||(t[n]="otcs_user")),"toolbarSticky"===n&&!0===t[n]&&s(t,n))}};l(this.alpaca.options.fields);var r=function(i,t,n){for(var a in t)if(t.hasOwnProperty(a)){var s="array"===t[a].type,l="object"===t[a].type;if(t[a]&&t[a].type&&(s||l)){var o=s?t[a].items:t[a],d=i[a];if(d){d.toolbarSticky=!t[a].disabled,d.isMultiField=!0,d.uniqueId=a,d.messages=f,d.isEditMode="update"===n,d.fields&&(e.extend(d.fields.item,{"isMultiFieldItem":!0,"hideInlineActions":!0}),void 0!==d.validate&&e.extend(d.fields.item,{"validate":d.validate}));var c=o;if(c){if((1!==c.minItems&&"object"===c.type||c.maxItems!==c.minItems&&"object"===c.type)&&(d.isMultiRowSetEnabled="array"===t[a].type,d.toolbarSticky=!t[a].disabled,d.fields)){var u=s?d.fields.item.fields:d.fields.fields;e.each(u,function(i){e.extend(i,{"isMultiFieldItem":!0}),d.onlyread=i.readonly})}d.canWrite=void 0===d.readonly?!d.onlyread:!d.readonly,d.isTabable=d.isEditMode&&!d.isMultiFieldItem}}s?i[a].fields&&i[a].fields.item&&i[a].fields.item.fields&&r(i[a].fields.item.fields,o.properties,n):l&&r(i[a].fields,o.properties,n)}}};r(this.alpaca.options.fields,this.alpaca.schema.properties,this.mode);!function(i){for(var t in i)if(i.hasOwnProperty(t)){if(!e.isObject(i[t]))return i[t],void("toolbarSticky"===t&&!0===i[t]&&s(i,t));i[t].type,i[t]&&!0===i[t].toolbarSticky&&s(i[t],t),l(i[t])}}(this.alpaca.options.fields);var o=function(e,i){for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];a.setRequiredFieldsEditable=i.setRequiredFieldsEditable,a.mode=i.mode,a.label&&!a.labelModifed&&(a.label=a.label.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),a.label=t("<div>").innerHTML=a.label),a.labelModifed=!0,i.inContainer&&(a.inContainer=!0),-1!==n.indexOf("_")&&i.commonCategories&&-1!==i.commonCategories.indexOf(n.split("_")[0])&&(a.applyFlag=!0),a.fields&&o(a.fields,i)}},d={"mode":this.mode,"inContainer":!!this.options&&!!this.options.node&&!!this.options.node.get("container"),"setRequiredFieldsEditable":this.setRequiredFieldsEditable,"commonCategories":this.commonCategories};o(this.alpaca.options.fields,d)},"_splitFields":function(){var i,t=function(e,i){this.isSetType=e,this.rgVals=[],this.rgKeys=[],this.rgObjectKeys=[]},n=this.alpaca.schema,a=this.alpaca.options,s=JSON.parse(JSON.stringify(this.alpaca.data)),l=new t,r=[],o={};return e.reduce(n.properties,e.bind(function(n,l,d,c){var u="array"===l.type&&"object"===l.items.type;l.type;if(a.fields&&a.fields[d]&&a.fields[d].hidden)return n;if(void 0!==n.isSetType||(n.isSetType=u),n.isSetType!==u&&(r.push(n),n=new t(u)),"object"===l.type&&(n.rgObjectKeys=n.rgObjectKeys.concat(e.keys(l.properties))),u&&(a.isSetType=u,a.fields&&a.fields[d]&&e.extend(a.fields[d],{"isSetType":!0}),s[d])){var h=s[d][0]||s[d];e.each(l.properties||l.items.properties,function(e,i){var t=h[i];if(e.items&&e.items.defaultItems)if(t&&t.length>e.items.defaultItems)for(;t.length>e.items.defaultItems;)t.pop();else if(t&&t.length<e.items.defaultItems)for(;t.length<e.items.defaultItems;)t.push("")}),this.setEmptyValueInData(s),o[d]=JSON.parse(JSON.stringify(h))}return n.rgVals.push(l),n.rgKeys.push(d),i=n,n},this),l),Object.keys(o).length>0&&(a.defaultData=o),i&&r.push(i),r},"setEmptyValueInData":function(i){var t=this;e.each(i,function(e,n){i[n]instanceof Object?t.setEmptyValueInData(i[n]):i[n]=""})},"_bindFields":function(i,t,n){var a=i.rgKeys,s=i.rgObjectKeys,l=a.length+s.length,r={};if(i.isSetType||!n)e.each(a,function(e,i){r[e]=t},this);else if(n)if(a.length>this.breakFieldsAt)e.each(a,function(e,i){r[e]=i<l/2?t:n},this);else if(a.length<this.breakFieldsAt)e.each(a,function(e,i){r[e]=t},this);else{var o=this.breakFieldsAt/2+1;e.each(a,function(e,i){r[e]=i<o?t:n},this)}return r},"_destroyForm":function(){this.form&&(this.form.destroy(),this.form=void 0),this.$form&&(this.$form.off("field:changed"),this.$form.off("field:invalid"),this.$form.off("reset"),this.$form.off("scroll"),this.$form.empty(),this.$form=void 0),this.form&&this.form.destroy()},"validate":function(){return this.form.refreshValidationState(!0),this.form.isValid(!0)},"setFocus":function(){this.form.children.some(function(e){var i=!e.options.readonly&&!e.schema.readonly;return i&&e.trigger("focus"),i})},"getValues":function(e){var i=this.form.getValue();return i&&e&&(i=r.getValueOnPath(i,e)),i},"_blockActions":function(){},"_unblockActions":function(){},"_validate":function(e){return!0},"hideNotRequired":function(i){var n=this.$(".alpaca-field"),a=this.$(".thumbnail_section"),s=t.merge(n,a),l=s.not(".alpaca-field-object, .cs-form-set .alpaca-field-array"),r=s.filter(".alpaca-field-object, .cs-form-set .alpaca-field-array");e.each(r,function(e){0===t(e).find(".alpaca-required").length&&l.push(e)});var o=l.not(".alpaca-required"),d=s.length===o.length,c=e.filter(o,function(e){return e=e&&t(e).closest(".cs-form-set").length>0?e:void 0}),u=e.filter(c,function(e){return e=t(e).hasClass("alpaca-field-array")&&0===t(e).closest(".cs-form-set-container").find(".alpaca-required").length?e:void 0});o=e.union(e.difference(o,c),u);var h=d?this.$el:o,p=i?"addClass":"removeClass";return t(h)[p]("binf-hidden"),i?t(o).attr("data-cstabindex","-1"):t(o).removeAttr("data-cstabindex"),this.$el[p]("csui-required-fields-only"),d}});m.version="1.0";var g=l.Connector.extend({});return l.registerConnectorClass("otcs_context",g),m}),csui.define("hbs!csui/controls/typeaheadpicker/impl/typeaheaditem",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a,s;return'  <div class="item-info lightweight'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="csui-item-name '+this.escapeExpression((s=null!=(s=i.cssItemName||(null!=e?e.cssItemName:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cssItemName","hash":{}}):s))+' binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+"</span>\r\n  </div>\r\n"},"2":function(e,i,t,n){return" binf-disabled"},"4":function(e,i,t,n){var a,s;return'  <div class="item-picture'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="csui-default-icon '+this.escapeExpression((s=null!=(s=i.cssDefaultIcon||(null!=e?e.cssDefaultIcon:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cssDefaultIcon","hash":{}}):s))+'"></span>\r\n    <img class="csui-custom-image '+this.escapeExpression((s=null!=(s=i.cssCustomImage||(null!=e?e.cssCustomImage:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cssCustomImage","hash":{}}):s))+' binf-hidden" alt="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'"\r\n         src="'+this.escapeExpression((s=null!=(s=i.imageUrl||(null!=e?e.imageUrl:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"imageUrl","hash":{}}):s))+'" >\r\n  </div>\r\n  <div class="item-info fullweight'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="csui-item-name '+this.escapeExpression((s=null!=(s=i.cssItemName||(null!=e?e.cssItemName:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cssItemName","hash":{}}):s))+' binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+"</span>\r\n    "+(null!=(a=i.if.call(e,null!=e?e.moreHtml:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+"\r\n"+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop}))?a:"")+"  </div>\r\n"},"5":function(e,i,t,n){var a,s;return null!=(s=null!=(s=i.moreHtml||(null!=e?e.moreHtml:e))?s:i.helperMissing,a="function"==typeof s?s.call(e,{"name":"moreHtml","hash":{}}):s)?a:""},"7":function(e,i,t,n){var a;return'      <span class="message binf-pull-left">'+this.escapeExpression((a=null!=(a=i["disabled-message"]||(null!=e?e["disabled-message"]:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"disabled-message","hash":{}}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return(null!=(a=i.if.call(e,null!=e?e.lightWeight:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.program(4,n,0)}))?a:"")+"\r\n"}});return t.registerPartial("csui_controls_typeaheadpicker_impl_typeaheaditem",n),n}),csui.define("css!csui/controls/typeaheadpicker/impl/typeaheadpicker",[],function(){}),csui.define("csui/controls/typeaheadpicker/impl/typeaheaditem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/utils/base","csui/utils/url","csui/utils/nodesprites","csui/utils/user.avatar.color","hbs!csui/controls/typeaheadpicker/impl/typeaheaditem","css!csui/controls/typeaheadpicker/impl/typeaheadpicker"],function(e,i,t,n,a,s,l,r,o){return t.ItemView.extend({"template":o,"tagName":"div","className":"csui-typeaheadpicker-item","ui":{"customImage":".item-picture .csui-custom-image","defaultIcon":".item-picture .csui-default-icon"},"templateHelpers":function(){var e;if(this.options.hbs&&this.options.hbs.itemMoreTemplate){var i=this.options.hbs.itemMoreHelper?this.options.hbs.itemMoreHelper.call(this):this.model.attributes;e=this.options.hbs.itemMoreTemplate(i)}return{"name":this.formatItemName(this.model),"moreHtml":e,"disabled":this.model.get("disabled"),"disabled-message":this.options.disabledMessage,"lightWeight":!!this.options.lightWeight,"imageUrl":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=","cssItemName":this.options.css&&this.options.css.itemName||"name","cssCustomImage":this.options.css&&this.options.css.customImage||"csui-icon binf-img-circle","cssDefaultIcon":this.options.css&&this.options.css.defaultIcon||"csui-icon csui-initials image_typeahead_placeholder"}},"formatItemName":function(e){return this.options.formatItemName?this.options.formatItemName(e):a.formatMemberName(e)},"constructor":function(e){e||(e={}),e.disabledMessage||(e.disabledMessage=""),e.css&&e.css.root&&(this.className=e.css.root),t.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.options.lightWeight||this._displayProfileImage()},"onDestroy":function(){this._releaseImageUrl()},"_displayProfileImage":function(){this.ui.customImage.addClass("csui-typeahead-image-"+this.model.get("id"));var i=this.model.get(this.model.imageAttribute||"image_url");if(i&&i.indexOf("?")>0){var t=this.options.connector.connection,n=new s(t.url).getCgiScript();i=s.combine(n,i);var a={"url":i,"dataType":"binary"};this._releaseImageUrl(),this.options.connector.makeAjaxCall(a).always(e.bind(function(e,i,t){200===t.status?(this._releaseImageUrl(),this._imageUrl=URL.createObjectURL(e),this.ui.customImage.attr("src",this._imageUrl),this.ui.defaultIcon.addClass("binf-hidden"),this.ui.customImage.removeClass("binf-hidden")):(this._releaseImageUrl(),this._renderDefaultIcon(this.options.css&&this.options.css.defaultIcon))},this))}else i&&i.startsWith("data:image/")?(this.ui.customImage.attr("src",i),this.ui.defaultIcon.addClass("binf-hidden"),this.ui.customImage.removeClass("binf-hidden")):(this._releaseImageUrl(),this._renderDefaultIcon(this.options.css&&this.options.css.defaultIcon))},"_renderDefaultIcon":function(e){if(this.ui.defaultIcon.attr("class","csui-default-icon"),this.ui.defaultIcon.addClass(e||"csui-icon csui-initials image_typeahead_placeholder"),this.ui.defaultIcon.hasClass("csui-initials")){var i,t=this.model.attributes.initials;if(t)i=r.getUserAvatarColor(this.model.attributes);else{var n=this.model.attributes[this.model.nameAttribute||"name"]||"",a=n.trim().indexOf(" ");t=a>0?n[0]+n[a+1]:n.substring(0,2),i=r.getUserAvatarColor({"initials":t})}this.ui.defaultIcon.text(t),this.ui.defaultIcon.css("background-color",i)}else if(this.ui.defaultIcon.hasClass("csui-nodesprites")){var s=l.findByNode(this.model),o=s&&s.get("className")||"";this.ui.defaultIcon.addClass(o),this.ui.defaultIcon.text(""),this.ui.defaultIcon.css("background-color","")}else this.ui.defaultIcon.text(""),this.ui.defaultIcon.css("background-color","");this.ui.customImage.addClass("binf-hidden"),this.ui.customImage.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=")},"_releaseImageUrl":function(){this._imageUrl&&(URL.revokeObjectURL(this._imageUrl),this._imageUrl=void 0)}})}),csui.define("csui/controls/typeaheadpicker/nls/typeaheadpicker.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/typeaheadpicker/nls/root/typeaheadpicker.lang",{"placeholderDefault":"Enter a name...","noResults":"No results found","clearValue":"Clear search value"}),csui.define("hbs!csui/controls/typeaheadpicker/impl/typeaheadpicker",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.ariaLabel||(null!=e?e.ariaLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"ariaLabel","hash":{}}):a))+'"'},"3":function(e,i,t,n){var a;return'aria-describedby="'+this.escapeExpression((a=null!=(a=i.idBtnDescription||(null!=e?e.idBtnDescription:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnDescription","hash":{}}):a))+'" '},"5":function(e,i,t,n){var a;return' aria-required="'+this.escapeExpression((a=null!=(a=i.isRequired||(null!=e?e.isRequired:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"isRequired","hash":{}}):a))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-item-picker '+this.escapeExpression((s=null!=(s=i.classItemPicker||(null!=e?e.classItemPicker:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"classItemPicker","hash":{}}):s))+'"\r\n     role="combobox" aria-expanded="false" aria-haspopup="true">\r\n  <input id="'+this.escapeExpression((s=null!=(s=i.id_input||(null!=e?e.id_input:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"id_input","hash":{}}):s))+'" class="typeahead binf-form-control cs-search" type="text"\r\n         aria-autocomplete="list" '+(null!=(a=i.if.call(e,null!=e?e.ariaLabel:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.idBtnDescription:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop}))?a:"")+"\r\n    "+(null!=(a=i.if.call(e,null!=e?e.isRequired:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+' placeholder="'+this.escapeExpression((s=null!=(s=i.placeholder||(null!=e?e.placeholder:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"placeholder","hash":{}}):s))+'"\r\n         aria-expanded="false" role="combobox">\r\n  <div class="typeahead cs-search-clear csui-icon formfield_clear" title="'+this.escapeExpression((s=null!=(s=i.clearValue||(null!=e?e.clearValue:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"clearValue","hash":{}}):s))+'"\r\n       aria-label="'+this.escapeExpression((s=null!=(s=i.clearValue||(null!=e?e.clearValue:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"clearValue","hash":{}}):s))+'" style="" tabindex="0"></div>\r\n  <div class="typeahead cs-search-icon icon-sv-search"></div>\r\n</div>'}});return t.registerPartial("csui_controls_typeaheadpicker_impl_typeaheadpicker",n),n}),csui.define("css!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield",[],function(){}),csui.define("csui/controls/typeaheadpicker/typeaheadpicker.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/utils/base","csui/utils/url","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/typeaheadpicker/impl/typeaheaditem.view","i18n!csui/controls/typeaheadpicker/nls/typeaheadpicker.lang","hbs!csui/controls/typeaheadpicker/impl/typeaheadpicker","css!csui/controls/typeaheadpicker/impl/typeaheadpicker","css!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield","csui/lib/bootstrap3-typeahead","csui/lib/jquery.when.all"],function(e,i,t,n,a,s,l,r,o,d,c,u){return a.LayoutView.extend({"template":u,"templateHelpers":function(){var e=this.options.id_input&&this.options.id_input.length>0?this.options.id_input:i.uniqueId("csui-typeaheadpicker-input");return{"placeholder":this.options.placeholder,"id_input":e,"ariaLabel":this.options.ariaLabel||this.options.placeholder,"idBtnDescription":this.options.descriptionId,"clearValue":c.clearValue,"isRequired":this.options.isRequired,"classItemPicker":this.options.css&&this.options.css.itemPicker||"csui-control-typeaheadpicker"}},"ui":{"itempicker":"div.cs-item-picker","searchbox":"input.typeahead","searchicon":".typeahead.cs-search-icon","searchclear":".typeahead.cs-search-clear"},"behaviors":function(){return{"TabableRegionBehavior":{"behaviorClass":o}}},"currentlyFocusedElement":function(e){return this.ui.searchclear&&t(this.ui.searchclear).is(":visible")&&e&&e.shiftKey?this.ui.searchclear:this.ui.searchbox},"triggers":{"click @ui.searchbox":"click","click @ui.searchicon":"click"},"events":{"keyup @ui.searchbox":"onKeyUp","keydown @ui.searchbox":"onKeyDown","click @ui.searchclear":"onClickClear","keydown @ui.searchclear":"onClickClear","dragstart .typeahead.binf-dropdown-menu li > a":"onDragItem"},"constructor":function(e){if(e||(e={}),e.css&&e.css.root&&(this.className=e.css.root),void 0!==e.placeholder||(e.placeholder=c.placeholderDefault),e.clearOnSelect||(e.clearOnSelect=!1),e.items||(e.items="all"),e.delay||(e.delay=200),e.disabledMessage||(e.disabledMessage=""),e.prettyScrolling||(e.prettyScrolling=!1),!e.collection)throw new Error("Collection is missing in the constructor options.");e.model||(e.model=new e.collection.model(void 0,{"connector":e.collection.connector})),a.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){t(this.ui.searchicon).on("click",i.bind(this.onClickIcon,this));var e=s.compile('<span><li class="csui-typeahead-picker-no-results{{#if classNoResults}} {{classNoResults}}{{/if}}">{{langNoResults}}</li></span>')({"classNoResults":this.options.css&&this.options.css.noResults,"langNoResults":c.noResults}),n={"items":this.options.items,"delay":this.options.delay,"collection":this.collection,"autoSelect":!1,"matcher":this._matchItems,"sorter":this._sortItems,"source":i.bind(this._retrieveItems,this),"displayText":i.bind(this._retrieveDisplayText,this),"highlighter":i.bind(this._renderHighlighter,this),"afterSelect":i.bind(this._afterSelect,this),"nextHighlighter":i.bind(this._nextHighlighter,this),"accessibility":i.bind(this._accessibility,this),"currentHighlighter":i.bind(this._currentHighlighter,this),"prettyScrolling":this.options.prettyScrolling,"appendTo":this.ui.itempicker,"handleNoResults":!0,"emptyTemplate":e,"beforeShow":this._beforePositioning,"afterShow":i.bind(this._positionContainer,this)};this.options.scrollContainerHeight&&(n.scrollContainerHeight=this.options.scrollContainerHeight),this.ui.searchbox.typeahead(n),this.model.get(this.model.idAttribute||"id")&&this.ui.searchbox.val(l.formatMemberName(this.model)),this.updateStyles()},"onKeyUp":function(e){this.updateStyles(),""===this.ui.searchbox.val()&&(this.trigger("item:clear"),this.ui.searchbox.removeAttr("aria-activedescendant"))},"onClickIcon":function(){this.context&&this.context.$scrollContainer.is(":visible")||(this.ui.searchbox.typeahead("lookup"),this.ui.searchbox.trigger("focus"))},"onKeyDown":function(e){9===e.keyCode&&t(this.ui.searchclear).is(":visible")&&(e.shiftKey?(this.updateStyles(),this.ui.searchbox.typeahead("hide")):(e.preventDefault(),e.stopPropagation(),this.ui.searchclear.trigger("focus")))},"onClickClear":function(e){"click"===e.type||13===e.keyCode?(this.ui.searchbox.val(""),this.updateStyles(),this.trigger("item:clear"),this.ui.searchbox.removeAttr("aria-activedescendant"),this.ui.searchbox.typeahead("hide"),this.ui.searchbox.trigger("focus")):9===e.keyCode&&t(this.ui.searchclear).is(":visible")&&(e.shiftKey?(e.preventDefault(),e.stopPropagation(),this.ui.searchbox.trigger("focus")):(this.updateStyles(),this.ui.searchbox.typeahead("hide")))},"onDragItem":function(e){return!1},"updateStyles":function(){var e=this.ui.searchbox.val()&&this.ui.searchbox.val().length>0;this.ui.searchclear.css({"display":e?"":"none"})},"_retrieveItems":function(e){if(this.options.onRetrieveItems)return this.options.onRetrieveItems(this.collection,e);var n=this.collection,a=t.Deferred();return n.setFilter(i.object([this.model.nameAttribute||"name"],[e]),{"fetch":!1})?(n.fetch().then(function(){a.resolve(n.models)},function(){a.reject()}),a.promise()):a.resolve(n.models).promise()},"_retrieveDisplayText":function(e){return e.get(this.model.nameAttribute||"name")},"_renderHighlighter":function(e){var t=this.collection.findWhere(i.object([this.model.nameAttribute||"name"],[e]));return new(this.options.TypeaheadItemView?this.options.TypeaheadItemView(t):d)(i.extend({"model":t,"connector":this.collection.connector,"disabledMessage":this.options.disabledMessage,"lightWeight":this.options.lightWeight},this.options.itemOptions||{})).render().el},"_matchItems":function(e){return!this.options.onMatchItems||this.options.matchItems(this.collection,e)},"_sortItems":function(e){return e},"_afterSelect":function(e){var i=this.options.clearOnSelect?"":l.formatMemberName(e);this.ui.searchbox.val(i),this.updateStyles(),this.trigger("item:change",{"item":e})},"_currentHighlighter":function(e){},"_nextHighlighter":function(e){},"_accessibility":function(e){this.ui.searchbox.attr("aria-activedescendant",e.attr(this.model.idAttribute||"id"))},"_beforePositioning":function(e){var i=e.$element.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling";e.$element.closest(i).length>0&&e.$appendTo&&e.$appendTo.addClass("csui-transparent")},"_positionContainer":function(e){var i=0,n=0,a=0,s=e.$element.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",r=e.$element.closest(s),o=e.$scrollContainer.children("ul.typeahead.binf-dropdown-menu").height(),d=this;d.context=e,r=r.length>0?r:e.$element.closest(".alpaca-field"),e.$element.addClass("cs-typeaheadfield-height"),r.length>0&&(n=r.offset().top,a=r.height(),i=e.$element.offset().top,n<0&&(n*=-1),i-n>a+n-i&&i>0&&e.$scrollContainer.height()>i-r.offset().top&&(e.$element.css("overflow","hidden"),e.$element.perfectScrollbar({"suppressScrollX":!0})),o<450&&e.$scrollContainer.children("ul.typeahead.binf-dropdown-menu").append(t("<div class='picker-spacer'>spacer</div>")),e.$scrollContainer.css("height","auto"),setTimeout(function(){e.$scrollContainer.scrollTop(0),e.$scrollContainer.children("ul.typeahead.binf-dropdown-menu").find(".picker-spacer").remove();var i=e.$element;l.adjustDropDownField(i,e.$scrollContainer,!0,d,d.hideItemPicker,e.$scrollContainer),e.$scrollContainer.perfectScrollbar("update"),e.$appendTo&&e.$appendTo.removeClass("csui-transparent"),d.trigger("typeahead:picker:open"),d.ui.searchbox.attr("aria-expanded",!0),d.ui.searchbox.attr("aria-owns","user-picker-ul")},0))},"hideItemPicker":function(e){e.context.$scrollContainer.hide(),e.trigger("typeahead:picker:close"),e.ui.searchbox.attr("aria-expanded",!1)}})}),csui.define("hbs!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a;return'aria-labelledby="'+this.escapeExpression((a=null!=(a=i.idBtnLabel||(null!=e?e.idBtnLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"idBtnLabel","hash":{}}):a))+'"'},"3":function(e,i,t,n){var a;return' aria-label="'+this.escapeExpression((a=null!=(a=i.multiFieldLabel||(null!=e?e.multiFieldLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"multiFieldLabel","hash":{}}):a))+'"'},"5":function(e,i,t,n){var a;return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+this.escapeExpression((a=null!=(a=i.cancel||(null!=e?e.cancel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cancel","hash":{}}):a))+'"></div>\r\n      </div>\r\n'},"7":function(e,i,t,n){var a;return null!=(a=i.if.call(e,null!=(a=null!=e?e.options:e)?a.applyFlag:a,{"name":"if","hash":{},"fn":this.program(8,n,0),"inverse":this.noop}))?a:""},"8":function(e,i,t,n){var a
;return'        <div class="icon-container binf-hidden">\r\n          <div class="csui-icon apply-all binf-hidden" title="'+this.escapeExpression((a=null!=(a=i.titleApplyAll||(null!=e?e.titleApplyAll:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"titleApplyAll","hash":{}}):a))+'" tabindex="0"\r\n               data-cstabindex="0"></div>\r\n        </div>\r\n'},"10":function(e,i,t,n){var a,s;return'          <div class="cs-field-read-content"\r\n            tabindex="0" data-cstabindex="0"\r\n               aria-label="'+this.escapeExpression((s=null!=(s=i.editModeAria||(null!=e?e.editModeAria:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"editModeAria","hash":{}}):s))+'">\r\n            <img class="cs-field-picture csui-custom-image '+this.escapeExpression((s=null!=(s=i.cssCustomImage||(null!=e?e.cssCustomImage:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cssCustomImage","hash":{}}):s))+' binf-hidden" src="'+this.escapeExpression((s=null!=(s=i.imageUrl||(null!=e?e.imageUrl:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"imageUrl","hash":{}}):s))+'" alt="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">\r\n            <span class="cs-field-picture csui-default-icon '+this.escapeExpression((s=null!=(s=i.cssDefaultIcon||(null!=e?e.cssDefaultIcon:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"cssDefaultIcon","hash":{}}):s))+'"></span>\r\n            <div class="cs-name">\r\n'+(null!=(a=i.if.call(e,null!=e?e.isTouch:e,{"name":"if","hash":{},"fn":this.program(11,n,0),"inverse":this.program(13,n,0)}))?a:"")+"            </div>\r\n          </div>\r\n"},"11":function(e,i,t,n){var a;return'                <div class="csui-typeahead-container '+this.escapeExpression((a=null!=(a=i.cssItemName||(null!=e?e.cssItemName:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cssItemName","hash":{}}):a))+'">\r\n                  '+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+"\r\n                </div>\r\n"},"13":function(e,i,t,n){var a;return'                <a href="javascript:void(0);" aria-label="'+this.escapeExpression((a=null!=(a=i.readModeAria||(null!=e?e.readModeAria:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"readModeAria","hash":{}}):a))+'"\r\n                   class="csui-typeahead-container '+this.escapeExpression((a=null!=(a=i.cssItemName||(null!=e?e.cssItemName:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"cssItemName","hash":{}}):a))+'"\r\n                   data-binf-original-title="" data-cstabindex="0">\r\n                  '+this.escapeExpression((a=null!=(a=i.name||(null!=e?e.name:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"name","hash":{}}):a))+"\r\n                </a>\r\n"},"15":function(e,i,t,n){var a;return'          <div class="cs-field-read-content placeholder" role="button" title="'+this.escapeExpression((a=null!=(a=i.noValue||(null!=e?e.noValue:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noValue","hash":{}}):a))+'"\r\n            tabindex="0" data-cstabindex="0" aria-label="'+this.escapeExpression((a=null!=(a=i.noName||(null!=e?e.noName:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"noName","hash":{}}):a))+'">\r\n            '+this.escapeExpression((a=null!=(a=i.emptyLabel||(null!=e?e.emptyLabel:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"emptyLabel","hash":{}}):a))+"\r\n          </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a,s;return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <div class="picker-container" '+(null!=(a=i.if.call(e,null!=e?e.idBtnLabel:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.noop}))?a:"")+"\r\n      "+(null!=(a=i.if.call(e,null!=e?e.multiFieldLabel:e,{"name":"if","hash":{},"fn":this.program(3,n,0),"inverse":this.noop}))?a:"")+"></div>\r\n"+(null!=(a=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":this.program(5,n,0),"inverse":this.program(7,n,0)}))?a:"")+'\r\n  </div>\r\n</div>\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n    <div class="btn-container">\r\n      <div>\r\n'+(null!=(a=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(10,n,0),"inverse":this.program(15,n,0)}))?a:"")+'      </div>\r\n    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+this.escapeExpression((s=null!=(s=i.edit||(null!=e?e.edit:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"edit","hash":{}}):s))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n'}});return t.registerPartial("csui_controls_form_impl_fields_typeaheadfield_typeaheadfield",n),n}),csui.define("csui/controls/form/fields/typeaheadfield.view.mixin",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/utils/base","csui/utils/url","csui/lib/numeral","csui/lib/handlebars","csui/utils/nodesprites","csui/controls/form/impl/fields/csformfield.view","csui/controls/typeaheadpicker/typeaheadpicker.view","csui/utils/user.avatar.color","hbs!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield","csui/lib/jquery.binary.ajax"],function(e,i,t,n,a,s,l,r,o,d,c,u,h,p,f,m){return{"mixin":function(e){return i.extend(e,{"makeTypeaheadFieldView":function(e){this.connector=this.options.context.getObject(s),this.dropdownMenuVisible=!1,e.css&&e.css.root&&(this.className=e.css.root)},"ui":{"readField":".cs-field-read-content","readFieldInner":".cs-field-read-inner","pickerContainer":".picker-container","writeField":".picker-container input","readArea":".cs-field-read","fieldPicture":".cs-field-picture","customImage":".cs-field-picture.csui-custom-image","defaultIcon":".cs-field-picture.csui-default-icon","itemName":".csui-typeahead-container","cancelIcon":".edit-cancel","readContentArea":".cs-field-read-content","itemDisplayName":".cs-name .csui-typeahead-container"},"events":function(){var e=l.isTouchBrowser()?{}:{"mouseover @ui.customImage":"showItemInfoPopup","mouseover @ui.defaultIcon":"showItemInfoPopup","mouseover @ui.itemDisplayName":"showItemInfoPopup","mouseleave @ui.customImage":"removeUnderline","mouseleave @ui.defaultIcon":"removeUnderline","mouseleave @ui.itemDisplayName":"removeUnderline","focusout @ui.itemDisplayName":"removeUnderline","click @ui.itemDisplayName":"showItemProfileDialog"};return l.isTouchBrowser()&&this.model.get("schema").readonly&&i.extend(e,{"click @ui.itemDisplayName":"showItemProfileDialog"}),i.extend(e,{"click @ui.customImage":"showItemProfileDialog","click @ui.defaultIcon":"showItemProfileDialog","keyup":"onKeyUp","keydown":"onKeyDown","click @ui.cancelIcon":"onCancelClicked","focusout @ui.writeField":"onFocusOutWrite","mousedown":"onMouseDown"}),e},"onRender":function(){this.ui.itemName.hasClass("csui-hovering")||this.ui.itemName.addClass("cs-no-hover csui-hovering"),this.data=this.model.get("data"),this.editValue=this.data,this.curVal=this.editValue,this.placeHolderText=this.options.alpacaField&&this.options.alpacaField.schema.disabled?m.noValueSet:this.alpacaField&&this.alpacaField.schema&&this.alpacaField.schema.placeholder?this.alpacaField.schema.placeholder:this.options.lang&&this.options.lang.alpacaPlaceholder||m.alpacaPlaceholderGeneric;var e="";this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem?e=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:"":this.alpacaField&&this.alpacaField.options&&(e=this.alpacaField.options.label?this.alpacaField.options.label:"");var n=this.options.TypeaheadPickerView||h;this.pickerView=new n(t.extend({"context":this.options.context,"placeholder":this.placeHolderText,"prettyScrolling":!0,"limit":20,"id":i.uniqueId(this.model.get("id")),"id_input":this.model.get("id"),"ariaLabel":e,"isRequired":this.options.alpacaField&&this.options.alpacaField.isRequired(),"descriptionId":this.options?this.options.descriptionId:"","lang":this.options.lang},this.options.pickerOptions||{})),this.listenTo(this.pickerView,"item:change",this.onItemChange),this.listenTo(this.pickerView,"typeahead:picker:open",this.onItemPickerOpen),this.listenTo(this.pickerView,"typeahead:picker:close",this.onItemPickerClose),this.listenTo(this.pickerView,"render",this.disableField),this.setItemPicked(!0),this.dialogOpen=!1,this.ui.pickerContainer.append(this.pickerView.$el),this.ui.writeField=this.$el.find(".picker-container input"),this.getEditableBehavior().ui.writeField=this.ui.writeField,!this.data.id||void 0!==this.options.noID&&this.data.id===this.options.noID||(this.pickerView.model.set(this.data),this._keyboardNavigationNotification(),this._setDefaultIcon(),this._setCustomImage()),this.pickerView.render()},"_setCustomImage":function(){var e=this.data[this.model.imageAttribute||"image_url"];e&&this._renderCustomImage(e)},"_renderCustomImage":function(e){e&&e.indexOf("?")>0?this._resolveImage(e).done(i.bind(function(e){this.url&&URL.revokeObjectURL(this.url),this.url=URL.createObjectURL(e),this.ui.customImage.attr("src",this.url),this.ui.defaultIcon.addClass("binf-hidden"),this.ui.customImage.removeClass("binf-hidden")},this)):e.startsWith("data:image/")&&(this.ui.customImage.attr("src",e),this.ui.defaultIcon.addClass("binf-hidden"),this.ui.customImage.removeClass("binf-hidden"))},"disableField":function(e){this.ui.pickerContainer.append(this.pickerView.$el),this.ui.writeField=this.$el.find(".picker-container input"),this.getEditableBehavior().ui.writeField=this.ui.writeField,this.trigger("disable:field")},"onItemPickerOpen":function(e){this.options.isDropDownOpen=!0;var i=this.$el.closest(".csui-scrollable-writemode");i&&!i.hasClass("csui-dropdown-open")&&i.addClass("csui-dropdown-open"),this.getEditableBehavior().hideActions&&this.getEditableBehavior().hideActions(e)},"onItemPickerClose":function(e){this.options.isDropDownOpen=!1;var i=this.$el.closest(".csui-scrollable-writemode");i&&i.hasClass("csui-dropdown-open")&&i.removeClass("csui-dropdown-open"),this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(e)},"removeUnderline":function(e){void 0!==this.options.noID&&this.data.id===this.options.noID||(this.ui.fieldPicture.removeClass("cs-hover"),this.ui.itemName.removeClass("cs-hover").addClass("cs-no-hover"))},"showItemProfileDialog":function(e){void 0!==this.options.noID&&this.data.id===this.options.noID||this.options.isInPopover||(e.preventDefault(),e.stopPropagation(),this.getItemWidget()?(this.dialogOpen=!0,this.showItemProfileDialogWidget(e)):this.createItemWidget("showItemProfileDialog",e))},"showItemProfileDialogWidget":function(e){this.ui.fieldPicture.addClass("cs-hover"),this.ui.itemName.removeClass("cs-no-hover").addClass("cs-hover"),this.getItemWidget().closeItemInfoPopup(e),this.getItemWidget().showItemProfileDialog(e)},"showItemInfoPopup":function(e){this.options.isInPopover=this.$el.closest(".csui-colout-formitems").length>0,void 0!==this.options.noID&&this.data.id===this.options.noID||this.options.isInPopover||(this.getItemWidget()?this.showItemInfoPopupWidget(e):this.createItemWidget("showItemInfoPopup",e))},"showItemInfoPopupWidget":function(e){this.ui.fieldPicture.addClass("cs-hover"),this.ui.itemName.removeClass("cs-no-hover").addClass("cs-hover"),this.getItemWidget().showItemInfoPopup(e)},"createItemWidget":function(e,t){if(this.options.createItemWidgetView){var n=this.$el.find(".csui-typeahead-container");this.options.createItemWidgetView.call(this,i.bind(function(a){this.setItemWidget(a),clearTimeout(this.getItemWidget().profileTimer);var s=setTimeout(i.bind(function(){n.binf_popover("show"),this[e](t)},this,t),500);this.getItemWidget().profileTimer=s,this[e](t)},this))}},"setItemWidget":function(e){this.itemWidgetView=e},"getItemWidget":function(){return this.itemWidgetView},"setItemPicked":function(e){this.itemPicked=e},"getItemPicked":function(){return this.itemPicked},"onCancelClicked":function(e){this.setItemPicked(!0)},"allowEditOnClickReadArea":function(e){var i=!("readonly"!==this.mode&&this.dialogOpen);return this.dialogOpen=!1,i||!0},"className":"cs-formfield cs-typeaheadfield","template":f,"templateHelpers":function(){var e="",t=this.options.alpacaField&&this.options.alpacaField.isRequired(),n="",a="",s=!1;n=t?m.requiredField:"",s=this.model&&this.model.attributes&&this.model.attributes.schema&&this.model.attributes.schema.readonly,this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(e=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:"",s=this.alpacaField.parent.options.readonly),a=e||this.model.get("options")&&this.model.get("options").label;var r=this.model.get("data"),o=void 0!==this.options.noId&&r.id===this.options.noId?this.options.lang&&this.options.lang.noItem||m.noValue:r.display_name||r.name_formatted,d=o||m.noValue,c=i.str.sformat(m.fieldEditAria,a,d)+n,h=o?i.str.sformat(this.options.lang&&this.options.lang.fieldReadOnlyAria||m.fieldReadOnlyAria,a,d)+n:i.str.sformat(this.options.lang&&this.options.lang.emptyFieldReadOnlyAria||m.fieldReadOnlyAria,a,d)+n,p={"name":o,"isTouch":l.isTouchBrowser(),"idBtnLabel":this.options.labelId,"applyFlag":this.options.applyFlag,"multiFieldLabel":e,"readModeAria":h,"editModeAria":s?h:c,"noName":s?h:c,"ariaRequired":t,"imageUrl":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=","cssItemName":this.options.css&&this.options.css.itemName||"cs-no-hover csui-hovering","cssCustomImage":this.options.css&&this.options.css.customImage||"binf-img-circle","cssDefaultIcon":this.options.css&&this.options.css.defaultIcon||"csui-icon csui-initials image_typeahead_placeholder"};return i.extend(u.prototype.templateHelpers.apply(this),p)},"formatItemName":function(e){return this.options.formatItemName?this.options.formatItemName(e):l.formatMemberName(e)},"setStateWrite":function(e,t,n){var a=this,s="writeonly"===this.mode?this.getEditValue():"read"===n?this.model.get("data"):this.getEditValue();return this.pickerView.model.set(i.extend(s,{"display_name":this.formatItemName(s)})),this.pickerView.render(),this.getStatesBehavior()._setStateWrite(e,t),t&&a.$(".picker-container input").trigger("focus").trigger("select"),this.editValue=s,!0},"isReadyToSave":function(){var e=this.$(".typeahead.binf-dropdown-menu");return(0===e.length||!e.is(":visible"))&&this.getItemPicked()},"onItemChange":function(e){this.editValue=e.item.attributes,this.setItemPicked(!0),this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(this),this.options.isDropDownOpen=!1,this.trigger("selection:changed")},"getEditValue":function(){return this.pickerView.$el.find("input").val()||(this.editValue={"display_name":"","id":null,"name":""}),this.getItemPicked()&&this.pickerView.$el.find("input").val(this.formatItemName(this.editValue)),this.editValue},"_getChangeValue":function(){return this.model.get("data").id},"_keyboardNavigationNotification":function(){this.options.model&&this.options.model.attributes.options&&"create"===this.options.model.attributes.options.mode&&setTimeout(i.bind(function(){var e=t.Event("tab:content:field:changed");this.$el.trigger(e)},this),300)},"_setDefaultIcon":function(){this.ui.customImage.addClass("csui-typeahead-image-"+this.data.id),this.ui.defaultIcon.addClass("csui-typeahead-icon-"+this.data.id),this._renderDefaultIcon(this.options.css&&this.options.css.defaultIcon)},"_renderDefaultIcon":function(e){if(this.ui.defaultIcon.attr("class","cs-field-picture csui-default-icon"),this.ui.defaultIcon.addClass(e||"csui-icon csui-initials image_typeahead_placeholder"),this.ui.defaultIcon.hasClass("csui-initials")){var i,t=this.options.model.attributes.data.initials;if(t)i=p.getUserAvatarColor(this.options.model.attributes.data);else{var n=this.options.model.attributes.data[this.model&&this.model.nameAttribute||"name"]||"",a=n.trim().indexOf(" ");t=a>0?n[0]+n[a+1]:n.substring(0,2),i=p.getUserAvatarColor({"initials":t})}this.ui.defaultIcon.text(t),this.ui.defaultIcon.css("background-color",i)}else if(this.ui.defaultIcon.hasClass("csui-nodesprites")){var s=c.findByNode(this.options.model.attributes.data),l=s&&s.get("className")||"";this.ui.defaultIcon.addClass(l),this.ui.defaultIcon.text(""),this.ui.defaultIcon.css("background-color","")}else this.ui.defaultIcon.text(""),this.ui.defaultIcon.css("background-color","");this.ui.customImage.addClass("binf-hidden"),this.ui.customImage.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=")},"getDisplayValue":function(){return this.getEditValue().name},"_resolveImage":function(e){var i=this.options.context,n=i.getObject(s),a=this.options.connection||n.connection,l=new r(a.url).getCgiScript(),o=t.Deferred(),d=r.combine(l,e),c={"url":d,"dataType":"binary","connection":a};return n.makeAjaxCall(c).done(function(e){o.resolve(e)}).fail(o.reject),o.promise()},"onDestroy":function(){this.pickerView&&this.pickerView.destroy(),this.url&&URL.revokeObjectURL(this.url)},"_getChangeEventValue":function(){return this.getValue().id},"onKeyPress":function(e){return 13===e.keyCode?(e.preventDefault(),e.stopPropagation(),this.getStatesBehavior().isStateRead()&&this.allowEditOnEnter()?this.getEditableBehavior().setViewStateWriteAndEnterEditMode():this.getStatesBehavior().isStateWrite()&&this.allowSaveOnEnter()&&this.getEditableBehavior().trySetValueAndLeaveEditMode(!0,!0)):32===e.keyCode&&this.getStatesBehavior().isStateRead()&&this.allowEditOnEnter()&&(e.preventDefault(),e.stopPropagation(),this.getEditableBehavior().setViewStateWriteAndEnterEditMode()),13===e.keyCode||9===e.keyCode||16===e.keyCode||113===e.keyCode?this.alpacaField&&this.alpacaField.refreshValidationState&&this.alpacaField.refreshValidationState(!1):this.setItemPicked(!1),!0},"onKeyDown":function(e){27===e.keyCode?(this.dropdownMenuVisible=this.options.isDropDownOpen,this.onItemPickerClose(e),e.preventDefault()):13!==e.keyCode&&32!==e.keyCode||(t(e.target).hasClass("csui-typeahead-container")&&this.showItemProfileDialog(e),this.alpacaField&&(this.alpacaField.keyDown=!0))},"onKeyUp":function(e){13===e.keyCode?(this.alpacaField&&this.alpacaField.refreshValidationState&&this.alpacaField.keyDown&&this.alpacaField.refreshValidationState(!1),this.alpacaField&&(this.alpacaField.keyDown=!1)):8===e.keyCode||46===e.keyCode?""===e.target.value?(this.setItemPicked(!0),"writeonly"===this.mode&&(this.model.attributes.data=""),this.getEditableBehavior().showActions&&this.getEditableBehavior().showActions(e),this.options.isDropDownOpen=!1):this.setItemPicked(!1):27===e.keyCode&&(this.dropdownMenuVisible&&(e.preventDefault(),e.stopPropagation()),this.dropdownMenuVisible=!1),this.setItemWidget("")},"handleTabKey":function(e){this.options.isDropDownOpen&&(this.pickerView.trigger("typeahead:picker:close",e),e.preventDefault(),e.stopPropagation())},"onMouseDown":function(e){!t(e.target.parentElement.parentElement).is(".csui-userpicker-item, .typeahead")&&!t(e.target).hasClass("member-info")||t(e.target).hasClass("csui-user-picker-no-results")||this.setItemPicked(!0)}})}}}),csui.define("csui/controls/form/fields/typeaheadfield.view",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/controls/form/fields/base/csformfield.view","csui/controls/form/fields/typeaheadfield.view.mixin"],function(e,i,t,n,a,s){var l=a.extend({"constructor":function(e){a.apply(this,arguments),this.makeTypeaheadFieldView(e)}});return s.mixin(l.prototype),l}),csui.define("csui/controls/form/fields/alpaca/alptypeaheadfield.mixin",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/typeaheadfield.view","csui/utils/base","i18n!csui/controls/form/impl/nls/lang"],function(e,i,t,n,a,s,l,r,o){return{"mixin":function(e){return i.extend(e,{"makeAlpTypeaheadField":function(){},"getFieldType":function(){return void 0!==this.options?this.options.alpacaFieldType||"":""},"postRender":function(e){this.base(e);var t={"id":this.data,"name":this.options.type_control?this.options.type_control.name:""};if(this.itemModel=void 0,this.data&&this.data!==this.options.noId){var n=this.field&&this.field.parent().find(".alpaca-control");if(this.options.ItemModelFactory){n.addClass("alpaca-control-hidden"),this.itemModel=this.connector.config.context.getModel(this.options.ItemModelFactory,{"attributes":{"id":this.data||""},"temporary":!0});var a=this;this.itemModel.ensureFetched().done(function(){a.showField(a.itemModel.attributes),n.removeClass("alpaca-control-hidden")}).fail(function(e){a.showField(i.extend(t,{"id":null})),n.removeClass("alpaca-control-hidden");var s=e&&e.responseJSON&&e.responseJSON.error||a.options.lang&&a.options.lang.invalidItem||o.invalidItem;a.displayMessage([{"id":"custom","message":s}],a.valid)})}else this.showField(i.extend(t,{"id":null}))}else this.showField(t);this.field.parent().addClass("csui-field-"+this.getFieldType()),this.field.parent().addClass(this.options.alpacaFieldClasses||"csui-field-otcs_typeahead")},"showField":function(e){var s,r=(this.id,this.options?this.options.descriptionId:""),d=t(this.field[0]).find("label");d&&1===d.length&&(s=d.attr("for")+"Label",d.attr("id",s));var c=this.options.TypeaheadFieldView||l;this.fieldView=new c({"context":this.connector.config.context,"data":e,"applyFlag":this.options.applyFlag,"model":i.extend(new n.Model({"data":e,"options":this.options,"schema":this.schema,"id":this.id}),{"imageAttribute":this.itemModel&&this.itemModel.imageAttribute,"nameAttribute":this.itemModel&&this.itemModel.nameAttribute}),"dataId":this.name,"noId":this.options.noId,"alpacaField":this,"labelId":s,"descriptionId":r,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema},"id":i.uniqueId(this.id),"css":this.options.css,"lang":this.options.lang,"pickerOptions":this.options.pickerOptions}),this.options.fieldValidator?this.options.validator=this.options.fieldValidator:this.options.validator=function(e){var i=this.fieldView&&this.fieldView.getItemPicked&&this.fieldView.getItemPicked();e({"status":i,"message":i?"":this.options.lang&&this.options.lang.invalidItem||o.invalidItem})};var u=t("<div>").addClass("alpaca-control");this.containerItemEl.find(".alpaca-control").replaceWith(u),this.region=new a.Region({"el":u}),this.region.show(this.fieldView)},"getValue":function(){var e="";return this.data&&this.data.id?e=this.data.id:this.data&&(e=""===this.data.id||null===this.data.id?"":this.data),e},"setValueAndValidate":function(e,i){this.setValue(e);var n=!0;return i?(n=this.validate(),this.refreshValidationState(!1)):this.fieldView.$el.trigger(t.Event("field:invalid")),n},"destroy":function(){this.base(),this.region&&this.region.destroy()},"handleValidate":function(){var e=this.base();if(!e){var i=this.validation;if(void 0!==this.fieldView.$el.find(".picker-container input").val()&&this.fieldView.$el.find(".picker-container input").val())return i.notOptional.status=!0,i.notOptional.message="",e;for(var t in i)!1===i[t].status&&"notOptional"!==t&&(i[t].status=!0,i[t].message="")}return e}})}}}),csui.define("csui/controls/userpicker/nls/userpicker.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/userpicker/nls/root/userpicker.lang",{"placeholderDefault":"Enter a name...","groupViewGroupTitle":"User Group","groupViewLeaderTitle":"Group Leader","invalidUser":"Invalid User","noResults":"No results found","clearValue":"Clear search value"}),csui.define("hbs!csui/controls/userpicker/impl/user",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a,s;return'  <div class="member-info'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+"</span>\r\n  </div>\r\n"},"2":function(e,i,t,n){return" binf-disabled"},"4":function(e,i,t,n){var a,s;return'  <div class="member-picture'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="csui-icon-paceholder csui-icon image_user_placeholder">'+this.escapeExpression((s=null!=(s=i.initials||(null!=e?e.initials:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"initials","hash":{}}):s))+'</span>\r\n    <img class="csui-icon-user csui-icon binf-img-circle binf-hidden" alt="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'"\r\n         src="'+this.escapeExpression((s=null!=(s=i.userImgSrc||(null!=e?e.userImgSrc:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"userImgSrc","hash":{}}):s))+'" >\r\n  </div>\r\n  <div class="member-info'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'</span>\r\n    <span class="email binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.email||(null!=e?e.email:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"email","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.email||(null!=e?e.email:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"email","hash":{}}):s))+'</span>\r\n    <span class="title binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.title||(null!=e?e.title:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.title||(null!=e?e.title:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'</span>\r\n    <span class="department binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.department||(null!=e?e.department:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"department","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.department||(null!=e?e.department:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"department","hash":{}}):s))+'</span>\r\n    <span class="office binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.office||(null!=e?e.office:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"office","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.office||(null!=e?e.office:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"office","hash":{}}):s))+"</span>\r\n"+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+"  </div>\r\n"},"5":function(e,i,t,n){var a;return'      <span class="message binf-pull-left">'+this.escapeExpression((a=null!=(a=i["disabled-message"]||(null!=e?e["disabled-message"]:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"disabled-message","hash":{}}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return(null!=(a=i.if.call(e,null!=e?e.lightWeight:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.program(4,n,0)}))?a:"")+"\r\n"}});return t.registerPartial("csui_controls_userpicker_impl_user",n),n}),csui.define("css!csui/controls/userpicker/impl/userpicker",[],function(){}),csui.define("csui/controls/userpicker/impl/user.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/utils/url","csui/utils/user.avatar.color","i18n!csui/controls/userpicker/nls/userpicker.lang","hbs!csui/controls/userpicker/impl/user","css!csui/controls/userpicker/impl/userpicker"],function(e,i,t,n,a,s,l,r){return t.ItemView.extend({"template":r,"tagName":"div","className":"csui-userpicker-item","ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"templateHelpers":function(){return{"name":n.formatMemberName(this.model),"email":this.model.get("business_email"),"title":this.model.get("title"),"department":this.model.get("group_id_expand")&&this.model.get("group_id_expand").name,"office":this.model.get("office_location"),"disabled":this.model.get("disabled"),"disabled-message":this.options.disabledMessage,"lightWeight":!!this.options.lightWeight,"userImgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}},"constructor":function(e){e||(e={}),e.disabledMessage||(e.disabledMessage=""),t.ItemView.prototype.constructor.call(this,e),this.listenTo(this,"render",this._assignUserColor)},"onRender":function(){this.options.lightWeight||this._displayProfileImage()},"onDestroy":function(){this._releasePhotoUrl()},"_displayProfileImage":function(){var i=this._getUserPhotoUrl();if(this.ui.personalizedImage.addClass("esoc-userprofile-img-"+this.model.get("id")),i){var t={"url":i,"dataType":"binary"};this._releasePhotoUrl(),this.options.connector.makeAjaxCall(t).always(e.bind(function(e,i,t){200===t.status?this._showPersonalizedImage(e):this._showDefaultImage()},this))}else this._showDefaultImage()},"_getUserPhotoUrl":function(){var e=this.options.connector.connection,i=new a(e.url).getCgiScript(),t=this.model.get("photo_url");if(t&&t.indexOf("?")>0)return a.combine(i,t)},"_showPersonalizedImage":function(e){this._releasePhotoUrl(),this._photoUrl=URL.createObjectURL(e),this.ui.personalizedImage.attr("src",this._photoUrl),this.ui.defaultImage.addClass("binf-hidden"),this.ui.personalizedImage.removeClass("binf-hidden")},"_showDefaultImage":function(e){this._releasePhotoUrl(),this.ui.personalizedImage.addClass("binf-hidden"),this.ui.defaultImage.removeClass("binf-hidden")},"_releasePhotoUrl":function(){this._photoUrl&&(URL.revokeObjectURL(this._photoUrl),this._photoUrl=void 0)},"_assignUserColor":function(){var e=s.getUserAvatarColor(this.model.attributes);this.ui.defaultImage.css("background",e)}})}),csui.define("hbs!csui/controls/userpicker/impl/group",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"1":function(e,i,t,n){var a,s;return'  <div class="member-info'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+"</span>\r\n  </div>\r\n"},"2":function(e,i,t,n){return" binf-disabled"},"4":function(e,i,t,n){var a,s;return'  <div class="member-picture'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop}))?a:"")+' binf-pull-left">\r\n    <span class="csui-icon image_group_placeholder"></span>\r\n  </div>\r\n  <div class="member-info'+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,n,0),"inverse":this.noop
}))?a:"")+' binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i.name||(null!=e?e.name:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'</span>\r\n    <span class="group-title binf-pull-left" title="'+this.escapeExpression((s=null!=(s=i["group-title"]||(null!=e?e["group-title"]:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"group-title","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=i["group-title"]||(null!=e?e["group-title"]:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"group-title","hash":{}}):s))+"</span>\r\n"+(null!=(a=i.if.call(e,null!=e?e.leader:e,{"name":"if","hash":{},"fn":this.program(5,n,0),"inverse":this.noop}))?a:"")+(null!=(a=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(7,n,0),"inverse":this.noop}))?a:"")+"  </div>\r\n"},"5":function(e,i,t,n){var a;return'      <span class="leader binf-pull-left" title="'+this.escapeExpression((a=null!=(a=i.leader||(null!=e?e.leader:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"leader","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=i.leader||(null!=e?e.leader:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"leader","hash":{}}):a))+'</span>\r\n      <span class="leader-title binf-pull-left" title="'+this.escapeExpression((a=null!=(a=i["leader-title"]||(null!=e?e["leader-title"]:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"leader-title","hash":{}}):a))+'">'+this.escapeExpression((a=null!=(a=i["leader-title"]||(null!=e?e["leader-title"]:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"leader-title","hash":{}}):a))+"</span>\r\n"},"7":function(e,i,t,n){var a;return'      <span class="message binf-pull-left">'+this.escapeExpression((a=null!=(a=i["disabled-message"]||(null!=e?e["disabled-message"]:e))?a:i.helperMissing,"function"==typeof a?a.call(e,{"name":"disabled-message","hash":{}}):a))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){var a;return(null!=(a=i.if.call(e,null!=e?e.lightWeight:e,{"name":"if","hash":{},"fn":this.program(1,n,0),"inverse":this.program(4,n,0)}))?a:"")+"\r\n"}});return t.registerPartial("csui_controls_userpicker_impl_group",n),n}),csui.define("csui/controls/userpicker/impl/group.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/utils/url","i18n!csui/controls/userpicker/nls/userpicker.lang","hbs!csui/controls/userpicker/impl/group","css!csui/controls/userpicker/impl/userpicker"],function(e,i,t,n,a,s,l){return t.ItemView.extend({"template":l,"tagName":"div","className":"csui-userpicker-item","templateHelpers":function(){return{"name":n.formatMemberName(this.model),"group-title":s.groupViewGroupTitle,"leader":this.model.get("leader_id")&&n.formatMemberName(this.model.get("leader_id")),"leader-title":s.groupViewLeaderTitle,"disabled":this.model.get("disabled"),"disabled-message":this.options.disabledMessage,"lightWeight":!!this.options.lightWeight}},"constructor":function(e){e||(e={}),e.disabledMessage||(e.disabledMessage=""),t.ItemView.prototype.constructor.call(this,e)}})}),csui.define("csui/controls/userpicker/userpicker.view",["csui/lib/underscore","csui/lib/jquery","csui/utils/contexts/factories/connector","csui/models/member","csui/models/members","csui/controls/typeaheadpicker/typeaheadpicker.view","csui/controls/userpicker/impl/user.view","csui/controls/userpicker/impl/group.view","csui-ext!csui/controls/userpicker/userpicker.view","css!csui/controls/userpicker/impl/userpicker"],function(e,i,t,n,a,s,l,r,o){return s.extend({"constructor":function(d){i.extend(!0,d||{},{"css":{"itemPicker":"csui-control-userpicker","noResults":"csui-user-picker-no-results"},"expandFields":["group_id","leader_id"]});var c;if(d.collection)c=d.collection.connector;else{if(!d.context)throw new Error("Context is missing in the constructor options");c=d.context.getObject(t),d.collection=new a(void 0,{"connector":c,"memberFilter":d.memberFilter,"expandFields":d.expandFields,"limit":d.limit,"comparator":function(e){return e.get("name_formatted").toLowerCase()}})}d.model||(d.model=new n(void 0,{"connector":c})),d.TypeaheadItemView=function(e){return 0===e.get("type")?l:o?o[0]:r},d.onRetrieveItems=function(i,t){return i.query=t,i.fetch().then(function(){if("function"==typeof d.onRetrieveMembers&&d.onRetrieveMembers({"collection":i}),d.widgetoptions&&d.widgetoptions.collection&&d.widgetoptions.collection.extraMemberModels&&d.widgetoptions.collection.extraMemberModels.length){var n=e.filter(d.widgetoptions.collection.extraMemberModels,function(e){return-1!==d.collection.comparator(e).indexOf(t.toLowerCase())});i.add(n)}return i.models})},s.prototype.constructor.call(this,d),this.listenTo(this,"typeahead:picker:open",function(){this.trigger("userpicker:open")}),this.listenTo(this,"typeahead:picker:close",function(){this.trigger("userpicker:close")})}})}),csui.define("css!csui/controls/form/impl/fields/userfield/userfield",[],function(){}),csui.define("csui/controls/form/fields/userfield.view",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/controls/form/fields/base/csformfield.view","csui/controls/form/fields/typeaheadfield.view.mixin","csui/controls/userpicker/userpicker.view","i18n!csui/controls/form/impl/nls/lang","css!csui/controls/form/impl/fields/userfield/userfield"],function(e,i,t,n,a,s,l,r){var o=a.extend({"constructor":function(e){t.extend(!0,e||{},{"css":{"root":"cs-formfield cs-userfield","itemName":"esoc-user-container cs-user-container-no-hover csui-hovering esoc-user-mini-profile","customImage":"user-photo binf-img-circle","defaultIcon":"user-default-image csui-icon image_user_placeholder csui-initials"},"lang":{"fieldReadOnlyAria":r.userFieldReadOnlyAria,"emptyFieldReadOnlyAria":r.emptyUserFieldReadOnlyAria,"noItem":r.noOwner},"noId":-3}),e.createItemWidgetView=this.createUserWidgetView,e.TypeaheadPickerView=l,a.apply(this,arguments),this.makeTypeaheadFieldView(this.options)}});s.mixin(o.prototype);var d=i.extend({},o.prototype);i.extend(o.prototype,{"onRender":function(){var e=this.model.get("data");this.onlyUsers="otcs_user_picker"===this.model.get("schema").type;var n=this.onlyUsers?[0]:[0,1];if(this.options.alpaca){var a=this.options.alpaca.options.type_control;i.has(a,e.id)?a=this.options.alpaca.options.type_control[e.id]:i.has(a,"?")&&(a=this.options.alpaca.options.type_control["?"]),a&&i.has(a,"parameters")&&(n=a.parameters.select_types)}t.extend(!0,this.options,{"lang":{"alpacaPlaceholder":this.onlyUsers?r.alpacaPlaceholderOTUserPicker:r.alpacaPlaceholderOTUserGroupPicker},"pickerOptions":{"memberFilter":{"type":n}}}),this.isGroup=1===e.type,this.ui.itemName.attr("title",this.isGroup?this.ui.itemName.text().trim():null),this._isUserWidgetEnabled=!1,d.onRender.apply(this,arguments)},"_setCustomImage":function(){this.isGroup||d._setCustomImage.apply(this,arguments)},"removeUnderline":function(e){this.isGroup||-3===this.data.id||(this.ui.customImage.removeClass("cs-user-photo-hover"),this.ui.defaultIcon.removeClass("cs-user-photo-hover"),this.ui.itemName.removeClass("cs-user-container-hover").addClass("cs-user-container-no-hover"))},"showItemProfileDialog":function(){this.isGroup||-3===this.data.id||d.showItemProfileDialog.apply(this,arguments)},"showItemProfileDialogWidget":function(e){this.ui.customImage.addClass("cs-user-photo-hover"),this.ui.defaultIcon.addClass("cs-user-photo-hover"),this.ui.itemName.removeClass("cs-user-container-no-hover").addClass("cs-user-container-hover"),t(".esoc-mini-profile-popover").binf_popover("hide"),this.getItemWidget().showUserProfileDialog(e)},"showItemInfoPopup":function(){this.isGroup||-3===this.data.id||d.showItemInfoPopup.apply(this,arguments)},"showItemInfoPopupWidget":function(e){this.ui.customImage.addClass("cs-user-photo-hover"),this.ui.defaultIcon.addClass("cs-user-photo-hover"),this.ui.itemName.removeClass("cs-user-container-no-hover").addClass("cs-user-container-hover"),this.getItemWidget().showMiniProfilePopup(e)},"createUserWidgetView":function(e){csui.require(["esoc/controls/userwidget/userwidget.view"],i.bind(function(i){var t=new i({"userid":this.data.id,"context":this.options.context,"baseElement":this.ui.membername,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":this.data.id,"connector":this.connector});e(t)},this))},"_setDefaultIcon":function(){this.ui.customImage.addClass("esoc-userprofile-img-"+this.data.id),this.ui.defaultIcon.addClass("esoc-user-default-avatar-"+this.data.id),this.isGroup?this._renderDefaultIcon("user-default-image csui-icon image_group_placeholder"):this._renderDefaultIcon("user-default-image csui-icon image_user_placeholder csui-initials")}});var c=i.extend({},o.prototype),u={"showUserProfileDialog":"showItemProfileDialog","showMiniProfilePopup":"showItemInfoPopup"},h=i.invert(u);return i.extend(o.prototype,{"setUserWidget":function(e,i){u[e]&&c.createItemWidget.call(this,u[e],i)},"createItemWidget":function(e,i){h[e]&&this.setUserWidget(h[e],i)},"setItemWidget":function(e){this.userWidgetView=e},"getItemWidget":function(){return this.userWidgetView},"setItemPicked":function(e){this.userPicked=e},"getItemPicked":function(){return this.userPicked},"className":"cs-formfield cs-userfield","_setDefaultProfilePicture":function(){return c._setDefaultIcon.apply(this,arguments)},"_setDefaultIcon":function(){return this._setDefaultProfilePicture.apply(this,arguments)},"_resolvePhoto":function(){return c._resolveImage.apply(this,arguments)},"_resolveImage":function(){return this._resolvePhoto.apply(this,arguments)},"onUserPickerOpen":function(){return c.onItemPickerOpen.apply(this,arguments)},"onItemPickerOpen":function(){return this.onUserPickerOpen.apply(this,arguments)},"onUserPickerClose":function(){return c.onItemPickerClose.apply(this,arguments)},"onItemPickerClose":function(){return this.onUserPickerClose.apply(this,arguments)},"showUserProfileDialog":function(){return c.showItemProfileDialog.apply(this,arguments)},"showItemProfileDialog":function(){return this.showUserProfileDialog.apply(this,arguments)},"showMiniProfilePopup":function(){return c.showItemInfoPopup.apply(this,arguments)},"showItemInfoPopup":function(){return this.showMiniProfilePopup.apply(this,arguments)}}),o}),csui.define("csui/controls/form/fields/alpaca/alpuserfield",["csui/lib/underscore","csui/lib/jquery","csui/lib/alpaca/js/alpaca","csui/controls/form/fields/alpaca/alptypeaheadfield.mixin","csui/controls/form/fields/userfield.view","csui/utils/contexts/factories/member","csui/controls/form/pub.sub","i18n!csui/controls/form/impl/nls/lang"],function(e,i,t,n,a,s,l,r){var o=n.mixin({"constructor":function(e,t,n,l,o,d,c){n=i.extend(!0,n||{},{"alpacaFieldType":"otcs_user","alpacaFieldClasses":"csui-field-otcs_user","lang":{"invalidItem":r.invalidUser},"noId":-3}),n.ItemModelFactory=s,n.TypeaheadFieldView=a,this.onlyUsers="otcs_user_picker"===l.type,this.base(e,t,n,l,o,d,c),this.makeAlpTypeaheadField()}}),d=e.extend({},o);return o=e.extend(o,{"showField":function(e){var i=d.showField.apply(this,arguments);return l.trigger(this.propertyId+"tkl:asyncBuildRelation",this.fieldView),i}}),t.Fields.CsuiUserField=t.Fields.TextField.extend(o),t.registerFieldClass("otcs_user",t.Fields.CsuiUserField),i.alpaca.Fields.CsuiUserField}),csui.define("csui/controls/form/colout/colout.form.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/form/form.view"],function(e,i,t,n,a){return a.extend({"constructor":function(e){this.options=e||{},a.prototype.constructor.call(this,e),this.options=e},"onRenderForm":function(){this.options.orginatingView.triggerMethod("render:form",this.options.originatingView)}})}),csui.define("hbs!csui/controls/form/colout/colout.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var n=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,n){return'<div class="csui-colout-formitems"></div>'}});return t.registerPartial("csui_controls_form_colout_colout.item",n),n}),csui.define("csui/controls/form/colout/colout.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/base","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/form/colout/colout.form.view","hbs!csui/controls/form/colout/colout.item","i18n"],function(e,i,t,n,a,s,l,r){return t.LayoutView.extend({"className":"csui-colout-container","regions":{"formRegion":".csui-colout-formitems"},"template":l,"behaviors":{"PerfectScrolling":{"behaviorClass":a,"suppressScrollX":!0,"scrollYMarginOffset":1}},"constructor":function(n){n||(n={}),t.LayoutView.prototype.constructor.call(this),this.options=n,this.options.get("targetEl").one("shown.binf.popover",i.bind(this.onShowColoutPopoverForm,this)),this.windowResizeHandler=i.bind(this._adjustColout,this),e(window).on("resize",this.windowResizeHandler),this.render()},"onRender":function(){var i,t=this.options.attributes.options.fields;for(var a in t)t[a].hasOwnProperty("prevData")&&delete t[a].prevChildData;if(n.isTouchBrowser()){var l=e(".binf-tab-content").length>0?e(".binf-tab-content").innerHeight():e(".form-metadata").innerHeight();this.$el.css({"max-height":l-100})}i=new s({"context":this.options.get("context"),"model":this.options,"layoutMode":"doubleCol","mode":"read","orginatingView":this}),this.formRegion.show(i)},"onRenderForm":function(){var e=this.options.get("targetEl");e.binf_popover({"content":this.el,"html":!0,"placement":function(e,i){var t=this,n=r&&r.settings.rtl?"left":"right";return setTimeout(function(){t.$arrow.css("top",50),t.$tip.css("top",-45)},0),n},"trigger":"manual","container":this.options.get("coloutContainer")}),e.binf_popover("show")},"onShowColoutPopoverForm":function(i){var a,s=this.options.get("targetEl"),l=this.$el.closest(".binf-popover"),o=l.find(".binf-arrow"),d=parseInt(o.css("top")),c=parseInt(o.css("height")),u=0===o.outerWidth()?28:o.outerWidth(),h=this.$el.parents(".cs-form-set-container"),p=h.closest(".ps-container").length>0?h.closest(".ps-container"):h.closest(".csui-normal-scrolling"),f=0;1===s.parents(".binf-modal-dialog").length&&(f=s.parents(".binf-modal-dialog").offset().left),a=n.isIE11()?s.offset().top-45:s.offset().top-parseInt(o.css("top"))-parseInt(o.css("top"));var m=l.find(".cs-form-doublecolumn"),g=m.length;m.parent(".cs-form").removeClass("cs-doublecolumn-form");for(var v=0;v<g;v++)e(m[v]).is(":empty")?e(m[v]).css("display","none"):(e(m[v]).css("display","table-cell"),o.css("display","block"),m.closest(".cs-form").addClass("cs-doublecolumn-form"));l.css({"position":"fixed","top":a}),n.isTouchBrowser()&&p.css({"-webkit-overflow-scrolling":"auto"}),r&&r.settings.rtl?l.css({"left":"auto","right":e(window).width()-(s.offset().left-u/2)-f}):l.css({"right":"auto","left":s.offset().left+s.width()-f}),this._adjustColout();var b=e(window).height(),y=l.innerHeight()-parseInt(o.css("top")),w=s.offset().top,F=w+y+c-b;b<w+y&&(a-=F,d+=F,l.css("top",a),o.css("top",d)),t.triggerMethodOn(this,"dom:refresh",this),s.trigger("focus")},"_adjustColout":function(){var i=this.$el.parents(".cs-form-set-container"),t=e(window).height(),n=e("nav.csui-navbar").innerHeight()/2,a=e("nav.csui-navbar").css("z-index"),s=e("#breadcrumb-wrap").css("z-index");this.$el.height()>t&&this.$el.height(t-n),e("nav.csui-navbar, #breadcrumb-wrap").css({"z-index":"auto"});var l=i.closest(".ps-container").length>0?i.closest(".ps-container"):i.closest(".csui-normal-scrolling");return e(l).on("scroll",function(){e(".csui-colout-icon").each(function(){e(this).data("binf.popover")&&(e(this).binf_popover("destroy"),e("nav.csui-navbar").css({"z-index":a}),e("#breadcrumb-wrap").css({"z-index":s}))})}),!1},"onDestroy":function(){this.windowResizeHandler&&e(window).off("resize",this.windowResizeHandler)}})}),csui.define("csui/utils/usersettings/impl/usersettings.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin"],function(e,i,t,n,a,s){"use strict";var l=t.Model.extend({"constructor":function(e){t.Model.prototype.constructor.apply(this,arguments),this.set({"id":e.userid},{"silent":!0}),this.makeConnectable(e),this.makeUploadable(e)},"validate":function(){if(!0!==this.get("accessibleMode")&&!1!==this.get("accessibleMode")){var e="accessibleMode attribute is invalid";return console.log(e),e}},"url":function(){var e=n.combine(this.connector.getConnectionUrl().getApiBase("v2"),"members/preferences");return e=n.appendQuery(e,"metadata=true&config_name=SmartUI")},"parse":function(e,i){if(Array.isArray(e.results)){var t=e.results[0].data,n=!1;return t&&"SmartUI"===t.config_name&&(n=t.preferences.accessibleMode),{"accessibleMode":n}}var a=e.links.data.self;if("PUT"===a.method&&0===a.body.length)return{}},"prepare":function(e,i){return{"SmartUI":{"accessibleMode":e.accessibleMode}}}});return a.mixin(l.prototype),s.mixin(l.prototype),l}),csui.define("csui/utils/usersettings/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/usersettings/impl/nls/root/lang",{"accHeader":"Accessibility","accModeLabel":"Accessible compliant mode","accModeText":"When on, this mode will improve the usability with accessibility tools such as screen readers","settingsTabTitle":"Settings"}),csui.define("css!csui/utils/usersettings/impl/usersettingstab",[],function(){}),csui.define("csui/utils/usersettings/usersettings.tab.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/models/form","csui/models/forms","csui/controls/form/form.view","csui/utils/contexts/page/page.context","csui/utils/usersettings/impl/usersettings.model","i18n!csui/utils/usersettings/impl/nls/lang","css!csui/utils/usersettings/impl/usersettingstab"],function(e,i,t,n,a,s,l,r,o,d){"use strict";return n.ItemView.extend({"constructor":function(e){this.model=new o(e),n.ItemView.prototype.constructor.apply(this),this.accessibleModeChanged=!1},"tagName":"div","template":!1,"getRawFormsData":function(e){return{"forms":[{"data":{"accessibleMode":e},"options":{"fields":{"accessibleMode":{"hidden":!1,"label":d.accModeLabel,"type":"checkbox","helper":d.accModeText}}},"schema":{"properties":{"accessibleMode":{"readonly":!1,"required":!1,"type":"boolean"}},"title":d.accHeader,"type":"object"}}]}},"onRender":function(){this.model.fetch({"prepare":!1,"async":!1});var i=this.model.get("accessibleMode"),t=new s;t.reset(t.parse(this.getRawFormsData(i)));var o=new a(t.models[0].attributes.forms[0]),d=new n.Region({"el":this.el}),c=new l({"context":new r,"model":o,"mode":"create"});c.on("change:field",function(i){this.model.set("accessibleMode",i.value),this.model.save(),this.accessibleModeChanged=!this.accessibleModeChanged;var t=this.$el.parents("div.esoc-simple-user-widget-view")[0];e(t).toggleClass("csui-dialog-page-reload",this.accessibleModeChanged)},this),d.show(c)}})}),csui.define("csui/utils/usersettings/usersettings",["csui/utils/usersettings/usersettings.tab.view","i18n!csui/utils/usersettings/impl/nls/lang"],function(e,i){"use strict";return[{"tabName":"usersettings","tabDisplayName":i.settingsTabTitle,"tabContentView":e,"showTab":function(e,i){return!0===i.enableSimpleSettingsModel&&void 0!==i.showUserSettings&&!0===i.showUserSettings}}]}),csui.define("bundles/csui-forms",["csui/controls/form/form.view","csui/controls/form/fields/alpaca/alpuserfield","csui/controls/form/fields/alpaca/alpcsuibooleanfield","csui/controls/form/fields/alpaca/alpcsuiselectfield","csui/controls/form/fields/alpaca/alpcsuidateonlyfield","csui/controls/form/fields/alpaca/alpcsuidatetimefield","csui/controls/form/fields/alpaca/alpcsuitextfield","csui/controls/form/fields/alpaca/alpcsuimultilingual.textfield","csui/controls/form/fields/alpaca/alpcsuitextareafield","csui/controls/form/fields/alpaca/alpcsuiintegerfield","csui/controls/form/fields/alpaca/alpcsuiurlfield","csui/controls/form/fields/alpaca/alpcsuiarrayfield","csui/controls/form/fields/alpaca/alpcsuiobjectfield","csui/controls/form/fields/alpaca/alpnodepickerfield","csui/controls/form/fields/alpaca/alpcsuiarraybuttonsfield","csui/controls/form/fields/alpaca/alpcsuipasswordfield","csui/controls/form/fields/alpaca/alpcsuitklfield","csui/controls/form/fields/alpaca/alpcsuipickerfield.mixin","csui/controls/form/fields/alpaca/alptypeaheadfield.mixin","csui/controls/form/fields/typeaheadfield.view","csui/controls/form/fields/typeaheadfield.view.mixin","csui/controls/form/fields/userfield.view","csui/controls/form/fields/booleanfield.view","csui/controls/form/fields/datefield.view","csui/controls/form/fields/datetimefield.view","csui/controls/form/fields/selectfield.view","csui/controls/form/fields/textfield.view","csui/controls/form/fields/multilingual.textfield.view","csui/controls/form/fields/textareafield.view","csui/controls/form/fields/nodepickerfield.view","csui/controls/form/fields/arraybuttonsfield.view","csui/controls/form/colout/colout.view","csui/controls/form/fields/tklfield.view","csui/controls/userpicker/userpicker.view","csui/controls/userpicker/impl/user.view","csui/controls/typeaheadpicker/typeaheadpicker.view","csui/controls/typeaheadpicker/impl/typeaheaditem.view","csui/controls/form/fields/base/csformfield.view","csui/controls/form/fields/base/csformfield.editable.behavior","csui/controls/form/fields/base/csformfield.states.behavior","csui/controls/form/fields/base/csformarrayfield.editable.behavior","csui/controls/form/fields/base/csformarrayfield.states.behavior","csui/utils/usersettings/usersettings.tab.view","csui/utils/usersettings/usersettings","csui/utils/usersettings/impl/usersettings.model","csui/lib/alpaca/js/alpaca","i18n!csui/controls/form/impl/nls/lang","csui/controls/form/impl/fields/csformfield.view","hbs!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield","css!csui/controls/form/impl/fields/typeaheadfield/typeaheadfield","css!csui/controls/form/impl/fields/userfield/userfield"],{}),csui.require(["require","css"],function(e,i){i.styleLoad(e,"csui/bundles/csui-forms",!0)});
//# sourceMappingURL=csui-forms.js.map