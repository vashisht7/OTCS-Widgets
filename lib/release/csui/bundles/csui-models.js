csui.define("csui/utils/log/console.re.appender",["csui/lib/log4javascript"],function(e){"use strict";function t(){}return t.prototype=Object.create(e.Appender.prototype),t.prototype.layout=new e.NullLayout,t.prototype.threshold=e.Level.DEBUG,t.prototype.append=function(t){var i=e.Level,n=this;if(window.console&&window.console.re&&window.console.re.log){var s=function(){var e=n.getLayout(),i=e.format(t);return e.ignoresThrowable()&&t.exception&&(i+=t.getThrowableStrRep()),i}();window.console.re.debug&&i.DEBUG.isGreaterOrEqual(t.level)?window.console.re.debug(s):window.console.re.info&&i.INFO.equals(t.level)?window.console.re.info(s):window.console.re.warn&&i.WARN.equals(t.level)?window.console.re.warn(s):window.console.re.error&&t.level.isGreaterOrEqual(i.ERROR)?window.console.re.error(s):window.console.re.log(s)}},t.prototype.group=function(e){window.console&&window.console.re&&window.console.re.group&&window.console.re.group(e)},t.prototype.groupEnd=function(){window.console&&window.console.re&&window.console.re.groupEnd&&window.console.re.groupEnd()},t.prototype.toString=function(){return"ConsoleReAppender"},t}),csui.define("csui/utils/log",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/log4javascript","csui/utils/log/console.re.appender","csui/lib/underscore.string"],function(e,t,i,n,s){"use strict";function o(e){if(!(this instanceof o))return new o(e);this._target=e,i.find(d.modules,function(t,i){r(i,e)&&(t.level&&(this._threshold=c(t.level)),void 0!==t.timing&&(this.timing=t.timing))},this)}function r(e,t){return"**"===e?e=".*":"*"===e?e="[^/]*":(e=e.replace(/^\*(?!\*)/g,"#"),e=e.replace(/([^*])\*$/g,"$1#"),e=e.replace(/\/\*(?!\*)/g,"/#"),e=e.replace(/([^*])\*\//g,"$1#/"),e=e.replace(/\/\*\*/g,"(?:/.*)?"),e=e.replace(/\*\*\//g,"(?:.*/)?"),e=e.replace(/#/g,"[^/]*")),e="^"+e+"$",new RegExp(e).test(t)}function c(e){var t=f[(e||"WARN").toUpperCase()];if(!t)throw new Error('invalid log level: "'+e+'".');return t}function a(e){return void 0!==e?(e="string"==typeof e?i.str.sformat.apply(this,arguments):null!==e?e.toString():"null",d.performanceTimeStamp&&(e=u()+e),d.moduleNameStamp&&this._target&&(e+=" ("+this._target+")")):e="",e}function u(){return"["+(window.performance.now()/1e3%10).toFixed(3)+"] "}function l(e){return this._target&&(e=i.str.sformat("[{0}] {1}",this._target,e)),e}var d=e.config();i.defaults(d,{"console":!0,"consoleRe":!1,"level":"WARN","timing":!1,"page":!1,"performanceTimeStamp":!1,"moduleNameStamp":!1,"server":!1,"window":!1,"modules":{}});var m="undefined"!=typeof console&&d.console,h=d.window||d.page||d.server||d.consoleRe,p=m||h,f={"ERROR":4,"WARN":3,"INFO":2,"DEBUG":1,"ALL":1},g=c(d.level);n.setDocumentReady();var v,b=n.getLogger();if(h&&(b=n.getLogger(),d.window&&(v=new n.PopUpAppender,v.setNewestMessageAtTop(!1),v.setScrollToLatestMessage(!0),v.setLayout(new n.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m{1}")),b.addAppender(v)),d.page&&(v=new n.InPageAppender(d.placeholder),v.setNewestMessageAtTop(!1),v.setScrollToLatestMessage(!0),v.setShowHideButton(!0),v.setShowCommandLine(!0),v.setLayout(new n.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m{1}")),b.addAppender(v)),d.consoleRe&&(v=new s,v.setLayout(new n.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m{1}")),b.addAppender(v)),d.server)){v=new n.AjaxAppender(d.server.url),v.setLayout(new n.JsonLayout),v.setTimed(!0),v.setTimerInterval(500),v.setSendAllOnTimer(!0),v.setBatchSize(10),v.setWaitForResponse(!1),v.setSendAllOnUnload(!0);var y=i.extend({"content-type":"application/json"},d.server.headers);i.each(i.keys(y),function(e){v.addHeader(e,y[e])}),b.addAppender(v)}b.setLevel(n.Level.DEBUG);var x={"_threshold":g,"config":d,"enabled":p,"last":void 0,"can":function(e){return this._threshold<=c(e)},"debug":function(){if(p&&this._threshold===f.DEBUG){var e=a.apply(this,arguments);if(h&&b.debug(e),m)return this.last="DBG  "+e,!0}return!1},"info":function(){if(p&&this._threshold<=f.INFO){var e=a.apply(this,arguments);if(h&&b.info(e),m)return this.last="INF  "+e,!0}return!1},"warn":function(){if(p&&this._threshold<=f.WARN){var e=a.apply(this,arguments);if(h&&b.warn(e),m)return this.last="WRN  "+e,!0}return!1},"error":function(){if(p){var e=a.apply(this,arguments);if(h&&b.error(e),m)return this.last="ERR  "+e,!0}return!1},"time":function(e){this.timing&&console.time(l.call(this,e))},"timeEnd":function(e){this.timing&&console.timeEnd(l.call(this,e))},"getObjectName":function(e){return null!=e?Object.getPrototypeOf(e).constructor.name:void 0===e?"undefined":null===e?"null":""},"getStackTrace":function(e){var t;try{throw new Error}catch(e){t=e.stack}if(t){var i=t.split("\n");i&&i.length>0&&(i[0].match(/\.js/)||(i=i.slice(1)),t=i.slice(0===e?0:e||1).join("\n"))}else t="at unknown place (no stack trace available)";return t}};return i.extend(o,x),i.extend(o.prototype,x),o}),csui.define("csui/utils/url",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";function i(e){this.raw=e}return i.prototype={"raw":void 0,"isValid":function(){return!!this.raw&&this.raw.match(i.re_weburl)},"isAbsolute":function(){return!!this.raw&&this.raw.match(/^.*\/\//)},"getAbsolute":function(){if(this.isAbsolute())return this.raw;var e=location.origin||new i(location.href).getOrigin();return i.combine(e,this.raw)},"getProtocol":function(){var e=this.isAbsolute()&&0!==this.raw.indexOf("//")?this.raw:window.location.href;return e.toLowerCase().substring(0,e.indexOf(":"))},"getHost":function(){var e=this.getAbsolute().match(/^.*\/\/([^:\/]+)/);return e&&e[1]},"getPort":function(){var e=this.getAbsolute().toLowerCase(),t=e.match(/^.*\/\/([^\/]+)/),i=t&&t[1].match(/:([^\/]+)/);return i?parseInt(i[1],10):0===e.indexOf("https")?443:80},"getOrigin":function(){var e=this.getAbsolute().match(/^.*\/\/[^\/]+/);return e&&e[0]},"getPath":function(){var e=this.getAbsolute().match(/^.*\/\/[^\/]+(\/[^?]+)/);return e&&e[1]},"getVirtualDirectory":function(){var e=this.getAbsolute().match(/^.*\/\/[^\/]+\/[^\/]+/);return e&&e[0]},"getCgiScript":function(){var e=this.getAbsolute(),t=e.length-7;if("/"===e.charAt(this.raw.length-1)&&--t,e.lastIndexOf("/api/v1")===t)return e.substr(0,t);var i=e.match(/^.*\/\/[^\/]+\/[^\/]+\/[^\/]+/);return i&&i[0]},"getQuery":function(){var e=this.getAbsolute().match(/\?(.+)/);return e&&e[1]},"getApiBase":function(e){return e||(e="v1"),"number"==typeof e&&(e="v"+e),this.getCgiScript()+"/api/"+e+"/"},"makeAbsoluteUrl":function(e,t){if(!e.match(/^\w+:\/\//)){var n=e.charAt(0);return"/"===n?"/"===e.charAt(1)?this.getProtocol()+":"+e:i.combine(this.getOrigin(),e):"?"===n?this.getCgiScript()+e:(t||(t=this.getCgiScript()),i.combine(t,e))}return e},"toString":function(){return this.raw}},i.version="1.0",i.combine=function(){for(var e="",t=0;t<arguments.length;++t){var i=arguments[t],n=void 0!==i&&null!==i?i.toString():"";"/"==n.charAt(0)?e+=e&&"/"==e.charAt(e.length-1)?n.substring(1):n:(t>0&&(!e||"/"!=e.charAt(e.length-1))&&n.length>0&&(e+="/"),e+=n)}return e},i.makeMultivalueParameter=function(t,i){return i&&i.length?(i=e.map(i,encodeURIComponent),t+"="+i.join("&"+t+"=")):""},i.combineQueryString=function(){var i,n,s={};for(i=0;i<arguments.length;++i)n=arguments[i],e.isObject(n)&&e.extend(s,n);for(s=t.param(s,!0),i=0;i<arguments.length;++i)n=arguments[i],e.isString(n)&&n&&(s&&(s+="&"),s+=n);return s},i.appendQuery=function(e,t){if(t){if(e.indexOf("?")>=0){var i=e[e.length-1];"?"!==i&&"&"!==i&&(e+="&")}else e+="?";e+=t}return e},i.urlParams=function(e){if(e){var i=e.indexOf("#"),n=e.indexOf("?");if(-1!==n)return t.parseParams(e.substring(n,-1===i?e.length:i))}return{}},i.mergeUrlParams=function(n,s,o){var r=i.urlParams(n),c=o.concat(e.keys(r)),a=e.omit(t.parseParams(s),c);return t.param(a)},i.re_weburl=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),i}),csui.define("csui/utils/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/impl/nls/root/lang",{"ColumnMemberName2":"{1} {0}","ColumnMemberName3":"{1} {2} {0}","sizeInBytes":"{0} bytes","ErrorUnknown":"Unknown error.","InvalidResponse":"Invalid response received.","ErrorStatiNice":["Confirm","Error","Warning","Hint","Information"],"ErrorHtmlTpl":"<span class='msgIcon <%= statusPlain %>Icon'><%= statusNice %>: <%= msg %></span><br>","ErrorStringTpl":"<%= statusNice %>: <%= msg %>;\n","AuthenticationFailureDialogTitle":"Authentication failure","SessionExpiredDialogTitle":"Session expired","AuthenticationFailureDialogText":"The page will be reloaded and you may need to sign in again.","NodeTypeSearchQuery":"Search","NodeTypeURL":"Web address","NodeTypeAudio":"Audio","NodeTypeCompressed":"Compressed File","NodeTypeImage":"Image","NodeTypeText":"Text Document","NodeTypeHtml":"Html Document","NodeTypeUnknown":"Unknown","NodeTypeVideo":"Video","NodeTypeDOC":"Microsoft Word","NodeTypePDF":"Portable Document Format","NodeTypePPT":"Microsoft Powerpoint","NodeTypePresentation":"Presentation","NodeTypeXLS":"Microsoft Excel","NodeTypeSpreadsheet":"Spreadsheet","NodeTypeFormula":"Formula","NodeTypePublisher":"Microsoft Publisher","NodeTypeVisio":"Microsoft Visio","NodeTypeMPP":"Microsoft Project","NodeTypeONE":"Microsoft OneNote","NoConnectivity":"No connectivity","NetworkError":"Network communication failed.","resourceConflict":"Due to an edit conflict, your changes could not be saved. Another user has changed the same object. Reload the page to reflect the latest changes.","Home":"Home","Loading":"Loading...","NotAvailalbe":"Not available."}),csui.define("csui/utils/errormessage",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/url","i18n!csui/utils/impl/nls/lang"],function(e,t,i,n,s,o,r){"use strict";var c={"Confirm":0,"Error":1,"Warning":2,"Hint":3,"Info":4},a=n.Model.extend({"constructor":function(e){n.Model.prototype.constructor.apply(this,arguments),e instanceof Error&&(this.attributes.message=e.message,this.attributes.name=e.name)},"defaults":{"type":c.Error,"name":"","message":r.ErrorUnknown},"getType":function(){return this.get("type")},"getName":function(){return this.get("name")},"getMessage":function(){return this.get("message")}}),u=a.extend({"constructor":function(e){a.Message.prototype.constructor.apply(this,arguments)},"defaults":{"type":c.Error,"message":r.ErrorUnknown}}),l=u.extend({"defaults":{"statusCode":void 0,"statusText":void 0,"errorDetails":void 0},"constructor":function(e){if(a.ErrorMessage.prototype.constructor.apply(this,arguments),e)if(null!=e.status){if(this.statusCode=e.status,this.statusText=e.statusText,e.responseText)try{e.responseJSON=JSON.parse(e.responseText)}catch(e){s.warn("Parsing error response failed: {0}.",e)&&console.warn(s.last)}if(e.responseJSON){var t=e.responseJSON;this.message=t&&t.error,this.message||(this.message=e.responseText),this.errorDetails=t&&t.errorDetail}this.message||(0===this.statusCode?this.message=r.NetworkError:this.message=r.InvalidResponse),e.settings&&e.settings.url&&(this.method=e.settings.type,this.url=e.settings.url)}else"object"==typeof e.error?(this.message=e.error,this.errorDetails=e.errorDetail):e instanceof n.Model?(this.message=e.message||e.get("error"),this.errorDetails=e.errorDetails||e.errorDetail||e.get("errorDetails")||e.get("errorDetail")):e instanceof Error?this.message=e.message:i.extend(this,e)}});return l.prototype.toString=function(){var e=/[.!?:;,]$/,t=/\s+$/,i="";return this.message&&(i=this.message,i.replace(t,""),i.match(e)||(i+=".")),this.errorDetails&&(i&&(i+="\r\n"),i+=this.errorDetails,i.replace(t,""),i.match(e)||(i+=".")),i||(this.statusText&&(i&&(i+="\r\n"),i+=this.statusText),this.statusCode>0&&(i&&(i+="\r\n "),i+="("+this.statusCode+")")),i||(i=r.ErrorUnknown),i},l.version="1.0",a={"verion":"1.0","Type":c,"Message":a,"ErrorMessage":u,"RequestErrorMessage":l}}),csui.define("csui/utils/messagehelper",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/errormessage","i18n!csui/utils/impl/nls/lang"],function(e,t,i,n,s,o,r){"use strict";s=s(e.id);var c="0.3s",a={"-webkit-transition":"top "+c,"transition":"top "+c},u={"-webkit-transition":"top "+c,"transition":"top "+c},l={"-webkit-transition":"","transition":""},d={"-webkit-transition":"opacity "+c,"transition":"opacity "+c},m=n.Collection.extend({"model":o.Message,"title":"","showMessages":function(e,t){s.warn("This method has been deprecated and will be removed in future. Please, use MoalAler or GlobalMessaage to report errors.")&&console.warn(s.last);var i=r.ErrorStatiNice[this.getStatus()],n=void 0===t||t;this.trigger("showErrors",this.groupBy("type"),this.toHtml(),i,n),e&&this.reset()},"addMessage":function(e,t,i){this.title=i||"",t=t||o.Type.Error;var n=new o.Message({"type":t,"message":e});return this.add([n])},"showErrors":function(e,t){return this.showMessages(e,t)},"addError":function(e){var t=new o.ErrorMessage;return t.message=e.message,this.add([t])},"addErrorMessage":function(e){return this.add([e])},"getStatus":function(){return this.sortBy("type")[0].get("type")},"clear":function(){return this.reset()},"hasMessages":function(){return this.length>0},"getMessages":function(){return this.groupBy("type")},"toHtml":function(){var e=i.template(r.ErrorHtmlTpl),t=[];return i.each(this.groupBy("type"),function(n){i.each(n.reverse(),function(n){t+=e({"statusPlain":i.keys(o.Type)[n.get("type")],"statusNice":r.ErrorStatiNice[n.get("type")],"msg":n.get("message")})})}),t},"removeField":function(e,t,i){var n=e.find(t);i.forEach(function(e){var i=t+"-"+e,s=n.find(i);s.hasClass("binf-hidden")||s.addClass("binf-hidden")})},"switchField":function(e,t,i,n){var s=e.find(t),o=t+"-"+i,r=s.find(o),c=!1;return r.hasClass("binf-hidden")&&(n.forEach(function(e){var i=t+"-"+e;if(o!=i){var n=s.find(i);n.hasClass("binf-hidden")||n.addClass("binf-hidden")}}),r.removeClass("binf-hidden"),c=!0),{"changed":c,"element":r}},"transitionEnd":i.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if(void 0!==i.style[e])return t[e]}),"createPanel":function(e,t,i,n){var s=new t(i);if(s.$el.removeClass("binf-panel binf-panel-default"),s.$el.addClass("csui-global-message"),e.classNames&&s.$el.addClass(e.classNames),s.render(),n){n.$el.hasClass("binf-hidden")!=s.$el.hasClass("binf-hidden")&&s.$el.toggleClass("binf-hidden");var o=n.$el.hasClass("csui-collapsed");o!=s.$el.hasClass("csui-collapsed")&&(o?s.doCollapse(!1):s.doExpand(!1))}return s},"activatePanel":function(e,t,i,n){return n||e.$el.hasClass("binf-hidden")?(t&&this.resizePanel(e,t),e.$el.appendTo(i.el),n&&n.destroy()):(e.$el.addClass("binf-hidden"),e.$el.appendTo(i.el),e.doShow(t,i)),e},"showPanel":function(e,t,n){if(e.$el.hasClass("binf-hidden")){var s=this,o=this.getTargetSizes(n.$el),r=i.extend({"csuiBeforeShow":function(){if(t){var i=s.getTargetSizes(t.$el);s.setPanelHeight(e,i)}}},e);this.slidedown(r,e.$el,e.$el,o)}},"slidedown":function(e,t,n,s){var o,r;n=n||t,e.$el===t||e.$el.removeClass("csui-collapsed"),e.$el.removeClass(e.$el===t?"csui-hiding":"csui-collapsing"),e.$el.addClass(e.$el===t?"csui-showing":"csui-expanding"),e.csuiBeforeShow&&e.csuiBeforeShow();var c=t.css("position");if(n.hasClass("binf-hidden")){t.css(l),t.addClass("position-hidden"),t!==n&&(r=t.height(),o=Math.min(s.height-s.top,r),t.css({"bottom":"calc(100% - "+(s.top+o)+"px)"})),n.removeClass("binf-hidden"),r=t.height();var u=this.getTargetSizes(t);"relative"===c?(o=Math.min(s.height-u.height,r),t.css({"top":o+"px"})):(o=Math.min(u.top,s.top+r),t.css({"top":o+"px"})),t.removeClass("position-hidden"),t.addClass("position-show");t.position()}return t.one(this.transitionEnd(),function(){(e.$el===t?"csui-showing":"csui-expanding")&&(t.css(l),e.$el.removeClass(e.$el===t?"csui-showing":"csui-expanding"),e.csuiAfterShow&&e.csuiAfterShow())}),"relative"===c?t.css(i.extend({"top":"0px"},a)):t.css(i.extend({"top":s.top+"px"},a)),e},"expandPanel":function(e,t,i,n){i=i||t,(e.$el.hasClass("csui-collapsed")||i.hasClass("binf-hidden")||e.$el.hasClass("csui-collapsing"))&&(n=!0===n||void 0===n,n?this.slidedown(e,t,i,this.getTargetSizes(t)):(e.$el.removeClass("csui-collapsed"),i.removeClass("binf-hidden")))},"hidePanel":function(e){e.$el.hasClass("binf-hidden")||this.slideup(e,e.$el,e.$el)},"slideup":function(e,t,n){n=n||t;var s=t.css("position");e.$el.removeClass(e.$el===t?"csui-showing":"csui-expanding"),e.$el.addClass(e.$el===t?"csui-hiding":"csui-collapsing"),e.csuiBeforeHide&&e.csuiBeforeHide(),t.one(this.transitionEnd(),function(){e.$el.hasClass(e.$el===t?"csui-hiding":"csui-collapsing")&&(n.addClass("binf-hidden"),t.css(i.extend({"top":"","bottom":""},l)),e.$el.removeClass(e.$el===t?"csui-hiding":"csui-collapsing"),e.$el===t||e.$el.addClass("csui-collapsed"),e.csuiAfterHide&&e.csuiAfterHide())});var o=this.getTargetSizes(t);"relative"===s?t.css({"top":"0px"}):t.css({"top":o.top+"px"});var r=(t.position(),0),c=t.attr("id");if(c&&t.hasClass("csui-minheight")){var a=t.find("."+c+"-heightsource");a.length>0&&(r=a.outerHeight())}return t.css(i.extend({"top":parseInt(r)-o.height+"px"},u)),t},"collapsePanel":function(e,t,i,n){i=i||e.$el,e.$el.hasClass("csui-collapsed")&&i.hasClass("binf-hidden")&&!e.$el.hasClass("csui-expanding")||(n=!0===n||void 0===n,n?this.slideup(e,t,i):(e.$el.addClass("csui-collapsed"),i.addClass("binf-hidden")))},"fadeoutPanel":function(e){var t=e.$el.css("opacity")||"1";e.$el.css({"opacity":t}),e.$el.one(this.transitionEnd(),function(){e.$el.addClass("binf-hidden"),e.$el.css(i.extend({"opacity":""},l)),e.csuiAfterHide&&e.csuiAfterHide()});e.$el.css("opacity");return e.$el.css(i.extend({"opacity":"0.0"},d)),e},"resizePanel":function(e,t){if(t){var i=this.getTargetSizes(t.$el);this.setPanelHeight(e,i)}e.doResize&&e.doResize()},"getTargetSizes":function(e){if(e){var t=e[0].getBoundingClientRect();return i.extend({"width":t.width,"height":t.height},e.position())}return{"left":0,"top":0,"width":333,"height":63}},"setPanelHeight":function(e,t){return e.$el.find(".csui-height-target").height(t.height),e}});return m.prototype.toString=function(){var e=i.template(r.ErrorStringTpl),t=[];i.each(this.groupBy("type"),function(n){i.each(n,function(n){t+=e({"statusPlain":i.keys(o.Type)[n.get("type")],"statusNice":r.ErrorStatiNice[n.get("type")],"msg":n.get("message")})})})},m.version="1.0",i.extend(m,n.Events),m}),csui.define("csui/utils/types/date",["module","csui/lib/underscore","csui/lib/moment","csui/lib/moment-timezone"],function(e,t,i){"use strict";function n(e){for(var t,s,o,r,c=/\w+/g,a=e,u=0;t=c.exec(e);)s=t[0],(o=i.localeData().longDateFormat(s))&&(r=t.index+u,a=a.substring(0,r)+o+a.substring(r+s.length),u+=o.length-s.length);return a!==e?n(a):a}function s(e){return e<10?"0"+e:e}function o(e){return e instanceof i?e:e instanceof Date?i(e):_.formatIsoDateTimeInTimeZone&&!function(e){var t=e.length;if(t>19){if("Z"===e.charAt(t-1))return!0;var i=e.charAt(t-5);if("+"===i||"-"===i)return!0}}(e)?i.tz(e,_.formatIsoDateTimeInTimeZone):i(e)}function r(e){return e&&o(e).toDate()}function c(e,t,n){function o(e,t){return e.year()+"-"+s(e.month()+1)+"-"+s(e.date())+"T"+s(e.hours())+":"+s(e.minutes())+":"+s(e.seconds())+t}t||(t=R);var r=i(e,t,!0);if(!r.isValid()){if(!n)throw new Error('Parsing date value "'+e+'" as "'+t+'" failed.');n()}return _.formatIsoDateTimeInUtc?o(r.utc(),"Z"):_.formatIsoDateTimeInTimeZone?o(r.tz(_.formatIsoDateTimeInTimeZone),""):o(r,"")}function a(e,t,n){t||(t=A);var o=i(e,t,!0);if(!o.isValid()){if(!n)throw new Error('Parsing date value "'+e+'" as "'+t+'" failed.');n()}return o.year()+"-"+s(o.month()+1)+"-"+s(o.date())}function u(e,t){return i(e,t||A,!0).isValid()}function l(e,t){return i(e,t||R,!0).isValid()}function d(e){return _.friendlyDate?g(e):h(e)}function m(e){return _.friendlyDateTime?v(e):f(e)}function h(e){return e?o(e).format(A):""}function p(e){return e?o(e).format(E):""}function f(e){return e?o(e).format(R):""}function g(e){return e?o(e).calendar():""}function v(e){return e?o(e).calendar():""}function b(e){return e?o(e).fromNow():""}function y(e){return e?i.utc(e).toISOString():""}function x(e){return e?i(e).toISOString():""}var _=window.csui.requirejs.s.contexts._.config.config["csui/utils/base"]||{};_=t.extend({"friendlyDateTime":!0,"friendlyTime":!0,"friendlyDate":!0,"formatIsoDateTimeInUtc":!1,"formatIsoDateTimeInTimeZone":void 0},_,e.config());var C=_.dateFormat||"L",w=_.timeFormat||"LTS",S=_.dateTimeFormat||C+" "+w,A=n(C),E=n(w),R=n(S);return{"exactDateFormat":A,"exactTimeFormat":E,"exactDateTimeFormat":R,"deserializeDate":r,"serializeDate":a,"serializeDateTime":c,"validateDate":u,"validateDateTime":l,"formatDate":d,"formatDateTime":m,"formatExactDate":h,"formatExactTime":p,"formatExactDateTime":f,"formatFriendlyDate":g,"formatFriendlyDateTime":v,"formatFriendlyDateTimeNow":b,"formatISODateTime":x,"formatISODate":y}}),csui.define("csui/utils/types/number",["module","csui/lib/underscore","csui/lib/numeral","i18n!csui/utils/impl/nls/lang"],function(e,t,i,n){"use strict";function s(e,t){return i(e).format(t)}function o(e){return s(e,"0,0")}function r(e){return u.friendlyFileSize?c(e):a(e)}function c(e){return t.isNumber(e)?e>=1024?i(e).format("0 b"):a(e):""}function a(e){return t.isNumber(e)?(e=o(e),t.str.sformat(n.sizeInBytes,e)):""}var u=window.csui.requirejs.s.contexts._.config.config["csui/utils/base"]||{};return u=t.extend({"friendlyFileSize":!0},u,e.config()),{"formatInteger":s,"formatIntegerWithCommas":o,"formatFileSize":r,"formatFriendlyFileSize":c,"formatExactFileSize":a,"MAX_SAFE_INTEGER":Number.MAX_SAFE_INTEGER||9007199254740991,"MIN_SAFE_INTEGER":Number.MIN_SAFE_INTEGER||-9007199254740991}}),csui.define("csui/utils/types/member",["csui/lib/underscore","csui/lib/backbone","i18n!csui/utils/impl/nls/lang"],function(e,t,i){"use strict";function n(n){if(!n)return"";if(e.isNumber(n)||e.isString(n))return n.toString();if(n instanceof t.Model&&(n=n.attributes),n.display_name)return n.display_name;if(n.name_formatted)return n.name_formatted;var s=n.first_name,o=n.last_name,r=n.middle_name;return(s?r?e.str.sformat(i.ColumnMemberName3,o,s,r):o?e.str.sformat(i.ColumnMemberName2,o,s):s:o)||n.name_formatted||n.name||n.id&&n.id.toString()||""}return{"formatMemberName":n}}),csui.define("csui/utils/types/localizable",["csui/lib/underscore","i18n"],function(e,t){"use strict";function i(t,i){return e.isObject(t)&&(t=e.reduce(t,function(e,t,i){return i=i.toLowerCase().replace("_","-"),e[i]=t,e},{}),t=t[u]||t[l]||t[d]||t[m]||i),null!=t&&t.toString()||""}function n(e,t,i){i||(i={});var n=i.usage||"search",s={"usage":n,"sensitivity":"search"===n?"base":"variant","numeric":"search"!==n};if(!e||!t)return e?-1:t?1:0;if(e.localeCompare)try{return e.localeCompare(t,u,s)}catch(e){}return e=e.toLowerCase(),t=t.toLowerCase(),e<t?-1:e>t?1:0}function s(e,t){return r(e,t)>=0}function o(e,t){var i,s=e.length,o=Math.min(s,3*t.length);for(i=1;i<=o;++i)if(0===n(e.substring(s-i),t))return!0}function r(e,t){var i,n=e.length-t.length+1;for(i=0;i<=n;++i)if(c(e.substring(i),t))return i;return-1}function c(e,t){var i,s=Math.min(e.length,3*t.length);for(i=1;i<=s;++i)if(0===n(e.substring(0,i),t))return!0}function a(t,i){var n,s=Array.prototype.slice.call(arguments,2);return n=t>4?i.formatForFive:t>1?i.formatForTwo:t>0?i.formatForOne:i.formatForNone||i.formatForFive,s.splice(0,0,t.toString()),s.splice(0,0,n),e.str.sformat.apply(e.str,s)}var u=t.settings.locale,l=u.replace(/[-_]\w+$/,""),d=t.settings.defaultLocale,m=d.replace(/[-_]\w+$/,"");return{"getClosestLocalizedString":i,"localeCompareString":n,"localeContainsString":s,"localeEndsWithString":o,"localeIndexOfString":r,"localeStartsWithString":c,"formatMessage":a}}),csui.define("csui/utils/base",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/errormessage","csui/utils/messagehelper","csui/utils/types/date","csui/utils/types/number","csui/utils/types/member","csui/utils/types/localizable","i18n"],function(e,t,i,n,s,o,r,c,a,u){"use strict";function l(e,t){var i=$.text(e).html();return t&&(i=i.replace(/\r?\n/g,"\r\n<br>")),i}function d(e){return e&&e.once}function m(i){return i&&(e.isString(i)||e.isElement(i)||i instanceof t)}function h(){return!!("ontouchstart"in window||navigator.maxTouchPoints||navigator.msMaxTouchPoints)}function p(){return!!("ontouchstart"in window)}function f(){if(navigator&&null!=navigator.userAgent){return null!=navigator.userAgent.match(/(iPhone |iPad)/i)}return!0}function g(){return navigator.platform.indexOf("Mac")>-1}function v(){return f()&&window.matchMedia("(orientation: landscape)").matches}function b(){return f()&&window.matchMedia("(orientation: portrait)").matches}function y(){if(navigator&&navigator.userAgent){return/Trident.*11/i.test(navigator.userAgent)}}function x(){if(navigator&&navigator.userAgent){return/Mozilla/.test(navigator.userAgent)}}function _(){if(navigator&&navigator.userAgent){return/Edge/.test(navigator.userAgent)}}function C(){if(navigator&&navigator.userAgent){return/Firefox/.test(navigator.userAgent)}}function w(){return y()||_()}function S(){var e=window.chrome,t=window.navigator,i=t.vendor,n=t.userAgent.indexOf("OPR")>-1,s=t.userAgent.indexOf("Edge")>-1,o=t.userAgent.match("CriOS"),r=!1;return(o||null!=e&&"Google Inc."===i&&!1===n&&!1===s)&&(r=!0),r}function A(){if(navigator&&navigator.userAgent){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function E(e,t){var i=0;return t>0&&(i=Math.floor(2*e/t)),i}function R(e){var i=e instanceof t?e:t(e);if(!i.is(":visible"))return!1;var n=i.offset(),s={"left":window.pageXOffset,"top":window.pageYOffset},o={"width":H.width(),"height":H.height()};return n.left>=s.left&&n.left-s.left<o.width&&n.top>=s.top&&n.top-s.top<o.height}function k(e){if(void 0===e)return!1;var i=e instanceof t?e[0]:e;if(!i||!i.getBoundingClientRect)return!1;var n=i.getBoundingClientRect();return n.left>=window.pageXOffset&&n.right-window.pageXOffset<H.width()}function T(e){if(void 0===e)return!1;var i=e instanceof t?e[0]:e;if(!i||!i.getBoundingClientRect)return!1;var n=i.getBoundingClientRect();return n.top>=window.pageYOffset&&n.bottom-window.pageYOffset<H.height()}function I(e,i,n,s){if(void 0===e)return!1;var o=e instanceof t?e[0]:e;if(!o||!o.getBoundingClientRect)return!1;for(var r=void 0!==n?n:100,c=void 0!==s?s:100,a=o.getBoundingClientRect(),u=[],l=i||5,d=0;null!=o.parentElement&&d<l;)u.push(o.parentElement.getBoundingClientRect()),o=o.parentElement,d++;return u.every(function(e){var t=Math.min(a.right,e.right)-Math.max(a.left,e.left),i=Math.min(a.bottom,e.bottom)-Math.max(a.top,e.top),n=t/a.width*100,s=i/a.height*100;return n+.01>r&&s+.01>c})}function O(e,i,n,s){if(void 0===e||void 0===i)return!1;var o=e instanceof t?e[0]:e;if(!o||!o.getBoundingClientRect)return!1;var r=i instanceof t?i[0]:i;if(!r||!r.getBoundingClientRect)return!1;var c=void 0!==n?n:100,a=void 0!==s?s:100,u=o.getBoundingClientRect(),l=r.getBoundingClientRect(),d=Math.min(u.right,l.right)-Math.max(u.left,l.left),m=Math.min(u.bottom,l.bottom)-Math.max(u.top,l.top),h=d/u.width*100,p=m/u.height*100;return h+.01>c&&p+.01>a}function N(e){var i=t(e),n=i.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",s=i.closest(n),o=s.siblings(".csui-tab-contents-header-wrapper");if(o[0]){var r=i.offset().top,c=s[0].getBoundingClientRect().top+o.height();if(!(r>c)){var a=s.scrollTop();s.scrollTop(a-(c-r))}}}function M(e){var t=e.data,i=t.inputElement,n=t.view,s=t.dropdownContainer,o=t.callback;i.parents(".csui-normal-scrolling").css("overflow","auto"),s.length>0&&s[0]!==e.target&&s.is(":visible")&&o&&o(n)}function q(e,t,i,n,s,o){var r,c={"inputElement":e,"view":n,"dropdownContainer":t,"callback":s},a=this.isIE11(),l=this.isTouchBrowser();this.isHybrid();if(l&&!e.closest(".csui-scrollable-writemode").hasClass("csui-dropdown-open")&&e.closest(".csui-scrollable-writemode").addClass("csui-dropdown-open"),e.parents(".csui-scrollablecols").length>0&&e.parents(".cs-form-set-container").length>0){r=e.parents(".csui-scrollablecols").parents(".cs-form-set-container").find(".ps-container.ps-active-x");var d,m,h=u&&u.settings.rtl,p=e.offset().left,f=e.parents(".csui-scrollablecols").siblings(".csui-lockedcols").find(".csui-shadowleft-container"),g=f.offset().left;if(h){m=p+e.outerWidth()-g}else{m=g+f.outerWidth()-p}if(m>0){if(r.off("scroll",M),r.one("set:scrolled",function(){r&&r.on("scroll",c,M),P(e,t,i,o,a),F(e,t,n,s)}),h)d=r.scrollLeftRtl(),r.scrollLeftRtl(d+m);else{d=r.scrollLeft(),r.scrollLeft(d-m);var v=this;setTimeout(function(){v.isTouchBrowser&&!e.closest(".csui-scrollable-writemode").hasClass(".csui-dropdown-open")&&e.closest(".csui-scrollable-writemode").addClass("csui-dropdown-open")},100)}return}}r&&r.on("scroll",c,M),P(e,t,i,o,a),F(e,t,n,s)}function P(e,i,n,s,o){if(!e.is(":visible"))return!1;i.css({"left":0,"top":0});var r,c,a=!!e.closest(".cs-perspective-panel").length,l=u&&u.settings.rtl,d=e.offset().top,m=a?e.offset().left:e[0].getBoundingClientRect().left,h=e.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",p=e.closest(h),f=o?[]:p.length>0?p.parents(".binf-modal-content, .csui-sidepanel-container"):e.closest(".binf-modal-content, .csui-sidepanel-container"),g=f.length>0?l?f.outerWidth()+f.offset().left:f.offset().left:l?t(document).width():0,v=f.length>0?f.offset().top:0,b=e.outerHeight(),y=e.outerWidth(),x=t(".cs-perspective-panel"),_=e.closest(".cs-perspective-panel"),C=_.length>0?_:e.closest(".cs-perspective"),w=C.length>0?C.outerHeight():t(document).height(),S=C.length>0?C.offset().top:0,E=C.length>0?C.offset().left:0,R=e[0].getBoundingClientRect();n&&i.css({"width":y}),".csui-normal-scrolling"!=h&&e.parents(".csui-normal-scrolling").css("overflow","hidden");var k=x.length>0?x[0].getBoundingClientRect().top:0;k<0&&(k=x.offset().top);var T=S>0?S:k,I=R.top-T,O=window.innerHeight-(R.top+R.height),N=I>O;s&&(s.css({"max-height":Math.abs(.9*(N?I:O))+"px"}),N=s.outerHeight()>O),N?(r=o?C.length>0?w+S-R.top:document.documentElement.offsetHeight+document.documentElement.scrollTop-d:f.length>0?f.outerHeight()+v-d:C.length>0||A()?w+S-d:a?document.documentElement.offsetHeight-d:window.innerHeight-e[0].getBoundingClientRect().top,l?i.css({"position":"fixed","right":g-(m+y),"top":"auto","bottom":r,"left":"auto"}):i.css({"position":"fixed","left":m-g-E,"top":"auto","bottom":r}),i.hasClass("binf-datetimepicker-widget")&&i.addClass("binf-top").removeClass("binf-bottom")):(c=o?d+b-document.documentElement.scrollTop:f.length>0?d+b-v:C.length>0?d+b-S:R.top+R.height-S,l?i.css({"position":"fixed","right":g-(m+y),"top":c,"bottom":"auto","left":"auto"}):i.css({"position":"fixed","left":m-g-E,"top":c,"bottom":"auto"}),i.hasClass("binf-datetimepicker-widget")&&i.addClass("binf-bottom").removeClass("binf-top"))}function D(i){var n=i.targetEl,s=i.dropdownMenu||n.nextAll(".binf-dropdown-menu"),o=i.hAlignment||"left",r=i.vAlignment||"bottom",c=u&&u.settings.rtl;if(!n.length||!n.is(":visible")||!s.length)return!1;s.css({"maxHeight":"","maxWidth":"","top":"","left":"","right":"","bottom":""}),s.removeClass("binf-dropdown-align-left-top binf-dropdown-align-left-bottom binf-dropdown-align-right-top binf-dropdown-align-right-bottom");var a=s.outerHeight(),l=s.outerWidth();s.addClass("binf-hidden")
;var d=t(window).width(),m=t(window).height(),h=parseInt(s.css("maxWidth"),10)||224,p=n[0].getBoundingClientRect(),f=p.bottom,g=p.left,v=d-p.right,b=m-p.top,x=window.pageXOffset||document.documentElement.scrollLeft,_=window.pageYOffset||document.documentElement.scrollTop,C=p.top-10,w=m-p.bottom-10,S=p.right-10,A=d-p.left-10;if("bottom"===r&&w<=a?(C>a||C>w)&&(r="top"):"top"===r&&C<=a&&(w>a||w>C)&&(r="bottom"),o=c?"left"===o?"right":"left":o,"left"===o&&A<=l?(S>l||S>A)&&(o="right"):"right"===o&&S<=l&&(A>l||A>S)&&(o="left"),s.addClass("binf-dropdown-align-"+o+"-"+r),!y()){var E=n.closest(".cs-perspective-panel"),R=n.parents(".binf-modal-content"),k=E.length?E:n.closest(".cs-perspective");if(k=k.length?k:R,k.length>0){var T=k.offset(),I=n.offset();f+=_-T.top,g+=x-T.left,v=k.outerWidth()+T.left-I.left-n.outerWidth(),b=k.outerHeight()+T.top-I.top}}var O={"position":"fixed"};"left"===o?(O=e.extend(O,{"left":g}),A<h&&(O.maxWidth=A)):O=e.extend(O,{"right":v}),O="bottom"===r?e.extend(O,{"top":f}):e.extend(O,{"bottom":b}),s.css(O),s.removeClass("binf-hidden")}function F(e,i,n,s){var o=e.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",r=e.closest(o);r.on("scroll",n,function(t){e.parents(".csui-normal-scrolling").css("overflow","auto"),i.is(":visible")&&s&&s(n)}),t(window).on("scroll",function(){e.parents(".csui-normal-scrolling").css("overflow","auto"),i.is(":visible")&&s&&s(n)}),t(window).on("resize",function(){e.parents(".csui-normal-scrolling").css("overflow","auto"),i.is(":visible")&&s&&s(n)})}function j(e){return JSON.stringify(e)}function L(e,t){return"YYYY-MM-DD"===t||"MM/DD/YYYY"===t?o.serializeDate(e):o.serializeDateTime(e)}function U(e){return t(e).find("a[href], area[href], input, select, textarea, button, iframe, object, embed, *[tabindex], *[contenteditable]").filter(":visible:not([disabled])")}function B(e,i){function n(t){a!==i&&(s.appendChild(p(o.substr(c,t+1-c))),r<s.clientWidth?(m?(d=o.substr(c,t+1-c),c=t+1):(d=o.substr(c,u-c),c=u),l=h("span"),l.appendChild(p(d)),e.appendChild(l),m=!0,a++):m=!1,u=t+1,s.removeChild(s.firstChild))}var s,o,r,c,a,u,l,d,m,h=document.createElement.bind(document),p=document.createTextNode.bind(document);if(e="object"==typeof e&&e.length>0?e[0]:e,s=h("span"),t(s).css({"position":"absolute","whiteSpace":"pre","visibilty":"hidden"}),e.ownerDocument||e.ownerDocument===document){for(c=u=0,a=1,m=!1,r=e.clientWidth,o=(e.textContent||e.innerText).trim().replace(/\n/g," ");null!==e.firstChild;)e.removeChild(e.firstChild);e.appendChild(s),o.replace(/\W|\_/g,function(e,t){n(t)}),n(o.substr(c).length),e.removeChild(s),l=h("span"),t(l).css({"display":"inline-block","overflow":"hidden","whiteSpace":"nowrap","width":"100%"}),a>1&&t(l).css({"textOverflow":"ellipsis"}),l.appendChild(p(o.substr(c))),e.appendChild(l)}}function V(t,i){if(t&&i&&i.unSupportedWidgets){var n=e.chain(i.unSupportedWidgets).values().flatten()._wrapped;if(n&&n.length>0&&e.contains(n,t.type))return}return t}function z(e,t,i){var n,s=function(){clearTimeout(n),t.call(i||e)};n=setTimeout(s,2e3),e.one(G(),s)}function W(e){return e.is(":visible")?e.offset():{"top":0,"left":0}}var H=t(window),Q=new s;Q.on("showErrors",function(e,i,n,s){alert(t(i).text())});var $=t("<p></p>"),G=e.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if(void 0!==i.style[e])return t[e]});return{"MessageHelper":Q,"ErrorHandler":Q,"MessageType":n.Type,"Message":n.Message,"RequestErrorMessage":n.RequestErrorMessage,"ErrorStatus":n.Type,"ErrorToShow":n.Message,"ErrorMessage":n.ErrorMessage,"Error":n.RequestErrorMessage,"exactDateFormat":o.exactDateFormat,"exactTimeFormat":o.exactTimeFormat,"exactDateTimeFormat":o.exactDateTimeFormat,"parseDate":o.deserializeDate,"stringifyDate":j,"dateToLocalIsoString":L,"deserializeDate":o.deserializeDate,"serializeDate":o.serializeDate,"serializeDateTime":o.serializeDateTime,"formatDate":o.formatDate,"formatDateTime":o.formatDateTime,"formatExactDate":o.formatExactDate,"formatExactTime":o.formatExactTime,"formatExactDateTime":o.formatExactDateTime,"formatFriendlyDate":o.formatFriendlyDate,"formatFriendlyDateTime":o.formatFriendlyDateTime,"formatFriendlyDateTimeNow":o.formatFriendlyDateTimeNow,"formatISODateTime":o.formatISODateTime,"formatISODate":o.formatISODate,"getReadableFileSizeString":r.formatFileSize,"formatFileSize":r.formatFileSize,"formatFriendlyFileSize":r.formatFriendlyFileSize,"formatExactFileSize":r.formatExactFileSize,"formatInteger":r.formatInteger,"formatIntegerWithCommas":r.formatIntegerWithCommas,"formatMemberName":c.formatMemberName,"getClosestLocalizedString":a.getClosestLocalizedString,"localeCompareString":a.localeCompareString,"localeContainsString":a.localeContainsString,"localeEndsWithString":a.localeEndsWithString,"localeIndexOfString":a.localeIndexOfString,"localeStartsWithString":a.localeStartsWithString,"formatMessage":a.formatMessage,"escapeHtml":l,"isBackbone":d,"isPlaceholder":m,"Url":i,"isTouchBrowser":h,"isHybrid":p,"isAppleMobile":f,"isMacintosh":g,"isIE11":y,"isEdge":_,"isMozilla":x,"isFirefox":C,"isSafari":A,"isLandscape":v,"isPortrait":b,"isMSBrowser":w,"isChrome":S,"px2em":E,"isVisibleInWindowViewport":R,"isVisibleInWindowViewportHorizontally":k,"isVisibleInWindowViewportVertically":T,"isElementVisibleInParents":I,"isElementVisibleInParent":O,"checkAndScrollElemToViewport":N,"setScrollHandler":M,"adjustDropDownField":q,"autoAlignDropDowns":P,"hideDropDowns":F,"findFocusables":U,"applyEllipsis":B,"filterUnSupportedWidgets":V,"onTransitionEnd":z,"getOffset":W,"alignDropDownMenu":D}}),csui.define("csui/models/action",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base"],function(e,t,i,n,s,o,r){"use strict";var c;return s.Model.extend({"idAttribute":"signature","constructor":function(e,i){s.Model.prototype.constructor.apply(this,arguments),i&&i.connector&&i.connector.assignTo(this),c||(c=t("csui/models/actions"));var o=n.isArray(e&&e.children)&&e.children||[];this.children=new c(o)},"url":function(){return r.Url.combine(this.connector.connection.url,"actions",this.get("signature"))},"fetch":function(e){return o.debug("Fetching action with the ID {0}.",this.get("signature"))&&console.log(o.last),s.Model.prototype.fetch.call(this,e)},"parse":function(e){var t=e;if(this.children){var i=n.isArray(t.children)&&t.children||[];this.children.reset(i)}return t}})}),csui.define("csui/models/actions",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base","csui/models/action"],function(e,t,i,n,s,o,r){"use strict";var c=n.Collection.extend({"model":r,"constructor":function(e,t){n.Collection.prototype.constructor.apply(this,arguments),this.options=t||{}},"findRecursively":function(e){var t=this.get({"cid":e})||this.find(function(t){return t.get("signature")===e});return t||(t=i.find(this.map(function(t){return t.children.findRecursively(e)}),function(e){return e})),t}});return i.extend(c,{"version":"1.0"}),c}),csui.define("csui/models/mixins/rules.matching/rules.matching.mixin",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log"],function(e,t,i,n){"use strict";return n=n(e.id),{"mixin":function(e){return t.extend(e,{"makeRulesMatching":function(e){return this},"rulesToMatch":["equals","contains","startsWith","endsWith","matches","includes","equalsNoCase","containsNoCase","startsWithNoCase","endsWithNoCase","matchesNoCase","includesNoCase","has","decides","or","and","not"],"matchRules":function(e,i,n){var s=t.chain(this.rulesToMatch).map(function(t){var n=i[t];return void 0===n?void 0:this["_evaluate-"+t](e,n)},this).filter(function(e){return void 0!==e}).value();return!s.length||t[n||"any"](s,function(e){return!0===e})},"_getRulingPropertyValue":function(e,s){if("string"!=typeof s)return null==s&&(s="null"),n.warn("Invalid property name in the action rule specification: {0}",s)&&console.warn(n.last),null;var o=s.split("."),r=e instanceof i.Model?e.attributes:e||{};return t.find(o,function(e){if(null==(r=r[e]))return r=null,!0}),r},"_evaluate-or":function(e,i){return t.isArray(i)?t.any(i,function(t){return this.matchRules(e,t)},this):this.matchRules(e,i,"any")},"_evaluate-and":function(e,i){return t.isArray(i)?t.all(i,function(t){return this.matchRules(e,t)},this):this.matchRules(e,i,"all")},"_evaluate-not":function(e,t){return!this.matchRules(e,t)},"_evaluate-equals":function(e,t){return this._evaluateEquals(e,t,!1)},"_evaluate-equalsNoCase":function(e,t){return this._evaluateEquals(e,t,!0)},"_evaluateEquals":function(e,i,n){return t.any(i,function(i,s){var o=this._getRulingPropertyValue(e,s);if(t.isArray(i)||(i=[i]),n){var r=this._normalizeCase(o,i);o=r.actual,i=r.values}return t.any(i,function(e){return e==o})},this)},"_evaluate-contains":function(e,t){return this._evaluateContains(e,t,!1)},"_evaluate-containsNoCase":function(e,t){return this._evaluateContains(e,t,!0)},"_evaluateContains":function(e,i,n){return t.any(i,function(i,s){var o=this._getRulingPropertyValue(e,s)||"";if(o&&(o=o.toString())||(o=[]),t.isArray(i)||(i=[i]),n){var r=this._normalizeCase(o,i);o=r.actual,i=r.values}return t.any(i,function(e){return o.indexOf(e)>=0})},this)},"_evaluate-startsWith":function(e,t){return this._evaluateStartsWith(e,t,!1)},"_evaluate-startsWithNoCase":function(e,t){return this._evaluateStartsWith(e,t,!0)},"_evaluateStartsWith":function(e,i,n){return t.any(i,function(i,s){var o=this._getRulingPropertyValue(e,s)||"";if(o&&(o=o.toString())||(o=""),t.isArray(i)||(i=[i]),n){var r=this._normalizeCase(o,i);o=r.actual,i=r.values}return t.any(i,function(e){return 0===o.indexOf(e)})},this)},"_evaluate-endsWith":function(e,t){return this._evaluateEndsWith(e,t,!1)},"_evaluate-endsWithNoCase":function(e,t){return this._evaluateEndsWith(e,t,!0)},"_evaluateEndsWith":function(e,i,n){return t.any(i,function(i,s){var o=this._getRulingPropertyValue(e,s)||"";if(o&&(o=o.toString())||(o=""),t.isArray(i)||(i=[i]),n){var r=this._normalizeCase(o,i);o=r.actual,i=r.values}return t.any(i,function(e){return t.str.endsWith(o,e)})},this)},"_evaluate-matches":function(e,t){return this._evaluateMatches(e,t,!1)},"_evaluate-matchesNoCase":function(e,t){return this._evaluateMatches(e,t,!0)},"_evaluateMatches":function(e,i,n){return t.any(i,function(i,s){var o=this._getRulingPropertyValue(e,s)||"";if(o&&(o=o.toString())||(o=""),t.isArray(i)||(i=[i]),n){var r=this._normalizeCase(o,i);o=r.actual,i=r.values}return t.any(i,function(e){return"string"==typeof e&&(e=new RegExp(e)),e.test(o)})},this)},"_evaluate-includes":function(e,t){return this._evaluateIncludes(e,t,!1)},"_evaluate-includesNoCase":function(e,t){return this._evaluateIncludes(e,t,!0)},"_evaluateIncludes":function(e,i,n){return t.any(i,function(i,s){var o=this._getRulingPropertyValue(e,s)||[];if(t.isArray(o)||(o=t.isObject(o)?Object.keys(o):[o]),t.isArray(i)||(i=[i]),n){var r=this._normalizeCase(o,i);o=r.actual,i=r.values}return t.any(i,function(e){return t.contains(o,e)})},this)},"_evaluate-has":function(e,i){return t.isArray(i)||(i=[i]),t.any(i,function(t){return null!=this._getRulingPropertyValue(e,t)},this)},"_evaluate-decides":function(e,i){return t.isArray(i)||(i=[i]),t.any(i,function(t){return t(e)})},"_normalizeCase":function(e,i){return"string"==typeof e&&(e=e.toLowerCase()),i=t.map(i,function(e){return"string"==typeof e?e.toLowerCase():e}),{"actual":e,"values":i}}})}}}),csui.define("csui/models/actionitem",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin"],function(e,t,i){"use strict";var n=t.Model.extend({"idAttribute":null,"defaults":{"sequence":100,"signature":null},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(i)},"enabled":function(e){var t=this.get("type");return void 0!==t?t==e.get("type"):this.matchRules(e,this.attributes)}});return i.mixin(n.prototype),n}),csui.define("csui/models/actionitems",["csui/lib/underscore","csui/lib/backbone","csui/models/actionitem"],function(e,t,i){"use strict";return t.Collection.extend({"model":i,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)},"findByNode":function(e){return this.find(function(t){return t.enabled(e)})},"getAllSignatures":function(){return e.chain(this.pluck("signature")).unique().value()},"getAllCommandSignatures":function(t){return e.chain(this.getAllSignatures()).map(function(i){var n=t.get(i);if(n){if(i=n.get("command_key"),e.isArray(i)){var s=i[0];return"default"===s&&(s=["default","open",i[2]]),s}return i}}).flatten().compact().unique().value()},"getPromotedCommandsSignatures":function(){return e.chain(this.getAllSignatures()).flatten().compact().unique().value()}})}),csui.define("csui/models/addabletype",["module","csui/lib/backbone","csui/utils/log"],function(e,t,i){var n=t.Model.extend({"constructor":function(){t.Model.prototype.constructor.apply(this,arguments)},"parse":function(e){return e}});return n.version="1.0",n.Hidden=-1,n}),csui.define("csui/models/addabletypes",["module","csui/lib/backbone","csui/utils/log","csui/models/addabletype"],function(e,t,i,n){var s=t.Collection.extend({"model":n,"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments),this.options=i||{}}});return s.version="1.0",s}),csui.define("csui/models/mixins/connectable/connectable.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){var i=t._prepareModel;return e.extend(t,{"makeConnectable":function(e){return e&&e.connector&&e.connector.assignTo(this),this},"_prepareModel":function(e,t){return t||(t={}),t.connector||(t.connector=this.connector),i.call(this,e,t)}})}}}),csui.define("csui/models/ancestor",["module","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin"],function(e,t,i){var n=t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(i)},"idAttribute":null,"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return i.mixin(n.prototype),n}),csui.define("csui/models/ancestors",["module","csui/lib/backbone","csui/utils/log","csui/models/ancestor"],function(e,t,i,n){var s=t.Collection.extend({"model":n,"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments),this.options=i||{}}});return s.version="1.0",s}),csui.define("csui/models/mixins/expandable/expandable.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makeExpandable":function(e){var t=e&&e.expand;return"string"==typeof t&&(t=t.split(",")),this.expand=t||[],this},"setExpand":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.expand,t)||(this.expand instanceof Object&&this.expand.properties?this.expand.properties.push(t):this.expand.push(t))},this)},"resetExpand":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var i=e.indexOf(this.expand,t);i>=0&&this.expand.splice(i,1)},this)):this.expand.splice(0,this.expand.length)},"getExpandableResourcesUrlQuery":function(){return{"expand":this.expand}}})}}}),csui.define("csui/models/mixins/fetchable/fetchable.mixin",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/base"],function(e,t,i,n){"use strict";return{"mixin":function(s){var o=s.fetch;return e.extend(s,{"makeFetchable":function(e){return this.autoreset=e&&e.autoreset,this.on("reset",this._beforeFetchSucceeded,this).on("add",this._beforeFetchSucceeded,this).on("remove",this._beforeFetchSucceeded,this).on("change",this._beforeFetchSucceeded,this)},"_beforeFetchSucceeded":function(){this._fetchingOriginal&&this._fetchSucceeded()},"_fetchStarted":function(){this.fetched=!1,this.error=null},"_fetchSucceeded":function(){this._fetchingOriginal=this.fetching=!1,this.fetched=!0,this.error=void 0},"_fetchFailed":function(e){this._fetchingOriginal=this.fetching=!1,this.error=new n.Error(e)},"fetch":function(t){var i=this.fetching;if(!i){t=e.defaults(t||{},{"cache":!0,"urlBase":this.urlCacheBase?this.urlCacheBase():void 0}),this._fetchStarted(),t=this._prepareFetch(t);var n=this,s=t.success,r=t.error;t.success=function(){n._fetchSucceeded(),s&&s.apply(this,arguments)},t.error=function(e,t,i){n._fetchFailed(t),r&&r.apply(this,arguments)},this._fetchingOriginal=!0,i=o.call(this,t),this._fetchingOriginal&&(this.fetching=i)}return i},"_prepareFetch":function(e){return e||(e={}),void 0===e.reset&&this.autoreset&&(e.reset=!0),e},"ensureFetched":function(e){return this.fetched?(e&&e.success&&e.success(this),t.Deferred().resolve(this,{},e).promise()):this.fetch(e)},"invalidateFetch":function(){if(!this.fetching)return this.fetched=!1,this.error=null,!0},"prefetch":function(n,s){var o=t.Deferred();s=e.defaults(s,{"parse":!0}),s=this._prepareFetch(s);var r=s.silent;return this.error=null,this.fetched=!1,this.fetching=o.promise(),r||this.trigger("request",this,n,s),setTimeout(function(){if(this._fetchSucceeded(),this instanceof i.Model){var e=s.parse?this.parse(n,s):n;this.set(e,s)}else{this[s.reset?"reset":"set"](n,s)}s.success&&s.success.call(s.context,this,n,s),r||this.trigger("sync",this,n,s),o.resolve()}.bind(this)),this.fetching}})}}}),csui.define("csui/models/mixins/autofetchable/autofetchable.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeAutoFetchable":function(e){e&&e.autofetchEvent&&(this._autofetchEvent=e.autofetchEvent);var t=e&&e.autofetch;return t&&this.automateFetch(t),this},"automateFetch":function(t){var i=e.result(this,"_autofetchEvent"),n=t?"on":"off";this.autofetch=!!t,this[n](i,e.bind(this._fetchAutomatically,this,t))},"isFetchable":function(){return!!this.get("id")},"_autofetchEvent":"change:id","_fetchAutomatically":function(t){this.isFetchable()&&this.fetch(e.isObject(t)&&t)}})}}}),csui.define("csui/models/mixins/resource/resource.mixin",["csui/lib/underscore","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/autofetchable/autofetchable.mixin"],function(e,t,i,n){"use strict";return{"mixin":function(s){return t.mixin(s),i.mixin(s),n.mixin(s),e.extend(s,{"makeResource":function(e){return this.makeConnectable(e).makeFetchable(e).makeAutoFetchable(e)}})}}}),csui.define("csui/models/mixins/including.additional.resources/including.additional.resources.mixin",["csui/lib/underscore","csui/lib/jquery"],function(e,t){return{"mixin":function(t){return e.extend(t,{"makeIncludingAdditionalResources":function(e){return this._additionalResources=[],e&&e.includeResources&&this.includeResources(e.includeResources),this},"includeResources":function(t){e.isArray(t)||(t=t.split(",")),this._additionalResources=e.union(this._additionalResources,t)},"excludeResources":function(t){t?(e.isArray(t)||(t=t.split(",")),this._additionalResources=e.reject(this._additionalResources,t)):this._additionalResources.splice(0,this._additionalResources.length)},"getAdditionalResourcesUrlQuery":function(){return e.reduce(this._additionalResources,function(e,t){return e[t]="true",e},{})}})}}}),csui.define("csui/models/authenticated.user/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"url":function(){var e=new t(this.connector.connection.url).getApiBase("v1"),i=t.combine(e,"/auth"),n=t.combineQueryString(this.getExpandableResourcesUrlQuery(),this.getAdditionalResourcesUrlQuery());return n?i+"?"+n:i},"parse":function(e){var t=e.data||{};return t.perspective=e.perspective,t}})}}}),csui.define("csui/models/authenticated.user",["csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","csui/models/authenticated.user/server.adaptor.mixin"],function(e,t,i,n,s){"use strict";var o=e.Model.extend({"constructor":function(t,i){e.Model.prototype.constructor.call(this,t,i),this.makeResource(i).makeIncludingAdditionalResources(i).makeExpandable(i).makeServerAdaptor(i)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return n.mixin(o.prototype),t.mixin(o.prototype),i.mixin(o.prototype),s.mixin(o.prototype),o}),csui.define("csui/models/authenticated.user.node.permission",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin"],function(e,t,i,n,s,o){"use strict";var r=t.Model.extend({"constructor":function(e,i){i||(i={}),t.Model.prototype.constructor.call(this,e,i),this.makeResource(i).makeIncludingAdditionalResources(i).makeExpandable(i),this.options=i},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"url":function(){var e=this.node?this.node.get("id"):this.options.node.get("id"),t=this.options.user.get("id"),n=new i(this.connector.connection.url).getApiBase("v2");return i.combine(n,"/nodes/",e,"/permissions/effective/",t)},"parse":function(e){var t=e.results&&e.results.data&&e.results.data.permissions;return t?this.node&&!this.node.get("container")&&-1!==t.permissions.indexOf("add_items")&&t.permissions.splice(t.permissions.indexOf("add_items"),1):t={},t},"hasEditPermissionRights":function(){if(this.node&&"simple"===this.node.get("permissions_model"))return!1;var t=this.get("permissions");return t&&e.isArray(t)&&e.contains(t,"edit_permissions")}});return o.mixin(r.prototype),n.mixin(r.prototype),s.mixin(r.prototype),r}),csui.define("csui/models/mixins/uploadable/uploadable.mixin",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log"],function(e,t,i,n,s){"use strict";s=s(e.id);var o=t.extend({"useJson":!1,"useMock":!1,"usePatch":!1,"metadataPartName":"body"},e.config()),r={"mixin":function(e){var n=e.sync;return e.prepare||(e.prepare=function(e,t){return e}),e.prepareFormData||(e.prepareFormData=function(e,t){return{"body":JSON.stringify(e)}}),t.extend(e,{"makeUploadable":function(e){return this},"sync":function(e,o,c){function a(){return(c.url||t.result(o,"url")).replace(/\?.*$/,"")}var u=r.useJSON,l=r.mock,d=r.usePatch,m=r.metadataPartName,h=c.data||c.attrs||this.attributes;if(!1!==c.prepare&&(h=this.prepare(h,c)),"create"===e)if(s.debug("Creating {0} ({1}).",s.getObjectName(this),this.cid)&&console.log(s.last),l)t.each(t.keys(c.files||{}),function(e){var i,n=c.files[e];if(t.isArray(n)&&n.length>1)for(i=0;i<n.length;++i){var s=i?e+i:e;h[s]=n[i]}else n&&(h[e]=n)}),t.extend(c,{"data":h,"contentType":"application/json","url":a()});else if(t.isEmpty(c.files))u?t.extend(c,{"data":JSON.stringify(h),"contentType":"application/json","url":a()}):(h=this.prepareFormData(h),t.extend(c,{"data":i.param(h),"contentType":"application/x-www-form-urlencoded","url":a()}));else{var p=new FormData;h=JSON.stringify(h),u?p.append(m,new Blob([h],{"type":"application/json"})):p.append(m,h),t.each(t.keys(c.files||{}),function(e){var i,n=c.files[e];if(t.isArray(n)&&n.length>1)for(i=0;i<n.length;++i){var s=i?e+i:e;p.append(s,n[i])}else n&&p.append(e,n,n.name)}),t.extend(c,{"data":p,"contentType":!1,"url":a()})}else if("update"===e||"patch"===e){s.debug("Updating {0} ({1}).",s.getObjectName(this),this.cid)&&console.log(s.last),d||(e="update");var f=this.state&&this.state.get("metadata_token");null!=f&&(h.metadata_token=f),l?t.extend(c,{"data":h,"contentType":"application/json","url":a()}):u?t.extend(c,{"data":JSON.stringify(h),"contentType":"application/json","url":a()}):(h=this.prepareFormData(h),t.extend(c,{"data":i.param(h),"contentType":"application/x-www-form-urlencoded","url":a()}))}return n.call(this,e,o,c)}})},"useJSON":o.useJson,"mock":o.useMock,"usePatch":o.usePatch,"metadataPartName":o.metadataPartName};return r}),csui.define("csui/models/member/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"urlRoot":function(){var e=new t(this.connector.connection.url).getApiBase("v1");return t.combine(e,"/members")},"url":function(){var e,i=t.combineQueryString(this.getExpandableResourcesUrlQuery()),n=this.get("id");if(n)e=t.combine(this.urlRoot(),n);else{var s=new t(this.connector.connection.url).getApiBase("v1");e=t.combine(s,"/auth")}return i?e+"?"+i:e},"parse":function(e){return e.user||e.data||e}})}}}),csui.define("csui/models/member",["csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","csui/models/member/server.adaptor.mixin"],function(e,t,i,n,s,o){"use strict";var r=e.Model.extend({"imageAttribute":"photo_url","constructor":function(t,i){e.Model.prototype.constructor.call(this,t,i),this.makeResource(i).makeIncludingAdditionalResources(i).makeUploadable(i).makeExpandable(i).makeServerAdaptor(i)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return s.mixin(r.prototype),t.mixin(r.prototype),n.mixin(r.prototype),i.mixin(r.prototype),o.mixin(r.prototype),r}),csui.define("csui/models/authentication",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/member","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin"],function(e,t,i,n,s,o,r,c){"use strict";var a=t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(i).makeIncludingAdditionalResources(i).makeFetchable(i).makeExpandable(i),this.user=new n(this.get("user"),i)},"idAttribute":null,"url":function(){var e=i.combine(this.connector.connection.url,"auth"),t=i.combineQueryString(this.getExpandableResourcesUrlQuery(),this.getAdditionalResourcesUrlQuery());return t?e+"?"+t:e},"parse":function(t){var i=t.user||(t.user=t.data);return e.defaults(i,{"perspective":t.perspective}),this.user&&this.user.set(i),t}});return c.mixin(a.prototype),r.mixin(a.prototype),s.mixin(a.prototype),o.mixin(a.prototype),a}),csui.define("csui/models/clientsidecollection",["csui/lib/underscore","csui/lib/backbone","csui/utils/base"],function(e,t,i){"use strict";function n(){var t={"clone":function(){var e=new this.constructor(this.models,this.options);return this.columns&&e.columns.reset(this.columns.toJSON()),e.actualSkipCount=this.actualSkipCount,e.totalCount=this.totalCount,e.filteredCount=this.filteredCount,e},"_cacheCollection":function(){!0!==this.selfReset&&(this.selfReset=!1,this.cachedCollection=this.clone())},"parse":function(e){return this.actualSkipCount=0,this.totalCount=e.results.length,this.filteredCount=this.totalCount,this._limitResponse(e.results),this.columns&&this.columns.resetColumnsV2(e,this.options),e.results},"_limitResponse":function(e){e&&this.skipCount&&(e.length>this.skipCount?e.splice(0,this.skipCount):this.actualSkipCount=0),e&&this.topCount&&e.length>this.topCount&&e.splice(this.topCount)},"_resetCollection":function(){this.cachedCollection||this._cacheCollection(),this.workingModels=e.clone(this.cachedCollection.models),this.totalCount=this.workingModels.length,this.filteredCount=this.workingModels.length},"_runAllOperations":function(e){this._resetCollection(),this._sortCollection(),this._filterCollection(),this._limitCollection(),this._triggerCollectionResetEvent(e)},"_triggerCollectionResetEvent":function(t){this.models=e.clone(this.workingModels),this.length=this.models.length,t&&(this.selfReset=!0,this.trigger("reset",this))},"setLimit":function(e,t,i){if(this.skipCount!=e||this.topCount!=t)return this.skipCount=e,this.actualSkipCount=e,this.topCount=t,this._runAllOperations(!0),!0},"_limitCollection":function(){this._limitResponse(this.workingModels)},"resetLimit":function(e){if(this.skipCount)return this.skipCount=0,this.topCount=0,this.actualSkipCount=0,this._resetCollection(),this._triggerCollectionResetEvent(!0),!0},"setFilter":function(t){return this.filterObj||(this.filterObj={}),e.isEmpty(t)?this.filterObj={}:e.extend(this.filterObj,t),this._runAllOperations(!0),!0},"clearFilter":function(e){if(this.filterObj)return this.filterObj=void 0,this._resetCollection(),this._triggerCollectionResetEvent(!0),!0},"_filterCollection":function(){for(var t in this.filterObj)if(e.has(this.filterObj,t)){var i=this.filterObj[t];null!=i&&""!==i&&(e.isArray(i)||(i=[i]),this.workingModels=e.filter(this.workingModels,function(n){var s=r(t,n.get(t));return e.any(i,function(e){var i=r(t,e);return"type"===t&&-1==i?n.get("container"):o(s,i)})}))}this.totalCount=this.workingModels.length,this.filteredCount=this.workingModels.length},"setOrder":function(e,t){if(this.orderBy!=e)return this.orderBy=e,this._runAllOperations(),!0},"resetOrder":function(e){if(this.orderBy)return this.orderBy=void 0,this._resetCollection(),this._triggerCollectionResetEvent(),!0},"_sortCollection":function(){if(this.orderBy){var t=e.map(this.orderBy.split(","),function(e){var t=e.trim().split(" ");return{"property":t[0],"descending":"desc"===t[1]}});this.workingModels.sort(function(i,n){var o=0;return e.find(t,function(e){if(i=r(e.property,i.get(e.property)),n=r(e.property,n.get(e.property)),o=s(i,n))return e.descending&&(o*=-1),!0}),o})}}};return t.ClientSideCollection=e.clone(t),t}function s(e,t){if("string"==typeof e&&"string"==typeof t)return i.localeCompareString(e,t,{"usage":"sort"});if(e!=t){if(e>t||void 0===t)return 1;if(e<t||void 0===e)return-1}return 0}function o(e,t){return"string"==typeof e&&"string"==typeof t?i.localeContainsString(e,t.toString()):e==t}function r(e,t){if(null!=t){if("type"===e)return+t;if(e.indexOf("date")>=0)return new Date(t)}return t}return n}),csui.define("csui/models/column",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/utils/log"],function(e,t,i,n,s){var o=i.Model.extend({"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)},"idAttribute":null,"parse":function(e){switch(e.column_key){case"name":e=t.extend(e,{"default_action":!0,"contextual_menu":!1,"editable":!0,"filter_key":"name"});break;case"type":e=t.extend(e,{"default_action":!0})}return e}});return o.version="1.0",o}),csui.define("csui/models/columns",["module","csui/lib/backbone","csui/utils/log","csui/models/column"],function(e,t,i,n){var s=t.Collection.extend({"model":n,"constructor":function(){t.Collection.prototype.constructor.apply(this,arguments)}});return s.version="1.0",s}),csui.define("csui/models/datadefinition",["module","csui/lib/backbone","csui/utils/log"],function(e,t,i){"use strict";var n=t.Model.extend({"constructor":function(){t.Model.prototype.constructor.apply(this,arguments)},"idAttribute":null,"parse":function(e){return e}});return n.version="1.0",n}),csui.define("csui/models/datadefinitions",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base","csui/models/datadefinition"],function(e,t,i,n,s,o){"use strict";var r=i.Collection.extend({"model":o,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),this.setOptions(t)},"setOptions":function(e){this.options=e||{},this.options.connector&&this.options.connector.assignTo(this),this.options.node&&this.options.node.connector&&this.options.node.connector.assignTo(this)},"url":function(){var e;if(this.options.url){
var t=new s.Url(this.connector.connection.url).getCgiScript(!0);e=s.Url.combine(t,this.options.url)}else e=this.options.node&&this.options.node.urlBase(),this.options.nodeResource&&(e=s.Url.combine(e,this.options.nodeResource));return e},"fetch":function(e){return n.debug("Fetching data-definitions for url '{0}'.",this.url())&&"undefined"!=typeof console&&console.log(n.last),e||(e={}),void 0===e.reset&&(e.reset=!0),i.Collection.prototype.fetch.call(this,e)},"parse":function(e,n){return this.data=e.data||{},this.definitions=e.definitions||{},this.definitions_map=e.definitions_map||{},this.definitions_order=e.definitions_order||{},this.definitions_flat={},t.each(this.definitions,function(e,i){var n=t.extend({"signature":i,"href":this.data[i]},e);this.definitions_flat[i]=n},this),i.Collection.prototype.parse.call(this,this.definitions_flat,n)},"GetDefinitionsOrder":function(){return this.definitions_order},"GetDefinitionMap":function(){return this.definitions_map},"GetDefinition":function(e){return this.definitions[e]},"GetFlatCollection":function(){return this.definitions_flat||{}},"GetFlatDefinition":function(e){return this.definitions_flat[e]}});return t.extend(r,{"version":"1.0"}),r}),csui.define("csui/models/mixins/v2.fields/v2.fields.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeFieldsV2":function(e){return this.fields=e&&e.fields||{},this},"hasFields":function(t){return!!this.fields[t]||!!(e.isEmpty(this.fields)&&this.collection&&this.collection.fields)&&(t?!!this.collection.fields[t]:e.isEmpty(this.collection.fields))},"setFields":function(t,i){e.isObject(t)?e.each(t,function(e,t){this._setOneFieldSet(t,e)},this):this._setOneFieldSet(t,i)},"resetFields":function(t,i){e.isObject(t)?e.each(t,function(e,t){this._resetOneFieldSet(t,e)},this):this._resetOneFieldSet(t,i)},"getResourceFieldsUrlQuery":function(){return e.reduce(this.fields,function(t,i,n){var s=t.fields||(t.fields=[]),o=e.map(i,encodeURIComponent),r=encodeURIComponent(n);if(o.length){var c=r.indexOf(".");c>0?r=r.substring(0,c)+"{"+o.join(",")+"}"+r.substring(c):r+="{"+o.join(",")+"}"}return s.push(r),t},{})},"_setOneFieldSet":function(t,i){var n=this.fields[t]||(this.fields[t]=[]);i&&(e.isArray(i)||(i=i.split(",")),e.each(i,function(t){e.contains(n,t)||n.push(t)},this))},"_resetOneFieldSet":function(t,i){if(i){var n=this.fields[t]||(this.fields[t]=[]);e.isArray(i)||(i=i.split(",")),e.each(i,function(t){var i=e.indexOf(n,t);i>=0&&n.splice(i,1)},this)}else t?delete this.fields[t]:e.chain(this.fields).keys().each(function(e){delete this.fields[e]},this)}})},"mergePropertyParameters":function(t,i){return"string"==typeof i&&(i=i.split(",")),Array.isArray(i)&&(i=i.reduce(function(e,t){var i=e[t];return i&&!i.length||(e[t]=[]),e},{})),t||(t={}),e.each(i,function(i,n){var s=t[n];s?e.each(i,function(t){e.contains(s,t)||s.push(t)}):t[n]=i}),t}}}),csui.define("csui/models/mixins/v2.expandable/v2.expandable.mixin",["csui/lib/underscore","csui/models/mixins/v2.fields/v2.fields.mixin"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makeExpandableV2":function(e){return this.expand=e&&e.expand||{},this},"hasExpand":function(t){return!!this.expand[t]||!!(e.isEmpty(this.expand)&&this.collection&&this.collection.expand)&&(t?!!this.collection.expand[t]:e.isEmpty(this.collection.expand))},"setExpand":function(t,i){e.isObject(t)?e.each(t,function(e,t){this._setOneExpand(t,e)},this):this._setOneExpand(t,i)},"resetExpand":function(t,i){e.isObject(t)?e.each(t,function(e,t){this._resetOneExpand(t,e)},this):this._resetOneExpand(t,i)},"getExpandableResourcesUrlQuery":function(){return e.reduce(this.expand,function(t,i,n){var s=t.expand||(t.expand=[]),o=e.map(i,encodeURIComponent),r=encodeURIComponent(n);return o.length&&(r+="{"+o.join(",")+"}"),s.push(r),t},{})},"_setOneExpand":function(t,i){var n=this.expand[t]||(this.expand[t]=[]);i&&(e.isArray(i)||(i=i.split(",")),e.each(i,function(t){e.contains(n,t)||n.push(t)},this))},"_resetOneExpand":function(t,i){if(i){var n=this.expand[t]||(this.expand[t]=[]);e.isArray(i)||(i=i.split(",")),e.each(i,function(t){var i=e.indexOf(n,t);i>=0&&n.splice(i,1)},this)}else t?delete this.expand[t]:e.chain(this.expand).keys().each(function(e){delete this.expand[e]},this)}})},"mergePropertyParameters":t.mergePropertyParameters}}),csui.define("csui/models/mixins/state.requestor/state.requestor.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeStateRequestor":function(e){return this.stateEnabled=e&&e.stateEnabled,this},"enableState":function(){this.stateEnabled=!0},"disableState":function(){this.stateEnabled=!1},"getStateEnablingUrlQuery":function(){return(null!=this.stateEnabled?this.stateEnabled:this.collection&&this.collection.stateEnabled)?{"state":""}:{}}})}}}),csui.define("csui/models/mixins/state.carrier/state.carrier.mixin",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/state.requestor/state.requestor.mixin"],function(e,t,i){"use strict";function n(e){var t=e&&e.state;return t&&t.properties||t}return{"mixin":function(s){return i.mixin(s),e.extend(s,{"makeStateCarrier":function(e,i){return this.state=new t.Model(n(i)),this.makeStateRequestor(e)},"setState":function(e){if(this.state){var t=n(e);t&&this.state.set(t)}},"parseState":function(e,t,i){e.state=n(t)}})}}}),csui.define("csui/models/mixins/v2.commandable/v2.commandable.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makeCommandableV2":function(e){var t=e&&e.commands;return"string"==typeof t&&(t=t.split(",")),this.commands=t||[],this},"setCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.commands,t)||this.commands.push(t)},this)},"resetCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var i=e.indexOf(this.commands,t);i>=0&&this.commands.splice(i,1)},this)):this.commands.splice(0,this.commands.length)},"getRequestedCommandsUrlQuery":function(){return this.commands.length&&{"actions":this.commands}}})}}}),csui.define("csui/models/node.actions/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){var n=i.fetch;return e.extend(i,{"makeServerAdaptor":function(e){return this},"fetch":function(i){var s={};!!this.parent_id&&(s.reference_id=this.parent_id),s.ids=this.nodes,s.actions=this.getRequestedCommandsUrlQuery().actions;var o=i||{};return e.extend(o,{"type":"POST","url":t.combine(this.connector.getConnectionUrl().getApiBase("v2"),"/nodes/actions"),"contentType":"application/x-www-form-urlencoded","data":{"body":JSON.stringify(s)}}),n.call(this,o)},"parse":function(t,i){return e.isArray(t)?t:e.map(t.results,function(t,i){return{"id":i,"actions":e.map(t.data,function(e,t){return e.signature=t,e})}},{})}})}}}),csui.define("csui/models/node.actions",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/actions","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/v2.commandable/v2.commandable.mixin","csui/models/node.actions/server.adaptor.mixin"],function(e,t,i,n,s,o,r,c){"use strict";var a=t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.actions=new n(e&&e.actions)}}),u=t.Collection.extend({"model":a,"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments);var n=i&&i.nodes;"string"==typeof n&&(n=n.split(",")),this.nodes=n||[],this.makeConnectable(i).makeFetchable(i).makeCommandableV2(i).makeServerAdaptor(i)},"setNodes":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.nodes,t)||this.nodes.push(t)},this)},"resetNodes":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var i=e.indexOf(this.nodes,t);i>=0&&this.nodes.splice(i,1)},this)):this.nodes=[]},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"nodes":e.clone(this.nodes),"commands":e.clone(this.includeCommands)})}});return s.mixin(u.prototype),o.mixin(u.prototype),r.mixin(u.prototype),c.mixin(u.prototype),u}),csui.define("csui/utils/promoted.actionitems",["csui/lib/underscore","csui/models/actionitems"],function(e,t,i){"use strict";return new t([{"signature":"properties","sequence":10},{"signature":"unreserve","sequence":10},{"signature":"permissions","sequence":10},{"signature":"reserve","sequence":10},{"signature":"rename","sequence":10},{"signature":"share","sequence":10},{"signature":"edit","sequence":10},{"signature":"copy","sequence":10},{"signature":"move","sequence":10},{"signature":"download","sequence":10},{"signature":"comment","sequence":10},{"signature":"open","sequence":10},{"signature":"delete","sequence":10},{"signature":"browse","sequence":10},{"signature":"addversion","sequence":10},{"signature":"editpermissions","sequence":10},{"signature":"versionscontrol","sequence":10}])}),csui.define("csui/utils/deepClone/deepClone",["csui/lib/underscore","csui/lib/backbone"],function(e,t){function i(t,n){if(!t||"object"!=typeof t||t instanceof HTMLElement||e.isBoolean(t)||e.isNumber(t)||e.isString(t))return t;if(e.isDate(t)||e.isRegExp(t))return new t.constructor(t.valueOf());if(e.isArray(t))return e.map(t,function(t){return e.deepClone(t)});if(t.constructor!==Object){if(!n)throw new Error("Cannot clone an arbitrary function object instance");if(n.cloneCloneableObjects){if(t.deepClone)return t.deepClone();if(t.clone)return t.clone()}if(n.copyArbitraryObjects)return t;if(!n.cloneArbitraryObjects)throw new Error("Cannot clone an arbitrary function object instance")}return e.reduce(t,function(e,t,n){return e[n]=i(t),e},{})}return e.mixin({"deepClone":i}),t.Model.prototype.deepClone=function(e){return new this.constructor(i(this.attributes,e))},t.Collection.prototype.deepClone=function(e){return new this.constructor(this.map(function(t){return i(t.attributes,e)}))},i}),csui.define("csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/node.actions","csui/models/mixins/v2.commandable/v2.commandable.mixin","csui/utils/promoted.actionitems","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o){"use strict";return{"mixin":function(r){s.mixin(r);var c=r._prepareModel;return e.extend(r,{"makeDelayedCommandableV2":function(e){e||(e={});var t=e.defaultActionCommands,i=e.promotedActionCommands||o.getPromotedCommandsSignatures(),s=e.nonPromotedActionCommands||[];return"string"==typeof t&&(t=t.split(",")),this.defaultActionCommands=t||[],this.promotedActionCommands=i,this.nonPromotedActionCommands=s||[],this.delayedActions=new n(void 0,{"connector":e.connector}),this.nonPromotedActions=new n(void 0,{"isNonPromoted":!0,"connector":e.connector}),this.additionalActions=new n(void 0,{"isNonPromoted":!0,"connector":e.connector}),this.setEnabledDelayRestCommands(e.delayRestCommands,e.promoteSomeRestCommands),this.delayRestCommandsForModels=e.delayRestCommandsForModels,this.promotedActionItemsFromControler=o,this.makeCommandableV2(e)},"setEnabledDelayRestCommands":function(e,t){e?this._enableDelayRestCommands():this._disableDelayRestCommands(),this.promoteSomeRestCommands=!1!==t},"setEnabledLazyActionCommands":function(e){var i=t.Deferred();return e?(this._enableNonPromotedRestCommands(),this._requestsNonPromotedRestActions().done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)})):this._disableNonPromotedRestCommands(),i.promise()},"getAdditionalActionCommands":function(i,n){var s=t.Deferred();return this._requestAdditionalActions(i,n).done(e.bind(function(e){s.resolve(e)},this)).fail(function(e){s.reject(e)}),s.promise()},"_enableDelayRestCommands":function(){this.delayRestCommands||(this.delayRestCommands=!0,this.on("sync",this._requestRestActions,this))},"_disableDelayRestCommands":function(){this.delayRestCommands&&(this.delayRestCommands=!1,this.off("sync",this._requestRestActions,this))},"_enableNonPromotedRestCommands":function(){this.enableNonPromotedCommands||(this.enableNonPromotedCommands=!0,this.on("sync",this._requestsNonPromotedRestActions,this))},"_disableNonPromotedRestCommands":function(){this.enableNonPromotedCommands=!1,this.off("sync",this._requestsNonPromotedRestActions,this)},"_requestRestActions":function(e,t,n){e!==this||this instanceof i.Collection&&!this.length||n.xhr&&"GET"!==n.xhr.settings.type&&"POST"!==n.xhr.settings.type||(this.promoteSomeRestCommands?this._requestPromotedActions(e,t,n):this._requestDelayedActions(e,t,n))},"_requestDelayedActions":function(){var t=this.defaultActionCommands,n=e.reject(this.commands,function(i){return e.contains(t,i)});if(n.length){var s=this.delayedActions;s.resetCommands(),s.setCommands(n),s.resetNodes(),this instanceof i.Collection?s.setNodes(this.pluck("id")):s.setNodes([this.get("id")]),s.connector||this.connector.assignTo(s),s.parent_id=this.node?this.node.get("id"):this.get("id"),s.once("sync",e.bind(this._updateOriginalActions,this)).fetch({"reset":!0})}},"_requestPromotedActions":function(t){var n=this.defaultActionCommands,s=this.promotedActionCommands,o=e.reject(this.commands,function(t){return e.contains(n,t)}),r=[],c=[];if(e.each(o,function(t){e.contains(s,t)?r.push(t):c.push(t)}),this.promotedActionCommands=r,this.nonPromotedActionCommands=c,r.length){var a=this.delayedActions;if(a.resetCommands(),a.setCommands(r),a.resetNodes(),this instanceof i.Collection){var u=[];this.each(function(e){e.nonPromotedActionCommands=c,e.promotedActionCommands=r,e.get("csuiDelayedActionsRetrieved")||u.push(e.get("id"))}),a.setNodes(u)}else t.nonPromotedActionCommands=c,t.promotedActionCommands=r,a.setNodes([this.get("id")]);a.parent_id=this.node?this.node.get("id"):this.get("id"),a.nodes.length>0&&(a.connector||this.connector.assignTo(a),a.fetch({"reset":!0,"success":e.bind(this._updateOriginalActions,this)}))}else this instanceof i.Collection?this.each(function(e){e.nonPromotedActionCommands=c,e.promotedActionCommands=r}):(t.nonPromotedActionCommands=c,t.promotedActionCommands=r)},"_requestsNonPromotedRestActions":function(){var n=t.Deferred(),s=this.nonPromotedActions,o=this.nonPromotedActionCommands.length?this.nonPromotedActionCommands:this.collection.nonPromotedActionCommands;if(s.resetCommands(),s.setCommands(o),s.resetNodes(),this instanceof i.Collection){var r=[];this.each(function(e){e.get("csuiLazyActionsRetrieved")||e.isLocallyCreated||r.push(e.get("id"))}),s.parent_id=this.length&&this.models[0].get("reference_id"),s.setNodes(r)}else s.setNodes([this.get("id")]),s.parent_id=this.get("reference_id");return s.connector||this.connector.assignTo(s),s.commands.length&&s.nodes.length?s.fetch({"reset":!0,"success":e.bind(function(){this._updateOriginalActionsAfterLazyActions(),n.resolve(this)},this),"error":e.bind(function(e){this.attributes.csuiLazyActionsRetrieved=!1,n.reject(e)},this)}):(this instanceof i.Collection?this.each(function(e){e.set("csuiLazyActionsRetrieved",!0)}):this.set("csuiLazyActionsRetrieved",!0),n.resolve(this)),n.promise()},"_requestAdditionalActions":function(n,s){var o=t.Deferred(),r=this.additionalActions;if(r.resetCommands(),r.setCommands(n),r.resetNodes(),this instanceof i.Collection){var c=[];this.each(function(e){e.get(s)||e.isLocallyCreated||c.push(e.get("id"))}),r.parent_id=this.length&&this.models[0].get("reference_id"),r.setNodes(c)}else r.setNodes([this.get("id")]),r.parent_id=this.get("reference_id");return r.connector||this.connector.assignTo(r),r.commands.length&&r.nodes.length?r.fetch({"reset":!0,"success":e.bind(function(){this._updateOriginalActionsAfterAdditionalActions(s),o.resolve(this)},this),"error":e.bind(function(e){this.attributes[s]=!1,o.reject(e)},this)}):(this instanceof i.Collection?this.each(function(e){e.set(s,!0)}):this.set(s,!0),o.resolve(this)),o.promise()},"_updateOriginalActions":function(){function e(e){var i=t.get(e.get("id"));i&&(e.actions.add(i.actions.models),e.set("csuiDelayedActionsRetrieved",!0))}var t=this.delayedActions;this instanceof i.Collection?this.each(e):e(this)},"_updateOriginalActionsAfterLazyActions":function(){var t=this.nonPromotedActions,n=function(i){i.attributes.csuiLazyActionsRetrieved=!0;var n=t.get(i.get("id"));n&&(e.each(n.actions.models,function(e){e.attributes.csuiNonPromotedAction=!0}),i.actions.add(n.actions.models))};this instanceof i.Collection?this.each(n):n(this)},"_updateOriginalActionsAfterAdditionalActions":function(t){var n=this.additionalActions,s=function(i){i.attributes[t]=!0;var s=n.get(i.get("id"));s&&(e.each(s.actions.models,function(e){e.attributes.csuiNonPromotedAction=!0}),i.actions.add(s.actions.models))};this instanceof i.Collection?this.each(s):s(this)},"setDefaultActionCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.defaultActionCommands,t)||this.defaultActionCommands.push(t)},this)},"resetDefaultActionCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var i=e.indexOf(this.defaultActionCommands,t);i>=0&&this.defaultActionCommands.splice(i,1)},this)):this.defaultActionCommands.splice(0,this.defaultActionCommands.length)},"getRequestedCommandsUrlQuery":function(){var e=this.delayRestCommands?this.defaultActionCommands:this.commands;return e.length&&{"actions":e}},"getAllCommandsUrlQuery":function(){var e=this.commands;return e.length&&{"actions":e}},"_prepareModel":function(e,t){var i,n,s;t||(t={}),i=t.delayRestCommands,n=t.delayRestCommandsForModels,s=t.promoteSomeRestCommands,this.delayedActions&&(void 0===i&&(i=this.delayRestCommands),void 0===n&&(n=this.delayRestCommandsForModels),void 0===s&&(s=this.promoteSomeRestCommands)),t.delayRestCommands=n,t.delayRestCommandsForModels=!1,t.promoteSomeRestCommands=s;var o=c.call(this,e,t);return t.delayRestCommands=i,t.delayRestCommandsForModels=n,o}})}}}),csui.define("csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin",["csui/lib/underscore","csui/lib/jquery"],function(e,t){return{"mixin":function(t){return e.extend(t,{"makeAdditionalResourcesV2Mixin":function(e){return this._additionalResources=[],e&&e.includeResources&&this.includeResources(e.includeResources),this},"includeResources":function(t){t&&!e.isArray(t)&&(t=t.split(",")),this._additionalResources=e.union(this._additionalResources,t)},"excludeResources":function(t){t?(e.isArray(t)||(t=t.split(",")),this._additionalResources=e.reject(this._additionalResources,t)):this._additionalResources.splice(0,this._additionalResources.length)},"getAdditionalResourcesUrlQuery":function(){return e.reduce(this._additionalResources,function(e,t){return e[t]="",e},{})}})}}}),csui.define("csui/models/node.columns2",["csui/lib/backbone"],function(e){"use strict";var t=e.Model.extend({"id":"column_key","constructor":function(t,i){e.Model.prototype.constructor.call(this,t,i)}});return e.Collection.extend({"model":t,"constructor":function(t,i){e.Collection.prototype.constructor.call(this,t,i)}})}),csui.define("csui/models/node/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/models/node/impl/nls/root/lang",{"sizeColumnTitle":"Size"}),csui.define("csui/models/utils/v1tov2",[],function(){"use strict";function e(e){function t(e,t){var i=e.properties||(e.properties=[]);t.forEach(function(e){i.indexOf(e)<0&&i.push(e)})}return Array.isArray(e)?e.reduce(function(e,i){return"node"===i?t(e,n):"member"===i?t(e,r):"user"===i?t(e,s):"group"===i?t(e,o):e[i]||(e[i]=[]),e},{}):"node"===e?{"properties":n.slice()}:"member"===e?{"properties":r.slice()}:"user"===e?{"properties":s.slice()}:"group"===e?{"properties":o.slice()}:e}function t(e){return Array.isArray(e)?e.reduce(function(e,t){return"node"!==t&&"user"!==t&&"group"!==t&&"member"!==t||(t="properties"),e.indexOf(t)<0&&e.push(t),e},[]):"node"===e?n.slice():"member"===e?r.slice():"user"===e||"member"===e?s.slice():"group"===e?o.slice():e}function i(e){if(Array.isArray(e))return e.reduce(function(e,t){return n.indexOf(t)>=0?e.push("node"):s.indexOf(t)>=0?e.push("user"):o.indexOf(t)>=0&&e.push("group"),e},[]);if("object"==typeof e){var t=e.properties;return t?t.length?t.reduce(function(e,t){return n.indexOf(t)>=0?t="node":s.indexOf(t)>=0?t="user":o.indexOf(t)>=0&&(t="group"),e.indexOf(t)<0&&e.push(t),e},[]):["node","member"]:[]}return"properties"===e?["node","member"]:e}var n=["original_id","parent_id","volume_id"],s=["create_user_id","modify_user_id","owner_user_id","reserved_user_id"],o=["owner_group_id"],r=s.concat(o);return{"includeExpandsV1toV2":e,"excludeExpandsV1toV2":t,"expandsV2toV1":i,"nodeExpands":n,"userExpands":s}}),csui.define("csui/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeSyncableFromMultipleSources":function(e){return this},"syncFromMultipleSources":function(e,i,n,s){function o(e){return Array.isArray(e)?e[0]:e}void 0===s&&"object"==typeof n?(s=n,n=o):null==n&&(n=o);var r=this,c=e.filter(function(e){return e.abort}),a=t.Deferred(),u=a.promise();return c.length&&(u.abort=function(e){return e||(e="canceled"),c.forEach(function(t){t.abort(e)}),this}),r.trigger("request",r,{},s),t.when.apply(t,e).done(function(){var e=i.apply(r,arguments),t=s.success;t&&t.call(s.context,e,"success",{}),a.resolve(e,"success",{})}).fail(function(){var e=n.apply(r,arguments),t=s.error;t&&t.call(s.context,e,"error",e.statusText),a.reject.call(a,e,"error",e.statusText)}),u}})}}}),csui.define("csui/models/node/server.adaptor.mixin",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/url","i18n!csui/models/node/impl/nls/lang","csui/models/utils/v1tov2","csui/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o,r){"use strict";function c(e,n){var s=i.Deferred();return csui.require(["csui/models/node.actions"],function(){m=arguments[0];var i=u(e,n),o=l(e,n);n=t.defaults({"parse":!1},n),e.syncFromMultipleSources([i,o],a,n).then(s.resolve,s.reject)},s.reject),s.promise()}function a(e,t){return e.actions=t,e}function u(e,t){var i=e.clone();i.separateCommands=!1;var n=t.collection||e.collection;if(i.isCollectionV2ParameterSource(n)){var s=i.getResourceScopeFrom(n);i.setResourceScope(s)}return i.resetCommands(),i.resetDefaultActionCommands(),i.invalidateFetch(),i.fetch().then(function(){return i.attributes})}function l(e,t){var i=new m(void 0,{"connector":e.connector,"nodes":[e.get("id")],"commands":t.urlQueryWithActionsOnly.actions});return i.fetch().then(function(){return i.reduce(function(e,t){var i=t.actions.toJSON();return e.concat(i)},[])})}function d(e,i){var n=i.url;n&&t.isString(n)?i.url=n.replace(/\?.*$/,""):i.url=e.urlBase()}var m,h={"mixin":function(e){var a=e.sync;return r.mixin(e),t.extend(e,{"makeServerAdaptor":function(e){return this.fetchExactFields=e&&e.fetchExactFields,this},"isFetchableDirectly":function(){return this.get("id")>0},"urlCacheBase":function(){var e=this.urlBase();return e.indexOf("/volumes")<0&&(e=e.replace("/api/v1/","/api/v2/")),e+"?"},"urlBase":function(){var e=this.get("id"),i=this.connector.connection.url;if(e)if("volume"===e)i=n.combine(i,"volumes",this.get("type"));else{if(t.isNumber(e)&&!(e>0))throw new Error("Unsupported id value");i=n.combine(i,"nodes",e)}else i=n.combine(i,"nodes");return this.options.apiVersion&&i.getApiBase(this.options.apiVersion),i},"url":function(){var e,t=this.urlBase();if(!this.isNew())if("volume"===this.get("id")){var s=o.expandsV2toV1(this.expand);s.length&&(e=i.param({"expand":s},!0))}else e=this.collection?this._getCombinedUrlQuery({"withActions":!0}):this._getNodeUrlQuery({"withActions":!0}),this.hasFields("properties")||this.fetchExactFields||(e=n.combineQueryString(e,"fields=properties"));return n.appendQuery(t,e)},"urlQueryWithoutActions":function(){var e;return e=this.collection?this._getCombinedUrlQuery({"withActions":!1}):this._getNodeUrlQuery({"withActions":!1}),this.hasFields("properties")||this.fetchExactFields||(e=e.concat({"fields":"properties"})),e},"urlQueryWithActionsOnly":function(){var e;if(this.collection){var t=this.getV2ParameterSource();e=this._getUrlQueryActionsFromSource(t)}else e=this.getRequestedCommandsUrlQuery();return e},"_getNodeUrlQuery":function(e){var t=n.combineQueryString(this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getAdditionalResourcesUrlQuery());return e.withActions&&(t=n.combineQueryString(t,this.getRequestedCommandsUrlQuery())),t},"_getCombinedUrlQuery":function(e){var t=this.getV2ParameterSource(),i=this._getUrlQueryWithoutActionsFromSource(t);if(e.withActions){var s=this._getUrlQueryActionsFromSource(t);i=i.concat(s)}return n.combineQueryString.apply(n,i)},"_getUrlQueryWithoutActionsFromSource":function(e){return["getExpandableResourcesUrlQuery","getAdditionalResourcesUrlQuery","getResourceFieldsUrlQuery"].map(function(i){var n=this[i]();return t.isEmpty(n)&&(i=e[i])?i.call(e):n},this)},"_getUrlQueryActionsFromSource":function(e){var i=this.delayRestCommands?"getRequestedCommandsUrlQuery":"getAllCommandsUrlQuery",n=this[i]();return t.isEmpty(n)&&(i=e.getAllCommandsUrlQuery||e.getRequestedCommandsUrlQuery)&&(n=i.call(e)),(this.refernce_id||this.attributes.reference_id)&&(n=t.extend({"reference_id":this.refernce_id||this.attributes.reference_id},n)),n},"sync":function(e,t,i){return"read"!==e&&d(this,i),"read"===e&&i.urlQueryWithActionsOnly?c(this,i):a.call(this,e,t,i)},"parse":function(e){var i=e.results||e,n=i.data,s=n&&(n.id||n.properties)&&n,o=s&&s.properties||s||e;if(void 0!==e.type&&(o.type=e.type),void 0!==e.type_name&&(o.type_name=e.type_name),s&&s.versions&&(o.versions=s.versions),t.extend(o,e.type_info),o.versions){var r=o.versions;t.isArray(r)&&(r=r[r.length-1]),r&&t.extend(o,t.pick(r,["file_size","mime_type","version_id","version_number","version_number_major","version_number_minor"]))}t.defaults(o,{"perspective":i&&i.perspective||e.perspective}),this.parseState(o,i),this._parseActions(o,i,e);var c=o.original_id&&o.original_id.id?o.original_id:o.original_id_expand;c&&this._parseActions(c,{},{});var a=o.parent_id&&o.parent_id.id?o.parent_id:o.parent_id_expand;if(a&&(this._parseActions(a,{},{}),a.actions.length||this._makeAccessible(a)),140===o.type&&!o.url){var u=t.findWhere(o.actions,{"signature":"default"});o.url=u&&u.href}o.addable_types=e.addable_types;var l=s&&s.columns;l&&(o.columns=this._parseColumns(l,e));var d=e.definitions||i.metadata&&i.metadata.properties;return d&&(o.definitions=this._parseDefinitions(d,l)),s&&s.properties&&(o.data=t.omit(s,"columns","metadata","properties")),this.collection&&this.collection.node&&298===this.collection.node.get("type")&&(o.reference_id=this.collection.node.get("id")),void 0===this.get("csuiLazyActionsRetrieved")&&this.get("csuiDelayedActionsRetrieved")&&!t.isEmpty(this.changed)&&(o.csuiLazyActionsRetrieved=!0),o},"_parseColumns":function(e,i){var n=i.definitions_order||e&&t.pluck(e,"key");return t.map(n,function(e){return{"key":e}})},"_parseDefinitions":function(e,n){return e.size||!e.container_size&&!e.file_size||(e.size=e.container_size||e.file_size,e.size.key="size",e.size.name=s.sizeColumnTitle),n&&(t.each(n,function(n){var s=n.key,o=e[s];o||(o=e[s]=t.omit(n,"data_type"),o.type=n.data_type);var r=["user","group","member"];-1!==i.inArray(o.persona,r)&&(o.type=14),o.sort=!!n.sort_key}),t.each(n,function(i){var n=i.key;if(n.lastIndexOf("_formatted")>=0){var s=n.substr(0,n.length-10),o=e[s];o||(o=e[s]=t.omit(i,"data_type"),o.type=o.data_type),o.sort=!!i.sort_key}})),t.map(e,function(e,t){return e.key||(e.key=t),e})},"_parseActions":function(e,i,n){var s,o=e.actions||n.actions||n.available_actions;t.isArray(o)?(t.each(o,function(e){e.signature||(e.signature=e.type,e.name=e.type_name,delete e.type,delete e.type_name)}),s=t.reduce(o,function(e,t){return e[t.signature]={},e},{}),e.actions=o):(s=e.commands||n.commands||n.actions||i&&i.actions||{},s.data&&s.order&&s.map&&(s=s.data),e.actions=t.chain(s).keys().map(function(e){var t=s[e];return t.signature=e,t}).value(),delete e.commands,delete e.commands_map,delete e.commands_order)},"_makeAccessible":function(e){e.actions=[{"signature":"open"}]}})}};return h}),csui.define("csui/models/node/node.model",["module","csui/lib/underscore","csui/lib/backbone","csui/models/actions","csui/models/addabletypes","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/state.carrier/state.carrier.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/node.columns2","csui/models/node/server.adaptor.mixin","csui/models/utils/v1tov2","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o,r,c,a,u,l,d,m,h,p){"use strict";function f(e,i){if(e.separateCommands&&e.urlQueryWithActionsOnly&&"volume"!==e.get("id")){var n=t.result(e,"urlQueryWithActionsOnly");if(n&&n.actions.length>g.separateCommandsThreshold)return void(i.urlQueryWithActionsOnly=n)}var s=t.result(e,"url");s.indexOf("/volumes")<0&&(s=s.replace("/api/v1/","/api/v2/")),i.url=s}var g=t.extend({"idAttribute":null,"usesIntegerId":!0,"separateCommands":!1,"separateCommandsThreshold":10},e.config()),v=i.Collection.extend({"model":i.Model.extend({"id":"key","constructor":function(e,t){i.Model.prototype.constructor.call(this,e,t)}}),"constructor":function(e,t){i.Collection.prototype.constructor.call(this,e,t)}}),b=i.Model.extend({"idAttribute":g.idAttribute,"constructor":function(e,o){e||(e={}),o||(o={}),i.Model.prototype.constructor.call(this,e,o),this.options=t.pick(o,["connector"]),this.makeResource(o).makeAdditionalResourcesV2Mixin(o).makeFieldsV2(o).makeExpandableV2(o).makeStateCarrier(o,e).makeDelayedCommandableV2(o).makeUploadable(o).makeServerAdaptor(o);var r=o.separateCommands;this.separateCommands=void 0!==r?r:g.separateCommands,this.setState(e),e.actions||this._setCollectionProperty("actions",n,e,o),e.addable_types||this._setCollectionProperty("addable_types",s,e,o),e.definitions||this._setCollectionProperty("definitions",v,e,o),e.columns||this._setCollectionProperty("columns",m,e,o)},"clone":function(){var e=new this.constructor(this.attributes,{"connector":this.connector,"fields":t.deepClone(this.fields),"expand":t.deepClone(this.expand),"stateEnabled":this.stateEnabled,"includeResources":t.clone(this._additionalResources),"commands":t.clone(this.commands),"defaultActionCommands":t.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands,"separateCommands":this.separateCommands});return e.actions.reset(this.actions.toJSON()),e.fetched=this.fetched,e.error=this.error,e.state.set(this.state.toJSON()),e},"isNew":function(){return!this.has("id")},"isFetchable":function(){if(b.usesIntegerId){var e=this.get("id");return e>0||"volume"===e}return!!this.get("id")},"isCollectionV2ParameterSource":function(e){return e&&e.makeFieldsV2},"getV2ParameterSource":function(){var e=this.collection;if(this.isCollectionV2ParameterSource(e))return e;var t=this.clone();if(e){var i=e._additionalResources;i&&t.includeResources(i);var n=e.defaultActionCommands;n&&t.setDefaultActionCommands(n);var s=e.includeCommands;s&&t.setCommands(s);var o=e.expand;o&&t.setExpand(p.includeExpandsV1toV2(o))}return t},"set":function(e,t,o){var r;return null==e?this:("object"==typeof e?(r=e,o=t):(r={})[e]=t,o||(o={}),this.setState(r),t&&t.skipSetValue?void 0:(r.actions&&this._setCollectionProperty("actions",n,r,o),r.addable_types&&this._setCollectionProperty("addable_types",s,r,o),r.definitions&&this._setCollectionProperty("definitions",v,r,o),r.columns&&this._setCollectionProperty("columns",m,r,o),
void 0!==r.original_id&&this._setNodeProperty("original",r,o),void 0!==r.parent_id&&this._setNodeProperty("parent",r,o),void 0!==r.volume_id&&this._setNodeProperty("volume",r,o),i.Model.prototype.set.call(this,r,o)))},"triggerAllChanges":function(){function e(e){e&&e.trigger("reset",e)}function t(e){if(e){var t=e.attributes;Object.keys(t).forEach(function(i){e.trigger("change:"+i,e,t[i])}),e.trigger("change",e)}}e(this.actions),e(this.addableTypes),e(this.definitions),e(this.columns),t(this.original),t(this.parent),t(this.volume),t(this)},"_setCollectionProperty":function(e,i,n,s){var o=t.str.camelize(e),r=n[e],c=this[o];c?c.reset(r,{"silent":s&&s.silent}):this[o]=new i(r,{"connector":this.connector||s&&s.connector})},"_setNodeProperty":function(e,i,n){var s=i[e+"_id_expand"]||i[e+"_id"];s&&!t.isObject(s)&&(s={"id":s}),t.isObject(s)?this[e]?this[e].set(s,{"silent":n&&n.silent}):this[e]=new b(s,{"connector":this.connector||n&&n.connector}):delete this[e]},"getResourceScope":function(){var e=this.getV2ParameterSource();return t.deepClone({"fields":t.isEmpty(this.fields)?e.fields:this.fields,"expand":t.isEmpty(this.expand)?e.expand:this.expand,"includeResources":t.isEmpty(this._additionalResources)?e._additionalResources:this._additionalResources,"commands":t.isEmpty(this.commands)?e.commands:this.commands,"defaultActionCommands":this.defaultActionCommands})},"getResourceScopeFrom":function(e){return t.deepClone({"fields":e.fields,"expand":e.expand,"includeResources":e._additionalResources,"commands":e.commands,"defaultActionCommands":e.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)},"toString":function(){var e=this.get("id");return"volume"===e?"volume:"+this.get("type"):null!=e?"node:"+e:"node:invalid"}},{"usesIntegerId":g.usesIntegerId});d.mixin(b.prototype),c.mixin(b.prototype),a.mixin(b.prototype),u.mixin(b.prototype),l.mixin(b.prototype),r.mixin(b.prototype),o.mixin(b.prototype),h.mixin(b.prototype);var y=b.prototype.fetch;return b.prototype.fetch=function(e){if(e||(e={}),!e.url){var t=this.collection,i=e.collection;i&&(this.collection=i),f(this,e),i&&(this.collection=t)}return y.call(this,e)},b}),csui.define("csui/models/server.adaptors/favorite2.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){var n=i.parse,s=i.sync;return e.extend(i,{"makeServerAdaptor":function(e){return this},"parse":function(t,i){if(t.results&&(t=t.results),e.isEmpty(t))return{};if(i.attrs){var s={};return e.each(e.keys(i.attrs),function(e){s["favorite_"+e]=i.attrs[e]},this),s}t.data&&t.data.properties&&t.data.favorites&&(t.data.properties.favorite_name=t.data.favorites.name,t.data.properties.favorite_tab_id=t.data.favorites.tab_id);var o=n.call(this,t);return o.actions&&(o.actions=e.reject(o.actions,function(e){return"rename"==e.signature||"delete"==e.signature}),o.actions.push({"signature":"favorite_rename"})),o},"sync":function(i,n,o){var r=!1;if("update"===i||"patch"===i){var c={};if(e.each(e.keys(o.attrs),function(e){var t=e;0===e.indexOf("favorite_")&&(r=!0,t=e.substr("favorite_".length)),c[t]=o.attrs[e]}),o.attrs=c,r){var a=this.connector.getConnectionUrl().getApiBase("v2");a=t.combine(a,"/members/favorites"),a=t.combine(a,n.id),o.url=a}}return s.call(this,i,n,o)}})}}}),csui.define("csui/models/favorite2",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/server.adaptors/favorite2.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n,s){"use strict";var o=n.extend({"mustRefreshAfterPut":!1,"idAttribute":"id","constructor":function(e,t){n.prototype.constructor.apply(this,arguments),this.makeServerAdaptor(t)}});return s.mixin(o.prototype),o}),csui.define("csui/models/browsable/browsable.mixin",["csui/lib/underscore","csui/lib/backbone","csui/utils/url"],function(e,t,i){function n(t,n){if(void 0!==t&&null!==t&&""!==t&&(t=e.isArray(t)?i.makeMultivalueParameter("where_"+n,t):"where_"+n+"="+encodeURIComponent(t.toString()),t.length>0))return t}return{"mixin":function(t){return e.extend(t,{"makeBrowsable":function(t){return t||(t={}),this.skipCount=t.skip||0,this.topCount=t.top||0,this.filters=t.filter||{},this.orderBy=t.orderBy,e.isString(this.filters)&&(this.filters=this.filterStringToObject(this.filters)),this},"setFilter":function(t,i,s){var o,r,c=t;if(e.isObject(t)&&!e.isArray(t)?s=i:(c={},c[i]=t),"object"!=typeof s&&(s={"fetch":s}),e.isEmpty(c)){if(s.clear)return this.clearFilter(s.fetch)}else{for(o in c)e.has(c,o)&&(t=c[o],n(this.filters[o],o)!==n(t,o)&&(void 0!==t?this.filters[o]=t:delete this.filters[o],r=!0));if(s.clear)for(o in this.filters)e.has(this.filters,o)&&!e.has(c,o)&&void 0!==n(this.filters[o],o)&&(delete this.filters[o],r=!0);if(r)return this.trigger("filter:change"),!1!==s.fetch&&this.fetch(),!0}},"clearFilter":function(t){var i;if(!e.isEmpty(this.filters))for(var s in this.filters)e.has(this.filters,s)&&void 0!==n(this.filters[s],s)&&(delete this.filters[s],i=!0);if(i)return this.trigger("filter:clear"),!1!==t&&this.fetch(),!0},"getFilterAsString":function(){var t="",i=this.filters;return i&&e.forEach(e.keys(i),function(n){var s=i[n];s&&(t&&(t+="||"),s&&e.isArray(s)?s.length>0&&(t+=n+"=["+s+"]"):t+=n+"="+s)}),t},"filterStringToObject":function(t){var i=t.split("||"),n={};return e.each(i,function(e){var t=e.split("="),i=t[1];i&&"["===i.charAt(0)&&(i=i.substring(1,i.length-1).split(",")),n[t[0]]=i}),n},"setOrder":function(e,t){if(this.orderBy!=e)return this.orderBy=e,!1!==t&&this.fetch({"skipSort":!1}),this.trigger("orderBy:change"),!0},"resetOrder":function(e){if(this.orderBy)return this.orderBy=void 0,this.trigger("orderBy:clear"),!1!==e&&this.fetch(),!0},"setSkip":function(e,t){if(this.skipCount!=e)return this.skipCount=e,this.trigger("paging:change"),!1!==t&&this.fetch(),!0},"setTop":function(e,t){if(this.topCount!=e)return this.topCount=e,this.trigger("paging:change"),!1!==t&&this.fetch(),!0},"setLimit":function(e,t,i){if(this.skipCount!=e||this.topCount!=t)return this.skipCount=e,this.topCount=t,this.trigger("paging:change"),!1!==i&&this.fetch(),!0},"resetLimit":function(e){if(this.skipCount)return this.skipCount=0,this.trigger("limits:change"),!1!==e&&this.fetch(),!0}})}}}),csui.define("csui/models/browsable/client-side.mixin",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/base","csui/models/browsable/browsable.mixin"],function(e,t,i,n,s){return{"mixin":function(i){s.mixin(i);var o=i.fetch;return e.extend(i,{"makeClientSideBrowsable":function(e){return this.listenTo(this,"add",this._modelAdded).listenTo(this,"remove",this._modelRemoved).listenTo(this,"reset",this._modelsReset),this.allModels||(this.allModels=[]),this._filling=0,this.makeBrowsable(e)},"setOrderOnRequest":function(e){this.orderOnRequest=e},"getBrowsableUrlQuery":function(){var e={};if(this.orderBy&&this.orderOnRequest){var i=this.orderBy.split(",")[0].split(" ");e.sort=(i[1]||"asc")+"_"+i[0]}return t.param(e)},"fetch":function(i){i=i?e.clone(i):{},e.defaults(i,{"skipSort":this.orderOnRequest});var n,s=this;if(!i.reload&&void 0!==this.lastFilteredAndSortedModels){this.trigger("request",this,{},i);var r=t.Deferred();return setTimeout(function(){n=s._fill(i),s._notify(n,i),r.resolve(n)},0),r.promise()}var c=i.silent,a=i.reset;i.silent=!0,i.reset=!0;var u=i.success,l=i.error;return i.success=function(t,i,o){s.allModels=e.clone(s.models);var r=o.parse;o.parse=!1,s.reset([],o),void 0!==c?o.silent=c:delete o.silent,void 0!==a?o.reset=a:delete o.reset,n=s._fill(o),--s._filling,void 0!==r?o.parse=r:delete o.parse,o.success=u,u&&u.call(o.context,t,i,o)},i.error=function(e,t,i){--s._filling,l&&l.call(i.context,e,t,i)},++this._filling,this.lastFilteredAndSortedModels=void 0,this._lastFilterAndSortCriteria=void 0,o.call(this,i).then(function(){return n})},"populate":function(i,n){n=e.extend({"parse":!0},n);var s=n.silent,o=n.reset;n.silent=!0,n.reset=!0,n.skipSort=this.orderOnRequest,++this._filling,this.lastFilteredAndSortedModels=[],this._lastFilterAndSortCriteria=void 0,this.skipCount=0,this.filters={},this.orderBy=void 0,this.sorting&&!this.sorting.links&&(this.sorting=void 0),this.reset(i,n),this.allModels=e.clone(this.models);var r=n.parse;n.parse=!1,this.reset([],n),this.trigger("request",this,{},n),n.silent=s,0===this.allModels.length?n.reset=!0:n.reset=o;var c=t.Deferred(),a=this;return setTimeout(function(){a.fetched=!0;var e=a._fill(n);--a._filling,n.parse=r,a._notify(e,n),c.resolve(e)}),c.promise()},"setAllModels":function(t){var i={};i.parse=!1;var n=this.topCount;this.reset([],i),this.topCount=n,this.allModels=e.clone(t),this.totalCount=this.allModels.length,this.lastFilteredAndSortedModels=[],this._lastFilterAndSortCriteria=void 0,this.skipCount=0,this.filters={},this.orderBy=void 0,this.sorting&&!this.sorting.links&&(this.sorting=void 0)},"compareObjectsForSort":function(e,t,i){return t=this._parseValue(e,t.get(e)),i=this._parseValue(e,i.get(e)),this._compareValues(e,t,i)},"_fill":function(t){var i,n={"orderBy":this.orderBy,"filters":e.clone(this.filters)};if(this._lastFilterAndSortCriteria&&e.isEqual(this._lastFilterAndSortCriteria,n))i=this.lastFilteredAndSortedModels;else{if(i=e.clone(this.allModels),i=this._filter(i),this.sorting&&!this.sorting.links&&(this.sorting=void 0),!t.skipSort&&(i=this._sort(i),this.orderBy&&void 0===this.sorting)){var s=this.orderBy.split(" ");this.sorting={"sort":[]},this.sorting.sort.push({"key":"sort","value":(s[1]||"asc")+"_"+s[0]})}this.lastFilteredAndSortedModels=i,this._lastFilterAndSortCriteria=n}this.totalCount=this.allModels.length,this.filteredCount=i.length,i=this._limit(i);var o=t.reset;void 0===o&&(o=this.autoreset);var r=o?"reset":"set";return++this._filling,this[r](i,t),--this._filling,i},"_notify":function(e,t){t.success&&t.success.call(t.context,this,e,t),this.trigger("sync",this,e,t)},"_limit":function(e){return this.skipCount?(this.actualSkipCount=Math.min(this.skipCount,e.length),e=e.slice(this.skipCount)):this.actualSkipCount=0,this.topCount&&(e=e.slice(0,this.topCount)),e},"_sort":function(t){var i=this;if(this.orderBy){var n=e.map(this.orderBy.split(","),function(e){var t=e.trim().split(" ");return{"property":t[0],"descending":"desc"===t[1]}});t=t.sort(function(t,s){var o=0;return e.find(n,function(e){if(o=i.compareObjectsForSort(e.property,t,s))return e.descending&&(o*=-1),!0}),o})}return t},"_filter":function(t){var i=this;for(var n in this.filters)if(e.has(this.filters,n)){var s=this.filters[n];null!=s&&""!==s&&(e.isArray(s)||(s=[s]),t=e.filter(t,function(t){var o=i._parseValue(n,t.get(n));return e.any(s,function(e){var s=i._parseValue(n,e);return"type"===n&&-1==s?t.get("container"):i._containsValue(n,o,s)})}))}return t},"_modelAdded":function(e,t,i){this._populate(i)&&(this.allModels.push(e),++this.totalCount,this._lastFilterAndSortCriteria=void 0)},"_modelRemoved":function(t,i,n){if(this._populate(n)){var s=e.findIndex(this.allModels,t);s>=0&&(this.allModels.splice(s,1),--this.totalCount,this._lastFilterAndSortCriteria=void 0)}},"_modelsReset":function(t,i){this._populate(i)&&(this.allModels=e.clone(this.models),this.totalCount=this.allModels.length,this.lastFilteredAndSortedModels=[],this._lastFilterAndSortCriteria=void 0,this.skipCount=this.topCount=0,this.filters={},this.orderBy=void 0,this.sorting&&!this.sorting.links&&(this.sorting=void 0))},"_populate":function(e){return!(this._filling||e&&!1===e.populate)},"_compareValues":function(t,i,s){return"string"==typeof i&&"string"==typeof s?n.localeCompareString(i,s,{"usage":"sort"}):e.isArray(i)||e.isArray(s)?(e.isArray(i)?e.isArray(s)||(s=[s]):i=[i],this._compareArrays(i,s)):this._compareObjects(i,s)},"_compareObjects":function(e,t){if(e!=t){if(e>t||void 0===t)return 1;if(e<t||void 0===e)return-1}return 0},"_compareArrays":function(e,t){for(var i=0,s=Math.min(e.length,t.length),o=0;o<=s;){if(o===e.length&&o===t.length){i=0;break}if(o===e.length){i=-1;break}if(o===t.length){i=1;break}if(0!==(i="string"==typeof e[o]&&"string"==typeof t[o]?n.localeCompareString(e[o],t[o],{"usage":"sort"}):this._compareObjects(e[o],t[o])))break;o++}return i},"_containsValue":function(t,i,s){return"string"==typeof i&&"string"==typeof s?n.localeContainsString(i,s.toString()):e.isArray(i)&&"string"==typeof s?e.some(i,function(e){return"string"==typeof e?n.localeContainsString(e,s.toString()):e==s}):i==s},"_parseValue":function(t,i){if(null!=i){if("type"===t)return+i;if(t.indexOf("date")>=0)return e.isArray(i)?i.map(function(e){return new Date(e)}):new Date(i)}return i}})}}}),csui.define("csui/models/browsable/v2.response.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeBrowsableV2Response":function(e){return this.orderBy=e.orderBy,this},"parseBrowsedState":function(t,i){var n=t.collection||t,s=n.paging,o=n.sorting,r=n.searching;if(s?(this.actualSkipCount=(s.page-1)*(s.limit||0),this.totalCount=s.total_count,this.filteredCount=s.filtered_count||s.total_count):(this.actualSkipCount=0,this.filteredCount=this.totalCount=t.results.length),o&&(this.sorting=o,s.columns)){var c,a=o.sort[0].value,u=a.indexOf("_"),l=a.substring(u+1);e.each(s.columns,function(e){e.sort_key===l&&(c=e)}),c&&(this.sortingColumnKey=c.key)}r&&(this.searching=r)},"parseBrowsedItems":function(e,t){return e.results}})}}}),csui.define("csui/models/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/models/impl/nls/root/lang",{"serverCallPrecheckFailedMissingConnector":"Missing connector data for server call.","serverCallPrecheckFailedModelIsNew":"Model is new.","fav_parent_id":"Location","fav_size":"Size","fav_ungrouped":"Ungrouped","name":"Name","type":"Type","version":"Version","state":"State","favorite":"Favorite","toggleDetails":"Toggle Details","parentID":"Parent ID"}),csui.define("csui/models/favorite2column",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","i18n!csui/models/impl/nls/lang"],function(e,t,i,n){"use strict";return t.Model.extend({"idAttribute":null,"constructor":function(e,i){if(e&&!e.title){var s="fav_"+e.column_key;e.title=n[s]}t.Model.prototype.constructor.call(this,e,i)}})}),csui.define("csui/models/favorite2columns",["csui/lib/underscore","csui/lib/backbone","csui/models/favorite2column","i18n!csui/models/impl/nls/lang"],function(e,t,i,n){"use strict";return t.Collection.extend({"model":i,"constructor":function(e,i){e||(e=[{"default_action":!0,"key":"type","name":n.type,"type":2},{"default_action":!0,"key":"favorite_name","name":n.name,"type":-1},{"key":"reserved","name":n.state,"type":5},{"key":"parent_id","name":n.parentID,"type":2},{"key":"favorite","name":n.favorite,"type":5}],e.forEach(function(e,t){e.definitions_order=t+100,e.column_key=e.key})),t.Collection.prototype.constructor.call(this,e,i)}})}),csui.define("csui/models/server.adaptors/favorites2.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2"),i=t.combineQueryString(this.getAdditionalResourcesUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getRequestedCommandsUrlQuery(),this.getSortByOrderUrlQuery());return e=t.combine(e,"/members/favorites"),i?e+"?"+i:e},"getSortByOrderUrlQuery":function(){return{"sort":"order"}},"parse":function(e,t){return this.parseBrowsedState({"results":e},t),this.parseBrowsedItems(e,t)}})}}}),csui.define("csui/models/favorites2",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/mixins/v2.commandable/v2.commandable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/favorite2","csui/models/favorite2columns","csui/models/server.adaptors/favorites2.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o,r,c,a,u,l,d,m,h,p){"use strict";var f=t.Collection.extend({"model":m,"constructor":function(i,n){t.Collection.prototype.constructor.apply(this,arguments),this.callCounter=0,n&&(this.options=e.pick(n,["connector","autoreset","includeResources","fields","expand","commands"])),this.makeConnectable(n).makeFetchable(n).makeAdditionalResourcesV2Mixin(n).makeFieldsV2(n).makeExpandableV2(n).makeStateRequestor(n).makeCommandableV2(n).makeClientSideBrowsable(n).makeBrowsableV2Response(n).makeDelayedCommandableV2(n).makeServerAdaptor(n),this.columns=new h(n.columns)},"_prepareModel":function(e,i){return i||(i={}),i.promotedActionCommands=this.promotedActionCommands,i.nonPromotedActionCommands=this.nonPromotedActionCommands,t.Collection.prototype._prepareModel.call(this,e,i)},"clone":function(){var t=new this.constructor(this.models,{"connector":this.connector,"fields":e.deepClone(this.fields),"expand":e.deepClone(this.expand),"includeResources":e.clone(this._additionalResources),"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":this.orderBy,"commands":e.clone(this.commands),"defaultActionCommands":e.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands});return this.columns&&t.columns.reset(this.columns.toJSON()),t.actualSkipCount=this.actualSkipCount,t.totalCount=this.totalCount,t.filteredCount=this.filteredCount,t},"getResourceScope":function(){return e.deepClone({"fields":this.fields,"expand":this.expand,"includeResources":this._additionalResources,"commands":this.commands,"defaultActionCommands":this.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)}});return u.mixin(f.prototype),l.mixin(f.prototype),i.mixin(f.prototype),n.mixin(f.prototype),s.mixin(f.prototype),o.mixin(f.prototype),r.mixin(f.prototype),c.mixin(f.prototype),a.mixin(f.prototype),d.mixin(f.prototype),p.mixin(f.prototype),f}),csui.define("csui/models/favorite2group",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/favorites2","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o){"use strict";var r=t.Model.extend({"mustRefreshAfterPut":!1,"idAttribute":"tab_id","constructor":function(e,i){t.Model.prototype.constructor.call(this,e,i),this.makeResource(i),this.makeUploadable(i),e||(e={}),this.favorites=new o(e.favorites,{"connector":i.connector,"autoreset":!0,"tab_id":this.get("tab_id"),"columns":e.favorite_columns,"commands":i&&i.commands})},"urlRoot":function(){var e=this.connector.getConnectionUrl().getApiBase("v2");return i.combine(e,"/members/favorites/tabs/")},"parse":function(e,t){return e.results&&e.results.data?{"tab_id":e.results.data.tab_id}:e}});return n.mixin(r.prototype),s.mixin(r.prototype),r}),csui.define("csui/models/server.adaptors/favorite2groups.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","i18n!csui/models/impl/nls/lang"],function(e,t,i,n){"use strict";return{"mixin":function(e){return t.extend(e,{"makeServerAdaptor":function(e){return this},"sync":function(e,i,n){if("read"!==e)throw new Error("Only fetching groups with favorites is supported.");var s=this.connector.makeAjaxCall({"url":this.url()}).then(function(e){return e}),o=this.favorites,r=t.omit(n,["success","error"]),c=o.fetch(r).then(function(e){return o});return n.parse=!1,this.syncFromMultipleSources([s,c],this._createMergedResponse,n)},"_createMergedResponse":function(e,t,i){var s=t.toJSON(),o=t.columns;return e.results.push({"data":{"name":n.fav_ungrouped,"order":-1,"tab_id":-1}}),e.results.map(function(e){e=e.data;var t=e.tab_id;return e.favorites=s.filter(function(e){return e.favorite_tab_id===t||-1===t&&null===e.favorite_tab_id}),e.favorite_columns=o.toJSON(),e})},"parse":function(e,t){return e},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2"),t=i.combineQueryString(this.getAdditionalResourcesUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getSortByOrderUrlQuery());return e=i.combine(e,"/members/favorites/tabs"),t?e+"?"+t:e}})}}}),csui.define("csui/models/favorite2groups",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/utils/base","csui/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/favorite2group","csui/models/favorites2","csui/models/server.adaptors/favorite2groups.mixin","i18n!csui/models/impl/nls/lang"],function(e,t,i,n,s,o,r,c,a,u,l,d,m,h,p){"use strict";var f=i.Collection.extend({"model":d,"constructor":function(e,n){i.Collection.prototype.constructor.apply(this,arguments),n&&(this.options=t.pick(n,["connector","autoreset","includeResources","fields","expand"])),this.makeConnectable(n).makeFetchable(n).makeAdditionalResourcesV2Mixin(n).makeFieldsV2(n).makeExpandableV2(n).makeServerAdaptor(n),n&&(this.favorites=n.favorites,this.commands=n.commands),this.favorites||(this.favorites=new m(void 0,{"connector":this.connector,"autoreset":!0,"commands":this.commands})),this.on("sync",this._setupEventPropagation,this),this.on("add",this._propagateFavorite2CollectionOptions,this),this.on("reset",function(e,t){var i=this;e.each(function(n){i._propagateFavorite2CollectionOptions(n,e,t)})},this)},"_fetch":function(e){return e||(e={}),e.originalSilent=e.silent,e.silent=!0,this.originalFetch.call(this,e)},"_prepareModel":function(e,t){return t||(t={}),t.commands=this.commands,i.Collection.prototype._prepareModel.call(this,e,t)},"_setupEventPropagation":function(){var e=this;this.each(function(t){t.favorites.listenTo(t.favorites,"reset update",function(t,i){e.trigger("update",e,i)})},this)},"_propagateFavorite2CollectionOptions":function(e,i,n){e.favorites.setFilter(t.deepClone(this.favorites.filters),!1),e.favorites.setOrder(this.favorites.orderBy,!1),e.favorites.setFields(t.deepClone(this.favorites.fields)),e.favorites.setExpand(t.deepClone(this.favorites.expand)),this.favorites.commands&&e.favorites.setCommands(this.favorites.commands),e.favorites.promotedActionCommands=this.favorites.promotedActionCommands,e.favorites.nonPromotedActionCommands=this.favorites.nonPromotedActionCommands,e.favorites.each(function(t){t.promotedActionCommands=e.favorites.promotedActionCommands,t.nonPromotedActionCommands=e.favorites.nonPromotedActionCommands})},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"filter":t.deepClone(this.filters),"orderBy":this.orderBy,"fields":t.clone(this.fields),"expand":t.clone(this.expand),"commands":t.clone(this.commands),"favorites":this.favorites.clone()})},"getSortByOrderUrlQuery":function(){return{"sort":"order"}},"resetCollection":function(e,t){this.reset(e,t),this.fetched=!0},"saveAll":function(){var t=this,i=this.map(function(e){var t,i=e.get("tab_id");return t=-1==i?null:e.get("name"),{"name":t,"tab_id":i,"favorites":e.favorites.map(function(e){return{"id":e.get("id"),"name":e.get("favorite_name")}})}}),o=this.connector.getConnectionUrl().getApiBase("v2");o=n.combine(o,"/csui/favorites"),this.callCounter++;var r={"type":"PUT","url":o,"data":i,"beforeSend":function(e,i){e.counter=t.callCounter}},c=e.Deferred(),a=this.connector.makeAjaxCall(r);return a.then(function(e){if(a.counter<t.callCounter)c.reject();else{r={"type":"GET","url":t.url()};t.connector.makeAjaxCall(r).then(function(i){i.results&&i.results instanceof Array&&i.results.forEach(function(e,i){if(e.data){var n=t.at(i);t.remove(n,{"silent":!0}),n.set("tab_id",e.data.tab_id,{"silent":!0}),t.add(n,{"at":i,"silent":!0}),n.set("order",e.data.order,{"silent":!0});for(var s=0;s<n.favorites.length;s++){var o=n.favorites.at(s);n.favorites.remove(o,{"silent":!0}),o.set("favorite_tab_id",e.data.tab_id,{"silent":!0}),n.favorites.add(o,{"at":s,"silent":!0})}}}),c.resolve(e),t.trigger("bulk:update:succeed")},function(e,i){var n=new s.RequestErrorMessage(e);c.reject(n),t.trigger("bulk:update:fail")})}},function(e,i){if(e.counter<t.callCounter)c.reject();else{var n=new s.RequestErrorMessage(e);c.reject(n)}t.trigger("bulk:update:fail")}),c.promise()}});return o.mixin(f.prototype),r.mixin(f.prototype),c.mixin(f.prototype),a.mixin(f.prototype),u.mixin(f.prototype),l.mixin(f.prototype),h.mixin(f.prototype),f}),csui.define("csui/models/server.adaptors/favorite.model.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","i18n!csui/models/impl/nls/lang"],function(e,t,i,n){"use strict";return{"mixin":function(e){return t.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){return i.combine(this.options.connector.getConnectionUrl().getApiBase("v2"),"members/favorites",this.get("id"))},"_serverCallPreCheck":function(){return this.isNew()?{"error":n.serverCallPrecheckFailedModelIsNew}:this.options&&this.options.connector?void 0:{"error":n.serverCallPrecheckFailedMissingConnector}},"_serverCallUpdateFavorite":function(e,i,n){var s=this._serverCallPreCheck();if(void 0!==s)return void i.reject(s);var o={"type":e,"url":this.url()};if("POST"===e){var r=this.get("tab_id"),c=this.get("name");if(void 0!==r||void 0!==c){var a={};void 0!==c&&t.extend(a,{"name":c}),void 0!==r&&-1!==r&&t.extend(a,{"tab_id":r}),t.extend(o,{"data":a})}}this.options.connector.makeAjaxCall(o).done(t.bind(function(e){if(this.set("selected",n),window.csui&&window.csui.mobile){this.get("node").fetch({"force":!0})}i.resolve(e)},this)).fail(function(e){i.reject(e)})}})}}}),csui.define("csui/models/favorite.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/base","csui/utils/url","csui/models/server.adaptors/favorite.model.mixin","i18n!csui/models/impl/nls/lang"],function(e,t,i,n,s,o,r){"use strict";var c=i.Model.extend({"constructor":function(e,t){t||(t={}),this.options=t,i.Model.prototype.constructor.apply(this,arguments),this.makeServerAdaptor(t)},"isNew":function(){return void 0===this.get("id")},"addToFavorites":function(){var t=e.Deferred();return this._serverCallUpdateFavorite("POST",t,!0),t.promise()},"removeFromFavorites":function(){var t=e.Deferred();return this._serverCallUpdateFavorite("DELETE",t,!1),t.promise()}});return o.mixin(c.prototype),c}),csui.define("csui/models/member/member.model",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/resource/resource.mixin"],function(e,t,i,n){"use strict";var s=t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.call(this,e,i),this.groupId=e.groupId,this.makeResource(i)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"url":function(){var e=this.get("id"),t=this.connector.getConnectionUrl().getApiBase("v2");return t=e?i.combine(t,"members/"+e+"/members"):i.combine(t,"members")},"parse":function(t){if(void 0!==t.data){var i=this.get("id");return e.each(t.data,function(e){e.parentId=i}),t}return t}});return n.mixin(s.prototype),s}),csui.define("csui/models/browsable/v1.request.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url"],function(e,t,i){function n(e,t){var i={};return void 0!==e&&null!==e&&""!==e&&(i.key="where_"+t,i.value=e),i}return{"mixin":function(s){return e.extend(s,{"makeBrowsableV1Request":function(e){return this},"getBrowsableParams":function(){var i={},s=this.topCount||0;if(s&&(i.limit=s,i.page=Math.floor((this.skipCount||0)/s)+1),this.orderBy){var o=this.orderBy.split(",")[0].split(" ");"relevance"===this.orderBy.toLowerCase()?i.sort=this.orderBy:i.sort=(o[1]||"asc")+"_"+o[0]}if(!t.isEmptyObject(this.filters))for(var r in this.filters)if(e.has(this.filters,r)){var c=n(this.filters[r],r);void 0!==c.key&&(i[c.key]=c.value)}return i},"getBrowsableUrlQuery":function(){return i.combineQueryString(this.getBrowsableParams())}})}}}),csui.define("csui/models/member/membercollection",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/resource/resource.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v1.request.mixin","csui/models/member/member.model"],function(e,t,i,n,s,o,r){"use strict";var c=t.Collection.extend({"model":r,"searchTerm":"","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments),this.makeResource(i),this.makeBrowsable(i),void 0!==i&&void 0!==i.member&&null!==i.member?(this.parentId=i.member.get("id"),this.nodeId=i.member.get("nodeId"),this.categoryId=i.member.get("categoryId"),this.groupId=i.member.get("groupId")):(this.nodeId=i.nodeId,this.categoryId=i.categoryId,this.groupId=i.groupId),this.query=i.query||"",this.type=i.type},"clone":function(){var e=new this.constructor(this.models,{"connector":this.connector,"parentId":this.parentId,"nodeId":this.nodeId,"categoryId":this.categoryId,"groupId":this.groupId,"query":this.query});return e.totalCount=this.totalCount,e},"url":function(){var e=this.connector.connection.url,t=this.groupId;void 0!==t&&null!==t||(t=this.parentId,this.topCount=20),this.topCount||(this.topCount=20);var n=i.combineQueryString(this.getBrowsableUrlQuery(),{"expand":"properties{group_id}"});return n=n.replace("where_name","query"),e=e.replace("/api/v1","/api/v2"),e=this.type&&"GroupsOfCurrentUser"===this.type?i.combine(e,"members/memberof?"+n):1===this.type&&t?i.combine(e,"members/"+t+"/members?where_type=1&"+n):1===this.type?i.combine(e,"members?where_type=1&"+n):t?i.combine(e,"members/"+t+"/members?"+n):i.combine(e,"members?"+n)},"parse":function(t,i){if(!e.isEmpty(t.results)){var n=this;return this.totalCount=t.collection&&t.collection.paging?t.collection.paging.total_count:t.results.length,e.each(t.results,function(t){t.parentId=n.parentId,t=e.extend(t,t.data.properties)}),t.results}return this.totalCount=0,null},"search":function(e){this.searchTerm=e,this.fetch()}});return n.mixin(c.prototype),s.mixin(c.prototype),o.mixin(c.prototype),c}),csui.define("csui/models/members",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/member","csui/models/mixins/resource/resource.mixin"],function(e,t,i,n,s,o){"use strict";var r=i.Collection.extend({"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),this.makeResource(t),t||(t={}),this.limit=t.limit||10,this.query=t.query||"",this.expandFields=t.expandFields||[],t.memberFilter&&t.memberFilter.type&&(this.memberType=t.memberFilter.type),this.memberType||(this.memberType=[0,1])},"model":s,"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"limit":this.limit,"query":this.query,"expandFields":e.clone(this.expandFields),"memberFilter":{"type":this.memberType}})},"urlRoot":function(){var e=new n(this.connector.connection.url).getApiBase("v2");return n.combine(e,"/members")},"url":function(){
var t="limit="+this.limit,i=this.memberType.length&&"where_type="+this.memberType.join("&where_type=")||"",s=this.expandFields.length&&"expand=properties{"+this.expandFields.join(",")+"}"||"",o=encodeURIComponent(s),r="query="+encodeURIComponent(this.query),c=n.combineQueryString(t,i,o,r);return n.appendQuery(e.result(this,"urlRoot"),c)},"parse":function(t){return e.isEmpty(t.results)?null:(e.each(t.results,function(t){t=e.extend(t,t.data.properties),delete t.data}),t.results)}});return o.mixin(r.prototype),r}),csui.define("csui/models/mixins/node.connectable/node.connectable.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){var i=t._prepareModel;return e.extend(t,{"makeNodeConnectable":function(e){return e&&e.node&&(this.node=e.node,e.node.connector&&e.node.connector.assignTo(this)),this},"_prepareModel":function(e,t){t||(t={});var n=t.node||this.node;return t.connector=n&&n.connector,i.call(this,e,t)}})}}}),csui.define("csui/models/mixins/node.autofetchable/node.autofetchable.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeNodeAutoFetchable":function(e){e&&e.autofetchEvent&&(this._autofetchEvent=e.autofetchEvent);var t=e&&e.autofetch;return t&&this.automateFetch(t),this},"automateFetch":function(t){var i=e.result(this,"_autofetchEvent"),n=t?"on":"off";this.autofetch=!!t,this.node[n](i,e.bind(this._fetchAutomatically,this,t))},"isFetchable":function(){return this.node.isFetchableDirectly()},"_autofetchEvent":"change:id","_fetchAutomatically":function(t){this.isFetchable()&&this.fetch(e.isObject(t)&&t)}})}}}),csui.define("csui/models/mixins/node.resource/node.resource.mixin",["csui/lib/underscore","csui/models/mixins/node.connectable/node.connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/node.autofetchable/node.autofetchable.mixin"],function(e,t,i,n){return{"mixin":function(s){return t.mixin(s),i.mixin(s),n.mixin(s),e.extend(s,{"makeNodeResource":function(e){return this.makeNodeConnectable(e).makeFetchable(e).makeNodeAutoFetchable(e)}})}}}),csui.define("csui/utils/nodesprites",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin","i18n!csui/utils/impl/nls/lang","csui-ext!csui/utils/nodesprites"],function(e,t,i,n,s){var o=t.Model.extend({"defaults":{"sequence":100,"className":null},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(i)}});i.mixin(o.prototype);var r=t.Collection.extend({"model":o,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)},"findClass":function(t,i,n){var s=this.find(function(s){var o=s.get(t);if(void 0!==o){if(e.isArray(o[i]))for(var r=o[i],c=0;c<r.length;c++)if(r[c]===n)return!0;return o[i]===n}});return s?s.get("className"):void 0},"findTypeByNode":function(t){var i=t.get("type_name")||n.NodeTypeUnknown,s=this.findByNode(t);if(s){var o=e.result(s.attributes,"mimeType");o&&(i=o)}return i},"findClassByNode":function(t){var i=this.findByNode(t);return i&&e.result(i.attributes,"className")||""},"findByNode":function(e){return this.find(function(t){return t.matchRules(e,t.attributes)})}}),c=new r([{"equalsNoCase":{"mime_type":["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12"]},"className":"csui-icon mime_excel","svgId":"themes--carbonfiber--image--icons--mime_excel","mimeType":n.NodeTypeXLS,"sequence":50},{"equalsNoCase":{"mime_type":["application/visio","application/x-visio","application/vnd.visio","application/visio.drawing","application/vsd","application/x-vsd","image/x-vsd","application/vnd.visio2013","application/vnd.ms-visio.drawing","application/vnd.ms-visio.viewer","application/vnd.ms-visio.stencil","application/vnd.ms-visio.template"]},"className":"csui-icon mime_visio","svgId":"themes--carbonfiber--image--icons--mime_visio","mimeType":n.NodeTypeVisio,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.sun.xml.calc","application/vnd.sun.xml.calc.template","application/vnd.stardivision.calc","application/x-starcalc"]},"className":"csui-icon mime_spreadsheet","svgId":"themes--carbonfiber--image--icons--mime_spreadsheet","mimeType":n.NodeTypeSpreadsheet,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.template.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"]},"className":"csui-icon mime_powerpoint","svgId":"themes--carbonfiber--image--icons--mime_powerpoint","mimeType":n.NodeTypePPT,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.google-apps.presentation","application/x-iwork-keynote-sffkey","application/vnd.wolfram.mathematica","application/vnd.wolfram.player","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.presentation-template","application/vnd.sun.xml.impress","application/vnd.sun.xml.impress.template","application/vnd.stardivision.impress","application/vnd.stardivision.impress-packed","application/x-starimpress","application/vnd.lotus-freelance","application/vnd.stardivision.impress","application/vnd.corel-presentations","application/vnd.sun.xml.impress","application/vnd.ms-officetheme","application/vnd.sun.xml.impress.template "]},"className":"csui-icon mime_presentation","svgId":"themes--carbonfiber--image--icons--mime_presentation","mimeType":n.NodeTypePresentation,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.ms-publisher","application/x-mspublisher"]},"className":"csui-icon mime_publisher","svgId":"themes--carbonfiber--image--icons--mime_publisher","mimeType":n.NodeTypePublisher,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.oasis.opendocument.formula","application/vnd.sun.xml.math","application/vnd.stardivision.math","application/x-starmath"]},"className":"csui-icon mime_formula","svgId":"themes--carbonfiber--image--icons--mime_formula","mimeType":n.NodeTypeFormula,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.pdf","application/x-pdf","application/pdf"]},"className":"csui-icon mime_pdf","svgId":"themes--carbonfiber--image--icons--mime_pdf","mimeType":n.NodeTypePDF,"sequence":50},{"equalsNoCase":{"mime_type":["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"]},"className":"csui-icon mime_word","svgId":"themes--carbonfiber--image--icons--mime_word","mimeType":n.NodeTypeDOC,"sequence":50},{"equalsNoCase":{"mime_type":["drawing/dwg"]},"className":"csui-icon mime_dwg","svgId":"themes--carbonfiber--image--icons--mime_dwg","mimeType":n.NodeTypeDOC,"sequence":50},{"equalsNoCase":{"mime_type":["application/onenote","application/msonenote"]},"className":"csui-icon mime_onenote","svgId":"themes--carbonfiber--image--icons--mime_onenote","mimeType":n.NodeTypeONE,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.ms-project","application/msproj","application/msproject","application/x-msproject","application/x-ms-project","application/mpp"]},"className":"csui-icon mime_project","svgId":"themes--carbonfiber--image--icons--mime_project","mimeType":n.NodeTypeMPP,"sequence":50},{"startsWithNoCase":{"mime_type":"image/"},"className":"csui-icon mime_image","svgId":"themes--carbonfiber--image--icons--mime_image","mimeType":n.NodeTypeImage,"sequence":50},{"startsWithNoCase":{"mime_type":"audio/"},"className":"csui-icon mime_audio","svgId":"themes--carbonfiber--image--icons--mime_audio","mimeType":n.NodeTypeAudio,"sequence":50},{"startsWithNoCase":{"mime_type":"text/"},"className":"csui-icon mime_paper","svgId":"themes--carbonfiber--image--icons--mime_paper","mimeType":n.NodeTypeText,"sequence":50},{"equalsNoCase":{"mime_type":"text/html"},"className":"csui-icon mime_html","svgId":"themes--carbonfiber--image--icons--mime_html","mimeType":n.NodeTypeHtml,"sequence":40},{"startsWithNoCase":{"mime_type":"video/"},"className":"csui-icon mime_video","svgId":"themes--carbonfiber--image--icons--mime_video","mimeType":n.NodeTypeVideo,"sequence":50},{"equalsNoCase":{"mime_type":["application/x-rar-compressed","application/zip","application/x-zip","application/x-zip-compressed"]},"className":"csui-icon mime_zip","svgId":"themes--carbonfiber--image--icons--mime_zip","mimeType":n.NodeTypeCompressed,"sequence":50},{"equals":{"type":136},"className":"csui-icon compound_document","svgId":"themes--carbonfiber--image--icons--compound_document","sequence":100},{"equals":{"type":144},"className":"csui-icon mime_document","svgId":"themes--carbonfiber--image--icons--mime_document","sequence":100},{"equals":{"type":736},"className":"csui-icon mime_drawing","svgId":"themes--carbonfiber--image--icons--mime_drawing","sequence":100},{"equals":{"type":258},"className":"csui-icon csui-icon-saved-search-query","svgId":"themes--carbonfiber--image--icons--mime_saved_search","mimeType":n.NodeTypeSearchQuery,"sequence":100},{"equals":{"type":140},"className":"csui-icon url1","svgId":"themes--carbonfiber--image--icons--url","mimeType":n.NodeTypeURL,"sequence":100},{"equals":{"type":1},"className":"csui-icon shortcut1","svgId":"themes--carbonfiber--image--icons--shortcut","sequence":100},{"equals":{"type":2},"className":"csui-icon mime_generation","svgId":"themes--carbonfiber--image--icons--mime_generation","sequence":100},{"equals":{"type":131},"className":"csui-icon category1","svgId":"themes--carbonfiber--image--icons--category","sequence":100},{"equals":{"type":202},"className":"csui-icon csui-icon-project","svgId":"themes--carbonfiber--image--icons--mime_cs_project","sequence":100},{"equals":{"type":298},"className":"csui-icon collection","svgId":"themes--carbonfiber--image--icons--collection","sequence":100},{"equals":{"type":141},"className":"csui-icon csui-icon-enterprise-volume","svgId":"themes--carbonfiber--image--icons--title_enterprise","sequence":100},{"equals":{"type":142},"className":"csui-icon csui-icon-personal-volume","svgId":"themes--carbonfiber--image--icons--title_enterprise","sequence":100},{"equals":{"type":133},"className":"csui-icon csui-icon-category-volume","svgId":"themes--carbonfiber--image--icons--category_volume","sequence":100},{"equals":{"type":132},"className":"csui-icon csui-icon-node-category-folder","svgId":"themes--carbonfiber--image--icons--category_volume","sequence":100},{"equals":{"type":299},"className":"csui-icon csui-icon-node-livereport","svgId":"themes--carbonfiber--image--icons--mime_livereport","sequence":100},{"equals":{"type":212},"className":"csui-icon csui-icon-node-milestone","svgId":"themes--carbonfiber--image--icons--mime_milestone","sequence":100},{"equals":{"type":218},"className":"csui-icon csui-icon-node-poll","svgId":"themes--carbonfiber--image--icons--mime_poll","sequence":100},{"equals":{"type":384},"className":"csui-icon csui-icon-node-prospector","svgId":"themes--carbonfiber--image--icons--prospector","sequence":100},{"equals":{"type":206},"className":"csui-icon csui-icon-node-task","svgId":"themes--carbonfiber--image--icons--mime_task","sequence":100},{"equals":{"type":205},"className":"csui-icon csui-icon-node-task-group","svgId":"themes--carbonfiber--image--icons--mime_task_group","sequence":100},{"equals":{"type":204},"className":"csui-icon csui-icon-node-task-list","svgId":"themes--carbonfiber--image--icons--mime_task_list","sequence":100},{"equals":{"type":957},"className":"csui-icon csui-icon-perspective","svgId":"themes--carbonfiber--image--icons--mime_perspective","sequence":100},{"equals":{"type":958},"className":"csui-icon csui-icon-rule","svgId":"themes--carbonfiber--image--icons--mime_rule","sequence":100},{"equals":{"type":955},"className":"csui-icon csui-icon-perspective-assets-folder","svgId":"themes--carbonfiber--image--icons--perspective_assets_folder","sequence":100},{"equals":{"type":954},"className":"csui-icon csui-icon-perspective-assets-volume","svgId":"themes--carbonfiber--image--icons--perspective_assets_volume","sequence":100},{"equals":{"type":899},"className":"csui-icon csui-icon-node-virtual-folder","svgId":"themes--carbonfiber--image--icons--virtual_folder","sequence":100},{"equals":{"type":146},"className":"csui-icon mime_custom_view","svgId":"themes--carbonfiber--image--icons--mime_custom_view","sequence":30},{"equals":{"type":153},"className":"csui-icon assignment-workflow","svgId":"themes--carbonfiber--image--icons--assignment_workflow","sequence":100},{"equals":{"type":128},"className":"csui-icon mime_workflow_map","svgId":"themes--carbonfiber--image--icons--mime_workflow_map","sequence":100},{"equals":{"type":190},"className":"csui-icon mime_workflow_status","svgId":"themes--carbonfiber--image--icons--mime_workflow_status","sequence":100},{"equals":{"type":207},"className":"csui-icon mime_channel","svgId":"themes--carbonfiber--image--icons--mime_channel","sequence":100},{"equals":{"type":208},"className":"csui-icon mime_news","svgId":"themes--carbonfiber--image--icons--mime_news_item","sequence":100},{"equals":{"type":215},"className":"csui-icon mime_discussion","svgId":"themes--carbonfiber--image--icons--mime_conversation","sequence":100},{"equals":{"type":335},"className":"csui-icon mime_xml_dtd","svgId":"themes--carbonfiber--image--icons--mime_xml","sequence":30},{"equals":{"type":223},"className":"csui-icon mime_form","svgId":"themes--carbonfiber--image--icons--mime_form","sequence":100},{"equals":{"type":230},"className":"csui-icon mime_form_template","svgId":"themes--carbonfiber--image--icons--layout_template","sequence":100},{"equals":{"type":1281},"className":"csui-icon icon-pulse-comment","svgId":"themes--carbonfiber--image--icons--pulse_comment","sequence":100},{"equals":{"type":5574},"className":"csui-icon mime_wiki_page","svgId":"themes--carbonfiber--image--icons--mime_wiki_page","sequence":10},{"equals":{"type":5573},"className":"csui-icon mime_wiki","svgId":"themes--carbonfiber--image--icons--mime_wiki","sequence":10},{"equals":{"container":"nonselectable"},"className":"csui-icon mime_folder_nonselectable","svgId":"themes--carbonfiber--image--icons--mime_folder_nonselectable32","sequence":1e3},{"equals":{"container":!0},"className":"csui-icon mime_folder","svgId":"themes--carbonfiber--image--icons--mime_folder","sequence":1e3},{"className":"csui-icon mime_document","svgId":"themes--carbonfiber--image--icons--mime_document","sequence":1e4}]);return s&&c.add(e.flatten(s,!0)),c}),csui.define("csui/models/node.addable.type/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url","csui/models/node/node.model","csui/utils/nodesprites"],function(e,t,i,n){"use strict";return{"mixin":function(s){return e.extend(s,{"makeServerAdaptor":function(e){return this},"url":function(){return t.combine(this.node.urlBase(),"addablenodetypes")},"parse":function(t,s){var o=t.data,r=t.definitions;return e.chain(o).keys().map(function(e){var t=o[e],s=r[e];if(t&&s){var c=t&&/[?&]type=([^&]+)(?:&.*)?$/.exec(t);if(c){var a=parseInt(c[1],10);return{"type":a,"type_name":n.findTypeByNode(new i({"type":a,"type_name":s.name}))}}}}).compact().value()}})}}}),csui.define("csui/models/node/node.addable.type.collection",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/node.resource/node.resource.mixin","csui/models/node.addable.type/server.adaptor.mixin"],function(e,t,i,n,s,o){"use strict";var r=t.Model.extend({"defaults":{"type":null,"type_name":null},"idAttribute":"type","constructor":function(){t.Model.prototype.constructor.apply(this,arguments)}}),c=t.Collection.extend({"model":r,"constructor":function e(t,i){e.__super__.constructor.apply(this,arguments),this.makeNodeResource(i).makeServerAdaptor(i)},"clone":function(){return new this.constructor(this.models,{"node":this.node})},"isFetchable":function(){return this.node.isFetchable()}});return s.mixin(c.prototype),o.mixin(c.prototype),c}),csui.define("csui/models/mixins/appcontainer/appcontainer.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeAppContainer":function(e){return this},"massageResponse":function(t){return e.map(["original","create_user","owner_user","reserved_user","modify_user","parent"],function(e){var i=e+"_id",n=i+"_expand";t[n]&&(t[n].id=t[i])}),t.reserved=!!t.reserved_user_id,t.parent_id&&!t.parent_id_expand&&(t.parent_id_expand={"type":this.node.get("type"),"name":this.node.get("name"),"openable":this.node.get("openable")}),t.parent_id_expand&&(t.parent_id_expand.container=!0,t.parent_id_expand.mime_type=t.parent_id_expand.mime_type||null),t}})}}}),csui.define("csui/models/node.children2/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/appcontainer/appcontainer.mixin"],function(e,t,i,n,s){"use strict";return{"mixin":function(o){return n.mixin(o),i.mixin(o),s.mixin(o),e.extend(o,{"makeServerAdaptor":function(e){return this.useSpecialPaging=e.useSpecialPaging,this.makeBrowsableV1Request(e).makeBrowsableV2Response(e).makeAppContainer(e),this},"url":function(){var i,n,s=new t(this.node.connector.connection.url).getApiBase(2);if(this.useSpecialPaging){i=t.combine(s,"app/container",this.node.get("id"),"page");var o={"fields":e.without(this.getResourceFieldsUrlQuery().fields,"properties")};n=t.combineQueryString(this.getBrowsableUrlQuery(),o)}else i=t.combine(s,"nodes",this.node.get("id"),"nodes"),n=t.combineQueryString(this.getBrowsableUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getAdditionalResourcesUrlQuery(),this.getRequestedCommandsUrlQuery());return t.appendQuery(i,n)},"parse":function(e,t){if(this.useSpecialPaging){var i=this;e.results=e.results.map(function(e){return i.massageResponse(e)})}return this.parseBrowsedState(e,t),this.parseBrowsedItems(e,t)}})}}}),csui.define("csui/models/node.children2/node.children2",["module","csui/lib/underscore","csui/lib/backbone","csui/models/node/node.model","csui/models/mixins/node.resource/node.resource.mixin","csui/models/browsable/browsable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/node.children2/server.adaptor.mixin","csui/models/utils/v1tov2","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o,r,c,a,u,l,d,m){"use strict";var h=e.config();t.defaults(h,{"defaultPageSize":30});var p=i.Collection.extend({"model":n,"constructor":function(e,n){n=t.defaults({},n,{"top":h.defaultPageSize},n),i.Collection.prototype.constructor.call(this,e,n),this.makeNodeResource(n).makeBrowsable(n).makeAdditionalResourcesV2Mixin(n).makeFieldsV2(n).makeExpandableV2(n).makeStateRequestor(n).makeDelayedCommandableV2(n).makeServerAdaptor(n)},"clone":function(){var e=new this.constructor(this.models,{"node":this.node,"skip":this.skipCount,"top":this.topCount,"filter":t.deepClone(this.filters),"orderBy":this.orderBy,"fields":t.deepClone(this.fields),"expand":t.deepClone(this.expand),"includeResources":t.clone(this._additionalResources),"commands":t.clone(this.commands),"defaultActionCommands":t.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands,"autofetch":this.autofetch,"autofetchEvent":this._autofetchEvent});return e.fetched=this.fetched,e.error=this.error,e.actualSkipCount=this.actualSkipCount,e.totalCount=this.totalCount,e.filteredCount=this.filteredCount,e},"isFetchable":function(){return this.node.isFetchable()},"getResourceScope":function(){return t.deepClone({"fields":this.fields,"expand":this.expand,"includeResources":this._additionalResources,"commands":this.commands,"defaultActionCommands":this.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)}});o.mixin(p.prototype),r.mixin(p.prototype),c.mixin(p.prototype),a.mixin(p.prototype),u.mixin(p.prototype),l.mixin(p.prototype),s.mixin(p.prototype),d.mixin(p.prototype);var f=p.prototype,g=f.makeExpandableV2,v=f.setExpand,b=f.resetExpand;f.makeExpandableV2=function(e){var t=e&&e.expand;return Array.isArray(t)&&(e.expand=m.includeExpandsV1toV2(t)),g.call(this,e)},f.setExpand=function(e,t){return t||(e=m.includeExpandsV1toV2(e)),v.call(this,e,t)},f.resetExpand=function(e,t){return t||(e=m.excludeExpandsV1toV2(e)),b.call(this,e,t)};var y=f.makeCommandableV2;return f.makeCommandableV2=function(e){return y.call(this,e),this.includeCommands=this.commands,this},p}),csui.define("csui/models/node.ancestors/server.adaptor.mixin",["csui/lib/underscore","csui/models/ancestor","csui/utils/url"],function(e,t,i){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"url":function(){return i.combine(this.node.urlBase(),"ancestors")},"parse":function(i,n){if(i=i.ancestors,this.options.stop){var s,o=this.options.stop.get?this.options.stop.get("id"):this.options.stop.id;i=e.filter(i.reverse(),function(e){var t=!s;return e.id==o&&(s=!0),t}).reverse()}return this.options.limit&&i.length>this.options.limit&&(i.splice(0,i.length-this.options.limit),i.unshift({"type":t.Hidden})),e.each(i,function(e){e.container=!0}),i}})}}}),csui.define("csui/models/nodeancestors",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/utils/log","csui/models/ancestor","csui/models/ancestors","csui/models/mixins/node.resource/node.resource.mixin","csui/models/node.ancestors/server.adaptor.mixin"],function(e,t,i,n,s,o,r,c,a,u){"use strict";var l=c.extend({"constructor":function(e,t){c.prototype.constructor.apply(this,arguments),this.makeNodeResource(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"isFetchable":function(){return this.node.isFetchable()}});return a.mixin(l.prototype),u.mixin(l.prototype),l}),csui.define("csui/models/nodechildrencolumn",["module","csui/lib/backbone","csui/utils/log","i18n!csui/models/impl/nls/lang"],function(e,t,i,n){"use strict";return t.Model.extend({"constructor":function(e,i){if(e&&!e.title){var s=n[e.column_key];void 0!==s&&(e.title=s)}t.Model.prototype.constructor.call(this,e,i)},"idAttribute":null})}),csui.define("csui/models/nodechildrencolumns",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/models/nodechildrencolumn"],function(e,t,i,n,s){"use strict";var o=i.Collection.extend({"model":s,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),this.fetched=!1},"resetCollection":function(e,i){this.cachedColumns&&t.isEqual(e,this.cachedColumns)||(this.cachedColumns=t.map(e,function(e){return t.clone(e)}),this.reset(e,i),this.fetched=!0)},"getColumnModels":function(e,i){return t.reduce(e,function(e,n){if(n.indexOf("_formatted")>=0){var s=n.replace(/_formatted$/,"");if(i[s])return e}else{var o=i[n];if(o&&!o.definitions_order){var r=i[n+"_formatted"];r&&r.definitions_order&&(o.definitions_order=r.definitions_order)}}var c=i[n];switch(n){case"name":c=t.extend(c,{"default_action":!0,"contextual_menu":!1,"editable":!0,"filter_key":"name"});break;case"type":c=t.extend(c,{"default_action":!0});break;case"modify_date":c=t.extend(c,{"initialSortingDescending":!0})}return e.push(t.extend({"column_key":n},c)),e},[])},"resetColumns":function(e,t){this.resetCollection(this.getV1Columns(e,t),t)},"getV1Columns":function(e,i){var n=e.definitions,s=i&&i.columnsFromDefinitionsOrder?e.definitions_order:t.keys(n);if(e.definitions_order)for(var o=0;o<e.definitions_order.length;o++){var r=e.definitions_order[o],c=n[r];c&&(c.definitions_order=500+o)}return this.getColumnModels(s,n)},"resetColumnsV2":function(e,t){this.resetCollection(this.getV2Columns(e),t)},"getV2Columns":function(e){var i=e.results&&e.results[0]&&e.results[0].metadata&&e.results[0].metadata.properties||{};!i.size&&(i.container_size||i.versions&&i.versions.file_size)&&(i.size=i.container_size||i.versions.file_size,i.size.align="right",i.size.key="size",i.size.name="Size");var n=t.keys(i);return this.getColumnModels(n,i)}});return o.version="1.0",o}),csui.define("csui/models/nodes",["module","csui/lib/backbone","csui/models/node/node.model","csui/utils/log","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin"],function(e,t,i,n,s){var o=t.Collection.extend({"model":i,"constructor":function(e,i){i||(i={}),t.Collection.prototype.constructor.apply(this,arguments),this.makeDelayedCommandableV2(i)},"automateFetch":function(e){}});return s.mixin(o.prototype),o.version="1.0",o}),csui.define("csui/models/mixins/commandable/commandable.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeCommandable":function(e){var t=e&&e.commands;return"string"==typeof t&&(t=t.split(",")),this.includeCommands=t||[],this},"setCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.includeCommands,t)||this.includeCommands.push(t)},this)},"resetCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var i=e.indexOf(this.includeCommands,t);i>=0&&this.includeCommands.splice(i,1)},this)):this.includeCommands.splice(0,this.includeCommands.length)},"getRequestedCommandsUrlQuery":function(){return this.includeCommands.length&&{"commands":this.includeCommands}}})}}}),csui.define("csui/models/mixins/delayed.commandable/delayed.commandable.mixin",["csui/lib/underscore","csui/lib/backbone","csui/models/node.actions","csui/models/mixins/commandable/commandable.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n){"use strict";return{"mixin":function(s){n.mixin(s);var o=s._prepareModel;return e.extend(s,{"makeDelayedCommandable":function(e){e||(e={});var t=e.defaultActionCommands;return"string"==typeof t&&(t=t.split(",")),this.defaultActionCommands=t||[],this.delayedActions=new i(void 0,{"connector":e.connector}),this.delayRestCommands=e.delayRestCommands,this.delayRestCommands&&this.on("sync",this._requestRestActions),this.delayRestCommandsForModels=e.delayRestCommandsForModels,this.makeCommandable(e)},"_requestRestActions":function(i){if(!(i!==this||this instanceof t.Collection&&!this.length)){var n=this.defaultActionCommands,s=e.reject(this.includeCommands,function(t){return e.contains(n,t)});if(s.length){var o=this.delayedActions;o.resetCommands(),o.setCommands(s),o.resetNodes(),this instanceof t.Collection?o.setNodes(this.pluck("id")):o.setNodes([this.get("id")]),o.connector||this.connector.assignTo(o),o.parent_id=this.node?this.node.get("id"):this.get("id"),o.fetch({"reset":!0,"success":e.bind(this._updateOriginalActions,this)})}}},"_updateOriginalActions":function(){function e(e){var t=i.get(e.get("id"));t&&e.actions.add(t.actions.models)}var i=this.delayedActions;this instanceof t.Collection?this.each(e):e(this)},"setDefaultActionCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.defaultActionCommands,t)||this.defaultActionCommands.push(t)},this)},"resetDefaultActionCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var i=e.indexOf(this.defaultActionCommands,t);i>=0&&this.defaultActionCommands.splice(i,1)},this)):this.defaultActionCommands.splice(0,this.defaultActionCommands.length)},"getRequestedCommandsUrlQuery":function(){var e=this.delayRestCommands?this.defaultActionCommands:this.includeCommands;return e.length&&{"commands":e}},"getAllCommandsUrlQuery":function(){var e=this.includeCommands;return e.length&&{"commands":e}},"_prepareModel":function(e,t){var i,n;t||(t={}),this.delayedActions?(i=t.delayRestCommands,void 0===i&&(i=this.delayRestCommands),void 0===(n=t.delayRestCommandsForModels)&&(n=this.delayRestCommandsForModels)):(i=t.delayRestCommands,n=t.delayRestCommandsForModels),t.delayRestCommands=n,t.delayRestCommandsForModels=!1;var s=o.call(this,e,t);return t.delayRestCommands=i,t.delayRestCommandsForModels=n,s}})}}}),csui.define("csui/models/browsable/v1.response.mixin",["csui/lib/underscore"],function(e){return{"mixin":function(t){return e.extend(t,{"makeBrowsableV1Response":function(e){return this},"parseBrowsedState":function(e,t){e.page&&(this.actualSkipCount=(e.page-1)*(e.limit||0));var i=e.total_count?e.total_count:0;this.totalCount=i,this.filteredCount=e.filtered_count||i},"parseBrowsedItems":function(e,t){return e.data}})}}}),csui.define("csui/models/node.children/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url","csui/models/browsable/v1.request.mixin","csui/models/browsable/v1.response.mixin"],function(e,t,i,n){"use strict";return{"mixin":function(s){return n.mixin(s),i.mixin(s),e.extend(s,{"makeServerAdaptor":function(e){return this.makeBrowsableV1Request(e).makeBrowsableV1Response(e),this},"url":function(){var e=!!this.includeActions,i=t.combineQueryString({"extra":e,"actions":e},this.getBrowsableUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getRequestedCommandsUrlQuery());return t.combine(this.node.urlBase(),i?"/nodes?"+i:"/nodes")},"urlCacheBase":function(){return t.combine(this.node.urlBase(),"/nodes?")},"parse":function(e,t){return this.parseBrowsedState(e,t),this.columns&&this.columns.resetColumns(e,this.options),this.parseBrowsedItems(e,t)}})}}}),csui.define("csui/models/nodechildren",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/nodes","csui/models/nodechildrencolumns","csui/models/mixins/node.resource/node.resource.mixin","csui/models/mixins/expandable/expandable.mixin","csui/models/browsable/browsable.mixin","csui/models/mixins/delayed.commandable/delayed.commandable.mixin","csui/models/node.children/server.adaptor.mixin","csui/utils/log","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o,r,c,a,u,l,d,m,h){"use strict";var p=e.config();i.defaults(p,{"defaultPageSize":30}),h=h(e.id);var f=r.extend({"constructor":function(e,t){t=i.defaults({},t,{"top":p.defaultPageSize,"columnsFromDefinitionsOrder":!1},t),r.prototype.constructor.call(this,e,t),this.makeNodeResource(t).makeExpandable(t).makeDelayedCommandable(t).makeBrowsable(t).makeServerAdaptor(t),this.options=t,this.includeActions=t.includeActions,this.columns=new c},"clone":function(){return new this.constructor(this.models,{"node":this.node,"skip":this.skipCount,"top":this.topCount,"filter":i.deepClone(this.filters),"orderBy":this.orderBy,"expand":i.clone(this.expand),"includeActions":this.includeActions,"commands":i.clone(this.includeCommands),"defaultActionCommands":i.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands})},
"isFetchable":function(){return this.node.isFetchable()}});l.mixin(f.prototype),u.mixin(f.prototype),d.mixin(f.prototype),m.mixin(f.prototype),a.mixin(f.prototype);var g=f.prototype.fetch;return f.prototype.Fetchable={"fetch":function(e){return g.call(this,e)}},f}),csui.define("csui/models/permission/nodepermission.model",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin"],function(e,t,i,n,s,o,r){"use strict";function c(e,t,i,n){var s=h.PERMISSION_LEVEL_NONE,o=9;return t?(o++,n.get("advancedVersioningEnabled")||o--):i||o--,e&&e.length>0&&"simple"!==n.get("permissions_model")?s=e.indexOf("edit_permissions")>=0&&e.length===o?h.PERMISSION_LEVEL_FULL_CONTROL:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0&&e.length===o-1?h.PERMISSION_LEVEL_WRITE:e.indexOf("see_contents")>=0&&2===e.length?h.PERMISSION_LEVEL_READ:h.PERMISSION_LEVEL_CUSTOM:e&&e.length>0&&"simple"===n.get("permissions_model")&&(e.indexOf("edit_permissions")>=0?s=h.PERMISSION_LEVEL_FULL_CONTROL:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0?s=h.PERMISSION_LEVEL_WRITE:e.indexOf("see_contents")>=0&&2===e.length&&(s=h.PERMISSION_LEVEL_READ)),s}function a(){return["see","see_contents"]}function u(e,t,i){var n=["see","see_contents","modify","edit_attributes","add_items","reserve","add_major_version","delete_versions","delete"];return e?i||n.splice(n.indexOf("add_major_version"),1):(n.splice(n.indexOf("add_items"),1),t||n.splice(n.indexOf("add_major_version"),1)),n}function l(e,t,i){var n=["see","see_contents","modify","edit_attributes","add_items","reserve","add_major_version","delete_versions","delete","edit_permissions"];return e?i||n.splice(n.indexOf("add_major_version"),1):(n.splice(n.indexOf("add_items"),1),t||n.splice(n.indexOf("add_major_version"),1)),n}function d(e,t,i,n){var s=null;switch(e){case h.PERMISSION_LEVEL_NONE:s=[];break;case h.PERMISSION_LEVEL_READ:s=a();break;case h.PERMISSION_LEVEL_WRITE:s=u(t,i,n);break;case h.PERMISSION_LEVEL_FULL_CONTROL:s=l(t,i,n)}return s}var m=t.extend({"idAttribute":null},e.config()),h=n.Model.extend({"idAttribute":m.idAttribute,"defaults":{"addEmptyAttribute":!0},"constructor":function(e,i){e||(e={}),i||(i={}),n.Model.prototype.constructor.call(this,e,i),this.options=t.pick(i,["connector"]),this.makeConnectable(i).makeUploadable(i)},"isNew":function(){return!this.get("type")||!(this.has("right_id")||"public"===this.get("type"))},"urlBase":function(){var e=this.get("type"),i=this.get("right_id"),n=this.nodeId,o=this.apply_to,r=this.include_sub_types,c="",a=this.options.connector.getConnectionUrl().getApiBase("v2");if(t.isNumber(n)&&!(n>0))throw new Error("Unsupported id value");if(a=s.combine(a,"nodes",n,"permissions"),o&&(c=s.combineQueryString(c,{"apply_to":o})),r&&t.each(r,function(e){c=s.combineQueryString(c,{"include_sub_types":e})}),c=c.length>0?"?"+c:c,e)if("custom"!==e)a=s.combine(a,e+c);else{if(t.isNumber(i)&&!(i>0))throw new Error("Unsupported permission type or user id");a=s.combine(a,e,i+c)}else a=s.combine(a,"custom"+c);return a},"url":function(){var e=this.urlBase();return e},"parse":function(e,t){if(this.collection){var i,n=e.permissions?e.permissions.indexOf("add_items"):-1;this.collection.isContainer?(i=e.permissions?e.permissions.indexOf("add_major_version"):-1,this.collection.options.node&&this.collection.options.node.get("advancedVersioningEnabled")||-1===i||e.permissions.splice(i,1)):(-1!==n&&e.permissions.splice(n,1),i=e.permissions?e.permissions.indexOf("add_major_version"):-1,this.collection.options.node&&this.collection.options.node.get("advanced_versioning")||-1===i||e.permissions.splice(i,1))}return e},"getPermissionLevel":function(){return h.getPermissionLevel(this.get("permissions"),this.collection.isContainer,this.collection.options.node&&this.collection.options.node.get("advanced_versioning"),this.collection.options.node)}},{"getPermissionLevel":c,"getReadPermissions":a,"getWritePermissions":u,"getFullControlPermissions":l,"getPermissionsByLevelExceptCustom":d});return h.prototype.PERMISSION_LEVEL_NONE=h.PERMISSION_LEVEL_NONE=0,h.prototype.PERMISSION_LEVEL_READ=h.PERMISSION_LEVEL_READ=1,h.prototype.PERMISSION_LEVEL_WRITE=h.PERMISSION_LEVEL_WRITE=2,h.prototype.PERMISSION_LEVEL_FULL_CONTROL=h.PERMISSION_LEVEL_FULL_CONTROL=3,h.prototype.PERMISSION_LEVEL_CUSTOM=h.PERMISSION_LEVEL_CUSTOM=4,h.prototype.getReadPermissions=h.getReadPermissions,h.prototype.getWritePermissions=h.getWritePermissions,h.prototype.getFullControlPermissions=h.getFullControlPermissions,h.prototype.getPermissionsByLevelExceptCustom=h.getPermissionsByLevelExceptCustom,o.mixin(h.prototype),r.mixin(h.prototype),h}),csui.define("csui/models/permission/permission.response.mixin",["csui/lib/underscore","csui/utils/base"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makePermissionResponse":function(e){return this},"parsePermissionResponse":function(t,i,n){if(t.results&&t.results.data&&t.results.data.permissions&&!e.isEmpty(t.results.data.permissions)){var s=t.results.data.permissions;if(e.isArray(s)){s=e.reject(s,function(e){return"public"===e.type&&!e.permissions});var o=e.find(s,function(e){return"owner"===e.type}),r=e.find(s,function(e){return"group"===e.type});o&&o.permissions&&r&&!r.permissions&&(s=e.reject(s,function(e){return"group"===e.type&&!e.permissions})),o&&!o.permissions&&r&&r.permissions&&(s=e.reject(s,function(e){return"owner"===e.type&&!e.permissions})),o&&!o.permissions&&r&&!r.permissions&&(s=e.reject(s,function(e){return"group"===e.type&&!e.permissions}))}else e.isObject(s)&&(s=[],t.results.data.permissions&&t.results.data.permissions.permissions.length>0&&s.push(t.results.data.permissions));t.results.data.permissions=s}}})}}}),csui.define("csui/models/permission/nodeuserpermissions",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/permission/nodepermission.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/permission/permission.response.mixin"],function(e,t,i,n,s,o,r,c,a,u,l,d){"use strict";var m=e.config();i.defaults(m,{"defaultPageSize":30});var h=n.Collection.extend({"model":o,"constructor":function(e,t){t=i.defaults({},t,{"top":m.defaultPageSize},t),n.Collection.prototype.constructor.apply(this,arguments),this.makeFetchable(t),this.options=t,this.includeActions=t.includeActions,this.query=this.options.query,this.makeConnectable(t).makeFetchable(t).makeBrowsable(t).makeBrowsableV2Response(t).makePermissionResponse(t)},"isFetchable":function(){return!0},"url":function(){var e,t=s.combine(this.connector.getConnectionUrl().getApiBase("v2"),"nodes",this.options.node.get("id"));return this.options.memberId?(t+="/permissions/effective/"+this.options.memberId,e=s.combineQueryString({"expand":"permissions{right_id}"},e)):e=s.combineQueryString({"fields":["properties{container, name, type, versions_control_advanced, permissions_model}","permissions{right_id, permissions, type}","versions{version_id}"],"expand":["permissions{right_id}"]},e),e&&(t+="?"+e),t},"parse":function(e,t){if(e.results&&e.results.data&&(this.parsePermissionResponse(e,t,this.options.clearEmptyPermissionModel),!this.options.node.get("isNotFound")))return this.nodeName=e.results.data.properties?e.results.data.properties.name:"",(void 0===this.isContainer||e.results.data.properties)&&(this.isContainer=!e.results.data.properties||e.results.data.properties.container),e.results.data.permissions},"setOrder":function(e,t){if(this.orderBy!=e)return this.orderBy=e,!1!==t&&this.fetch({"skipSort":!1}),!0},"processForEmptyOwner":function(){this.findWhere({"type":"owner"})||this.findWhere({"type":"group"})||this.add({"permissions":null,"right_id":null,"type":"owner"},{"at":0})},"addPublicAccess":function(e){this.findWhere({"type":"owner"})&&this.findWhere({"type":"group"})?this.add(e,{"at":2}):this.add(e,{"at":1})},"addOwnerOrGroup":function(e,t){var i=this.findWhere({"type":"owner"});if(i&&null===i.get("permissions")){var n=this.at(0);this.remove(n,{"silent":t}),this.add(e,{"at":0})}else this.add(e,{"at":"owner"===e.get("type")?0:1})}});return c.mixin(h.prototype),a.mixin(h.prototype),u.mixin(h.prototype),r.mixin(h.prototype),l.mixin(h.prototype),d.mixin(h.prototype),h}),csui.define("csui/models/tool.item.config/tool.item.config.collection",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,n,s){"use strict";var o=e.config().configs||[];return Array.isArray(o)||(o=Object.keys(o).reduce(function(e,t){return e.concat(o[t])},[])),o=o.map(function(e){return{"id":e}}),s.Collection.extend({"constructor":function(e,t){e||(e=o),s.Collection.prototype.constructor.call(this,e,t)},"sync":function(e,t,n){if("read"!==e)throw new Error("Only fetching tool item configurations is supported.");var s=this;return n=i.extend({},this.options,n),this._resolveConfigs(n).then(function(){var e=s.toJSON();n.success&&n.success(e,n),s.trigger("sync",s,e,n)})},"_resolveConfigs":function(e){var i=this.chain().filter(function(e){return e.has("id")&&!(e.has("config")||e.has("error"))}).pluck("id").value(),s=n.Deferred(),o=this;return i.length?t(i,function(){var e=arguments;i.forEach(function(t,i){o.get(t).set("config",e[i])}),s.resolve()},function(t){o.forEach(function(e){e.set("error",t)}),e.ignoreErrors?s.resolve():s.reject(t)}):s.resolve(),s.promise()}})}),csui.define("csui/models/tool.item.mask/tool.item.mask.collection",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,n,s){"use strict";var o=e.config().masks||[];return Array.isArray(o)||(o=Object.keys(o).reduce(function(e,t){return e.concat(o[t])},[])),o=o.map(function(e){return{"id":e}}),s.Collection.extend({"constructor":function(e,t){e||(e=o),s.Collection.prototype.constructor.call(this,e,t)},"sync":function(e,t,n){if("read"!==e)throw new Error("Only fetching tool item masks is supported.");var s=this;return n=i.extend({},this.options,n),this._resolveMasks(n).then(function(){var e=s.toJSON();n.success&&n.success(e,n),s.trigger("sync",s,e,n)})},"_resolveMasks":function(e){var i=this.chain().filter(function(e){return e.has("id")&&!(e.has("mask")||e.has("error"))}).pluck("id").value(),s=n.Deferred(),o=this;return i.length?t(i,function(){var e=arguments;i.forEach(function(t,i){o.get(t).set("mask",e[i])}),s.resolve()},function(t){o.forEach(function(e){e.set("error",t)}),e.ignoreErrors?s.resolve():s.reject(t)}):s.resolve(),s.promise()}})}),csui.define("csui/models/server.module/server.module.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,n){"use strict";var s=e.config().modules||{},o=t.map(s,function(e,t){return e.id=t,e}),r=n.Model.extend({"defaults":{"id":null,"title":null},"constructor":function e(t,i){e.__super__.constructor.apply(this,arguments)}});return n.Collection.extend({"model":r,"constructor":function e(t,i){t||(t=o),e.__super__.constructor.call(this,t,i)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching the server modules is supported.");var n=this;return i||(i={}),this._resolveServerModules().then(function(){var e=n.toJSON();i.success&&i.success(e,i),n.trigger("sync",n,e,i)})},"_resolveServerModules":function(e){e=t.extend({},this.options,e);var n=i.Deferred(),o=this.find(function(t){var i=s[t.id];if(i)t.set(i.attributes);else if(!e.ignoreErrors)return!0});if(o){var r=new Error("Invalid module prefix: "+o.id);return n.reject(r)}return n.resolve().promise()}})}),csui.define("csui/models/specificnodemodel",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/node.resource/node.resource.mixin"],function(e,t,i,n){"use strict";var s=t.Model.extend({"constructor":function(e,i){this.options=i||(i={}),t.Model.prototype.constructor.call(this,arguments),this.makeNodeResource(i)},"parse":function(e){return e},"url":function(){var t,n=this.options.node,s=n.get("id");return t=e.str.sformat("forms/nodes/properties/specific?id={0}",s),i.combine(this.options.connector.connection.url,t)}});return n.mixin(s.prototype),s}),csui.define("csui/utils/objectstorage",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/lib/jquery"],function(e,t,i,n,s){"use strict";function o(){this.items={}}return t.extend(o.prototype,{"constructor":o,"setItem":function(e,t){this.items[e]=t},"getItem":function(e){return this.items[e]},"removeItem":function(e){delete this.items[e]}}),o}),csui.define("csui/utils/namedstorage",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/objectstorage"],function(e,t,i,n,s){function o(e,t){this.storage=e,this.name=t;try{this.storage.setItem("testkey","testvalue")}catch(e){this.os=new s}}function r(){var e;return(e=this.os?this.os.getItem(this.name):this.storage&&this.storage.getItem(this.name))&&JSON.parse(e)||{}}function c(e){this.os?this.os.setItem(this.name,JSON.stringify(e)):this.storage&&this.storage.setItem(this.name,JSON.stringify(e))}return t.extend(o.prototype,i.Events,{"constructor":o,"get":function(e,t){return r.call(this)[e]},"set":function(e,t){var i=r.call(this);i[e]=t,c.call(this,i)},"remove":function(e){var t=r.call(this);delete t[e],c.call(this,t)},"destroy":function(){this.storage.removeItem(this.name)}}),o.extend=i.View.extend,o.version="1.0",o}),csui.define("csui/utils/namedsessionstorage",["module","csui/utils/log","csui/utils/namedstorage"],function(e,t,i){void 0===sessionStorage&&t.warn("Session storage is not available.  Some information will not be able to save temporarily; authenticated state, for example.")&&console.warn(t.last);var n=i.extend({"constructor":function(e){i.prototype.constructor.call(this,sessionStorage,e)}});return n.version="1.0",n}),csui.define("csui/models/view.state.model",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/url","csui/utils/namedsessionstorage"],function(e,t,i,n,s,o){"use strict";var r=new o(e.id),c=Object.freeze({"LAST_ROUTER":"lastRouter","CURRENT_ROUTER":"currentRouter","CURRENT_ROUTER_FRAGMENT":"currentRouterFragment","CURRENT_ROUTER_NAVIGATE_OPTIONS":"currentRouterNavigateOptions","CURRENT_ROUTER_SCOPE_ID":"currentRouterScopeId","METADATA_CONTAINER":"metadata_container","STATE":"state","DEFAULT_STATE":"default_state","SESSION_STATE":"session_state","ROUTERS_HISTORY_ARRAY":"routersHistoryArray","URL_PARAMS":"urlParams","ALLOW_WIDGET_URL_PARAMS":"allowWidgetUrlParams"});return new(i.Model.extend({"constructor":function(e,n){i.Model.prototype.constructor.apply(this,arguments),this.set("enabled",!1),this._routersHistory=[],t.values(c).forEach(function(e){var t=r.get(e);-1!==e.indexOf("Array")&&t&&(t=JSON.parse(t)),this.set(e,t),this.listenTo(this,"change:"+e,this._syncWithStorage.bind(this,e))}.bind(this)),this._routersHistory=this.get(c.ROUTERS_HISTORY_ARRAY)||[]},"BROWSING_TYPE":{"none":0,"nodestable":1,"breadcrumbs":2,"navigation":3},"CONSTANTS":c,"_setViewStateAttribute":function(e,i,n,s){if(s||(s={}),this._getViewStateAttribute(e,i)!==n){var o=this.get(e)||{};return o=t.clone(o),s.encode&&(n=encodeURIComponent(n)),void 0===n?delete o[i]:o[i]=n,s=t.omit(s,"encode"),this.set(e,o,s),!0}},"_getViewStateAttribute":function(e,t,i){var n=this.get(e);if(n){var s=n[t];return s&&i&&(s=decodeURIComponent(s)),s}},"setViewState":function(e,t,i){return this._setViewStateAttribute(c.STATE,e,t,i)},"getViewState":function(e,t){return this._getViewStateAttribute(c.STATE,e,t)},"setDefaultViewState":function(e,t,i){return this._setViewStateAttribute(c.DEFAULT_STATE,e,t,i)},"getDefaultViewState":function(e,t){return this._getViewStateAttribute(c.DEFAULT_STATE,e,t)},"setSessionViewState":function(e,i,n){if(n||(n={}),this.getSessionViewState(e)!==i){var s=this.get(c.SESSION_STATE)||{};return s=t.clone(s),s[e]=i,this.set(c.SESSION_STATE,s,n),!0}},"getSessionViewState":function(e){var t=this.get(c.SESSION_STATE);if(t)return t[e]},"_syncWithStorage":function(e){var i=this.get(e);t.isArray(i)&&(i=JSON.stringify(i)),r.set(e,i)},"updateRoutingHistory":function(e){var t=this.isSameRoutingInfo(e,this.getLastRouterInfo());this.set(this.CONSTANTS.LAST_ROUTER,this.get(this.CONSTANTS.CURRENT_ROUTER)),t?(this._restoreStatesFromRouterInfo(this._routersHistory.pop()),this.unset(c.ROUTERS_HISTORY_ARRAY,{"silent":!0}),this.set(c.ROUTERS_HISTORY_ARRAY,this._routersHistory)):this.get("disableLastRouterOnChange")?this.set("disableLastRouterOnChange",!1):this._addRouterInfoToHistory()},"_restoreStatesFromRouterInfo":function(e){if(e){var t={"state":e.state,"default_state":e.defaultState,"session_state":e.sessionState};this.set(t,{"silent":!0}),["state","default_state","session_state"].forEach(function(e){this._syncWithStorage(e)}.bind(this))}},"_addRouterInfoToHistory":function(){var e=r.get(c.CURRENT_ROUTER);e&&(this._routersHistory.push({"router":e,"urlParam":r.get(c.URL_PARAMS),"fragment":r.get(c.CURRENT_ROUTER_FRAGMENT),"scopeId":r.get(c.CURRENT_ROUTER_SCOPE_ID),"navigateOptions":r.get(c.CURRENT_ROUTER_NAVIGATE_OPTIONS),"state":r.get(c.STATE),"sessionState":r.get(c.SESSION_STATE),"defaultState":r.get(c.DEFAULT_STATE)}),this._routersHistory.length>10&&this._routersHistory.shift(),this.unset(c.ROUTERS_HISTORY_ARRAY,{"silent":!0}),this.set(c.ROUTERS_HISTORY_ARRAY,this._routersHistory))},"getLastRouterInfo":function(){return this._routersHistory&&this._routersHistory.length>0&&this._routersHistory[this._routersHistory.length-1]},"isSameRoutingInfo":function(e,t){return e&&t&&e.router===t.router&&e.router===t.router&&e.fragment===t.fragment},"disableLastRouterOnChange":function(){},"clean":function(){this.clear(),r.destroy()},"restoreLastRouter":function(){csui.require(["csui/pages/start/perspective.routing"],function(e){var t=this.getLastRouterInfo();t?(this._restoreStatesFromRouterInfo(t),e.getInstance().restoreRouter(t)):window.history.back()}.bind(this))},"addUrlParameters":function(e,t){csui.require(["csui/pages/start/perspective.routing"],function(i){i.getInstance({"context":t}).addUrlParameters(this.get(c.CURRENT_ROUTER),e)}.bind(this))}},{"CONSTANTS":c}))}),csui.define("csui/models/perspective/personalization.server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url"],function(e,t,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.get("perspective_id"),t=new i(this.connector.connection.url).getApiBase("v2");if(!e)throw new Error("Unsupported perspective_id value");return t=i.combine(t,"perspectives",e,"personalization")}})}}}),csui.define("csui/utils/namedlocalstorage",["module","csui/utils/log","csui/utils/namedstorage"],function(e,t,i){void 0===localStorage&&t.warn("Local storage is not available.  Some information will not be able to be persisted; expanded/collapsed state of facet filters, for example.")&&console.warn(t.last);var n=i.extend({"constructor":function(e){i.prototype.constructor.call(this,localStorage,e)}});return n.version="1.0",n}),csui.define("csui/models/perspective/localstorage.server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/namedlocalstorage"],function(e,t,i,n){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"getStorage":function(){var e=t.Deferred(),i=this;return csui.require(["csui/utils/contexts/factories/user"],function(t){var s=i.options.context.getModel(t),o=s.get("id");if(!o){var r=i.options.context.getFactory(t);r.initialResponse&&(o=r.initialResponse.data.id)}return i.namedLocalStorage||(i.namedLocalStorage=new n("perspective:personalization:"+o)),i.namedLocalStorage,e.resolve(i.namedLocalStorage)},e.reject),e},"savePerspective":function(){var e=this;return this.getStorage().then(function(t){return t.set(e.getNodeId(),e.toJSON())})},"fetchPerspective":function(){var e=this;return this.getStorage().then(function(t){return t.get(e.getNodeId())})},"sync":function(i,n,s){var o=t.Deferred();switch(i){case"create":case"update":case"patch":n.savePerspective().then(function(){o.resolve(this)},o.reject);break;case"read":n.fetchPerspective().then(function(t){e.isEmpty(t)||n.set(t),o.resolve(n)},o.reject);break;default:o.reject()}return o.promise()}})}}}),csui.define("csui/utils/perspective/perspective.util",["module"],function(e){function t(e){return!!(e&&e.schema&&e.schema.required&&e.schema.required.length>0)}function i(e){return e=e||{},!e.callback&&!t(e)}function n(){return h}function s(e){switch(e){case m.MODE_PERSONALIZE:return m.WIDGET_SHORTCUTS;default:return m.WIDGET_PERSPECTIVE_PLACEHOLDER}}function o(e,t){return e.type===m.WIDGET_PERSPECTIVE_PLACEHOLDER||s(t)===e.type&&e.options&&e.__isPlacehoder}function r(e){var t=m.WIDGET_ID_PERSPECTIVE_PREFIX;return e===m.MODE_PERSONALIZE&&(t=m.WIDGET_ID_PESONALIZATION_PREFIX),t+ +new Date}function c(e){var t=e[m.KEY_WIDGET_ID];return!!t&&a(t)}function a(e){return e&&e.substr(0,m.WIDGET_ID_PESONALIZATION_PREFIX.length)===m.WIDGET_ID_PESONALIZATION_PREFIX}function u(e){return!!e[m.KEY_WIDGET_ID]}function l(e){return e&&!0===e[m.KEY_HIDDEN]}function d(e,t){e&&(e[m.KEY_HIDDEN]=t)}var m=Object.freeze({"MODE_EDIT_PERSPECTIVE":"edit","MODE_PERSONALIZE":"personalize","WIDGET_PERSPECTIVE_PLACEHOLDER":"csui/perspective.manage/widgets/perspective.placeholder","WIDGET_SHORTCUTS":"csui/widgets/shortcuts","KEY_WIDGET_ID":"w_id","KEY_HIDDEN":"hidden","WIDGET_ID_PERSPECTIVE_PREFIX":"pman-","WIDGET_ID_PESONALIZATION_PREFIX":"personal-"}),h=[m.KEY_WIDGET_ID,m.KEY_HIDDEN];return{"MODE_EDIT_PERSPECTIVE":m.MODE_EDIT_PERSPECTIVE,"MODE_PERSONALIZE":m.MODE_PERSONALIZE,"WIDGET_PERSPECTIVE_PLACEHOLDER":m.WIDGET_PERSPECTIVE_PLACEHOLDER,"WIDGET_SHORTCUTS":m.WIDGET_SHORTCUTS,"KEY_WIDGET_ID":m.KEY_WIDGET_ID,"WIDGET_ID_PERSPECTIVE_PREFIX":m.WIDGET_ID_PERSPECTIVE_PREFIX,"WIDGET_ID_PESONALIZATION_PREFIX":m.WIDGET_ID_PESONALIZATION_PREFIX,"isEligibleForLiveWidget":i,"hasRequiredFields":t,"isEmptyPlaceholder":o,"getExtraWidgetKeys":n,"getEmptyPlaceholderWidgetType":s,"generateWidgetId":r,"isPersonalWidget":c,"isPersonalWidgetId":a,"hasWidgetId":u,"isHiddenWidget":l,"setWidgetHidden":d}}),csui.define("csui/models/perspective/personalize/delta.generator",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/perspective/perspective.util"],function(e,t,i,n){var s=function(e){this.personalization=e.personalization,this.perspective=e.perspective,this.perspective instanceof i.Model&&(this.perspective=this.perspective.toJSON())};return t.extend(s.prototype,{"getDeltaOfFlowPerspective":function(e){var i=this.perspective.options.widgets,s=this.personalization.options.widgets;i=t.reject(i,n.isPersonalWidget);var o=t.pluck(i,n.KEY_WIDGET_ID),r=t.filter(s,n.isPersonalWidget),c=t.partition(s,n.isHiddenWidget),a=t.pluck(c[1],n.KEY_WIDGET_ID),u=t.pluck(c[0],n.KEY_WIDGET_ID);return t.extend(e,{"perspectiveWidgets":o,"personalWidgets":r,"order":a,"hidden":u}),e},"getDelta":function(){var e=t.pick(this.perspective,"type","perspective_id","perspective_version");switch(e.perspective_id=e.perspective_id||this.perspective.id,this.perspective.override?t.extend(e,t.pick(this.perspective.override,"perspective_id","perspective_version")):e.perspective_version=e.perspective_version||1,this.personalization.type){case"flow":return this.getDeltaOfFlowPerspective(e);default:throw new Error("Personalization not supported.")}}}),s}),csui.define("csui/models/perspective/personalize/delta.resolver",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/perspective/perspective.util"],function(e,t,i,n){var s=function(e){this.delta=e.delta,this.perspective=e.perspective,this.perspective instanceof i.Model&&(this.perspective=this.perspective.toJSON())};return t.extend(s.prototype,{"resolveFlowPerspective":function(e){var i=this.delta.order,s=this.delta.personalWidgets,o=this.delta.hidden,r=this.perspective.options.widgets,c=t.indexBy(s,n.KEY_WIDGET_ID),a=t.indexBy(r,n.KEY_WIDGET_ID);i=t.filter(i,function(e){return t.has(a,e)||t.has(c,e)}),o=t.filter(o,function(e){return t.has(a,e)||t.has(c,e)});var u=t.filter(r,function(e){var s=e[n.KEY_WIDGET_ID];return!t.contains(i,s)&&!t.contains(o,s)}),l=t.map(i,function(e){return n.isPersonalWidgetId(e)?c[e]:a[e]}),d=t.map(o,function(e){var i=t.clone(a[e]);return n.setWidgetHidden(i,!0),i}),m=t.union(l,u,d);return t.extend(e,{"options":{"widgets":m},"personalizations":this.delta}),e},"canMergeDelta":function(){return this.perspective.perspectiveId===this.delta.perspectiveId&&this.perspective.type===this.delta.type},"getPersonalization":function(){if(!this.canMergeDelta())return this.perspective;var e=t.clone(this.perspective);switch(this.delta.type){case"flow":return this.resolveFlowPerspective(e);default:return e}}}),s}),csui.define("csui/models/perspective/personalize/personalize.guide",["module","csui/models/perspective/personalize/delta.generator","csui/models/perspective/personalize/delta.resolver"],function(e,t,i){return{"getDelta":function(e,i){return new t({"perspective":e,"personalization":i}).getDelta()},"getPersonalization":function(e,t){return new i({"perspective":e,"delta":t}).getPersonalization()}}}),csui.define("csui/models/perspective/personalization.model",["require","module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/models/node/node.model","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/connectable/connectable.mixin","csui/models/perspective/personalization.server.adaptor.mixin","csui/models/perspective/localstorage.server.adaptor.mixin","csui/models/perspective/personalize/personalize.guide","csui/utils/perspective/perspective.util"],function(e,t,i,n,s,o,r,c,a,u,l,d){"use strict";var m=n.extend({"persistOnLocalStorage":!1},t.config()),h=s.Model.extend({"constructor":function e(t,i){e.__super__.constructor.apply(this,arguments),this.options=i,m.persistOnLocalStorage?this.makeServerAdaptor(i):this.makeUploadable(i).makeConnectable(i).makeServerAdaptor(i),this.resolvePersonalization=!0},"getPerspectiveId":function(){return this.get("perspective_id")},"getPerspective":function(){return this.resolvePersonalization||this.personalization,this.personalization=l.getPersonalization(this.options.perspective,this.toJSON()),this.resolvePersonalization=!1,this.personalization},"setPerspective":function(e,t){var i=l.getDelta(this.options.perspective,e);this.set(i,t),this.resolvePersonalization=!0},"update":function(e,t){var i=this.getPerspective();n.extend(i,e.perspective),this.setPerspective(i,t)},"prepareFormData":function(e,t){return{"personalizations":JSON.stringify(e),"perspective_id":this.get("perspective_id"),"perspective_version":this.get("perspective_version"),"node":this.getNodeId()}},"getNodeId":function(){return this.options.sourceModel&&this.options.sourceModel instanceof o&&this.options.sourceModel.has("id")?this.options.sourceModel.get("id"):"landing-page"}},{"loadPersonalization":function(e,t){var s,o=e.get("perspective");if(!o)return i.Deferred().resolve().promise();if(m.persistOnLocalStorage)s=h.loadPersonalizationFromLocalStorage(e,t,o);else if(o.personalizations){var r=new h(o.personalizations,{"sourceModel":e,"perspective":o});s=i.Deferred().resolve(r.getPerspective())}else s=i.Deferred().resolve();return s.then(function(e){if(e&&!n.isEmpty(e))return n.defaults(e,{"perspectiveMode":d.MODE_PERSONALIZE})}),s.promise()},"loadPersonalizationFromLocalStorage":function(e,t,s){var o=i.Deferred(),r=new h({},{"sourceModel":e,"context":t,"perspective":s});return r.fetch().then(function(){var e=r.getPerspective();n.isEmpty(e)?o.resolve():o.resolve(e)},function(e){o.reject(e)}),o.promise()}});return m.persistOnLocalStorage?u.mixin(h.prototype):(r.mixin(h.prototype),c.mixin(h.prototype),a.mixin(h.prototype)),h}),csui.define("csui/models/autofetchable",["module","csui/lib/underscore","csui/utils/log"],function(e,t,i){"use strict";function n(e){var i={"makeAutoFetchable":function(e){return e&&e.autofetch&&this.automateFetch(e.autofetch),this},"automateFetch":function(e){this[e?"on":"off"](t.result(this,"_autofetchEvent"),t.bind(this._fetchAutomatically,this,e))},"isFetchable":function(){return!!this.get("id")},"_autofetchEvent":"change:id","_fetchAutomatically":function(e,i,n,s){if(this.isFetchable()){var o=t.extend({},e,s);this.fetch(o)}}};return i.AutoFetchable=t.clone(i),i}return i=i(e.id),n}),csui.define("csui/models/connectable",["module","csui/lib/underscore","csui/utils/log"],function(e,t,i){"use strict";function n(e){var i={"makeConnectable":function(e){return e&&e.connector&&e.connector.assignTo(this),e&&e.connector&&this.original&&e.connector.assignTo(this.original),this},"_prepareModel":function(t,i){return i||(i={}),i.connector=this.connector,e.prototype._prepareModel.call(this,t,i)}};return i.Connectable=t.clone(i),i}return i=i(e.id),n}),csui.define("csui/models/fetchable",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log"],function(e,t,i,n){"use strict";function s(e){var s={"makeFetchable":function(e){return this.autoreset=e&&e.autoreset,this.on("reset",this._beforeFetchSucceeded,this).on("add",this._beforeFetchSucceeded,this).on("change",this._beforeFetchSucceeded,this)},"_beforeFetchSucceeded":function(){this.fetching&&this._fetchSucceeded()},"_fetchSucceeded":function(){this.fetching=!1,this.fetched=!0},"_fetchFailed":function(){this.fetching=!1},"fetch":function(t){if(this.fetching)n.debug("Fetching is in progress for {0} ({1}).",n.getObjectName(this),this.cid)&&console.log(n.last);else{this.fetched=!1,n.debug("Fetching is starting for {0} ({1}).",n.getObjectName(this),this.cid)&&console.log(n.last),t=this._prepareFetch(t);var i=this,s=t.success,o=t.error;t.success=function(){n.debug("Fetching succeeded for {0} ({1}).",n.getObjectName(i),i.cid)&&console.log(n.last),i._fetchSucceeded(),s&&s.apply(this,arguments)},t.error=function(){n.debug("Fetching failed for {0} ({1}).",n.getObjectName(i),i.cid)&&console.log(n.last),i._fetchFailed(),o&&o.apply(this,arguments)},this.fetching=e.prototype.fetch.call(this,t)}return this.fetching},"_prepareFetch":function(e){return e||(e={}),void 0===e.reset&&this.autoreset&&(e.reset=!0),e},"ensureFetched":function(e){return this.fetched?(n.debug("No need to fetch {0} ({1}).",n.getObjectName(this),this.cid)&&console.log(n.last),e&&e.success&&e.success(this),i.Deferred().resolve(this,{},e).promise()):this.fetch(e)}};return s.Fetchable=t.clone(s),s}return n=n(e.id),s}),csui.define("csui/models/including.additional.resources",["module","csui/lib/underscore","csui/utils/log"],function(e,t,i){"use strict";function n(e){var i={"makeIncludingAdditionalResources":function(e){return this._additionalResources=[],e&&e.includeResources&&this.includeResources(e.includeResources),this},"includeResources":function(e){t.isArray(e)||(e=e.split(",")),this._additionalResources=t.union(this._additionalResources,e)},"excludeResources":function(e){e?(t.isArray(e)||(e=e.split(",")),this._additionalResources=t.reject(this._additionalResources,e)):this._additionalResources=[]},"getAdditionalResourcesUrlQuery":function(){return t.reduce(this._additionalResources,function(e,t){return e[t]="true",e},{})}};return i.IncludingAdditionalResources=t.clone(i),i}return i=i(e.id),n}),csui.define("csui/models/nodeautofetchable",["module","csui/lib/underscore","csui/utils/log"],function(e,t,i){"use strict";function n(e){var i={"makeNodeAutoFetchable":function(e){return e&&e.autofetch&&this.automateFetch(e.autofetch),this},"automateFetch":function(e){this.node[e?"on":"off"](t.result(this,"_autofetchEvent"),t.bind(this._fetchAutomatically,this,e))},"isFetchable":function(){return this.node.isFetchableDirectly()},"_autofetchEvent":"change:id","_fetchAutomatically":function(e){this.isFetchable()&&this.fetch(t.isObject(e)&&e)}}
;return i.NodeAutoFetchable=t.clone(i),i}return i=i(e.id),n}),csui.define("csui/models/nodeconnectable",["module","csui/lib/underscore","csui/utils/log"],function(e,t,i){"use strict";function n(e){var i={"makeNodeConnectable":function(e){return e&&e.node&&(this.node=e.node,e.node.connector&&e.node.connector.assignTo(this)),this},"_prepareModel":function(t,i){return i.connector=this.node&&this.node.connector,e.prototype._prepareModel.call(this,t,i)}};return i.NodeConnectable=t.clone(i),i}return i=i(e.id),n}),csui.define("csui/models/noderesource",["module","csui/lib/underscore","csui/utils/log","csui/models/nodeconnectable","csui/models/fetchable","csui/models/nodeautofetchable"],function(e,t,i,n,s,o){"use strict";function r(e){var i={"makeNodeResource":function(e){return this.makeNodeConnectable(e).makeFetchable(e).makeNodeAutoFetchable(e)}};return i.NodeResource=t.clone(i),t.extend({},n(e),s(e),o(e),i)}return i=i(e.id),r}),csui.define("csui/models/resource",["module","csui/lib/underscore","csui/utils/log","csui/models/connectable","csui/models/fetchable","csui/models/autofetchable"],function(e,t,i,n,s,o){"use strict";function r(e){var i={"makeResource":function(e){return this.makeConnectable(e).makeFetchable(e).makeAutoFetchable(e)}};return i.Resource=t.clone(i),t.extend({},n(e),s(e),o(e),i)}return i=i(e.id),r}),csui.define("csui/models/uploadable",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log"],function(e,t,i,n,s){"use strict";function o(e){var o={"makeUploadable":function(e){return this},"sync":function(e,o,r){function c(){return(r.url||t.result(o,"url")).replace(/\?.*$/,"")}var a=r.data||r.attrs||this.attributes;if("create"===e){s.debug("Creating {0} ({1}).",s.getObjectName(this),this.cid)&&console.log(s.last);var u=new FormData;u.append("body",JSON.stringify(a)),t.each(t.keys(r.files||{}),function(e){var i,n=r.files[e];if(t.isArray(n)&&n.length>1)for(i=0;i<n.length;++i){var s=i?e+i:e;u.append(s,n[i])}else n&&u.append(e,n)}),t.extend(r,{"data":u,"contentType":!1,"url":c()})}else"update"!==e&&"patch"!==e||(s.debug("Updating {0} ({1}).",s.getObjectName(this),this.cid)&&console.log(s.last),e="update",a={"body":JSON.stringify(a)},t.extend(r,{"data":i.param(a),"contentType":"application/x-www-form-urlencoded","url":c()}));return n.sync(e,o,r)}};return o.Uploadable=t.clone(o),o}return s=s(e.id),o}),csui.define("csui/models/mixins/versions/v2.versions.response.mixin",["csui/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeVersionableV2Response":function(e){return this},"parseVersionsResponse":function(e){return e.results&&e.results.data?e.results.data.versions:e}})}}}),csui.define("csui/models/server.adaptors/version.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"url":function(){var e=t.combine(this.connector.getConnectionUrl().getApiBase("v2"),"nodes",this.get("id"),"versions");if(!this.isNew()){e=t.combine(e,this.get("version_number"));var i=t.combineQueryString(this.getExpandableResourcesUrlQuery());i&&(e+="?"+i)}return e},"parse":function(t){var i=t.data||this.parseVersionsResponse(t);if(i.id_expand&&i.id_expand.type&&(i.type=i.id_expand.type),i.version_number_name&&(i.version_number_name_formatted=i.version_number_name),i.commands){var n=i.commands;i.actions=e.chain(n).keys().map(function(e){var t=n[e];return t.signature=e,t}).value(),delete i.commands,delete i.commands_map,delete i.commands_order}return i}})}}}),csui.define("csui/models/version",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/url","csui/models/actions","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/versions/v2.versions.response.mixin","csui/models/server.adaptors/version.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n,s,o,r,c,a,u,l){"use strict";var d=i.Model.extend({"idAttribute":"version_number","constructor":function(e,n){e||(e={}),n=t.extend({"expand":["user","versions{id, owner_id}"]},n),i.Model.prototype.constructor.call(this,e,n),this.makeResource(n).makeUploadable(n).makeVersionableV2Response(n).makeExpandable(n).makeServerAdaptor(n),e.actions||(this.actions=new o)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector,"expand":t.deepClone(this.expand)})},"set":function(e,t,n){var s;return null==e?this:("object"==typeof e?(s=e,n=t):(s={})[e]=t,n||(n={}),s.actions&&(this.actions?this.actions.reset(s.actions,n):this.actions=new o(s.actions)),i.Model.prototype.set.call(this,s,n))},"isNew":function(){return!this.has("version_number")},"isFetchable":function(){return!(!this.get("id")||!this.get("version_number"))}});return r.mixin(d.prototype),a.mixin(d.prototype),c.mixin(d.prototype),u.mixin(d.prototype),l.mixin(d.prototype),d}),csui.define("csui/models/widget/widget.model",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log","csui/models/server.module/server.module.collection","csui/models/tool.item.config/tool.item.config.collection","csui/models/tool.item.mask/tool.item.mask.collection"],function(e,t,i,n,s,o,r,c,a){"use strict";o=o(t.id);var u=s.Model.extend({"defaults":{"id":null,"view":null,"manifest":null,"error":null},"constructor":function e(t,n){this.options=i.defaults({},n,{"includeView":!0,"includeManifest":!0,"includeServerModule":!0,"includeToolItems":!0}),this.options.includeToolItems&&(this.options.includeManifest=!0),e.__super__.constructor.call(this,t,this.options),this.serverModule=new r.prototype.model,this.actions=new s.Collection},"getDefaultData":function(){var e=this.get("manifest");return e?this._getDefaultPropertyValue(e.schema):{}},"_getDefaultPropertyValue":function(e){if(e)return"object"===e.type?i.reduce(e.properties,function(e,t,i){return e[i]=this._getDefaultPropertyValue(t),e},{},this):e.default},"_getDefaultPrimitiveValue":function(e){if(e){var t=e.default;if(void 0!==t)return t;switch(e.type){case"string":return"";case"integer":case"number":return 0;case"boolean":return!1;case"array":return[];case"null":return null}}},"sync":function(e,t,s){if("read"!==e)throw new Error("Only fetching the widget is supported.");s=i.extend({},this.options,s),i.defaults(s,{"includeView":this.options.includeView,"includeManifest":this.options.includeManifest,"includeServerModule":this.options.includeServerModule,"includeToolItems":this.options.includeToolItems}),s.includeToolItems&&(s.includeManifest=!0);var o=this._resolveServerModules(s),r=this._resolveToolItems(s),c=this._resolveToolItemMasks(s),a=this;return n.when(o,r,c).then(i.bind(this._resolveWidget,this,s)).then(function(){var e=a.toJSON();s.success&&s.success(e,s),a.trigger("sync",a,e,s)},function(){var e=a.get("error");return s.error&&s.error(e,s),a.trigger("error",a,e,s),n.Deferred().reject(e)})},"_resolveWidget":function(e){var t=this._resolveView(e),i=this._resolveManifest(e),s=this;return n.when(t,i).then(function(){s._updateServerModule(e),s._updateActions(e)})},"_resolveView":function(t){var i=n.Deferred();if(t.includeView){var s=this,o=this.getModuleData(),r=this.getViewModulePath(o);e([r],function(e){s.set("view",e),i.resolve()},function(e){s.set("error",e),t.ignoreErrors?i.resolve():i.reject(e)})}else i.resolve();return i.promise()},"_resolveManifest":function(t){var i=n.Deferred();if(t.includeManifest){var s=this,o=this.getModuleData(),r=this.getManifestModulePath(o);e([r],function(n){if(s._needsLocalization(n)){var c=s.getLocalizedManifestModulePath(o);e([c],function(e){n=u.resolveLocalizedManifest(r,n,e),s.set("manifest",n),i.resolve()},function(e){s.has("error")||s.set("error",e),t.ignoreErrors||t.ignoreManifestErrors?(s.set("manifest",n),i.resolve()):i.reject(e)})}else s.set("manifest",n),i.resolve()},function(e){s.has("error")||s.set("error",e),t.ignoreErrors||t.ignoreManifestErrors?(s.set("manifest",{}),i.resolve()):i.reject(e)})}else i.resolve();return i.promise()},"_resolveServerModules":function(e){var t;return e.includeServerModule&&!e.serverModules?(e.serverModules=t=new r,t.fetch({"ignoreErrors":e.ignoreErrors})):n.Deferred().resolve().promise()},"_resolveToolItems":function(e){var t;return e.includeToolItems&&!e.toolItems?(e.toolItems=t=new c,t.fetch({"ignoreErrors":e.ignoreErrors})):n.Deferred().resolve().promise()},"_resolveToolItemMasks":function(e){var t;return e.includeToolItems&&!e.toolItemMasks?(e.toolItemMasks=t=new a,t.fetch({"ignoreErrors":e.ignoreErrors})):n.Deferred().resolve().promise()},"_getModulePrefix":function(){var e=this.get("id"),t=e.indexOf("/");return t<0?"csui":e.substring(0,t)},"getModuleData":function(){var e,t=this.get("id"),i=t.lastIndexOf("/");return i<0?e="csui/widgets/"+t:(e=t,t=t.substring(i+1)),{"name":t,"path":e}},"getViewModulePath":function(e){return e.path+"/"+e.name+".view"},"getManifestModulePath":function(e){return"json!"+e.path+"/"+e.name+".manifest.json"},"getLocalizedManifestModulePath":function(e){return"i18n!"+e.path+"/impl/nls/"+e.name+".manifest"},"_updateServerModule":function(e){if(e.includeServerModule){var t=this._getModulePrefix(),i=e.serverModules.get(t),n=i&&i.toJSON()||{"id":t};this.serverModule.set(n)}},"_updateActions":function(e){if(e.includeToolItems){var t=this.get("manifest"),i=t&&t.actions;this.actions.reset(i,{"silent":!0}),this.actions.each(function(t){t.toolItems=e.toolItems.get(t.get("toolItems")),t.toolItemMasks=e.toolItemMasks.get(t.get("toolItemMasks")),t.toolbars=new s.Collection(t.get("toolbars"))}),e.silent||this.actions.trigger("reset",this.actions,e)}},"_needsLocalization":function(e){function t(e){return"string"==typeof e&&0===e.indexOf("{{")&&e.lastIndexOf("}}")===e.length-2}var n;for(var s in e)if(e.hasOwnProperty(s)){if(n=e[s],t(n))return!0;if(i.isArray(n)){for(var o=0;o<n.length;o++)if(t(n[o]))return!0}else if("object"==typeof n)return this._needsLocalization(n)}}},{"resolveLocalizedManifest":function(e,t,n){function s(t,n){function r(e){return i.isString(e)&&0===e.indexOf("{{")&&e.lastIndexOf("}}")===e.length-2&&e.substring(2,e.length-2)}var c,a,u,l,d,m;for(c in t)if(t.hasOwnProperty(c))if(a=t[c],u=r(a))t[c]=n[u]||n[c]||a;else if(i.isArray(a))for(d=n[c]||[],m=0;m<a.length;++m)l=a[m],u=r(l),u?a[m]=d[m]||n[u]||n[c]||l:i.isObject(l)&&(a[m]=s(l,d[m]||n));else i.isObject(a)&&(n[c]&&o.warn('Hierarchical format has been detected in the localization module "{0}". It has been deprecated and the support for it will be removed. Please, change it to the flat format as soon as possible. Although JSON format allows using nested objects, automated translation tools can handle only key-value pairs. That is why localization modules has to contain only one object with properties pointing to strings.',e)&&console.log(o.last),t[c]=s(a,n[c]||n));return t}return s(t,n)}});return u}),csui.define("csui/models/widget/widget.collection",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/widget/widget.model","csui/models/server.module/server.module.collection","csui/models/tool.item.config/tool.item.config.collection","csui/models/tool.item.mask/tool.item.mask.collection"],function(e,t,i,n,s,o,r,c,a){"use strict";var u=t.config().widgets||[];i.isArray(u)||(u=Array.prototype.concat.apply([],i.values(u))),u=i.map(u,function(e){return{"id":e}});var l=s.Collection.extend({"model":o,"constructor":function e(t,n){this.options=i.defaults({},n,{"includeView":!0,"includeManifest":!0,"includeServerModule":!0,"includeToolItems":!0}),this.options.includeToolItems&&(this.options.includeManifest=!0),t||(t=u),e.__super__.constructor.call(this,t,n)},"sync":function(e,t,s){if("read"!==e)throw new Error("Only fetching the widgets is supported.");var o=this;s=i.extend({},this.options,s),s.includeToolItems&&(s.includeManifest=!0);var r=this._resolveServerModules(s),c=this._resolveToolItems(s),a=this._resolveToolItemMasks(s);return n.when(r,c,a).then(i.bind(this._resolveWidgets,this,s)).then(function(){var e=o.toJSON();s.success&&s.success(e,s),o.trigger("sync",o,e,s)})},"_prepareModel":function(e,t){return t||(t={}),i.defaults(t,{"includeView":this.options.includeView,"includeManifest":this.options.includeManifest,"includeServerModule":this.options.includeServerModule,"includeToolItems":this.options.includeToolItems}),l.__super__._prepareModel.call(this,e,t)},"_resolveServerModules":function(e){var t=e.serverModules;return t||!e.includeServerModule?n.Deferred().resolve().promise():(t=e.serverModules=new r,t.fetch({"ignoreErrors":!1!==e.ignoreErrors}))},"_resolveToolItems":function(e){var t=e.toolItems;return t||!e.includeToolItems?n.Deferred().resolve().promise():(t=e.toolItems=new c,t.fetch({"ignoreErrors":!1!==e.ignoreErrors}))},"_resolveToolItemMasks":function(e){var t=e.toolItemMasks;return t||!e.includeToolItems?n.Deferred().resolve().promise():(t=e.toolItemMasks=new a,t.fetch({"ignoreErrors":!1!==e.ignoreErrors}))},"_resolveWidgets":function(e){var t=this.filter(function(e){return e.has("id")&&!(e.has("view")||e.has("manifest")||e.has("error"))}),s=i.invoke(t,"fetch",{"ignoreErrors":!1!==e.ignoreErrors,"ignoreManifestErrors":!1!==e.ignoreManifestErrors,"includeView":e.includeView,"includeManifest":e.includeManifest,"includeServerModule":e.includeServerModule,"includeToolItems":e.includeToolItems,"serverModules":e.serverModules,"toolItems":e.toolItems,"toolItemMasks":e.toolItemMasks});return n.when.apply(n,s)}});return l}),csui.define("csui/models/zipanddownload/zipanddownload.preflight",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin"],function(e,t,i,n,s,o,r){"use strict";var c=(t.extend({"idAttribute":null},e.config()),n.Model.extend({"constructor":function(e,t){e||(e={}),t||(t={}),this.options=t,n.Model.prototype.constructor.call(this,e,t),this.options.connector=t.collection&&t.collection.connector||t.container&&t.container.connector||t.nodes.models&&t.nodes.models[0].connector,this.makeConnectable(t).makeUploadable(t)},"urlBase":function(){var e=this.options.connector.getConnectionUrl().getApiBase("v2");return e=s.combine(e,"zipanddownload"),e=this.preflight?s.combine(e,"preflight",""):s.combine(e,"")},"url":function(){var e=this.urlBase();return e},"parse":function(e,t){return e}}));return o.mixin(c.prototype),r.mixin(c.prototype),c}),csui.define("csui/models/zipanddownload/zipanddownload.stages",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin"],function(e,t,i,n,s){"use strict";var o=i.Model.extend({"constructor":function(e,t){this.options=t||(t={}),i.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(t)},"url":function(){var e=this.options.connector.getConnectionUrl().getApiBase("v2");return n.combine(e,"zipanddownload",this.get("id"))},"parse":function(e){return this.updateLocation(e.results.data.jobs),e.results.data.jobs},"updateLocation":function(t){t.complete&&t.unprocessed_items_list&&t.unprocessed_items_list.length>0&&e.each(t.unprocessed_items_list,function(e,t){if(e.path){var i=e.path.split("\\");i.length>0&&""!==i[i.length-1]?e.parentLocation=i[i.length-1]:i.length>0&&(e.parentLocation=i[i.length-2])}})}});return s.mixin(o.prototype),o}),csui.define("csui/utils/mime.types",["csui/lib/underscore"],function(e){"use strict";function t(e){if(!e||-1===e.indexOf("."))return"";var t="";switch(e.split(".").pop()){case"dwg":case"dxf":case"svf":t="drawing/dwg";break;case"jar":case"war":t="application/x-zip";break;case"XLS5":case"xlb":case"xlsx":t="application/vnd.ms-excel";break;case"pptx":case"ppt":t="application/vnd.ms-powerpoint";break;case"docx":case"doc":t="application/msword";break;case"vob":t="video/mpeg";break;case"odf":case"xsm":t="application/vnd.oasis.opendocument.formula"}return t}return{"getMimeType":t}}),csui.define("csui/utils/classic.nodes/classic.nodes",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/rules.matching/rules.matching.mixin","csui-ext!csui/utils/classic.nodes/classic.nodes"],function(e,t,i,n,s){"use strict";var o=t.Model.extend({"defaults":{"sequence":100,"url":null,"urlQuery":null,"force":!1},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(i)}});n.mixin(o.prototype);var r=t.Collection.extend({"model":o,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)},"findByNode":function(e,t){var i=this.find(function(t){return t.matchRules(e,t.attributes)});if(i)return{"url":this._getUrl(i,e,t),"forced":i.get("forced")}},"isForced":function(e,t){return this.some(function(t){return t.get("forced")&&t.matchRules(e,t.attributes)})},"isSupported":function(e,t){return this.some(function(t){return t.matchRules(e,t.attributes)})},"getUrl":function(e,t){var i=this.find(function(t){return t.matchRules(e,t.attributes)});if(i)return this._getUrl(i,e,t)},"_getUrl":function(e,t,n){var s=e.get("url");if(s)"string"==typeof s?s=this._replaceParameters(s,t.attributes):"function"==typeof s&&(s=s(t));else{var o=e.get("urlQuery");if(o){"string"==typeof o?o=this._replaceParameters(o,t.attributes):"function"==typeof o&&(o=o(t));var r=n&&n.connector||t.connector;s=r?new i(r.connection.url).getCgiScript():"",o=i.combineQueryString(o),s=i.appendQuery(s,o)}}return s},"_replaceParameters":function(t,i){for(var n,s,o,r,c=i.attributes,a=/{([^}]+)}/g;n=a.exec(t);)s=n[1].split("."),o=c,e.find(s,function(e){if(null==(o=o[e]))return o="",!0}),r=n.index,t=t.substring(0,r)+encodeURIComponent(o)+t.substring(r+n[0].length);return t}}),c=new r;return s&&c.add(e.flatten(s,!0)),c}),csui.define("csui/utils/authenticators/authenticators",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin","csui-ext!csui/utils/authenticators/authenticators"],function(e,t,i,n){"use strict";var s=t.Model.extend({"defaults":{"sequence":100,"authenticator":null},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(i)}});i.mixin(s.prototype);var o=t.Collection.extend({"model":s,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.call(this,e,i)},"findByConnection":function(e){var t=this.find(function(t){return t.matchRules(e,t.attributes)});return t&&t.get("authenticator")}}),r=new o;return n&&r.add(e.flatten(n,!0)),r}),csui.define("csui/utils/connector",["require","module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base","csui/utils/url","i18n","i18n!csui/utils/impl/nls/lang","csui/utils/authenticators/authenticators","csui/models/mixins/uploadable/uploadable.mixin","csui/lib/jquery.ajax-progress"],function(e,t,i,n,s,o,r,c,a,u,l,d){"use strict";function m(e){if(this.connection=e.connection,this.authenticator=e.authenticator,!this.authenticator){var t=l.findByConnection(this.connection);if(!t)throw new Error("No authenticator found. Load csui-extensions.json to enable built-in authenticators.");this.authenticator=new t}this.authenticator.connection=this.connection,this.authenticator.connectionTimeout=this.connectionTimeout,this.authenticationPending=!1,this.waitingRequests=[],this.restartRequests=[]}function h(e){if(e.connector){if(e.connector===this)return;throw new Error("Impossible to re-assign connector.")}return e.connector=this,p.call(this,e)}function p(e){var t=this,i=e.sync;return e.sync=function(e,s,o){function r(){M=!1;var r={"execute":i,"thisObj":s};t.extendAjaxOptions(o,r);var c=n.clone(o);n.extend(r,{"options":c,"deferred":o.deferred,"executeOptionsArray":[e,s,n.extend(c,{"restartRequest":!0})]});var a=o.deferred,u=i.call(s,e,s,o).progress(a.notify).done(a.resolve).fail(function(e,t,i){M||401===e.status||a.reject(e,t,i)});return g(a.promise(),u)}return v.call(t,r)},this}function f(){return new c(this.connection.url)}function g(e,t){return e.abort=function(){return t.abort&&t.abort(),this},e}function v(e){if(this.authenticator.isAuthenticated())return e();var t={"execute":e,"deferred":i.Deferred()};this.waitingRequests.push(t);var n=this;return A.call(this,function(){w.call(n)},function(e){S.call(n),T(e)}),t.deferred.promise()}function b(e,t){e.headers||(e.headers={}),n.extend(e.headers,this.connection.headers),n.extend(e.headers,{"Accept-Language":a.settings.locale}),this.authenticator.setAuthenticationHeaders(e.headers),e.timeout=this.connectionTimeout,e.deferred=i.Deferred();var s,c=this,l=e.beforeSend;e.beforeSend=function(t,i){e.request=t,t.settings=i,c.reportSending&&c.reportSending(t,i),l&&l(t,i),e.progress({"lengthComputable":!1,"beforeSend":!0})};var d=e.progress;e.progress=function(t){c.reportProgress&&c.reportProgress(t,e.request),d&&d(t),e.deferred.notify(t,e.request)};var m=e.success;e.success=function(e,t,i){c.authenticator.updateAuthenticatedSession(i),c._succeeded=!0,c.reportSuccess&&c.reportSuccess(i),m&&m(e,t,i)};var h=e.error;return e.error=function(a,l,d){function m(){if(!c.confirmingReload){c.confirmingReload=!0;var e=new r.RequestErrorMessage(a),t=c._succeeded?u.SessionExpiredDialogTitle:u.AuthenticationFailureDialogTitle;o.warn(e)&&console.warn(o.last),csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showWarning(u.AuthenticationFailureDialogText,t,{"buttons":e.buttons.Ok}).always(function(){c.authenticator.unauthenticate({"reason":"failed"})})})}}if(!M)if(401==a.status)if(t||e.restartDeferred){var p=t||{"options":s,"deferred":e.restartDeferred||e.deferred,"execute":i.ajax,"thisObj":void 0,"executeOptionsArray":[n.extend(s,{"restartRequest":!0})]};c.restartRequests.push(p),c.reauthenticatingInitiated||(c.reauthenticatingInitiated=!0,c.authenticator.unauthenticate({"reason":"expired"}),c.authenticator.authenticate(function(){c.reauthenticatingInitiated=!1,C.call(c)},function(e){c.restartRequests=[],m()}))}else m();else!function(){409==a.status&&O(a),c.reportError&&c.reportError(a),h&&h(a,l,d)}()},s=n.clone(e),e}function y(e){return e=JSON.stringify(e),d.useJSON||d.mock?e:{"body":e}}function x(){return d.useJSON||d.mock?"application/json":"application/x-www-form-urlencoded"}function _(e){function t(){e=r.extendAjaxOptions(e);var t=i.Deferred();n.extend(e,{"restartDeferred":t});var s=i.ajax(e).progress(t.notify).done(t.resolve).fail(function(e,i,n){401!==e.status&&(M||t.reject(e,i,n))});return g(t.promise(),s)}var s=e.method||e.type||"GET",o=e.data,r=this;if(o)if("GET"===s){"string"!=typeof o&&(o=i.param(o,!0));var c=e.url||location.href;c+=c.indexOf("?")>=0?"&":"?",c+=o,delete e.data}else{var a=e.contentType;o instanceof FormData?(void 0===a&&(e.contentType=!1),e.processData=!1):("string"!=typeof o&&(e.data=y(o)),void 0===a&&(e.contentType=x()))}return v.call(this,t)}function C(){var e=this,t=this.restartRequests.slice(0);this.restartRequests=[],n.each(t,function(t){e.authenticator.setAuthenticationHeaders(t.options.headers),t.execute.apply(t.thisObj,t.executeOptionsArray).progress(t.deferred.notify).done(t.deferred.resolve).fail(function(e,i,n){M||t.deferred.reject(e,i,n)})})}function w(){var e=this.waitingRequests.slice(0);this.waitingRequests=[],n.each(e,function(e){e.execute().progress(e.deferred.notify).done(e.deferred.resolve).fail(function(t,i,n){M||e.deferred.reject(t,i,n)})})}function S(){var e=this.waitingRequests.slice(0);this.waitingRequests=[],n.each(e,function(e){e.deferred.reject()})}function A(e,t){if(!this.authenticationPending){this.authenticationPending=!0;var i=this;this.authenticator.authenticate(function(){i.authenticationPending=!1,e()},function(e){i.authenticationPending=!1,t(e)})}}function E(e,t){e&&t&&o.debug("Sending request as {0} to {1}.",t.type,t.url)&&console.log(o.last)}function R(e,t){var i=e.lengthComputable?n.str.sformat("{0} from {1} bytes transferred",e.loaded,e.total):e.beforeSend?"connection opened":"no information";o.debug("Progress of {0} from {1}: {2}.",t.settings.type,t.settings.url,i)&&console.log(o.last)}function k(e){e&&e.settings&&o.debug("Receiving response for {0} from {1}.",e.settings.type,e.settings.url)&&console.log(o.last)}function T(e,t){t||(e instanceof Error?(t=e,e=void 0):t=new r.RequestErrorMessage(e)),e&&e.settings&&o.warn("{0} request to {1} failed:",e.settings.type,e.settings.url)&&console.warn(o.last),o.warn(t)&&console.warn(o.last),r.MessageHelper.addMessage(t.toString())}function I(e){var t=r.isBackbone(e)?e.attributes:e,s=c.combine(this.connection.url,"contentauth?id="+t.id),o=n.extend({"Accept-Language":a.settings.locale},this.connection.headers);return this.authenticator.setAuthenticationHeaders(o),i.ajax({"type":"GET","url":s,"headers":o,"timeout":this.connectionTimeout,"context":this,"beforeSend":n.bind(function(e,t){e.settings=t,this.reportSending&&this.reportSending(e,t)},this),"success":n.bind(function(e,t,i){this.authenticator.updateAuthenticatedSession(i),this.reportSuccess&&this.reportSuccess(i)},this),"error":n.bind(function(e,t,i){this.reportError&&this.reportError(e)},this)})}function O(e){if(e.responseText)try{e.responseJSON=JSON.parse(e.responseText)}catch(e){o.warn("Parsing error response failed: {0}.",e)&&console.warn(o.last)}if(e.responseJSON){var t=e.responseJSON;t.error=u.resourceConflict,e.responseText=JSON.stringify(t)}}var N=n.extend({"connectionTimeout":void 0},t.config()),M=!1;return i(window).on("beforeunload."+t.id,function(e){M=!0}),n.extend(m.prototype,s.Events,{"constructor":m,"assignTo":h,"getConnectionUrl":f,"extendAjaxOptions":b,"extendFetchOptions":b,"formatAjaxData":y,"getAjaxContentType":x,"makeAjaxCall":_,"reportSending":E,"reportProgress":R,"reportSuccess":k,"reportError":T,"requestContentAuthToken":I,"connectionTimeout":N.connectionTimeout,"authenticate":A}),m}),csui.define("csui/utils/defaultactionitems",["csui/lib/underscore","csui/models/actionitems","csui-ext!csui/utils/defaultactionitems"],function(e,t,i){"use strict";var n=new t;return i&&n.add(e.flatten(i,!0)),n}),csui.define("csui/utils/authenticators/authenticator",["csui/lib/underscore","csui/lib/backbone"],function(e,t){"use strict";function i(e){this.connection=e&&e.connection||{}}return e.extend(i.prototype,t.Events,{"authenticate":function(e,t,i){if("function"==typeof e&&(i=t,t=e,e=void 0),e||(e={}),this.syncStorage(e.session),this.doAuthenticate(e,t,i))return this;if(this.isAuthenticated())t&&t(this.connection);else{var n=new Error("Missing authentication parameters.");if(!i)throw n;i(n,this.connection)}return this},"setUserId":function(e){this.userId=e},"getUserId":function(){return this.userId},"doAuthenticate":function(e){},"unauthenticate":function(e){return this},"isAuthenticated":function(){return!1},"syncStorage":function(e){return this},"setAuthenticationHeaders":function(e){},"updateAuthenticatedSession":function(e){}}),i.extend=t.View.extend,i}),csui.define("csui/utils/authenticators/ticket.authenticator",["module","csui/lib/underscore","csui/utils/authenticators/authenticator","csui/utils/namedsessionstorage"],function(e,t,i,n){"use strict";var s=window.csui.requirejs.s.contexts._.config.config["csui/utils/authenticator"]||{};s=t.extend({"rememberTicket":!0,"ticketHeader":"OTCSTicket","ticketExpirationHeader":"OTCSTicketExpires"},s,e.config()),s.ticketHeader=s.ticketHeader.toLowerCase(),s.ticketExpirationHeader=s.ticketExpirationHeader.toLowerCase();var o=new n(e.id);return i.extend({"constructor":function(e){i.prototype.constructor.call(this,e)},"unauthenticate":function(e){return this.connection.session=void 0,s.rememberTicket&&o.remove(this.connection.url),this.trigger("loggedOut",{"sender":this,"connection":this.connection,"reason":e&&e.reason}),this},"isAuthenticated":function(){var e=this.connection.session;return!(!e||!e.ticket)},"syncStorage":function(e){return e||(e=this.connection.session),!e&&s.rememberTicket&&(e=o.get(this.connection.url)),e&&(this.connection.session||(this.connection.session={}),t.extend(this.connection.session,e)),this},"setAuthenticationHeaders":function(e){var t=this.connection.session,i=t&&t.ticket;if(i)return e[s.ticketHeader]=i,!0},"updateAuthenticatedSession":function(e,i){e||(e={}),!i&&e.getResponseHeader&&(i=e,e={});var n=e.ticket||i&&i.getResponseHeader(s.ticketHeader);if(n){var r=this.connection.session||(this.connection.session={});t.extend(r,{"ticket":n,"expires":e.expires||i&&i.getResponseHeader(s.ticketExpirationHeader)}),s.rememberTicket&&o.set(this.connection.url,r)}}})}),csui.define("csui/utils/authenticators/request.authenticator",["module","csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/url","csui/utils/log","csui/models/mixins/uploadable/uploadable.mixin","csui/utils/authenticators/ticket.authenticator","csui/lib/jquery.parse.param"],function(e,t,i,n,s,o,r,c){"use strict";var a=window.csui.requirejs.s.contexts._.config.config["csui/utils/requestauthenticator"]||{};return a=i.extend({"connectionTimeout":6e4},a,e.config()),c.extend({"constructor":function(e){c.prototype.constructor.call(this,e)},"login":function(e,t,i){delete this.connection.session,o.debug("Sending authentication request to {0}.",this.connection.url)&&console.log(o.last);var n=this.prepareRequest(e);return this.updateRequestBody(n),this.makeRequest(n,t,i)},"prepareRequest":function(e){return e},"parseResponse":function(e,t){return e},"makeRequest":function(e,r,c){var a=i.extend({},this.connection.headers,e.headers);return t.ajax(i.extend({"url":s.combine(this.connection.url,"auth"),"timeout":this.connectionTimeout,"context":this,"beforeSend":function(e,t){e.settings=t},"success":function(e,t,i){o.debug("Receiving authentication response from {0}.",this.connection.url)&&console.log(o.last),e=this.parseResponse(e,i),this.authenticateSession(e,i)&&(r&&r.call(this,this.connection),this.trigger("loggedIn",{"sender":this,"connection":this.connection}))},"error":function(e){var t=new n.RequestErrorMessage(e);o.warn("Logging in to {0} failed:\r\n{1}",this.connection.url,t)&&console.warn(o.last),c&&c.call(this,t,this.connection)}},e,{"headers":a}))},"updateRequestBody":function(e){var i;r.useJSON||r.mock?"application/json"!==e.contentType&&(e.contentType="application/json",i=e.data,"string"==typeof i&&(i=t.parseParam(i)),r.mock?e.data=i:e.data=JSON.stringify(i),e.processData=!1):"application/json"===e.contentType&&(e.contentType="application/x-www-form-urlencoded",i=e.data,"string"==typeof i&&(e.data=JSON.parse(i)),r.mock&&(e.data=i),e.processData=!0)},"authenticateSession":function(e,t){return!e||!e.ticket||(t&&t.settings&&t.settings.data&&o.info("Logging in to {0} as {1} succeeded.",this.connection.url,t.settings.data.username)&&console.log(o.last),this.updateAuthenticatedSession(e,t),!0)},"unauthenticate":function(e){var t=this.isAuthenticated();return c.prototype.unauthenticate.apply(this,arguments),t&&this.trigger("loggedOut",{"sender":this,"connection":this.connection,"reason":e&&e.reason}),this},"connectionTimeout":a.connectionTimeout})}),csui.define("csui/utils/authenticators/server.adaptors/initial.header.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"prepareRequest":function(e){var i=e&&e.headers||this.connection.authenticationHeaders;return{"url":t.combine(this.connection.url,"auth"),"headers":i}}})}}}),csui.define("csui/utils/authenticators/initial.header.authenticator",["require","csui/utils/log","csui/utils/authenticators/request.authenticator","csui/utils/authenticators/server.adaptors/initial.header.mixin"],function(e,t,i,n){"use strict";var s=i.extend({"constructor":function(e){i.prototype.constructor.call(this,e),this.makeServerAdaptor(e)},"doAuthenticate":function(e,t,i){var n=e.headers||this.connection.authenticationHeaders,s=this;if(n)return this.connection.authenticationHeaders=n,
this.login({},t,function(e,t){s._reportError(e),s.unauthenticate({"reason":"failed"}),i&&i(e,t)}),!0},"authenticateSession":function(e,i){if(e&&e.data)return t.info("Logging in to {0} as {1} succeeded.",this.connection.url,e.data.name)&&console.log(t.last),this.updateAuthenticatedSession(i),!0},"_reportError":function(e){csui.require(["csui/dialogs/modal.alert/modal.alert"],function(t){t.showError(e.toString())})}});return n.mixin(s.prototype),s}),csui.define("csui/utils/headerauthenticator",["csui/utils/authenticators/initial.header.authenticator"],function(e){"use strict";return e}),csui.define("csui/utils/authenticators/interactive.credentials.authenticator",["require","module","csui/lib/underscore","csui/utils/authenticators/request.authenticator"],function(e,t,i,n){"use strict";return n.extend({"interactive":!0,"constructor":function(e){n.prototype.constructor.call(this,e)},"authenticate":function(e,t,s){"function"==typeof e&&(t,t=e,e=void 0),n.prototype.authenticate.call(this,e,t,i.bind(this.openSignInDialog,this,t))},"openSignInDialog":function(e){if(!this.reauthenticating){var t=this;t.reauthenticating=!0,csui.require(["csui/utils/impl/signin.dialog/signin.dialog","csui/controls/progressblocker/blocker"],function(i,n){var s=new i({"connection":t.connection});n.suppressAll(),s.show().done(function(i){t.connection.session=i.session,t.reauthenticating=!1,n.resumeAll(),e(t.connection)})})}}})}),csui.define("csui/utils/interactiveauthenticator",["csui/utils/authenticators/interactive.credentials.authenticator"],function(e){"use strict";return e}),csui.define("csui/utils/node.info.sprites",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/utils/node.info.sprites"],function(e,t,i){var n=t.Model.extend({"defaults":{"sequence":100},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}}),s=t.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)}}),o=new s;return i&&o.add(e.flatten(i,!0)),o}),csui.define("csui/utils/page.leaving.blocker",["module","csui/lib/jquery"],function(e,t){function i(){n||(n=!0,t(window).on("beforeunload."+e.id,function(e){if(r.isEnabled()){var t=o[0];return e&&(e.originalEvent.returnValue=t),t}}))}var n,s,o=[],r={"isEnabled":function(){return!s&&o.length},"enable":function(e){o.unshift(e),i()},"disable":function(){o.shift()},"forceDisable":function(){s=!0}};return r}),csui.define("csui/utils/requestauthenticator",["csui/utils/authenticators/request.authenticator"],function(e){"use strict";return e}),csui.define("csui/utils/smart.nodes/smart.nodes",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin","csui-ext!csui/utils/smart.nodes/smart.nodes"],function(e,t,i,n){"use strict";var s=t.Model.extend({"defaults":{"sequence":100},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(i)}});i.mixin(s.prototype);var o=t.Collection.extend({"model":s,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)},"isSupported":function(e,t){return this.some(function(t){return t.matchRules(e,t.attributes)})}}),r=new o;return n&&r.add(e.flatten(n,!0)),r}),csui.define("csui/utils/authenticators/server.adaptors/basic.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"prepareRequest":function(e){var i=e&&e.data||this.connection.credentials;return{"url":t.combine(this.connection.url,"auth"),"headers":{"authorization":this.formatAuthorizationHeader(i)}}}})}}}),csui.define("csui/utils/authenticators/basic.authenticator",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/utils/url","csui/utils/log","csui/utils/namedsessionstorage","csui/utils/authenticators/authenticator","csui/models/mixins/uploadable/uploadable.mixin","csui/utils/authenticators/server.adaptors/basic.mixin"],function(e,t,i,n,s,o,r,c,a,u){"use strict";var l=t.extend({"rememberCredentials":!0},e.config()),d=new r(e.id),m=c.extend({"constructor":function(e){c.prototype.constructor.call(this,e),this.credentials=e&&e.credentials,this.makeServerAdaptor(e)},"check":function(e,t,i){o.debug("Checking credentials with {0}.",this.connection.url)&&console.log(o.last);var n=this.prepareRequest(e);return this.makeRequest(n,t,i)},"prepareRequest":function(e){return e},"makeRequest":function(e,s,r){var c=t.extend({},this.connection.headers,e.headers);return i.ajax(t.extend({"timeout":this.connectionTimeout,"context":this,"beforeSend":function(e,t){e.settings=t},"success":function(t,i,n){o.debug("Receiving credentials-checking response from {0}.",this.connection.url)&&console.log(o.last),this.doAuthenticate(e),s&&s(this.connection),this.trigger("loggedIn",{"sender":this,"connection":this.connection})},"error":function(e){var t=new n.RequestErrorMessage(e);o.warn("Check credentials with {0} failed:\r\n{1}",this.connection.url,t)&&console.warn(o.last),r&&r(t,this.connection)}},e,{"headers":c}))},"doAuthenticate":function(e,t,i){var n=e.credentials||this.credentials||this.connection.credentials;n&&(this.connection.credentials=n,l.rememberCredentials&&d.set(this.connection.url,n))},"unauthenticate":function(e){var t=this.isAuthenticated();return this.connection.credentials=void 0,l.rememberCredentials&&d.remove(this.connection.url),t&&this.trigger("loggedOut",{"sender":this,"connection":this.connection,"reason":e&&e.reason}),this},"isAuthenticated":function(){return!!this.connection.credentials},"syncStorage":function(){return!this.connection.credentials&&l.rememberCredentials&&(this.connection.credentials=d.get(this.connection.url)),this},"setAuthenticationHeaders":function(e){e.authorization=this.formatAuthorizationHeader(this.connection.credentials)},"formatAuthorizationHeader":function(e){return"Basic "+btoa(unescape(encodeURIComponent(e.username+":"+e.password)))}});return u.mixin(m.prototype),m}),csui.define("csui/utils/authenticators/server.adaptors/credentials.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"prepareRequest":function(e){var i=e&&e.data||this.connection.credentials;return{"type":"POST","url":t.combine(this.connection.url,"auth"),"data":{"username":i.username,"password":i.password,"domain":""}}}})}}}),csui.define("csui/utils/authenticators/credentials.authenticator",["require","csui/utils/authenticators/request.authenticator","csui/utils/authenticators/server.adaptors/credentials.mixin"],function(e,t,i){"use strict";var n=t.extend({"constructor":function(e){t.prototype.constructor.call(this,e),this.credentials=e&&e.credentials,this.makeServerAdaptor(e)},"doAuthenticate":function(e,t,i){var n=e.credentials||this.credentials||this.connection.credentials,s=this;if(n)return this.connection.credentials=n,this.login({},t,function(e,t){s._reportError(e),s.unauthenticate({"reason":"failed"}),i&&i(e,t)}),!0},"_reportError":function(e){csui.require(["csui/dialogs/modal.alert/modal.alert"],function(t){t.showError(e.toString())})}});return i.mixin(n.prototype),n}),csui.define("csui/utils/authenticators/regular.header.authenticator",["module","csui/lib/underscore","csui/utils/log","csui/utils/authenticators/authenticator","csui/utils/namedsessionstorage"],function(e,t,i,n,s){"use strict";var o=t.extend({"rememberAuthenticationHeaders":!0},e.config()),r=new s(e.id);return n.extend({"constructor":function(e){n.prototype.constructor.call(this,e)},"doAuthenticate":function(e,t,i){var n=e.headers||this.connection.authenticationHeaders;n&&(this.connection.authenticationHeaders=n,o.rememberAuthenticationHeaders&&r.remove(this.connection.url))},"unauthenticate":function(e){return this.connection.authenticationHeaders=void 0,o.rememberAuthenticationHeaders&&r.remove(this.connection.url),this},"isAuthenticated":function(){return!!this.connection.authenticationHeaders},"syncStorage":function(){return!this.connection.authenticationHeaders&&o.rememberAuthenticationHeaders&&(this.connection.authenticationHeaders=r.get(this.connection.url)),this},"setAuthenticationHeaders":function(e){t.extend(e,this.connection.authenticationHeaders)}})}),csui.define("csui/utils/authenticators/redirecting.form.authenticator",["require","module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/authenticators/ticket.authenticator"],function(e,t,i,n,s,o){"use strict";var r=t.config(),c=r.authenticationIFrameTimeout||3e3;return o.extend({"interactive":!0,"constructor":function(e){o.prototype.constructor.call(this,e)},"authenticate":function(e,t,n){"function"==typeof e&&(n=t,t=e,e=void 0),o.prototype.authenticate.call(this,e,t,i.bind(this.initiateLoginSequence,this,t,n))},"initiateLoginSequence":function(e,t){function i(){r(),m&&m.destroy()}function o(){csui.require(["csui/controls/progressblocker/blocker"],function(e){e.suppressAll()})}function r(){csui.require(["csui/controls/progressblocker/blocker"],function(e){e.resumeAll()})}function a(t){if(t.origin===h&&t.data.ticket){s.debug("Redirecting Form Authenticator received new ticket.")&&console.log(s.last),window.removeEventListener("message",a,!1),d&&clearTimeout(d),d=void 0,i();(p.connection.session||(p.connection.session={})).ticket=t.data.ticket,e&&e(p.connection)}}function u(){d=setTimeout(l,c)}function l(){m&&(m.$el.removeClass("binf-hidden"),o())}var d,m,h,p=this;window.addEventListener("message",a,!1),function(){var e=n.Deferred();return csui.require(["csui/lib/marionette","csui/controls/dialog/dialog.view","csui/utils/url"],function(t,i,s){var o=s.appendQuery(new s(p.connection.url).getCgiScript(),"func=csui.ticket");o=s.appendQuery(o,"userid="+p.getUserId()),h=new s(p.connection.url).getOrigin();var r=new t.View({"el":n("<iframe>",{"width":"100%","height":"100%","src":o})});m=new i({"standardHeader":!1,"view":r,"fullSize":!0}),r.render(),m.show({"render":!1}),m.$el.css({"z-index":"1061"}),m.$el.addClass("binf-hidden"),e.resolve()},e.reject),e.promise()}().done(u)}})}),csui.define("csui/utils/authenticators/core.authenticators",["module","csui/lib/underscore","csui/utils/authenticators/ticket.authenticator","csui/utils/authenticators/basic.authenticator","csui/utils/authenticators/credentials.authenticator","csui/utils/authenticators/regular.header.authenticator","csui/utils/authenticators/initial.header.authenticator","csui/utils/authenticators/interactive.credentials.authenticator","csui/utils/authenticators/redirecting.form.authenticator"],function(e,t,i,n,s,o,r,c,a){"use strict";var u=window.csui.requirejs.s.contexts._.config.config["csui/utils/interactiveauthenticator"]||{},l=u.enabled,d=e.config();u=t.extend({"enableInteractiveAuthenticator":void 0===d.enableRedirectingFormAuthenticator&&!1!==l,"enableRedirectingFormAuthenticator":!1,"forceBasicAuthenticator":!1,"preferBasicAuthenticator":!1,"preferRegularHeaderAuthenticator":!1},d);var m=u.enableInteractiveAuthenticator?c:u.enableRedirectingFormAuthenticator?a:i;return[{"authenticator":n,"sequence":50,"decides":function(e){return u.forceBasicAuthenticator||e.credentials&&u.preferBasicAuthenticator}},{"authenticator":o,"sequence":50,"and":{"has":"authenticationHeaders","decides":function(){return u.preferRegularHeaderAuthentication}}},{"authenticator":s,"has":"credentials"},{"authenticator":r,"has":"authenticationHeaders"},{"sequence":1e3,"authenticator":m}]}),csui.define("csui/utils/authenticator",["csui/utils/authenticators/ticket.authenticator"],function(e){"use strict";return e}),csui.define("csui/utils/basicauthenticator",["csui/utils/authenticators/credentials.authenticator"],function(e){"use strict";return e}),csui.define("bundles/csui-models",["csui/models/action","csui/models/actions","csui/models/actionitem","csui/models/actionitems","csui/models/addabletype","csui/models/addabletypes","csui/models/ancestor","csui/models/ancestors","csui/models/authenticated.user","csui/models/authenticated.user.node.permission","csui/models/authentication","csui/models/clientsidecollection","csui/models/column","csui/models/columns","csui/models/datadefinition","csui/models/datadefinitions","csui/models/favorite2","csui/models/favorite2group","csui/models/favorite2groups","csui/models/favorites2","csui/models/favorite2column","csui/models/favorite2columns","csui/models/favorite.model","csui/models/member","csui/models/member/member.model","csui/models/member/membercollection","csui/models/members","csui/models/node/node.addable.type.collection","csui/models/node/node.model","csui/models/node.children2/node.children2","csui/models/node.columns2","csui/models/nodeancestors","csui/models/nodechildrencolumn","csui/models/nodechildrencolumns","csui/models/nodechildren","csui/models/node.actions","csui/models/nodes","csui/models/permission/nodepermission.model","csui/models/permission/nodeuserpermissions","csui/models/tool.item.config/tool.item.config.collection","csui/models/tool.item.mask/tool.item.mask.collection","csui/models/server.module/server.module.collection","csui/models/specificnodemodel","csui/models/view.state.model","csui/models/perspective/personalization.model","csui/models/browsable/browsable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v1.response.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/appcontainer/appcontainer.mixin","csui/models/mixins/autofetchable/autofetchable.mixin","csui/models/mixins/commandable/commandable.mixin","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","csui/models/mixins/node.autofetchable/node.autofetchable.mixin","csui/models/mixins/node.connectable/node.connectable.mixin","csui/models/mixins/node.resource/node.resource.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/rules.matching/rules.matching.mixin","csui/models/mixins/state.carrier/state.carrier.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.commandable/v2.commandable.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/autofetchable","csui/models/connectable","csui/models/fetchable","csui/models/including.additional.resources","csui/models/nodeautofetchable","csui/models/nodeconnectable","csui/models/noderesource","csui/models/resource","csui/models/uploadable","csui/models/utils/v1tov2","csui/models/version","csui/models/version","csui/models/version","csui/models/widget/widget.collection","csui/models/widget/widget.model","csui/models/zipanddownload/zipanddownload.preflight","csui/models/zipanddownload/zipanddownload.stages","i18n!csui/models/impl/nls/lang","csui/utils/base","csui/utils/mime.types","csui/utils/classic.nodes/classic.nodes","csui/utils/connector","csui/utils/defaultactionitems","csui/utils/promoted.actionitems","csui/utils/deepClone/deepClone","csui/utils/errormessage","csui/utils/headerauthenticator","csui/utils/interactiveauthenticator","csui/utils/log","csui/utils/messagehelper","csui/utils/namedlocalstorage","csui/utils/namedsessionstorage","csui/utils/namedstorage","csui/utils/nodesprites","csui/utils/node.info.sprites","i18n!csui/utils/impl/nls/lang","csui/utils/page.leaving.blocker","csui/utils/requestauthenticator","csui/utils/smart.nodes/smart.nodes","csui/utils/types/date","csui/utils/types/localizable","csui/utils/types/member","csui/utils/types/number","csui/utils/url","csui/utils/perspective/perspective.util","csui/utils/authenticators/authenticator","csui/utils/authenticators/authenticators","csui/utils/authenticators/basic.authenticator","csui/utils/authenticators/core.authenticators","csui/utils/authenticators/credentials.authenticator","csui/utils/authenticators/initial.header.authenticator","csui/utils/authenticators/interactive.credentials.authenticator","csui/utils/authenticators/regular.header.authenticator","csui/utils/authenticators/request.authenticator","csui/utils/authenticators/ticket.authenticator","csui/utils/authenticator","csui/utils/basicauthenticator","csui/utils/headerauthenticator","csui/utils/interactiveauthenticator","csui/utils/requestauthenticator","csui/models/authenticated.user/server.adaptor.mixin","csui/models/member/server.adaptor.mixin","csui/models/node/server.adaptor.mixin","csui/models/node.children/server.adaptor.mixin","csui/models/node.children2/server.adaptor.mixin","csui/utils/authenticators/server.adaptors/basic.mixin","csui/utils/authenticators/server.adaptors/credentials.mixin","csui/utils/authenticators/server.adaptors/initial.header.mixin"],{});
//# sourceMappingURL=csui-models.js.map