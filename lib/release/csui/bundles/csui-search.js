csui.define("csui/models/widget/search.results/facet.server.adaptor.mixin",["csui/lib/underscore","csui/utils/url","csui/models/node.facets/facet.query.mixin"],function(e,t,i){"use strict";function s(t,i){return e.map(t,function(t){var s=e.map(t.facet_items,function(e){return{"name":e.display_name,"total":e.count,"value":e.value,"selected":i}});return{"id":t.name,"name":t.display_name,"type":t.type,"topics":s,"items_to_show":5}})}return{"mixin":function(o){i.mixin(o);var n=o.sync;return e.extend(o,{"filterQueryParameterName":"filter","makeServerAdaptor":function(e){return this.makeFacetQuery(e)},"cacheId":"","url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2");return t.combine(e,"search")},"sync":function(t,i,s){var o=this.options.query.toJSON();return this.options.query.resetDefaults?(this.orderBy="",this.skipCount=0,this.options.query.resetDefaults=!1):(this.orderBy=this.orderBy&&this.previousQuery!==this.options.query.attributes.where?"":this.orderBy,this.skipCount=this.previousOrderBy!==this.orderBy?0:this.skipCount,this.topCount=this.options.topCount?this.options.topCount:10),e.extend(o,this.getFilterParam(this.filters)),e.extend(o,this.getBrowsableParams()),o.options="{'facets'}",(this.orderBy||this.pagination)&&this.cacheId&&(o.cache_id=this.cacheId,this.pagination=!1),e.extend(s,{"type":"POST","contentType":"application/x-www-form-urlencoded","data":o,"traditional":!0}),n.apply(this,arguments)},"parse":function(e,t){return e.results=e.featured?e.featured.concat(e.results):e.results,this.parseBrowsedState(e.collection,t),this._parseFacets(e.collection.searching.facets),e.results.sorting=e.collection.sorting,this.cacheId=e.collection&&e.collection.searching&&e.collection.searching.cache_id?e.collection.searching.cache_id:"",this.parseBrowsedItems(e,t)},"_parseFacets":function(e){var t;e&&(t=s(e.selected,!0).concat(s(e.available,!1))),this.reset(t)}})}}}),csui.define("csui/models/widget/search.results/search.facets",["csui/lib/underscore","csui/models/facets","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/models/widget/search.results/facet.server.adaptor.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,s,o,n,a){"use strict";var r=t.extend({"constructor":function(e,i){this.options=i||(i={}),t.prototype.constructor.apply(this,arguments),this.makeConnectable(i).makeFetchable(i).makeBrowsableV1Request(i).makeBrowsableV2Response(i).makeServerAdaptor(i)},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"skip":this.skipCount,"top":this.topCount,"filters":e.deepClone(this.filters)})},"isFetchable":function(){return!!this.options.query.get("where")||!!this.options.query.get("query_id")}});return o.mixin(r.prototype),n.mixin(r.prototype),i.mixin(r.prototype),s.mixin(r.prototype),a.mixin(r.prototype),r}),csui.define("csui/models/widget/search.results/object.to.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone"],function(e,t,i){"use strict";var s=i.Model.extend({"constructor":function(){i.Model.apply(this,arguments)}}),o=i.Collection.extend({"model":s,"constructor":function(){i.Collection.apply(this,arguments)},"isFetchable":!1}),n=["available","selected"];return function(e){return t.each(e,function(e){t.isObject(e)&&n.map(function(i){e[i]&&t.isArray(e[i])&&(e[i]=new o(e[i]))})}),e}}),csui.define("csui/widgets/search.custom/impl/form.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/controls/form/form.view"],function(e,t,i,s,o,n){return n.extend({"constructor":function(e){this.options=e||{},n.prototype.constructor.call(this,i.extend(e,{"custom":{"adjustHeight":!0}})),this.jQuery=t;var s=this;this.customFlatten=function(e,t,o){return i.isObject(e)?i.each(e,function(e,i){s.customFlatten(e,t,i)}):(/^(anydate|anyvalue)/i.test(e)&&(e=""),t[o]=e),t},this.customFilter=function(){var e=this,t=[],s=e.customFlatten(e.objectList(e.getValues()),{});return i.isObject(s)&&i.each(s,function(i,o){if(e.customEndsWith(o,"_DFrom")||e.customEndsWith(o,"_DFor")||e.customEndsWith(o,"_DTo")){var n=o.substr(0,o.lastIndexOf("_"));!i&&s[n]&&(s[n]="")}i&&t.push(i)}),t},this.customEndsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},this.objectList=function(e){var t=[];return i.each(e,function(e){i.isObject(e)&&t.push(e)}),i.flatten(t)},this.$el.on("keydown",function(e){if(13!==e.keyCode||"text"!==e.target.type&&"search"!==e.target.type||""===e.target.value.trim()){if(13===e.keyCode&&s.jQuery(".binf-dropdown-menu").parent(".binf-open").length>=1)e.stopImmediatePropagation();else if(13===e.keyCode)if(""===e.target.value){var i=s.customFilter();i&&0===i.length?s.options.customView.trigger("enable:search",!1):s.triggerSearch(e)}else s.options.customView.trigger("enable:search",!0)}else{if(t(e.target).is("input.typeahead")&&0!==t(e.target).siblings(".typeahead.scroll-container:visible").length)return;s.triggerSearch(e)}}),this.$el.on("keyup",function(e){if("text"===e.target.type)if(""===e.target.value){var t=s.customFilter();t&&0===t.length&&s.options.customView.trigger("enable:search",!1)}else s.options.customView.trigger("enable:search",!0)})},"triggerSearch":function(e){this.options.customView.trigger("trigger:search")},"updateRenderedForm":function(){return!1},"onRenderForm":function(){this.options.customView.triggerMethod("render:form")},"onChangeField":function(e){var t=this.customFilter();0===t.length?this.options.customView.trigger("enable:search",!1):this.options.customView.trigger("enable:search",!0),!window.event||13!==window.event.keyCode&&13!==window.event.which||(e.value?(this.options.customView.trigger("enable:search",!0),this.options.customView.triggerMethod("field:updated")):t&&0===t.length?this.options.customView.trigger("enable:search",!1):t&&0!==t.length&&this.options.customView.triggerMethod("field:updated"))}})}),csui.define("hbs!csui/widgets/search.custom/impl/customsearchform",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s,o,n){var a;return null!=(a=t.if.call(e,null!=e?e.isSetType:e,{"name":"if","hash":{},"fn":this.program(2,s,0,o,n),"inverse":this.program(4,s,0,o,n),"data":s}))?a:""},"2":function(e,t,i,s,o,n){var a;return'      <div class="binf-col-md-12 cs-form-singlecolumn cs-form-set"\r\n           id="csfSingleCol_'+this.escapeExpression(this.lambda(null!=n[2]?n[2].modelId:n[2],e))+this.escapeExpression((a=null!=(a=t.index||s&&s.index)?a:t.helperMissing,"function"==typeof a?a.call(e,{"name":"index","hash":{},"data":s}):a))+'"></div>\r\n'},"4":function(e,t,i,s,o,n){var a;return'      <div class="binf-col-md-12 cs-form-doublecolumn"\r\n           id="csfLeftCol_'+this.escapeExpression(this.lambda(null!=n[2]?n[2].modelId:n[2],e))+this.escapeExpression((a=null!=(a=t.index||s&&s.index)?a:t.helperMissing,"function"==typeof a?a.call(e,{"name":"index","hash":{},"data":s}):a))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s,o,n){var a;return'<div class="binf-row">\r\n'+(null!=(a=t.each.call(e,null!=e?e.fields:e,{"name":"each","hash":{},"fn":this.program(1,s,0,o,n),"inverse":this.noop,"data":s}))?a:"")+"</div>\r\n"},"useData":!0,"useDepths":!0});return i.registerPartial("csui_widgets_search.custom_impl_customsearchform",s),s}),csui.define("hbs!csui/widgets/search.custom/impl/customsearch.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-custom-search-formitems"></div>'}});return i.registerPartial("csui_widgets_search.custom_impl_customsearch.item",s),s}),csui.define("csui/widgets/search.custom/impl/search.customFormView",["csui/lib/marionette","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/widgets/search.custom/impl/form.view","hbs!csui/widgets/search.custom/impl/customsearchform","hbs!csui/widgets/search.custom/impl/customsearch.item"],function(e,t,i,s,o,n,a){return e.ItemView.extend({"tag":"div","className":"customsearch-attr-container","constructor":function(t){t||(t={}),this.options=t,e.ItemView.prototype.constructor.apply(this,arguments),this.model.on("error",this.errorHandle,this)},"template":a,"onRender":function(t){var i=new e.Region({"el":this.$el.find(".csui-custom-search-formitems")}),s=new o({"context":this.options.context,"model":this.model,"layoutMode":"singleCol","mode":"create","customView":this,"templateId":this.model.attributes.data.templateId});i.show(s),this.formView=s},"onRenderForm":function(){this.options.objectView.triggerMethod("render:form")}})}),csui.define("csui/widgets/search.custom/impl/search.customview.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/utils/url"],function(e,t,i,s,o,n){var a=i.Model.extend({"constructor":function(e,t){t||(t={}),i.Model.prototype.constructor.call(this,e,t),this.options=t,this.makeConnectable(t).makeFetchable(t)}});return s.mixin(a.prototype),o.mixin(a.prototype),e.extend(a.prototype,{"isFetchable":function(){return!!this.options},"url":function(){return n.combine(this.connector.connection.url,"nodes/"+this.options.nodeId+"/customviewsearchforms")},"parse":function(e,t){return e.name=e.text,e}}),a}),csui.define("csui/widgets/search.custom/impl/search.customview.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/widgets/search.custom/impl/search.customview.model"],function(e,t,i,s,o,n){return s.extend({"propertyPrefix":"customSearch","constructor":function(a,r){s.prototype.constructor.apply(this,arguments);var l=this.options.customSearch||{};if(!(l instanceof i.Model)){var c=a.getObject(o,r),h=e.config();l=new n(l.attributes||h.attributes,t.defaults({"connector":c,"nodeId":r.customQuery.nodeId},l.options,h.options))}this.property=l},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("csui/widgets/search.custom/impl/search.customquery.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/utils/url"],function(e,t,i,s,o,n){var a=i.Model.extend({"constructor":function(e,t){this.options=t||(t={}),i.Model.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t)}});return s.mixin(a.prototype),o.mixin(a.prototype),e.extend(a.prototype,{"isFetchable":function(){return this.options.node.isFetchable()},"url":function(){return n.combine(this.connector.connection.url,"searchqueries/"+this.get("id"))},"parse":function(e,t){return e.name=e.text,e}}),a}),csui.define("csui/widgets/search.custom/impl/search.customquery.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/widgets/search.custom/impl/search.customview.factory","csui/widgets/search.custom/impl/search.customquery.model","csui/utils/contexts/factories/connector"],function(e,t,i,s,o,n,a){return s.extend({"propertyPrefix":"customQuery","constructor":function(o,r){r||(r={}),s.prototype.constructor.apply(this,arguments);var l=this.options.customQuery||{};if(!(l instanceof i.Model)){var c=o.getObject(a,r),h=e.config();l=new n(r.attributes,t.extend({"connector":c},h.options,l.options))}this.property=l},"fetch":function(e){return this.property.fetch(this.options)}})}),csui.define("csui/widgets/search.custom/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.custom/impl/nls/root/lang",{"searchButtonMessage":"Search","title":"Custom View Search"}),csui.define("hbs!csui/widgets/search.custom/impl/customsearch.main",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o,n;return'  <div class="csui-saved-search-submit-container">\r\n    <button class="binf-btn binf-btn-primary csui-custom-search-form-submit"\r\n            id="'+this.escapeExpression((n=null!=(n=t.searchButton||(null!=e?e.searchButton:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchButton","hash":{}}):n))+'" value="Search"> '+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.search:o,e))+" </button>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="csui-saved-search-form" id="'+this.escapeExpression((n=null!=(n=t.searchFormId||(null!=e?e.searchFormId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchFormId","hash":{}}):n))+'"></div>\r\n'+(null!=(o=t.unless.call(e,null!=e?e.hideSearchButton:e,{"name":"unless","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("csui_widgets_search.custom_impl_customsearch.main",s),s}),csui.define("hbs!csui/widgets/search.custom/impl/error.template",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="csui-error-icon-div">\r\n  <div class="csui-error-icon-parent">\r\n    <div class="csui-error-icon notification_error"></div>\r\n  </div>\r\n</div>\r\n<div class="csui-suggestion">'+this.escapeExpression((o=null!=(o=t.errorMessage||(null!=e?e.errorMessage:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"errorMessage","hash":{}}):o))+"</div>"}});return i.registerPartial("csui_widgets_search.custom_impl_error.template",s),s}),csui.define("css!csui/widgets/search.custom/impl/search.custom",[],function(){}),csui.define("csui/widgets/search.custom/impl/search.object.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/widgets/search.custom/impl/search.customFormView","csui/controls/tile/behaviors/blocking.behavior","csui/utils/contexts/factories/search.query.factory","csui/widgets/search.custom/impl/search.customquery.factory","csui/models/mixins/fetchable/fetchable.mixin","i18n!csui/widgets/search.custom/impl/nls/lang","hbs!csui/widgets/search.custom/impl/customsearch.main","hbs!csui/widgets/search.custom/impl/error.template","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/contexts/factories/next.node","css!csui/widgets/search.custom/impl/search.custom.css"],function(e,t,i,s,o,n,a,r,l,c,h,d,u,m){return i.CompositeView.extend({"className":"csui-custom-view-search","templateHelpers":function(){return{"messages":{"search":c.searchButtonMessage},"hideSearchButton":!!this.options.hideSearchButton&&this.options.hideSearchButton,"searchFormId":this.searchFormId,"searchButton":e.uniqueId("csui-custom-search-form-submit")}},"behaviors":{"Blocking":{"behaviorClass":n},"PerfectScrolling":{"behaviorClass":u,"contentParent":".csui-custom-search-formitems","scrollYMarginOffset":15}},"constructor":function(s){if(s=s||{},s.data||(s.data={}),this.context=s.context,this.searchFormId=e.uniqueId("csui-saved-search-form"),this.jQuery=t,i.CompositeView.prototype.constructor.apply(this,arguments),!s.model){var o=s.data.savedSearchQueryId||s.savedSearchQueryId;this.model=s.context.getCollection(r,{"attributes":{"id":o}}),l.mixin(r)}this.listenTo(this.model,"sync",this.render),this.listenTo(this.model,"error",this.handleError),this.$el.on({"change input":e.bind(this._refreshDOM,this)})},"ui":function(){return{"searchFormId":"#"+this.searchFormId}},"_refreshDOM":function(){setTimeout(e.bind(function(){this.triggerMethod("dom:refresh")},this),500)},"template":h,"events":{"click .csui-custom-search-form-submit":"loadCustomSearch"},"onRender":function(t){if(this.model.attributes&&this.model.attributes.data){if(this.options.parentView)this.model.get("schema").title?this.options.parentView.options.title=this.model.get("schema").title:this.options.parentView.options.title=this.options.parentView.options.data&&this.options.parentView.options.data.title?this.options.parentView.options.data.title:this.options.parentView.options.title||c.title,this.trigger("change:title");else{var s=this.model.get("schema").title?this.model.get("schema").title:c.title;this.options.titleElement&&(this.options.titleElement.html(s),this.options.titleElement.attr("title",s))}this.options.customValues&&this.updateCustomSearch(this.options.customValues.updatedValues,this.options.customValues.attributes,this.model.get("data")),this.options.objectView=this;var n=new o(e.extend(this.options,{"model":this.model}));this.listenTo(n,"trigger:search",this._triggerSearch),this.listenTo(n,"enable:search",function(e){this._enableSearch(e)});new i.Region({"el":this.ui.searchFormId}).show(n),this.customFormView=n,this.options&&"function"==typeof this.blockActions&&this.blockActions();var a=e.filter(e.flatten(e.map(this.model.get("data"),e.values)),function(e){return e});a&&0===a.length?this._enableSearch(!1):this._enableSearch(!0)}},"handleError":function(){if(this.model.error&&this.model.error.message){this.options.parentView.options.title=this.options.parentView.options.data&&this.options.parentView.options.data.title?this.options.parentView.options.data.title:this.options.parentView.options.title||c.title,this.trigger("change:title"),this.ui.searchFormId.addClass("csui-custom-error");var e=d.call(this,{"errorMessage":this.model.error.message});this.ui.searchFormId.append(e),this.$el.find(".csui-saved-search-submit-container").addClass("binf-hidden")}},"_triggerSearch":function(){var e=this;setTimeout(function(t){e.jQuery(".csui-custom-search-form-submit").hasClass("binf-disabled")||e.loadCustomSearch()},50)},"_enableSearch":function(e){e?(this.jQuery(".csui-custom-search-form-submit").removeClass("binf-disabled").removeClass("csui-search-form-submit-disabled"),this.trigger("enable:search",!0)):(this.jQuery(".csui-custom-search-form-submit").addClass("binf-disabled").addClass("csui-search-form-submit-disabled"),this.trigger("enable:search",!1))},"onRenderForm":function(){this.$el.is(":visible")&&this._refreshDOM(),this.unblockActions(),this.options.parentView&&"function"==typeof this.options.parentView.unblockActions&&this.options.parentView.unblockActions()},"onFieldUpdated":function(){this.loadCustomSearch()},"updateCustomSearch":function(t,i,s){if(t)this.model.attributes.data=e.extend(this.model.attributes.data,t);else if(i){var o=i;e.each(s,function(t,i){t instanceof Object&&e.each(t,function(i,s){i instanceof Object?e.each(i,function(e,t){o[t]&&(i[t]=o[t],delete o[t])}):o[s]&&(t[s]=o[s],delete o[s])})}),e.each(o,function(t,i){if("query_id"!==i){var s=-1!==i.indexOf("__")?i.split("__"):void 0,o={};if(s){var n=-1!==s[0].indexOf("_")?i.split("_"):void 0;if(n){o[i]=t;var a=this.model.attributes.data[n[0]];a[s[0]]=e.extend(a[s[0]],o)}else o[i]=t,this.model.attributes.data[s[0]]=e.extend(this.model.attributes.data[s[0]],o)}else{var r=-1!==i.indexOf("_")?i.split("_"):void 0;o[i]=t,this.model.attributes.data[r[0]]=e.extend(this.model.attributes.data[r[0]],o)}}},this)}},"loadCustomSearch":function(){var t=this.customFormView.formView.customFilter();if(t&&0!==t.length){this.$(".csui-custom-search-form-submit").hasClass("binf-disabled")&&this._enableSearch(!0),this.updatedFormValues=this.customFormView.formView.getValues(),this.queryModel=this.options.query||this.context.getModel(a),this.nextNode=this.context.getModel(m),!this.options.query&&e.isEmpty(this.queryModel.attributes)&&e.isEmpty(this.nextNode.attributes)&&history.pushState({"search":{"name":void 0,"id":void 0}},"",location.href),this.queryModel.clear({"silent":!0}),this.queryModel.updatedValues=this.updatedFormValues;var i={};e.each(this.updatedFormValues,function(t){t instanceof Object&&e.each(t,function(t,s){t instanceof Object?e.each(t,function(e,t){i[t]=e}):i[s]=t})}),i.query_id=this.model.get("data").templateId,i.forcePerspectiveChange=this.options.showInSearchResultsNewPerspective,this.resetPageDefaults(),this.queryModel.set(i),this.trigger("click:search")}else this._enableSearch(!1)},"resetPageDefaults":function(){this.queryModel.resetDefaults=!0}})}),csui.define("csui/widgets/search.custom/search.custom.view",["csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/lib/jquery","csui/utils/base","csui/controls/tile/tile.view","csui/behaviors/default.action/default.action.behavior","csui/widgets/search.custom/impl/search.object.view","i18n!csui/widgets/search.custom/impl/nls/lang"],function(e,t,i,s,o,n,a,r,l){return n.extend({"constructor":function(t){t||(t={}),t.title=t.title||l.title,t.icon=t.titleBarIcon||"title-customviewsearch",this.context=t.context,n.prototype.constructor.call(this,t),t=t.data?e.extend(t,t.data):t,this.options=t,this.options.parentView=this,this.contentViewOptions=this.options},"contentView":r,"behaviors":{"DefaultAction":{"behaviorClass":a}},"onShow":function(){this.$el.find(".tile-title .csui-heading").html(""),this.listenTo(this.contentView,"change:title",this.updateTitle)},"updateTitle":function(){this.$el.find(".tile-title .csui-heading").html(o.escapeHtml(this.options.title)),this.$el.find(".tile-title").attr("title",this.options.title),this.$el.find(".tile-controls").attr("title",this.options.title)}})}),csui.define("csui/controls/settings/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/settings/impl/nls/root/lang",{"summaryDescriptionTitle":"Summary / description","columnSettingsTitle":"Column settings","selectColumns":"Select columns","searchBackToTooltip":"Go back to '{0}'","searchBackToAria":"Go back to '{0}'","addAvailableColumns":"Add columns","addColumnsAria":"Add table columns to show","removeColumn":"Remove '{0}'","removeColumnAria":"Remove column '{0}' from table","SearchBackToolTip":"Back","SearchBackAria":"Close","selected":"Selected","SummaryOnly":"Summaries only","SummaryPreferred":"Summaries preferred","DescriptionOnly":"Descriptions only","DescriptionPreferred":"Descriptions preferred","SummaryAndDescription":"Summaries and descriptions"}),csui.define("hbs!csui/controls/settings/available.columns/impl/available.columns",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="column-header">\r\n  <div class="icon arrow_back" tabindex="0" title="'+this.escapeExpression((o=null!=(o=t.backToButtonTitle||(null!=e?e.backToButtonTitle:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backToButtonTitle","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.backToButtonAria||(null!=e?e.backToButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backToButtonAria","hash":{}}):o))+'" role="button"></div>\r\n  <div class="column-title" title="'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'</div>\r\n  <div class="selected-column-count"></div>\r\n</div>\r\n<div class="columns-list binf-list-group" role="group">\r\n</div>'}});return i.registerPartial("csui_controls_settings_available.columns_impl_available.columns",s),s}),csui.define("hbs!csui/controls/settings/available.columns/impl/available.column",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="column-item-container" title="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'">\r\n  <span class="icon icon-listview-checkmark"></span>\r\n  <span class="column-label">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n</div>"}});return i.registerPartial("csui_controls_settings_available.columns_impl_available.column",s),s}),csui.define("csui/controls/settings/available.columns/available.columns.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette3","csui/controls/tile/behaviors/perfect.scrolling.behavior","i18n!csui/controls/settings/impl/nls/lang","hbs!csui/controls/settings/available.columns/impl/available.columns","hbs!csui/controls/settings/available.columns/impl/available.column"],function(e,t,i,s,o,n,a,r){"use strict";var l=s.View.extend({"template":r,"attributes":{"tabindex":"0","role":"checkbox","aria-checked":"false"},"className":"column-item","triggers":{"click":"column:add","keydown":{"event":"keydown:item","stopPropagation":!1,"preventDefault":!1}},"constructor":function(e){s.View.apply(this,arguments)}}),c=s.CollectionView.extend({"childView":l,"childViewEvents":{"column:add":"onColumnAdd","keydown:item":"onChildViewKeydown"},"constructor":function(e){s.CollectionView.apply(this,arguments),this.focusIndex=0},"onColumnAdd":function(e){e.$el.toggleClass("selected");var t=e.$el.hasClass("selected");t?e.$el.attr("aria-checked",!0):e.$el.attr("aria-checked",!1),t?(e.model.set({"isNew":!0}),this.options.availableSelectedColumnsCollection.add(e.model),"OTName"===e.model.get("key")?this.options.selectedColumnsCollection.findWhere({"key":"OTMIMEType"})?this.options.selectedColumnsCollection.add(e.model,{"at":1}):this.options.selectedColumnsCollection.add(e.model,{"at":0}):"OTMIMEType"===e.model.get("key")?this.options.selectedColumnsCollection.add(e.model,{"at":0}):this.options.selectedColumnsCollection.add(e.model)):(e.model.set({"isNew":!1}),this.options.availableSelectedColumnsCollection.remove(e.model),this.options.selectedColumnsCollection.remove(e.model)),this.options.settingsView.options.data.display_regions="{"+this.options.selectedColumnsCollection.pluck("key").map(function(e){return"'"+e+"'"}).join(",")+"}"},"onBeforeDestroy":function(){this.options.availableSelectedColumnsCollection&&(this.collection.remove(this.options.availableSelectedColumnsCollection.models),this.options.availableSelectedColumnsCollection.reset())},"onChildViewKeydown":function(t,i){var s=this.$el.find("*[tabindex]");switch(i.which){case 27:this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",i);break;case 13:case 32:this.onColumnAdd(t),i.preventDefault(),i.stopPropagation();break;case 38:this.focusIndex>0&&--this.focusIndex,e(s[this.focusIndex]).trigger("focus"),i.preventDefault(),i.stopPropagation();break;case 40:this.focusIndex<s.length-1&&++this.focusIndex,e(s[this.focusIndex]).trigger("focus"),i.preventDefault(),i.stopPropagation();break;case 9:this.$el.parents(".available-columns-container").find(".arrow_back").trigger("focus"),i.preventDefault(),i.stopPropagation()}}}),h=s.View.extend({"constructor":function(){s.View.apply(this,arguments),this.listenTo(this.options.availableSelectedColumnsCollection,"update",this.render)},"templateContext":function(){return{"count":this.options.availableSelectedColumnsCollection.length||"","label":n.selected}},"template":t.template("<span title='<%=label%> <%=count%>'><%=count%></span>")});return s.View.extend({"className":"csui-available-column","template":a,"templateContext":function(){return{"label":n.selectColumns,"available":this.options.availableColumns,"backToButtonTitle":t.str.sformat(n.searchBackToTooltip,n.columnSettingsTitle),"backToButtonAria":t.str.sformat(n.searchBackToAria,n.columnSettingsTitle)}},"regions":{"columnsList":".columns-list","selectedColumnsCountView":".selected-column-count"},"ui":{"backArrow":".arrow_back"},"events":{"keydown @ui.backArrow":"onKeyDownArrow","click @ui.backArrow":"showSelectedColumns","keydown":"onKeyInView"},"behaviors":{"PerfectScrolling":{"behaviorClass":o,"contentParent":".columns-list","suppressScrollX":!0,"scrollYMarginOffset":15}},"onKeyDownArrow":function(e){var t=e.keyCode;13!==t&&32!==t&&37!==t||(this.showSelectedColumns(e),e.preventDefault(),e.stopPropagation())},"onKeyInView":function(t){var i=this.$el.find(".column-item*[tabindex]");switch(t.which){case 27:this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",t);break;case 9:this.availableColumnsCollectionView.focusIndex=0,e(i[0]).trigger("focus"),t.preventDefault(),t.stopPropagation()}},"constructor":function(e){s.View.apply(this,arguments),this.options.availableSelectedColumnsCollection=new i.Collection},"showSelectedColumns":function(e){this.options.selectedColumnsCollection&&(this.options.selectedColumnsCollection.add(this.options.collection.remove(this.options.availableSelectedColumnsCollection.models)),this.options.availableSelectedColumnsCollection.reset()),this.options.settingsView.showSettings("selectedColumnsContainer",this.options.selectedColumnView)},"onRender":function(){this.availableColumnsCollectionView=new c(this.options),this.showChildView("columnsList",this.availableColumnsCollectionView),this.showChildView("selectedColumnsCountView",new h({"availableSelectedColumnsCollection":this.options.availableSelectedColumnsCollection}))}})}),csui.define("hbs!csui/controls/settings/selected.columns/impl/selected.columns",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="column-header">\r\n  <div class="icon arrow_back" tabindex="0" title="'+this.escapeExpression((o=null!=(o=t.backButtonTitle||(null!=e?e.backButtonTitle:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonTitle","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.backButtonAria||(null!=e?e.backButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonAria","hash":{}}):o))+'" role="button"></div>\r\n  <div class="column-title" title="'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'</div>\r\n</div>\r\n<div class="add-button" tabindex="0" role="button" aria-label="'+this.escapeExpression((o=null!=(o=t.addColumnsAria||(null!=e?e.addColumnsAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"addColumnsAria","hash":{}}):o))+'">\r\n  <span class="icon icon-columnsadd" title="'+this.escapeExpression((o=null!=(o=t.addAvailableColumns||(null!=e?e.addAvailableColumns:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"addAvailableColumns","hash":{}}):o))+'"></span>\r\n</div>\r\n<div class="columns-list binf-list-group" role="menu">\r\n</div>'}});return i.registerPartial("csui_controls_settings_selected.columns_impl_selected.columns",s),s}),csui.define("hbs!csui/controls/settings/selected.columns/impl/selected.column",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'  <div class="remove-button icon circle_delete" tabindex="0" role="button" aria-label="'+this.escapeExpression((o=null!=(o=t.removeColumnAria||(null!=e?e.removeColumnAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"removeColumnAria","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.removeColumn||(null!=e?e.removeColumn:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"removeColumn","hash":{}}):o))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="column-item-container" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">\r\n  <span class="icon icon-draggable-handle6"></span>\r\n  <span class="column-label" data-csui-key="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{
"name":"label","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n</div>\r\n"+(null!=(o=t.if.call(e,null!=e?e.isRemovable:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("csui_controls_settings_selected.columns_impl_selected.column",s),s}),csui.define("csui/controls/settings/selected.columns/selected.columns.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette3","csui/utils/base","csui/controls/tile/behaviors/perfect.scrolling.behavior","i18n!csui/controls/settings/impl/nls/lang","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/settings/available.columns/available.columns.view","csui/controls/table/table.view","hbs!csui/controls/settings/selected.columns/impl/selected.columns","hbs!csui/controls/settings/selected.columns/impl/selected.column"],function(e,t,i,s,o,n,a,r,l,c,h,d){"use strict";var u=s.View.extend({"template":d,"className":function(){return"column-item"+(this.model.get("isNew")?" csui-new-column-item":"")},"attributes":{"data-value":"column","role":"menuitem"},"ui":{"removeBtn":".remove-button"},"triggers":{"keydown":{"event":"keydown:item","stopPropagation":!1,"preventDefault":!1},"click @ui.removeBtn":{"event":"column:remove","stopPropagation":!1,"preventDefault":!1}},"templateContext":function(){var e=["OTName","OTMIMEType"],i=this.model.get("key");return{"name":this.model.get("name"),"label":i,"isRemovable":!(e.indexOf(i)>-1),"removeColumn":t.str.sformat(a.removeColumn,this.model.get("name")),"removeColumnAria":t.str.sformat(a.removeColumnAria,this.model.get("name"))}},"constructor":function(e){s.View.apply(this,arguments),e&&e.isTabularView&&this.$el.attr("draggable",!0),this.model.set("sequence",this.model&&this.model.collection&&this.model.collection.findIndex(this.model))}}),m=s.CollectionView.extend({"className":"csui-selected-column","childView":u,"childViewOptions":function(){return{"isTabularView":this.options&&this.options.isTabularView}},"childViewEvents":{"column:remove":"onColumnRemove","keydown:item":"onChildViewKeydown"},"constructor":function(e){e||(e={}),this.options=e,this.focusIndex=0,s.CollectionView.apply(this,e)},"onColumnRemove":function(e){this.options.availableColumnsCollection.add(this.options.collection.remove(e.model)),this.options.settingsView.$el.css("height",this.options.settingsView.currentCard.outerHeight()),this.options.settingsView.options.data.display_regions="{"+this.collection.pluck("key").map(function(e){return"'"+e+"'"}).join(",")+"}"},"attachHtml":function(e,t,i){s.CollectionView.prototype.attachHtml.call(this,e,t,i),this.options.isTabularView&&"OTName"!==t.model.get("key")&&"OTMIMEType"!==t.model.get("key")?this.attachDragListeners(t):(t.$el.addClass("drag-disabled"),t.$el.removeAttr("draggable"))},"_getItemKey":function(e){return e.find("[data-csui-key]").attr("data-csui-key")},"attachDragListeners":function(i){var s=this,o=i.$el,n=function(){s.$el.find(".csui-dragline").remove(),delete s._dropAfter};o.on("dragstart",function(t){s._dragData={"sourceKey":s._getItemKey(e(t.currentTarget))},t.originalEvent.dataTransfer.setData("text","")}),o.on("dragover",function(t){if(s._dragData&&void 0!==s._dragData.sourceKey){t.preventDefault();var i=e('<div class="csui-dragline">'),o=e(t.currentTarget).height();t.offsetY>o/2?void 0!==s._dropAfter&&!1!==s._dropAfter||(n(),e(t.currentTarget).after(i),s._dropAfter=!0):void 0!==s._dropAfter&&!0!==s._dropAfter||(n(),e(t.currentTarget).before(i),s._dropAfter=!1)}}),o.on("drop",t.bind(function(e){s._dragData&&void 0!==s._dragData.sourceKey&&this.onSubItemDrop(s,e)},this)),o.on("dragleave",function(){n()}),o.on("dragend",function(e){e.preventDefault(),n(),delete s._dragData})},"onSubItemDrop":function(t,i){var s=t,o=s._dragData&&s._dragData.sourceKey||s.keyDragSource||null,n=s._getItemKey(e(i.currentTarget)),a=s.collection.findWhere({"key":o}),r=s.collection.findWhere({"key":n}),l=s.collection.indexOf(a),c=s.collection.indexOf(r);i.preventDefault(),l!==c&&l&&(!0===s._dropAfter&&c++,l<c&&c--,s.collection.remove(a),s.collection.add(a,{"at":c}),s.$el.find(".csui-dragline").remove(),s.keyDragSource&&(s.$el.find(".active").removeClass("active"),e(s.$el.children()[c]).addClass("active"),s.$el.find(".active > *[tabindex]").trigger("focus")),s.triggerMethod("reorder",a),s._dragData&&s._dragData.sourceKey&&delete s._dropAfter,this.options.settingsView.isChanged=!0,this.options.settingsView.options.data.display_regions="{"+this.collection.pluck("key").map(function(e){return"'"+e+"'"}).join(",")+"}")},"onSubItemPaste":function(t,i){var s=t,o=e('<div class="csui-dragline">');s.$el.find(".csui-dragline").remove(),40===i.keyCode?e(i.currentTarget).after(o):e(i.currentTarget).siblings(".active").before(o)},"onChildViewKeydown":function(t,i){var s,n=o.isMacintosh(),a=i.keyCode,r=this.$el.find("*[tabindex]");if(this.options.isTabularView&&(n&&i.metaKey&&!i.ctrlKey||!n&&!i.metaKey&&i.ctrlKey))i.preventDefault(),i.stopPropagation(),88===a?this.keyDragSource=this._getItemKey(e(i.currentTarget)):86===a&&(this.onSubItemDrop(this,i),this.keyDragSource=void 0);else if(27===a)this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",i);else if(13===a||32===a)this.onColumnRemove(t,i),i.stopPropagation(),r.length-1===this.focusIndex&&--this.focusIndex,r=this.$el.find("*[tabindex]"),0===r.length?(s=this.$el.parents(".selected-columns-container").find(".add-button"),s.trigger("focus")):(e(r[this.focusIndex]).closest(".column-item").addClass("active"),e(r[this.focusIndex]).trigger("focus"));else if(r.length&&(38!==a&&40!==a||(e(r[this.focusIndex]).closest(".column-item").removeClass("active"),38===a?this.focusIndex>0&&--this.focusIndex:this.focusIndex<r.length-1&&++this.focusIndex,e(r[this.focusIndex]).closest(".column-item").addClass("active"),e(r[this.focusIndex]).trigger("focus"),this.keyDragSource&&this.focusIndex>=0&&this.onSubItemPaste(this,i),i.stopPropagation(),i.preventDefault()),9===i.keyCode)){if(e(r[this.focusIndex]).closest(".column-item").removeClass("active"),i.shiftKey&&this.options.availableColumnsCollection.length)s=this.$el.parents(".selected-columns-container").find(".add-button"),s.trigger("focus");else{var l=this.$el.parents(".selected-columns-container").find(".arrow_back");l.trigger("focus")}i.stopPropagation(),i.preventDefault()}}});return s.View.extend({"constructor":function(e){s.View.apply(this,arguments)},"template":h,"templateContext":{"label":a.columnSettingsTitle,"backButtonTitle":a.SearchBackToolTip,"backButtonAria":a.SearchBackAria,"addAvailableColumns":a.addAvailableColumns,"addColumnsAria":a.addColumnsAria},"behaviors":{"PerfectScrolling":{"behaviorClass":n,"contentParent":".columns-list","suppressScrollX":!0,"scrollYMarginOffset":15},"TabableRegionBehavior":{"behaviorClass":r}},"regions":{"columnsList":".columns-list"},"ui":{"backArrow":".arrow_back","addButton":".add-button"},"events":{"click @ui.backArrow":"showSettingsView","keydown @ui.backArrow":"onKeydownBackArrow","click @ui.addButton":"showAvailableColumns","keydown":"onKeyInView"},"onKeydownBackArrow":function(e){var t=e.keyCode;13!==t&&32!==t&&37!==t||(this.showSettingsView(e),e.preventDefault(),e.stopPropagation())},"onKeyInView":function(t){var i=t.keyCode,s=this.$el.find(".add-button"),o=0;27===i?(this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",t)):s.length&&(9===i?(t.shiftKey?e(document.activeElement).hasClass("arrow_back")?(s=this.$el.find(".circle_delete"),o=this.selectedColumnsCollectionView.focusIndex=s.length-1,e(s[o]).closest(".column-item").addClass("active"),e(s[o]).trigger("focus")):this.$el.find(".arrow_back").trigger("focus"):(o=0,e(document.activeElement).hasClass("arrow_back")&&this.options.availableColumnsCollection.length?e(s[o]).trigger("focus"):(s=this.$el.find(".circle_delete"),this.selectedColumnsCollectionView.focusIndex=0,e(s[o]).closest(".column-item").addClass("active"),e(s[o]).trigger("focus"))),t.preventDefault(),t.stopPropagation()):13!==i&&32!==i||(this.showAvailableColumns(t),t.preventDefault(),t.stopPropagation()))},"showSettingsView":function(e){this.options.settingsView.showSettings("settingsDropDownContainer",this.options.settingsView.settingsDropDownView)},"showAvailableColumns":function(){var e,t,i=this.options.settings&&this.options.settings.get("display");i&&i.display_regions&&(e=i.display_regions.available,t=i.display_regions.selected),this.options.settingsView.showSettings("availableColumnsContainer",new l({"selectedColumnView":this,"settingsView":this.options.settingsView,"tableCollection":this.options.tableCollection,"collection":e,"selectedColumnsCollection":t,"settings":this.options.settings}))},"onRender":function(){this.options.availableColumnsCollection.length||this.ui.addButton.addClass("binf-hidden"),this.selectedColumnsCollectionView=new m(this.options),this.showChildView("columnsList",this.selectedColumnsCollectionView),this.listenTo(this.options.availableColumnsCollection,"update",t.bind(function(){this.options.availableColumnsCollection.length?this.ui.addButton.removeClass("binf-hidden"):this.ui.addButton.addClass("binf-hidden")},this))}})}),csui.define("hbs!csui/controls/settings/summary.description/impl/summary.descriptions",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="column-header">\r\n  <div class="icon arrow_back" tabindex="0" title="'+this.escapeExpression((o=null!=(o=t.backButtonTitle||(null!=e?e.backButtonTitle:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonTitle","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.backButtonAria||(null!=e?e.backButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonAria","hash":{}}):o))+'" role="button"></div>\r\n  <div class="column-title" title="'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'</div>\r\n</div>\r\n<div class="columns-list binf-list-group" role="radiogroup"></div>'}});return i.registerPartial("csui_controls_settings_summary.description_impl_summary.descriptions",s),s}),csui.define("hbs!csui/controls/settings/summary.description/impl/summary.description",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"selected"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="column-item-container" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"\" role='radio' aria-checked="+this.escapeExpression((n=null!=(n=t.checked||(null!=e?e.checked:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"checked","hash":{}}):n))+'>\r\n  <span class="icon icon-listview-checkmark '+(null!=(o=t.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'"></span>\r\n  <span class="column-label" id="'+this.escapeExpression((n=null!=(n=t.key||(null!=e?e.key:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"key","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</div>\r\n</div>"}});return i.registerPartial("csui_controls_settings_summary.description_impl_summary.description",s),s}),csui.define("csui/controls/settings/summary.description/summary.description.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette3","i18n!csui/controls/settings/impl/nls/lang","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/settings/summary.description/impl/summary.descriptions","hbs!csui/controls/settings/summary.description/impl/summary.description"],function(e,t,i,s,o,n,a,r){"use strict";var l=s.View.extend({"template":r,"className":"column-item","templateContext":function(){return{"name":this._nameResolver(),"label":this.model.get("key"),"checked":!!this.model.get("selected")}},"ui":{"itemContainer":".column-item-container"},"triggers":{"click @ui.itemContainer":"click:itemContainer","keydown @ui.itemContainer":{"event":"keydown:itemContainer","stopPropagation":!1,"preventDefault":!1}},"constructor":function(e){e||(e={}),this.options=e,s.View.call(this,e),this.listenTo(this.model,"change",this.render)},"_nameResolver":function(){var e,t=this.model.get("key");switch(t){case"SO":e=o.SummaryOnly;break;case"SP":e=o.SummaryPreferred;break;case"DO":e=o.DescriptionOnly;break;case"DP":e=o.DescriptionPreferred;break;case"SD":e=o.SummaryAndDescription;break;default:e=this.model.get("name")}return e}}),c=s.CollectionView.extend({"childView":l,"childViewOptions":{},"constructor":function(e){e||(e={}),this.options=e,this.focusIndex=0,s.CollectionView.call(this,e)},"onChildviewClickItemContainer":function(e){this.selectSummary(e)},"selectSummary":function(e){this.collection.findWhere({"selected":!0}).unset("selected"),e.model.set("selected",!0),this.options.settingsView.options.data.summary_description=e.model.get("key"),this.options.selectedCollection=e.model.get("key"),this.options.settingsView.model.get("display").summary_description.selected=e.model.get("key"),e.$el.find(".column-item-container").trigger("focus")},"onChildviewKeydownItemContainer":function(t,i){var s=i.keyCode,o=this.$el.find("*[tabindex]");if(27===s)this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",i);else if(13===s||32===s)this.selectSummary(t);else if(o.length&&(38!==s&&40!==s||(38===s?this.focusIndex>0&&--this.focusIndex:this.focusIndex<o.length-1&&++this.focusIndex,e(o[this.focusIndex]).trigger("focus"),i.stopPropagation(),i.preventDefault()),9===i.keyCode)){var n=this.$el.parents(".csui-summary-description-list").find(".arrow_back");n.trigger("focus"),i.stopPropagation(),i.preventDefault()}}});return s.View.extend({"template":a,"className":"csui-summary-description-list","ui":{"backArrow":".arrow_back"},"events":{"click @ui.backArrow":"onClickBackArrow","keydown @ui.backArrow":"onKeyPressBackArrow","keydown":"onKeyInView"},"regions":{"columnsList":".columns-list"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":n}},"currentlyFocusedElement":function(t){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),e(t&&t.shiftKey?i[i.length-1]:i[0])},"templateContext":function(){var e=this;return t.each(this.options.availableCollection&&this.options.availableCollection.models,function(t,i){t.get("key")===e.options.selectedCollection&&(t.set("selected",!0),t.set("checked",!0))}),{"label":o.summaryDescriptionTitle,"available":this.options.availableCollection&&this.options.availableCollection.models,"backButtonTitle":o.SearchBackToolTip,"backButtonAria":o.SearchBackAria}},"constructor":function(e){e||(e={}),this.options=e,s.View.call(this,e)},"onClickBackArrow":function(e){this.showSettingsView(e)},"onKeyPressBackArrow":function(e){var t=e.keyCode;13!==t&&32!==t&&37!==t||(this.showSettingsView(e),e.stopPropagation(),e.preventDefault())},"showSettingsView":function(e){this.options.settingsView.showSettings("settingsDropDownContainer",this.options.settingsView.settingsDropDownView)},"onRender":function(){this.summaryDescriptionCollectionView=new c(this.options),this.showChildView("columnsList",this.summaryDescriptionCollectionView)},"onKeyInView":function(t){var i=t.keyCode,s=this.$el.find(".column-item-container"),o=0;27===i?(this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",t)):s.length&&(9!==i&&16!==i||(o=t.shiftKey?s.length-1:0,this.summaryDescriptionCollectionView.focusIndex=0,e(s[o]).trigger("focus"),t.stopPropagation(),t.preventDefault()))}})}),csui.define("hbs!csui/controls/settings/impl/settings.dropdown",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<a class="csui-settings-option" href="javascript:void(0);" tabindex="0" title="'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'" role="menuitem">\r\n  <span class="csui-settings-option-title">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'</span>\r\n  <span class="icon icon-next-card"></span>\r\n</a>\r\n'}});return i.registerPartial("csui_controls_settings_impl_settings.dropdown",s),s}),csui.define("csui/controls/settings/impl/settings.dropdown.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette3","i18n!csui/controls/settings/impl/nls/lang","csui/controls/settings/selected.columns/selected.columns.view","csui/controls/settings/summary.description/summary.description.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/settings/impl/settings.dropdown"],function(e,t,i,s,o,n,a,r,l){"use strict";var c=s.View.extend({"tagName":"li","template":l,"className":"binf-list-group-item","triggers":{"click a":{"event":"show:settings"},"keydown a":{"event":"show:settings:dropdown","preventDefault":!1}},"constructor":function(e){e||(e={}),this.options=e,s.View.call(this,e)},"showColumnsSettings":function(e){var t,i,s=this.model&&this.model.get("display");s&&s.display_regions&&(t=s.display_regions.selected,i=s.display_regions.available),t&&t.where({"isNew":!0}).map(function(e){e.set({"isNew":!1},{"silent":!0})}),this.options.showSettings("selectedColumnsContainer",new n({"settingsDropDownView":this,"tableCollection":this.options.tableCollection,"collection":t,"availableColumnsCollection":i,"settings":this.model}))},"showSummaryOrDescription":function(e){var t,i,s=this.model&&this.model.get("display");s.summary_description&&s.summary_description.available&&(t=s.summary_description.available,i=s.summary_description.selected),this.options.originatingView.showSettings("summaryOrDescriptionContainer",new a({"settingsDropDownView":this,"selectedCollection":i,"availableCollection":t,"collection":t,"settings":this.model}))}});return s.CollectionView.extend({"constructor":function(){this.focusIndex=0,s.CollectionView.apply(this,arguments)},"className":"binf-list-group","tagName":"ul","childView":c,"childViewEvents":{"show:settings:dropdown":"onShowSettingsDropdown","show:settings":"onShowSettings"},"childViewOptions":function(){return{"settingsView":this.options.settingsView}},"behaviors":{"TabableRegionBehavior":{"behaviorClass":r}},"currentlyFocusedElement":function(t){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),e(t&&t.shiftKey?i[i.length-1]:i[0])},"onShowSettings":function(e,t){this.options.settingsView.showSettings(e.model.get("id"),e.model.get("view"))},"onShowSettingsDropdown":function(t,i){var s=i.keyCode,o=this.$el.find("a[tabindex]");27===s?(this.$el.closest(".csui-search-settings").trigger("focus"),this.options.settingsView.triggerMethod("close:menu",i)):13===s||32===s||39===s?this.onShowSettings(t,i):o.length&&(38!==s&&40!==s||(38===s?this.focusIndex>0&&--this.focusIndex:this.focusIndex<o.length-1&&++this.focusIndex,e(o[this.focusIndex]).trigger("focus"),i.stopPropagation(),i.preventDefault()))}})}),csui.define("hbs!csui/controls/settings/impl/settings",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'<div class="selected-columns-container"></div>\r\n<div class="available-columns-container"></div>\r\n<div class="summary-description-container"></div>\r\n'},"3":function(e,t,i,s){return'<div id="'+this.escapeExpression(this.lambda(e,e))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="settings-dropdown-container csui-settings-show" tabindex="0"></div>\r\n'+(null!=(o=t.if.call(e,null!=e?e.showDefaults:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t.each.call(e,null!=e?e.regions:e,{"name":"each","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("csui_controls_settings_impl_settings",s),s}),csui.define("css!csui/controls/settings/impl/settings",[],function(){}),csui.define("csui/controls/settings/settings.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette3","i18n","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/settings/impl/settings.dropdown.view","csui/controls/settings/selected.columns/selected.columns.view","csui/controls/settings/summary.description/summary.description.view","i18n!csui/controls/settings/impl/nls/lang","hbs!csui/controls/settings/impl/settings","css!csui/controls/settings/impl/settings"],function(e,t,i,s,o,n,a,r,l,c,h,d){"use strict";return o.View.extend({"constructor":function(e){e||(e={}),i.defaults(e,{"showDefaults":!0}),this.plugins=i.each(e.options,function(e,t){e.region="#"+e.id}),o.View.call(this,e)},"className":"csui-settings-container","template":d,"templateContext":function(){return{"showDefaults":this.options.showDefaults,"regions":i.map(this.plugins,function(e){return e.region.substring(1)})}},"regions":function(){var e={"settingsDropDownContainer":this.options.settingsDropDownContainer||".settings-dropdown-container"};return this.options.showDefaults&&i.extend(e,{"selectedColumnsContainer":".selected-columns-container","availableColumnsContainer":".available-columns-container","summaryOrDescriptionContainer":".summary-description-container"}),i.each(this.plugins,function(t){e[t.id]=t.region}),e},"ui":function(){var e={"settingsDropDownContainer":".settings-dropdown-container"};return this.options.showDefaults&&i.extend(e,{"selectedColumnsContainer":".selected-columns-container","availableColumnsContainer":".available-columns-container","summaryOrDescriptionContainer":".summary-description-container"}),i.each(this.plugins,function(t){e[t.id]=t.region}),e},"behaviors":{"TabableRegionBehavior":{"behaviorClass":a}},"currentlyFocusedElement":function(e){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),t(e&&e.shiftKey?i[i.length-1]:i[0])},"onRender":function(){var e=new s.Collection(this.options.options);if(this.options.showDefaults){var t,i,o=this.model&&this.model.get("display");this.prevModel=JSON.parse(JSON.stringify(o)),o&&o.display_regions&&(t=o.display_regions.selected,i=o.display_regions.available);var n,a;o&&o.summary_description&&o.summary_description.available&&(n=o.summary_description.available,a=o.summary_description.selected),t&&t.where({"isNew":!0}).map(function(e){e.set({"isNew":!1},{"silent":!0})}),e.add([{"id":"selectedColumnsContainer","label":h.columnSettingsTitle,"view":new l({"settingsView":this,"isTabularView":this.options.isTabularView,"tableCollection":this.options.tableCollection,"collection":t,"availableColumnsCollection":i,"settings":this.model})},{"id":"summaryOrDescriptionContainer","label":h.summaryDescriptionTitle,"view":new c({"settingsView":this,"selectedCollection":a,"availableCollection":n,"collection":n,"settings":this.model})}],{"at":0})}this.settingsDropDownView=new r({"settingsView":this,"model":this.model,"tableCollection":this.options.tableCollection,"collection":e,"showSettings":this.showSettings.bind(this)}),this.showChildView("settingsDropDownContainer",this.settingsDropDownView),this.currentCard=this.ui.settingsDropDownContainer},"onShow":function(){var e=this;this.$el.css("height",this.currentCard.outerHeight()),setTimeout(function(){e.settingsDropDownView.$el.find(".binf-list-group-item a").length>0&&t(e.settingsDropDownView.$el.find(".binf-list-group-item a")[0]).trigger("focus")},0)},"showSettings":function(e,t){this.isCardChanging||(this.isCardChanging=!0,this.showChildView(e,t),this.animate(this.currentCard,this.ui[e]),this.currentCard=this.ui[e])},"animate":function(e,t){this.$el&&this.$el.css("height",t.outerHeight());var i=this;t.index()>e.index()?(t.one("animationend",function(){delete i.isCardChanging,t.addClass("csui-settings-show").removeClass("animate-show"),t.find("[tabindex]:first").trigger("focus")}),t.addClass("animate-show")):(e.one("animationend",function(){delete i.isCardChanging,e.removeClass("csui-settings-show animate-hide"),t.find("[tabindex]:first").trigger("focus")}),e.addClass("animate-hide"))}})}),csui.define("csui/widgets/search.results/controls/sorting/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.results/controls/sorting/impl/nls/root/localized.strings",{"sortBy":"Sort by...","sortByThis":"Sort by {0}","sortOptionsAria":"Sort options","ascending":"{0}: Click to sort ascending","descending":"{0}: Click to sort descending"}),csui.define("hbs!csui/widgets/search.results/controls/sorting/impl/sort.menu",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'  <div class="csui-search-sort-options ">\r\n    <button id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n            data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="'+this.escapeExpression((o=null!=(o=t.sortButtonAria||(null!=e?e.sortButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"sortButtonAria","hash":{}}):o))+'">\r\n      <span class="cs-label">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</span>\r\n      <span class="cs-icon icon-caret-down"></span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu" aria-label="'+this.escapeExpression((o=null!=(o=t.listAria||(null!=e?e.listAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"listAria","hash":{}}):o))+'"></ul>\r\n  </div>\r\n  <a href="javascript:void(0);" class="cs-icon search-sort-btn icon-sortArrowDown"></a>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return null!=(o=t.if.call(e,null!=e?e.sortEnable:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:""}});return i.registerPartial("csui_widgets_search.results_controls_sorting_impl_sort.menu",s),s}),csui.define("csui/widgets/search.results/controls/sorting/sort.menu.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","i18n!csui/widgets/search.results/controls/sorting/impl/nls/localized.strings","hbs!csui/widgets/search.results/controls/sorting/impl/sort.menu","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/lib/binf/js/binf"],function(e,t,i,s,o,n,a,r,l,c,h){return n.ItemView.extend({"className":"cs-sort-links","template":l,"templateHelpers":function(){var e={"sortBy":r.sortBy};this.selected.get("title")?this.selected.get("title"):this.constants.DEFAULT_SORT;return{"messages":e,"sortEnable":this.collection.models.length&&!!this.collection.sorting&&this.options.enableSorting,"id":s.uniqueId("sortButton"),"sortButtonAria":r.sortOptionsAria,"listAria":r.sortOptionsAria}},"constants":{"SORT_ASC":"asc","SORT_DESC":"desc","DEFAULT_SORT":"relevance"},"events":{"click .binf-dropdown-menu > li > a":"onSortOptionClick","click a.search-sort-btn":"onSortOrderClick","keydown":"onKeyInView"},"ui":{"toggle":">.csui-search-sort-options>.binf-dropdown-toggle","selectedLabel":">.csui-search-sort-options>.binf-dropdown-toggle >.cs-label","selectedIcon":">.csui-search-sort-options>.binf-dropdown-toggle >.cs-icon","sortOrderBtn":"a.search-sort-btn"},"constructor":function(e){if(n.View.prototype.constructor.apply(this,arguments),this.config=this.options.config||{},this.selected=new o.Model,this.collection){var t=this.options.orderBy||this.collection.orderBy;this.collection.setOrder(t,!1),this.listenTo(this.collection,"reset",this.render)}this.listenTo(this.collection,"change",this._refreshSelection),this.listenTo(this.selected,"change",this._updateSelection)},"onRender":function(){if(this.ui.toggle.binf_dropdown(),this.ui.sortOrderBtn.hide(),void 0!==this.collection.sorting&&void 0!==this.collection.sorting.links)if(this.collection.sorting.sort&&this.collection.sorting.sort[0]!==this.constants.DEFAULT_SORT?(this._setSelection(this.collection.sorting.links[this.collection.sorting.sort]),this._addDropdownItems(i.extend({},this.collection.sorting.links),this.collection.sorting.sort[0]),this.ui.sortOrderBtn.show()):(this._setSelection(this.collection.sorting.links[this.constants.DEFAULT_SORT]),this._addDropdownItems(i.extend({},this.collection.sorting.links),""),this.$el.find(".binf-dropdown-menu > :first-child").addClass("binf-active"),this.$el.find(".binf-dropdown-menu > :first-child a.csui-sort-option").attr("aria-checked","true"),this.$el.find(".binf-dropdown-menu > :first-child .cs-icon").addClass("icon-listview-checkmark"),this.ui.sortOrderBtn.hide()),this.ui.selectedLabel.text(this.selected.get("title")),this.selected.get("order")===this.constants.SORT_ASC){this.ui.sortOrderBtn.removeClass("icon-sortArrowDown"),this.ui.sortOrderBtn.addClass("icon-sortArrowUp");var e=s.str.sformat(r.descending,this.selected.get("title"));this.ui.sortOrderBtn.attr("title",e).attr("aria-label",e)}else{this.ui.sortOrderBtn.removeClass("icon-sortArrowUp"),this.ui.sortOrderBtn.addClass("icon-sortArrowDown");var t=s.str.sformat(r.ascending,this.selected.get("title"));this.ui.sortOrderBtn.attr("title",t).attr("aria-label",t)}},"onKeyInView":function(e){9===e.keyCode&&!!this.$el.find(".binf-open")&&this.$el.find(".binf-open").removeClass("binf-open")},"behaviors":{"PerfectScrolling":{"behaviorClass":c,"contentParent":".binf-dropdown-menu","suppressScrollX":!0},"TabableRegionBehavior":{"behaviorClass":h}},"currentlyFocusedElement":function(e){var t=this.$("*[tabindex]");return t.length&&t.prop("tabindex",0),e&&e.shiftKey?i(t[t.length-1]):this.orderClicked?this.ui.sortOrderBtn:i(t[0])},"_setSelection":function(e){var t={};this.collection.sorting.sort?(0===this.collection.sorting.sort[0].indexOf(this.constants.SORT_DESC)&&(t.id=this.collection.sorting.sort[0].replace(/desc_/g,""),t.order=this.constants.SORT_DESC),0===this.collection.sorting.sort[0].indexOf(this.constants.SORT_ASC)&&(t.id=this.collection.sorting.sort[0].replace(/asc_/g,""),t.order=this.constants.SORT_ASC)):(t.id="",t.order=this.constants.SORT_DESC),t.title=s.str.trim(e&&e.name?this.trimSortOptionName(e.name):"empty");var i=s.str.sformat(r.sortByThis,t.title);this.$el.find(".csui-search-sort-options \t.binf-dropdown-toggle").attr("title",i),this.selected.set(t)},"_updateSelection":function(){this.ui.selectedLabel.text(this.selected.get("title"))},"_refreshSelection":function(e){e.collection&&e.collection.inMetadataNavigationView&&(e.collection.isSortOptionSelected=!0),e.get("id")===this.selected.get("id")&&this._setSelection(e)},"resetCollection":function(e,t){this.collection.setOrder(e,!0)},"sortPage":function(e){e.preventDefault(),e.stopPropagation();var t=[],s=i(e.currentTarget).attr("data-csui-sortoption-id");void 0!==s?t.push(s+" "+this.constants.SORT_DESC):t.push(""),
this.resetCollection(t.join(),!0)},"_addDropdownItems":function(e,t){var i=this.$el.find(".binf-dropdown-menu"),s=this;if(e[this.constants.DEFAULT_SORT]){var o=s.trimSortOptionName(e[s.constants.DEFAULT_SORT].name);i.append('<li role="presentation"><a role="menuitemradio" aria-checked="false" href="#" class="csui-sort-option" data-binf-toggle="tab"><span class="cs-icon"></span><span class="cs-label" title="'+o+'">'+o+"</span></a></li>"),delete e[s.constants.DEFAULT_SORT]}for(var n in e)if(0===n.search("asc_"))delete e[n];else{var a=n.replace(/desc_/g,""),r=s.trimSortOptionName(e[n].name);t.split(/_(.+)/,2)[1]===n.split(/_(.+)/,2)[1]?i.append('<li role="presentation" class="binf-active"><a role="menuitemradio" aria-checked="true" data-csui-sortoption-id="'+a+'" href="#" class="csui-sort-option" data-binf-toggle="tab"><span class="cs-icon icon-listview-checkmark"></span><span class="cs-label" title="'+r+'">'+r+"</span></a></li>"):i.append('<li role="presentation"><a role="menuitemradio" aria-checked="false" data-csui-sortoption-id="'+a+'" href="#" class="csui-sort-option" data-binf-toggle="tab"><span class="cs-icon"></span><span class="cs-label" title="'+r+'">'+r+"</span></a></li>")}},"activate":function(e){!0===this.$el.find("li").hasClass("binf-active")&&(this.$el.find("li").removeClass("binf-active"),this.$el.find("li a.csui-sort-option").attr("aria-checked","false"),this.$el.find("li .cs-icon").removeClass("icon-listview-checkmark")),i(e.parentElement).addClass("binf-active"),i(e).find("a.csui-sort-option").attr("aria-checked","true"),i(e).find("span.cs-icon").addClass("icon-listview-checkmark")},"resetSelection":function(e,t){var i={};i.id=e,i.title=s.str.trim(t),i.order=this.constants.SORT_DESC,this.selected.set(i)},"onSortOptionClick":function(e){this.collection.isSortOptionSelected=!0,e.preventDefault(),e.stopPropagation(),e.currentTarget.children[1].innerHTML.toLowerCase()===this.constants.DEFAULT_SORT&&this.ui.sortOrderBtn.hide(),this.orderClicked=!1,this.activate(e.currentTarget);var t=i(e.currentTarget).attr("data-csui-sortoption-id");void 0===t&&(t=""),this.resetSelection(t,e.currentTarget.children[1].innerHTML),this.sortPage(e),this.ui.toggle.binf_dropdown("toggle"),this.trigger("change:sortOrder")},"onSortOrderClick":function(e){this.collection.isSortOptionSelected=!0,e.preventDefault(),e.stopPropagation(),this.orderClicked=!0;var t=[];this.ui.sortOrderBtn.hasClass("icon-sortArrowDown")?(this.ui.sortOrderBtn.removeClass("icon-sortArrowDown"),this.ui.sortOrderBtn.addClass("icon-sortArrowUp"),t.push(this.selected.id+" "+this.constants.SORT_ASC)):(this.ui.sortOrderBtn.removeClass("icon-sortArrowUp"),this.ui.sortOrderBtn.addClass("icon-sortArrowDown"),t.push(this.selected.id+" "+this.constants.SORT_DESC)),this.collection.setOrder(t.join(),!0)},"trimSortOptionName":function(e){return e.replace(/\(([;\s\w\"\=\,\:\.\/\~\{\}\?\!\-\%\&\#\$\^\(\)]*?)\)/g,"")}})}),csui.define("csui/widgets/search.results/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.results/impl/nls/root/lang",{"loadingSearchResultMessage":"Loading search results...","noSearchResultMessage":"No results found.","searchQueryKeyboardShortcut":"Press Ctrl+F3 to go to the Search Query box","suggestionKeyword":"Suggestions:","searchSuggestion1":"Make sure all words are spelled correctly.","searchSuggestion2":"Try different keywords.","searchSuggestion3":"Try more general keywords.","searchSuggestion4":"Try broadening or removing the location restriction.","failedSearchResultMessage":"Loading search results failed.","owner":"Owner","created":"Created","createdBy":"Created by","modified":"Modified","size":"Size","type":"Type","items":"Items","searchResults":"Search Results","searchSettings":"Search Settings","clearAll":"Clear all","about":"About","expandAll":"Expand all","collapseAll":"Collapse all","relevance":"Relevance","name":"Name","creationDate":"CreationDate","showMore":"Show more","showMoreAria":"Show more metadata","showLess":"Show less","showLessAria":"Show less metadata","selectAll":"Select all results on current page.","selectAllAria":"Select all results on current page","selectItem":"Select {0}","selectItemAria":"Select {0}. When selected an action bar of options can be reached per shift-tab","searchBackTooltip":"Go back","searchBackTooltipTo":"Go back to '{0}'","searchBackToHome":"Home","versionLabel":"v","versionSeparator":".","filterExpandTooltip":"Show filters","filterCollapseTooltip":"Hide filters","filterExpandAria":"Show filter panel","filterCollapseAria":"Hide filter panel","customSearchTab":"Search","searchFilterTab":"Refine by","mimeTypeAria":"type {0}","itemBreadcrumbAria":"Breadcrumb {0}","formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items","promotedLabel":"Promoted","dialogTitle":"Filters","dialogTemplate":"Applying filters would clear your current selection.\nDo you want to proceed?","standardSearchView":"Standard search view","tabularSearchView":"Tabular search view","showDescription":"Show description","hideDescription":"Hide description","descriptionColumnTitle":"Description","summaryColumnTitle":"Summary"}),csui.define("hbs!csui/widgets/search.results/impl/search.results.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'    <span class="csui-search-facet-filter-parent">\r\n      <span class="csui-search-filter icon icon-toolbarFilter" role="button"\r\n            aria-label="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.filterAria:o,e))+'" title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.searchFilterTooltip:o,e))+'"\r\n            tabindex="0"></span>\r\n    </span>\r\n'},"3":function(e,t,i,s){var o,n;return'      <div class="csui-search-header-action csui-search-settings"\r\n           title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.settingsLabel:o,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.settingsLabel:o,e))+'" tabindex="0" role="menu" aria-haspopup="true"\r\n           aria-expanded="false">\r\n        <svg class="csui-svg-icon csui-svg-icon-normal" focusable="false">\r\n          <use xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_settings32"></use>\r\n        </svg>\r\n        <svg class="csui-svg-icon csui-svg-icon-hover" focusable="false">\r\n          <use\r\n              xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_settings32.hover"></use>\r\n        </svg>\r\n        <svg class="csui-svg-icon csui-svg-icon-active" focusable="false">\r\n          <use\r\n              xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_settings32.active"></use>\r\n        </svg>\r\n        <div class="csui-settings-dropdown"></div>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="csui-search-header">\r\n   <span class="csui-search-arrow-back-parent">\r\n   <span class="icon arrow_back cs-go-back" aria-label="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.searchBackTooltip:o,e))+'"\r\n         title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.searchBackTooltip:o,e))+'" tabindex="0" role="button"></span>\r\n   </span>\r\n'+(null!=(o=t.if.call(e,null!=(o=null!=e?e.messages:e)?o.enableSearchFilter:o,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'  <div class="csui-search-header-title"></div>\r\n  <div class="csui-search-right-header-container">\r\n    <div class="csui-search-header-action csui-search-sorting" id="csui-search-sorting"></div>\r\n    <span class="csui-search-header-action icon icon-description-toggle binf-hidden"\r\n          aria-label="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.descriptionTitle:o,e))+'" title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.descriptionTitle:o,e))+'"\r\n          role="button" tabindex="0"></span>\r\n    <div class="csui-search-header-action csui-tabular-view"\r\n         aria-label="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.tabularViewIconTitle:o,e))+'"\r\n         role="button" title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.tabularViewIconTitle:o,e))+'" tabindex="0">\r\n      <svg class="csui-svg-icon csui-svg-icon-normal csui-icon-off" focusable="false">\r\n        <use\r\n            xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_table_tabular32"></use>\r\n      </svg>\r\n      <svg class="csui-svg-icon csui-svg-icon-hover csui-icon-off" focusable="false">\r\n        <use\r\n            xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_table_tabular32.hover"></use>\r\n      </svg>\r\n      <svg class="csui-svg-icon csui-svg-icon-active csui-icon-off" focusable="false">\r\n        <use\r\n            xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_table_tabular32.active"></use>\r\n      </svg>\r\n      <svg class="csui-svg-icon csui-svg-icon-normal csui-icon-on" focusable="false">\r\n        <use\r\n            xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_table_standard32"></use>\r\n      </svg>\r\n      <svg class="csui-svg-icon csui-svg-icon-hover csui-icon-on" focusable="false">\r\n        <use\r\n            xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_table_standard32.hover"></use>\r\n      </svg>\r\n      <svg class="csui-svg-icon csui-svg-icon-active csui-icon-on" focusable="false">\r\n        <use\r\n            xlink:href="'+this.escapeExpression((n=null!=(n=t.spritePath||(null!=e?e.spritePath:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"spritePath","hash":{}}):n))+'#themes--carbonfiber--image--generated_icons--action_table_standard32.active"></use>\r\n      </svg>\r\n    </div>\r\n'+(null!=(o=t.if.call(e,null!=(o=null!=e?e.messages:e)?o.showSettings:o,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+'  </div>\r\n</div>\r\n<div class="csui-table-rowselection-toolbar"></div>'}});return i.registerPartial("csui_widgets_search.results_impl_search.results.header",s),s}),csui.define("hbs!csui/widgets/search.results/impl/search.results.header.title",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-search-header-title-container csui-fadeout">\r\n  <h2 id="resultsTitle" class="csui-results-title"></h2>\r\n  <div id="customSearchTitle" class="csui-custom-search-title"></div>\r\n</div>\r\n<span id="headerCount" class="headerCount"></span>\r\n<span id="searchHeaderCountLive" role="status" class="binf-sr-only" aria-live="polite"></span>'}});return i.registerPartial("csui_widgets_search.results_impl_search.results.header.title",s),s}),csui.define("csui/widgets/search.results/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.results/nls/root/lang",{"aboutNHits":"About {0} hits","ToolbarItemReserve":"Reserve","ToolbarItemUnreserve":"Unreserve"}),csui.define("css!csui/widgets/search.results/impl/search.results",[],function(){}),csui.define("csui/widgets/search.results/impl/search.results.header.title.view",["csui/lib/underscore","csui/lib/marionette","hbs!csui/widgets/search.results/impl/search.results.header.title","i18n!csui/widgets/search.results/nls/lang","i18n!csui/widgets/search.results/impl/nls/lang","css!csui/widgets/search.results/impl/search.results"],function(e,t,i,s,o){"use strict";return t.ItemView.extend({"template":i,"constructor":function(e){t.ItemView.prototype.constructor.apply(this,arguments)},"ui":{"resultTitle":"#resultsTitle","customSearchTitle":"#customSearchTitle","headerCount":"#headerCount","searchHeaderCountLive":"#searchHeaderCountLive"},"_assignTotalItemElem":function(){this.count=this.options.count||0;var t=e.str.sformat(s.aboutNHits,this.count),i="";return i=0!==this.count?t:o.noSearchResultMessage,this.ui.headerCount.empty(),this.ui.headerCount.append(t),this.countTextAria=o.searchResults+": "+i+". "+o.searchQueryKeyboardShortcut,this.ui.searchHeaderCountLive.text(this.countTextAria),!0},"_updateSearchResultsTitle":function(){var e,t;this.options.useCustomTitle&&this.title?(this.ui.customSearchTitle.text(this.title),t=o.searchResults+": "+this.title,e=o.searchResults+": "):(e=this.options.searchHeaderTitle||o.searchResults,t=e),this.ui.resultTitle.text(e),this.ui.resultTitle.parent().attr("title",t)},"setCustomSearchTitle":function(e){this.title='"'+e+'"',this.ui.customSearchTitle.text(e);var t=o.searchResults+": ";this.ui.resultTitle.text(t),this.ui.resultTitle.parent().attr("title",t+this.title)},"onRender":function(){this._assignTotalItemElem(),this._updateSearchResultsTitle()}})}),csui.define("csui/widgets/search.results/impl/search.results.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/utils/base","csui/utils/contexts/factories/previous.node","csui/utils/contexts/factories/next.node","csui/utils/namedsessionstorage","csui/models/nodes","csui/utils/contexts/factories/user","csui/utils/contexts/factories/search.query.factory","csui/utils/accessibility","csui/pages/start/perspective.routing","csui/controls/settings/settings.view","csui/controls/globalmessage/globalmessage","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/widgets/search.results/controls/sorting/sort.menu.view","i18n!csui/widgets/search.results/impl/nls/lang","hbs!csui/widgets/search.results/impl/search.results.header","csui/utils/contexts/factories/application.scope.factory","csui/widgets/search.results/impl/search.results.header.title.view","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/themes/carbonfiber/svg_sprites/symbol/sprite","css!csui/widgets/search.results/impl/search.results"],function(e,t,i,s,o,n,a,r,l,c,h,d,u,m,p,g,b,f,w,v,y,S,C,V){"use strict";var _,T=u.isAccessibleTable(),x=s.LayoutView.extend({"className":"csui-search-results-header","template":v,"templateHelpers":function(){var e={"searchResults":w.searchResults,"clearAll":w.clearAll,"about":w.about,"searchBackTooltip":w.searchBackTooltip,"searchFilterTooltip":w.filterExpandTooltip,"filterAria":w.filterExpandAria,"enableSearchFilter":this.options.enableFacetFilter,"tabularViewIconTitle":w.tabularSearchView,"descriptionTitle":w.showDescription,"showSettings":!!this.options.enableSearchSettings,"settingsLabel":w.searchSettings,"tabularSearchView":"TabularView"===this.collection.prevSearchDisplayStyle};return{"spritePath":V.getSpritePath(),"messages":e}},"ui":{"back":".cs-go-back","parent":".csui-search-arrow-back-parent","filter":".csui-search-filter","filterParent":".csui-search-facet-filter-parent","resultTitle":".csui-results-title","searchHeaderTitle":".csui-search-header-title","settingsMenu":".csui-search-settings","toggleResultsView":".csui-tabular-view","toggleDescription":".icon-description-toggle"},"events":{"click @ui.back":"onClickBack","click @ui.parent":"onClickBack","keypress @ui.back":"onClickBack","click @ui.filter":"onClickFilter","keypress @ui.filter":"onClickFilter","click @ui.filterParent":"onClickFilter","click @ui.settingsMenu":"_createSettingsDropdown","keydown @ui.settingsMenu":"showSettingsDropdown","click @ui.toggleResultsView":"toggleView","keypress @ui.toggleResultsView":"toggleView","click @ui.toggleDescription":"onToggleDescriptionClick","keypress @ui.toggleDescription":"onToggleDescriptionClick"},"regions":{"settingsRegion":".csui-settings-dropdown"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":b}},"currentlyFocusedElement":function(e){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),e&&e.shiftKey?t(i[i.length-1]):t(i[0]).hasClass("csui-acc-focusable-active")?this.ui.filter:t(i[0])},"namedSessionStorage":new l,"constructor":function(e){e||(e={}),this.localStorage=e&&e.localStorage,s.LayoutView.prototype.constructor.call(this,e),this.collection&&this.listenTo(this.collection,"reset",this.updateHeader).listenTo(this.collection,"remove",this._collectionItemRemoved),this.previousNode=e.context.getModel(a).clone(),this.nextNode=e.context.getModel(r),this.searchQuery=e.context.getModel(d),this.applicationScope=e.context.getModel(y),this.context=e.context,(""===this.applicationScope.previous("id")||this._isPreviousRouter("Landing"))&&this.namedSessionStorage&&this.namedSessionStorage.get("previousNodeId")&&(this.namedSessionStorage.remove("previousNodeName"),this.namedSessionStorage.remove("previousNodeId")),this.localStorage.storage.getItem("PrevSearchDisplayStyle")&&(this.showDescription=this.localStorage.get(this._createSearchDisplayStyleKey()+"_showDescription"))},"initialize":function(){this.titleView=this.options.titleView||new S({})},"updateHeader":function(){this.renderTitleView(),this.collection&&this.collection.length?(this.ui.back.addClass("search_results_data"),this.ui.filter.addClass("search_results_data"),this.ui.toggleResultsView.removeClass("binf-hidden")):(this.ui.back.addClass("search_results_nodata"),this.ui.filter.addClass("search_results_nodata"),this.ui.toggleResultsView.addClass("binf-hidden")),this.updateToggleIcon(),this.updateToggleDescriptionIcon(),this.updateToggleDescription(),"TabularView"===this.collection.prevSearchDisplayStyle&&(this._createSortRegion(),this._createSortingView())},"updateToggleDescriptionIcon":function(){"TabularView"===this.collection.prevSearchDisplayStyle?(this.$el.find(".icon-description-toggle").removeClass("search-settings-none"),this.$el.find(".icon-description-toggle").removeClass("binf-hidden"),this.showDescription?(this.$el.find(".icon-description-toggle").attr("title",w.hideDescription),this.$el.find(".icon-description-toggle").attr("aria-label",w.hideDescription)):(this.$el.find(".icon-description-toggle").attr("title",w.showDescription),this.$el.find(".icon-description-toggle").attr("aria-label",w.showDescription))):(this.$el.find(".icon-description-toggle").addClass("binf-hidden"),this.$el.find(".icon-description-toggle").removeClass("icon-description-shown"))},"updateToggleDescription":function(){if(this.options.originatingView&&"TabularView"===this.options.originatingView.collection.prevSearchDisplayStyle)if(T&&this.options.originatingView.targetView)this.options.originatingView.getAdditionalColumns();else{var e=this.options.originatingView.collection.filter(function(e){return e.get("description")}),t=this.options.originatingView.collection.filter(function(e){return e.get("summary")}),i=this.localStorage.get(this._createSearchDisplayStyleKey()+"_showDescription");switch(this.selectedSettings=this.selectedSettings?this.selectedSettings:this.collection.selectedSettings,this.selectedSettings){case"DO":e.length?(this.$el.find(".icon-description-toggle").removeClass("binf-hidden"),this.trigger("toggle:description",{"showDescriptions":i}),i&&(this.$el.find(".icon-description-toggle").removeClass("icon-description-hidden").addClass("icon-description-shown"),this.$el.find(".csui-description-collapsed").removeClass("csui-description-collapsed"))):this.$el.find(".icon-description-toggle").hasClass("binf-hidden")||(this.$el.find(".icon-description-toggle").addClass("binf-hidden"),this.trigger("toggle:description",{"showDescriptions":!1}),this.options.originatingView&&this.options.originatingView.targetView&&this.options.originatingView.targetView.$el.find(".cs-description").addClass("csui-description-collapsed"));break;case"SP":case"DP":case"SD":e.length||t.length?(this.$el.find(".icon-description-toggle").removeClass("binf-hidden"),this.trigger("toggle:description",{"showDescriptions":i}),i&&(this.$el.find(".icon-description-toggle").removeClass("icon-description-hidden").addClass("icon-description-shown"),this.$el.find(".csui-description-collapsed").removeClass("csui-description-collapsed"))):this.$el.find(".icon-description-toggle").hasClass("binf-hidden")||(this.$el.find(".icon-description-toggle").addClass("binf-hidden"),this.trigger("toggle:description",{"showDescriptions":!1}),this.options.originatingView&&this.options.originatingView.targetView&&this.options.originatingView.targetView.$el.find(".cs-description").addClass("csui-description-collapsed"));break;case"SO":t.length?(this.$el.find(".icon-description-toggle").removeClass("binf-hidden"),this.trigger("toggle:description",{"showDescriptions":i}),i&&(this.$el.find(".icon-description-toggle").removeClass("icon-description-hidden").addClass("icon-description-shown"),this.$el.find(".csui-description-collapsed").removeClass("csui-description-collapsed"))):this.$el.find(".icon-description-toggle").hasClass("binf-hidden")||(this.$el.find(".icon-description-toggle").addClass("binf-hidden"),this.trigger("toggle:description",{"showDescriptions":!1}),this.options.originatingView&&this.options.originatingView.targetView&&this.options.originatingView.targetView.$el.find(".cs-description").addClass("csui-description-collapsed"));break;case"NONE":this.$el.find(".icon-description-toggle").addClass("search-settings-none"),this.options.originatingView&&this.options.originatingView.targetView&&this.options.originatingView.targetView.$el.find(".cs-description").addClass("csui-description-collapsed"),this.trigger("toggle:description",{"showDescriptions":!1})}}},"onRender":function(){this.renderTitleView(),this.collection&&this.collection.length?(this.ui.back.addClass("search_results_data"),this.ui.filter.addClass("search_results_data"),this.ui.toggleResultsView.removeClass("binf-hidden")):(this.ui.back.addClass("search_results_nodata"),this.ui.filter.addClass("search_results_nodata"),this.ui.toggleResultsView.addClass("binf-hidden")),this.rendered=!0,this.$el.show(),this.options.enableBackButton?(this.ui.back.attr("title",this.options.backButtonToolTip),this.ui.back.attr("aria-label",this.options.backButtonToolTip)):m.getInstance(this.options).hasRouted()||history.state||this._isViewStateModelEnabled()||this.previousNode.get("id")||this.namedSessionStorage&&this.namedSessionStorage.get("previousNodeId")||this._isPreviousRouter("Metadata")?this._setBackButtonTitle():(this.ui.back.hide(),this.ui.parent.hide()),this.tableRowSelectionToolbarRegion||(this._createToolbarRegion(),this.options.originatingView._updateToolbarActions())},"renderTitleView":function(){e.extend(this.titleView.options,{"count":this.collection&&this.collection.totalCount,"useCustomTitle":!!this.options.useCustomTitle,"searchHeaderTitle":this.collection&&this.collection.searching?this.collection.searching.result_title:w.searchResults}),this.titleView.render(),s.triggerMethodOn(this.titleView,"before:show",this.titleView,this),this.ui.searchHeaderTitle.append(this.titleView.el),s.triggerMethodOn(this.titleView,"show",this.titleView,this)},"onBeforeDestroy":function(){this.titleView.destroy()},"showSettingsDropdown":function(e){var t=e.keyCode;13!==t&&32!==t||(this._createSettingsDropdown(e),e.preventDefault(),e.stopPropagation())},"_createSettingsDropdown":function(i){i.target.classList.contains("csui-search-settings")&&(!this.settingsView||this.settingsView&&this.settingsView.isDestroyed()?(t(document).on("mouseup.dropdown"+this.cid,e.bind(this._closeSettingsMenu,this)),this.data={},this.settingsView=new p({"model":this.options.settings,"tableCollection":this.collection,"data":this.data,"isTabularView":"TabularView"===this.collection.prevSearchDisplayStyle}),this.listenTo(this.settingsView,"close:menu",e.bind(function(e){this._destroySettingsDropdown(e)},this)),this.settingsRegion.show(this.settingsView),this.propagateEventsToViews(this.settingsView),this.settingsView.$el.find(".binf-show").trigger("focus"),this.settingsView.isVisible=!0,this.listenTo(this.settingsView,"update:showSummaryDescriptions",function(){this.selectedSettings=this.settingsView.model.get("display").summary_description.selected,"TabularView"===this.collection.prevSearchDisplayStyle?(this.options.originatingView.targetView.selectedSettings=this.selectedSettings,this.options.originatingView.targetView.options.descriptionRowViewOptions.showSummaryOnly="SO"===this.selectedSettings,this.render(),this.updateHeader(),this._createSortRegion(),this._createSortingView(),this._createToolbarRegion(),this.options.originatingView._updateToolbarActions(),this.options.originatingView.collection.selectedItems&&this.options.originatingView.collection.selectedItems.length>0&&(this.options.originatingView.collection.selectedItems.reset(this.options.originatingView.targetView._allSelectedNodes.models),this.options.originatingView.targetView._tableRowSelectionToolbarView.trigger("toggle:condensed:header"))):(this.options.originatingView.targetView.render(),this.options.originatingView.targetView.trigger("render:metadata"))})):this._destroySettingsDropdown())},"_destroySettingsDropdown":function(i){if(this.settingsView.destroy(),t(document).off("mouseup.dropdown"+this.cid),this.data.summary_description||this.data.display_regions){this.options.originatingView.blockActions(),this.collection.isSortOptionSelected=!0,this.formData=new FormData;var s=this;e.mapObject(this.data,function(e,t){"display_regions"===t?s.formData.append(t,e):"summary_description"===t&&s.formData.append(t,e)}),this.settingsView.model.save(null,{"parse":!1,"data":this.formData,"processData":!1,"cache":!1,"contentType":!1}).done(e.bind(function(e){s.data.summary_description&&(s.settingsView.model.get("display").summary_description.selected=s.data.summary_description,s.settingsView.trigger("update:showSummaryDescriptions"),s.options.originatingView.collection.settings_changed=!1),s.data.display_regions&&(s.options.originatingView.unblockActions(),s.options.originatingView.collection.settings_changed=!0,s.settingsView.options.tableCollection.fetch()),s.options.originatingView.collection.settings_changed||(s.options.originatingView.executeEndProcess(),s.trigger("render:table")),this.$el.find(".csui-search-settings").trigger("focus")},this)).fail(function(e){e=new n.Error(e),g.showMessage("error",e.message),s.options.originatingView.unblockActions()}),this.options.originatingView&&this.options.originatingView.targetView&&this.options.originatingView.targetView.standardHeaderView&&(this.options.originatingView.targetView.standardHeaderView.expandAllView.pageChange(),this.options.originatingView.targetView.standardHeaderView.expandAllView._isExpanded=!1)}if(this.settingsView.isChanged){var o=this.settingsView.model.get("display").display_regions.selected;e.each(this.options.originatingView.tableColumns.models,e.bind(function(e){var t=e.get("key");if("reserved"!==t&&"favorite"!==t){var i=o.findWhere({"key":t}),s=o.indexOf(i);e.set("sequence",s)}},this)),this.options.originatingView&&(this.trigger("render:table"),this.settingsView.isChanged=!1)}},"_closeSettingsMenu":function(e){this.ui.settingsMenu.is&&this.ui.settingsMenu.is(e&&e.target)||this.settingsView&&this.settingsView.$el.has(e&&e.target).length?e.stopPropagation():this.settingsView&&this.settingsView.isDestroyed()||(this._destroySettingsDropdown(e),this.$el.find(".csui-search-settings").trigger("focus"))},"onToggleDescriptionClick":function(e){if("keypress"===e.type&&(13===e.keyCode||32===e.keyCode)||"click"===e.type){e.preventDefault();var t=this.options.originatingView;this.showDescription?(this.localStorage.set(this._createSearchDisplayStyleKey()+"_showDescription",!1),t.targetView.options.descriptionRowViewOptions.showDescriptions=!1,t.$el.find(".icon-description-toggle").addClass("icon-description-hidden").removeClass("icon-description-shown"),this.$el.find(".icon-description-toggle").attr("title",w.showDescription),this.$el.find(".icon-description-toggle").attr("aria-label",w.showDescription),t.$el.find(".cs-description").addClass("csui-description-collapsed"),this.showDescription=!1,this.trigger("toggle:description",{"showDescriptions":!1})):(this.localStorage.set(this._createSearchDisplayStyleKey()+"_showDescription",!0),t.targetView.options.descriptionRowViewOptions.showDescriptions=!0,this.$el.find(".icon-description-toggle").attr("title",w.hideDescription),this.$el.find(".icon-description-toggle").attr("aria-label",w.hideDescription),t.$el.find(".icon-description-toggle").removeClass("icon-description-hidden").addClass("icon-description-shown"),t.$el.find(".csui-description-collapsed").removeClass("csui-description-collapsed"),this.showDescription=!0,this.trigger("toggle:description",{"showDescriptions":!0})),this.$el.find(".icon-description-toggle").trigger("focus")}},"toggleView":function(e){("keypress"!==e.type||13!==e.keyCode&&32!==e.keyCode)&&"click"!==e.type||(e.stopImmediatePropagation(),e.preventDefault(),"TabularView"===this.collection.prevSearchDisplayStyle?(this.$el.parent("#header").hasClass("csui-show-header")&&this.$el.parent("#header").removeClass("csui-show-header"),this.$el.find(".csui-table-rowselection-toolbar").addClass("binf-hidden"),this._prevSearchDisplayStyleLocalStorage("StandardView"),this.collection.prevSearchDisplayStyle="StandardView",_&&_.$el.empty()):(this._prevSearchDisplayStyleLocalStorage("TabularView"),this.collection.prevSearchDisplayStyle="TabularView",this._createSortRegion(),this.collection.isSortOptionSelected=!0,this._createSortingView(),this._createToolbarRegion()),this.updateToggleIcon(),this.updateToggleDescriptionIcon(),this.updateToggleDescription(),this.trigger("reload:searchForm"))},"updateToggleIcon":function(){"TabularView"===this.collection.prevSearchDisplayStyle?(this.ui.toggleResultsView.attr("title",w.standardSearchView),this.ui.toggleResultsView.attr("aria-label",w.standardSearchView),this.ui.toggleResultsView.find(".csui-icon-off").addClass("binf-hidden"),this.ui.toggleResultsView.find(".csui-icon-on").removeClass("binf-hidden")):(this.ui.toggleResultsView.attr("title",w.tabularSearchView),this.ui.toggleResultsView.attr("aria-label",w.tabularSearchView),this.ui.toggleResultsView.find(".csui-icon-on").addClass("binf-hidden"),this.ui.toggleResultsView.find(".csui-icon-off").removeClass("binf-hidden"))},"_createSortRegion":function(){_=new s.Region({"el":"#csui-search-sorting"})},"_createSortingView":function(){var e,t=this.options.originatingView;t&&(e=t.sortingView?t.sortingView:new f({"collection":this.options.collection,"enableSorting":void 0===this.options.enableSorting||this.options.enableSorting}),_.show(e))},"_createToolbarRegion":function(){var e=new s.Region({"el":".csui-search-results-header .csui-table-rowselection-toolbar"});this.tableRowSelectionToolbarRegion=e},"_isPreviousRouter":function(e){
var t=this.context.viewStateModel;return t&&t.get(t.CONSTANTS.LAST_ROUTER)===e},"_syncStorage":function(e,t){this.namedSessionStorage.set("previousNodeName",e),this.namedSessionStorage.set("previousNodeId",t)},"_prevSearchDisplayStyleLocalStorage":function(e){this.localStorage.set(this._createSearchDisplayStyleKey(),e)},"_setBackButtonTitle":function(){var t;if(this._isPreviousRouter("Metadata")){var i=this.context.viewStateModel,s=i.get(i.CONSTANTS.METADATA_CONTAINER);t=s.name,this._syncStorage(t,s.id)}else void 0!==this.searchQuery.attributes.location_id1||this.previousNode.get("id")||this.namedSessionStorage&&this.namedSessionStorage.get("previousNodeId")?this.previousNode.get("id")?(t=this.previousNode.get("name"),this._syncStorage(t,this.previousNode.get("id"))):t=this.namedSessionStorage.get("previousNodeName"):(t=w.searchBackToHome,this.namedSessionStorage=null);this.ui.back.attr("title",e.str.sformat(w.searchBackTooltipTo,t)),this.ui.back.attr("aria-label",e.str.sformat(w.searchBackTooltipTo,t))},"setCustomSearchTitle":function(e){!!this.titleView.setCustomSearchTitle&&this.titleView.setCustomSearchTitle(e)},"_collectionItemRemoved":function(){var e=this.collection.totalCount;this.collection.totalCount=--this.collection.totalCount,"TabularView"===this.collection.prevSearchDisplayStyle&&this.tableRowSelectionToolbarRegion&&delete this.tableRowSelectionToolbarRegion,this.render(),this.collection.totalCount=e},"onClickBack":function(e){this.backButtonClicked||(this.backButtonClicked=!0,("keypress"===e.type&&13===e.keyCode||"click"===e.type)&&(this.options.enableBackButton?(e.stopPropagation(),this.trigger("go:back")):this._isViewStateModelEnabled()?this.context.viewStateModel.restoreLastRouter():this.previousNode.get("id")||this.namedSessionStorage&&this.namedSessionStorage.get("previousNodeId")?(this.nextNode.set("id",void 0,{"silent":!0}),this.nextNode.set("id",this.namedSessionStorage.get("previousNodeId"))):this.applicationScope.set("id","")))},"_isViewStateModelEnabled":function(){return this.context&&this.context.viewStateModel},"onClickFilter":function(e){("keypress"===e.type&&13===e.keyCode||"click"===e.type)&&(e.preventDefault(),e.stopPropagation(),this.trigger("toggle:filter",this.options.originatingView),this.trigger("focus:filter",this.options.originatingView))},"_createSearchDisplayStyleKey":function(){var e,t=this.context||this.options&&this.options.context,i=(new o).getAbsolute(),s=t&&t.getModel(h).get("id");return i&&(e=i.split("//")[1].split("/")[0].split(":")[0]),e+s}});return e.extend(x.prototype,C),x}),csui.define("hbs!csui/widgets/search.results/impl/metadata/search.metadata",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<span class="csui-search-metadata binf-col-lg-4 binf-col-md-4 binf-col-sm-4\r\n                    binf-col-xs-4" title="'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'</span>\r\n<span class="csui-search-metadata-spacer binf-col-lg-1 binf-col-md-1 binf-col-sm-1\r\n     binf-col-xs-1"></span>\r\n<span class="searchDetails binf-col-lg-7 binf-col-md-7 binf-col-sm-7\r\n                    binf-col-xs-7" title="'+this.escapeExpression((o=null!=(o=t.tooltipText||(null!=e?e.tooltipText:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tooltipText","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</span>\r\n"}});return i.registerPartial("csui_widgets_search.results_impl_metadata_search.metadata",s),s}),csui.define("csui/widgets/search.results/impl/metadata/search.metadata.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/base","csui/controls/table/cells/cell.factory","csui/controls/table/cells/templated/templated.view","csui/utils/types/date","i18n!csui/widgets/search.results/impl/nls/lang","hbs!csui/widgets/search.results/impl/metadata/search.metadata","css!csui/widgets/search.results/impl/search.results"],function(e,t,i,s,o,n,a,r){"use strict";var l=t.ItemView.extend({"className":"csui-search-item-details binf-col-lg-12","template":r,"attributes":{"role":"listitem"},"templateHelpers":function(){this._index<this.options.displayCount?this._index<2&&this.el.classList.add("csui-search-result-item-tobe-hide"):(this.el.classList.add("csui-search-hidden-items"),this.el.classList.add("truncated-"+this.options.rowId));var e=s.getCellView(this.model);""===e.columnClassName&&(e=o);var t={"CellView":e,"attributes":this.model.attributes,"name":this.model.get("key"),"title":this.model.get("title")||this.model.get("name")||this.model.get("column_name")},i=new e({"tagName":"span","model":this.options.searchItemModel,"column":t}),n=i.getValueData&&i.getValueData();return{"label":this.model.get("name"),"value":n&&(n.formattedValue||n.value||n.name),"tooltipText":n&&(n.value||n.name||n.nameAria)}}});return t.CollectionView.extend({"className":"csui-search-items-metadata","childView":l,"ui":{"fieldsToBeHiddenOnHover":".csui-search-result-item-tobe-hide"},"childViewOptions":function(){return{"rowId":this.options.rowId,"searchItemModel":this.model,"displayCount":this.childDisplayCount}},"constructor":function(e){e||(e={}),this.options=e,t.CollectionView.prototype.constructor.apply(this,arguments);var i=this.model.get("description"),s=this.model.get("summary");this.childDisplayCount=s&&s.length||i&&i.length?3:2},"filter":function(e,t,i){return"size"===e.get("key")||"OTObjectSize"===e.get("key")?this.model.get(e.get("key"))&&""!==this.model.get(e.get("key")+"_formatted"):["OTLocation","OTName","OTMIMEType","reserved","favorite"].indexOf(e.get("key"))>=0?void 0:this.model.get(e.get("key"))&&""!==this.model.get(e.get("key"))},"onRender":function(){this.collection;this.collection.comparator=function(e){return e.get("definitions_order")},this.collection.sort(),this.bindUIElements()}})}),csui.define("hbs!csui/widgets/search.results/impl/breadcrumbs/search.breadcrumbs",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'    <li role="menuitem" class="csui-breadcrumb-menu binf-hidden">\r\n      <a class=\'csui-breadcrumb csui-acc-focusable\' href="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.node_link_url:o,e))+'"\r\n         data-id="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.id:o,e))+'"\r\n         title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.name:o,e))+'">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.name:o,e))+"</a>\r\n"},"3":function(e,t,i,s){var o;return'  <li class="tail">\r\n    <a class="csui-breadcrumb csui-acc-focusable" href="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.node_link_url:o,e))+'"\r\n       data-id="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.id:o,e))+'"\r\n       title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.name:o,e))+'">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.attributes:e)?o.name:o,e))+"</a>\r\n  </li>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<li class="binf-dropdown binf-hidden binf-search-breadcrumb-ddmenu">\r\n  <a href="#" class="binf-dropdown-toggle csui-subcrumb csui-acc-focusable"\r\n     data-binf-toggle="dropdown" title="'+this.escapeExpression((n=null!=(n=t.subcrumbTooltip||(null!=e?e.subcrumbTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"subcrumbTooltip","hash":{}}):n))+'">...</a>\r\n  <ul class="binf-dropdown-menu" role="menu">\r\n'+(null!=(o=t.each.call(e,null!=e?e.crumbs:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+"  </ul>\r\n</li>\r\n\r\n"+(null!=(o=t.each.call(e,null!=e?e.crumbs:e,{"name":"each","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")}});return i.registerPartial("csui_widgets_search.results_impl_breadcrumbs_search.breadcrumbs",s),s}),csui.define("csui/widgets/search.results/impl/breadcrumbs/search.breadcrumbs.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette3","hbs!csui/widgets/search.results/impl/breadcrumbs/search.breadcrumbs","csui/utils/contexts/factories/next.node","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/node.links/node.links"],function(e,t,i,s,o,n,a,r){return s.View.extend({"tagName":"ol","className":"binf-breadcrumb","template":o,"templateContext":function(){return{"crumbs":this.collection.models,"subcrumbTooltip":this.lang.subcrumbTooltip}},"behaviors":{"TabableRegion":{"behaviorClass":a}},"events":{"keydown":"onKeyInView"},"_breadcrumbSelector":"a.csui-acc-focusable:visible","constructor":function(e){e||(e={}),this.lang=e.lang||{},this.collection=e.collection,this.isRtl=e.isRtl,this.connector=this.collection.connector;for(var i=this.collection.models,o=0;o<i.length;o++)i[o].attributes.node_link_url=this._getAncestorUrl(i[o]);s.View.call(this,e),this.listenTo(this.collection,"update reset",this._adjustToFit),this.context=this.options.context,this.accLastBreadcrumbElementFocused=!0,this.accNthBreadcrumbElementFocused=0,this.resizeTimer=void 0,t(window).on("resize."+this.cid,{"view":this},this._onWindowResize)},"_getAncestorUrl":function(e){return e.get("id")>0&&this.connector&&r.getUrl(e,{"connector":this.connector})||"#"},"_onWindowResize":function(e){if(e&&e.data&&e.data.view){var t=e.data.view;t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){t._adjustToFit()},200)}},"isTabable":function(){return this.collection.models.length>1},"currentlyFocusedElement":function(){if(this.isTabable()){if(this.accLastBreadcrumbElementFocused)return this.$(this._breadcrumbSelector+":last");var e=this.$(this._breadcrumbSelector);return t(e[this.accNthBreadcrumbElementFocused])}return t()},"synchronizeCollections":function(){return!0},"onKeyInView":function(e){var t;switch(e.keyCode){case 37:case 38:t=this.$(this._breadcrumbSelector),this.accLastBreadcrumbElementFocused?t.length>1&&(this.accLastBreadcrumbElementFocused=!1,this.accNthBreadcrumbElementFocused=t.length-2):this.accNthBreadcrumbElementFocused>0&&this.accNthBreadcrumbElementFocused--,this.trigger("changed:focus",this),this.currentlyFocusedElement().trigger("focus");break;case 39:case 40:this.accLastBreadcrumbElementFocused||(t=this.$(this._breadcrumbSelector),this.accNthBreadcrumbElementFocused<t.length-1&&(this.accNthBreadcrumbElementFocused++,this.trigger("changed:focus",this),this.currentlyFocusedElement().trigger("focus")))}},"refresh":function(){this._adjustToFit()},"_adjustToFit":function(){if(this.collection.length>1){this.options.hasPromoted&&this.render(),this.el.getElementsByClassName("binf-dropdown")[0].classList.add("binf-hidden");var t=this.el.offsetWidth,i=this.el.getElementsByClassName("tail"),s=this.el.getElementsByClassName("csui-breadcrumb-menu"),o=i[i.length-1],n=0,a=e.bind(function(e){0===e&&this.el.getElementsByClassName("binf-dropdown")[0].classList.remove("binf-hidden"),i[e].classList.add("binf-hidden"),s[e].classList.remove("binf-hidden")},this);this.options.hasPromoted&&(n=this.$el.closest(".csui-search-promoted-breadcrumbs-row").find(".csui-search-promoted").outerWidth()+1);for(var r=0;r<i.length;r++)i[r].classList.remove("binf-hidden"),s[r].classList.add("binf-hidden");for(r=0;r<this.collection.length-1;r++)if(this.isRtl){if(!(o.offsetLeft>this.el.offsetLeft))break;a(r)}else{if(!(t<o.offsetLeft+32-n))break;a(r)}this.triggerMethod("tabable")}},"_getMaxDisplayWidth":function(){return.9*this.el.offsetWidth},"_getDisplayWidth":function(){for(var e=this.el.children,t=0,i=0;i<e.length;i++)t+=e[i].offsetWidth;return t},"onClickAncestor":function(e,t){},"onBeforeDestroy":function(){t(window).off("resize."+this.cid,this._onWindowResize)}})}),csui.define("hbs!csui/widgets/search.results/impl/search.result",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return' aria-describedby="idOfPromotedLabel" '},"3":function(e,t,i,s){var o,n;return'                <div class="csui-search-results-version csui-search-item-version-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n                  <a href="javascript:void(0);" class="csui-search-version-label">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.versionLabel:o,e))+" "+this.escapeExpression(this.lambda(null!=(o=null!=e?e.versions:e)?o.version_number_name:o,e))+"\r\n                  </a>\r\n                </div>\r\n"},"5":function(e,t,i,s){var o;return'              <div class="csui-search-promoted" id="idOfPromotedLabel" aria-label="'+this.escapeExpression((o=null!=(o=t.promoted_label||(null!=e?e.promoted_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"promoted_label","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.promoted_label||(null!=e?e.promoted_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"promoted_label","hash":{}}):o))+'">\r\n                <span class="csui-search-promoted-label">'+this.escapeExpression((o=null!=(o=t.promoted_label||(null!=e?e.promoted_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"promoted_label","hash":{}}):o))+"</span>\r\n              </div>\r\n"},"7":function(e,t,i,s){var o;return'              <div class="csui-search-breadcrumb">\r\n                <div class="csui-search-item-breadcrumb csui-search-item-breadcrumb-'+this.escapeExpression((o=null!=(o=t.cid||(null!=e?e.cid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'"></div>\r\n                <div class="csui-search-row-spacer binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n                binf-col-xs-12"></div>\r\n              </div>\r\n'},"9":function(e,t,i,s){var o;return'              <div class="csui-search-item-action-'+this.escapeExpression((o=null!=(o=t.cid||(null!=e?e.cid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+"-"+this.escapeExpression((o=null!=(o=t.version_id||(null!=e?e.version_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"version_id","hash":{}}):o))+' csui-search-item-inline-actions"></div>\r\n'},"11":function(e,t,i,s){var o;return'              <div class="csui-search-item-action-'+this.escapeExpression((o=null!=(o=t.cid||(null!=e?e.cid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+' csui-search-item-inline-actions"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'<div class="csui-search-item-row-wrapper csui-search-item-complete-row binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="csui-search-item-row binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <h3 class="csui-search-item-hide-h3">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</h3>\r\n    <div class="csui-search-item-check"></div>\r\n    <div class="csui-search-item-icon">\r\n      <a href='+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+"\r\n       "+(null!=(o=t.if.call(e,null!=e?e.has_promoted:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'\r\n                        aria-label="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+" "+this.escapeExpression((n=null!=(n=t.mimeTypeAria||(null!=e?e.mimeTypeAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"mimeTypeAria","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.OTName||(null!=e?e.OTName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"OTName","hash":{}}):n))+'"\r\n                  class="csui-search-item-link '+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.inactiveclass:o,e))+'"><span class="csui-type-icon"></span></a>\r\n      </div>\r\n    <div class="csui-search-col2 binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="csui-search-item-left-panel binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n        <div class="csui-search-item">\r\n          <div class="csui-search-item-name-wrapper">\r\n            <div class="csui-search-item-name ">\r\n              <a href='+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+"  "+(null!=(o=t.if.call(e,null!=e?e.has_promoted:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'\r\n                  aria-label="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+" "+this.escapeExpression((n=null!=(n=t.mimeTypeAria||(null!=e?e.mimeTypeAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"mimeTypeAria","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.OTName||(null!=e?e.OTName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"OTName","hash":{}}):n))+'"\r\n                  class="csui-search-item-link '+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.inactiveclass:o,e))+'">'+this.escapeExpression((n=null!=(n=t.OTName||(null!=e?e.OTName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"OTName","hash":{}}):n))+"</a>\r\n"+(null!=(o=t.if.call(e,null!=e?e.has_version:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?o:"")+'              <div class="csui-icon csui-search-results-nodestateicon csui-search-item-nodestateicon\r\n                  csui-search-item-nodestateicon-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class="csui-search-item-content-wrapper binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <div class="csui-search-promoted-breadcrumbs-row">\r\n'+(null!=(o=t.if.call(e,null!=e?e.has_promoted:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?o:"")+(null!=(o=t.if.call(e,null!=(o=null!=e?e.messages:e)?o.showBreadcrumb:o,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?o:"")+'          </div>\r\n          <p class="csui-search-item-desc csui-overflow-description binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></p>\r\n          <div class="csui-search-row-spacer binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n        binf-col-xs-12 csui-search-row-spacer-divider"></div>\r\n          <p class="csui-search-item-summary csui-overflow-summary binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></p>\r\n        </div>\r\n        <div class="csui-search-row-spacer binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n        binf-col-xs-12 csui-search-row-spacer-divider"></div>\r\n      </div>\r\n      <div class="csui-search-item-center-panel binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n      <div class="csui-search-item-right-panel">\r\n        <div class="csui-search-item-control-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+' binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <div class="csui-search-toolbar-container binf-hidden binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(o=t.if.call(e,null!=e?e.version_id:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?o:"")+'          </div>\r\n          <div class="csui-search-row-spacer binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n          <div role="list" class="csui-search-item-details-wrapper binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="csui-search-item-action-panel csui-search-item-action-panel-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n      <div class="csui-search-item-fav search-fav-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>'}});return i.registerPartial("csui_widgets_search.results_impl_search.result",s),s}),csui.define("hbs!csui/widgets/search.results/impl/search.empty",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="csui-no-result-message-wrapper">\r\n    <p class="csui-no-result-message" title="'+this.escapeExpression((o=null!=(o=t.message||(null!=e?e.message:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"message","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.message||(null!=e?e.message:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"message","hash":{}}):o))+'</p>\r\n    <div class="csui-display-hide">\r\n        <ul class="csui-search-suggestion-list">\r\n            <li>'+this.escapeExpression((o=null!=(o=t.searchSuggestion1||(null!=e?e.searchSuggestion1:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"searchSuggestion1","hash":{}}):o))+"</li>\r\n            <li>"+this.escapeExpression((o=null!=(o=t.searchSuggestion2||(null!=e?e.searchSuggestion2:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"searchSuggestion2","hash":{}}):o))+"</li>\r\n            <li>"+this.escapeExpression((o=null!=(o=t.searchSuggestion3||(null!=e?e.searchSuggestion3:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"searchSuggestion3","hash":{}}):o))+"</li>\r\n            <li>"+this.escapeExpression((o=null!=(o=t.searchSuggestion4||(null!=e?e.searchSuggestion4:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"searchSuggestion4","hash":{}}):o))+"</li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n"}});return i.registerPartial("csui_widgets_search.results_impl_search.empty",s),s}),csui.define("hbs!csui/widgets/search.results/controls/expandall/impl/expandall",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o;return'<div class="csui-search-expandall-wrapper">\r\n  <div class="csui-search-expandall-text"\r\n       title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.expandAll:o,e))+'">'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.expandAll:o,e))+'</div>\r\n  <button class="csui-search-header-expand-all" aria-label="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.expandAll:o,e))+'"\r\n          title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.expandAll:o,e))+'" aria-pressed="false">\r\n    <span class="icon csui-icon icon-expandArrowDown"></span>\r\n  </button>\r\n</div>'}});return i.registerPartial("csui_widgets_search.results_controls_expandall_impl_expandall",s),s}),csui.define("css!csui/widgets/search.results/controls/expandall/impl/expandall",[],function(){}),csui.define("csui/widgets/search.results/controls/expandall/expandall.view",["csui/lib/jquery","csui/lib/marionette","hbs!csui/widgets/search.results/controls/expandall/impl/expandall","i18n!csui/widgets/search.results/impl/nls/lang","css!csui/widgets/search.results/controls/expandall/impl/expandall"],function(e,t,i,s){return t.ItemView.extend({"template":i,"templateHelpers":function(){return{"messages":{"expandAll":s.expandAll}}},"events":{"click @ui.expandAllSelector":"expandAll"},"ui":{"expandAllSelector":".csui-search-header-expand-all","expandIcon":".icon","expandAllLabelText":".csui-search-expandall-text"},"expandAll":function(t){if(this.collection.length>0){this._isExpanded?(this._isExpanded=!1,this.ui.expandAllLabelText.html(s.expandAll),this.ui.expandAllLabelText.attr("title",s.expandAll),e(".csui-expand-all").addClass("csui-collapse-all"),this.ui.expandIcon.removeClass("icon-expandArrowUp"),this.ui.expandIcon.addClass("icon-expandArrowDown"),this.ui.expandIcon.attr("title",s.expandAll),this.ui.expandAllSelector.attr("title",s.expandAll).attr("aria-pressed","true").attr("aria-label",s.expandAll),this.options.view.$el.find("."+this.options._eleCollapse).trigger("click")):(this._isExpanded=!0,this.ui.expandAllLabelText.html(s.collapseAll),this.ui.expandAllLabelText.attr("title",s.collapseAll),e(".csui-expand-all").removeClass("csui-collapse-all"),this.ui.expandIcon.removeClass("icon-expandArrowDown"),this.ui.expandIcon.addClass("icon-expandArrowUp"),this.ui.expandIcon.attr("title",s.collapseAll),this.ui.expandAllSelector.attr("title",s.collapseAll).attr("aria-pressed","false").attr("aria-label",s.collapseAll),this.options.view.$el.find("."+this.options._eleExpand).trigger("click")),this.options.view.options.layoutView&&this.options.view.options.layoutView.updateScrollbar(),t.preventDefault(),t.stopPropagation()}},"pageChange":function(){this.ui.expandIcon instanceof Object&&this.ui.expandIcon[0].classList.contains(this.options._eleCollapse)&&(this.ui.expandIcon.removeClass(this.options._eleCollapse).addClass(this.options._eleExpand).attr("title",s.expandAll),this.ui.expandAllLabelText.html(s.expandAll),this.ui.expandAllLabelText.attr("title",s.expandAll),this.ui.expandAllSelector.attr("title",s.expandAll).attr("aria-pressed","false").attr("aria-label",s.expandAll))}})}),csui.define("hbs!csui/widgets/search.results/impl/standard/standard.search.results.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div\r\n    class="csui-search-header-left-actions binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div id="selectAllCheckBox" class="csui-select-all csui-search-item-check"></div>\r\n    <div id="SelectedItemsCounter" class="csui-selected-items-counter-view"></div>\r\n    <div id="toolbar"\r\n         class="csui-search-toolbar binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n  </div>\r\n</div>\r\n<div class="csui-search-header-right-actions">\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="csui-search-header-actions">\r\n      <div class="csui-search-sorting" id="csui-search-sort"></div>\r\n      <div class="csui-expand-all" id="expandAllArrow"></div>\r\n    </div>\r\n  </div>\r\n</div> \r\n'}});return i.registerPartial("csui_widgets_search.results_impl_standard_standard.search.results.header",s),s}),csui.define("csui/widgets/search.results/impl/standard/standard.search.results.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/tabletoolbar/tabletoolbar.view","csui/widgets/search.results/controls/expandall/expandall.view","csui/controls/checkbox/checkbox.view","csui/widgets/search.results/controls/sorting/sort.menu.view","csui/controls/selected.count/selected.count.view","csui/models/node/node.model","i18n!csui/widgets/search.results/impl/nls/lang","hbs!csui/widgets/search.results/impl/standard/standard.search.results.header","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","css!csui/widgets/search.results/impl/search.results"],function(e,t,i,s,o,n,a,r,l,c,h,d,u){"use strict";var m=s.LayoutView.extend({"template":d,"regions":{"expandAllRegion":"#expandAllArrow","sortRegion":"#csui-search-sort","selectAllRegion":"#selectAllCheckBox","toolbarRegion":"#toolbar","selectedCounterRegion":"#SelectedItemsCounter"},"constructor":function(e){e||(e={}),this.collection=e.collection,this.resultsView=e.view,this.options=e.options,this.localStorage=e.localStorage,s.LayoutView.prototype.constructor.call(this,e),this.listenTo(this.collection,"remove",this._updateToolItems).listenTo(this.collection,"sync",this._updateToolItems),this.setSelectAllView(),this.setSortingView(),this.setExpandAllView(),this._setToolBar(),this._setSelectionCounterView(),this.listenTo(this.collection,"sync",this._removeAllSelections),this.listenTo(this.collection,"reset",function(){this.expandAllView.pageChange()}),this.listenTo(this,"dom:refresh",this._refreshEle),this.listenTo(this.options.originatingView,"query:changed",function(){this.expandAllView&&(this.expandAllView._isExpanded=!1)})},"_refreshEle":function(){this.toolbarView&&this.toolbarView.trigger("dom:refresh"),this._selectAllView&&this._selectAllView.triggerMethod("dom:refresh"),this.expandAllView&&this.expandAllView.triggerMethod("dom:refresh")},"onRender":function(){this.sortRegion.show(this.sortingView),this.expandAllRegion.show(this.expandAllView),this.selectedCounterRegion.show(this.selectedCounterView),this.selectAllRegion.show(this._selectAllView),this.toolbarRegion.show(this.toolbarView),this._updateToolItems()},"_setToolBar":function(){var t=this,i=new c({"id":void 0},{"connector":this.collection.connector});this.collection.node=i,this.toolbarView=new o({"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"collection":this.collection,"originatingView":this.options.originatingView,"container":this.container,"context":this.options.context,"toolbarCommandController":this.options.originatingView.commandController,"events":function(){return e.extend({},o.prototype.events,{"keydown":t.onKeyInViewInToolbarView})}}),this.listenTo(this.toolbarView,"refresh:tabindexes",function(){this.toolbarView.$el.find(".csui-otherToolbar>ul>li>a:visible").attr("tabindex",0)})},"_updateToolItems":function(){if(this.toolbarView){var e=this.collection.selectedItems.models;e&&1===e.length?this.toolbarView.options.collection.node=e[0].parent:this.toolbarView.options.collection.node=new c({"id":void 0},{"connector":this.collection.connector}),this.toolbarView.updateForSelectedChildren(e)}},"onKeyInViewInToolbarView":function(e){switch(e.keyCode){case 37:case 39:e.preventDefault(),e.stopPropagation()}},"_setSelectionCounterView":function(){this.selectedCounterView=new l({"collection":this.collection.selectedItems,"scrollableParent":".csui-result-list"}),this.listenTo(this.collection.selectedItems,"remove reset add",this._updateToolItems),this.listenTo(this.selectedCounterView.collection,"remove",this._updateRowsState),this.listenTo(this.selectedCounterView.collection,"reset",e.bind(function(){"StandardView"===this.collection.prevSearchDisplayStyle&&this.resultsView._rowStates.set(m.RowStatesSelectedRows,[])},this))},"_updateRowsState":function(t){var i=[];t instanceof Array?i=t:i.push(t),"StandardView"===this.collection.prevSearchDisplayStyle&&e.each(i,function(t){var i=this.resultsView._rowStates.get(m.RowStatesSelectedRows);i=e.without(i,t.get("id")),this.collection.selectedItems.remove(t),this.resultsView._rowStates.set(m.RowStatesSelectedRows,i)},this)},"setSelectAllView":function(){this._selectAllView=new a({"checked":this._calculateSelectAllCheckedStatus(),"disabled":0===this.collection.length,"ariaLabel":h.selectAllAria,"title":h.selectAll}),this.listenTo(this._selectAllView,"clicked",function(e){
switch(e.cancel=!0,this._selectAllView.model.get("checked")){case"true":this.resultsView._rowStates.get(m.RowStatesSelectedRows).forEach(function(e){var t=this.collection.selectedItems.findWhere({"id":e});this.collection.selectedItems.remove(t)},this),this.resultsView._rowStates.set(m.RowStatesSelectedRows,[]);break;default:var t=[],i=this.collection.filter(function(e){return!1!==e.get("selectable")&&(t.push(e.get("id")),!this.collection.selectedItems.findWhere({"id":e.get("id")}))},this);this.collection.selectedItems.add(i),this.resultsView._rowStates.set(m.RowStatesSelectedRows,t)}}),this.listenTo(this.resultsView._rowStates,"change:"+m.RowStatesSelectedRows,function(){this._updateSelectAllCheckbox()}),this.listenTo(this.collection,"reset",function(){this._updateSelectAllCheckbox()})},"_updateSelectAllCheckbox":function(){this._selectAllView&&(this._selectAllView.setChecked(this._calculateSelectAllCheckedStatus()),this._selectAllView.setDisabled(0===this.collection.length))},"_removeAllSelections":function(){var t=[];this.collection.each(e.bind(function(e){this.collection.selectedItems.findWhere({"id":e.get("id")})&&t.push(e.get("id"))},this)),t.length&&this.resultsView._rowStates.set({"selected":[]},{"silent":!0}),this.resultsView._rowStates.set(m.RowStatesSelectedRows,t)},"_calculateSelectAllCheckedStatus":function(){var e=this.resultsView._rowStates.get(m.RowStatesSelectedRows);if(e&&e.length){var t=e.length===this.collection.length;return e.length>0&&!t?"mixed":e.length>0}},"setSortingView":function(){return this.sortingView=new r({"collection":this.collection,"enableSorting":void 0===this.options.enableSorting||this.options.enableSorting}),!0},"setExpandAllView":function(){return this.expandAllView=new n({"collection":this.collection,"view":this.resultsView,"_eleCollapse":"icon-expandArrowUp","_eleExpand":"icon-expandArrowDown"}),this.expandAllView}},{"RowStatesSelectedRows":"selected"});return e.extend(m.prototype,u),m}),csui.define("csui/widgets/search.results/impl/standard/standard.search.results.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/progressblocker/blocker","csui/controls/table/cells/favorite/favorite.view","csui/controls/checkbox/checkbox.view","csui/controls/node.state/node.states.view","csui/controls/node.state/node.state.icons","csui/widgets/search.results/impl/metadata/search.metadata.view","i18n!csui/widgets/search.results/impl/nls/lang","csui/controls/tableactionbar/tableactionbar.view","i18n","csui/models/node/node.model","csui/utils/nodesprites","csui/controls/node-type.icon/node-type.icon.view","csui/widgets/search.results/impl/breadcrumbs/search.breadcrumbs.view","csui/models/nodeancestors","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/search.metadata.factory","hbs!csui/widgets/search.results/impl/search.result","hbs!csui/widgets/search.results/impl/search.empty","csui/utils/node.links/node.links","csui/utils/accessibility","csui/utils/log","csui/widgets/search.results/impl/standard/standard.search.results.header.view","csui/lib/handlebars.helpers.xif","css!csui/widgets/search.results/impl/search.results","csui/lib/jquery.mousehover","csui/lib/jquery.redraw"],function(e,t,i,s,o,n,a,r,l,c,h,d,u,m,p,g,b,f,w,v,y,S,C,V,_,T,x,k){"use strict";var I=T.isAccessibleTable(),A=t.extend({"enableFacetFilter":!0,"enableBreadcrumb":!0,"enableSearchSettings":!0,"showInlineActionBarOnHover":!I,"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble"},e.config()),D={"isAppleMobile":n.isAppleMobile(),"mimeTypes":{},"isRtl":p&&p.settings.rtl},R=o.ItemView.extend({"className":"csui-empty","template":V,"constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}}),E=o.LayoutView.extend({"className":function(){var e="binf-list-group-item binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 ";return e+=this.hasVersioned?"csui-search-result-version-item":"",e+=this.hasPromoted?" csui-search-promoted-item":""},"template":C,"regions":{"favRegion":".csui-search-item-fav","selectionRegion":".csui-search-item-check","searchMetadataRegion":".csui-search-item-details-wrapper","breadcrumbRegion":".csui-search-item-breadcrumb","nodeStateRegion":".csui-search-item-nodestateicon"},"ui":{"descriptionField":".csui-overflow-description","summaryField":".csui-overflow-summary","modifiedByField":".csui-search-modified-by","metadataDetails":".csui-search-item-details","inlineToolbarContainer":".csui-search-toolbar-container","inlineToolbar":".csui-search-item-row","arrowIcon":".search-results-item-expand .icon"},"events":{"click .csui-search-item-link":"openSearchItem","click .csui-search-version-label":"openVersionHistory","click .icon-expandArrowUp":"showMetadataInfo","click .icon-expandArrowDown":"hideMetadataInfo"},"templateHelpers":function(){var e=this.options.defaultActionController,t=e.hasAction.bind(e),i=t(this.model)?"":"csui-search-no-default-action",s={"created":u.created,"createdby":u.createdBy,"modified":u.modified,"owner":u.owner,"type":u.type,"items":u.items,"showMore":u.showMore,"showLess":u.showLess,"versionLabel":u.versionLabel,"versionSeparator":u.versionSeparator,"inactiveclass":i,"showBreadcrumb":A.enableBreadcrumb&&this.model.collection.isLocationColumnAvailable},o=this.defaultActionUrl,n=this.promotedText;return{"showOwner":this.model.attributes.hasOwnProperty("owner_user_id"),"messages":s,"defaultActionUrl":o,"has_promoted":this.hasPromoted,"promoted_label":u.promotedLabel,"promoted_text":n.replace(/,/g,", "),"has_version":this.hasVersioned,"cid":this.cid,"itemBreadcrumb":this.itemBreadcrumb,"mimeTypeAria":this.mimeTypeAria}},"openSearchItem":function(e){e.preventDefault(),this.trigger("click:item",this.model)},"constructor":function(e){e||(e={}),o.LayoutView.prototype.constructor.call(this,e),this.collection=e.collection,this.model.attributes.mime_type=this.model.attributes.mime_type?this.model.attributes.mime_type:this.model.attributes.versions?this.model.attributes.versions.mime_type:"",this._hiddenMetadataElements=i();var s=this.model.attributes.mime_type;this.mimeTypeSearch=D.mimeTypes[s],this.mimeTypeSearch||(D.mimeTypes[s]=b.findTypeByNode(this.model)),this.mimeTypeSearch=D.mimeTypes[s],t.extend(this.model.attributes,{"collection_id":this.model.cid,"mime_type_search":this.mimeTypeSearch});var n=this.model.attributes.ancestors,a=n?n.length:0,r=a?n[a-1]:void 0,l=r&&r.attributes?r.attributes.name:void 0;this.itemBreadcrumb=t.str.sformat(u.itemBreadcrumbAria,l),this.mimeTypeAria=t.str.sformat(u.mimeTypeAria,this.mimeTypeSearch),this.hasVersioned=this.hasVersion(),this.hasPromoted=this.hasPromoted(),this.defaultActionUrl=_.getUrl(this.model,{"connector":this.model.connector}),this.promotedText="",this.hasPromoted&&(this.promotedText=this.hasBestBet()?this.model.get("bestbet"):this.model.get("nickname"),this.promotedText=this.promotedText.toString()),this._rowStates=e.rowStates,this.addOwnerDisplayName(),this.addCreatedUserDisplayName(),this.listenTo(this._rowStates,"change:"+M.RowStatesSelectedRows,this._selectionChanged),this.listenTo(this.model,"change",function(){1===t.size(this.model.changed)&&t.has(this.model.changed,"csuiDelayedActionsRetrieved")||(this.model.changed.name&&this.model.set({"OTName":this.model.changed.name}),this.render(),this.updateItemdetails())}),this.model.get("name")!==this.model.get("OTName")&&(this.model.set({"OTName":this.model.get("name")}),this.render(),this.updateItemdetails()),this.listenTo(this.options.parentView,"render:metadata",t.bind(function(e){this.searchMetadataView=new d({"rowId":this.cid,"collection":this.options.parentView.metadata,"model":this.model});var t=this.searchMetadataView.options.collection.models;t&&1===t.length&&null===t[0].get("key")&&this.searchMetadataView.options.collection.add(e,{"silent":!0}),this.searchMetadataRegion.show(this.searchMetadataView)},this)),!1===D.isAppleMobile&&(this.$el.on("mouseenter."+this.cid,".csui-search-item-row",t.bind(this._hoverStart,this)),this.$el.on("mouseleave."+this.cid,".csui-search-item-row",t.bind(this._hoverEnd,this)))},"_hoverStart":function(){this.showInlineActions()},"_hoverEnd":function(){this.hideInlineActions()},"_selectionChanged":function(e){var i=e.previous(M.RowStatesSelectedRows),s=e.changed[M.RowStatesSelectedRows],o=t.difference(i,s),n=t.difference(s,i),a=this.model.get("id");t.contains(o,a)&&(this.model.set("csuiIsSelected",!1),this._checkboxView.setChecked(!1),this.ui.inlineToolbar.removeClass("selected")),t.contains(n,a)&&(this._checkboxView.setChecked(!0),this.ui.inlineToolbar.addClass("selected"),this.hideInlineActions())},"initActionViews":function(e){this.favView=new r({"tagName":"div","focusable":!0,"model":e.model,"context":e.context,"tableView":e.tableView});var i=this._rowStates.get(M.RowStatesSelectedRows),s=t.contains(i,this.model.get("id")),o=t.str.sformat(u.selectItem,e.model.get("name")),n=t.str.sformat(u.selectItemAria,e.model.get("name")),a=!1!==e.model.get("selectable");this._checkboxView=new l({"checked":s?"true":"false","disabled":!a,"ariaLabel":n,"title":o}),this.listenTo(this._checkboxView.model,"change:checked",function(e){this._markAsSelected("true"===e.changed.checked)}),e.connector=e.model.connector,A.enableBreadcrumb&&this.model.collection.isLocationColumnAvailable&&this.addBreadcrumbs(e)},"_getEnabledNodeStateIcons":function(){var e;return e=Object.getPrototypeOf(h),new e.constructor(h.filter(function(e){var t=e.get("iconView");try{return t&&(!t.enabled||t.enabled({"context":this.options.context,"node":this.model}))}catch(e){x.warn("Evaluating an icon view failed.\n{0}",e.message)&&console.warn(x.last)}},this))},"_markAsSelected":function(e){var i,s=this.model.get("id"),o=this._rowStates.get(M.RowStatesSelectedRows);if(e)t.contains(o,s)||(this.collection.selectedItems.add(this.model),i=o.concat([s]),this._rowStates.set(M.RowStatesSelectedRows,i));else if(t.contains(o,s)){var n=this.collection.selectedItems.findWhere({"id":this.model.get("id")});this.collection.selectedItems.remove(n),i=t.without(o,s),this._rowStates.set(M.RowStatesSelectedRows,i)}},"addBreadcrumbs":function(e){var i=new v(e.model.attributes.ancestors,{"node":e.model,"autofetch":!1});return!this.hasPromoted||this.hasPromoted&&this.model.get("ancestors")?(this.breadcrumbsView=new w({"context":e.context,"collection":i,"startSubCrumbs":0,"isRtl":D.isRtl}),this.breadcrumbsView.synchronizeCollections(!0)):e.model.parent.get("id")>0?this.getAncestors(e).fetch().done(t.bind(function(e){this.breadcrumbsView.completeCollection?(this.breadcrumbsView.completeCollection.length&&this.breadcrumbsView.completeCollection.last().set({"showAsLink":!0},{"silent":!0}),this.model.attributes.ancestors=this.breadcrumbsView.completeCollection.models):(this.breadcrumbsView.collection.length&&this.breadcrumbsView.collection.last().set({"showAsLink":!0},{"silent":!0}),this.model.attributes.ancestors=this.breadcrumbsView.collection.models),this.breadcrumbsView.synchronizeCollections(),this.model.collection&&this.model.collection.fetched&&this.model.trigger("change:ancestors",this.model)},this)):this.breadcrumbsView=void 0,!0},"getAncestors":function(e){var t=e.model,i={"node":t.parent,"autofetch":!1},s=new v(void 0,i);return this.breadcrumbsView=new w({"context":e.context,"collection":s,"startSubCrumbs":0,"hasPromoted":this.hasPromoted,"isRtl":D.isRtl}),s},"onRender":function(e){this.initActionViews(this.options);var t=this._getEnabledNodeStateIcons();t.length&&(this.nodeStateView=new c({"context":this.options.context,"node":this.options.model,"tableView":this.options.originatingView,"targetView":this.options.originatingView,"collection":t}),this.nodeStateRegion.show(this.nodeStateView));var i=this.model.get("search_result_metadata");if(i&&!1!==i.current_version&&"minor"!==i.version_type&&void 0!==this.model.get("favorite")&&this.favRegion.show(this.favView),A.enableBreadcrumb&&this.breadcrumbsView){this.breadcrumbRegion.show(this.breadcrumbsView),this.$el.find("ol.binf-breadcrumb").attr("aria-label",this.itemBreadcrumb);var s=this.$el.find("ol.binf-breadcrumb > li").length;1===s?this.$el.find(".tail").addClass("one-node"):2===s&&this.$el.find(".tail").addClass("two-nodes")}this.selectionRegion.show(this._checkboxView),this.model.collection&&"true"===this._checkboxView.options.checked&&this.$el.find(".csui-search-item-row").addClass("selected"),this.trigger("render:metadata"),this._nodeIconView=new f({"el":this.$(".csui-type-icon").get(0),"node":this.model}),this._nodeIconView.render();var o=this.model.collection.selectedSettings,n="",a="";if(o)switch(o){case"SD":n=this.model.get("description"),a=this.model.get("summary");break;case"SO":n=this.model.get("summary");break;case"SP":n=this.model.get("summary")||this.model.get("description");break;case"DP":n=this.model.get("description")||this.model.get("summary");break;case"DO":n=this.model.get("description");break;default:n=""}n&&n.length>0&&(this.el.getElementsByClassName("csui-search-item-desc")[0].innerHTML=n),a&&a.length>0&&(this.el.getElementsByClassName("csui-search-item-summary")[0].innerHTML=a),this.listenTo(this,"adjust:breadcrumb",function(){this.breadcrumbsView.refresh()})},"hasVersion":function(){var e=this.model.get("versions");if(e){var t=this.model.get("search_result_metadata");e=t&&(!1===t.current_version||"minor"===t.version_type)}return e},"hasBestBet":function(){var e=this.model.get("bestbet");return!!e&&!!e.length},"hasNickName":function(){var e=this.model.get("nickname");return!!e&&!!e.length},"hasPromoted":function(){return!!this.hasBestBet()||!!this.hasNickName()},"onBeforeDestroy":function(){this._nodeIconView&&this._nodeIconView.destroy(),this.$el&&!1===D.isAppleMobile&&(this.$el.off("mouseenter."+this.cid,".csui-search-item-row",this._hoverStart),this.$el.off("mouseleave."+this.cid,".csui-search-item-row",this._hoverEnd))},"onShow":function(e){if(this.updateItemdetails(e),this.nodeStateView){var t=this.nodeStateView.el.getElementsByTagName("li");1===t.length?this.$el.addClass("csui-search-result-nodestate-item"):2===t.length?this.$el.addClass("csui-search-result-nodestate-item2"):t.length>2&&this.$el.addClass("csui-search-result-nodestate-more")}},"_toggleExpand":function(e){this.bindUIElements(),this._isExpanded?(this._isExpanded=!1,i(".truncated-"+this.cid).hide(),e.attr("title",u.showMore).attr("aria-expanded","false").attr("aria-label",u.showMoreAria),this.ui.arrowIcon.removeClass("icon-expandArrowUp"),this.ui.arrowIcon.addClass("icon-expandArrowDown"),this.ui.descriptionField.removeClass("csui-search-item-desc-height"),this.ui.descriptionField.addClass("csui-overflow"),this.ui.summaryField.removeClass("csui-search-item-summary-height"),this.ui.summaryField.addClass("csui-overflow")):(this._isExpanded=!0,i(".truncated-"+this.cid).show(),e.attr("title",u.showLess).attr("aria-expanded","true").attr("aria-label",u.showLessAria),this.ui.arrowIcon.removeClass("icon-expandArrowDown"),this.ui.arrowIcon.addClass("icon-expandArrowUp"),this.ui.descriptionField.addClass("csui-search-item-desc-height"),this.ui.descriptionField.removeClass("csui-overflow"),this.ui.summaryField.addClass("csui-search-item-summary-height"),this.ui.summaryField.removeClass("csui-overflow"))},"updateItemdetails":function(e){var t=this,s=this.hasDescriptionText(this.ui.descriptionField[0]),o=this.hasDescriptionText(this.ui.summaryField[0]);s&&this.ui.descriptionField.addClass("csui-overflow"),this.$el.find(".truncated-"+this.cid).addClass("binf-hidden"),o&&this.ui.summaryField.addClass("csui-overflow"),A.enableBreadcrumb&&this.breadcrumbsView&&this.breadcrumbsView.refresh(),0===this.$el.find(".search-results-item-expand").length&&this.$el.find(".csui-search-item-fav.search-fav-"+this.cid).after('<button class="search-results-item-expand" title="'+u.showMore+'" aria-expanded="false" aria-label="'+u.showMoreAria+'"><span class="icon icon-expandArrowDown"></span></button>').next().on("click",function(){t._toggleExpand.call(t,i(this))}),s||(this.ui.descriptionField.addClass("binf-hidden"),this.ui.modifiedByField.addClass("binf-hidden")),o||this.ui.summaryField.addClass("binf-hidden")},"addOwnerDisplayName":function(){var e="";this.model.attributes.owner_user_id_expand&&(e=this.getDisplayName(this.model.attributes.owner_user_id_expand)),t.extend(this.model.attributes,{"owner_display_name":e})},"addCreatedUserDisplayName":function(){var e="";this.model.attributes.create_user_id_expand&&(e=this.getDisplayName(this.model.attributes.create_user_id_expand)),t.extend(this.model.attributes,{"create_user_display_name":e})},"getDisplayName":function(e){return e.name_formatted||e.name},"hasDescriptionText":function(e){return e&&e.textContent.trim().length>0},"showInlineActions":function(){if(0===this.ui.inlineToolbarContainer.find(".csui-table-actionbar").length){if(this.collection.selectedItems.length>0)return;this._hiddenMetadataElements=this.$el.find(".csui-search-item-details:lt(2)"),this._hiddenMetadataElements.addClass("binf-hidden"),this.ui.inlineToolbarContainer.removeClass("binf-hidden");var e=this.model.attributes.version_id?"-"+this.model.attributes.version_id:"",t=i(".csui-search-item-action-"+this.cid+e)[0],s={"sender":this,"target":t,"node":this.model};this.trigger("enterSearchRow",s)}},"hideInlineActions":function(){if(this.ui.inlineToolbarContainer.addClass("binf-hidden"),this._hiddenMetadataElements.removeClass("binf-hidden"),this._hiddenMetadataElements=i(),!this._isExpanded){this.ui.descriptionField.html().trim().length<=0&&(this.ui.descriptionField.addClass("binf-hidden"),this.ui.modifiedByField.addClass("binf-hidden"));this.ui.summaryField.html().trim().length<=0&&this.ui.summaryField.addClass("binf-hidden")}var e=this.model.attributes.version_id?"-"+this.model.attributes.version_id:"",t=i(".csui-search-item-action-"+this.cid+e)[0],s={"sender":this,"target":t,"node":[]};this.trigger("leaveSearchRow",s)},"openVersionHistory":function(e){var t=this,s={},o=[],n=this.model.attributes.version_id?"-"+this.model.attributes.version_id:"",a=i(".csui-search-item-action-"+this.cid+n)[0];o=this.model,s={"sender":t,"target":a,"model":o},t.options.originatingView.openVersionHistory(s)},"showMetadataInfo":function(e){this.ui.descriptionField.removeClass("binf-hidden"),this.ui.modifiedByField.removeClass("binf-hidden"),this.ui.summaryField.removeClass("binf-hidden"),e.preventDefault(),e.stopPropagation()},"hideMetadataInfo":function(e){this.ui.descriptionField.html().trim().length<=0&&(this.ui.descriptionField.addClass("binf-hidden"),this.ui.modifiedByField.addClass("binf-hidden")),this.ui.summaryField.html().trim().length<=0&&this.ui.summaryField.addClass("binf-hidden"),e.preventDefault(),e.stopPropagation()}}),M=o.CollectionView.extend({"className":"binf-list-group","childView":E,"childViewOptions":function(){return{"context":this.options.context,"defaultActionController":this.defaultActionController,"metadata":this.metadata,"rowStates":this._rowStates,"originatingView":this.options.originatingView,"headerView":this.options.originatingView.headerView,"parentView":this,"isLocationColumnAvailable":this.isLocationColumnAvailable>-1,"collection":this.collection}},"emptyView":R,"emptyViewOptions":function(){return{"model":this.emptyModel}},"behaviors":{"DefaultAction":{"behaviorClass":y}},"childEvents":{"click:item":"onClickItem"},"constructor":function(e){e||(e={}),this.options=e,this.context=e.context,this.collection=e.collection,this.localStorage=this.options.localStorage,o.CollectionView.prototype.constructor.apply(this,arguments),this.setRowStates(),this.setInlineActionBarEvents(),this.metadata=this.options.metadata||this.context.getCollection(S,this),this.setStandardSearchHeaderView(),this.listenTo(this,"update:tool:items",this._updateToolItems),this.listenTo(this.collection,"sync",function(){this.collection.selectedItems&&this.collection.selectedItems.length&&this.collection.each(t.bind(function(e){var i=this.collection.selectedItems.findIndex({"id":e.get("id")});if(-1!==i&&this.collection.selectedItems.at(i)!==e){this.collection.selectedItems.remove(this.collection.selectedItems.at(i)),this.collection.selectedItems.add(e,{"at":i}),e.set("csuiIsSelected",!0);var s,o=e.get("id"),n=this._rowStates.get(M.RowStatesSelectedRows);t.contains(n,o)||(this.collection.selectedItems.add(this.model),s=n.concat([o]),this._rowStates.set(M.RowStatesSelectedRows,s))}else this._updateToolItems()},this))}),this.listenTo(this.collection,"sync",this._focusOnFirstSearchResultElement),this.listenTo(this.options.originatingView,"render:metadata",this.renderMetadataModels),this.listenTo(this,"dom:refresh",function(){this.standardHeaderView.triggerMethod("dom:refresh")}),a.delegate(this,e.originatingView),this.collection.originatingView=e.originatingView,this.emptyModel=new s.Model({"message":u.noSearchResultMessage,"suggestionKeyword":u.suggestionKeyword,"searchSuggestion1":u.searchSuggestion1,"searchSuggestion2":u.searchSuggestion2,"searchSuggestion3":u.searchSuggestion3,"searchSuggestion4":u.searchSuggestion4}),this.listenTo(this.collection,"sync",function(){var e=this.options.originatingView.facetView&&this.options.originatingView.facetView.$(".csui-facet");e&&e.length&&e.prop("tabindex",0)}),this.listenTo(this.collection,"error",function(){this.emptyModel.set("message",u.failedSearchResultMessage)}),this.listenTo(this,"dom:refresh",this._refreshDom),this.listenTo(this,"facet:opened",function(){i(window).width()>1023&&this.children.each(function(e){e.trigger("adjust:breadcrumb")})}),this.listenTo(this,"destroy:header:view",function(){this.standardHeaderView.destroy(),this.standardHeaderView=void 0})},"_focusOnFirstSearchResultElement":function(){this.options.originatingView&&!this.options.originatingView.collection.settings_changed?this.$el.find(".binf-list-group-item:first-child .csui-search-item-name > a").trigger("focus"):this.options.originatingView.collection.settings_changed=!1},"renderMetadataModels":function(){this.metadata=t.extend({},this.metadata,this.collection.searching&&this.collection.searching.sortedColumns);var e=t.filter(this.metadata.models,function(e){return!e.get("default")});this.trigger("render:metadata",e)},"setRowStates":function(){this._rowStates=new s.Model,this._rowStates.set(M.RowStatesSelectedRows,[])},"setStandardSearchHeaderView":function(){this.standardHeaderView=new k({"collection":this.collection,"view":this,"options":this.options,"selectedItems":this.collection.selectedItems})},"_updateToolItems":function(){this.standardHeaderView&&this.standardHeaderView._updateToolItems()},"_showInlineActionBar":function(e){if(e){this._savedHoverEnterArgs=null;var s=e.node.get("parent_id");s instanceof Object&&(s=e.node.get("parent_id").id);var o=new g({"id":s},{"connector":e.node.connector});this.inlineToolbarView=new m(t.extend({"context":this.options.context,"commands":this.defaultActionController.commands,"delayedActions":this.collection.delayedActions,"collection":this.options.toolbarItems.inlineToolbar||[],"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineToolbar,"container":o,"containerCollection":this.collection,"model":e.node,"originatingView":this.options.originatingView,"notOccupiedSpace":0},this.options.toolbarItems.inlineToolbar&&this.options.toolbarItems.inlineToolbar.options)),this.listenTo(this.inlineToolbarView,"after:execute:command",this.options.originatingView._toolbarCommandExecuted),this.inlineToolbarView.render(),this.listenTo(this.inlineToolbarView,"destroy",function(){this.inlineToolbarView=void 0,this._savedHoverEnterArgs&&this._showInlineActionBarWithDelay(this._savedHoverEnterArgs)},this),i(e.target).append(this.inlineToolbarView.$el),this.inlineToolbarView.triggerMethod("show")}},"setInlineActionBarEvents":function(){this.listenTo(this,"childview:enterSearchRow",this._showInlineActionBarWithDelay),this.listenTo(this,"childview:openVersionHistory",this.openVersionHistory),this.listenTo(this,"childview:leaveSearchRow",this._actionBarShouldDestroy),this.listenTo(this.collection,"reset",this._destroyInlineActionBar)},"_showInlineActionBarWithDelay":function(e,t){this._showInlineActionbarTimeout&&clearTimeout(this._showInlineActionbarTimeout);var i=this;this._showInlineActionbarTimeout=setTimeout(function(){i._showInlineActionbarTimeout=void 0,i._showInlineActionBar.call(i,t)},200)},"_actionBarShouldDestroy":function(e,t){this._showInlineActionbarTimeout&&(clearTimeout(this._showInlineActionbarTimeout),this._showInlineActionbarTimeout=void 0),this.inlineToolbarView&&this.inlineToolbarView.destroy()},"_destroyInlineActionBar":function(){this.inlineToolbarView&&(this.inlineToolbarView.destroy(),this.inlineToolbarView=void 0)},"onClickItem":function(e){this.triggerMethod("execute:defaultAction",e.model)},"onScrollTop":function(){i(".binf-list-group").scrollTop(0)},"_refreshDom":function(){this.$el.addClass("list-group-height"),this.onScrollTop()}},{"RowStatesSelectedRows":"selected"});return M}),csui.define("csui/controls/table/rows/description/search.description.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/table/rows/description/description.view"],function(e,t,i,s,o){return o.extend({"templateHelpers":function(){var t="",i="",s="",n="",a="",r="",l="",c="",h=this.options&&this.options.tableView&&this.options.tableView.selectedSettings,d=!1;switch(h){case"SD":t=this.model.get("description"),c=this.model.get("summary"),d=!0;break;case"SO":t=this.model.get("summary");break;case"SP":t=this.model.get("summary")||this.model.get("description");break;case"DP":t=this.model.get("description")||this.model.get("summary");break;case"DO":t=this.model.get("description");break;case"NONE":break;default:t=""}if(t&&t.length>0){t=t.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),r=t;var u=/&lt;HH&gt;/gi,m=/&lt;\/HH&gt;/gi;i=t.replace(u,'<span class="csui-summary-hh">'),i=i.replace(m,"</span>"),n=r.replace(u,""),n=n.replace(m,"")}if(d&&c&&c.length>0){c=c.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),l=c;var p=/&lt;HH&gt;/gi,g=/&lt;\/HH&gt;/gi;s=c.replace(p,'<span class="csui-summary-hh">'),s=s.replace(g,"</span>"),a=l.replace(p,""),a=a.replace(g,"")}return e.extend(o.prototype.templateHelpers.apply(this),{"complete_description":n,"current_description":i,"complete_summary":a,"current_summary":s,"search_description":!0,"search_summary":!0,"summary_description_available":d&&c,"descriptionAvailable":t})}})}),csui.define("csui/widgets/search.results/impl/tabular/tabular.search.results.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/table/table.view","csui/controls/table/rows/description/search.description.view","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/controls/tableactionbar/tableactionbar.view","csui/utils/accessibility","csui/lib/jquery.mousehover","csui/lib/jquery.redraw"],function(e,t,i,s,o,n,a,r,l,c,h){"use strict";var d=h.isAccessibleTable();return a.extend({"ui":{"toggleDetails":".csui-table-cell-_toggledetails.sorting_disabled"},"events":{"mouseup @ui.toggleDetails":"onToggleOrChangePageSize","keypress @ui.toggleDetails":"onToggleOrChangePageSize","mouseup .binf-table > thead > tr > th:not(.sorting_disabled)":"onTableSortClick","keypress .binf-table > thead > tr > th:not(.sorting_disabled)":"onTableSortClick"},"constructor":function(e){if(this.collection=e.collection,this.options=e,this.columns=this.collection.searching&&this.collection.searching.sortedColumns,e.accessibleTable&&this.getAdditionalColumns(),this.collection.columns=this.columns?this.columns:this.tableColumns,this.settings=this.options.originatingView.getSettings(),this.settings&&this.settings.get("display")){var i=this.settings.get("display").summary_description.selected;this.showSummaryOnly="SO"===i}this.defaultActionController=this.options.defaultActionController;var s=t.extend({"context":this.options.context,"connector":this.collection.options.connector,"collection":this.collection,"columns":this.options.columns,"enableSorting":void 0===this.options.enableSorting||this.options.enableSorting,"tableColumns":this.options.tableColumns,"pageSize":this.options.data.pageSize||this.options.pageSize,"originatingView":this.options.originatingView,"container":this.options.container,"orderBy":this.collection.orderBy,"filterBy":this.options.filterBy,"actionItems":this.defaultActionController.actionItems,"descriptionRowView":r,"descriptionRowViewOptions":{"firstColumnIndex":2,"lastColumnIndex":2,"showDescriptions":!1,"showSummary":!0,"collapsedHeightIsOneLine":!0,"displayInEntireRow":!0,"showSummaryOnly":this.showSummaryOnly,"descriptionColspan":7},"commands":this.defaultActionController.commands,"blockingParentView":this.options.originatingView,"parentView":this.options.originatingView,"inlineBar":{"viewClass":c,"options":t.extend({"collection":this.options.toolbarItems.tabularInlineToolbar||[],"toolItemsMask":this.options.toolbarItemsMasks.toolbars.tabularInlineToolbar,"delayedActions":this.collection.delayedActions,"container":this.container,"containerCollection":this.collection},this.options.toolbarItems.tabularInlineToolbar&&this.options.toolbarItems.tabularInlineToolbar.options,{"inlineBarStyle":this.options.config.inlineActionBarStyle,"forceInlineBarOnClick":this.options.config.forceInlineActionBarOnClick,"showInlineBarOnHover":this.options.config.showInlineActionBarOnHover})},"allSelectedNodes":this.collection.selectedItems,"customLabels":this.options.customLabels});e=t.extend(e,s),a.prototype.constructor.call(this,e),this.selectedSettings=this.collection.selectedSettings,this._showEmptyViewText=!this.collection.length,this.listenTo(this.options.originatingView,"render:table",function(){this.columns=this.options.originatingView.columns,this.render()}),this.listenTo(this.options.originatingView,"toggle:description",function(e){this.showDetailRowDescriptions(e),this.trigger("update:scrollbar")}),this._setTableViewEvents(),this.listenTo(this,"set:tablerow:assets",function(){this.columns=this.options.originatingView.columns,this.setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar||[],"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showSelectionCounter":!0}),this._setTableRowSelectionToolbarEventListeners()}),this.listenTo(this.options.originatingView,"properties:view:destroyed",this.onPropertiesViewDestroyed),this.listenTo(this.options.originatingView,"permissions:view:destroyed",this.onPropertiesViewDestroyed),this.listenTo(this.collection,"remove",function(){!this.collection.selectedItems.length&&(0===this.collection.models.length||this.collection.totalCount<this.collection.topCount)&&this.collection.trigger("sync")})},"onRender":function(){this.collection.selectedItems.length&&this.collection.selectedItems.trigger("reset")},"_setTableViewEvents":function(){return this.listenTo(this,"tableRowSelected",function(e){if(this.cancelAnyExistingInlineForm.call(this),this.collection.selectedItems){var i=e.nodes,s=this.collection.selectedItems.models.slice(0);t.each(i,function(e){this.collection.selectedItems.get(e)||s.push(e)},this),this.collection.selectedItems.reset(s)}}),this.container&&this.listenTo(this.container,"change:id",function(){this.options.fixedFilterOnChange?(this.collection.clearFilter(!1),this.collection.setFilter(this.options.fixedFilterOnChange,!1)):this.options.clearFilterOnChange&&this.collection.clearFilter(!1),this.options.resetOrderOnChange&&this.collection.resetOrder(!1),this.options.resetLimitOnChange&&this.collection.resetLimit(!1)}),this.listenTo(this.collection.selectedItems,"reset",function(){this.tableToolbarView&&(this.options.originatingView.headerView.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),
this._onSelectionUpdateCssClasses(this.collection.selectedItems.length));var e=this.collection.selectedItems;this.collection.each(function(t){var i=e.get(t.get("id"));t.set("csuiIsSelected",void 0!==i)})}),this.listenTo(this,"tableRowUnselected",function(e){if(this.collection.selectedItems){var i=e.nodes;t.each(i,function(e){this.collection.selectedItems.remove(e,{"silent":!0})},this),this.collection.selectedItems.reset(t.clone(this.collection.selectedItems.models))}}),this.listenTo(this,"execute:defaultAction",function(e){var t={"node":e};if(this.trigger("before:defaultAction",t),!t.cancel){var i=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this.options.originatingView}).done(function(){i.trigger("executed:defaultAction",t)})}}),this.enableDragNDrop&&this.listenTo(this,"tableRowRendered",function(e){var t=this.setDragNDrop(e);this._assignDragArea(t,i(e.target)),this._assignDragArea(t,e.expandedRows)}),!0},"setTableRowSelectionToolbar":function(e){this._tableRowSelectionToolbarView=new l({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.options.originatingView.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"showSelectionCounter":!0,"scrollableParent":".csui-nodetable tbody","commands":this.defaultActionController.commands,"selectedChildren":this.collection.selectedItems,"container":this.collection.node,"context":this.context,"originatingView":this.options.originatingView,"collection":this.collection});var t=this._tableRowSelectionToolbarView;this.listenTo(t,"toggle:condensed:header",function(){this.options.originatingView.headerView.$el.find(".csui-search-header").toggleClass("csui-show-header"),this.showingBothToolbars=this.options.originatingView.headerView&&this.options.originatingView.headerView.$el.find(".csui-search-header").hasClass("csui-show-header"),this.showingBothToolbars?(this.options.originatingView.headerView.$el.find(".csui-search-header").removeClass("csui-table-rowselection-toolbar-visible"),this.options.originatingView.headerView.$el.parent("#header").addClass("csui-show-header")):(this.options.originatingView.headerView.$el.find(".csui-search-header").addClass("csui-table-rowselection-toolbar-visible"),this.options.originatingView.headerView.$el.parent("#header").removeClass("csui-show-header")),t.trigger("toolbar:activity",!0,this.showingBothToolbars)}),this.listenTo(t,"render",function(){this.listenTo(t._selectedCountView.collection,"remove",function(e){var t=this.collection.findWhere({"id":e.get("id")});t?t.set("csuiIsSelected",!1):e.set("csuiIsSelected",!1),this._onSelectionUpdateCssClasses(this.collection.selectedItems.length)})})},"_setTableRowSelectionToolbarEventListeners":function(){this.listenTo(this.collection.selectedItems,"reset",function(){var e=this.options.originatingView&&this.options.originatingView.headerView;e.tableRowSelectionToolbarRegion&&e.tableRowSelectionToolbarRegion.$el.removeClass("binf-hidden"),this._tableRowSelectionToolbarView._rightToolbarView.options.showCondensedHeaderToggle=!0,e.tableRowSelectionToolbarRegion&&e.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.collection.selectedItems.length)})},"_onSelectionUpdateCssClasses":function(e,t){var i=this.options.originatingView.headerView.tableRowSelectionToolbarRegion.$el,s=this.options.originatingView.headerView&&this.options.originatingView.headerView.$el.find(".csui-search-header").hasClass("csui-show-header");this._tableRowSelectionToolbarVisible=!e,d?e>0?(this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,s||this.showingBothToolbars||this.options.originatingView.headerView.$el.find(".csui-search-header").addClass("csui-table-rowselection-toolbar-visible"),i.removeClass("binf-hidden"),i.addClass("csui-table-rowselection-toolbar-visible")),this._tableRowSelectionToolbarView.trigger("toolbar:activity",this._tableRowSelectionToolbarVisible,s)):(this.showingBothToolbars=!1,this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.options.originatingView.headerView.$el.find(".csui-search-header").removeClass("csui-show-header"),this.options.originatingView.headerView.$el.find(".csui-search-header").removeClass("binf-hidden"),this.options.originatingView.headerView.$el.find(".csui-search-header").removeClass("csui-table-rowselection-toolbar-visible"),i.removeClass("csui-table-rowselection-toolbar-visible"),this.options.originatingView.headerView.$el.parent("#header").removeClass("csui-show-header"))):e>0?(this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,i.removeClass("binf-hidden").redraw().addClass("csui-table-rowselection-toolbar-visible"),s||this.showingBothToolbars||this.options.originatingView.headerView.$el.find(".csui-search-header").addClass("csui-table-rowselection-toolbar-visible")),this._tableRowSelectionToolbarView.trigger("toolbar:activity",this._tableRowSelectionToolbarVisible,s)):(this.showingBothToolbars=!1,this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.options.originatingView.headerView.$el.find(".csui-search-header").removeClass("csui-show-header"),i.removeClass("csui-table-rowselection-toolbar-visible"),this.options.originatingView.headerView.$el.find(".csui-search-header").removeClass("csui-table-rowselection-toolbar-visible"),this.options.originatingView.headerView.$el.parent("#header").removeClass("csui-show-header")))},"onTableSortClick":function(e){("keypress"!==e.type||13!==e.keyCode&&32!==e.keyCode)&&"mouseup"!==e.type||(this.collection.isSortOptionSelected=!1)},"onToggleOrChangePageSize":function(e){("keypress"!==e.type||13!==e.keyCode&&32!==e.keyCode)&&"mouseup"!==e.type||(this.collection.isSortOptionSelected=!0)},"onPropertiesViewDestroyed":function(){this.onMetadataNavigationViewDestroyed(),this.options.originatingView.headerView.updateToggleDescription(),this.render()},"onMetadataNavigationViewDestroyed":function(){this.collection.inMetadataNavigationView&&this.isTabularView&&(this.collection.inMetadataNavigationView=!1)}})}),csui.define("csui/models/widget/search.results/search.metadata/search.columns",["csui/lib/underscore","csui/lib/backbone","i18n!csui/models/impl/nls/lang"],function(e,t,i){var s=t.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),o=t.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new o(this.map(function(e){return e.attributes}))}});return new o([{"key":"OTMIMEType","sequence":0,"titleIconInHeader":"mime_type","permanentColumn":!0},{"key":"OTName","sequence":1,"permanentColumn":!0,"isNaming":!0},{"key":"version_id","column_key":"version_id","title":i.version,"noTitleInHeader":!0,"permanentColumn":!0,"sequence":2},{"key":"reserved","column_key":"reserved","sequence":3,"title":i.state,"noTitleInHeader":!0,"permanentColumn":!0},{"key":"favorite","column_key":"favorite","sequence":910,"title":i.favorite,"noTitleInHeader":!0,"permanentColumn":!0}])}),csui.define("csui/widgets/search.results/impl/toolbaritems",["csui/lib/underscore","module","csui-ext!csui/widgets/search.results/impl/toolbaritems"],function(e,t,i){return i&&e.each(i,function(e){}),i}),csui.define("csui/widgets/search.results/toolbaritems",["csui/lib/underscore","i18n!csui/widgets/search.results/nls/lang","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/search.results/toolbaritems","csui/widgets/search.results/impl/toolbaritems"],function(e,t,i,s,o,n,a){"use strict";function r(t){e.each(t,function(t){e.each(t,function(t,i){var s=l[i];if(!s)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new o(e),s.addItem(e)})})})}var l={"filterToolbar":new s({"filter":[{"signature":"Filter","name":i.ToolbarItemFilter,"icon":"icon icon-toolbarFilter","svgId":"themes--carbonfiber--image--generated_icons--action_filter32"}]},{"addTrailingDivider":!1}),"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata","svgId":"themes--carbonfiber--image--generated_icons--action_properties32"},{"signature":"CopyLink","name":i.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"share":[{"signature":"SendTo","name":i.ToolbarItemSendTo,"flyout":"sendto","group":"share"},{"signature":"Share","name":i.ToolbarItemShare,"flyout":"share","promoted":!0,"group":"share"},{"signature":"EmailLink","name":i.ToolbarItemEmailLink,"flyout":"sendto","promoted":!0,"group":"share"}],"main":[{"signature":"InlineEdit","name":i.ToolbarItemRename,"onlyInTouchBrowser":!0},{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion},{"signature":"Collect","name":i.ToolbarCollect},{"signature":"Delete","name":i.ToolbarItemDelete},{"signature":"RemoveCollectedItems","name":i.ToolbarItemRemoveCollectionItems},{"signature":"ZipAndDownload","name":i.MenuItemZipAndDownload}],"shortcut":[{"signature":"OriginalCopyLink","name":i.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":i.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":i.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":t.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":t.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":i.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":i.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":i.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":i.ToolbarItemOriginalDownload},{"signature":"OriginalDelete","name":i.ToolbarItemOriginalDelete}]},{"maxItemsShown":15,"dropDownIcon":"icon icon-toolbar-more","dropDownSvgId":"themes--carbonfiber--image--generated_icons--action_more32","dropDownText":i.ToolbarItemMore,"addGroupSeparators":!1,"lazyActions":!0}),"otherToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata","svgId":"themes--carbonfiber--image--generated_icons--action_properties32"},{"signature":"CopyLink","name":i.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"share":[{"signature":"SendTo","name":i.ToolbarItemSendTo,"flyout":"sendto","group":"share"},{"signature":"Share","name":i.ToolbarItemShare,"flyout":"share","promoted":!0,"group":"share"},{"signature":"EmailLink","name":i.ToolbarItemEmailLink,"flyout":"sendto","promoted":!0,"group":"share"}],"main":[{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion},{"signature":"Collect","name":i.ToolbarCollect},{"signature":"Delete","name":i.ToolbarItemDelete},{"signature":"ZipAndDownload","name":i.MenuItemZipAndDownload}]},{"maxItemsShown":5,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","dropDownSvgId":"themes--carbonfiber--image--generated_icons--action_more32","addGroupSeparators":!1,"lazyActions":!0}),"inlineToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata","svgId":"themes--carbonfiber--image--generated_icons--action_properties32"},{"signature":"CopyLink","name":i.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink","svgId":"themes--carbonfiber--image--generated_icons--action_copy_link32"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"icon":"icon icon-toolbar-edit","svgId":"themes--carbonfiber--image--generated_icons--action_edit32"}],"share":[],"other":[{"signature":"permissions","name":i.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions","svgId":"themes--carbonfiber--image--generated_icons--action_view_perms32"},{"signature":"Download","name":i.ToolbarItemDownload,"icon":"icon icon-toolbar-download","svgId":"themes--carbonfiber--image--generated_icons--action_download32"},{"signature":"ReserveDoc","name":t.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve","svgId":"themes--carbonfiber--image--generated_icons--action_reserve32"},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve","svgId":"themes--carbonfiber--image--generated_icons--action_reserve32"},{"signature":"Copy","name":i.ToolbarItemCopy,"icon":"icon icon-toolbar-copy","svgId":"themes--carbonfiber--image--generated_icons--action_copy32"},{"signature":"Move","name":i.ToolbarItemMove,"icon":"icon icon-toolbar-move","svgId":"themes--carbonfiber--image--generated_icons--action_move32"},{"signature":"AddVersion","name":i.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version","svgId":"themes--carbonfiber--image--generated_icons--action_add_version32"},{"signature":"Collect","name":i.ToolbarCollect,"icon":"icon icon-toolbar-actioncollect","svgId":"themes--carbonfiber--image--generated_icons--action_collect32"},{"signature":"Delete","name":i.ToolbarItemDelete,"icon":"icon icon-toolbar-delete","svgId":"themes--carbonfiber--image--generated_icons--action_delete32"},{"signature":"ZipAndDownload","name":i.MenuItemZipAndDownload,"icon":"icon icon-toolbar-download","svgId":"themes--carbonfiber--image--generated_icons--action_download32"}]},{"maxItemsShown":5,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","dropDownSvgId":"themes--carbonfiber--image--generated_icons--action_more32","addGroupSeparators":!1}),"tabularInlineToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata","svgId":"themes--carbonfiber--image--generated_icons--action_properties32"},{"signature":"CopyLink","name":i.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink","svgId":"themes--carbonfiber--image--generated_icons--action_copy_link32"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"icon":"icon icon-toolbar-edit","svgId":"themes--carbonfiber--image--generated_icons--action_edit32"}],"share":[],"other":[{"signature":"permissions","name":i.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions","svgId":"themes--carbonfiber--image--generated_icons--action_view_perms32"},{"signature":"Download","name":i.ToolbarItemDownload,"icon":"icon icon-toolbar-download","svgId":"themes--carbonfiber--image--generated_icons--action_download32"},{"signature":"ReserveDoc","name":t.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve","svgId":"themes--carbonfiber--image--generated_icons--action_reserve32"},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve","svgId":"themes--carbonfiber--image--generated_icons--action_reserve32"},{"signature":"Copy","name":i.ToolbarItemCopy,"icon":"icon icon-toolbar-copy","svgId":"themes--carbonfiber--image--generated_icons--action_copy32"},{"signature":"Move","name":i.ToolbarItemMove,"icon":"icon icon-toolbar-move","svgId":"themes--carbonfiber--image--generated_icons--action_move32"},{"signature":"AddVersion","name":i.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version","svgId":"themes--carbonfiber--image--generated_icons--action_add_version32"},{"signature":"Collect","name":i.ToolbarCollect,"icon":"icon icon-toolbar-actioncollect","svgId":"themes--carbonfiber--image--generated_icons--action_collect32"},{"signature":"Delete","name":i.ToolbarItemDelete,"icon":"icon icon-toolbar-delete","svgId":"themes--carbonfiber--image--generated_icons--action_delete32"},{"signature":"ZipAndDownload","name":i.MenuItemZipAndDownload,"icon":"icon icon-toolbar-download","svgId":"themes--carbonfiber--image--generated_icons--action_download32"}]},{"maxItemsShown":5,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","dropDownSvgId":"themes--carbonfiber--image--generated_icons--action_more32","addGroupSeparators":!1}),"versionToolItems":["properties","open","download","delete"]};return a&&r(a),n&&r(n),l}),csui.define("csui/widgets/search.results/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){"use strict";function o(){var o=e.config(),a=new s;this.toolbars=t.reduce(n,function(e,s){var n=new i(a,{"normalize":!1});return t.each(o,function(e,t){(e=e[s])&&n.extendMask(e)}),n.storeMask(),e[s]=n,e},{})}var n=["otherToolbar","inlineToolbar"];return o.toolbars=n,o}),csui.define("csui/models/widget/search.results/search.settings/server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url"],function(e,t,i,s){"use strict";return{"mixin":function(t){var i=t.sync;return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2"),t="",i=this.options.templateId;return t=i?s.combine(t,"/template/"+i):s.combine(t,"/template"),t=s.combine(t,"/settings/display"),s.combine(e,"search"+t)},"sync":function(e,t,s){return i.apply(this,arguments)}})}}}),csui.define("csui/models/widget/search.results/search.settings/search.settings.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/utils/url","csui/models/mixins/fetchable/fetchable.mixin","csui/models/widget/search.results/search.settings/server.adaptor.mixin"],function(e,t,i,s,o,n,a){"use strict";var r=i.Model.extend({"constructor":function(){i.Model.apply(this,arguments)}}),l=i.Collection.extend({"model":r,"constructor":function(){i.Collection.apply(this,arguments)},"isFetchable":!1}),c=i.Model.extend({"constructor":function(e,t){this.options=t||(t={}),i.Model.apply(this,arguments),this.makeConnectable(t).makeFetchable(t).makeServerAdaptor(t)},"idAttribute":"key","defaults":{"key":null,"sequence":0},"isNew":function(){return!1},"parse":function(e,i){e=e.results&&e.results.data;var s=["available","selected"];return t.each(e&&e.display,function(e){t.isObject(e)&&s.map(function(i){e[i]&&t.isArray(e[i])&&(e[i]=new l(e[i]))})}),e},"isFetchable":function(){return!0},"getColumnKeys":function(){return this.pluck("key")}});return s.mixin(c.prototype),n.mixin(c.prototype),a.mixin(c.prototype),c}),csui.define("csui/utils/contexts/factories/search.settings.factory",["require","module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/models/widget/search.results/search.settings/search.settings.model"],function(e,t,i,s,o,n,a){return o.extend({"propertyPrefix":"searchSettings","constructor":function(e,r){o.prototype.constructor.apply(this,arguments);var l=this.options.searchSettings||{};if(!(l instanceof s.Collection)){var c=e.getObject(n,r),h=t.config(),d=r.templateId;l=new a(l.models,i.extend({"connector":c,"templateId":d},l.options,h.options,{"autofetch":!0,"autoreset":!0}))}this.property=l},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("csui/utils/contexts/factories/search.results.facets.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/models/widget/search.results/search.facets"],function(e,t,i,s,o,n){return s.extend({"propertyPrefix":"searchFacets","constructor":function(a,r){s.prototype.constructor.apply(this,arguments);var l=this.options.searchFacets||{};if(!(l instanceof i.Collection)){var c=a.getObject(o,r),h=l.options.query,d=e.config();l=new n(l.models,t.extend({"connector":c,"query":h,"stateEnabled":!0},l.options,d.options,{"autofetch":!0,"autoreset":!0}))}this.property=l},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("hbs!csui/widgets/search.results/impl/search.results",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var o;return'          <div class="csui-search-left-panel-tabs">\r\n          <ul role="tablist">\r\n              <li class="csui-tab csui-search-custom-tab" role="presentation">\r\n                <a title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.customSearchTab:o,e))+'" tabindex="0"  role="tab">\r\n                  <span>'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.customSearchTab:o,e))+"</span>\r\n                </a>\r\n              </li>\r\n"+(null!=(o=t.if.call(e,null!=e?e.showFacetPanel:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?o:"")+"            </ul>\r\n          </div>\r\n"},"2":function(e,t,i,s){var o;return'                <li class="csui-tab csui-search-facet-tab" role="presentation">\r\n                  <a title="'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.searchFilterTab:o,e))+'" tabindex="0" role="tab">\r\n                    <span>'+this.escapeExpression(this.lambda(null!=(o=null!=e?e.messages:e)?o.searchFilterTab:o,e))+"</span>\r\n                  </a>\r\n                </li>\r\n"},"4":function(e,t,i,s){return'            <div class="csui-search-results-custom">\r\n              <div id="csui-search-custom-container"></div>\r\n            </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var o,n;return'\x3c!-- TODO: need to apply localization --\x3e\r\n<div id="header"></div>\r\n<div class="binf-container-fluid">\r\n  <div class="csui-facet-table-container">\r\n    <div class="csui-search-left-panel csui-popover-panel csui-is-hidden">\r\n      <div class="csui-popover-panel-container">\r\n'+(null!=(o=t.if.call(e,null!=e?e.enableCustomSearch:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?o:"")+'        <div class="csui-search-left-panel-content"  role="tabpanel">\r\n'+(null!=(o=t.if.call(e,null!=e?e.enableCustomSearch:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?o:"")+'          <div id="facetview" class="csui-facetview"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="csui-search-results-body binf-col-lg-12 binf-col-md-12 binf-col-xs-12">\r\n      <div id="csui-search-custom-results">\r\n        <div class="csui-search-results-content binf-col-lg-12 binf-col-md-12">\r\n          <div id="facetbarview"></div>\r\n          <div\r\n              class="csui-search-tool-container binf-hidden binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n            <div class=\'csui-standard-header-view\' id="csui-standard-header-view"></div>\r\n          </div>\r\n          <div id="results" tabindex="-1" class="csui-result-list binf-col-lg-12 binf-col-md-12\r\n          binf-col-sm-12 binf-col-xs-12"></div>\r\n          <div class=\'csui-search-loading-wrapper\'>\r\n            <div class=\'csui-search-loading\'>'+this.escapeExpression((n=null!=(n=t.loadingMessage||(null!=e?e.loadingMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"loadingMessage","hash":{}}):n))+'</div>\r\n          </div>\r\n          <div\r\n              class="csui-search-row-divider binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n        </div>\r\n\r\n        <div id="pagination"\r\n             class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("csui_widgets_search.results_impl_search.results",s),s}),csui.define("csui/widgets/search.results/search.results.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/url","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/search.results.factory","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/search.results/impl/search.results.header.view","csui/widgets/search.results/impl/standard/standard.search.results.view","csui/widgets/search.results/impl/tabular/tabular.search.results.view","csui/controls/table/table.view","csui/controls/table/rows/description/search.description.view","csui/models/widget/search.results/search.metadata/search.columns","csui/models/nodechildrencolumn","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/controls/pagination/nodespagination.view","csui/controls/progressblocker/blocker","csui/widgets/search.results/toolbaritems","csui/widgets/search.results/toolbaritems.masks","csui/widgets/search.custom/impl/search.object.view","csui/utils/contexts/factories/search.settings.factory","csui/controls/globalmessage/globalmessage","i18n!csui/widgets/search.results/impl/nls/lang","csui/controls/tableactionbar/tableactionbar.view","csui/utils/contexts/factories/search.results.facets.factory","csui/models/node/node.model","csui/models/nodes","csui/utils/commands/properties","csui/utils/contexts/factories/user","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/search.metadata.factory","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/toolbar/toolbar.command.controller","hbs!csui/widgets/search.results/impl/search.results","csui/utils/defaultactionitems","csui/utils/commands","csui/utils/namedlocalstorage","csui/dialogs/modal.alert/modal.alert","csui/controls/facet.panel/facet.panel.view","csui/controls/facet.bar/facet.bar.view","csui/utils/accessibility","csui/lib/handlebars.helpers.xif","css!csui/widgets/search.results/impl/search.results","csui/lib/jquery.mousehover","csui/lib/jquery.redraw"],function(e,t,i,s,o,n,a,r,l,c,h,d,u,m,p,g,b,f,w,v,y,S,C,V,_,T,x,k,I,A,D,R,E,M,B,P,O,F,$,N,L,q,H,j){"use strict";var K=j.isAccessibleTable(),z=t.extend({"enableFacetFilter":!0,"enableBreadcrumb":!0,"enableSearchSettings":!0,"showInlineActionBarOnHover":!K,"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble"},e.config()),U=o.LayoutView.extend({"className":"csui-search-results binf-panel binf-panel-default","template":O,"templateHelpers":function(){return{"messages":{"customSearchTab":T.customSearchTab,"searchFilterTab":T.searchFilterTab,"enableCustomSearch":this.enableCustomSearch},"enableCustomSearch":this.enableCustomSearch,"loadingMessage":T.loadingSearchResultMessage,"showFacetPanel":!1!==this.options.showFacetPanel}},"ui":{"toolBarContainer":".csui-search-tool-container","customSearchContainer":".csui-search-results-custom","facetView":"#facetview","customViewTab":".csui-search-custom-tab","facetViewTab":".csui-search-facet-tab","searchResultsContent":".csui-search-results-content","searchResultsBody":".csui-search-results-body","searchSidePanel":".csui-search-left-panel","loadingEle":".csui-search-loading-wrapper"},"events":{"click @ui.customViewTab":"openCustomView","click @ui.facetViewTab":"openFacetView","keypress @ui.customViewTab":"openCustomView","keypress @ui.facetViewTab":"openFacetView","mouseup @ui.toggleDetails":"onToggleOrChangePageSize","keypress @ui.toggleDetails":"onToggleOrChangePageSize","mouseup .csui-paging-navbar > ul > li:not(.csui-overflow) > a":"onChangePage","keypress .csui-paging-navbar > ul > li:not(.csui-overflow) > a":"onChangePage","mouseup .csui-pagesize-menu ul.csui-dropdown-list a":"onToggleOrChangePageSize","keypress .csui-pagesize-menu ul.csui-dropdown-list a":"onToggleOrChangePageSize","click":"stopClosingSearchBox"},"regions":{"headerRegion":"#header","resultsRegion":"#results","paginationRegion":"#pagination","standardHeaderRegion":"#csui-standard-header-view","customSearchRegion":"#csui-search-custom-container","facetBarRegion":"#facetbarview","facetRegion":"#facetview","tableRowSelectionToolbarRegion":".csui-table-rowselection-toolbar"},"behaviors":{"PerfectScrolling":{"behaviorClass":B,"contentParent":".csui-result-list","suppressScrollX":!0,"scrollYMarginOffset":15},"DefaultAction":{"behaviorClass":E}},"namedLocalStorage":new N("PrevSearchDisplayStyle"),"getPageSize":function(){return this.namedLocalStorage.get(this._createSearchDisplayStyleKey()+"_PrevSRPageSize")||10},"constructor":function(e){e||(e={}),this.context=e.context,e.pageSize=this.getPageSize(),e.data||(e.data={}),e.toolbarItems||(e.toolbarItems=y),e.toolbarItemsMasks||(e.toolbarItemsMasks=new S),this.context=e.context,e.query||(e.query=this.context.getModel(r)),e.collection?e.collection.fetched||(this._originalScope=e.collection.getResourceScope()):e.collection=this.context.getModel(l,e);var a=void 0!==e.enableSearchSettings?e.enableSearchSettings:z.enableSearchSettings;if(a){var c=e.query?e.query.get("query_id"):void 0;this.loadSearchSettings(c)}e.collection.fetched||(e.collection.setResourceScope(l.getDefaultResourceScope()),e.collection.setDefaultActionCommands(F.getAllCommandSignatures($)),e.collection.setEnabledDelayRestCommands(!0),e.collection.delayedActions&&this.listenTo(e.collection.delayedActions,"error",function(e,t,i){var s=new n.Error(t);_.showMessage("error",s.message)})),e.collection.isSortOptionSelected=!0,o.LayoutView.prototype.constructor.call(this,e),this.collection.selectedItems=new s.Collection,this.metadata=e.metadata||this.context.getCollection(M,e),this.query=e.query,this.collection.setLimit(0,e.pageSize,!1),this._toggleCustomSearch(),this.commandController=new P({"commands":$}),this.listenTo(this.commandController,"before:execute:command",this._beforeExecuteCommand),this.listenTo(this.commandController,"after:execute:command",this._toolbarCommandExecuted);var h=this.namedLocalStorage.get(this._createSearchDisplayStyleKey());this.collection.prevSearchDisplayStyle=h||"StandardView",this.setSearchHeader();var d=this;this.listenTo(this.headerView,"go:back",function(){d.trigger("go:back")}),this.tableColumns=e.tableColumns?e.tableColumns:g.deepClone(),this.listenTo(this.headerView,"toggle:filter",this._completeFilterCommand),this.listenTo(this.headerView,"focus:filter",this._focusFilter),this.listenTo(this.headerView,"reload:searchForm",this._resetTargetView),this.listenTo(this.headerView,"render:table",t.bind(function(){this.columns=this.collection.searching&&this.collection.searching.sortedColumns,this.getAdditionalColumns(),this.trigger("render:table")},this)),this.listenTo(this.headerView,"toggle:description",function(e){this.trigger("toggle:description",e.showDescriptions)}),e.collection.searchFacets||(e.collection.searchFacets=this.context.getModel(k,{"options":{"query":this.options.query,"topCount":1},"detached":!0})),this.facetFilters=e.collection.searchFacets,this.enableCustomSearch&&(this.setCustomSearchView(),this.listenTo(this.customSearchView,"change:title",this.updateHeaderTitle)),this.options.blockingParentView?v.delegate(this,this.options.blockingParentView):v.imbue(this),this.listenTo(this.settings,"sync",t.bind(function(){var e=!1,i=!1
;this.settings&&this.settings.get("display")&&(this.settings.get("display").display_regions&&this.settings.get("display").display_regions.selected&&(e=t.findIndex(this.settings.get("display").display_regions.selected.models,function(e,t){return"OTLocation"===e.get("key")})),i=this.settings.get("display").summary_description&&this.settings.get("display").summary_description.selected),this.collection.isLocationColumnAvailable=e>-1,this.collection.selectedSettings=i},this)),this.listenTo(this.collection,"sync",function(){this.enableCustomSearch||this.$el.parents(".search-results-container").addClass("csui-global-search")}),this.listenTo(this.query,"change",function(){if(!this.query.get("forcePerspectiveChange")){if(this.collection.isSortOptionSelected=!0,this._updatePanels(),a){var i=this.query?this.query.get("query_id"):void 0;this.loadSearchSettings(i)}if(this.collection.isFetchable()){var s=z.csui&&z.csui.fetchFacets;this.facetFilters.clearFilter(s),this.facetFilters.fetched=!1,this.paginationView.nodeChange(),this.collection.fetch({"error":t.bind(this.onSearchResultsFailed,this,e)}),this.trigger("query:changed"),this.resetScrollToTop()}this.collection.selectedItems.reset([])}}),this.listenTo(this.options.context,"request",this.blockActions).listenTo(this.options.context,"sync",this._persistState).listenTo(this.options.context,"error",this.unblockActions).listenTo(this.collection,"request",this.executePreProcess).listenTo(this.collection,"error",this.unblockActions).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"new:page",this.resetScrollToTop);var u=this.namedLocalStorage&&this.namedLocalStorage.get(this._createSearchDisplayStyleKey()+"_PrevSRPageSize");this.options.pageSize=u||10,this.setPagination(),this.listenTo(this.collection,"sync",this.executeEndProcess),this.listenTo(this,"target:view:changed",this.executeEndProcess),!n.isMozilla()&&this.propagateEventsToRegions(),this.onWinRefresh=t.bind(this.windowRefresh,this),i(window).on("resize.app",this.onWinRefresh),this.enableCustomSearch&&this.listenToOnce(this,"dom:refresh",t.bind(function(){this.$el.width()>1023?(this.ui.searchSidePanel.addClass("csui-is-visible"),this.ui.searchResultsBody.addClass("csui-search-results-body-right")):(this.ui.searchSidePanel.addClass("search-side-panel-overlay"),this.ui.searchSidePanel.addClass("search-side-panel-auto"))},this))},"executePreProcess":function(){if(this.$el.is(":visible")){var e=this.el;e.getElementsByClassName("csui-result-list")[0].getBoundingClientRect().left!==e.getBoundingClientRect().left&&this.ui.loadingEle.addClass("csui-side-panel-exists"),this.ui.loadingEle.removeClass("binf-hidden")}this.blockActions()},"executeEndProcess":function(){this.targetView||(this.setTargetView(),this.paginationRegion.show(this.paginationView),this.targetView.trigger("set:inline:actionbar:events"),this._setFacetBarView(),this.facetBarView&&!1!==this.options.showFacetPanel&&this.facetBarRegion.show(this.facetBarView),this.correctFilterAria()),this.collection.length&&(this.trigger("render:metadata"),this.columns=this.collection.searching&&this.collection.searching.sortedColumns,this.getAdditionalColumns(),this.targetView.trigger("set:tablerow:assets"),this.collection.settings_changed&&"TabularView"===this.collection.prevSearchDisplayStyle&&(this.trigger("render:table"),this.collection.settings_changed=!1)),this.updateActionToolBar(),this.updateScrollbar(),this.unblockSearchResultsActions()},"unblockSearchResultsActions":function(){this.ui.loadingEle.removeClass("csui-side-panel-exists"),this.ui.loadingEle.addClass("binf-hidden"),this.unblockActions()},"collectionEvents":{"reset":"updateLayoutView"},"updateLayoutView":function(){var e=this.namedLocalStorage&&this.namedLocalStorage.get(this._createSearchDisplayStyleKey()+"_PrevSRPageSize");e=e||10,this.paginationView.options.pageSize=e,this.paginationView.selectedPageSize=e},"stopClosingSearchBox":function(e){i(e.target).closest(".binf-dropdown").length||i(e.target).hasClass("binf-dropdown")||i(e.target).hasClass("arrow_back")||e.stopPropagation()},"setPagination":function(){return this.paginationView=new w({"collection":this.collection,"pageSize":this.options.pageSize,"defaultDDList":[10,25,50,100]}),this.listenTo(this.paginationView,"pagesize:updated",function(e){this.paginationView.pageSize=e.pageSize,this.namedLocalStorage.set(this._createSearchDisplayStyleKey()+"_PrevSRPageSize",this.paginationView.pageSize)}),!0},"onToggleOrChangePageSize":function(e){("keypress"!==e.type||13!==e.keyCode&&32!==e.keyCode)&&"mouseup"!==e.type||(this.collection.isSortOptionSelected=!0)},"onChangePage":function(e){var t=i(e.currentTarget);parseInt(t.attr("data-pageid"),10)+1!==this.paginationView.currentPageNum&&this.onToggleOrChangePageSize(e)},"_persistState":function(){this.unblockActions()},"loadSearchSettings":function(e){this.options.templateId=e,this.settings&&this.settings.options&&(this.settings.options.templateId=e),this.settings=this.options.settings||this.context.getCollection(V,this.options),this.settings.fetch()},"_createSearchDisplayStyleKey":function(){var e,t=this.context||this.options&&this.options.context,i=(new a).getAbsolute(),s=t&&t.getModel(R).get("id");return i&&(e=i.split("//")[1].split("/")[0].split(":")[0]),e+s},"setTargetView":function(){if(this.columns=this.collection.searching&&this.collection.searching.sortedColumns,K&&this.getAdditionalColumns(),this.collection.columns=this.columns?this.columns:this.tableColumns,this.settings&&this.settings.get("display")){var e=this.settings.get("display").summary_description.selected;this.showSummaryOnly="SO"===e}var t=this.collection.prevSearchDisplayStyle;"TabularView"===t?(this.ui.toolBarContainer.addClass("binf-hidden"),this.targetView=this.setTabularSearchView(),this.targetView.trigger("set:tablerow:assets")):(this.ui.toolBarContainer.removeClass("binf-hidden"),this.targetView=this.setStandardSearchView()),this.resultsRegion.show(this.targetView,this),"StandardView"===t?(this.standardHeaderRegion.show(this.targetView.standardHeaderView),this.targetView.standardHeaderView._removeAllSelections()):this.trigger("toggle:description",this.headerView.showDescription)},"_resetTargetView":function(){this.targetView.trigger("destroy:header:view"),this.targetView.destroy(),this.targetView=void 0,this.resultsRegion.empty(),this.setTargetView(),this.executeEndProcess(),this.resetScrollToTop()},"setStandardSearchView":function(){var e=t.extend(this.options,{"collection":this.collection,"originatingView":this,"headerEle":this.ui.toolBarContainer,"context":this.context,"metadata":this.metadata});return new d(e)},"setTabularSearchView":function(){var e=t.extend(this.options,{"collection":this.collection,"columns":this.columns,"tableColumns":this.tableColumns,"originatingView":this,"container":this.container,"defaultActionController":this.defaultActionController,"config":z,"customLabels":{"emptyTableText":T.noSearchResultMessage}});return new u(e)},"_focusFilter":function(e){!!e&&e.headerView.ui.filter.trigger("focus"),this.correctFilterAria(e);var t=this.facetView&&this.facetView.$(".csui-facet");t&&t.length&&t.prop("tabindex",0)},"correctFilterAria":function(e){e&&e.headerView&&(this.ui.searchSidePanel.hasClass("csui-is-visible")?e.headerView.ui.filter.attr("title",T.filterCollapseTooltip).addClass("icon-toolbarFilterCollapse").attr("aria-label",T.filterCollapseAria):e.headerView.ui.filter.attr("title",T.filterExpandTooltip).removeClass("icon-toolbarFilterCollapse").attr("aria-label",T.filterExpandAria))},"onSearchResultsFailed":function(e,t,i){var s=new n.RequestErrorMessage(i);L.showError(s.toString())},"updateScrollbar":function(){this.triggerMethod("update:scrollbar",this)},"resetScrollToTop":function(){this.$("#results").scrollTop(0)},"updateActionToolBar":function(){0===this.collection.length?(this.ui.toolBarContainer.addClass("binf-hidden"),this.enableCustomSearch||this.ui.customSearchContainer.addClass("binf-hidden")):"StandardView"===this.collection.prevSearchDisplayStyle&&(this.ui.toolBarContainer.removeClass("binf-hidden"),this.ui.customSearchContainer.removeClass("binf-hidden"))},"openVersionHistory":function(e){var i=new A;i.push(e.model);var o={"nodes":i,"container":e.model.collection.node,"collection":e.model.collection,"selectedTab":new s.Model({"title":"Versions"})};o=t.extend(o,{"originatingView":this}),(new D).execute(o,this.options).always(function(e){})},"onPropertiesViewDestroyed":function(){this.onMetadataNavigationViewDestroyed();this.namedLocalStorage.get(this._createSearchDisplayStyleKey()+"_showDescription");"TabularView"===this.collection.prevSearchDisplayStyle&&(this.headerView.updateToggleDescription(),this.tableView&&this.tableView.render()),this.paginationView&&this.paginationView.collectionChange()},"onPermissionViewDestroyed":function(){this.onPropertiesViewDestroyed()},"onMetadataNavigationViewDestroyed":function(){this.collection.inMetadataNavigationView&&this.isTabularView&&(this.collection.inMetadataNavigationView=!1)},"_toggleCustomSearch":function(){this.enableCustomSearch=!!this.options.customSearchViewModel||!!this.options.customSearchView||this.query.get("query_id")&&Object.keys(this.query.attributes).length>1,this.enableCustomSearch?(this.$el.find("#csui-search-custom-container").addClass("csui-search-custom-container"),this.$el.find("#csui-search-custom-results").addClass("csui-search-custom-results"),this.$el.find(".csui-search-custom-tab").addClass("binf-active"),this.$el.find(".csui-search-custom-tab > a").attr("aria-selected","true")):this.customSearchView&&this.query.get("where")&&(this.customSearchRegion.empty(),this.$el.find("#csui-search-custom-container").removeClass("csui-search-custom-container"),this.$el.find("#csui-search-custom-results").removeClass("csui-search-custom-results"))},"_updatePanels":function(){if(this._toggleCustomSearch(),this.enableCustomSearch)this.$el.find(".csui-search-results-custom").removeClass("binf-hidden"),this.$el.find(".csui-search-left-panel-tabs").removeClass("binf-hidden"),this.ui.searchResultsBody.addClass("csui-search-results-body-right");else if(this.ui.searchSidePanel.hasClass("csui-is-visible")){var e=this;this.ui.searchSidePanel.one(this._transitionEnd(),function(){e.$el.find(".csui-search-results-custom").addClass("binf-hidden"),e.$el.find(".csui-search-left-panel-tabs").addClass("binf-hidden"),e.ui.searchSidePanel.hasClass("csui-is-visible")||e.ui.searchSidePanel.addClass("csui-is-hidden"),e.ui.facetView.removeClass("binf-hidden")}),this.ui.searchResultsBody.removeClass("csui-search-results-body-right"),this.ui.searchSidePanel.removeClass("csui-is-visible")}else this.$el.find(".csui-search-results-custom").addClass("binf-hidden"),this.$el.find(".csui-search-left-panel-tabs").addClass("binf-hidden"),this.ui.facetView.removeClass("binf-hidden");this.headerView&&(this.headerView.options.useCustomTitle=this.enableCustomSearch),this.facetView&&(this.facetView.options.data.showTitle=!this.enableCustomSearch,this.facetView.render())},"openCustomView":function(e){this.enableCustomSearch&&("keypress"===e.type&&13===e.keyCode||"click"===e.type)&&(this.ui.facetView.addClass("binf-hidden"),this.$el.find(".csui-search-results-custom").removeClass("binf-hidden"),this.$el.find(".csui-search-facet-tab").removeClass("binf-active"),this.$el.find(".csui-search-facet-tab > a").removeAttr("aria-selected"),this.$el.find(".csui-search-custom-tab").addClass("binf-active"),this.$el.find(".csui-search-custom-tab > a").attr("aria-selected","true"),e.stopPropagation())},"openFacetView":function(e){this.enableCustomSearch&&(this.facetFilters.ensureFetched(),this._ensureFacetPanelViewDisplayed(),("keypress"===e.type&&13===e.keyCode||"click"===e.type)&&(this.$el.find(".csui-search-results-custom").addClass("binf-hidden"),this.ui.facetView.removeClass("binf-hidden"),this.$el.find(".csui-search-custom-tab").removeClass("binf-active"),this.$el.find(".csui-search-custom-tab > a").removeAttr("aria-selected"),this.$el.find(".csui-search-facet-tab").addClass("binf-active"),this.$el.find(".csui-search-facet-tab > a").attr("aria-selected","true"),e.stopPropagation(),this.facetView.triggerMethod("dom:refresh")))},"onDestroy":function(){i(window).off("resize.app",this.onWinRefresh),this._originalScope&&this.options.collection.setResourceScope(this._originalScope),this.tableView&&this.tableView.destroy()},"windowRefresh":function(){this.facetView&&this.facetView.triggerMethod("dom:refresh"),this.targetView&&this.targetView.triggerMethod("dom:refresh"),"absolute"!=this.ui.searchSidePanel.css("position")?this.$el.width()>1023&&this.ui.searchSidePanel.hasClass("search-side-panel-overlay")&&(this.ui.searchSidePanel.removeClass("search-side-panel-overlay"),this.ui.searchSidePanel.hasClass("search-side-panel-auto")&&(this.ui.searchSidePanel.removeClass("search-side-panel-auto"),this._completeFilterCommand(this,!0))):this.ui.searchSidePanel.hasClass("search-side-panel-auto")||this.ui.searchSidePanel.hasClass("search-side-panel-overlay")||(this.ui.searchSidePanel.addClass("search-side-panel-overlay"),this.ui.searchSidePanel.hasClass("csui-is-visible")&&(this.ui.searchSidePanel.addClass("search-side-panel-auto"),this._completeFilterCommand(this,!0)))},"setSearchHeader":function(){var e=void 0!==this.options.enableSearchSettings?this.options.enableSearchSettings:z.enableSearchSettings;return this.headerView=new h({"collection":this.collection,"filter":this.options.searchString,"context":this.options.context,"enableBackButton":this.options.enableBackButton,"backButtonToolTip":this.options.backButtonToolTip,"enableFacetFilter":z.enableFacetFilter,"useCustomTitle":this.enableCustomSearch,"commands":$,"originatingView":this,"titleView":this.options.titleView,"localStorage":this.namedLocalStorage,"enableSearchSettings":e,"settings":!!this.settings&&this.settings}),!0},"getSettings":function(){return this.settings},"setCustomSearchView":function(){return this.customSearchView=this.options.customSearchView||new C({"context":this.options.context,"savedSearchQueryId":this.query.get("query_id"),"customValues":this.query,"parentView":this,"query":this.query,"model":this.options.customSearchViewModel}),!0},"getAdditionalColumns":function(){if(K){var e=this.headerView&&this.headerView.selectedSettings;switch(e=e||this.settings&&this.settings.get("display").summary_description.selected){case"SD":case"SP":case"DP":(this.tableView&&!this.tableView.columns.findWhere({"column_key":"description"})||!this.columns.findWhere({"column_key":"description"}))&&this.getDescriptionColumn(),(this.tableView&&!this.tableView.columns.findWhere({"column_key":"summary"})||!this.columns.findWhere({"column_key":"summary"}))&&this.getSummaryColumn();break;case"SO":this.removeDescriptionColumn(),(this.tableView&&!this.tableView.columns.findWhere({"column_key":"summary"})||!this.columns.findWhere({"column_key":"summary"}))&&this.getSummaryColumn();break;case"DO":this.removeSummaryColumn(),(this.tableView&&!this.tableView.columns.findWhere({"column_key":"description"})||!this.columns.findWhere({"column_key":"description"}))&&this.getDescriptionColumn();break;case"NONE":this.removeSummaryColumn(),this.removeDescriptionColumn()}}},"getDescriptionColumn":function(){this.columns.push(new b({"column_key":"description","name":T.descriptionColumnTitle,"sortable":!1,"permanentColumn":!0,"type":-1,"definitions_order":505}))},"getSummaryColumn":function(){this.columns.push(new b({"column_key":"summary","name":T.summaryColumnTitle,"sortable":!1,"permanentColumn":!0,"type":-1,"definitions_order":506}))},"removeDescriptionColumn":function(){this.tableView&&this.tableView.columns.findWhere({"column_key":"description"})&&this.tableView.columns.findWhere({"column_key":"description"}).destroy()},"removeSummaryColumn":function(){this.tableView&&this.tableView.columns.findWhere({"column_key":"summary"})&&this.tableView.columns.findWhere({"column_key":"summary"}).destroy()},"_beforeExecuteCommand":function(e){!!this.collection.selectedItems&&this.collection.selectedItems.each(function(t){t.collection=e.status.collection}),e.command&&e.command.get("selfBlockOnly")&&e.status&&e.status.toolItemView&&e.status.toolItemView.$el.find("a").addClass("binf-disabled")},"_toolbarCommandExecuted":function(e){e&&e.commandSignature&&(this.targetView&&this.targetView.trigger("update:tool:items"),e.command&&e.command.allowCollectionRefetch&&this.collection.totalCount>this.collection.topCount&&this.collection.fetch(),"Delete"!==e.commandSignature&&"Move"!==e.commandSignature||!(0===this.collection.models.length||this.collection.totalCount<this.collection.topCount)||("Move"===e.commandSignature&&this.collection.selectedItems.remove(this.collection.selectedItems.models),this.collection.trigger("sync")))},"_updateToolbarActions":function(){this.targetView&&this.targetView.trigger("set:tablerow:assets")},"_showInlineActionBar":function(e){if(e){this._savedHoverEnterArgs=null;var s=e.node.get("parent_id");s instanceof Object&&(s=e.node.get("parent_id").id);var o=new I({"id":s},{"connector":e.node.connector});this.inlineToolbarView=new x(t.extend({"context":this.options.context,"commands":$,"delayedActions":this.collection.delayedActions,"collection":this.options.toolbarItems.inlineToolbar||[],"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineToolbar,"container":o,"containerCollection":this.collection,"model":e.node,"originatingView":this,"notOccupiedSpace":0},this.options.toolbarItems.inlineToolbar&&this.options.toolbarItems.inlineToolbar.options)),this.listenTo(this.inlineToolbarView,"after:execute:command",this._toolbarCommandExecuted),this.inlineToolbarView.render(),this.listenTo(this.inlineToolbarView,"destroy",function(){this.inlineToolbarView=void 0,this._savedHoverEnterArgs&&this._showInlineActionBarWithDelay(this._savedHoverEnterArgs)},this),i(e.target).append(this.inlineToolbarView.$el),this.inlineToolbarView.triggerMethod("show")}},"_showInlineActionBarWithDelay":function(e,t){this._showInlineActionbarTimeout&&clearTimeout(this._showInlineActionbarTimeout);var i=this;this._showInlineActionbarTimeout=setTimeout(function(){i._showInlineActionbarTimeout=void 0,i._showInlineActionBar.call(i,t)},200)},"_actionBarShouldDestroy":function(e,t){this._showInlineActionbarTimeout&&(clearTimeout(this._showInlineActionbarTimeout),this._showInlineActionbarTimeout=void 0),this.inlineToolbarView&&this.inlineToolbarView.destroy()},"_destroyInlineActionBar":function(){this.inlineToolbarView&&(this.inlineToolbarView.destroy(),this.inlineToolbarView=void 0)},"onRender":function(){var e=this;if(this.headerRegion.show(this.headerView),this.enableCustomSearch&&this.customSearchRegion.show(this.customSearchView),this.enableCustomSearch)this.ui.facetView.addClass("binf-hidden"),this.ui.searchSidePanel.removeClass("csui-is-hidden");else{this.ui.searchSidePanel.removeClass("csui-is-visible");var t=this;this.ui.searchSidePanel.one(this._transitionEnd(),function(){t.ui.searchSidePanel.hasClass("csui-is-visible")||t.ui.searchSidePanel.addClass("csui-is-hidden")})}this._toggleCustomSearch(),this.$(".csui-result-list").on("scroll",function(){e.trigger("scroll")})},"_ensureFacetPanelViewDisplayed":function(){void 0===this.facetView&&!1!==this.options.showFacetPanel&&(this._setFacetPanelView(),this.facetRegion.show(this.facetView))},"_setFacetPanelView":function(){this.facetView=new q({"collection":this.facetFilters,"blockingLocal":!0,"showTitle":!this.enableCustomSearch}),this.listenTo(this.facetView,"remove:filter",this._removeFacetFilter).listenTo(this.facetView,"remove:all",this._removeAll).listenTo(this.facetView,"apply:filter",this._checkSelectionAndApplyFilter)},"_removeFacetPanelView":function(){this.facetRegion.empty(),this.facetView=void 0},"_setFacetBarView":function(){this.facetBarView=new H({"collection":this.facetFilters}),this.listenTo(this.facetBarView,"remove:filter",this._removeFacetFilter).listenTo(this.facetBarView,"remove:all",this._removeAll).listenTo(this.facetBarView,"facet:bar:visible",this._handleFacetBarVisible).listenTo(this.facetBarView,"facet:bar:hidden",this._handleFacetBarHidden)},"_checkSelectionAndApplyFilter":function(e){this.collection.selectedItems.length?L.confirmQuestion(t.str.sformat(T.dialogTemplate,T.dialogTitle),T.dialogTitle,{}).done(t.bind(function(){this.collection.selectedItems.reset([]),this._addToFacetFilter(e)},this)):this._addToFacetFilter(e)},"_addToFacetFilter":function(e){this.facetFilters.addFilter(e,!1),this.collection.setDefaultPageNum(),this.collection.fetch({"fetchFacets":!0}),this.resetScrollToTop()},"_removeFacetFilter":function(e){this.facetFilters.removeFilter(e,!1),this.collection.setDefaultPageNum(),this.collection.fetch({"fetchFacets":!0}),this.resetScrollToTop()},"_removeAll":function(){this.facetFilters.clearFilter(!1),this.collection.setDefaultPageNum(),this.collection.fetch({"fetchFacets":!0}),this.resetScrollToTop()},"_completeFilterCommand":function(e,t){var i=e.ui.searchSidePanel.css("position"),s=this;"absolute"===i&&void 0===t&&(e.ui.searchSidePanel.removeClass("search-side-panel-auto"),e.ui.searchSidePanel.addClass("search-side-panel-overlay")),e.showSidePanel=!e.ui.searchSidePanel.hasClass("csui-is-visible"),e.showSidePanel?(e.facetFilters.ensureFetched(),e._ensureFacetPanelViewDisplayed(),e.ui.searchSidePanel.removeClass("csui-is-hidden"),e.ui.searchSidePanel.one(e._transitionEnd(),function(){n.isMSBrowser()&&e.ui.searchSidePanel.hasClass("csui-is-visible")&&e.ui.searchResultsBody.addClass("csui-search-results-body-right"),e.triggerMethod("dom:refresh"),e.paginationView&&e.paginationView.triggerMethod("dom:refresh"),s.targetView&&s.targetView.triggerMethod("dom:refresh"),e.facetView.triggerMethod("dom:refresh"),s.targetView.trigger("facet:opened",!0)}).addClass("csui-is-visible"),n.isMSBrowser()||e.ui.searchSidePanel.hasClass("csui-is-visible")&&e.ui.searchResultsBody.addClass("csui-search-results-body-right")):(e.ui.searchSidePanel.one(e._transitionEnd(),function(){e.ui.searchSidePanel.hasClass("csui-is-visible")||e.ui.searchSidePanel.addClass("csui-is-hidden"),e.triggerMethod("dom:refresh"),e._removeFacetPanelView(),e.paginationView&&e.paginationView.triggerMethod("dom:refresh"),s.targetView&&s.targetView.triggerMethod("dom:refresh"),s.headerView.currentlyFocusedElement(),s.headerView.trigger("focus:filter",s),s.targetView.trigger("facet:opened",!1)}).removeClass("csui-is-visible"),e.ui.searchResultsBody.removeClass("csui-search-results-body-right")),this.facetView&&this.facetView.triggerMethod("dom:refresh"),this.listenTo(this.facetView,"dom:refresh",function(){this.headerView.currentlyFocusedElement(),this.headerView.trigger("focus:filter",this)})},"_transitionEnd":t.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if(void 0!==i.style[e])return t[e]}),"updateHeaderTitle":function(){this.headerView.setCustomSearchTitle(this.options.title)},"_handleFacetBarVisible":function(){this.ui.searchResultsContent.addClass("csui-facetbarviewOpened"),this.ui.searchResultsContent.find(".csui-facet-list-bar .csui-facet-item:last a").trigger("focus")},"_handleFacetBarHidden":function(){this.ui.searchResultsContent.removeClass("csui-facetbarviewOpened"),this.headerView.trigger("refresh:tabindexes")}},{"RowStatesSelectedRows":"selected"});return t.extend(U.prototype,c),U}),csui.define("json!csui/widgets/search.custom/search.custom.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","kind":"tile","schema":{"type":"object","properties":{"savedSearchQueryId":{"title":"{{savedSearchQueryTitle}}","description":"{{savedSearchQueryDescription}}","type":"string"}},"required":["savedSearchQueryId"]},"options":{"fields":{"savedSearchQueryId":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[258]}}}}}}),csui.define("json!csui/widgets/search.results/search.results.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","kind":"fullpage","schema":{},"options":{},"actions":[{"toolItems":"csui/widgets/search.results/toolbaritems","toolItemMasks":"csui/widgets/search.results/toolbaritems.masks","toolbars":[{"id":"otherToolbar","title":"{{otherToolbarTitle}}","description":"{{otherToolbarDescription}}"},{"id":"inlineToolbar","title":"{{inlineToolbarTitle}}","description":"{{inlineToolbarDescription}}"}]}]}),csui.define("csui/widgets/search.custom/impl/nls/search.custom.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.custom/impl/nls/root/search.custom.manifest",{"widgetTitle":"Custom View Search","widgetDescription":"Shows custom view search form for the given saved search query.","savedSearchQueryTitle":"Search query","savedSearchQueryDescription":"An existing saved search query object"}),csui.define("csui/widgets/search.results/impl/nls/search.results.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.results/impl/nls/root/search.results.manifest",{"widgetTitle":"Search Results","widgetDescription":"Shows objects found by a full-text search query and offers the most important actions for them.","otherToolbarTitle":"List Header Toolbar","otherToolbarDescription":"Toolbar, which is activated in the list header, once a list item is selected.","inlineToolbarTitle":"Inline Toolbar","inlineToolbarDescription":"Toolbar, which is displayed on the right side of a list item, when the mouse cursor is moving above it."}),csui.define("bundles/csui-search",["csui/models/widget/search.results/facet.server.adaptor.mixin","csui/models/widget/search.results/search.facets","csui/models/widget/search.results/object.to.model","csui/widgets/search.custom/search.custom.view","csui/widgets/search.custom/impl/search.object.view","csui/widgets/search.custom/impl/search.customquery.factory","csui/widgets/search.results/search.results.view","csui/widgets/search.results/toolbaritems","csui/widgets/search.results/impl/toolbaritems","json!csui/widgets/search.custom/search.custom.manifest.json","json!csui/widgets/search.results/search.results.manifest.json","i18n!csui/widgets/search.custom/impl/nls/search.custom.manifest","i18n!csui/widgets/search.results/impl/nls/search.results.manifest","csui/widgets/search.results/toolbaritems","csui/widgets/search.results/toolbaritems.masks"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"csui/bundles/csui-search",!0)});
//# sourceMappingURL=csui-search.js.map