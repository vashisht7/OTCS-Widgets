csui.define("esoc/lib/jquery.emojiarea/jquery.emojiarea.custom",["module","csui/lib/jquery","i18n"],function(e,t,i){return function(e,t,s){var n=["p","div","pre","form"],o=function(e){return e.is(":visible")?e.offset():{"top":0,"left":0}};e.emojiarea={"path":"","util":{},"icons":{},"widget":"","defaults":{"button":null,"buttonLabel":"Emojis","buttonPosition":"after"}},e.fn.emojiarea=function(t){return e.emojiarea.path=t.path,e.emojiarea.widget=t.widget,t=e.extend({},e.emojiarea.defaults,t),this.each(function(){var i=e(this);"contentEditable"in s.body&&!1!==t.wysiwyg?new c(i,t):new r(i,t)})};var a={};a.restoreSelection=function(){return t.getSelection?function(e){var i=t.getSelection();i.removeAllRanges();for(var s=0,n=e.length;s<n;++s)i.addRange(e[s])}:s.selection&&s.selection.createRange?function(e){e&&e.select()}:void 0}(),a.saveSelection=function(){return t.getSelection?function(){var e=t.getSelection(),i=[];if(e.rangeCount)for(var s=0,n=e.rangeCount;s<n;++s)i.push(e.getRangeAt(s));return i}:s.selection&&s.selection.createRange?function(){var e=s.selection;return"none"!==e.type.toLowerCase()?e.createRange():null}:void 0}(),a.replaceSelection=function(){return t.getSelection?function(e){var i,n=t.getSelection(),o="string"==typeof e?s.createTextNode(e):e;n.getRangeAt&&n.rangeCount&&(i=n.getRangeAt(0),i.deleteContents(),i.insertNode(o),i.setStart(o,0),t.setTimeout(function(){i=s.createRange(),i.setStartAfter(o),i.collapse(!0),n.removeAllRanges(),n.addRange(i)},0))}:s.selection&&s.selection.createRange?function(e){var t=s.selection.createRange();"string"==typeof e?t.text=e:t.pasteHTML(e.outerHTML)}:void 0}(),a.insertAtCursor=function(e,t){e=" "+e;var i,n,o=t.value;void 0!==t.selectionStart&&void 0!==t.selectionEnd?(i=t.selectionStart,t.selectionEnd,t.value=o.substring(0,i)+e+o.substring(t.selectionEnd),t.selectionStart=t.selectionEnd=i+e.length):void 0!==s.selection&&void 0!==s.selection.createRange&&(t.trigger("focus"),n=s.selection.createRange(),n.text=e,n.select())},a.extend=function(e,t){if(void 0!==e&&e||(e={}),"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},a.escapeRegex=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},a.htmlEntities=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var l=function(){};l.prototype.setup=function(){var e=this;this.$editor.on("focus",function(){e.hasFocus=!0}),this.$editor.on("blur",function(){e.hasFocus=!1}),this.setupButton()},l.prototype.setupButton=function(){var t,i=this;this.options.button?t=e(this.options.button):!1!==this.options.button?(t=e('<a href="javascript:void(0)">'),t.html(this.options.buttonLabel),t.addClass("emoji-button"),t.attr({"title":this.options.buttonLabel}),this.$editor[this.options.buttonPosition](t)):t=e(""),t.on("click",function(e){d.show(i)}),this.$button=t},l.createIcon=function(t){var i=e.emojiarea.icons[t],s=e.emojiarea.path||"";s.length&&"/"!==s.charAt(s.length-1)&&(s+="/");var n=e.emojiarea.iconsTitle,o=n[t],l=e("<img/>");return l.attr("src",s+i),l.attr("title",a.htmlEntities(o)),l.attr("alt",a.htmlEntities(t)),l.prop("outerHTML")};var r=function(e,t){this.options=t,this.$textarea=e,this.$editor=e,this.setup()};r.prototype.insert=function(t){e.emojiarea.icons.hasOwnProperty(t)&&(a.insertAtCursor(t,this.$textarea.eq(0)),this.$textarea.trigger("change"))},r.prototype.val=function(){return this.$textarea.val()},a.extend(r.prototype,l.prototype);var c=function(i,n){var o=this;this.options=n,this.$textarea=i,this.$editor=e("<div>").addClass("emoji-wysiwyg-editor"),this.$editor.text(i.val()),this.$editor.attr({"contenteditable":"true"}),this.$editor.on("blur keydown keyup paste",function(e){if(e.originalEvent&&"paste"===e.originalEvent.type&&t.clipboardData&&t.getSelection){var i=t.getSelection().getRangeAt(0);i.endOffset-i.startOffset>0&&i.deleteContents()}return o.onChange.apply(o,arguments)}),this.$editor.on("wheel",function(e){return e.originalEvent.deltaY>0?o.$editor.animate({"scrollTop":"+=100px"},10):o.$editor.animate({"scrollTop":"-=100px"},10),!1}),navigator.appVersion&&-1===navigator.appVersion.indexOf("MSIE 10")&&(this.$editor.on("mousedown focus keydown",function(){s.execCommand("AutoUrlDetect",!1,!1),s.execCommand("enableObjectResizing",!1,!1)}),this.$editor.on("blur",function(){s.execCommand("enableObjectResizing",!0,!0)}));var r=this.$editor.text(),c=/<span data-userid=.*?>\(@.*?\)<\/span>/gi,d=r.match(c),u=e.emojiarea.icons;for(var m in u)u.hasOwnProperty(m)&&(r=r.replace(new RegExp(a.escapeRegex(m),"g"),l.createIcon(m)));var p=r.match(c);if(null!==p&&p.length>0)for(var h in p)r=r.replace(p[h],d[h]);this.$editor.html(r),i.hide().after(this.$editor),this.setup(),e(s.body).on("mousedown touchstart keyup",function(){o.hasFocus&&(o.selection=a.saveSelection())})};c.prototype.onChange=function(e){this.$textarea.val(this.val(e)).trigger("change")},c.prototype.insert=function(t){var i=e(l.createIcon(t));i.attr("tabindex",-1),i[0].attachEvent&&i[0].attachEvent("onresizestart",function(e){e.returnValue=!1},!1),this.selection&&a.restoreSelection(this.selection);try{a.replaceSelection(i[0])}catch(e){}this.onChange(),e("#esoc-social-comment-container").find(".esoc-social-comment-list-item").removeClass("esoc-edit-init-min-height")},c.prototype.val=function(e){for(var t=[],i=[],s=function(){t.push(i.join("")),i=[]},o=function(e,t){if(3===e.nodeType)i.push(e.nodeValue);else if(1===e.nodeType){var a=e.tagName.toLowerCase(),l=-1!==n.indexOf(a);if(l&&i.length&&s(),"input"===a){if(t){if(8!=t.keyCode){var r=e.value||"";r&&i.push(r)}}else{var r=e.value||"";r&&i.push(r)}return}if("img"===a){var r=e.getAttribute("alt")||"";return void(r&&i.push(r))}"br"===a?s():navigator.appVersion&&-1===navigator.appVersion.indexOf("MSIE 10")&&"p"===a&&!e.hasChildNodes()&&s();for(var c=e.childNodes,d=0;d<c.length;d++)o(c[d],t);l&&i.length&&s()}},a=this.$editor[0].childNodes,l=0;l<a.length;l++)o(a[l],e);return i.length&&s(),t.join("\n")},a.extend(c.prototype,l.prototype);var d=function(){var i=this,n=(e(s.body),e(t));this.visible=!1,this.emojiarea=null,this.$menu=e("<div>"),this.$menu.addClass("binf-popover binf-bottom emoji-menu"),this.$menu.hide(),e('<div class="binf-arrow"></div>').appendTo(this.$menu),this.$items=e('<div class="myemoji">').appendTo(this.$menu),e("#esoc-social-comment-container").append(),e.emojiarea.widget.off("keydown").on("keydown",function(e){var t=i.emojiarea?i.emojiarea.$button:"";27!==e.keyCode&&9!==e.keyCode||(i.hide(),t&&t.trigger("focus"))}),e.emojiarea.widget.off("mouseup").on("mouseup",function(t){e(t.target).parents(".esoc-social-attachment-popover").length,!0===i.visible&&i.hide()}),n.off("resize").on("resize",function(){i.visible&&i.reposition()}),this.$menu.on("mouseup","a",function(e){return e.stopPropagation(),!1}),this.$items.on("keydown",function(t){switch(t.which){case e.ui.keyCode.LEFT:t.target.previousSibling&&e(t.target.previousSibling).trigger("focus"),t.preventDefault();break;case e.ui.keyCode.UP:e(t.target).prevAll().eq(4)&&e(t.target).prevAll().eq(4).trigger("focus"),t.preventDefault();break;case e.ui.keyCode.RIGHT:t.target.nextSibling&&e(t.target.nextSibling).trigger("focus"),t.preventDefault();break;case e.ui.keyCode.DOWN:e(t.target).nextAll().eq(4)&&e(t.target).nextAll().eq(4).trigger("focus"),t.preventDefault();break;case e.ui.keyCode.ESCAPE:i.emojiarea.$button.first().trigger("focus"),i.emojiarea.options&&i.emojiarea.options.util&&(i.emojiarea.options.util.emojiObj=i),t.preventDefault(),t.stopPropagation();default:return}}),this.$menu.on("click keydown","a",function(s){if("click"===s.type||32===(s.keyCode||s.which)){var n=e(".binf-label",e(this)).text();return t.setTimeout(function(){i.onItemSelected.apply(i,[n])},0),s.stopPropagation(),!1}}),this.load()};d.prototype.onItemSelected=function(e){this.emojiarea.insert(e),this.emojiarea.$editor.first().trigger("focus"),this.hide()},d.prototype.load=function(){var t=[],i=e.emojiarea.icons,s=e.emojiarea.iconsTitle,n=e.emojiarea.path;n.length&&"/"!==n.charAt(n.length-1)&&(n+="/");for(var o in i)if(i.hasOwnProperty(o)){var r=s[o];t.push('<a href="javascript:void(0)" title="'+r+'">'+l.createIcon(o)+'<span class="binf-label">'+a.htmlEntities(o)+"</span></a>")}this.$items.html(t.join(""))},d.prototype.reposition=function(){if(null!==this.emojiarea&&void 0!==this.emojiarea.options&&0===e(this.emojiarea.options.parent).find(".emoji-menu").length&&this.emojiarea.options.parent.append(this.$menu),null!==this.emojiarea){var t=this.emojiarea.$button,s=t.position();if(this.emojiarea.options.container){var n=this.emojiarea.$button.outerHeight(),a=o(this.emojiarea.options.container).top,l=o(this.emojiarea.$button).top,r=this.$menu.height();l-a>r+n?(s.top=t.outerHeight()-(r+n/2),this.$menu.removeClass("binf-bottom"),this.$menu.addClass("binf-top")):(this.$menu.removeClass("binf-top"),this.$menu.addClass("binf-bottom"),s.top+=t.outerHeight())}else s.top+=t.outerHeight();if(s.left+=Math.round(t.outerWidth()/2),i.settings.rtl){var c=t.parent().outerWidth()-s.left;this.$menu.css({"top":s.top,"right":c})}else this.$menu.css({"top":s.top,"left":s.left})}},d.prototype.hide=function(t){var i;this.emojiarea&&(i=this.emojiarea.options.util,isStatus=this.emojiarea.options.isStatus,this.emojiarea.menu=null,this.emojiarea.$button.removeClass("on"),this.emojiarea=null),this.$menu.remove(),e(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-minheight"),isStatus||i&&i.setCommentDialogPointer(),new u},d.prototype.show=function(e){this.emojiarea&&this.emojiarea===e||(this.emojiarea=e,this.emojiarea.menu=this,this.reposition(),this.$menu.show(),this.$menu.find("a:first").trigger("focus"),this.visible=!0)};var u=function(){d.show=function(){var e=null;return function(t){e=e||new d,e.show(t)}}()};new u}(t,window,document),t}),csui.define("esoc/lib/jquery.emojiarea/packs/custom/emojis",["module","csui/lib/jquery","esoc/lib/jquery.emojiarea/jquery.emojiarea.custom"],function(e,t,i){t.emojiarea.icons={":)":"smile32.svg",":D":"grin32.svg",":(":"sad32.svg","x(":"angry32.svg",";)":"wink32.svg",":-o":"surprise32.svg",":p":"tounge32.svg",":-s":"worried32.svg",":-/":"confused32.svg",":/)":"eyebrows_raised32.svg","(o)":"oops32.svg","(y)":"thumbsup32.svg","(n)":"thumbsdown32.svg","(*)":"star32.svg","(c)":"coffee_break32.svg","(q)":"question32.svg","(!)":"exclamation32.svg"},t.emojiarea.iconsTitle={":)":"Smile    :)",":D":"Grin    :D",":(":"Sad    :(","x(":"Angry    x(",";)":"Wink    ;)",":-o":"Surprise    :-o",":p":"Tounge    :p",":-s":"Worried    :-s",":-/":"Confused    :-/",":/)":"Raised Eyebrow   :/)","(o)":"Oops    (o)","(y)":"Thumbs Up    (y)","(n)":"Thumbs Down    (n)","(*)":"Star    (*)","(c)":"Coffee    (c)","(q)":"Question    (q)","(!)":"Exclamation    (!)"}}),csui.define("esoc/widgets/socialactions/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/widgets/socialactions/nls/root/lang",{"comments":"Comments","commentCount":"comments","oneComment":"comment","reply":"Reply","replyCount":"Reply ({0})","attachFile":"Attach file","modifiedAt":"Modified","update":"Update","cancel":"Cancel","commentBlank":"<strong>Oops.</strong> The comment field was blank.","post":"Post","posting":"Posting...","writeAComment":"Write a comment","loadingComments":"Loading comments...","deleteComment":"Delete","edit":"Edit","hide":"Hide","confirmationText1":"Are you sure that you want to delete this comment?","confirmationText2":"All replies to the comment will also be deleted.","deleteCommentheader":"Delete Comment","seeMoreReplies":"Show more replies","fromContentServer":"From Content Server","fromYourDesktop":"From your desktop","attachmentPopoverTitle":"Attachment","attachmentDeleteTitle":"Delete Attachment","editAttachmentTitle":"Edit Attachment","attachmentDeleteDescription":"Are you sure you want to delete the attachment?","close":"Close","uploadAttachment":"Uploading Attachment","deleteReplyheader":"Delete Reply","confirmationTextforReplyDelete":"Are you sure that you want to delete this reply?","emoticon":"Insert Emoji","errorOK":"OK","Smile":"Smile","Grin":"Grin","Sad":"Sad","Angry":"Angry","Wink":"Wink","Surprise":"Surprise","Tounge":"Tounge","Worried":"Worried","Confused":"Confused","RaisedEyebrow":"Raised Eyebrow","Oops":"Oops","ThumbsUp":"Thumbs Up","ThumbsDown":"Thumbs Down","Star":"Star","Coffee":"Coffee","Question":"Question","Exclamation":"Exclamation","targetPickerTitle":"Select a Shortcut","versionMsg":"Added a new version ","version":"Version -","addMsg":"Added ","defaultErrorMessageForUpdateComment":"Server Error: Unable to perform the action","defaultErrorMessageForUpdateWithAttachment":"Server Error: Unable to perform the action","defaultErrorMessageForCreateRemoteObject":"Server Error: Unable to perform the action","defaultErrorMessageForReply":"Server Error: Unable to perform the action","defaultErrorMessageCommentsFetch":"Server Error: Unable to perform the action","defaultErrorMessageUpdatePhoto":"Server Error: Unable to perform photo update","defaultErrorMessageCommentSubmit":"Server Error: Unable to post comment","more":"more","less":"less","noResults":"No results found","itemNotExist":"Sorry, the item you requested could not be accessed. Either it does not exist, or you do not have permission to access it. If you were sent a link to this item, please contact the sender for assistance."}),csui.define("esoc/widgets/socialactions/socialemoticons",["module","csui/lib/jquery"],function(e,t){t.socialEmoticons={"icons":[{"shortcut":":)","image":"smile32.svg","key":"Smile","defaulttitle":"Smile    :)"},{"shortcut":":D","image":"grin32.svg","key":"Grin","defaulttitle":"Grin    :D"},{"shortcut":":(","image":"sad32.svg","key":"Sad","defaulttitle":"Sad    :("},{"shortcut":"x(","image":"angry32.svg","key":"Angry","defaulttitle":"Angry    x("},{"shortcut":";)","image":"wink32.svg","key":"Wink","defaulttitle":"Wink    ;)"},{"shortcut":":-o","image":"surprise32.svg","key":"Surprise","defaulttitle":"Surprise    :-o"},{"shortcut":":p","image":"tounge32.svg","key":"Tounge","defaulttitle":"Tounge    :p"},{"shortcut":":-s","image":"worried32.svg","key":"Worried","defaulttitle":"Worried    :-s"},{"shortcut":":-/","image":"confused32.svg","key":"Confused","defaulttitle":"Confused    :-/"},{"shortcut":":/)","image":"eyebrows_raised32.svg","key":"RaisedEyebrow","defaulttitle":"Raised Eyebrow   :/)"},{"shortcut":"(o)","image":"oops32.svg","key":"Oops","defaulttitle":"Oops    (o)"},{"shortcut":"(y)","image":"thumbsup32.svg","key":"ThumbsUp","defaulttitle":"Thumbs Up    (y)"},{"shortcut":"(n)","image":"thumbsdown32.svg","key":"ThumbsDown","defaulttitle":"Thumbs Down    (n)"},{"shortcut":"(*)","image":"star32.svg","key":"Star","defaulttitle":"Star    (*)"},{"shortcut":"(c)","image":"coffee_break32.svg","key":"Coffee","defaulttitle":"Coffee    (c)"},{"shortcut":"(q)","image":"question32.svg","key":"Question","defaulttitle":"Question    (q)"},{"shortcut":"(!)","image":"exclamation32.svg","key":"Exclamation","defaulttitle":"Exclamation    (!)"}]}}),csui.define("esoc/widgets/activityfeedwidget/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/widgets/activityfeedwidget/impl/nls/root/lang",{"dialogTitle":"Activity Feed","searchPlaceholder":"Search in ActivityFeed","expandTitle":"Expand","name":"Step or task name","parent_id":"Workflow or task list name","versionMsg":"Added version ","modifiedAt":"Modified","addMsg":"Added ","commentMsg":"Commented ","replyMsg":"Replied ","commentLabel":"Comment","status":"\u2019s status","version":"version","contentupdates":"Content updates","statusupdates":"Status updates","attributeupdates":"Attribute updates","allusers":"All users","iamfollowing":"Users I am following","myfollowers":"My followers","myupdates":"My own updates","mentions":"@Mentions","myfavorites":"My Favorites","activitytypes":"Activity types","refineby":"Refine by","updatesfrom":"Updates from","allselectedlabel":"Activity types (All)","emptyactivityfeed":"No activities found.","emptyactivityfeedforuserprofile":"No activities","more":"more","less":"less","comments":"Comments","newupdates":"New updates","statusfeed":"Status post","cancel":"Cancel","userProfileLink":"User Profile Link"}),csui.define("hbs!esoc/widgets/activityfeedwidget/impl/newupdates",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.newupdates:n,e))+'" class="'+this.escapeExpression((o=null!=(o=t.newUpdatesWrapperClass||(null!=e?e.newUpdatesWrapperClass:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"newUpdatesWrapperClass","hash":{}}):o))+'" tabindex="0" data-cstabindex="0">\r\n  <span class="esoc-activityfeeed-new-updates">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.newupdates:n,e))+'</span>\r\n  <span title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'" class="esoc-activityfeed-close"></span>\r\n</div>'}});return i.registerPartial("esoc_widgets_activityfeedwidget_impl_newupdates",s),s}),csui.define("esoc/widgets/common/util",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/lib/jquery.emojiarea/packs/custom/emojis","csui/models/node/node.model","csui/models/nodechildren","csui/utils/log","csui/utils/commands","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/user","csui/utils/contexts/factories/member","i18n!esoc/widgets/socialactions/nls/lang","csui/dialogs/modal.alert/modal.alert","esoc/widgets/socialactions/socialemoticons","csui/utils/namedsessionstorage","csui/utils/url","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","hbs!esoc/widgets/activityfeedwidget/impl/newupdates","csui/lib/jquery.binary.ajax"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v,b,w){return{"globalConstants":{"MAX_ID":"max_id","SINCE_ID":"since_id","MAX_CHAR_LIMIT":1e3,"REPLY_COUNT":"reply_count","REQUEST_TYPE_ATTACHMENT_DELETE":"AttachmentDelete","FETCH_NEXT_PAGE_MODELS_LENGTH":5,"SHOW_SEE_MORE_MODELS_LENGTH":4,"DOCUMENT_ATTACHMENT_SUBTYPE":144,"SHORTCUT_ATTACHMENT_SUBTYPE":1,"ROI_OBJECT_TYPE":952,"MEMBERS":"/members/","PHOTO":"/photo","USERID":"userid","USERDETAILS":"userdetails","ESOCIAL_USER_INFO":"esoc-user-info","EMOJI_URL":"/socialfeed/app/lib/jquery.emojiarea/packs/custom","PULSE_RESOURCE_COUNT":10,"FRIENDS":"friends","FOLLOWERS":"followers","INCLUDES":"includes","EXTENDEDINFO":"extendedInfo","CHAT_SEETING":"chatSetting","CHAT_SEETINGS":"chatSettings","FIELD_MAX_CHAR_LIMIT":"maxCharLimit","UPDATE_EXTENDED_INFO":"updateExtendedInfo","FIELDS":"fields","COUNT":"count","SETTINGS":"settings","USER_PRIVACY_SETTINGS":["everyone","follow","nobody"],"FOLLOW":"follow","UNFOLLOW":"unfollow","ACTION":"action","UPDATE_SETTINGS_ACTION":"updateSettings","CONTENT_PRIVACY":"contentPrivacy","STATUS_PRIVACY":"statusPrivacy","EXPAND":"expand","MEMBER":"member","HTTP_LINK":"http://","event_bus":i.extend({},s.Events),"URI_DELIMITER":":","AT_SIGN_SYMBOL":"@","URI_PREFIX":"sip"},"REST_URLS":{"csGetCommentRESTUrl":"/pulse/statuses/public_timeline?includes=actions,reply_count,user_info&excludes=replies&count=5&","csPostCommentRESTUrl":"/pulse/statuses/update","csGetROI":"/objectsocialinfo?","csCreateROI":"/remote_objects","csGetAFSinceId":"/pulse/statuses/socialactivity?where_feedtype=","membersRESTUrl":"/members?where_type=0","chatHistoryUrl":"/members/","pulseRestUrl":"/pulse/members/","pulseInfoRestUrl":"/pulse_info","updatePhotoUrl":"/pulse/upload_profile_photo","pulseSettingsUrl":"/pulse/settings","searchUsersUrl":"/pulse/searchUsers","deletePhotoUrl":"/pulse/members/photo"},"config_settings":{"feedsAutoRefreshWait":6e4,"maxMessageLength":1e3,"maxNumOfEntries":20,"visibility":"on"},"lang":m,"log":l,"onClickableUrl":function(e,i){e=e.replace(/<img/gi," <img"),e=e.replace(/&nbsp;/gi," ");var s=/(https?:\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi,n=/https?:\/\/\S+\.(svg)/gi,o=e.match(n);o&&o.length>0&&(e=e.replace(/.svg"/gi,'.svg" '));var a=e.match(s),l=e,r="",c=0,d=1,u=0;if(null!==a&&a.length>0){for(c=0;c<a.length;c++){u=l.indexOf(a[c]),u>0&&(r+=l.substring(0,u));var m=a[c].split("&lt;");if(0!==m[0].indexOf(t.emojiarea.path)||i)for(m[0].length>30?(m[0]=this.revHtmlEntities(m[0]),r+='<a href="'+m[0]+'" onclick="window.open(this.href,\'_blank\');return false;" >'+this.decodeHtmlEntities(m[0].substring(0,30))+"...</a>"):r+='<a href="'+m[0]+'" onclick="window.open(this.href,\'_blank\');return false;" >'+m[0]+"</a>",d=1;d<m.length;d++)r+="&lt;"+m[d];else r+=m[0];l=l.substring(u+a[c].length)}r+=l}else r=e;return r},"getEmojiPath":function(e){var t=this,i=e.connection;return new g(i.url).getOrigin()+i.supportPath+t.globalConstants.EMOJI_URL},"createEmojiIcons":function(){var e=new Object({}),i=this,s=new Object({});t.each(t.socialEmoticons.icons,function(t,n){e[n.shortcut]=n.image,i.lang[n.key]?s[n.shortcut]=i.lang[n.key]+"  "+n.shortcut:s[n.shortcut]=n.defaulttitle}),t.emojiarea.icons=e,t.emojiarea.iconsTitle=s},"addEmoji":function(e,i,s){var n=e.html(),o=t.emojiarea.icons;for(var a in o)o.hasOwnProperty(a)&&(n=n.replace(new RegExp((a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g"),this.createIcon(a,s)));e[0].innerHTML=i?this.onClickableUrl(n):n},"preventDrop":function(e){e.on("drop",function(e){return e.preventDefault(),!1})},"createIcon":function(e,i){t.emojiarea.path=this.getEmojiPath(i);var s=t.emojiarea.icons[e],n=t.emojiarea.path||"";n.length&&"/"!==n.charAt(n.length-1)&&(n+="/");var o=t.emojiarea.iconsTitle,a=o[e];return"<img src='"+n+s+"' title='"+this.htmlEntities(a)+"' alt='"+this.htmlEntities(e)+"'>"},"htmlEntities":function(e){var t=document.createElement("textarea");return t.innerHTML=e,String(t.value).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},"openWarningDialog":function(e){t(e.parent).append(t("#mdAlert")),p.showWarning(this.replaceBreakTagWithNewLine(e.errorContent)),t("#mdAlert .btn-close, #mdAlert .binf-close").on("click",function(){t("body").append(t("#mdAlert"))})},"openErrorDialog":function(e){t(e.parent).append(t("#mdAlert")),p.showError(this.replaceBreakTagWithNewLine(e.errorContent)),t("#mdAlert .btn-close, #mdAlert .binf-close").on("click",function(){t("body").append(t("#mdAlert"))})},"replaceBreakTagWithNewLine":function(e){if(e){var t=/<br\s*[\/]?>/gi;return e.replace(t,"\n")}return""},"isChrome":function(){return window.navigator.appVersion.indexOf("Chrome")>0},"isIE":function(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0},"onCommentFormPaste":function(e,t,i){var s;e.preventDefault(),e.originalEvent.clipboardData?(s=(e.originalEvent||e).clipboardData.getData("text/plain"),s.length+t>i&&(s=s.substr(0,i-t)),document.execCommand("insertText",!1,s)):window.clipboardData&&(s=window.clipboardData.getData("Text"),s.length+t>i&&(s=s.substr(0,i-t)),document.execCommand("AutoUrlDetect",!1,!1),window.getSelection&&(window.getSelection().getRangeAt(0).insertNode(document.createTextNode(s)),window.getSelection().removeAllRanges()))},"fillDefaultActivityOptions":function(e){var t=e.data?e.data:e;t&&(void 0===t.feedtype&&(t.feedtype="all"),void 0===t.feedsource&&(t.feedsource={"source":"all"}),void 0===t.feedSettings&&(t.feedSettings={"enableComments":!0}),void 0===t.updatesfrom&&(t.updatesfrom={"from":"all"})),e=t},"getActivityWidgetId":function(e){var t="",i=e.data?e.data:e;return i&&(void 0!==i.feedtype&&(t="ft",i.feedtype.indexOf("all")>-1&&(t+="_a"),i.feedtype.indexOf("content")>-1&&(t+="_c"),i.feedtype.indexOf("status")>-1&&(t+="_s"),i.feedtype.indexOf("attributes")>-1&&(t+="_at")),void 0!==i.feedsource&&(t+="_fs_",void 0!==i.feedsource.source&&(t+=i.feedsource.source),void 0!==i.feedsource.id&&(t+=i.feedsource.id)),t+="_fst_",void 0!==i.feedSettings&&i.feedSettings.enableComments&&(t+="ec"),void 0!==i.feedSettings&&i.feedSettings.enableFilters&&(t+="ef"),void 0!==i.enableComments&&i.enableComments&&(t+="ec"),void 0!==i.enableFilters&&i.enableFilters&&(t+="ef"),void 0!==i.updatesfrom&&(t+="_uf_",void 0!==i.updatesfrom.from&&(t+=i.updatesfrom.from),void 0!==i.updatesfrom.id&&(t+=i.updatesfrom.id)),void 0!==i.wrapperClass&&(t+="_hr_"),void 0!==i.origin&&(t+="_org_"+i.origin),void 0!==i.honorfeedsource&&(t+="_hfs_"+i.honorfeedsource)),t},"navigationWithArrowKeys":function(e,i){var s,n,o,a,l=this;s=e.$el.find(".esoc-activityfeed-list-item a").filter(":visible"),s.prop("tabindex","-1").attr("data-cstabindex","-1"),n=e.$el.find(".esoc-activityfeed-list-item:first div a:first"),n&&n.length&&(n.prop("tabindex","0").attr("data-cstabindex","0"),a=n),o=e.$el.find("*[data-cstabindex=0]"),o.length&&o.prop("tabindex",0),e.$el.find(i).on("keydown",".esoc-activityfeed-list-item",function(i){var s,n,o,r=i.currentTarget,c=i.target,d=t(r).find("div a:not(.esoc-hide-element)"),u=d.length;if(9===i.keyCode){var m=e.options.userProfileView;m&&(o=m.$el.find("ul.esoc-user-profile-tabcontainer li").eq(m.options.tabIndex+1),o.children()&&o.children().eq(0)&&(i.preventDefault(),i.stopPropagation(),o.children().eq(0).trigger("focus")),e.$el.find("[tabindex="+m.options.tabIndex+"]").filter(":visible").prop("tabindex","-1"))}if(i.keyCode===t.ui.keyCode.DOWN){for(n=0;n<u;n++)if(d[n]===c){s=d[n+1];break}n!==u-1||s||(o=t(r).next(),s=t(o).find("div a:first")),s&&!t(s).length&&(o=t(o).next(),s=t(o).find("div a:first"))}else if(i.keyCode===t.ui.keyCode.UP){for(n=0;n<u;n++)if(d[n]===c){s=d[n-1];break}0!==n||s||(o=t(r).prev(),s=t(o).find("div a:not(.esoc-hide-element):last")),s&&!t(s).length&&(o=t(o).prev(),s=t(o).find("div a:not(.esoc-hide-element):last"))}t(s).length&&(l.moveFocusFromSrcToDest(e,t(c),t(s)),a=t(s),i.preventDefault())});var r='.csui-facet:first [data-cstabindex="0"],.csui-facet:first [data-cstabindex="-1"]',c=[];"userwidget"!==e.options.origin?(c.push(r),c.push('.csui-facet:last [data-cstabindex="0"],.csui-facet:last [data-cstabindex="-1"]')):c.push(r),c.forEach(function(i){e.$el.find(i).on("focus",function(i){var s,n=t(i.target);n.is(":visible")&&(i.hasOwnProperty("originalEvent")&&"-1"===n.attr("data-cstabindex")?(s=e.$el.find('.csui-facet:first input[data-cstabindex="0"]'),l.moveFocusFromSrcToDest(e,s,n,!0)):l.addTabableClass(e,t(i.target)))})}),e.$el.find(i).on("focus",".esoc-activityfeed-list-item",function(i){var s=t(i.target);s.is(":visible")&&(a||(a=e.$el.find('.esoc-activityfeed-list-item [data-cstabindex="0"]')),i.hasOwnProperty("originalEvent")&&"-1"===s.attr("data-cstabindex")?l.moveFocusFromSrcToDest(e,a,s,!0):l.addTabableClass(e,s),a=s)})},"moveFocusFromSrcToDest":function(e,t,i,s){if(t[0]===i[0])return void this.addTabableClass(e,i);-1===t.prop("tabindex")?i.prop("tabindex","0").attr("data-cstabindex","0"):i.prop("tabindex",t.prop("tabindex")).attr("data-cstabindex","0"),t.prop("tabindex","-1").attr("data-cstabindex","-1"),this.addTabableClass(e,i),s||i.trigger("focus")},"addTabableClass":function(e,t){var i,s=e.options.userProfileView;i=s?s.options:e,i.focusedElement&&i.focusedElement.removeClass(v.accessibilityActiveElementClass),t.addClass(v.accessibilityActiveElementClass),i.focusedElement=t},"getUserProfileRestApiURL":function(e,t){return e+this.globalConstants.MEMBERS+t+this.globalConstants.PHOTO},"getUserPhotoURL":function(e){var i=t.Deferred(),s=function(t){return g.combine(new g(e.connectionURL).getCgiScript(),t.attributes.photo_url)};if(e.userModel&&e.userModel.attributes.hasOwnProperty("photo_url")){var n=e.userModel.get("photo_url")?s(e.userModel):"";i.resolve(n)}else{var o=this.getUserWidgetModel(e);e.noCache?o.fetch().done(function(){i.resolve(s(o))}):o.ensureFetched().done(function(){i.resolve(s(o))})}return i},"updateQueryStringValues":function(e,t,i){var s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),n=-1!==e.indexOf("?")?"&":"?";return e.match(s)?e.replace(s,"$1"+t+"="+i+"$2"):e+n+t+"="+i},"decodeHtmlEntities":function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},"revHtmlEntities":function(e){return String(e).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},"updateAjaxCall":function(e){var i=this,s=e.itemview,n=e.url,o=e.currentNodeModel,a=e.requestType,l=e.userId||s&&s.model.get("id"),r=e.targetElement,c=(e.photoElement,e.defaultPhotoElement,e.data),u=e.type,m=(e.imageElement,function(){var e=s.options.context&&s.options.context.getFactory(d);s&&e&&(e.options[l]&&(e.options[l]=""),e.options[l+"_blob_content"]&&(e.options[l+"_blob_content"]=""))}),p=e.connector;p.authenticator.syncStorage(),t.ajax(p.extendAjaxOptions({"url":n,"type":u,"data":c,"contentType":!1,"crossDomain":!0,"processData":!1,"success":function(e,n,l){switch(a){case"updatePhoto":m(),s.$el.find(".esoc-userprofile-actions .esoc-profile-img-load-container").removeClass("esoc-progress-display"),s.$el.find(".esoc-userprofile-actions .esoc-full-profile-avatar").removeClass("esoc-profile-opacity"),s.$el.find(t("#esoc-profilepic-desktop-attachment")).val("");var r={"noCache":!0,"connector":p,"userid":s.options.userid,"context":s.options.context};i.setProfilePic(r);var c=s.options.context.getModel(d),u=i.getUserPhotoURL({"context":r.context,"noCache":r.noCache,"connectionURL":p.connection.url,"userid":r.userid});u.promise().done(function(e){c.attributes.photo_url=e.replace(new g(p.connection.url).getCgiScript(),""),s.$el.find(".esoc-simple-user-widget").length>0&&s.model&&(s.model.attributes.photo_url=e.replace(new g(p.connection.url).getCgiScript(),"")),c.trigger("change"),t(".esoc-simple-profile-img-load-container").removeClass("esoc-simple-profile-img-load-icon")}),s.$el.find(t("#esoc-profilepic-desktop-attachment")).val("");break;case"deletePhoto":m(),r={"noCache":!0,"connector":p,"userid":s.options.userid,"context":s.options.context},i.setProfilePic(r),c=s.options.context.getModel(d),u=i.getUserPhotoURL({"context":r.context,"noCache":r.noCache,"connectionURL":p.connection.url,"userid":r.userid}),u.promise().done(function(e){c.attributes.photo_url=e.replace(new g(p.connection.url).getCgiScript(),""),s.$el.find(".esoc-userprofile-default-avatar").css("display","inline-flex"),s.$el.find(".esoc-simple-user-widget").length>0&&s.model&&(s.model.attributes.photo_url=e.replace(new g(p.connection.url).getCgiScript(),"")),c.trigger("change")});break;case"updateCommentCount":var h=e.results&&e.results.data&&e.results.data.properties;h&&i.updateCommentCount({"currentNodeModel":o,"commentCount":h.wnd_comments});break;case"getCommentCount":var f=e.results&&e.results[0]&&e.results[0].data&&e.results[0].data.properties;f&&i.updateCommentCount({"currentNodeModel":o,"commentCount":f.wnd_comments})}},"error":function(e,t,n){switch(a){case"updatePhoto":s.$el.find(".esoc-userprofile-actions .esoc-profile-img-load-container").removeClass("esoc-progress-display"),s.$el.find(".esoc-userprofile-actions .esoc-full-profile-avatar").removeClass("esoc-profile-opacity"),s.$el.find("#esoc-profilepic-desktop-attachment").val("");var o={"parent":r,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:i.lang.defaultErrorMessageUpdatePhoto};i.openErrorDialog(o)}}}))},"updateCommentCount":function(e){var i=e.currentNodeModel,s=e.commentCount;if(i.attributes.wnd_comments=s,void 0!==s){var n=t(".wnd_comments_validated[data-csid='"+i.attributes.id+"']"),o=t(".esoc-socialactions-comment[data-value='"+i.attributes.id+"']");s>1?(n.attr("title",s+" "+m.commentCount),o.attr("aria-label",s+" "+m.commentCount)):1===s?(n.attr("title",s+" "+m.oneComment),o.attr("aria-label",s+" "+m.oneComment)):(n.attr("title",""),o.attr("aria-label",m.comments)),s>0?(s=s>99?"99+":s,n.html(s)):n.html("")}},"setProfilePic":function(e){var s=e.context,n=e.context.getObject(c),o=n.connection;new g(o.url);this.getUserPhotoURL({"context":e.context,
"noCache":e.noCache,"connectionURL":o.url,"userid":e.userid,"userModel":e.userModel}).promise().done(function(a){var l=e.photoElement?e.photoElement:t(".esoc-userprofile-img-"+e.userid),r=e.defaultPhotElement?e.defaultPhotElement:t(".esoc-user-default-avatar-"+e.userid);a&&a.match(/v=/)?function(a){var c=t.Deferred(),u=e.userid,m=s&&s.getFactory(d),p=m&&m.options[u];return p&&p.length?m.options[u+"_blob_content"]?c.resolve(m.options[u+"_blob_content"],l,r):m.options[u].push(function(e){c.resolve(e,l,r)}):(m.options[u]=[],m.options[u].push(function(e){c.resolve(e,l,r)}),n.makeAjaxCall({"url":a,"dataType":"binary","connection":o}).done(function(e){var t=URL.createObjectURL(e);m.options[u+"_blob_content"]=t,i.each(m.options[u],function(e){e(t)}),m.options[u]=[]}).fail(c.reject)),c.promise()}(a).done(function(t,i,s){s.hide(),i.show(),i.removeClass("binf-hidden"),i.attr("src",t),e.viewShownEvent&&e.parentView&&e.parentView.trigger("view:shown")}).fail(function(){l.hide(),l.removeClass("binf-hidden"),r.addClass("esoc-user-show-profilepic"),r.css("display","inline-flex"),r.removeClass("binf-hidden"),e.viewShownEvent&&e.parentView&&e.parentView.trigger("view:shown")}):(l.hide(),l.removeClass("binf-hidden"),r.addClass("esoc-user-show-profilepic"),r.css("display","inline-flex"),r.removeClass("binf-hidden"),e.viewShownEvent&&e.parentView&&e.parentView.trigger("view:shown"))})},"setUserColor":function(e){var i=e.defaultPhotElement?e.defaultPhotElement:t(".esoc-user-default-avatar-"+e.userid);e.userbackgroundcolor&&i&&i.css("background",e.userbackgroundcolor)},"openItem":function(e){var i=this,s=e.node,n=e.callingViewInstance,o=!!s.original&&s.original.get("id")>0;(s.get("container")||5574===s.get("type")||o&&(s.original.get("container")||258===s.original.get("type")))&&(t(".esoc-user-widget-dialog .cs-close").trigger("click"),i.unbindWidget(),t(".activityfeed-expand .cs-close").trigger("click")),n.triggerMethod("execute:defaultAction",s)},"getV2Url":function(e){return e.replace("/v1","/v2")},"unbindWidget":function(e){e&&e.activityfeeditem&&(e.commentAction?(delete e.commentAction,e.activityfeeditem.trigger("commentdialog:action")):e.activityfeeditem.trigger("start:notification")),t("[id*=esoc-social-comment-widget]").remove(),t("[id*=esoc-social-comment-widget-pointer]").remove(),t("[id*=esoc-social-comment-widget-mask]").remove(),t(".cs-expanded.activityfeed-expand.esoc").prop("disabled",!1)},"isTextOverflown":function(e){var t=e[0]||e,i=t.style.overflow;i&&"visible"!==i||(t.style.overflow="hidden");var s=t.clientWidth+5<t.scrollWidth||t.clientHeight+5<t.scrollHeight;return t.style.overflow=i,s},"showMoreContent":function(e,i,s){var n=t(i.$el.find(".esoc-see-less").eq(0)),o=t(i.$el.find(".esoc-see-more").eq(0)),a=t(s).eq(0);t(n).removeAttr("style"),t(n).show().removeClass("esoc-hide-element").trigger("focus"),t(o).hide().addClass("esoc-hide-element"),t(a).removeClass("esoc-see-more-content"),i.options.parentCollectionView.triggerMethod("update:scrollbar"),t(a).removeClass("esoc-see-more-activity"),t(a).addClass("esoc-see-less-activity")},"showLessContent":function(e,i,s){var n=t(i.$el.find(".esoc-see-less").eq(0)),o=t(i.$el.find(".esoc-see-more").eq(0)),a=t(s).eq(0);t(n).hide().addClass("esoc-hide-element"),t(o).removeAttr("style"),t(o).show().removeClass("esoc-hide-element").trigger("focus"),t(a).addClass("esoc-see-more-content"),i.options.parentCollectionView.triggerMethod("update:scrollbar"),t(a).addClass("esoc-see-more-activity"),t(a).removeClass("esoc-see-less-activity")},"alignUpdateButton":function(e,i){var s,n,o=t(".esoc-activityfeed-list.esoc-activityfeed-list-"+e);i?(s=t("<div />",{"class":"esoc-activityfeed-new-updates-wrapper","html":w({"messages":b,"newUpdatesWrapperClass":"esoc-activityfeed-getnewupdates esoc-activityfeed-getnewupdates-"+e})}),0===o.closest(".esoc-afw-newupdates").parent().find(".esoc-activityfeed-getnewupdates-"+e).length&&(o.closest(".esoc-afw-newupdates").parent().append(s),n=t("<div />",{"class":"esoc-activityfeed-invisiblebutton"}),o.append(n))):s=t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+e),o.length>0&&s.css({"position":"absolute","top":"15px","left":"50%","transform":"translate(-50%, -50%)"})},"updateSelection":function(e,i,s){if("checkbox"===e.target.type){var n=i.$el.find("#"+e.target.id+"_checkbox");e.target.checked?n.addClass("icon-checkbox-selected").removeClass("icon-checkbox"):n.addClass("icon-checkbox").removeClass("icon-checkbox-selected")}else if("radio"===e.target.type){var o=e.target.id;i.$el.find('input[type="radio"]').each(function(){var e=t(this).attr("id");e!==o?(t(this).prop("checked",!1),i.$el.find(t("#"+e+"_radio")).addClass("icon-radiobutton").removeClass("icon-radiobutton-selected")):(t(this).prop("checked",!0),i.$el.find(t("#"+e+"_radio")).addClass("icon-radiobutton-selected").removeClass("icon-radiobutton"))})}},"getUserWidgetModel":function(e){var t=e.context.getModel(u,{"attributes":{"id":e.userid},"options":{"id":e.userid,"connector":e.connector},"temporary":!0});return t.setExpand("member"),t},"buildNodeModel":function(e,t,s){var n=i.extend({},e.attributes);return delete n.actions,s?(n=i.extend({"commands":e.attributes.attachmentCommands},n),n.id=e.attributes.extended_info&&e.attributes.extended_info.attachment_original_data_id?parseInt(e.attributes.extended_info.attachment_original_data_id,10):parseInt(e.attributes.extended_info.attachment_id,10)):(n=i.extend({"commands":e.attributes.sgmCommands},n),n.id=1===e.attributes.extended_info.subtype?e.attributes.extended_info.sgm_original_data_id:e.attributes.data_id),new o(n,{"connector":t,"parse":!0})},"placeCaretAtEnd":function(e){if(void 0!==window.getSelection&&void 0!==document.createRange){e.trigger("focus");var t=(window.getSelection().focusNode.textContent,window.getSelection());if(t.rangeCount){var i=t.getRangeAt(0);i=i.cloneRange(),i.selectNodeContents(e[0]),i.collapse(!1),t.removeAllRanges(),t.addRange(i)}e.trigger("focus")}else if(void 0!==document.body.createTextRange){var s=document.body.createTextRange();s.moveToElementText(e),s.collapse(!1),s.select()}}}}),csui.define("esoc/widgets/userwidget/model/userwidget.model",["csui/lib/backbone","csui/utils/url","csui/utils/namedsessionstorage","esoc/widgets/common/util"],function(e,t,i,s){return e.Model.extend({"defaults":{"userid":"","firstname":"","lastname":"","username":""},"connector":"","namedSessionStorage":new i(s.globalConstants.ESOCIAL_USER_INFO),"constructor":function(t,i){void 0!==t&&(this.attributes=t),this.defaults.userid=i.userid,e.Model.prototype.constructor.apply(this,arguments),i&&i.connector&&i.connector.assignTo(this)},"url":function(){return s.updateQueryStringValues(t.combine(this.connector.connection.url,"members",this.attributes.userid),s.globalConstants.EXPAND,s.globalConstants.MEMBER)},"parse":function(e){var t={},i=e.data;return t.display_name=i.display_name,t.id=i.id,t.department_name=i.group_id?i.group_id.name:"",t.office_location=i.office_location,t.business_email=i.business_email,t.title=i.title,t.business_fax=i.business_fax,t.business_phone=i.business_phone,t.time_zone=i.time_zone,t.photo_url=i.photo_url,t.deleted=i.deleted,""!==this.attributes.userid&&this.namedSessionStorage.set(s.globalConstants.USERDETAILS+this.attributes.userid,t),t}})}),csui.define("esoc/widgets/userwidget/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/widgets/userwidget/nls/root/lang",{"comments":"Comments","viewprofile":"View profile","unfollow":"Unfollow","follow":"Follow","chat":"Chat","chatlabeltext":"Chat with {0}","general":"General","extended":"Extended","personal":"Personal","following":"Following","followers":"Followers","followingTooltip":"Following {0}","followersTooltip":"Followers {0}","activity":"Activity","settings":"Settings","notification":"Notifications","notifyMentions":"Notify me when I am mentioned","notifyNewFollower":"Notify me when I have a new follower","notifyCommentsMyPosts":"Notify me when someone comments on my content","notifyCommentsMyThreads":"Notify me when someone comments on a thread I have participated in","notifyPrivateMessages":"Notify me when I am sent a private message","privacySettings":"Privacy settings for content messages","privacySettingsForStatusMessages":"Privacy settings for status messages","privacyEveryOne":"Everyone","privacyFollow":"Only the people I follow","privacyNone":"Only me","notifyMyUpdatesTo":"Show my updates to:","myProfile":"My profile","othersProfile":"{0}'s profile","phone":"Phone:","fax":"Fax:","timezone":"Time zone:","facebookLink":"Facebook profile link","linkedinLink":"Linkedin profile link","twitterLink":"Twitter profile link","manager":"Manager's name","defaultManagerMessage":"Enter the name of your manager.","languagesSpoken":"Languages spoken","aboutMe":"About me","jobDescription":"Job description","expertiseAreas":"Areas of expertise","pastPositions":"Past positions","degrees":"Degrees / Certifications","awards":"Awards / Honors","defaultLanguagesMessage":"List the languages that you speak.","defaultAboutMeMessage":"Write a brief description about yourself.","defaultfacebookMessage":"Provide a link to your Facebook profile.","defaultLinkedInMessage":"Provide a link to your LinkedIn profile.","defaulttwitterLinkMessage":"Provide a link to your Twitter profile.","defaultJobDesc":"Summarize your job responsibilities.","defaultExpertise":"Describe your areas of expertise.","defaultPastPositions":"List your relevant past positions.","defaultDegreeMessage":"List your degrees or certifications.","defaultAwardMessage":"List your awards or honors.","noFollowersMessage":"List is empty. No one is following you","noFriendsMessage":"You are not following anyone yet. To begin following, search for a user and, on their profile page, click Follow.","updatePic":"Update picture","edit":"Edit","update":"Update","cancel":"Cancel","more":"more","less":"less","userpickerplaceholder":"Search Users","defaultErrorMessageForMiniProfilePopup":"Server Error: Unable to display miniprofile","defaultErrorMessageForRelation":"Server Error: Unable to perform operation","defaultErrorMessageForUpdateSettings":"Server Error: Unable to update settings","defaultErrorMessageForUpdateExtentedField":"Server Error: Unable to update field","defaultErrorMessageForUpdateExtentedLink":"Server Error: Unable to update link","defaultErrorMessageForUserProfileActionLink":"Server Error: Unable to follow/unfollow a deleted user","previous":"Previous","next":"Next","emoticon":"Insert Emoji","defaultStatusPost":"Post your status here","statusPost":"My status","defaultErrorMessageForStatusPost":"Server Error: Unable to post status","presenceTooltipTextFormat":"{0} {1}","presenceUnknownTooltipText":"Unknown","presenceBeRightBackTooltipText":"Be Right Back","presenceBusyTooltipText":"Busy","presenceAwayTooltipText":"Away","presenceOfflineTooltipText":"Offline","presenceOnlineTooltipText":"Online","presenceInaConferenceCallTooltipText":"In a Conference Call","presencePresentingTooltipText":"Presenting","presenceDoNotDisturbTooltipText":"Do Not Disturb","presenceInaMeetingTooltipText":"In a Meeting","presenceInaCallTooltipText":"In a Call","presenceIdleOnlineTooltipText":"Inactive","presenceIdleBusyTooltipText":"Inactive Busy","presenceOutOfOfficeTooltipText":"Out of Office","goBackTo":"Go Back to","othersProfileTooltip":"'{0}'s' profile","simpleUserProfileManagerLabel":"Manager","simpleUserProfileOfficeLocation":"Office location","simpleUserProfileEmail":"Email","simpleUserProfileLabel":"Update profile picture","simpleUserProfileMobile":"Mobile","simpleUserProfilePhoneLabel":"Phone","profile":"Profile","uploadProfilePicture":"Upload profile picture","deleteProfilePicture":"Delete profile picture","dialogCloseButtonTooltip":"Close","closeDialogLabel":"Close Dialog","chatLabel":"Chat","image":"User Picker Image"}),csui.define("hbs!esoc/widgets/userwidget/impl/miniprofile",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'    <div class="esoc-mini-profile-user binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-simple-mini-profile-user">\r\n        <div\r\n            class="esoc-mini-profile-userinfo binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <div class="esoc-mini-profile-user-displayname">\r\n            <a href="javascript:void(0);" class="esoc-mini-profile-user-name binf-line-clamp"\r\n               title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+"</a>\r\n          </div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.title:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.office_location:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.business_email:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.business_phone:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.cell_phone:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+'        </div>\r\n      </div>\r\n      <div class="esoc-simple-mini-profile-user-img">\r\n\r\n        <div class="esoc-mini-profile-img">\r\n        <span class="esoc-mini-profile-avatar">\r\n           <a href="javascript:void(0);" class="esoc-mini-profile-pic">\r\n             <span class="image_user_placeholder esoc-miniprofile-default-avatar\r\n                esoc-user-default-avatar-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n             <img id="esoc-mini-profile-pic-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="esoc-userprofile-img-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'\r\n                binf-img-circle" title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'" alt="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'" src="#">\r\n           </a>\r\n        </span>\r\n        </div>\r\n        <div id="esoc-mini-profile-chat-comment" class="esoc-miniprofile-chat-action-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'\r\n        esoc-mini-profile-chat-comment"></div>\r\n        <div id="esoc-mini-profile-presence-indicator" class="esoc-mini-profile-presence-indicator binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n      binf-col-xs-12"></div>\r\n      </div>\r\n\r\n    </div>\r\n'},"2":function(e,t,i,s){var n;return'            <div class="esoc-mini-profile-user-title" title="'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</div>\r\n"},"4":function(e,t,i,s){var n;return'            <div class="esoc-mini-profile-user-location"\r\n                 title="'+this.escapeExpression((n=null!=(n=t.office_location||(null!=e?e.office_location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"office_location","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.office_location||(null!=e?e.office_location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"office_location","hash":{}}):n))+"\r\n            </div>\r\n"},"6":function(e,t,i,s){var n;return'            <div class="esoc-mini-profile-user-displayemail">\r\n              <a class="esoc-mini-profile-user-email" href="mailto:'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+'"\r\n                 title="'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+"</a>\r\n            </div>\r\n"},"8":function(e,t,i,s){var n;return'            <div class="esoc-mini-profile-user-phone-data">\r\n              <div class="esoc-mini-profile-user-phone-label">'+this.escapeExpression((n=null!=(n=t.business_phone_label||(null!=e?e.business_phone_label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_phone_label","hash":{}}):n))+'</div>\r\n              <div class="esoc-mini-profile-user-phone"\r\n                   title="'+this.escapeExpression((n=null!=(n=t.business_phone||(null!=e?e.business_phone:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_phone","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.business_phone||(null!=e?e.business_phone:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_phone","hash":{}}):n))+"</div>\r\n            </div>\r\n"},"10":function(e,t,i,s){var n;return'            <div class="esoc-mini-profile-user-mobile-data">\r\n              <div class="esoc-mini-profile-user-mobile-label">'+this.escapeExpression((n=null!=(n=t.cell_phone_label||(null!=e?e.cell_phone_label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cell_phone_label","hash":{}}):n))+'</div>\r\n              <div class="esoc-mini-profile-user-mobile" title="'+this.escapeExpression((n=null!=(n=t.cell_phone||(null!=e?e.cell_phone:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cell_phone","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.cell_phone||(null!=e?e.cell_phone:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cell_phone","hash":{}}):n))+"</div>\r\n            </div>\r\n"},"12":function(e,t,i,s){var n,o;return'      <div class="esoc-mini-profile-user binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <div class="esoc-mini-profile-img">\r\n        <span class="esoc-mini-profile-avatar">\r\n           <a href="javascript:void(0);" class="esoc-mini-profile-pic">\r\n             <span class="image_user_placeholder esoc-miniprofile-default-avatar\r\n                esoc-user-default-avatar-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n             <img id="esoc-mini-profile-pic-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="esoc-userprofile-img-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'\r\n                binf-img-circle" title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'" alt="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'">\r\n           </a>\r\n        </span>\r\n          </div>\r\n          <div id="esoc-mini-profile-presence-indicator"\r\n               class="esoc-mini-profile-presence-indicator binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n      binf-col-xs-12"></div>\r\n          <div class="esoc-mini-profile-userinfo binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n              <div class="esoc-mini-profile-user-displayname">\r\n                  <a href="javascript:void(0);" class="esoc-mini-profile-user-name binf-line-clamp"\r\n                     title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+"</a>\r\n              </div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.business_email:e,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.title:e,{"name":"if","hash":{},"fn":this.program(15,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.office_location:e,{"name":"if","hash":{},"fn":this.program(17,s,0),"inverse":this.noop}))?n:"")+'          </div>\r\n\r\n          <div class="esoc-mini-profile-actions binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=t.if.call(e,null!=e?e.deleted:e,{"name":"if","hash":{},"fn":this.program(19,s,0),"inverse":this.program(21,s,0)}))?n:"")+'          </div>\r\n          <div class="esoc-mini-profile-loading-img binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n              <span class="esoc-mini-profile-progress-icon" />\r\n          </div>\r\n          <div class="esoc-mini-profile-following-error binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n      </div>\r\n      <div id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="esoc-social-users-load-more"></div>\r\n'},"13":function(e,t,i,s){var n;return'                  <div class="esoc-mini-profile-user-displayemail">\r\n                      <a class="esoc-mini-profile-user-email" href="mailto:'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+'"\r\n                         title="'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+"</a>\r\n                  </div>\r\n"},"15":function(e,t,i,s){var n;return'                  <div class="esoc-mini-profile-user-title" title="'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</div>\r\n"},"17":function(e,t,i,s){var n;return'                  <div class="esoc-mini-profile-user-location"\r\n                       title="'+this.escapeExpression((n=null!=(n=t.office_location||(null!=e?e.office_location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"office_location","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.office_location||(null!=e?e.office_location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"office_location","hash":{}}):n))+"</div>\r\n"},"19":function(e,t,i,s){var n;return'                  <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n                      <div class="esoc-mini-profile-selfuser-actions">\r\n                          <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n                      </div>\r\n                  </a>\r\n'},"21":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.program(22,s,0),"inverse":this.program(29,s,0)}))?n:""},"22":function(e,t,i,s){var n,o;return'                      <div class="esoc-chat-action-enabled esoc-chat-action-enabled-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' binf-hidden">\r\n'+(null!=(n=t.unless.call(e,null!=e?e.hideFollow:e,{"name":"unless","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:"")+'                          <div class="esoc-mini-profile-otheruser-actions-spacing "></div>\r\n                          <a href="javascript:void(0);" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.chat:n,e))+'">\r\n                              <div class="esoc-miniprofile-chat-action-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'\r\n                     esoc-miniprofile-otheruser-actions-withchat esoc-miniprofile-chat-action"></div>\r\n                          </a>\r\n\r\n                          <div class="esoc-mini-profile-otheruser-actions-spacing "></div>\r\n                          <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n                              <div class="esoc-miniprofile-otheruser-actions-withchat">\r\n                                  <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n                              </div>\r\n                          </a>\r\n                      </div>\r\n\r\n                      <div class="esoc-chat-action-disabled esoc-chat-action-disabled-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' binf-hidden">\r\n'+(null!=(n=t.if.call(e,null!=e?e.hideFollow:e,{"name":"if","hash":{},"fn":this.program(25,s,0),"inverse":this.program(27,s,0)}))?n:"")+"                      </div>\r\n"},"23":function(e,t,i,s){var n;return'                              <a href="javascript:void(0);" class="esoc-mini-profile-following-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'">\r\n                                  <div class="esoc-miniprofile-otheruser-actions-withchat">\r\n                                      <div class="esoc-miniprofile-followingaction '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.followingClass:n,e))+'"\r\n                                           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'"></div>\r\n                                  </div>\r\n                              </a>\r\n'},"25":function(e,t,i,s){var n;return'                              <a href="javascript:void(0);" class="esoc-viewminiprofile-action">\r\n                                  <div class="esoc-mini-profile-selfuser-actions">\r\n                                      <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n                                  </div>\r\n                              </a>\r\n'},"27":function(e,t,i,s){var n;return'                              <a href="javascript:void(0);" class="esoc-mini-profile-following-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.followingClass:n,e))+'">\r\n                                  <div class="esoc-mini-profile-otheruser-actions-without-chat">\r\n                                      <div class="esoc-miniprofile-followingaction '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.followingClass:n,e))+'"\r\n                                           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'"></div>\r\n                                  </div>\r\n                              </a>\r\n                              <div class="esoc-mini-profile-otheruser-actions-spacing "></div>\r\n                              <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n                                  <div class="esoc-mini-profile-otheruser-actions-without-chat">\r\n                                      <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n                                  </div>\r\n                              </a>\r\n'},"29":function(e,t,i,s){var n;return'                      <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n                          <div class="esoc-mini-profile-selfuser-actions">\r\n                              <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n                          </div>\r\n                      </a>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="'+this.escapeExpression((o=null!=(o=t.className||(null!=e?e.className:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"className","hash":{}}):o))+' esoc-mini-profile-widget binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=t.if.call(e,null!=e?e.enableSimpleSettingsModel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(12,s,0)}))?n:"")+"</div>\r\n"}});return i.registerPartial("esoc_widgets_userwidget_impl_miniprofile",s),s}),csui.define("esoc/widgets/utils/chat/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/widgets/utils/chat/impl/nls/root/lang",{"labeltext":"Chat"}),csui.define("esoc/widgets/utils/chat/impl/util",["module","csui/lib/jquery","csui/lib/underscore","i18n!esoc/widgets/utils/chat/impl/nls/lang","esoc/widgets/common/util"],function(e,t,i,s,n){return{"lang":s,"commonUtil":n,"launchChatWindow":function(e){var t=e.uriPrefix?e.uriPrefix:n.globalConstants.URI_PREFIX,i=t+n.globalConstants.URI_DELIMITER+e.tguser+n.globalConstants.AT_SIGN_SYMBOL+e.domain;window.location=i}}}),csui.define("hbs!esoc/widgets/utils/chat/impl/chatbutton",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n
;return"<a class='esoc-social-chat-icon' title='"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.labeltext:n,e))+"'></a>"}});return i.registerPartial("esoc_widgets_utils_chat_impl_chatbutton",s),s}),csui.define("css!esoc/widgets/utils/chat/impl/chat",[],function(){}),csui.define("esoc/widgets/utils/chat/chat.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","i18n!esoc/widgets/utils/chat/impl/nls/lang","esoc/widgets/utils/chat/impl/util","hbs!esoc/widgets/utils/chat/impl/chatbutton","css!esoc/widgets/utils/chat/impl/chat.css"],function(e,t,i,s,n,o,a){return s.ItemView.extend({"className":"esoc-social-chat-control","template":function(e){return e.messages.customtemplate?e.messages.customtemplate:a(e)},"templateHelpers":function(){return{"messages":{"tguser":this.options.tguser,"labeltext":n.labeltext,"customtemplate":this.options.customtemplate}}},"events":{"click":"launchChatWindow"},"launchChatWindow":function(e){o.launchChatWindow(this.options)},"constructor":function(e){e=e||{},this.options=e,s.ItemView.prototype.constructor.call(this,e)}})}),csui.define("css!esoc/widgets/userwidget/chat/chat",[],function(){}),csui.define("esoc/widgets/userwidget/chat/chatutil",["module","require","csui/lib/jquery","csui/lib/underscore","i18n!esoc/widgets/userwidget/nls/lang","css!esoc/widgets/userwidget/chat/chat.css"],function(e,t,i,s,n){return{"updatePresenceModel":function(e,t){e.model.attributes.status="Unknown";var i=this.getPresenceStatus(t);e.model.attributes.status=i.statusCode,e.model.attributes.tooltipText=i.status,e.model.trigger("change.presencestatus")},"setIconColor":function(e,t){t.removeClass("esoc-chat-presence-Away"),t.removeClass("esoc-chat-presence-Online"),t.removeClass("esoc-chat-presence-Busy"),t.removeClass("esoc-chat-presence-IdleBusy"),t.removeClass("esoc-chat-presence-Offline"),t.removeClass("esoc-chat-presence-donotdisturb"),t.removeClass("esoc-user-profile-default-presence");var i=this.getPresenceStatus(e);t.addClass(i.statusIconClass).attr("title",i.status)},"getPresenceStatus":function(e){var t={"status":"","statusIconClass":"","statusCode":""};switch(s.isNumber(e.status)?e.status:e.activity?e.activity:e.status){case 0:case"Online":t.status=n.presenceOnlineTooltipText,t.statusIconClass="esoc-chat-presence-Online",t.statusCode="Online";break;case 1:case"Offline":t.status=n.presenceOfflineTooltipText,t.statusIconClass="esoc-chat-presence-Offline",t.statusCode="Offline";break;case 2:case"Off work":case"Away":t.status=n.presenceAwayTooltipText,t.statusIconClass="esoc-chat-presence-Away",t.statusCode="Away";break;case 3:case"Busy":t.status=n.presenceBusyTooltipText,t.statusIconClass="esoc-chat-presence-Busy",t.statusCode="Busy";break;case 4:case"BeRightBack":t.status=n.presenceBeRightBackTooltipText,t.statusIconClass="esoc-chat-presence-Away",t.statusCode="Away";break;case 5:case"on-the-phone":t.status=n.presenceInaCallTooltipText,t.statusIconClass="esoc-chat-presence-Busy",t.statusCode="Busy";break;case 7:case"in-a-meeting":t.status=n.presenceInaMeetingTooltipText,t.statusIconClass="esoc-chat-presence-Busy",t.statusCode="Busy";break;case 8:case"out-of-office":t.status=n.presenceOutOfOfficeTooltipText,t.statusIconClass="esoc-chat-presence-Away",t.statusCode="Away";break;case 9:case"DoNotDisturb":t.status=n.presenceDoNotDisturbTooltipText,t.statusIconClass="esoc-chat-presence-donotdisturb",t.statusCode="DoNotDisturb";break;case 10:case"in-a-conference":t.status=n.presenceInaConferenceCallTooltipText,t.statusIconClass="esoc-chat-presence-Busy",t.statusCode="Busy";break;case 18:case"Presenting":t.status=n.presencePresentingTooltipText,t.statusIconClass="esoc-chat-presence-donotdisturb",t.statusCode="DoNotDisturb";break;case 16:case"IdleOnline":t.status=n.presenceIdleOnlineTooltipText,t.statusIconClass="esoc-chat-presence-Away",t.statusCode="Away";break;case"IdleBusy":t.status=n.presenceIdleBusyTooltipText,t.statusIconClass="esoc-chat-presence-Busy",t.statusCode="Busy";break;default:t.status=n.presenceUnknownTooltipText,t.statusIconClass="esoc-user-profile-default-presence",t.statusCode="Unknown"}return t},"getNameCtrl":function(){var e=null,t={};try{try{this.isCompatibleMSIEVersion()&&(e=new t("Name.NameCtrl"))}catch(t){e=null}if(null==e){var i="application/x-sharepoint-uc";e=Boolean(navigator.mimeTypes)&&navigator.mimeTypes[i]&&navigator.mimeTypes[i].enabledPlugin}}catch(t){e=null}return e},"getMessageId":function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},"addHandler":function(e){window.attachEvent?window.attachEvent("onmessage",e):window.addEventListener("message",e)},"removeHandler":function(e){window.detachEvent?window.detachEvent("onmessage",e):window.removeEventListener("message",e)}}}),csui.define("esoc/widgets/userwidget/chat/skype/lib/GeneralHelper",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone"],function(e,t,i,s,n,o){return new o.Model({"namespace":function(e){for(var t=e.split("."),i=window,s="",n=0,o=t.length;n<o;n++)s=t[n],i[s]||(i[s]=i[s]||{}),i=i[s];return i},"generateUUID":function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},"isEmpty":function(e){return!e||!!i.isArray(e)&&0===e.length},"extractDataFromDataUri":function(e,t){var i=/^data:([^,;]+)(?:;charset=([^,;]+))?(;base64)?,(.*)$/i,s=i.exec(e);if(s[3]&&window.atob){var n=window.escape(window.atob(s[4]));return t&&t.unescape?decodeURI(n):n}var o=s[4].replace(/\+/g,"%20");return t&&t.unescape?window.unescape(o):o},"extractOriginFromAbsoluteUrl":function(e){if(e&&"string"==typeof e){var t=e.indexOf("://");if(-1!==t){t+=3;var i=e.indexOf("/",t);return e.slice(0,i)}return""}return""},"determineDomain":function(e){var t="",i=e.match(/^(?:(?:f|ht)tps?:\/\/)?([^\/:]+)/);return 0!==i.length&&(i=i[0],t=i.slice(i.indexOf(".")+1)),t},"convertJoinUrlToUri":function(e){var t=this.determineDomain(e),i=e.split(t),s="";return i.length>=2&&(i=i[1],i=i.split("/"),s="sip:"+i[1]+"@"+t+";gruu;opaque=app:conf:focus:id:"+i[2]),s},"logError":function(e){e&&e instanceof Error&&e.message&&window.console.log(e.message)},"genericRejectAction":function(e,t){window.console.log(t);var s=null;if(e){this.logError(e);try{i.isFunction(e.callback)&&e.callback(null)}catch(t){window.console.log("GeneralHelper: Encountered error executing callback"),this.logError(e)}e.deferred&&(s=e.deferred)}return s||(s=i.Deferred()),s.reject(null),s.promise()},"safeCallbackExec":function(e){if(e)if(i.isFunction(e.callback))try{i.isArray(e.params)||!e.params?e.callback.apply(this,e.params):window.console.log("object.params not in correct format: should be [] or null: unable to safe execute callback")}catch(t){e.error?window.console.log(e.error):window.console.log("Encountered error safe executing callback"),this.logError(t)}else e.callback&&window.console.log("object.callback is not a Function: unable to safe execute callback");else window.console.log("object not defined: unable to safe execute callback")},"getValue":function(e,t){return t||e},"parseHeaders":function(e){for(var t={},s=e.split("\r\n"),n=0;n<s.length;n++)if(""!==s[n]){var o=s[n].indexOf(":");if(-1!==o){var a=i.trim(s[n].slice(0,o)),l=i.trim(s[n].slice(o+1)),r=l.match(/\=".*?"/g);if(r&&0!==r.length){o=l.indexOf(r[0]);var c=l.slice(0,o),d=c.match(/\W/g),u=d?d[0]:null,m=u?i.trim(c.split(u)[0]):i.trim(c),p=l.slice(m.length+1),h=0;for(t[a]||(t[a]={});h<r.length;)for(t[a][m]||(t[a][m]={}),h;h<r.length;h++){var f=0;0!==p.indexOf(",")&&0!==p.indexOf(u)||(f+=1),1!==p.indexOf(",")&&1!==p.indexOf(u)||(f+=1),p=p.slice(f),o=p.indexOf(r[h]);var g=i.trim(p.slice(0,o));if(-1!==(o=g.lastIndexOf(u))){m=i.trim(g.slice(0,o)),p=p.slice(m.length+1);break}p=p.slice(g.length+r[h].length);var v=r[h].slice(1).replace(/"/g,"").split(",");if(1===v.length)t[a][m][g]=v[0];else{t[a][m][g]=[];for(var b=0;b<v.length;b++)t[a][m][g].push(v[b])}}}else t[a]=l.replace(/"/g,"")}else window.console.log("Not a header?")}return t}})}),csui.define("esoc/widgets/userwidget/chat/skype/lib/MemoryStorage",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper"],function(e,t,i,s,n,o){var a=o.attributes;return new n.Model({"_data":{},"init":function(e){var t=i.Deferred();return this._data={},t.resolve(),t.promise()},"create":function(e,t,s){var n=i.Deferred();return this._data[t]=e,n.resolve(t),a.safeCallbackExec({"callback":s,"params":[t]}),n.promise()},"read":function(e,t){var s=i.Deferred();return s.resolve(this._data[e]),a.safeCallbackExec({"callback":t,"params":[this._data[e]]}),s.promise()},"update":function(e,t,s){var n=i.Deferred();this._data[t]=e,n.resolve(t),a.safeCallbackExec({"callback":s,"params":[t]}),n.promise()},"deleteVal":function(e,t){var s=i.Deferred();return delete this._data[e],s.resolve(e),a.safeCallbackExec({"callback":t,"params":[e]}),s.promise()}})}),csui.define("esoc/widgets/userwidget/chat/skype/lib/Cache",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper","esoc/widgets/userwidget/chat/skype/lib/MemoryStorage"],function(e,t,i,s,n,o,a){var l=o.attributes,r=[],c=a.attributes;return new n.Model({"init":function(e){if(!c)return l.genericRejectAction(null,"storage object is not defined: unable to init");try{return c.init(e)}catch(e){return l.genericRejectAction(e,"Encountered error during init")}},"create":function(e){if(!(c&&e&&e.data))return l.genericRejectAction(e,"storage object or object.data not defined: unable to create");try{return c.create(e.data,e.id,e.callback).done(function(){r.push(e.id)})}catch(t){return l.logError(t),l.genericRejectAction(e,"Encountered error during create")}},"read":function(e){if(!c||!e.id)return l.genericRejectAction(e,"storage object or object.id not defined: unable to read");try{return-1!==r.indexOf(e.id)?c.read(e.id,e.callback):l.genericRejectAction(e,"_ids does not contain an entry for "+e.id+": unable to read")}catch(t){return l.logError(t),l.genericRejectAction(e,"Encountered error during read")}},"update":function(e){if(!(c&&e.id&&e.data))return l.genericRejectAction(e,"storage object, object.id, or object.data not defined: unable to update");try{return-1!==r.indexOf(e.id)?c.update(e.data,e.id,e.callback):l.genericRejectAction(e,"_ids does not contain an entry for "+e.id+": unable to update")}catch(t){return l.logError(t),l.genericRejectAction(e,"Encountered error during update")}},"deleteVal":function(e){if(!c||!e.id)return l.genericRejectAction(e,"storage object or object.id not defined: unable to delete");try{var t=r.indexOf(e.id);return-1!==t?c.deleteVal(e.id,e.callback).done(function(){r.splice(t,1)}):l.genericRejectAction(e,"_ids does not contain an entry for "+e.id+": unable to delete")}catch(t){return l.logError(t),l.genericRejectAction(e,"Encountered error during delete")}}})}),csui.define("esoc/widgets/userwidget/chat/skype/lib/Transport",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper"],function(e,t,i,s,n,o){var a=o.attributes;return n.Model.extend({"_domain":null,"_xframe":null,"_defaultType":"application/json","_container":null,"_element":null,"_accessToken":null,"_tokenType":null,"_requestStart":null,"_requestStop":null,"_requestCounter":0,"_methods":[],"_failedAllowedList":!1,"_scope":this,"constructor":function(e){this.targetOrigin=e,n.Model.prototype.constructor.apply(this,arguments)},"createClientTransportData":function(e){var t=e.accessToken||this._accessToken,i={"type":e.type,"url":e.url,"headers":{"Accept":e.acceptType,"Authorization":this._tokenType+" "+t}};switch(e.messageId&&(i.messageId=e.messageId),t||delete i.headers.Authorization,e.type){case"get":break;case"post":case"put":e.data&&e.data.etag&&(i.headers["If-Match"]='"'+e.data.etag+'"'),e.data?(-1!==e.contentType.indexOf("json")&&(e.data=JSON.stringify(e.data)),i.headers["Content-Type"]=e.contentType):(e.data="",i.headers["Content-Type"]=""),i.data=e.data;break;case"delete":i.headers={"Authorization":this._tokenType+" "+t}}return JSON.stringify(i)},"handleUrl":function(e){return-1!==(e?e.indexOf("://"):"")?e:e?this._domain+e:this._domain},"findReasonString":function(e){var t=a.parseHeaders(e);for(var i in t["X-Ms-diagnostics"])return t["X-Ms-diagnostics"][i].reason;return null},"handleAllowedList":function(e){if(403===e.status&&!this._failedAllowedList){var t=this.findReasonString(e.headers);null!==t&&(window.console.log(t),console.log(t),this._failedAllowedList=!0)}},"handleCallback":function(e,t,i){var s=this,n=function(i){var o=JSON.parse(i.data);if(s.handleAllowedList(o),o.messageId===t){s._requestStop&&--s._requestCounter<=0&&s._requestStop();try{var l=a.parseHeaders(o.headers);if(l["Content-Type"]&&l["Content-Type"].length&&-1!==l["Content-Type"].indexOf(this._defaultType))try{o.results=JSON.parse(o.responseText);if(s.testForDomainChanges(o.results,function(){a.safeCallbackExec({"callback":e,"params":[o],"error":"Encountered error executing transport callback"}),s.removeHandler(n)}))return}catch(e){window.console.error("Encountered error parsing response: "+e.message)}}catch(e){window.console.error("Encountered error handling response: "+e.message)}a.safeCallbackExec({"callback":e,"params":[o],"error":"Encountered error executing transport callback"}),s.removeHandler(n)}};return s.addHandler(n),n},"addHandler":function(e){window.attachEvent?window.attachEvent("onmessage",e):window.addEventListener("message",e),this._methods.push(e)},"removeHandler":function(e){window.detachEvent?window.detachEvent("onmessage",e):window.removeEventListener("message",e);var t=this._methods.indexOf(e);-1!==t&&this._methods.splice(t,1)},"testForDomainChanges":function(e,t){return!(!e._links||!e._links.xframe||this._xframe===e._links.xframe.href)&&(this._xframe=e._links.xframe.href,this._scope.injectFrame(this._xframe,this._container,t),!0)},"getDomain":function(){return this._domain},"setElement":function(e,t){e&&(this._element=e,this._domain=a.extractOriginFromAbsoluteUrl(t))},"setAuthorization":function(e,t){this._accessToken=e,this._tokenType=t},"getAuthorization":function(){return{"accessToken":this._accessToken,"tokenType":this._tokenType}},"setRequestCallbacks":function(e){e&&(e.start&&(this._requestStart=e.start),e.stop&&(this._requestStop=e.stop))},"clientRequest":function(e){if(this._element&&this._domain){var t=a.generateUUID(),i=this.handleCallback(e.callback,t,e.url);this._requestStart&&!1!==e.notifyAction&&(this._requestStart(),this._requestCounter++);try{this._element.postMessage(this.createClientTransportData({"url":this.handleUrl(e.url),"type":e.type.toLocaleLowerCase(),"data":e.data,"acceptType":a.getValue(this._defaultType,e.acceptType),"contentType":a.getValue(this._defaultType,e.contentType),"messageId":t,"accessToken":e.accessToken}),a.getValue("*",this.targetOrigin))}catch(e){window.console.log("Encountered error with clientRequest: "+e.message);var s={"messageId":t,"headers":"","status":400};i({"data":JSON.stringify(s)})}}},"injectFrame":function(e,t,s){this._container=t;var n=function(){window.clearTimeout(l);var t=window.setTimeout(function(){window.console.log("Frame location not found within timeout (10000): "+e),a.safeCallbackExec({"callback":s,"params":[{"status":408,"link":e}],"error":"Encountered error executing frame injection callback"})},1e4);this._scope.setElement(o[0].contentWindow,e),this._scope.clientRequest({"url":e,"type":"get","acceptType":"text/html","notifyAction":!1,"callback":function(e){window.clearTimeout(t),a.safeCallbackExec({"callback":s,"params":[e],"error":"Encountered error executing frame injection callback"})}})},o=i("<iframe></iframe>").load(n).attr("src",e),l=window.setTimeout(n,1e4);this._container.html(o)},"cleanup":function(){for(var e=0;e<this._methods.length;e++)this.removeHandler(this._methods[e])}})}),csui.define("esoc/widgets/userwidget/chat/skype/lib/Mime",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper"],function(e,t,i,s,n,o){o.attributes;return new n.Model({"processHeader":function(e){var t=i.trim(e).split("\n");for(var s in t)if(-1!==t[s].indexOf("boundary")){var n=t[s].split(";");for(var o in n)if(-1!==n[o].indexOf("boundary")){var a=i.trim(n[o].split("=")[1]);return'"'===a[0]&&'"'===a[a.length-1]?a.slice(1,-1):a}}},"processBody":function(e,t){var s=t.split("--"+e),n=[];for(var o in s)if(""!==i.trim(s[o])&&"--"!==i.trim(s[o])){var a=i.trim(s[o]).split("\r\n"),l={"status":null,"statusText":null,"responseText":"","header":"","messageId":null},r=null;for(var c in a)null===r&&-1!==a[c].indexOf("Content-Type")?null!==(r=this.determineContentType(a[c]))&&""===l.header&&(l.header=this.readHeader(a,c)):-1!==a[c].indexOf("HTTP/1.1")?(l.status=a[c].split(" ")[1],l.header=this.readHeader(a,++c)):null!==r&&""!==i.trim(a[c])&&(l.responseText=a[c],"json"===r&&(l.results=JSON.parse(i.trim(a[c]))));n.push(l)}return n},"determineContentType":function(e){var t=null;if(-1===e.indexOf("http; msgtype=response")){t=-1!==e.indexOf("json")?"json":i.trim(e).split("/")[1]}return t},"readHeader":function(e,t){for(var s="";""!==i.trim(e[t])&&t<e.length;)s=s.concat(e[t],"\n"),t++;return s},"processMessage":function(e){var t=this.processHeader(e.headers);return this.processBody(t,e.responseText)}})}),csui.define("esoc/widgets/userwidget/chat/skype/lib/Batch",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper","esoc/widgets/userwidget/chat/skype/lib/Mime"],function(e,t,i,s,n,o,a){var l=o.attributes,r=a.attributes;return n.Model.extend({"_defaultType":"application/json","_batchQueue":[],"_batchSize":20,"_timerId":null,"_defaultTimerLimit":3e3,"constructor":function(e,t,i){this.cache=e,this.transport=t,this.timerLimit=i,n.Model.prototype.constructor.apply(this,arguments)},"buildMessage":function(e){var t=null,i=null,s=e.url.indexOf("://");return-1!==s?(s+=3,t=e.url.slice(s).split("/",1)[0],i=e.type.toUpperCase()+" "+e.url.slice(s+t.length)+" HTTP/1.1"):(s=this.transport.getDomain().indexOf("://"),t=-1!==s?this.transport.getDomain().slice(s+3):this.transport.getDomain(),i=e.type.toUpperCase()+" "+e.url+" HTTP/1.1"),{"Request":i,"Host":t,"Accept":e.acceptType,"Data":e.data}},"sendBatch":function(e){var t=l.generateUUID(),i="multipart/batching;boundary="+t,s=[],n=[];for(var o in this._batchQueue)s.push(this.createDataPart(this._batchQueue[o].message,t)),n.push(this._batchQueue[o].callback);var a=function(e){for(var t=r.processMessage(e),i=0;i<t.length;i++)l.safeCallbackExec({"callback":n[i],"params":[t[i]],"error":"Encountered error executing batch callback"})},c=s.join("\r\n"),d=this;c+="\r\n\r\n--"+t+"--\r\n",this.cache.read({"id":"main"}).done(function(t){d.transport.clientRequest({"url":e,"type":"post","data":c,"acceptType":"multipart/batching","contentType":i,"callback":a})})},"createDataPart":function(e,t){var i="\r\n--"+t;return i+="\r\nContent-Type: application/http; msgtype=request\r\n",i+="\r\n"+e.Request,i+="\r\nHost: "+e.Host,i+="\r\nAccept: "+e.Accept,e.Data&&(i+="\r\nData: "+JSON.stringify(e.Data)),i+="\r\n"},"queueRequest":function(e){var t=this.buildMessage({"url":e.url,"type":e.type,"acceptType":l.getValue(this._defaultType,e.acceptType),"data":e.data});if(t)if(this._batchQueue.push({"message":t,"callback":e.callback}),this._batchQueue.length>=this._batchSize)this.processBatch();else if(!this._timerId){var i=this;this._timerId=window.setTimeout(function(){i.processBatch()},l.getValue(this._defaultTimerLimit,this.timerLimit))}},"processBatch":function(e){0!==this._batchQueue.length&&(this._timerId&&(window.clearTimeout(this._timerId),this._timerId=null),this.sendBatch(e),this._batchQueue.length=0)}})}),csui.define("esoc/widgets/userwidget/chat/skype/lib/Events",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone"],function(e,t,i,s,n){return n.Model.extend({"_handlingEvents":!1,"_handlers":{},"constructor":function(e,t,i){this.cache=e,this.transport=t,this.options=i,n.Model.prototype.constructor.apply(this,arguments)},"normalizeEventType":function(e){var t=e;return"added"===t&&(t="started"),"deleted"===t&&(t="completed"),t},"checkHrefOrOperationListeners":function(e,t){var i=this.normalizeEventType(e.type),s=null,n=[];e._embedded&&(s=e._embedded[e.link.rel].operationId||null),n.push(this._handlers[s]),n.push(this._handlers[e.link.rel]),n.push(this._handlers[e.link.href]),n.push(this._handlers["*"]);for(var o=0;o<n.length;o++)if(n[o]&&n[o][i]){var a=n[o][i];try{a(e,t)}catch(e){window.console.log("Encountered error executing event handler callback: "+e.message)}}},"processEvents":function(e){var t=[],i=[],s=0;if(e&&e.sender&&e.sender.length>0&&e.sender[0]){for(var n in e.sender){var o=e.sender[n].events;for(var a in o)o[a].link.rel&&"contactPresence"===o[a].link.rel&&(t[s]=o[a].link.href,i[s]=o[a].type,s+=1)}i.length>0&&this._handlers&&this._handlers.contactPresence&&this._handlers.contactPresence.updated(t)}},"getEventsHref":function(e){return this.options&&(this.options.low&&(this.options.low<5?this.options.low=5:this.options.low>1800&&(this.options.low=1800),e+="&low="+this.options.low),this.options.medium&&(this.options.medium<5?this.options.medium=5:this.options.medium>1800&&(this.options.medium=1800),e+="&medium="+this.options.medium),this.options.priority&&(this.options.priority<0&&(this.options.priority=0),e+="&priority="+this.options.priority),this.options.timeout&&(this.options.timeout<180?this.options.timeout=180:this.options.timeout>1800&&(this.options.timeout=1800),e+="&timeout="+this.options.timeout)),e},"startEvents":function(e){var t=this;return t._handlingEvents||(t._handlingEvents=!0),t._handlingEvents},"stopEvents":function(){this._handlingEvents=!1,this._handlers.length=0},"addEventHandlers":function(e,t){var i;e&&(i=e.href?e.href:e.rel?e.rel:e.operationId),this._handlers[i]=t},"removeEventHandlers":function(e){this._handlers[e]?delete this._handlers[e]:window.console.log("Event handler not found, unable to remove: "+e)},"updateEventOptions":function(e){this.options||(this.options={}),e&&(e.low&&(this.options.low=e.low),e.medium&&(this.options.medium=e.medium),e.priority&&(this.options.priority=e.priority),e.timeout&&(this.options.timeout=e.timeout))}})}),csui.define("esoc/widgets/userwidget/chat/skype/skype.model",["module","require","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,s){return s.Model.extend({"constructor":function(e){s.Model.prototype.constructor.apply(this,arguments)},"initialize":function(){}})}),csui.define("esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model",["module","require","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,s){return{"accessToken":null,"applicationsURL":null,"batchURL":null,"autoDiscoverURL":null,"iFrameURL":null,"serverURL":null,"pluginEnabled":!1,"internalServerURL":null,"externalServerURL":null,"nameCtrl":null,"chatEnabled":!1,"presenceEnabled":!1,"chatDomain":null,"eventHandling":!1,"loginUserSIP":null,"setLoginUserSIP":function(e){this.loginUserSIP=e},"getLoginUserSIP":function(){return this.loginUserSIP},"setPluginEnabled":function(e){this.pluginEnabled=e},"isPluginEnabled":function(){return this.pluginEnabled},"setChatDomain":function(e){this.chatDomain=e},"getChatDomain":function(){return this.chatDomain},"setChatEnabled":function(e){this.chatEnabled=e},"getChatEnabled":function(){return this.chatEnabled},"setPresenceEnabled":function(e){this.presenceEnabled=e},"getPresenceEnabled":function(){return this.presenceEnabled},"setInternalServerURL":function(e){this.internalServerURL=e},"getInternalServerURL":function(){return this.internalServerURL},"setExternalServerURL":function(e){this.externalServerURL=e},"getExternalServerURL":function(){return this.externalServerURL},"setAccessToken":function(e){this.accessToken=e},"getAccessToken":function(){return this.accessToken},"setApplicationsURL":function(e){this.applicationsURL=e},"getApplicationsURL":function(){return this.applicationsURL},"setBatchURL":function(e){this.batchURL=e},"getBatchURL":function(){return this.batchURL},"setEventURL":function(e){this.eventURL=e},"getEventURL":function(){return this.eventURL},"setpresenceSubscriptionURL":function(e){this.presenceSubscriptionURL=e},"getpresenceSubscriptionURL":function(){return this.presenceSubscriptionURL},"setCurrentSubscriptionURL":function(e){this.currentSubscriptionURL=e},"getCurrentSubscriptionURL":function(){return this.currentSubscriptionURL},"setAutoDiscoverURL":function(e){this.autoDiscoverURL=e},"getAutoDiscoverURL":function(e){return this.autoDiscoverURL},"setIFrameURL":function(e){this.iFrameURL=e},"getIFrameURL":function(){return this.iFrameURL},"setServerURL":function(e){this.internalServerURL.indexOf("https://")>-1?this.serverURL="https://"+e:this.serverURL="http://"+e},"getServerURL":function(){return this.serverURL},"setNameCtrl":function(e){this.nameCtrl=e},"getNameCtrl":function(){return this.nameCtrl}}}),csui.define("esoc/widgets/userwidget/chat/skype/skypeucwa.application",["module","require","csui/lib/jquery","csui/lib/underscore","esoc/widgets/common/util","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/lib/Cache","esoc/widgets/userwidget/chat/skype/lib/Transport","esoc/widgets/userwidget/chat/skype/lib/Batch","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model","esoc/widgets/userwidget/chat/chatutil","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper"],function(e,t,i,s,n,o,a,l,r,c,d,u){var m=u.attributes,p=c.getAutoDiscoverURL();return{"getXframe":function(e,t){e.html("");var s=i("<iframe></iframe>").attr("src",t).attr("id","xFrame");e.html(s),i("body").append(e)},"getRESTServiceURL":function(e){var t=d.getMessageId(),i=document.getElementById("xFrame"),s=this;s.handleRESTServiceURL(e),s.sendRequest(t,i,c.internalServerURL)},"handleRESTServiceURL":function(e){var t,s=this,n=function(o){if(null===c.getAutoDiscoverURL()){var a;try{a=JSON.parse(o.data)}catch(e){}if(a)if(200!==a.status&&e.deferredObj)e.deferredObj.resolve();else{try{t=JSON.parse(a.responseText)._links.xframe.href}catch(e){}c.setIFrameURL(t),s.getXframe(i(".esoc-user-chat-xFrame"),t);var l=t.split("/Autodiscover")[0];s.authenticate(l,e),c.setAutoDiscoverURL(l)}}d.removeHandler(n)};d.addHandler(n);var o=function(){if(window.clearTimeout(a),void 0===t&&c.externalServerURL.length>0){var n=c.externalServerURL;s.getXframe(i(".esoc-user-chat-xFrame"),n+"/xframe");var o=d.getMessageId(),l=document.getElementById("xFrame");s.handleExternalRESTServiceURL(e),s.sendRequest(o,l,n)}},a=window.setTimeout(o,5e3)},"handleExternalRESTServiceURL":function(e){var t,s=this,n=function(o){if(null===c.getAutoDiscoverURL()){var a;try{a=JSON.parse(o.data)}catch(e){}if(a)if(200!==a.status&&e.deferredObj)e.deferredObj.resolve();else{try{t=JSON.parse(a.responseText)._links.xframe.href}catch(e){}c.setIFrameURL(t),s.getXframe(i(".esoc-user-chat-xFrame"),t);var l=t.split("Autodiscover")[0];s.authenticate(l,e),c.setAutoDiscoverURL(l)}}d.removeHandler(n)};d.addHandler(n)},"authenticate":function(e,t){var s=this;t&&t.appNotFound?(c.eventHandling=!1,s.sendAuthRequest(e,t)):i("iframe").on("beforeload",function(){s.sendAuthRequest(e,t)})},"handleAuthenticationCallback":function(e){var t=this,i=function(s){var n=JSON.parse(s.data),o=null;200!==n.status&&e.deferredObj?e.deferredObj.resolve():(JSON.parse(n.responseText).access_token&&(o=JSON.parse(n.responseText).access_token,c.setAccessToken(o),t.createApplication(c.getAutoDiscoverURL(),o,e)),d.removeHandler(i))};d.addHandler(i)},"createApplication":function(e,t,i){if(this.handleCreateApplicationCallback(i),t){var s=d.getMessageId(),n={"type":"post","data":'{\r\n  "userAgent":"esocial1",\r\n  "endpointId":"'+s+'",\r\n  "culture":"en-US"\r\n}\r\n',"contentType":"application/json","url":e+"/ucwa/oauth/v1/applications","headers":{"Accept":"application/json","Content-Type":"application/json","Authorization":"Bearer "+t}};document.getElementById("xFrame").contentWindow.postMessage(JSON.stringify(n),m.getValue("*",p))}},"handleCreateApplicationCallback":function(e){var t=function(i){var s,n,o,a,l=JSON.parse(i.data),r=JSON.parse(l.responseText);201!==l.status&&e.deferredObj?e.deferredObj.resolve():(r._links&&(s=r._links.self.href,n=r._links.batch.href,o=r._links.events.href),r._embedded&&(a=r._embedded.people._links.presenceSubscriptions.href),c.setApplicationsURL(s),c.setBatchURL(n),c.setEventURL(o),c.setpresenceSubscriptionURL(a),e.deferredObj&&e.deferredObj.resolve(),d.removeHandler(t))};d.addHandler(t)},"sendRequest":function(e,t,s){i("iframe").on("beforeload",function(){if(t){var i={"type":"get","url":s,"contentType":"application/x-www-form-urlencoded;charset='utf-8'","headers":{"Accept":"application/json","Content-Type":"application/x-www-form-urlencoded;charset='utf-8'"},"messageId":e};t.contentWindow.postMessage(JSON.stringify(i),m.getValue("*",p))}})},"sendAuthRequest":function(e,t){var i=d.getMessageId(),s=document.getElementById("xFrame"),n=this;if(null!==s){n.handleAuthenticationCallback(t);var o={"type":"post","url":e+"/WebTicket/oauthtoken","contentType":"application/x-www-form-urlencoded;charset='utf-8'","headers":{"Accept":"application/json","Content-Type":"application/x-www-form-urlencoded;charset='utf-8'"},"data":{"grant_type":"urn:microsoft.rtc:windows"},"messageId":i};s.contentWindow.postMessage(JSON.stringify(o),m.getValue("*",p))}}}}),csui.define("esoc/widgets/userwidget/chat/skype/skypeucwa.model",["require","csui/lib/jquery","csui/lib/backbone","csui/utils/base","esoc/widgets/userwidget/chat/chatutil","esoc/widgets/userwidget/chat/skype/lib/Cache","esoc/widgets/userwidget/chat/skype/lib/Transport","esoc/widgets/userwidget/chat/skype/lib/Batch","esoc/widgets/userwidget/chat/skype/lib/Events","esoc/widgets/userwidget/chat/skype/skype.model","esoc/widgets/userwidget/chat/skype/skypeucwa.application","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model","esoc/widgets/userwidget/chat/skype/lib/GeneralHelper"],function(e,t,i,s,n,o,a,l,r,c,d,u,m){var p=m.attributes;return new(c.extend({"constructor":function(e){t("body").append('<span style="display:none" class="esoc-user-chat-xFrame"></span>'),i.Model.prototype.constructor.apply(this,arguments)},"initialize":function(){},"initializeApplication":function(e){u.internalServerURL.length>0&&(d.getXframe(t(".esoc-user-chat-xFrame"),u.internalServerURL+"/xframe"),d.getRESTServiceURL(e))},"showUserPresence":function(e){if(e.autoDiscoverURL=u.getAutoDiscoverURL(),e.email instanceof Array){var t,i=u.getServerURL(),s=u.getAutoDiscoverURL(),n=document.getElementById("xFrame"),r=o.attributes,c=new a(s),m=new l(r,c,4e3),h=0;if(r.create({"id":"main","data":{}}),n&&(t=n.contentWindow,c.setElement(t,i)),c.setAuthorization(u.getAccessToken(),"Bearer"),e.email&&e.email.length>0)for(h=0;h<e.email.length;h++)m.queueRequest({"url":u.getAutoDiscoverURL()+e.email[h],"type":"get","callback":function(t){JSON.parse(t.responseText).subcode;if(401===t.status){var i={"appNotFound":!0};d.authenticate(e.autoDiscoverURL,i)}else{var s=JSON.parse(t.responseText)._links.self.href;if(e.models)for(var n=0;n<e.models.length;n++)if(s.indexOf(e.models[n].get("screen_name").toLowerCase())>0){var o={"status":JSON.parse(t.responseText).availability};o.activity=JSON.parse(t.responseText).activity,e.models&&e.models[n].trigger("presence:update",o)}}}});m.processBatch(s+u.getBatchURL())}else{var f=u.getAutoDiscoverURL()+u.getApplicationsURL(),g=document.getElementById("xFrame");if(f=f+"/people/"+e.email+"/presence",this.handlePresenceCallback(e),g){var v={"type":"get","messageId":this.messageId,"url":f,"headers":{"Accept":"application/json","Authorization":"Bearer "+u.getAccessToken()}}
;document.getElementById("xFrame").contentWindow.postMessage(JSON.stringify(v),p.getValue("*",s))}}},"handlePresenceCallback":function(e){var t=function(i){var s;try{s=JSON.parse(i.data)}catch(e){}if(s.responseText){var o;try{o=JSON.parse(s.responseText).subcode}catch(e){}if(404===s.status&&"ApplicationNotFound"===o||401===s.status){var a={"appNotFound":!0};d.authenticate(e.autoDiscoverURL,a)}else{var l;try{l=JSON.parse(s.responseText).availability}catch(e){}var r={};r.status=l;try{r.activity=JSON.parse(s.responseText).activity}catch(e){}n.updatePresenceModel(e,r),n.removeHandler(t)}}};n.addHandler(t)},"updateEventPresence":function(t){var i,s=u.getServerURL(),n=u.getAutoDiscoverURL(),l=document.getElementById("xFrame"),c=u.getCurrentSubscriptionURL(),d=o.attributes,m=new a(n),p=new r(d,m),h=h||e("esoc/widgets/userwidget/chat/skype/skypeucwa.model");c?this.deleteSubscription(c,t):this.sendSubscription(t),d.create({"id":"main","data":{}}),l&&(i=l.contentWindow,m.setElement(i,s)),m.setAuthorization(u.getAccessToken(),"Bearer"),p.addEventHandlers({"rel":"contactPresence"},{"updated":function(e){if(t.email instanceof Array){var i={"email":e,"models":t.models};h.showUserPresence(i)}else h.showUserPresence(t)}})},"sendAckRequest":function(){var e=u.getAutoDiscoverURL(),t=e+u.getEventURL(),i=document.getElementById("xFrame"),s=n.getMessageId();if(null!==i&&!u.eventHandling){u.eventHandling=!0,this.handleEventCallback();var o={"type":"get","url":t,"contentType":"application/x-www-form-urlencoded;charset='utf-8'","headers":{"Accept":"application/json","Content-Type":"application/x-www-form-urlencoded;charset='utf-8'","Authorization":"Bearer "+u.getAccessToken()},"messageId":s};i.contentWindow.postMessage(JSON.stringify(o),p.getValue("*",e))}},"handleEventCallback":function(){var e,t=u.getAutoDiscoverURL(),i=this,s=function(o){var a=JSON.parse(o.data);if(a.responseText)if(e=JSON.parse(a.responseText),401===e.status||"ApplicationNotFound"===e.subcode){var l={"appNotFound":!0};d.authenticate(t,l)}else e.sender&&i.processEvents(a),n.removeHandler(s)};n.addHandler(s)},"processEvents":function(t){var i,s=u.getServerURL(),n=u.getAutoDiscoverURL(),l=document.getElementById("xFrame"),c=o.attributes,d=new a(n),m=new r(c,d),p=p||e("esoc/widgets/userwidget/chat/skype/skypeucwa.model"),h=JSON.parse(t.responseText);u.eventHandling&&(l&&(i=l.contentWindow,d.setElement(i,s)),d.setAuthorization(u.getAccessToken(),"Bearer"),h&&h._links&&(h._links.resync?d.clientRequest({"url":n+h._links.resync.href,"type":"get","acceptType":"application/json","callback":p.processEvents,"notifyAction":!1}):h._links.next&&d.clientRequest({"url":n+h._links.next.href,"type":"get","acceptType":"application/json","callback":p.processEvents,"notifyAction":!1})),m.processEvents(h))},"sendSubscription":function(e){var t,i=u.getServerURL(),s=u.getAutoDiscoverURL(),n=s+u.getpresenceSubscriptionURL(),o=document.getElementById("xFrame"),l=new a(s);o&&(t=o.contentWindow,l.setElement(t,i)),l.setAuthorization(u.getAccessToken(),"Bearer");var r=[];if(e.email instanceof Array)for(var c=0;c<e.email.length;c++)r[c]="sip:"+e.email[c];else r[0]="sip:"+e.email;var m={"duration":30,"uris":r};if(r.length>0){var p=this;l.clientRequest({"url":n,"type":"post","contentType":"application/json","data":m,"callback":function(t){var i=JSON.parse(t.responseText);if(401===i.status||"ApplicationNotFound"===i.subcode){var n={"appNotFound":!0};d.authenticate(s,n)}else u.setCurrentSubscriptionURL(JSON.parse(t.responseText)._links.self.href),p.processEvents(t),e.subscribeEvent&&p.sendAckRequest()}})}},"deleteSubscription":function(e,i){var s,n=u.getServerURL(),l=u.getAutoDiscoverURL(),c=document.getElementById("xFrame"),m=o.attributes,p=new a(l),h=new r(m,p);c&&(s=c.contentWindow,p.setElement(s,n)),p.setAuthorization(u.getAccessToken(),"Bearer");var f=this;p.clientRequest({"url":l+e,"type":"delete","callback":function(e){if(u.setCurrentSubscriptionURL(null),e.responseText){var s=JSON.parse(e.responseText);if(401===s.status||"ApplicationNotFound"===s.subcode){var n=t.Deferred(),o={"appNotFound":!0,"deferredObj":n};d.authenticate(l,o),n.promise().done(function(){i?f.sendSubscription(i):(h.removeEventHandlers("contactPresence"),u.eventHandling=!1)})}}else i?f.sendSubscription(i):(h.removeEventHandlers("contactPresence"),u.eventHandling=!1)}})}}))}),csui.define("esoc/widgets/userwidget/chat/skype/skypeplugin.model",["csui/lib/jquery","csui/lib/backbone","esoc/widgets/userwidget/chat/chatutil","esoc/widgets/userwidget/chat/skype/skype.model","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model"],function(e,t,i,s,n){return new(s.extend({"nameCtrl":null,"constructor":function(e){t.Model.prototype.constructor.apply(this,arguments)},"initialize":function(){},"updateEventPresence":function(e){this.showUserPresence(e)},"showUserPresence":function(t){if(n.getChatEnabled()&&n.getPresenceEnabled()){var s;if(t.email instanceof Array){s={"status":!1};var o=0;for(o=0;o<t.email.length;o++)s.status=this.nameCtrl.GetStatus(t.email[o],String(t.presenceHolder[o])),i.setIconColor(s,e("#"+t.presenceHolder[o]))}else s={"status":this.nameCtrl.GetStatus(t.email,t.presenceHolder)},i.updatePresenceModel(t,s)}},"attachLyncPresenceChangeEvent":function(){this.nameCtrl&&(this.nameCtrl.OnStatusChange=this.onLyncPresenceStatusChange)},"onLyncPresenceStatusChange":function(t,s,n){var o=e("#"+n),a={"status":s};i.setIconColor(a,o)},"setNameCtrl":function(e){this.nameCtrl=e},"getNameCtrl":function(){return this.nameCtrl}}))}),csui.define("esoc/widgets/userwidget/chat/realtime/realtime.model",["csui/lib/jquery","csui/lib/backbone"],function(e,t){return new(t.Model.extend({"constructor":function(e){this.submodel={},t.Model.prototype.constructor.apply(this,arguments)},"initialize":function(){},"getUserPresence":function(e){},"getUsersPresence":function(e){}}))}),csui.define("esoc/model/pulsesettings/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url","esoc/widgets/common/util"],function(e,t,i){"use strict";return{"mixin":function(s){return e.extend(s,{"makeServerAdaptor":function(e){return this},"url":function(e){var s=t.combine(i.getV2Url(this.connector.connection.url),i.REST_URLS.pulseSettingsUrl);return this.options.chat&&(s=i.updateQueryStringValues(s,i.globalConstants.FIELDS,i.globalConstants.CHAT_SEETINGS)),s},"parse":function(e){return this.options.fetched=!1,e.results}})}}}),csui.define("esoc/model/pulsesettings.model",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","esoc/model/pulsesettings/server.adaptor.mixin","csui/models/resource","esoc/widgets/common/util"],function(e,t,i,s,n,o,a,l,r,c,d,u,m){var p=n.Model.extend(s.extend({},u(n.Model),{"constructor":function(e,t){n.Model.prototype.constructor.apply(this,arguments),this.options=t,t&&t.connector&&t.connector.assignTo(this),this.options.fetched=!0,this.makeResource(t).makeIncludingAdditionalResources(t).makeUploadable(t).makeExpandable(t).makeServerAdaptor(t)},"isFetchable":function(){return this.options.fetched}}));return c.mixin(p.prototype),a.mixin(p.prototype),r.mixin(p.prototype),l.mixin(p.prototype),d.mixin(p.prototype),p}),csui.define("esoc/factory/pulsesettingsfactory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","esoc/model/pulsesettings.model"],function(e,t,i,s,n,o){return s.extend({"propertyPrefix":"pulsesettings","constructor":function(a,l){s.prototype.constructor.apply(this,arguments);var r=this.options.pulsesettings||{};if(!(r instanceof i.Model)){var c=a.getObject(n,l),d=e.config();r=new o(r.attributes||d.attributes,t.defaults({"connector":c},r.options,d.options))}this.property=r},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("esoc/widgets/userwidget/chat/chatfactory",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","esoc/widgets/userwidget/chat/skype/skypeucwa.model","esoc/widgets/userwidget/chat/skype/skypeplugin.model","esoc/widgets/userwidget/chat/realtime/realtime.model","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model","esoc/factory/pulsesettingsfactory","csui/utils/contexts/factories/user"],function(e,t,i,s,n,o,a,l,r,c,d){return new(n.Model.extend({"constructor":function(e){n.Model.prototype.constructor.apply(this,arguments)},"initializeApplication":function(e){this.options=e;var t=this,s=i.Deferred(),n={"deferredObj":s};return e.context.getModel(c,{"attributes":{"id":"chat"},"options":{"chat":!0},"permanent":!0}).ensureFetched().done(function(e){var i=e.results&&e.results.chatSettings;if(i&&i.chatEnabled&&i.presenceEnabled)if(r.setChatEnabled(i.chatEnabled),r.setPresenceEnabled(i.presenceEnabled),r.setChatDomain(i.chatDomain),r.setInternalServerURL(i.internalServerUrl),r.setExternalServerURL(i.externalServerUrl),r.setServerURL(i.chatDomain),null==a.getNameCtrl()){var l=t.getNameCtrl();try{l.GetStatus("","")}catch(e){l=null}if(null!=l){r.pluginEnabled=!0,r.setNameCtrl(l);var c=t.options.context.getModel(d),u=c.get("name")+"@"+i.chatDomain;r.setLoginUserSIP(u),!1===t.isPlugInLoggedInUser()&&(r.pluginEnabled=!1,o.initializeApplication(n))}else r.pluginEnabled=!1,o.initializeApplication(n)}else r.pluginEnabled=!0,r.setNameCtrl(l);s.resolve()}),s},"isPlugInLoggedInUser":function(){var e=r.getNameCtrl(),t=r.getLoginUserSIP(),i=!1,s=0;if(null==e)return i;for(s=0;s<20;s++)if(1!==e.GetStatus(t,"test")){i=!0;break}return i},"getProvider":function(e){return"realtime"===e?l:(!0===this.isPlugInLoggedInUser()&&(r.pluginEnabled=!0),r.pluginEnabled?!1===this.isPlugInLoggedInUser()?(r.pluginEnabled=!1,o.initializeApplication(),o):(a.setNameCtrl(r.getNameCtrl()),a.attachLyncPresenceChangeEvent(),a):o)},"getNameCtrl":function(){var e=null;try{try{this.isCompatibleMSIEVersion()&&(e=new window.ActiveXObject("Name.NameCtrl"))}catch(t){e=null}null==e&&(e=this.createNPApiOnWindowsPlugin("application/x-sharepoint-uc"),void 0===e.GetStatus&&(e=null))}catch(t){e=null}return e},"isNPAPIOnWinPluginInstalled":function(e){return Boolean(navigator.mimeTypes)&&navigator.mimeTypes[e]&&navigator.mimeTypes[e].enabledPlugin},"createNPApiOnWindowsPlugin":function(e){var t=null;try{if(t=document.getElementById(e),!Boolean(t)&&this.isNPAPIOnWinPluginInstalled(e)){var i=document.createElement("object");i.id=e,i.type=e,i.width="0",i.height="0",i.style.setProperty("visibility","hidden",""),document.body.appendChild(i),t=document.getElementById(e)}}catch(e){t=null}return t},"isCompatibleMSIEVersion":function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))}}))}),csui.define("esoc/widgets/userwidget/chat/model/presence.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","i18n!esoc/widgets/userwidget/nls/lang"],function(e,t,i,s){return i.Model.extend({"defaults":{"status":"Unknown","tooltipText":s.presenceUnknownTooltipText},"constructor":function(e){this.options=e,i.Model.prototype.constructor.apply(this,arguments),e&&e.connector&&e.connector.assignTo(this)}})}),csui.define("hbs!esoc/widgets/userwidget/chat/impl/presence",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.presenceEnabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:""},"2":function(e,t,i,s){var n,o;return"    <div id='esoc-chat-presence-indicator-"+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+"' title='"+this.escapeExpression((o=null!=(o=t.tooltipText||(null!=e?e.tooltipText:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tooltipText","hash":{}}):o))+"' class='esoc-chat-presence-indicator\r\n      "+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.status == 'Offline'",{"name":"xif","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+"\r\n      "+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.status == 'Away'",{"name":"xif","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+"\r\n      "+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.status == 'Online'",{"name":"xif","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+"\r\n      "+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.status == 'Busy'",{"name":"xif","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+"\r\n      "+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.status == 'Unknown'",{"name":"xif","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"\r\n      "+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.status == 'DoNotDisturb'",{"name":"xif","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")+'\' tabindex="0"\r\n         aria-label="'+this.escapeExpression((o=null!=(o=t.tooltipText||(null!=e?e.tooltipText:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tooltipText","hash":{}}):o))+'"></div>\r\n'},"3":function(e,t,i,s){return"esoc-chat-presence-Offline "},"5":function(e,t,i,s){return"esoc-chat-presence-Away"},"7":function(e,t,i,s){return"esoc-chat-presence-Online"},"9":function(e,t,i,s){return"esoc-chat-presence-Busy"},"11":function(e,t,i,s){return"esoc-chat-presence-Unknown"},"13":function(e,t,i,s){return"esoc-chat-presence-donotdisturb"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.chatEnabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("esoc_widgets_userwidget_chat_impl_presence",s),s}),csui.define("esoc/widgets/userwidget/chat/view/presence.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","esoc/widgets/userwidget/chat/chatfactory","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model","esoc/widgets/userwidget/chat/model/presence.model","hbs!esoc/widgets/userwidget/chat/impl/presence","esoc/widgets/common/util","css!esoc/widgets/userwidget/chat/chat.css","csui/lib/handlebars.helpers.xif"],function(e,t,i,s,n,o,a,l,r){return s.ItemView.extend({"template":l,"templateHelpers":function(){return{"messages":{}}},"initialize":function(e){this.options=e;var t=this;n.initializeApplication(e).promise().done(function(){var e=o.getChatEnabled(),s=o.getPresenceEnabled();if(e&&s){t.model.attributes.chatEnabled=e,t.model.attributes.presenceEnabled=s;var a=i.extend({},t.options);t.options.username&&(a.email=t.options.username+r.globalConstants.AT_SIGN_SYMBOL+o.getChatDomain(),a.presenceHolder="esoc-chat-presence-indicator-"+t.options.model.attributes.id),a.subscribeEvent?n.getProvider().updateEventPresence(a):n.getProvider().showUserPresence(a)}})},"constructor":function(e){e.model=new a(e),e=e||{},s.ItemView.prototype.constructor.call(this,e),this.model.on("change.presencestatus",this.render,this)}})}),csui.define("esoc/controls/dialog/dialog.view",["module","csui/lib/underscore","csui/lib/jquery","csui/controls/dialog/dialog.view","csui/utils/log"],function(e,t,i,s,n){n=n(e.id);var o=s.extend({"templateHelpers":t.extend(function(){var e="user"+this.options.view.options.userid;return{"binfDialogSizeClassName":(this.options.largeSize?"binf-modal-lg ":this.options.midSize?"binf-modal-md ":" ")+e}}),"onRender":function(){this.$el.addClass(o.prototype.className.call(this)).attr("tabindex",0),this._renderHeader(),this.options.view&&(this.body.show(this.options.view),this.options.view.triggerMethod("dom:refresh"),this.options.view.triggerMethod("after:show")),this._renderFooter()}});return o}),csui.define("hbs!esoc/controls/dialog/impl/multiple.dialogs",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div id="modalDialogs" class="multi-modal-dialogs">\r\n  <div class="modal-dialogs-inner" id="modalDialogsInner"></div>\r\n</div>\r\n\r\n'}});return i.registerPartial("esoc_controls_dialog_impl_multiple.dialogs",s),s}),csui.define("esoc/controls/dialog/multiple.dialogs.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","esoc/controls/dialog/dialog.view","hbs!esoc/controls/dialog/impl/multiple.dialogs","csui/utils/non-emptying.region/non-emptying.region","csui/utils/log","i18n","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,a,l,r,c,d,u){d=d(e.id);var m=n.ItemView.extend({"className":function(){var e="cs-dialog binf-modal binf-fade";return this.options.className&&(e+=" "+t.result(this.options,"className")),e},"attributes":{"tabindex":"-1","aria-hidden":"true"},"template":r,"behaviors":{"TabablesBehavior":{"behaviorClass":a,"recursiveNavigation":!0,"containTabFocus":!0}},"events":{"hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","click .cs-close":"onClickClose","shown.binf.modal":"onShown","keydown":"onKeyInView","setCurrentTabFocus":"setCurrentTabFocus","tabNextRegion":"tabNextRegion","click .tile-type-action-icon":"onClickActionIcon"},"constructor":function(){n.ItemView.prototype.constructor.apply(this,arguments),this.listenToOnce(this,"before:hide",a.popTabableHandler)},"onKeyInView":function(e){40!==e.keyCode&&38!==e.keyCode||(e.stopPropagation(),e.preventDefault()),27===e.keyCode&&this.destroy(e)},"setCurrentTabFocus":function(){this.focusOnLastRegion=!0,this.$el.trigger("focus")},"tabNextRegion":function(){this.trigger("changed:focus")},"onRender":function(){this.$el.addClass(m.prototype.className.call(this)).attr("tabindex",0),this.appendData(this.options.views)},"appendData":function(e){var t=new l({"view":e[e.length-1],"largeSize":this.options.largeSize});t.render();var i=t.$el.find(".binf-modal-dialog").detach();this.$el.find(".modal-dialogs-inner").append(i)},"onShow":function(){i(window).scrollTop(0),this.$el.binf_modal({"backdrop":"static","keyboard":!1,"paddingWhenOverflowing":!1})},"onShown":function(){this.$el.find(".cs-close").trigger("focus")},"kill":function(){return m.__super__.destroy.apply(this,arguments),this._scrollToBegin(),!0},"destroy":function(e){var t=this.options.views.length;if(this.$el.is(":visible")&&t)if(1===t)this.$el.binf_modal("hide");else{var s;s=i(e.currentTarget).hasClass("cs-dialog")?i(e.currentTarget).find(".slick-current .binf-modal-dialog"):i(e.currentTarget).closest(".binf-modal-dialog"),this.options.util.removeSlick();var n=s.index();i(s).remove(),n>0?this.options.util.applySlick(n-1):this.options.util.applySlick(n),this.options.views.length=this.options.views.length-1,1===this.options.views.length&&this.$el.trigger("focus")}else if(m.__super__.destroy.apply(this,arguments),this.options.focusCallBack)this.options.focusCallBack();else{var o=this.options.targetEle;o&&i(o).is(":visible")&&i(o).trigger("focus")}return this._scrollToBegin(),1===this.$el.find(".binf-modal-dialog").length?this.$el.find(".cs-close").trigger("focus"):this.$el.find(".slick-current .slick -close").trigger("focus"),this},"onHiding":function(){this.triggerMethod("before:hide")},"onHidden":function(){this.triggerMethod("hide"),this.destroy()},"onClickClose":function(e){e.preventDefault(),e.stopPropagation(),this.destroy(e)},"onClickActionIcon":function(e){this.options.view.trigger("click:actionIcon")},"_scrollToBegin":function(){if(!0===u.settings.rtl){var e=i("body").width();i("body").scrollLeft(e)}else i("body").scrollLeft(0)}});return m}),csui.define("esoc/lib/slick/slick",["csui/lib/jquery"],function(e){!function(t){"use strict";e&&!e.fn.slick&&function(e){var t=window.Slick||{};t=function(){function t(t,s){var n,o=this;o.defaults={"accessibility":!0,"adaptiveHeight":!1,"appendArrows":e(t),"appendDots":e(t),"arrows":!0,"asNavFor":null,"prevArrow":'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',"nextArrow":'<button class="slick-next" aria-label="Next" type="button">Next</button>',"autoplay":!1,"autoplaySpeed":3e3,"centerMode":!1,"centerPadding":"50px","cssEase":"ease","customPaging":function(t,i){return e('<button type="button" />').text(i+1)},"dots":!1,"dotsClass":"slick-dots","draggable":!0,"easing":"linear","edgeFriction":.35,"fade":!1,"focusOnSelect":!1,"focusOnChange":!1,"infinite":!0,"initialSlide":0,"lazyLoad":"ondemand","mobileFirst":!1,"pauseOnHover":!0,"pauseOnFocus":!0,"pauseOnDotsHover":!1,"respondTo":"window","responsive":null,"rows":1,"rtl":!1,"slide":"","slidesPerRow":1,"slidesToShow":1,"slidesToScroll":1,"speed":500,"swipe":!0,"swipeToSlide":!1,"touchMove":!0,"touchThreshold":5,"useCSS":!0,"useTransform":!0,"variableWidth":!1,"vertical":!1,"verticalSwiping":!1,"waitForAnimate":!0,"zIndex":1e3},o.initials={"animating":!1,"dragging":!1,"autoPlayTimer":null,"currentDirection":0,"currentLeft":null,"currentSlide":0,"direction":1,"$dots":null,"listWidth":null,"listHeight":null,"loadIndex":0,"$nextArrow":null,"$prevArrow":null,"scrolling":!1,"slideCount":null,"slideWidth":null,"$slideTrack":null,"$slides":null,"sliding":!1,"slideOffset":0,"swipeLeft":null,"swiping":!1,"$list":null,"touchObject":{},"transformsEnabled":!1,"unslicked":!1},e.extend(o,o.initials),o.activeBreakpoint=null,o.animType=null,o.animProp=null,o.breakpoints=[],o.breakpointSettings=[],o.cssTransitions=!1,o.focussed=!1,o.interrupted=!1,o.hidden="hidden",o.paused=!0,o.positionProp=null,o.respondTo=null,o.rowCount=1,o.shouldClick=!0,o.$slider=e(t),o.$slidesCache=null,o.transformType=null,o.transitionType=null,o.visibilityChange="visibilitychange",o.windowWidth=0,o.windowTimer=null,n=e(t).data("slick")||{},o.options=e.extend({},o.defaults,s,n),o.currentSlide=o.options.initialSlide,o.originalSettings=o.options,void 0!==document.mozHidden?(o.hidden="mozHidden",o.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(o.hidden="webkitHidden",o.visibilityChange="webkitvisibilitychange"),o.autoPlay=e.proxy(o.autoPlay,o),o.autoPlayClear=e.proxy(o.autoPlayClear,o),o.autoPlayIterator=e.proxy(o.autoPlayIterator,o),o.changeSlide=e.proxy(o.changeSlide,o),o.clickHandler=e.proxy(o.clickHandler,o),o.selectHandler=e.proxy(o.selectHandler,o),o.setPosition=e.proxy(o.setPosition,o),o.swipeHandler=e.proxy(o.swipeHandler,o),o.dragHandler=e.proxy(o.dragHandler,o),o.keyHandler=e.proxy(o.keyHandler,o),o.instanceUid=i++,o.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,o.registerBreakpoints(),o.init(!0)}var i=0;return t}(),t.prototype.activateADA=function(){var e=this,t=e.$slideTrack.find(".slick-active");t.length||(t=e.$slideTrack.find(".slick-current")),t.attr({"aria-hidden":"false"}).find("a, input, button, select,[data-cstabindex=-1]").attr({"tabindex":"0","data-cstabindex":"0"})},t.prototype.addSlide=t.prototype.slickAdd=function(t,i,s){var n=this;if("boolean"==typeof i)s=i,i=null;else if(i<0||i>=n.slideCount)return!1;n.unload(),"number"==typeof i?0===i&&0===n.$slides.length?e(t).appendTo(n.$slideTrack):s?e(t).insertBefore(n.$slides.eq(i)):e(t).insertAfter(n.$slides.eq(i)):!0===s?e(t).prependTo(n.$slideTrack):e(t).appendTo(n.$slideTrack),n.$slides=n.$slideTrack.children(this.options.slide),n.$slideTrack.children(this.options.slide).detach(),n.$slideTrack.append(n.$slides),n.$slides.each(function(t,i){e(i).attr("data-slick-index",t)}),n.$slidesCache=n.$slides,n.reinit()},t.prototype.animateHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.animate({"height":t},e.options.speed)}},t.prototype.animateSlide=function(t,i){var s={},n=this;n.animateHeight(),!0===n.options.rtl&&!1===n.options.vertical&&(t=-t),!1===n.transformsEnabled?!1===n.options.vertical?n.$slideTrack.animate({"left":t},n.options.speed,n.options.easing,i):n.$slideTrack.animate({"top":t},n.options.speed,n.options.easing,i):!1===n.cssTransitions?(!0===n.options.rtl&&(n.currentLeft=-n.currentLeft),e({"animStart":n.currentLeft}).animate({"animStart":t},{"duration":n.options.speed,"easing":n.options.easing,"step":function(e){e=Math.ceil(e),!1===n.options.vertical?(s[n.animType]="translate("+e+"px, 0px)",n.$slideTrack.css(s)):(s[n.animType]="translate(0px,"+e+"px)",n.$slideTrack.css(s))},"complete":function(){i&&i.call()}})):(n.applyTransition(),t=Math.ceil(t),!1===n.options.vertical?s[n.animType]="translate3d("+t+"px, 0px, 0px)":s[n.animType]="translate3d(0px,"+t+"px, 0px)",n.$slideTrack.css(s),i&&setTimeout(function(){n.disableTransition(),i.call()},n.options.speed))},t.prototype.getNavTarget=function(){var t=this,i=t.options.asNavFor;return i&&null!==i&&(i=e(i).not(t.$slider)),i},t.prototype.asNavFor=function(t){var i=this,s=i.getNavTarget();null!==s&&"object"==typeof s&&s.each(function(){var i=e(this).slick("getSlick");i.unslicked||i.slideHandler(t,!0)})},t.prototype.applyTransition=function(e){var t=this,i={};!1===t.options.fade?i[t.transitionType]=t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:i[t.transitionType]="opacity "+t.options.speed+"ms "+t.options.cssEase,!1===t.options.fade?t.$slideTrack.css(i):t.$slides.eq(e).css(i)},t.prototype.autoPlay=function(){var e=this;e.autoPlayClear(),e.slideCount>e.options.slidesToShow&&(e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed))},t.prototype.autoPlayClear=function(){var e=this;e.autoPlayTimer&&clearInterval(e.autoPlayTimer)},t.prototype.autoPlayIterator=function(){var e=this,t=e.currentSlide+e.options.slidesToScroll;e.paused||e.interrupted||e.focussed||(!1===e.options.infinite&&(1===e.direction&&e.currentSlide+1===e.slideCount-1?e.direction=0:0===e.direction&&(t=e.currentSlide-e.options.slidesToScroll,e.currentSlide-1==0&&(e.direction=1))),e.slideHandler(t))},t.prototype.buildArrows=function(){var t=this;!0===t.options.arrows&&(t.$prevArrow=e(t.options.prevArrow).addClass("slick-arrow"),t.$nextArrow=e(t.options.nextArrow).addClass("slick-arrow"),t.slideCount>t.options.slidesToShow?(t.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.prependTo(t.options.appendArrows),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.appendTo(t.options.appendArrows),!0!==t.options.infinite&&t.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):t.$prevArrow.add(t.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true","tabindex":"-1"}))},t.prototype.buildDots=function(){var t,i,s=this;if(!0===s.options.dots&&s.slideCount>s.options.slidesToShow){for(s.$slider.addClass("slick-dotted"),i=e("<ul />").addClass(s.options.dotsClass),t=0;t<=s.getDotCount();t+=1)i.append(e("<li />").append(s.options.customPaging.call(this,s,t)));s.$dots=i.appendTo(s.options.appendDots),s.$dots.find("li").first().addClass("slick-active")}},t.prototype.buildOut=function(){var t=this;t.$slides=t.$slider.children(t.options.slide+":not(.slick-cloned)").addClass("slick-slide"),t.slideCount=t.$slides.length,t.$slides.each(function(t,i){e(i).attr("data-slick-index",t).data("originalStyling",e(i).attr("style")||"")}),t.$slider.addClass("slick-slider"),t.$slideTrack=0===t.slideCount?e('<div class="slick-track"/>').appendTo(t.$slider):t.$slides.wrapAll('<div class="slick-track"/>').parent(),t.$list=t.$slideTrack.wrap('<div class="slick-list"/>').parent(),t.$slideTrack.css("opacity",0),!0!==t.options.centerMode&&!0!==t.options.swipeToSlide||(t.options.slidesToScroll=1),e("img[data-lazy]",t.$slider).not("[src]").addClass("slick-loading"),t.setupInfinite(),t.buildArrows(),t.buildDots(),t.updateDots(),t.setSlideClasses("number"==typeof t.currentSlide?t.currentSlide:0),!0===t.options.draggable&&t.$list.addClass("draggable"),t.slidesAdjust()},t.prototype.buildRows=function(){var e,t,i,s,n,o,a,l=this;if(s=document.createDocumentFragment(),o=l.$slider.children(),l.options.rows>0){for(a=l.options.slidesPerRow*l.options.rows,n=Math.ceil(o.length/a),e=0;e<n;e++){var r=document.createElement("div");for(t=0;t<l.options.rows;t++){var c=document.createElement("div");for(i=0;i<l.options.slidesPerRow;i++){var d=e*a+(t*l.options.slidesPerRow+i);o.get(d)&&c.appendChild(o.get(d))}r.appendChild(c)}s.appendChild(r)}l.$slider.empty().append(s),l.$slider.children().children().children().css({"width":100/l.options.slidesPerRow+"%","display":"inline-block"})}},t.prototype.checkResponsive=function(t,i){var s,n,o,a=this,l=!1,r=a.$slider.width(),c=window.innerWidth||e(window).width();if("window"===a.respondTo?o=c:"slider"===a.respondTo?o=r:"min"===a.respondTo&&(o=Math.min(c,r)),a.options.responsive&&a.options.responsive.length&&null!==a.options.responsive){n=null;for(s in a.breakpoints)a.breakpoints.hasOwnProperty(s)&&(!1===a.originalSettings.mobileFirst?o<a.breakpoints[s]&&(n=a.breakpoints[s]):o>a.breakpoints[s]&&(n=a.breakpoints[s]));null!==n?null!==a.activeBreakpoint?(n!==a.activeBreakpoint||i)&&(a.activeBreakpoint=n,"unslick"===a.breakpointSettings[n]?a.unslick(n):(a.options=e.extend({},a.originalSettings,a.breakpointSettings[n]),!0===t&&(a.currentSlide=a.options.initialSlide),a.refresh(t)),l=n):(a.activeBreakpoint=n,"unslick"===a.breakpointSettings[n]?a.unslick(n):(a.options=e.extend({},a.originalSettings,a.breakpointSettings[n]),!0===t&&(a.currentSlide=a.options.initialSlide),a.refresh(t)),l=n):null!==a.activeBreakpoint&&(a.activeBreakpoint=null,a.options=a.originalSettings,!0===t&&(a.currentSlide=a.options.initialSlide),a.refresh(t),l=n),t||!1===l||a.$slider.trigger("breakpoint",[a,l])}},t.prototype.changeSlide=function(t,i){var s,n,o,a=this,l=e(t.currentTarget);switch(l.is("a")&&t.preventDefault(),l.is("li")||(l=l.closest("li")),o=a.slideCount%a.options.slidesToScroll!=0,s=o?0:(a.slideCount-a.currentSlide)%a.options.slidesToScroll,t.data.message){case"previous":n=0===s?a.options.slidesToScroll:a.options.slidesToShow-s,a.slideCount>a.options.slidesToShow&&a.slideHandler(a.currentSlide-n,!1,i);break;case"next":n=0===s?a.options.slidesToScroll:s,a.slideCount>a.options.slidesToShow&&a.slideHandler(a.currentSlide+n,!1,i);break;case"index":var r=0===t.data.index?0:t.data.index||l.index()*a.options.slidesToScroll;a.slideHandler(a.checkNavigable(r),!1,i),l.children().trigger("focus");break;default:return}},t.prototype.checkNavigable=function(e){var t,i,s=this;if(t=s.getNavigableIndexes(),i=0,e>t[t.length-1])e=t[t.length-1];else for(var n in t){if(e<t[n]){e=i;break}i=t[n]}return e},t.prototype.cleanUpEvents=function(){var t=this;t.options.dots&&null!==t.$dots&&(e("li",t.$dots).off("click.slick",t.changeSlide).off("mouseenter.slick",e.proxy(t.interrupt,t,!0)).off("mouseleave.slick",e.proxy(t.interrupt,t,!1)),!0===t.options.accessibility&&t.$dots.off("keydown.slick",t.keyHandler)),t.$slider.off("focus.slick blur.slick"),!0===t.options.arrows&&t.slideCount>t.options.slidesToShow&&(t.$prevArrow&&t.$prevArrow.off("click.slick",t.changeSlide),t.$nextArrow&&t.$nextArrow.off("click.slick",t.changeSlide),!0===t.options.accessibility&&(t.$prevArrow&&t.$prevArrow.off("keydown.slick",t.keyHandler),t.$nextArrow&&t.$nextArrow.off("keydown.slick",t.keyHandler))),t.$list.off("touchstart.slick mousedown.slick",t.swipeHandler),t.$list.off("touchmove.slick mousemove.slick",t.swipeHandler),t.$list.off("touchend.slick mouseup.slick",t.swipeHandler),t.$list.off("touchcancel.slick mouseleave.slick",t.swipeHandler),t.$list.off("click.slick",t.clickHandler),e(document).off(t.visibilityChange,t.visibility),t.cleanUpSlideEvents(),!0===t.options.accessibility&&t.$list.off("keydown.slick",t.keyHandler),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().off("click.slick",t.selectHandler),
e(window).off("orientationchange.slick.slick-"+t.instanceUid,t.orientationChange),e(window).off("resize.slick.slick-"+t.instanceUid,t.resize),e("[draggable!=true]",t.$slideTrack).off("dragstart",t.preventDefault),e(window).off("load.slick.slick-"+t.instanceUid,t.setPosition)},t.prototype.cleanUpSlideEvents=function(){var t=this;t.$list.off("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$list.off("mouseleave.slick",e.proxy(t.interrupt,t,!1))},t.prototype.cleanUpRows=function(){var e,t=this;t.options.rows>0&&(e=t.$slides.children().children().detach(),e.removeAttr("style"),t.$slider.empty().append(e.detach()))},t.prototype.clickHandler=function(e){!1===this.shouldClick&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())},t.prototype.destroy=function(t){var i=this;i.autoPlayClear(),i.touchObject={},i.cleanUpEvents(),e(".slick-cloned",i.$slider).detach(),i.$dots&&i.$dots.remove(),i.$prevArrow&&i.$prevArrow.length&&(i.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.prevArrow)&&i.$prevArrow.remove()),i.$nextArrow&&i.$nextArrow.length&&(i.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.nextArrow)&&i.$nextArrow.remove()),i.$slides&&(i.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){e(this).attr("style",e(this).data("originalStyling"))}),i.$slideTrack.children(this.options.slide).detach(),i.$slideTrack.detach(),i.$list.detach(),i.$slider.append(i.$slides.detach())),i.cleanUpRows(),i.$slider.removeClass("slick-slider"),i.$slider.removeClass("slick-initialized"),i.$slider.removeClass("slick-dotted"),i.unslicked=!0,t||i.$slider.trigger("destroy",[i])},t.prototype.disableTransition=function(e){var t=this,i={};i[t.transitionType]="",!1===t.options.fade?t.$slideTrack.css(i):t.$slides.eq(e).css(i)},t.prototype.fadeSlide=function(e,t){var i=this;!1===i.cssTransitions?(i.$slides.eq(e).css({"zIndex":i.options.zIndex}),i.$slides.eq(e).animate({"opacity":1},i.options.speed,i.options.easing,t)):(i.applyTransition(e),i.$slides.eq(e).css({"opacity":1,"zIndex":i.options.zIndex}),t&&setTimeout(function(){i.disableTransition(e),t.call()},i.options.speed))},t.prototype.fadeSlideOut=function(e){var t=this;!1===t.cssTransitions?t.$slides.eq(e).animate({"opacity":0,"zIndex":t.options.zIndex-2},t.options.speed,t.options.easing):(t.applyTransition(e),t.$slides.eq(e).css({"opacity":0,"zIndex":t.options.zIndex-2}))},t.prototype.filterSlides=t.prototype.slickFilter=function(e){var t=this;null!==e&&(t.$slidesCache=t.$slides,t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(e).appendTo(t.$slideTrack),t.reinit())},t.prototype.focusHandler=function(){var t=this;t.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(i){i.stopImmediatePropagation();var s=e(this);setTimeout(function(){t.options.pauseOnFocus&&(t.focussed=s.is(":focus"),t.autoPlay())},0)})},t.prototype.getCurrent=t.prototype.slickCurrentSlide=function(){return this.currentSlide},t.prototype.getDotCount=function(){var e=this,t=0,i=0,s=0;if(!0===e.options.infinite)if(e.slideCount<=e.options.slidesToShow)++s;else for(;t<e.slideCount;)++s,t=i+e.options.slidesToScroll,i+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else if(!0===e.options.centerMode)s=e.slideCount;else if(e.options.asNavFor)for(;t<e.slideCount;)++s,t=i+e.options.slidesToScroll,i+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else s=1+Math.ceil((e.slideCount-e.options.slidesToShow)/e.options.slidesToScroll);return s-1},t.prototype.getLeft=function(e){var t,i,s,n,o=this,a=0;return o.slideOffset=0,i=o.$slides.eq(0).outerHeight(!0),!0===o.options.infinite?(o.slideCount>o.options.slidesToShow&&(o.slideOffset=o.slideWidth*o.options.slidesToShow*-1,n=-1,!0===o.options.vertical&&!0===o.options.centerMode&&(2===o.options.slidesToShow?n=-1.5:1===o.options.slidesToShow&&(n=-2)),a=i*o.options.slidesToShow*n),o.slideCount%o.options.slidesToScroll!=0&&e+o.options.slidesToScroll>o.slideCount&&o.slideCount>o.options.slidesToShow&&(e>o.slideCount?(o.slideOffset=(o.options.slidesToShow-(e-o.slideCount))*o.slideWidth*-1,a=(o.options.slidesToShow-(e-o.slideCount))*i*-1):(o.slideOffset=o.slideCount%o.options.slidesToScroll*o.slideWidth*-1,a=o.slideCount%o.options.slidesToScroll*i*-1))):e+o.options.slidesToShow>o.slideCount&&(o.slideOffset=(e+o.options.slidesToShow-o.slideCount)*o.slideWidth,a=(e+o.options.slidesToShow-o.slideCount)*i),o.slideCount<=o.options.slidesToShow&&(o.slideOffset=0,a=0),!0===o.options.centerMode&&o.slideCount<=o.options.slidesToShow?o.slideOffset=o.slideWidth*Math.floor(o.options.slidesToShow)/2-o.slideWidth*o.slideCount/2:!0===o.options.centerMode&&!0===o.options.infinite?o.slideOffset+=o.slideWidth*Math.floor(o.options.slidesToShow/2)-o.slideWidth:!0===o.options.centerMode&&(o.slideOffset=0,o.slideOffset+=o.slideWidth*Math.floor(o.options.slidesToShow/2)),t=!1===o.options.vertical?e*o.slideWidth*-1+o.slideOffset:e*i*-1+a,!0===o.options.variableWidth&&(s=o.slideCount<=o.options.slidesToShow||!1===o.options.infinite?o.$slideTrack.children(".slick-slide").eq(e):o.$slideTrack.children(".slick-slide").eq(e+o.options.slidesToShow),t=!0===o.options.rtl?s[0]?-1*(o.$slideTrack.width()-s[0].offsetLeft-s.width()):0:s[0]?-1*s[0].offsetLeft:0,!0===o.options.centerMode&&(s=o.slideCount<=o.options.slidesToShow||!1===o.options.infinite?o.$slideTrack.children(".slick-slide").eq(e):o.$slideTrack.children(".slick-slide").eq(e+o.options.slidesToShow+1),t=!0===o.options.rtl?s[0]?-1*(o.$slideTrack.width()-s[0].offsetLeft-s.width()):0:s[0]?-1*s[0].offsetLeft:0,t+=(o.$list.width()-s.outerWidth())/2)),t},t.prototype.getOption=t.prototype.slickGetOption=function(e){return this.options[e]},t.prototype.getNavigableIndexes=function(){var e,t=this,i=0,s=0,n=[];for(!1===t.options.infinite?e=t.slideCount:(i=-1*t.options.slidesToScroll,s=-1*t.options.slidesToScroll,e=2*t.slideCount);i<e;)n.push(i),i=s+t.options.slidesToScroll,s+=t.options.slidesToScroll<=t.options.slidesToShow?t.options.slidesToScroll:t.options.slidesToShow;return n},t.prototype.getSlick=function(){return this},t.prototype.getSlideCount=function(){var t,i,s=this;return i=!0===s.options.centerMode?s.slideWidth*Math.floor(s.options.slidesToShow/2):0,!0===s.options.swipeToSlide?(s.$slideTrack.find(".slick-slide").each(function(n,o){if(o.offsetLeft-i+e(o).outerWidth()/2>-1*s.swipeLeft)return t=o,!1}),Math.abs(e(t).attr("data-slick-index")-s.currentSlide)||1):s.options.slidesToScroll},t.prototype.goTo=t.prototype.slickGoTo=function(e,t){this.changeSlide({"data":{"message":"index","index":parseInt(e)}},t)},t.prototype.init=function(t){var i=this;e(i.$slider).hasClass("slick-initialized")||(e(i.$slider).addClass("slick-initialized"),i.buildRows(),i.buildOut(),i.setProps(),i.startLoad(),i.loadSlider(),i.initializeEvents(),i.updateArrows(),i.updateDots(),i.checkResponsive(!0),i.focusHandler()),t&&i.$slider.trigger("init",[i]),!0===i.options.accessibility&&i.initADA(),i.options.autoplay&&(i.paused=!1,i.autoPlay())},t.prototype.initADA=function(){var t=this,i=Math.ceil(t.slideCount/t.options.slidesToShow),s=t.getNavigableIndexes().filter(function(e){return e>=0&&e<t.slideCount});t.$slides.add(t.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true","tabindex":"-1"}).find("a, input, button, select,[data-cstabindex=0]").attr({"tabindex":"-1","data-cstabindex":"-1"}),null!==t.$dots&&(t.$slides.not(t.$slideTrack.find(".slick-cloned")).each(function(i){var n=s.indexOf(i);if(e(this).attr({"role":"tabpanel","id":"slick-slide"+t.instanceUid+i,"tabindex":-1}),-1!==n){var o="slick-slide-control"+t.instanceUid+n;e("#"+o).length&&e(this).attr({"aria-describedby":o})}}),t.$dots.attr("role","tablist").find("li").each(function(n){var o=s[n];e(this).attr({"role":"presentation"}),e(this).find("button").first().attr({"role":"tab","id":"slick-slide-control"+t.instanceUid+n,"aria-controls":"slick-slide"+t.instanceUid+o,"aria-label":n+1+" of "+i,"aria-selected":null,"tabindex":"-1"})}).eq(t.currentSlide).find("button").attr({"aria-selected":"true","tabindex":"0"}).end());for(var n=t.currentSlide,o=n+t.options.slidesToShow;n<o;n++)t.options.focusOnChange?(t.$slides.eq(n).attr({"tabindex":"0"}),t.$slides.eq(n).find(".slick-close").trigger("focus")):t.$slides.eq(n).removeAttr("tabindex");t.activateADA()},t.prototype.initArrowEvents=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.off("click.slick").on("click.slick",{"message":"previous"},e.changeSlide),e.$nextArrow.off("click.slick").on("click.slick",{"message":"next"},e.changeSlide),!0===e.options.accessibility&&(e.$prevArrow.on("keydown.slick",e.keyHandler),e.$nextArrow.on("keydown.slick",e.keyHandler)))},t.prototype.initDotEvents=function(){var t=this;!0===t.options.dots&&t.slideCount>t.options.slidesToShow&&(e("li",t.$dots).on("click.slick",{"message":"index"},t.changeSlide),!0===t.options.accessibility&&t.$dots.on("keydown.slick",t.keyHandler)),!0===t.options.dots&&!0===t.options.pauseOnDotsHover&&t.slideCount>t.options.slidesToShow&&e("li",t.$dots).on("mouseenter.slick",e.proxy(t.interrupt,t,!0)).on("mouseleave.slick",e.proxy(t.interrupt,t,!1))},t.prototype.initSlideEvents=function(){var t=this;t.options.pauseOnHover&&(t.$list.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$list.on("mouseleave.slick",e.proxy(t.interrupt,t,!1)))},t.prototype.initializeEvents=function(){var t=this;t.initArrowEvents(),t.initDotEvents(),t.initSlideEvents(),t.$list.on("touchstart.slick mousedown.slick",{"action":"start"},t.swipeHandler),t.$list.on("touchmove.slick mousemove.slick",{"action":"move"},t.swipeHandler),t.$list.on("touchend.slick mouseup.slick",{"action":"end"},t.swipeHandler),t.$list.on("touchcancel.slick mouseleave.slick",{"action":"end"},t.swipeHandler),t.$list.on("click.slick",t.clickHandler),e(document).on(t.visibilityChange,e.proxy(t.visibility,t)),!0===t.options.accessibility&&t.$list.on("keydown.slick",t.keyHandler),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().on("click.slick",t.selectHandler),e(window).on("orientationchange.slick.slick-"+t.instanceUid,e.proxy(t.orientationChange,t)),e(window).on("resize.slick.slick-"+t.instanceUid,e.proxy(t.resize,t)),e("[draggable!=true]",t.$slideTrack).on("dragstart",t.preventDefault),e(window).on("load.slick.slick-"+t.instanceUid,t.setPosition),e(t.setPosition)},t.prototype.initUI=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.show(),e.$nextArrow.show()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.show()},t.prototype.keyHandler=function(e){var t=this;e.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===e.keyCode&&!0===t.options.accessibility?t.changeSlide({"data":{"message":!0===t.options.rtl?"next":"previous"}}):39===e.keyCode&&!0===t.options.accessibility&&t.changeSlide({"data":{"message":!0===t.options.rtl?"previous":"next"}}))},t.prototype.lazyLoad=function(){function t(t){e("img[data-lazy]",t).each(function(){var t=e(this),i=e(this).attr("data-lazy"),s=e(this).attr("data-srcset"),n=e(this).attr("data-sizes")||a.$slider.attr("data-sizes"),o=document.createElement("img");o.onload=function(){t.animate({"opacity":0},100,function(){s&&(t.attr("srcset",s),n&&t.attr("sizes",n)),t.attr("src",i).animate({"opacity":1},200,function(){t.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),a.$slider.trigger("lazyLoaded",[a,t,i])})},o.onerror=function(){t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),a.$slider.trigger("lazyLoadError",[a,t,i])},o.src=i})}var i,s,n,o,a=this;if(!0===a.options.centerMode?!0===a.options.infinite?(n=a.currentSlide+(a.options.slidesToShow/2+1),o=n+a.options.slidesToShow+2):(n=Math.max(0,a.currentSlide-(a.options.slidesToShow/2+1)),o=a.options.slidesToShow/2+1+2+a.currentSlide):(n=a.options.infinite?a.options.slidesToShow+a.currentSlide:a.currentSlide,o=Math.ceil(n+a.options.slidesToShow),!0===a.options.fade&&(n>0&&n--,o<=a.slideCount&&o++)),i=a.$slider.find(".slick-slide").slice(n,o),"anticipated"===a.options.lazyLoad)for(var l=n-1,r=o,c=a.$slider.find(".slick-slide"),d=0;d<a.options.slidesToScroll;d++)l<0&&(l=a.slideCount-1),i=i.add(c.eq(l)),i=i.add(c.eq(r)),l--,r++;t(i),a.slideCount<=a.options.slidesToShow?(s=a.$slider.find(".slick-slide"),t(s)):a.currentSlide>=a.slideCount-a.options.slidesToShow?(s=a.$slider.find(".slick-cloned").slice(0,a.options.slidesToShow),t(s)):0===a.currentSlide&&(s=a.$slider.find(".slick-cloned").slice(-1*a.options.slidesToShow),t(s))},t.prototype.loadSlider=function(){var e=this;e.setPosition(),e.$slideTrack.css({"opacity":1}),e.$slider.removeClass("slick-loading"),e.initUI(),"progressive"===e.options.lazyLoad&&e.progressiveLazyLoad()},t.prototype.next=t.prototype.slickNext=function(){this.changeSlide({"data":{"message":"next"}})},t.prototype.orientationChange=function(){var e=this;e.checkResponsive(),e.setPosition()},t.prototype.pause=t.prototype.slickPause=function(){var e=this;e.autoPlayClear(),e.paused=!0},t.prototype.play=t.prototype.slickPlay=function(){var e=this;e.autoPlay(),e.options.autoplay=!0,e.paused=!1,e.focussed=!1,e.interrupted=!1},t.prototype.postSlide=function(t){var i=this;if(!i.unslicked&&(i.$slider.trigger("afterChange",[i,t]),i.animating=!1,i.swipeLeft=null,i.options.autoplay&&i.autoPlay(),!0===i.options.accessibility&&(i.initADA(),i.options.focusOnChange))){e(i.$slides.get(i.currentSlide)).find(".slick-close").trigger("focus")}},t.prototype.prev=t.prototype.slickPrev=function(){this.changeSlide({"data":{"message":"previous"}})},t.prototype.preventDefault=function(e){e.preventDefault()},t.prototype.progressiveLazyLoad=function(t){t=t||1;var i,s,n,o,a,l=this,r=e("img[data-lazy]",l.$slider);r.length?(i=r.first(),s=i.attr("data-lazy"),n=i.attr("data-srcset"),o=i.attr("data-sizes")||l.$slider.attr("data-sizes"),a=document.createElement("img"),a.onload=function(){n&&(i.attr("srcset",n),o&&i.attr("sizes",o)),i.attr("src",s).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),!0===l.options.adaptiveHeight&&l.setPosition(),l.$slider.trigger("lazyLoaded",[l,i,s]),l.progressiveLazyLoad()},a.onerror=function(){t<3?setTimeout(function(){l.progressiveLazyLoad(t+1)},500):(i.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),l.$slider.trigger("lazyLoadError",[l,i,s]),l.progressiveLazyLoad())},a.src=s):l.$slider.trigger("allImagesLoaded",[l])},t.prototype.refresh=function(t){var i,s,n=this;s=n.slideCount-n.options.slidesToShow,!n.options.infinite&&n.currentSlide>s&&(n.currentSlide=s),n.slideCount<=n.options.slidesToShow&&(n.currentSlide=0),i=n.currentSlide,n.destroy(!0),e.extend(n,n.initials,{"currentSlide":i}),n.init(),t||n.changeSlide({"data":{"message":"index","index":i}},!1)},t.prototype.registerBreakpoints=function(){var t,i,s,n=this,o=n.options.responsive||null;if("array"===e.type(o)&&o.length){n.respondTo=n.options.respondTo||"window";for(t in o)if(s=n.breakpoints.length-1,o.hasOwnProperty(t)){for(i=o[t].breakpoint;s>=0;)n.breakpoints[s]&&n.breakpoints[s]===i&&n.breakpoints.splice(s,1),s--;n.breakpoints.push(i),n.breakpointSettings[i]=o[t].settings}n.breakpoints.sort(function(e,t){return n.options.mobileFirst?e-t:t-e})}},t.prototype.reinit=function(){var t=this;t.$slides=t.$slideTrack.children(t.options.slide).addClass("slick-slide"),t.slideCount=t.$slides.length,t.currentSlide>=t.slideCount&&0!==t.currentSlide&&(t.currentSlide=t.currentSlide-t.options.slidesToScroll),t.slideCount<=t.options.slidesToShow&&(t.currentSlide=0),t.registerBreakpoints(),t.setProps(),t.setupInfinite(),t.buildArrows(),t.updateArrows(),t.initArrowEvents(),t.buildDots(),t.updateDots(),t.initDotEvents(),t.cleanUpSlideEvents(),t.initSlideEvents(),t.checkResponsive(!1,!0),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().on("click.slick",t.selectHandler),t.setSlideClasses("number"==typeof t.currentSlide?t.currentSlide:0),t.setPosition(),t.focusHandler(),t.paused=!t.options.autoplay,t.autoPlay(),t.$slider.trigger("reInit",[t])},t.prototype.resize=function(){var t=this;e(window).width()!==t.windowWidth&&(clearTimeout(t.windowDelay),t.windowDelay=window.setTimeout(function(){t.windowWidth=e(window).width(),t.checkResponsive(),t.unslicked||t.setPosition()},50))},t.prototype.removeSlide=t.prototype.slickRemove=function(e,t,i){var s=this;if("boolean"==typeof e?(t=e,e=!0===t?0:s.slideCount-1):e=!0===t?--e:e,s.slideCount<1||e<0||e>s.slideCount-1)return!1;s.unload(),!0===i?s.$slideTrack.children().remove():s.$slideTrack.children(this.options.slide).eq(e).remove(),s.$slides=s.$slideTrack.children(this.options.slide),s.$slideTrack.children(this.options.slide).detach(),s.$slideTrack.append(s.$slides),s.$slidesCache=s.$slides,s.reinit()},t.prototype.setCSS=function(e){var t,i,s=this,n={};!0===s.options.rtl&&(e=-e),t="left"==s.positionProp?Math.ceil(e)+"px":"0px",i="top"==s.positionProp?Math.ceil(e)+"px":"0px",n[s.positionProp]=e,!1===s.transformsEnabled?s.$slideTrack.css(n):(n={},!1===s.cssTransitions?(n[s.animType]="translate("+t+", "+i+")",s.$slideTrack.css(n)):(n[s.animType]="translate3d("+t+", "+i+", 0px)",s.$slideTrack.css(n)))},t.prototype.setDimensions=function(){var e=this;!1===e.options.vertical?!0===e.options.centerMode&&e.$list.css({"padding":"0px "+e.options.centerPadding}):(e.$list.height(e.$slides.first().outerHeight(!0)*e.options.slidesToShow),!0===e.options.centerMode&&e.$list.css({"padding":e.options.centerPadding+" 0px"})),e.listWidth=e.$list.width(),e.listHeight=e.$list.height(),!1===e.options.vertical&&!1===e.options.variableWidth?(e.slideWidth=Math.ceil(e.listWidth/e.options.slidesToShow),e.$slideTrack.width(Math.ceil(e.slideWidth*e.$slideTrack.children(".slick-slide").length))):!0===e.options.variableWidth?e.$slideTrack.width(5e3*e.slideCount):(e.slideWidth=Math.ceil(e.listWidth),e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0)*e.$slideTrack.children(".slick-slide").length)));var t=e.$slides.first().outerWidth(!0)-e.$slides.first().width();!1===e.options.variableWidth&&e.$slideTrack.children(".slick-slide").width(e.slideWidth-t)},t.prototype.setFade=function(){var t,i=this;i.$slides.each(function(s,n){t=i.slideWidth*s*-1,!0===i.options.rtl?e(n).css({"position":"relative","right":t,"top":0,"zIndex":i.options.zIndex-2,"opacity":0}):e(n).css({"position":"relative","left":t,"top":0,"zIndex":i.options.zIndex-2,"opacity":0})}),i.$slides.eq(i.currentSlide).css({"zIndex":i.options.zIndex-1,"opacity":1})},t.prototype.setHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.css("height",t)}},t.prototype.setOption=t.prototype.slickSetOption=function(){var t,i,s,n,o,a=this,l=!1;if("object"===e.type(arguments[0])?(s=arguments[0],l=arguments[1],o="multiple"):"string"===e.type(arguments[0])&&(s=arguments[0],n=arguments[1],l=arguments[2],"responsive"===arguments[0]&&"array"===e.type(arguments[1])?o="responsive":void 0!==arguments[1]&&(o="single")),"single"===o)a.options[s]=n;else if("multiple"===o)e.each(s,function(e,t){a.options[e]=t});else if("responsive"===o)for(i in n)if("array"!==e.type(a.options.responsive))a.options.responsive=[n[i]];else{for(t=a.options.responsive.length-1;t>=0;)a.options.responsive[t].breakpoint===n[i].breakpoint&&a.options.responsive.splice(t,1),t--;a.options.responsive.push(n[i])}l&&(a.unload(),a.reinit())},t.prototype.setPosition=function(){var e=this;e.setDimensions(),e.setHeight(),!1===e.options.fade?e.setCSS(e.getLeft(e.currentSlide)):e.setFade(),e.$slider.trigger("setPosition",[e])},t.prototype.setProps=function(){var e=this,t=document.body.style;e.positionProp=!0===e.options.vertical?"top":"left","top"===e.positionProp?e.$slider.addClass("slick-vertical"):e.$slider.removeClass("slick-vertical"),void 0===t.WebkitTransition&&void 0===t.MozTransition&&void 0===t.msTransition||!0===e.options.useCSS&&(e.cssTransitions=!0),e.options.fade&&("number"==typeof e.options.zIndex?e.options.zIndex<3&&(e.options.zIndex=3):e.options.zIndex=e.defaults.zIndex),void 0!==t.OTransform&&(e.animType="OTransform",e.transformType="-o-transform",e.transitionType="OTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.MozTransform&&(e.animType="MozTransform",e.transformType="-moz-transform",e.transitionType="MozTransition",void 0===t.perspectiveProperty&&void 0===t.MozPerspective&&(e.animType=!1)),void 0!==t.webkitTransform&&(e.animType="webkitTransform",e.transformType="-webkit-transform",e.transitionType="webkitTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.msTransform&&(e.animType="msTransform",e.transformType="-ms-transform",e.transitionType="msTransition",void 0===t.msTransform&&(e.animType=!1)),void 0!==t.transform&&!1!==e.animType&&(e.animType="transform",e.transformType="transform",e.transitionType="transition"),e.transformsEnabled=e.options.useTransform&&null!==e.animType&&!1!==e.animType},t.prototype.setSlideClasses=function(e){var t,i,s,n,o=this;if(i=o.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),o.$slides.eq(e).addClass("slick-current"),!0===o.options.centerMode){var a=o.options.slidesToShow%2==0?1:0;t=Math.floor(o.options.slidesToShow/2),!0===o.options.infinite&&(e>=t&&e<=o.slideCount-1-t?o.$slides.slice(e-t+a,e+t+1).addClass("slick-active").attr("aria-hidden","false"):(s=o.options.slidesToShow+e,i.slice(s-t+1+a,s+t+2).addClass("slick-active").attr("aria-hidden","false")),0===e?i.eq(i.length-1-o.options.slidesToShow).addClass("slick-center"):e===o.slideCount-1&&i.eq(o.options.slidesToShow).addClass("slick-center")),o.$slides.eq(e).addClass("slick-center")}else e>=0&&e<=o.slideCount-o.options.slidesToShow?o.$slides.slice(e,e+o.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):i.length<=o.options.slidesToShow?i.addClass("slick-active").attr("aria-hidden","false"):(n=o.slideCount%o.options.slidesToShow,s=!0===o.options.infinite?o.options.slidesToShow+e:e,o.options.slidesToShow==o.options.slidesToScroll&&o.slideCount-e<o.options.slidesToShow?i.slice(s-(o.options.slidesToShow-n),s+n).addClass("slick-active").attr("aria-hidden","false"):i.slice(s,s+o.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==o.options.lazyLoad&&"anticipated"!==o.options.lazyLoad||o.lazyLoad()},t.prototype.setupInfinite=function(){var t,i,s,n=this;if(!0===n.options.fade&&(n.options.centerMode=!1),!0===n.options.infinite&&!1===n.options.fade&&(i=null,n.slideCount>n.options.slidesToShow)){for(s=!0===n.options.centerMode?n.options.slidesToShow+1:n.options.slidesToShow,t=n.slideCount;t>n.slideCount-s;t-=1)i=t-1,e(n.$slides[i]).clone(!0).attr("id","").attr("data-slick-index",i-n.slideCount).prependTo(n.$slideTrack).addClass("slick-cloned");for(t=0;t<s+n.slideCount;t+=1)i=t,e(n.$slides[i]).clone(!0).attr("id","").attr("data-slick-index",i+n.slideCount).appendTo(n.$slideTrack).addClass("slick-cloned");n.$slideTrack.find(".slick-cloned").find("[id]").each(function(){e(this).attr("id","")})}},t.prototype.interrupt=function(e){var t=this;e||t.autoPlay(),t.interrupted=e},t.prototype.selectHandler=function(t){var i=this,s=e(t.target).is(".slick-slide")?e(t.target):e(t.target).parents(".slick-slide");if(!s.hasClass("slick-current")){var n=parseInt(s.attr("data-slick-index"));if(n||(n=0),i.slideCount<=i.options.slidesToShow)return void i.slideHandler(n,!1,!0);i.slideHandler(n)}},t.prototype.slideHandler=function(t,i,s){var n,o,a,l,r,c=null,d=this;if(i=i||!1,!(!0===d.animating&&!0===d.options.waitForAnimate||!0===d.options.fade&&d.currentSlide===t)){if(!1===i&&d.asNavFor(t),n=t,l=d.getLeft(d.currentSlide),d.currentLeft=null===d.swipeLeft?l:d.swipeLeft,!1===d.options.infinite&&!1===d.options.centerMode&&(t<0||t>d.getDotCount()*d.options.slidesToScroll))return void(!1===d.options.fade&&(n=d.currentSlide,!0!==s&&d.slideCount>d.options.slidesToShow?d.animateSlide(l,function(){d.postSlide(n)}):d.postSlide(n)));if(!1===d.options.infinite&&!0===d.options.centerMode&&(t<0||t>d.slideCount-d.options.slidesToScroll))return void(!1===d.options.fade&&(n=d.currentSlide,!0!==s&&d.slideCount>d.options.slidesToShow?d.animateSlide(l,function(){d.postSlide(n)}):d.postSlide(n)));if(d.options.autoplay&&clearInterval(d.autoPlayTimer),o=n<0?d.slideCount%d.options.slidesToScroll!=0?d.slideCount-d.slideCount%d.options.slidesToScroll:d.slideCount+n:n>=d.slideCount?d.slideCount%d.options.slidesToScroll!=0?0:n-d.slideCount:n,d.animating=!0,d.$slider.trigger("beforeChange",[d,d.currentSlide,o]),a=d.currentSlide,d.currentSlide=o,d.setSlideClasses(d.currentSlide),e(".slick-slide.slick-next-slide-adjust").removeClass("slick-next-slide-adjust"),e(".slick-slide.slick-prev-slide-adjust").removeClass("slick-prev-slide-adjust"),c=d.getLeft(n),d.slidesAdjust(),d.options.asNavFor&&(r=d.getNavTarget(),r=r.slick("getSlick"),r.slideCount<=r.options.slidesToShow&&r.setSlideClasses(d.currentSlide)),d.updateDots(),d.updateArrows(),!0===d.options.fade)return!0!==s?(d.fadeSlideOut(a),d.fadeSlide(o,function(){d.postSlide(o)})):d.postSlide(o),void d.animateHeight();!0!==s&&d.slideCount>d.options.slidesToShow?d.animateSlide(c,function(){d.postSlide(o)}):d.postSlide(o)}},t.prototype.startLoad=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.hide(),e.$nextArrow.hide()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.hide(),e.$slider.addClass("slick-loading")},t.prototype.swipeDirection=function(){var e,t,i,s,n=this;return e=n.touchObject.startX-n.touchObject.curX,t=n.touchObject.startY-n.touchObject.curY,i=Math.atan2(t,e),s=Math.round(180*i/Math.PI),s<0&&(s=360-Math.abs(s)),s<=45&&s>=0?!1===n.options.rtl?"left":"right":s<=360&&s>=315?!1===n.options.rtl?"left":"right":s>=135&&s<=225?!1===n.options.rtl?"right":"left":!0===n.options.verticalSwiping?s>=35&&s<=135?"down":"up":"vertical"},t.prototype.swipeEnd=function(e){var t,i,s=this;if(s.dragging=!1,s.swiping=!1,s.scrolling)return s.scrolling=!1,!1;if(s.interrupted=!1,s.shouldClick=!(s.touchObject.swipeLength>10),void 0===s.touchObject.curX)return!1;if(!0===s.touchObject.edgeHit&&s.$slider.trigger("edge",[s,s.swipeDirection()]),s.touchObject.swipeLength>=s.touchObject.minSwipe){switch(i=s.swipeDirection()){case"left":case"down":t=s.options.swipeToSlide?s.checkNavigable(s.currentSlide+s.getSlideCount()):s.currentSlide+s.getSlideCount(),s.currentDirection=0;break;case"right":case"up":t=s.options.swipeToSlide?s.checkNavigable(s.currentSlide-s.getSlideCount()):s.currentSlide-s.getSlideCount(),s.currentDirection=1}"vertical"!=i&&(s.slideHandler(t),s.touchObject={},s.$slider.trigger("swipe",[s,i]))}else s.touchObject.startX!==s.touchObject.curX&&(s.slideHandler(s.currentSlide),s.touchObject={})},t.prototype.swipeHandler=function(e){var t=this;if(!(!1===t.options.swipe||"ontouchend"in document&&!1===t.options.swipe||!1===t.options.draggable&&-1!==e.type.indexOf("mouse")))switch(t.touchObject.fingerCount=e.originalEvent&&void 0!==e.originalEvent.touches?e.originalEvent.touches.length:1,t.touchObject.minSwipe=t.listWidth/t.options.touchThreshold,!0===t.options.verticalSwiping&&(t.touchObject.minSwipe=t.listHeight/t.options.touchThreshold),e.data.action){case"start":t.swipeStart(e);break;case"move":t.swipeMove(e);break;case"end":t.swipeEnd(e)}},t.prototype.swipeMove=function(e){var t,i,s,n,o,a,l=this;return o=void 0!==e.originalEvent?e.originalEvent.touches:null,!(!l.dragging||l.scrolling||o&&1!==o.length)&&(t=l.getLeft(l.currentSlide),l.touchObject.curX=void 0!==o?o[0].pageX:e.clientX,l.touchObject.curY=void 0!==o?o[0].pageY:e.clientY,l.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(l.touchObject.curX-l.touchObject.startX,2))),a=Math.round(Math.sqrt(Math.pow(l.touchObject.curY-l.touchObject.startY,2))),!l.options.verticalSwiping&&!l.swiping&&a>4?(l.scrolling=!0,!1):(!0===l.options.verticalSwiping&&(l.touchObject.swipeLength=a),i=l.swipeDirection(),void 0!==e.originalEvent&&l.touchObject.swipeLength>4&&(l.swiping=!0,e.preventDefault()),n=(!1===l.options.rtl?1:-1)*(l.touchObject.curX>l.touchObject.startX?1:-1),!0===l.options.verticalSwiping&&(n=l.touchObject.curY>l.touchObject.startY?1:-1),s=l.touchObject.swipeLength,l.touchObject.edgeHit=!1,!1===l.options.infinite&&(0===l.currentSlide&&"right"===i||l.currentSlide>=l.getDotCount()&&"left"===i)&&(s=l.touchObject.swipeLength*l.options.edgeFriction,l.touchObject.edgeHit=!0),!1===l.options.vertical?l.swipeLeft=t+s*n:l.swipeLeft=t+s*(l.$list.height()/l.listWidth)*n,!0===l.options.verticalSwiping&&(l.swipeLeft=t+s*n),!0!==l.options.fade&&!1!==l.options.touchMove&&(!0===l.animating?(l.swipeLeft=null,!1):void l.setCSS(l.swipeLeft))))},t.prototype.swipeStart=function(e){var t,i=this;if(i.interrupted=!0,1!==i.touchObject.fingerCount||i.slideCount<=i.options.slidesToShow)return i.touchObject={},!1;void 0!==e.originalEvent&&void 0!==e.originalEvent.touches&&(t=e.originalEvent.touches[0]),i.touchObject.startX=i.touchObject.curX=void 0!==t?t.pageX:e.clientX,i.touchObject.startY=i.touchObject.curY=void 0!==t?t.pageY:e.clientY,i.dragging=!0},t.prototype.unfilterSlides=t.prototype.slickUnfilter=function(){var e=this;null!==e.$slidesCache&&(e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.appendTo(e.$slideTrack),e.reinit())},t.prototype.unload=function(){var t=this;e(".slick-cloned",t.$slider).remove(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove(),t.$nextArrow&&t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove(),t.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},t.prototype.unslick=function(e){var t=this;t.$slider.trigger("unslick",[t,e]),t.destroy()},t.prototype.updateArrows=function(){var e=this;Math.floor(e.options.slidesToShow/2),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&!e.options.infinite&&(e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===e.currentSlide?(e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode?(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-1&&!0===e.options.centerMode&&(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},t.prototype.updateDots=function(){var e=this;null!==e.$dots&&(e.$dots.find("li").removeClass("slick-active").end(),e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active"))},t.prototype.visibility=function(){var e=this;e.options.autoplay&&(document[e.hidden]?e.interrupted=!0:e.interrupted=!1)},e.fn.slick=function(){var e,i,s=this,n=arguments[0],o=Array.prototype.slice.call(arguments,1),a=s.length;for(e=0;e<a;e++)if("object"==typeof n||void 0===n?s[e].slick=new t(s[e],n):i=s[e].slick[n].apply(s[e].slick,o),void 0!==i)return i;return s},t.prototype.slidesAdjust=function(){var t=this;e(".slick-slide.slick-next-slide-adjust").removeClass("slick-next-slide-adjust"),e(".slick-slide.slick-prev-slide-adjust").removeClass("slick-prev-slide-adjust")
;var i=e(t.$slides.get(t.currentSlide));i.next().addClass("slick-next-slide-adjust"),i.prev().addClass("slick-prev-slide-adjust")}}(e)}()}),csui.define("esoc/widgets/userwidget/userwidget",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/connector","esoc/controls/userwidget/userwidget.view","csui/utils/contexts/factories/connector"],function(e,t,i,s,n,o,a,l){return{"getUser":function(e){i(e.placeholder).ready(function(){var o,r=new n.Region({"el":i(e.placeholder)});e.connector||(e.connector=e.context.getObject(l));var c=s.extend({},e);a=a||t("esoc/controls/userwidget/userwidget.view"),o=new a(c),r.show(o)})}}}),csui.define("esoc/widgets/userwidget/util",["require","module","csui/lib/jquery","csui/lib/marionette","csui/lib/underscore","csui/utils/contexts/factories/connector","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/common/util","esoc/widgets/utils/chat/chat.view","esoc/widgets/userwidget/chat/view/presence.view","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model","csui/controls/dialog/dialog.view","csui/utils/non-emptying.region/non-emptying.region","esoc/controls/dialog/multiple.dialogs.view","esoc/lib/slick/slick","csui/utils/url","esoc/widgets/userwidget/userwidget","esoc/widgets/userwidget/chat/chatfactory","esoc/factory/pulsesettingsfactory"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v,b){return{"lang":a,"commonUtil":l,"userDialog":null,"userStack":[],"updateAjaxCall":function(e){var t=this,n=e.itemview,a=e.context,d=e.url,u=e.requestType,m=e.relation,p=e.otherUserProfile,h=e.targetElement,g=e.data,v=e.popOverTarget,w=e.type,y=e.connector?e.connector:n.options.context?n.options.context.getObject(o):n.model.connector;e.userProfileview,e.newValue;y.authenticator.syncStorage(),y.makeAjaxCall({"url":d,"type":w,"data":g,"contentType":!1,"crossDomain":!0,"processData":!1,"success":function(e,o,d){switch(u){case"membersAPI":var g=e.data;if(p)g.otherUser=!1,g.actions={"viewprofile":t.lang.viewprofile};else if(m===l.globalConstants.FRIENDS){var w={"following":!0,"selfUser":!1,"relation":m,"otherUserProfile":p};t.setRelationModel(e.data,w)}a.getModel(b,{"attributes":{"id":"chat"},"options":{"chat":!0},"permanent":!0}).ensureFetched().done(function(e){g.chatSettings=e.attributes.chatSettings,n.collection.add(g)});var y={"id":g.id,"username":g.name,"context":a},x=new s.Region({"el":n.$el.find("#esoc-mini-profile-presence-indicator")}),_=new c(y);x.show(_),n.collection.trigger("add.follower");break;case"pulseInfo":var C=e.results;n.util.changeRelationsCounts(C);var E=n.util.commonUtil.globalConstants.event_bus._events;E&&E.updatefollowerstab&&E.updatefollowerstab.length>0&&(E.updatefollowerstab=E.updatefollowerstab.slice(-1)),n.util.commonUtil.globalConstants.event_bus.trigger("updatefollowerstab",n,C);break;case"miniProfilePopup":var k=e.results,S=h.find(".esoc-miniprofile-followingaction");i(v).binf_popover("hide"),n.model.attributes.following=!n.model.attributes.following,n.model.attributes.following?S.attr("title",t.lang.unfollow):S.attr("title",t.lang.follow),n.model.attributes.following?h.find(".esoc-miniprofile-followingaction").removeClass("esoc-mini-profile-follow-icon").addClass("esoc-mini-profile-unfollow-icon"):h.find(".esoc-miniprofile-followingaction").removeClass("esoc-mini-profile-unfollow-icon").addClass("esoc-mini-profile-follow-icon");var T=n.util.commonUtil.globalConstants.event_bus._events;T&&T.changefollowingstatus&&T.changefollowingstatus.length>0&&(T.changefollowingstatus=T.changefollowingstatus.slice(-1)),T&&T.updateuserfollowingstatus&&T.updateuserfollowingstatus.length>0&&(T.updateuserfollowingstatus=T.updateuserfollowingstatus.slice(-1)),n.util.commonUtil.globalConstants.event_bus.trigger("changefollowingstatus",n,k),n.util.commonUtil.globalConstants.event_bus.trigger("updateuserfollowingstatus",n,k);break;case"userProfileFollowingAction":var M=e.results;n.model.attributes.following=!n.model.attributes.following,n.model.attributes.following?h.html(t.lang.unfollow):h.html(t.lang.follow),n.$el.find(".esoc-userprofile-following-action").attr("title",n.model.attributes.following?t.lang.unfollow:t.lang.follow),n.model.attributes.followers_count=M.data.user.followers_count,n.model.attributes.following_count=M.data.user.following_count;var A=f.combine(l.getV2Url(n.options.connector.connection.url),t.commonUtil.REST_URLS.pulseRestUrl,n.model.attributes.id),I={"itemview":n,"url":A,"type":"GET","requestType":"pulseInfo"};t.updateAjaxCall(I);break;case"relation":var U=e.results;n.model.attributes.following=!n.model.attributes.following,n.model.attributes.following?(n.model.attributes.actions.following=t.lang.unfollow,n.model.attributes.actions.followingClass="esoc-mini-profile-unfollow-icon"):(n.model.attributes.actions.following=t.lang.follow,n.model.attributes.actions.followingClass="esoc-mini-profile-follow-icon"),n.model.attributes.otherUserProfile||n.util.changeRelationsCounts(U.data.user);var P=!1;if(n.$el.find(".esoc-mini-profile-actions").hasClass("esoc-miniprofile-has-tabindex")&&(P=!0),n.render(),n.showActions(),n.setProfilePic(),n.$el.find(".esoc-mini-profile-following-action").trigger("focus"),P&&n.$el.find(".esoc-mini-profile-actions").addClass("esoc-miniprofile-has-tabindex"),n.options.model.attributes.relation===l.globalConstants.FRIENDS&&!n.options.model.attributes.otherUserProfile){var $=n.options.model.collection;$.remove(n.model.attributes.id),$.trigger("remove.relation",n,U)}break;case"miniProfileActionsDisplay":var j=JSON.parse(JSON.stringify(e.results));if(n.model.attributes.following=j.following,n.model.attributes.chatSettings=j.chatSettings,i(".esoc-mini-profile-popover .esoc-mini-profile-loading-img").hide(),n.model.attributes.following?i(".esoc-mini-profile-popover .esoc-mini-profile-following-action").find(".esoc-miniprofile-followingaction").removeClass("esoc-mini-profile-follow-icon").addClass("esoc-mini-profile-unfollow-icon").attr("title",t.lang.unfollow):i(".esoc-mini-profile-popover .esoc-mini-profile-following-action").find(".esoc-miniprofile-followingaction").removeClass("esoc-mini-profile-unfollow-icon").addClass("esoc-mini-profile-follow-icon").attr("title",t.lang.follow),n.options.model.attributes.otherUser&&!n.options.model.attributes.deleted&&j.chatSettings&&j.chatSettings.chatEnabled){i(".esoc-mini-profile-popover .esoc-mini-profile-actions").show(),i(".esoc-mini-profile-popover .esoc-chat-action-enabled-"+n.model.attributes.id).removeClass("binf-hidden");var R=new s.Region({"el":i(".esoc-mini-profile-popover .esoc-miniprofile-chat-action-"+n.model.attributes.id)}),O={"context":n.options.context,"tguser":n.options.model.attributes.name,"domain":j.chatSettings.chatDomain},D=new r(O);R.show(D),i(".esoc-simple-mini-profile-user-img .esoc-mini-profile-chat-comment").css("display","inline-block"),i(".esoc-mini-profile-chat-comment").on("click",function(e){n.options.tguser=n.options.model.get("name"),n.options.domain=n.options.model.get("chatSettings")&&n.options.model.get("chatSettings").chatDomain,n.launchChatWindow(n)})}else i(".esoc-mini-profile-popover .esoc-mini-profile-actions").show(),i(".esoc-mini-profile-popover .esoc-chat-action-disabled-"+n.model.attributes.id).removeClass("binf-hidden");break;case"updateSettings":h.prop("disabled",!1),h.trigger("focus");break;case"updateExtendedTextField":n.model.attributes.userInputField?(n.model.attributes.content=void 0!==n.managerID?n.managerID:n.model.attributes.content,n.model.attributes.reportsTo=n.$el.find(".esoc-user-extended-edit-input").val().trim()?n.$el.find(".esoc-user-extended-edit-input").val():""):n.model.attributes.content=n.$el.find(".esoc-user-extended-edit-input").val().trim()?n.$el.find(".esoc-user-extended-edit-input").val():"",n.render(),n.model.attributes.userInputField?(n.on("view:shown",function(){n.trigger("change:content","userInputChanged")}),n.isUserModelLoaded&&n.trigger("change:content","userInputChanged")):n.trigger("change:content"),n.showSeeMoreLink(),n.model.attributes.content?n.$el.find(".esoc-user-messages").trigger("focus"):n.$el.find(".esoc-user-default-content").trigger("focus"),n.options.parentView.triggerMethod("update:scrollbar");break;case"postStatus":n.$el.find(".esoc-user-extended-edit-input")[0].innerHTML=n.$el.find(".esoc-user-extended-edit-input").val(),n.model.attributes.content=n.$el.find(".esoc-user-extended-edit-input").val().trim()?n.$el.find(".esoc-user-extended-edit-input").html():n.model.attributes.content,n.render(),n.trigger("change:content"),n.showSeeMoreLink(),n.model.attributes.content?n.$el.find(".esoc-user-messages").trigger("focus"):n.$el.find(".esoc-user-default-content").trigger("focus");break;case"updateExtendedLink":var L=n.$el.find(".esoc-user-extended-edit-input").val();n.model.attributes.content=t.getValidLink(L),n.render(),n.trigger("change:content"),n.addEllipsisOnFocus(),n.model.attributes.content?n.$el.find(".esoc-user-messages a").trigger("focus"):n.$el.find(".esoc-user-default-content").trigger("focus")}},"error":function(e,s,o){switch(u){case"miniProfilePopup":i(v).binf_popover("hide");var a={"parent":h,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:t.lang.defaultErrorMessageForMiniProfilePopup};t.commonUtil.openErrorDialog(a);break;case"relation":var l={"parent":h,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:t.lang.defaultErrorMessageForRelation};t.commonUtil.openErrorDialog(l);break;case"miniProfileActionsDisplay":var r=e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error;i(".esoc-mini-profile-popover .esoc-mini-profile-loading-img").hide(),i(".esoc-mini-profile-popover .esoc-mini-profile-following-error").html(r),i(".esoc-mini-profile-popover .esoc-mini-profile-following-error").attr("title",r),i(".esoc-mini-profile-popover .esoc-mini-profile-following-error").show(),i(".esoc-mini-profile-popover .esoc-mini-profile-actions").hide();break;case"updateSettings":var c={"parent":h,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:t.lang.defaultErrorMessageForUpdateSettings};t.commonUtil.openErrorDialog(c);var d=h.val();if("privacySettings"===h.attr("name")){var m=n.$el.find("#"+h.attr("id")+"_radio"),p=n.$el.find("#esoc_privacySettings_"+n.model.attributes.settings.contentPrivacy+"_radio");m.addClass("icon-radiobutton").removeClass("icon-radiobutton-selected"),p.addClass("icon-radiobutton-selected").removeClass("icon-radiobutton"),h.prop("checked",!1),n.$el.find("#esoc_privacySettings_"+n.model.attributes.settings.contentPrivacy).prop("checked",!0)}else{var f=n.$el.find("#"+h.attr("id")+"_checkbox");n.model.attributes.settings&&n.model.attributes.settings.hasOwnProperty(d)?f.addClass("icon-checkbox-selected").removeClass("icon-checkbox"):f.addClass("icon-checkbox").removeClass("icon-checkbox-selected"),h.prop("checked",n.model.attributes.settings.hasOwnProperty(d))}h.prop("disabled",!1),h.trigger("focus");break;case"updateExtendedTextField":case"postStatus":var g={"parent":h,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:"postStatus"===u?t.lang.defaultErrorMessageForStatusPost:t.lang.defaultErrorMessageForUpdateExtentedField};t.commonUtil.openErrorDialog(g),n.$el.find(".esoc-user-extended-edit-mode").removeClass("esoc-extendedinfo-update-mask"),n.$el.find(".esoc-user-extended-edit-input").prop("disabled",!1),n.model.attributes.content?n.$el.find(".esoc-user-messages").trigger("focus"):n.$el.find(".esoc-user-default-content").trigger("focus");break;case"updateExtendedLink":var b={"parent":h,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:t.lang.defaultErrorMessageForUpdateExtentedLink};t.commonUtil.openErrorDialog(b),n.$el.find(".esoc-user-extended-edit-mode").removeClass("esoc-extendedinfo-update-mask"),n.$el.find(".esoc-user-extended-edit-input").prop("disabled",!1),n.model.attributes.content?n.$el.find(".esoc-user-messages a").trigger("focus"):n.$el.find(".esoc-user-default-content").trigger("focus");break;case"userProfileFollowingAction":var w={"parent":h,"errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:t.lang.defaultErrorMessageForUserProfileActionLink};t.commonUtil.openErrorDialog(w)}}})},"closeUserWidgetDialog":function(){i(".esoc-user-widget-dialog").is(":visible")&&i(".esoc-user-widget-dialog .cs-close").trigger("click")},"showUserProfileDialog":function(t,s,o){if(t.templateHelpers().messages.showUserProfileLink){var l,r;t.$el.find(".esoc-user-mini-profile").binf_popover("hide"),t.$el.find(".esoc-user-display-name").attr("aria-describedby")&&i(".esoc-mini-profile-popover.popover").remove(),clearTimeout(t.profileTimer),this.commonUtil.unbindWidget();var c=t.$el.offsetParent(),h=i(c).closest(".binf-popover");c&&c.offsetParent&&1===h.length&&h.hide(),i(".activityfeed-expand").is(":visible")&&i(".activityfeed-expand .cs-close").trigger("click"),this.userDialog&&!t.options.enableSimpleSettingsModel&&this.userDialog.destroy(),this.userStack.length>0&&this.userStack[this.userStack.length-1].model.id===t.model.id&&this.userStack.pop(),r=t.options.model.attributes.otherUser?n.str.sformat(t.templateHelpers().messages.othersProfile,t.model.attributes.display_name?t.model.attributes.display_name:t.options.display_name):t.templateHelpers().messages.myProfile,t.options.userWidgetView=t;var f=this;if(t.options.enableSimpleSettingsModel){if(this.userDialog){if(0!==i(".binf-modal-dialog.user"+t.options.userid).length)return void(i(".slick-slide").length>0&&i(i(".slick-slide")[i(".binf-modal-dialog.user"+t.options.userid).parents(".slick-slide")[0].dataset.slickIndex]).trigger("click"));this.removeSlick(),this.simpleUserWidgetViews.push(new o(t.options)),this.userDialog.appendData(this.simpleUserWidgetViews)}else{this.simpleUserWidgetViews=[],this.simpleUserWidgetViews.push(new o(t.options)),this.userDialog=new p({"largeSize":!0,"views":this.simpleUserWidgetViews,"util":this,"className":"esoc-simple-user-widget-dialog esoc","targetEle":t.options.targetEle,"focusCallBack":t.options.focusCallBack});var g=i.fn.binf_modal.getDefaultContainer();new m({"el":g}).show(this.userDialog),this.userDialog.$el.css("display","block")}this.userDialog.$el.find(".binf-modal-header").remove(),this.userDialog.listenTo(this.userDialog,"destroy",function(){f.simpleUserWidgetViews&&1===f.simpleUserWidgetViews.length&&f.simpleUserWidgetViews[0].trigger("destroy"),f.userDialog=null,f.simpleUserWidgetViews=null}),this.simpleUserWidgetViews.length>=2&&this.userDialog.options.views[this.simpleUserWidgetViews.length-2].$el.find(".cs-field-read-content").trigger("focusout"),this.applySlick()}else l=new s(t.options),this.userDialog=new u({"title":r,"iconLeft":this.userStack.length>0?"arrow_back esoc-user-widget-dialog-back":"","largeSize":!0,"view":l,"className":"esoc-user-widget-dialog esoc","iconRight":"binf-close esoc-user-widget-dialog-close"}),this.userDialog.show();this.userStack.length>0&&(r=this.userStack[this.userStack.length-1].model.attributes.otherUser?n.str.sformat(a.othersProfileTooltip,this.userStack[this.userStack.length-1].model.attributes.display_name?this.userStack[this.userStack.length-1].model.attributes.display_name:t.options.display_name):this.userStack[this.userStack.length-1].templateHelpers().messages.myProfile,i("span.tile-type-icon.cs-icon-left.arrow_back.esoc-user-widget-dialog-back").attr("title",a.goBackTo+" "+r)),i(".esoc-user-widget-dialog-back").on("click",function(){var e=f.userStack.pop();e.model.id===t.model.id&&(e=f.userStack.pop()),f.showUserProfileDialog(e,s,o)}),i(".esoc-user-widget-dialog .cs-close").on("click",function(){f.userStack=[]}),0===this.userStack.length&&this.userStack.push(t),t.on("userwidgetview.show.user.dialog",function(t){var i=e("esoc/controls/userwidget/userwidget.view"),a=n.extend({},this.options);t.options.userid=t.options.model.id;var l=n.extend(a,t.options);delete l.model,l.display_name=t.options.model.attributes.display_name;var r=new i(l);r.showUserProfileDialog(r,s,o)}),d.getChatEnabled()&&d.getPresenceEnabled()&&!d.isPluginEnabled()&&i(".cs-close").on("click",function(e){-1!==i.inArray("esoc-user-widget-dialog-close",e.target.classList)&&d.getCurrentSubscriptionURL()&&v.getProvider().deleteSubscription(d.getCurrentSubscriptionURL())})}},"applySlick":function(e){i(".binf-modal-dialog").length>1?(i(".binf-modal-dialog").find(".cs-close").addClass("slick-close"),i(".modal-dialogs-inner").slick({"centerMode":!0,"easing":"easeOutElastic","focusOnSelect":!0,"focusOnChange":!0,"initialSlide":void 0!==e?e:this.simpleUserWidgetViews.length-1,"variableWidth":!0,"speed":500,"swipe":!1,"infinite":!1,"prevArrow":'<div class="slick-prev" title='+a.previous+" aria-label="+a.previous+"/>","nextArrow":'<div class="slick-next" title='+a.next+" aria-label="+a.next+"/>"})):(i(".binf-modal-dialog").find("[data-cstabindex=-1]").attr("tabindex","0").attr("data-cstabindex","0"),i(".binf-modal-dialog").find(".cs-close").removeClass("slick-close"))},"removeSlick":function(){i(".slick-list").length>0&&i(".modal-dialogs-inner").slick("unslick")},"getValidLink":function(e){var t=/((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi;return e&&null!==e.match(t)?e:""},"displayUserWidget":function(t,s){s.find(".esoc-widget-user-display-name").each(function(){var s={"userid":i(this).data("userid"),"context":t,"placeholder":this,"showUserProfileLink":!0,"showMiniProfile":!0};g=g||e("esoc/widgets/userwidget/userwidget"),g.getUser(s)})},"changeRelationsCounts":function(e){var t=e.friends_count>999?"999+":e.friends_count,s=e.followers_count>999?"999+":e.followers_count;i(".esoc-user-following-count").html(t),i(".esoc-user-following-tab-label").attr("title",n.str.sformat(this.lang.followingTooltip,e.friends_count)),i(".esoc-user-followers-count").html(s),i(".esoc-user-followers-tab-label").attr("title",n.str.sformat(this.lang.followersTooltip,e.followers_count))},"setRelationModel":function(e,t){e.relation=t.relation,e.following=t.following,e.otherUserProfile=t.otherUserProfile,t.selfUser?(e.actions={"viewprofile":this.lang.viewprofile},e.otherUser=!1):(e.otherUser=!0,t.following?e.actions={"following":this.lang.unfollow,"viewprofile":this.lang.viewprofile,"chat":this.lang.chat,"followingClass":"esoc-mini-profile-unfollow-icon"}:e.actions={"following":this.lang.follow,"viewprofile":this.lang.viewprofile,"chat":this.lang.chat,"followingClass":"esoc-mini-profile-follow-icon"})},"escapeSelector":function(e){var t=/^([a-zA-Z0-9_-]+)$/;return n.isNumber(e)||e.match(t)?e:e.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1")}}}),csui.define("css!esoc/widgets/userwidget/impl/userwidget",[],function(){}),csui.define("esoc/widgets/userwidget/view/miniprofile.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","csui/utils/user.avatar.color","i18n!esoc/widgets/userwidget/nls/lang","hbs!esoc/widgets/userwidget/impl/miniprofile","esoc/widgets/common/util","esoc/widgets/userwidget/util","esoc/widgets/utils/chat/impl/util","esoc/widgets/userwidget/chat/view/presence.view","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m){var p=e.config();return i.defaults(p,{"hideFollow":!1}),n.ItemView.extend({"commonUtil":c,"util":d,"className":"esoc-miniprofile-view","template":r,"ui":{"initialsPlaceholder":".image_user_placeholder"},"templateHelpers":function(){var e=void 0!==this.options.showPresenceIndicator&&this.options.showPresenceIndicator;return{"messages":{"enableSimpleSettingsModel":!!this.options.enableSimpleSettingsModel,"showPresenceIndicator":e,"viewprofile":l.viewprofile,"unfollow":l.unfollow,"follow":l.follow,"chat":l.chat,"following":this.options.model.attributes.following?"esoc-mini-profile-unfollow-icon":"esoc-mini-profile-follow-icon"}}},"initialize":function(e){this.options=e,this.followUnfollowActionUrl=o.combine(d.commonUtil.getV2Url(this.options.connector.connection.url),d.commonUtil.REST_URLS.pulseRestUrl,this.model.id)},"constructor":function(t){t=t||{},n.ItemView.prototype.constructor.call(this,t),this.model.id||(this.model.id=this.model.get("id"));var i=e.config();i&&(this.options.enableSimpleSettingsModel=i.enableSimpleUserProfile)},"getParentView":function(){return this.options.userWidgetView},"getElementOffset":function(e){return e.is(":visible")?e.offset():{"top":0,"left":0}},"onRender":function(e){var i=this.options.targetEle,s=this.options.model.attributes,c=s.following?this.templateHelpers().messages.unfollow:this.templateHelpers().messages.follow,u=(t(i).attr("id"),{"id":s.id,"display_name":s.display_name,"office_location":s.office_location,"business_email":s.business_email,"business_phone":s.business_phone,"business_phone_label":l.simpleUserProfilePhoneLabel,"cell_phone_label":l.simpleUserProfileMobile,"cell_phone":s.cell_phone,"title":s.title,"showPresenceIndicator":this.templateHelpers().messages.showPresenceIndicator,"otherUser":s.otherUser,"hideFollow":p.hideFollow,"deleted":s.deleted,"initials":s.initials,"actions":{"viewprofile":this.templateHelpers().messages.viewprofile,"following":c,"chat":this.templateHelpers().messages.chat},"enableSimpleSettingsModel":this.templateHelpers().messages.enableSimpleSettingsModel}),h=this.template(u),f=this;this.options.userbackgroundcolor=a.getUserAvatarColor(this.model.attributes),t(i).binf_popover({"content":h,"placement":function(e){t(e).addClass("esoc-mini-profile-popover esoc"),u.enableSimpleSettingsModel&&t(e).addClass("esoc-simple-mini-profile-popover");var s=t("<div/>").attr("style","display:none").addClass("esoc-mini-profile-popover binf-popover esoc-mini-profile-temp-div").append(r);t(i).append(s);var n=t(".esoc-mini-profile-temp-div").height()+40,o=t(".esoc-mini-profile-temp-div").width()+40;s.remove();var a=t(i),l=f.getElementOffset(a),c=l.left,d=l.top,m=t(window).width()-(c+a.outerWidth());return t(window).height()-(d+a.outerHeight(!0))>n?"bottom":m>o?"right":c>o?"left":d>n?"top":"auto"},"html":!0,"trigger":"manual","container":t.fn.binf_modal.getDefaultContainer()}),t(i).off("mouseenter").on("mouseenter",function(e){var s=f.getParentView();clearTimeout(s.profileTimer),f.options.originatingView&&f.options.originatingView.disengageModalKeyboardFocusOnClose&&f.options.originatingView.disengageModalKeyboardFocusOnClose();var n=setTimeout(function(){t(i).binf_popover("show")},1e3);s.profileTimer=n}),t(i).off("mouseleave").on("mouseleave",function(e){var t=f.getParentView();clearTimeout(t.profileTimer)}),t(i).off("shown.binf.popover").on("shown.binf.popover",function(e){var s={"id":f.model.attributes.id,"username":f.model.attributes.name,"context":f.options.context},a=new n.Region({"el":t(".esoc-mini-profile-popover #esoc-mini-profile-presence-indicator")}),l=new m(s);if(a.show(l),t(".esoc-mini-profile-popover .esoc-mini-profile-following-action").off("click").on("click",function(e){var s=new FormData,n=f.model.attributes.following?d.commonUtil.globalConstants.UNFOLLOW:d.commonUtil.globalConstants.FOLLOW;s.append(d.commonUtil.globalConstants.ACTION,n);var o={"itemview":f,"url":f.followUnfollowActionUrl,"type":"POST","data":s,"requestType":"miniProfilePopup","targetElement":t(this),"popOverTarget":i};f.util.updateAjaxCall(o)}),t(".esoc-mini-profile-popover .esoc-viewminiprofile-action,.esoc-mini-profile-popover .esoc-mini-profile-user-name,.esoc-mini-profile-popover .esoc-mini-profile-pic").off("click").on("click",function(e){e.stopPropagation(),f.options.userWidgetView.showUserProfileDialog(e)}),f.model.attributes.otherUser){var r=o.combine(d.commonUtil.getV2Url(f.options.connector.connection.url),d.commonUtil.REST_URLS.pulseRestUrl,f.model.id);r=d.commonUtil.updateQueryStringValues(r,d.commonUtil.globalConstants.FIELDS,d.commonUtil.globalConstants.CHAT_SEETING);var c={"itemview":f,"url":r,"type":"GET","requestType":"miniProfileActionsDisplay"};f.util.updateAjaxCall(c)}else t(".esoc-mini-profile-popover .esoc-mini-profile-loading-img").hide(),t(".esoc-mini-profile-popover .esoc-mini-profile-actions").show();if(t("*").one("scroll",function(){t(i).binf_popover("hide")}),t(i).one("remove",function(){t(i).binf_popover("hide")}),t("[aria-describedby]").each(function(){t(this).is(e.target)||0!==t(this).has(e.target).length||0!==t(".popover").has(e.target).length||t("#"+t(this)[0].getAttribute("aria-describedby")).find(e.target).is(e.target)||t(this).binf_popover("hide")}),t(".esoc-mini-profile-popover").on("mouseleave",function(e){var s=e.target.id?"#"+e.target.id:"";s||t(s).attr("aria-describedby")===t(i).attr("aria-describedby")||t(i).binf_popover("hide")}),t(i).off("mouseleave").on("mouseleave",function(e){setTimeout(function(){0===t(".esoc-mini-profile-popover:hover").length&&t(i).binf_popover("hide")},1e3)}),t(i).one("destroyed.binf.popover hidden.binf.popover",function(e){f.options.originatingView&&!f.options.originatingView.isDestroyed&&f.options.originatingView.engageModalKeyboardFocusOnOpen&&f.options.originatingView.engageModalKeyboardFocusOnOpen()}),f.listenTo(f.options.originatingView,"destroy",function(e){t(i).binf_popover("destroy")}),void 0!==f.model.id){var u={"context":f.options.context,"userid":f.model.attributes.id,"photoElement":t(".esoc-mini-profile-popover .esoc-userprofile-img-"+d.escapeSelector(f.model.attributes.id)),"defaultPhotElement":t(".esoc-mini-profile-popover .esoc-user-default-avatar-"+d.escapeSelector(f.model.attributes.id)),"userbackgroundcolor":f.options.userbackgroundcolor};f.util.commonUtil.setProfilePic(u),f.util.commonUtil.setUserColor(u)}})},"launchChatWindow":function(e){u.launchChatWindow(e.options)},"_assignUserColor":function(){var e=d.commonUtil.getUserAvatarColor(this.model.attributes);this.ui.initialsPlaceholder.css("background",e)}})}),csui.define("esoc/widgets/userwidget/model/extended.model",["csui/lib/backbone","csui/lib/jquery","csui/lib/underscore","csui/utils/url","esoc/widgets/userwidget/view/userprofile.view","esoc/widgets/userwidget/util","i18n!esoc/widgets/userwidget/nls/lang"],function(e,t,i,s,n,o,a){return e.Model.extend({"connector":"","restUrl":"","userWidgetView":"","constructor":function(t){this.options=t,this.userWidgetView=t.userWidgetView,this.restUrl=o.commonUtil.updateQueryStringValues(s.combine(o.commonUtil.getV2Url(t.connector.connection.url),o.commonUtil.REST_URLS.pulseRestUrl,this.userWidgetView.model.attributes.userid),o.commonUtil.globalConstants.FIELDS,o.commonUtil.globalConstants.EXTENDEDINFO);var i=o.commonUtil.globalConstants.FIELDS+"="+o.commonUtil.globalConstants.CHAT_SEETING;i=i+"&"+o.commonUtil.globalConstants.FIELDS+"="+o.commonUtil.globalConstants.FIELD_MAX_CHAR_LIMIT,this.restUrl=s.appendQuery(this.restUrl,i),e.Model.prototype.constructor.apply(this,arguments),t&&t.connector&&t.connector.assignTo(this)},"url":function(){return this.restUrl},"fetch":function(){this.connector.authenticator.syncStorage(),e.Model.prototype.fetch.apply(this,arguments)},"fetchSuccess":function(e,i){t(".esoc-user-profile-tabcontainer li.esoc-user-pulse-enabled-tabs").show(),t(".esoc-userprofile-action-names a.esoc-userprofile-following-action").show().html(i.results.following?a.unfollow:a.follow),t(".esoc-userprofile-action-names a.esoc-userprofile-following-action").attr("title",i.results.following?a.unfollow:a.follow),o.changeRelationsCounts(i.results),e.attributes.otherUser&&e.attributes.chatSettings&&e.attributes.chatSettings.chatEnabled&&t(".esoc-userprofile-action-names .esoc-user-profile-chat-action").show()},"fetchError":function(e,s){t(".esoc-user-profile-tabcontainer li.esoc-user-pulse-enabled-tabs").remove(),e.attributes.isError=!0,e.attributes=i.extend(e.attributes,e.userWidgetView.model.attributes)},"parse":function(e,t){o.commonUtil.globalConstants.MAX_CHAR_LIMIT=e.results.maxCharLimit;var s=this.userWidgetView.model.attributes,n=["followers_count","friends_count","following","chatSettings"];return i.each(n,function(t,i){s[t]=e.results[t]}),e=i.extend(e.results,this.userWidgetView.model.attributes)}})}),csui.define("css!esoc/lib/jquery.emojiarea/jquery.emojiarea",[],function(){}),csui.define("css!esoc/lib/jquery.emojiarea/jquery.emojiarea.custom",[],function(){}),csui.define("esoc/widgets/userwidget/view/extendedinfo.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","esoc/widgets/userwidget/util","i18n!esoc/widgets/userwidget/nls/lang","esoc/lib/jquery.emojiarea/jquery.emojiarea.custom","css!esoc/lib/jquery.emojiarea/jquery.emojiarea.css","css!esoc/lib/jquery.emojiarea/jquery.emojiarea.custom.css"],function(e,t,i,s,n,o,a){var l=null;return s.ItemView.extend({"tagName":"div","className":"binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12","util":n,"emojiarea":new a,"templateHelpers":function(){return{"messages":{"edit":o.edit,"update":o.update,"cancel":o.cancel,"facebookLink":o.facebookLink,"linkedinLink":o.linkedinLink,"twitterLink":o.twitterLink,"manager":o.manager,"defaultManagerMessage":o.defaultManagerMessage,"languagesSpoken":o.languagesSpoken,"aboutMe":o.aboutMe,"jobDescription":o.jobDescription,"expertiseAreas":o.expertiseAreas,"pastPositions":o.pastPositions,"degrees":o.degrees,"awards":o.awards,"defaultLanguagesMessage":o.defaultLanguagesMessage,"defaultAboutMeMessage":o.defaultAboutMeMessage,"defaultfacebookMessage":o.defaultfacebookMessage,"defaultLinkedInMessage":o.defaultLinkedInMessage,"defaulttwitterLinkMessage":o.defaulttwitterLinkMessage,"defaultJobDesc":o.defaultJobDesc,"defaultExpertise":o.defaultExpertise,"defaultPastPositions":o.defaultPastPositions,"defaultDegreeMessage":o.defaultDegreeMessage,"defaultAwardMessage":o.defaultAwardMessage,"more":o.more,"less":o.less,"emoticon":o.emoticon}}},"initialize":function(e){this.extendedInfo=e,l=this},"constructor":function(e){e=e||{},s.ItemView.prototype.constructor.call(this,e)},"onEditClick":function(t){if(this.model.attributes.isEditable){if(this.$el.find(".esoc-user-see-more").hide(),this.$el.find(".esoc-user-see-less").hide(),this.$el.find(".esoc-user-extended-view-mode").hide(),this.$el.find(".esoc-user-extended-edit-mode").show(),this.options.parentView.triggerMethod("update:scrollbar"),this.model.attributes.userInputField){if(this.model.attributes.content){var i={"id":this.model.attributes.content,"name":this.$el.find(".esoc-user-display-name").text().trim()};"status"===this.model.attributes.formField&&(this.$el.find(".esoc-user-extended-edit-input").trigger("focus"),this.applyEmoji(t),this.$el.find(".emoji-wysiwyg-editor").trigger("focus")),this.pickerView.model.set(i),this.pickerView.render()}this.$el.find(".esoc-user-manager-picker-holder input").trigger("focus")}else this.$el.find(".esoc-user-extended-edit-input").trigger("focus"),"status"===this.model.attributes.formField&&(this.applyEmoji(t),this.$el.find(".emoji-wysiwyg-editor").trigger("focus"));var s=this;e("#esoc-social-status-header").on("paste",function(t){var i=s.util.commonUtil.globalConstants.MAX_CHAR_LIMIT,n=e("#esoc-social-status-input").val().length;s.util.commonUtil.onCommentFormPaste(t,n,i),e("#esoc-social-status-input").innerHTML=e("#esoc-social-status-header").html(),s.onStatusChange(t)}),this.util.commonUtil.preventDrop(e("#esoc-social-status-header")),setTimeout(function(){e("#esoc-social-status-header").trigger("focus")},1e3),this.$el.find(".esoc-user-label").removeClass("esoc-cursor-pointer"),this.$el.find(".esoc-user-extended-edit").removeClass("esoc-edit-icon")}},"showEditLinkForText":function(e){this.$el.find(".esoc-user-extended-edit-input").is(":visible")||(this.$el.find(".esoc-user-extended-edit").addClass("esoc-edit-icon"),this.$el.find(".esoc-user-extended-edit").attr("href","javascript:void(0);").attr("tabindex","0"))},"hideEditLinkForText":function(e){this.$el.find(".esoc-user-extended-edit").removeClass("esoc-edit-icon"),
this.$el.find(".esoc-user-extended-edit").removeAttr("href"),this.$el.find(".esoc-user-extended-edit").attr("tabindex","-1")},"submitOnEnter":function(e){13===(e.keyCode?e.keyCode:e.which)&&this.updateExtendedInfoField(e)},"applyEmoji":function(t){this.$el.find(".emoji-wysiwyg-editor").remove(),this.$el.find("#esoc-social-status-input").emojiarea({"path":this.util.commonUtil.getEmojiPath(this.model.attributes.connector),"wysiwyg":!0,"button":".esoc-social-status-header-emotion","id":"esoc-social-status-header","parent":this.$el.find(".esoc-status-textinput-button-holder"),"util":this.util,"isStatus":!0,"container":e(".esoc-general-tab"),"widget":e(".esoc-user-widget-dialog .binf-modal-content")}),this.$el.find(".emoji-wysiwyg-editor").addClass("esoc-status-header-emoji").attr({"id":"esoc-social-status-header","style":"min-height: 100%","data-text":this.templateHelpers().messages.defaultMessage})}})}),csui.define("esoc/controls/userwidget/userwidget.model.mixin",["csui/lib/jquery","csui/lib/underscore"],function(e,t){"use strict";return{"parseModelResponse":function(e,t){e.attributes.display_name=e.get("name_formatted"),e.attributes.department_name=e.get("group_id")?e.get("group_id").name:""}}}),csui.define("hbs!esoc/widgets/userwidget/impl/userpickercard",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return" binf-disabled"},"3":function(e,t,i,s){var n;return'      <span class="message binf-pull-left">'+this.escapeExpression((n=null!=(n=t["disabled-message"]||(null!=e?e["disabled-message"]:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"disabled-message","hash":{}}):n))+"</span>\r\n"},"5":function(e,t,i,s){var n;return'      <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n        <div class="esoc-mini-profile-selfuser-actions">\r\n          <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n        </div>\r\n      </a>\r\n'},"7":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:""},"8":function(e,t,i,s){var n,o;return'        <div class="esoc-chat-action-enabled esoc-chat-action-enabled-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' binf-hidden">\r\n          <a href="javascript:void(0);" class="esoc-mini-profile-following-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'">\r\n            <div class="esoc-miniprofile-otheruser-actions-withchat">\r\n              <div class="esoc-miniprofile-followingaction '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.followingClass:n,e))+'"\r\n                   title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'"></div>\r\n            </div>\r\n          </a>\r\n\r\n          <div class="esoc-mini-profile-otheruser-actions-spacing "></div>\r\n          <a href="javascript:void(0);" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.chat:n,e))+'">\r\n            <div class="esoc-miniprofile-chat-action-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'\r\n                   esoc-miniprofile-otheruser-actions-withchat esoc-miniprofile-chat-action"></div>\r\n          </a>\r\n\r\n          <div class="esoc-mini-profile-otheruser-actions-spacing "></div>\r\n          <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n            <div class="esoc-miniprofile-otheruser-actions-withchat">\r\n              <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n            </div>\r\n          </a>\r\n        </div>\r\n\r\n        <div class="esoc-chat-action-disabled esoc-chat-action-disabled-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' binf-hidden">\r\n          <a href="javascript:void(0);" class="esoc-mini-profile-following-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'">\r\n            <div class="esoc-mini-profile-otheruser-actions-without-chat">\r\n              <div class="esoc-miniprofile-followingaction '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.followingClass:n,e))+'"\r\n                   title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.following:n,e))+'"></div>\r\n            </div>\r\n          </a>\r\n\r\n          <div class="esoc-mini-profile-otheruser-actions-spacing "></div>\r\n          <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n            <div class="esoc-mini-profile-otheruser-actions-without-chat">\r\n              <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n            </div>\r\n          </a>\r\n        </div>\r\n'},"10":function(e,t,i,s){var n;return'        <a href="javascript:void(0);" class="esoc-viewminiprofile-action" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'">\r\n          <div class="esoc-mini-profile-selfuser-actions">\r\n            <div class="esoc-mini-profile-view-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.actions:e)?n.viewprofile:n,e))+'"></div>\r\n          </div>\r\n        </a>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="'+this.escapeExpression((o=null!=(o=t.className||(null!=e?e.className:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"className","hash":{}}):o))+'">\r\n  <div class="member-picture'+(null!=(n=t.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' binf-pull-left">\r\n    <span class="esoc-user-picker-default-img-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' csui-icon-paceholder csui-icon\r\n            image_user_placeholder" style="background-color:'+this.escapeExpression((o=null!=(o=t.userbackgroundcolor||(null!=e?e.userbackgroundcolor:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"userbackgroundcolor","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n    <img class="esoc-user-picker-img-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' csui-icon-user csui-icon binf-img-circle binf-hidden" alt="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.image:n,e))+'">\r\n  </div>\r\n  <div class="member-info'+(null!=(n=t.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'</span>\r\n    <span class="email binf-pull-left" title="'+this.escapeExpression((o=null!=(o=t.email||(null!=e?e.email:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"email","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.business_email||(null!=e?e.business_email:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"business_email","hash":{}}):o))+'</span>\r\n    <span class="title binf-pull-left" title="'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</span>\r\n    <span class="department binf-pull-left" title="'+this.escapeExpression((o=null!=(o=t.department_name||(null!=e?e.department_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"department_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.department_name||(null!=e?e.department_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"department_name","hash":{}}):o))+'</span>\r\n    <span class="office binf-pull-left" title="'+this.escapeExpression((o=null!=(o=t.office_location||(null!=e?e.office_location:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"office_location","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.office_location||(null!=e?e.office_location:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"office_location","hash":{}}):o))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'  </div>\r\n  <div class="esoc-mini-profile-actions">\r\n'+(null!=(n=t.if.call(e,null!=e?e.deleted:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?n:"")+"  </div>\r\n</div>\r\n"}});return i.registerPartial("esoc_widgets_userwidget_impl_userpickercard",s),s}),csui.define("esoc/widgets/userwidget/view/userpickercard.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","csui/utils/user.avatar.color","esoc/widgets/userwidget/view/miniprofile.view","esoc/widgets/utils/chat/chat.view","esoc/widgets/userwidget/util","i18n!esoc/widgets/userwidget/nls/lang","hbs!esoc/widgets/userwidget/impl/userpickercard","esoc/factory/pulsesettingsfactory","esoc/controls/userwidget/userwidget.view","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p){return n.ItemView.extend({"util":c,"className":"esoc-userpickercard-container","template":u,"initialize":function(e){this.options=e;var t=this.options.connector||this.model.collection.connector;this.chatSettings=e.context.getModel(m,{"attributes":{"id":"chat"},"options":{"chat":!0},"permanent":!0}).ensureFetched(),this.followUnfollowActionUrl=o.combine(this.util.commonUtil.getV2Url(t.connection.url),this.util.commonUtil.REST_URLS.pulseRestUrl,this.model.attributes.id),this.model.on("show:Actions",this.showActions,this),this.model.on("hide:Actions",this.hideActions,this)},"constructor":function(e){e=e||{},n.ItemView.prototype.constructor.call(this,e)},"ui":{"viewProfileAction":".esoc-picker-view .esoc-viewminiprofile-action","followUnFollowAction":".esoc-picker-view .esoc-mini-profile-following-action","chatAction":".esoc-picker-view .esoc-social-chat-icon","actionSpacing":".esoc-picker-view .esoc-mini-profile-otheruser-actions-spacing"},"templateHelpers":function(){return{"messages":{"chat":d.chatLabel,"image":d.image}}},"events":{"click @ui.viewProfileAction":"showUserProfileDialog","click @ui.followUnFollowAction":"followUnfollowAction","mousedown @ui.followUnFollowAction":"preventDefaultAction","mousedown @ui.chatAction":"preventDefaultAction","mousedown @ui.actionSpacing":"preventDefaultAction","click @ui.actionSpacing":"preventDefaultAction","click @ui.chatAction":"preventDefaultAction"},"preventDefaultAction":function(e){e.preventDefault(),e.stopImmediatePropagation()},"showActions":function(){this.$el.find(".esoc-mini-profile-userinfo").addClass("esoc-mini-profile-userinfo-with-actions"),this.$el.find(".member-info").addClass("member-info-with-actions"),this.$el.find(".esoc-mini-profile-actions").show()},"hideActions":function(){this.$el.find(".esoc-mini-profile-actions").hide(),this.$el.find(".member-info").removeClass("member-info-with-actions")},"onRender":function(e){var t=this;t.options.userbackgroundcolor=a.getUserAvatarColor(this.model.attributes),t.model.attributes.otherUser&&t.chatSettings.done(function(e){if(e.attributes.chatSettings.chatEnabled){t.$el.find(".esoc-chat-action-enabled-"+t.model.attributes.id).removeClass("binf-hidden");var i=new n.Region({"el":t.$el.find(".esoc-miniprofile-chat-action")}),s={"context":t.options.context,"tguser":t.model.attributes.name,"domain":e.attributes.chatSettings.chatDomain},o=new r(s);i.show(o)}else t.$el.find(".esoc-chat-action-disabled-"+t.model.attributes.id).removeClass("binf-hidden")}),this.setProfilePic()},"setProfilePic":function(){var e=this.options.model.attributes.id,t={"context":this.options.context,"userid":e,"photoElement":this.$el.find(".esoc-user-picker-img-"+c.escapeSelector(e)),"defaultPhotElement":this.$el.find(".esoc-user-picker-default-img-"+c.escapeSelector(e)),"userbackgroundcolor":this.options.userbackgroundcolor};this.util.commonUtil.setProfilePic(t),this.util.commonUtil.setUserColor(t)},"showUserProfileDialog":function(t){this.model.attributes.userid=this.model.attributes.id;var s=i.extend({},this.options.widgetOptions);delete s.model,s.model=this.model,p=p||e("esoc/controls/userwidget/userwidget.view"),new p(s).showUserProfileDialog(t)},"followUnfollowAction":function(e){e.stopPropagation(e);var i=new FormData,s=(e||window.event,this.model.attributes.following?c.commonUtil.globalConstants.UNFOLLOW:c.commonUtil.globalConstants.FOLLOW);i.append(c.commonUtil.globalConstants.ACTION,s);var n={"itemview":this,"url":this.followUnfollowActionUrl,"type":"POST","data":i,"requestType":"miniProfilePopup","targetElement":t(e.target.parentElement),"connector":this.options.connector};this.util.updateAjaxCall(n)}})}),csui.define("esoc/widgets/userwidget/model/userpickercard.model",["csui/lib/underscore","csui/lib/backbone","csui/models/resource","esoc/widgets/userwidget/util"],function(e,t,i,s){return t.Model.extend(e.extend({},i(t.Model),{"defaults":{"className":"esoc-picker-view csui-userpicker-item"},"constructor":function(e){t.Model.prototype.constructor.apply(this,arguments)},"parse":function(e,t){var i=e.data.properties;return i.display_name=i.name_formatted,i.department_name=i.group_id_expand?i.group_id_expand.name:"",s.setRelationModel(i,{"following":i.following,"selfUser":i.self}),i}}))}),csui.define("esoc/widgets/userwidget/model/userpicker.model",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","esoc/widgets/userwidget/model/userpickercard.model","esoc/widgets/userwidget/util","csui/utils/url","csui/utils/contexts/factories/user","i18n!esoc/widgets/userwidget/nls/lang","csui/models/resource"],function(e,t,i,s,n,o,a,l,r){return t.Collection.extend(i.extend({},r(t.Collection),{"util":n,"model":s,"constructor":function(e){this.user=e.context?e.context.getModel(a):void 0,this.limit=e.limit||10,this.query=e.query||"",e.memberFilter&&e.memberFilter.type&&(this.memberType=e.memberFilter.type),this.memberType||(this.memberType=[0,1]),e&&e.connector&&e.connector.assignTo(this),t.Collection.prototype.constructor.apply(this,arguments)},"urlRoot":function(){return o.combine(this.util.commonUtil.getV2Url(this.connector.connection.url),this.util.commonUtil.REST_URLS.searchUsersUrl)},"url":function(){var e="?limit="+this.limit,t=this.memberType.length&&"&where_type="+this.memberType.join("&where_type=")||"",s=encodeURIComponent("&expand=properties{group_id}"),n="&query="+encodeURIComponent(this.query);return i.result(this,"urlRoot")+e+t+s+n},"parse":function(e){for(var t in e.results){var i=e.results[t];i.data.properties.id===this.user.get("id")&&(i.data.properties.self=!0)}return e.results},"fetch":function(){return this.Fetchable.fetch.apply(this,arguments)}}))}),csui.define("esoc/widgets/userwidget/view/customuserpicker.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/userpicker/userpicker.view","esoc/controls/userwidget/userwidget.view","esoc/controls/userwidget/userwidget.model.mixin","esoc/widgets/userwidget/view/userpickercard.view","esoc/widgets/userwidget/model/userpicker.model"],function(e,t,i,s,n,o,a,l,r,c){var d=o.extend({"constructor":function(e){e||(e={}),e.userView=e.widgetoptions.showActions?r:"",e.connector=e.widgetoptions.connector,e.relation=e.widgetoptions.relation;var t=new c(e);e.collection=e.widgetoptions.showActions?t:"",this.options=e,o.prototype.constructor.apply(this,arguments)},"currentlyFocusedElement":function(e){this.ui.searchclear&&i(this.ui.searchclear).is(":visible")?this.ui.searchclear.attr("tabindex","0").attr("data-cstabindex","0"):this.ui.searchbox.attr("tabindex","0").attr("data-cstabindex","0")},"_retrieveMembers":function(e){var t=this;return t.collection.query=e,t.collection.fetch({"reset":!0}).then(function(){return"function"==typeof t.options.onRetrieveMembers&&t.options.onRetrieveMembers({"collection":t.collection}),t.collection.models})},"_renderHighlighter":function(e){var t=this.collection.findWhere({"name":e});return new(0===t.get("type")?this.options.userView:this.options.groupView)({"model":t,"connector":this.options.widgetoptions.connector,"widgetOptions":this.options.widgetoptions,"context":this.options.context,"disabledMessage":this.options.disabledMessage}).render().el},"_resetInput":function(e){"esoc-activityfeed-invisiblebutton"!==e.target.className&&"activityfeed-expand-invisiblebutton"!==e.target.className&&i(".typeahead.binf-form-control.cs-search").val("")},"onShow":function(e){this.options.widgetoptions.showActions&&i(".typeahead.binf-form-control.cs-search").on("focusout",this,this._resetInput)},"_afterSelect":function(i){if(this.options.widgetoptions.showActions){var s=t.extend({},this.options.widgetoptions);delete s.model,this.parseModelResponse(i),s.model=i,s.userid=i.attributes.id,a=a||e("esoc/controls/userwidget/userwidget.view");new a(s).showUserProfileDialog()}else{var o=this.options.clearOnSelect?"":n.formatMemberName(i);this.ui.searchbox.val(o),this.updateStyles(),this.options.userView.userPicked=!0,this.trigger("item:change",{"item":i})}},"_nextHighlighter":function(e){this.options.widgetoptions.showActions&&e.data("value")&&e.data("value").trigger("show:Actions")},"_currentHighlighter":function(e){this.options.widgetoptions.showActions&&e.data("value")&&e.data("value").trigger("hide:Actions")},"_positionContainer":function(e){e.$scrollContainer.perfectScrollbar("update"),this.collection.length>0&&e.$menu.removeClass("csui-no-results-wrapper"),o.prototype._positionContainer.call(this,e),e.$element.css("height","")}});return t.extend(d.prototype,l),d}),csui.define("hbs!esoc/widgets/userwidget/impl/extendedinfotextfield",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="esoc-user-label esoc-user-textarea-label">\r\n'+(null!=(n=t.if.call(e,null!=e?e.extendedLabelClass:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+'    <div class="esoc-user-extended-info esoc-user-extended-view-mode">\r\n'+(null!=(n=t.if.call(e,null!=e?e.userInputField:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(10,s,0)}))?n:"")+'      <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n         class="esoc-user-see-more esoc-user-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n        <span class="icon-arrow-down"></span></a>\r\n      <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n         class="esoc-user-see-less esoc-user-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n        <span class="icon-arrow-up"></span></a>\r\n    </div>\r\n'},"2":function(e,t,i,s){var n;return"      <span class="+this.escapeExpression((n=null!=(n=t.extendedLabelClass||(null!=e?e.extendedLabelClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"extendedLabelClass","hash":{}}):n))+">"+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n"},"4":function(e,t,i,s){var n;return'      <span class="esoc-user-extended-info-label">'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n"},"6":function(e,t,i,s){var n,o;return'        <div class="esoc-user-manager-field">\r\n          <div class="esoc-user-manager-avatar-container">\r\n        <span id="esoc-user-default-avatar" class="image_user_placeholder\r\n          esoc-user-default-avatar">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n            <img id="esoc-user-manager-avatar" class="binf-img-circle esoc-user-manager-avatar" src="" />\r\n          </div>\r\n      <span class="esoc-widget-user-display-name esoc-user-messages" data-userid="'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+'"\r\n            data-username="'+this.escapeExpression((o=null!=(o=t.reportsTo||(null!=e?e.reportsTo:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"reportsTo","hash":{}}):o))+'" />\r\n'+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n"},"7":function(e,t,i,s){var n;return'            <div\r\n                class="esoc-user-extendedinfo-edit-icon '+(null!=(n=t.if.call(e,null!=e?e.reportsTo:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+'">\r\n              <a class="esoc-user-extended-edit" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n            </div>\r\n'},"8":function(e,t,i,s){return" esoc-user-extendedinfo-reports-to-edit-icon "},"10":function(e,t,i,s){var n,o;return'        <div class="esoc-user-extendedinfo">\r\n          <div class="esoc-user-extendedinfo-content">\r\n            <a '+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+'\r\n                                  class="esoc-user-messages-content esoc-user-messages">\r\n              <div class="esoc-social-status-data esoc-user-content esoc-user-messages-content\r\n                  esoc-user-extended-info-content '+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")+'">'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+"</div>\r\n            </a>\r\n          </div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(15,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n"},"11":function(e,t,i,s){return' href="javascript:void(0);" '},"13":function(e,t,i,s){return" esoc-cursor-pointer "},"15":function(e,t,i,s){var n;return'            <div class="esoc-user-extendedinfo-edit-icon">\r\n              <a class="esoc-user-extended-edit" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n            </div>\r\n'},"17":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(18,s,0),"inverse":this.noop}))?n:""},"18":function(e,t,i,s){var n,o;return'      <div class="esoc-user-label esoc-user-textarea-label ">\r\n'+(null!=(n=t.if.call(e,null!=e?e.extendedLabelClass:e,{"name":"if","hash":{},"fn":this.program(19,s,0),"inverse":this.program(21,s,0)}))?n:"")+'      </div>\r\n      <div\r\n          class="esoc-user-extended-info esoc-user-extended-view-mode esoc-user-default-content-mode">\r\n        <div class="esoc-user-extendedinfo-default-content">\r\n          <a '+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+'\r\n                                class="esoc-user-default-content '+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:"")+'">'+this.escapeExpression((o=null!=(o=t.defaultMessage||(null!=e?e.defaultMessage:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"defaultMessage","hash":{}}):o))+'</a>\r\n        </div>\r\n        <div class="esoc-user-extendedinfo-edit-icon">\r\n          <a class="esoc-user-extended-edit" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n        </div>\r\n      </div>\r\n'},"19":function(e,t,i,s){var n;return"          <span class="+this.escapeExpression((n=null!=(n=t.extendedLabelClass||(null!=e?e.extendedLabelClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"extendedLabelClass","hash":{}}):n))+">"+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n"},"21":function(e,t,i,s){var n;return'          <span class="esoc-user-extended-info-label">'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n"},"23":function(e,t,i,s){return"esoc-cursor-pointer"},"25":function(e,t,i,s){var n;return'    <div class="esoc-user-hide-element esoc-user-extended-edit-mode">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.formField === 'status'",{"name":"xif","hash":{},"fn":this.program(26,s,0),"inverse":this.program(28,s,0)}))?n:"")+"    </div>\r\n  </div>\r\n"},"26":function(e,t,i,s){var n,o;return'        <div class="esoc-social-status-input-container">\r\n          <textarea id=\'esoc-social-status-input\' class="esoc-user-extended-edit-textarea\r\n          esoc-user-extended-edit-input" placeholder="'+this.escapeExpression((o=null!=(o=t.defaultMessage||(null!=e?e.defaultMessage:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"defaultMessage","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+'</textarea>\r\n        </div>\r\n        <div class="esoc-status-textinput-button-holder">\r\n          <a href="javascript:void(0);"\r\n             class="esoc-social-status-header-emotion esoc-social-comment-emoticon"\r\n             id="esoc-social-status-emoticon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'"></a>\r\n        </div>\r\n        <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-user-text-edit-buttons">\r\n          <button id="esoc-user-status-update" class="esoc-user-status-update binf-btn binf-btn-primary"\r\n                  title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'</button>\r\n          <button class="esoc-user-cancel binf-btn binf-btn-default"\r\n                  title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+"</button>\r\n        </div>\r\n"},"28":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.userInputField:e,{"name":"if","hash":{},"fn":this.program(29,s,0),"inverse":this.program(31,s,0)}))?n:"")+'        <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-user-text-edit-buttons">\r\n          <button class="esoc-user-update binf-btn binf-btn-primary"\r\n                  title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'</button>\r\n          <button class="esoc-user-cancel binf-btn binf-btn-default"\r\n                  title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+"</button>\r\n        </div>\r\n"},"29":function(e,t,i,s){var n;return'          <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n            <div class="esoc-user-manager-picker-holder"></div>\r\n            <input type="text"\r\n                   class="esoc-user-extended-edit-text esoc-user-extended-edit-input esoc-user-hide-element"\r\n                   value="'+this.escapeExpression((n=null!=(n=t.content||(null!=e?e.content:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"content","hash":{}}):n))+'" placeholder="'+this.escapeExpression((n=null!=(n=t.defaultMessage||(null!=e?e.defaultMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultMessage","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.defaultMessage||(null!=e?e.defaultMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultMessage","hash":{}}):n))+'"/>\r\n          </div>\r\n'},"31":function(e,t,i,s){var n;return'          <textarea class="esoc-user-extended-edit-textarea esoc-user-extended-edit-input"\r\n                    placeholder="'+this.escapeExpression((n=null!=(n=t.defaultMessage||(null!=e?e.defaultMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultMessage","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.defaultMessage||(null!=e?e.defaultMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultMessage","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.content||(null!=e?e.content:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"content","hash":{}}):n))+"</textarea>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.content:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(17,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(25,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("esoc_widgets_userwidget_impl_extendedinfotextfield",s),s}),csui.define("esoc/widgets/userwidget/view/extendedinfotextfield.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/connector","esoc/widgets/userwidget/view/extendedinfo.view","esoc/widgets/userwidget/util","esoc/widgets/userwidget/view/customuserpicker.view","hbs!esoc/widgets/userwidget/impl/extendedinfotextfield","i18n!esoc/widgets/userwidget/nls/lang","csui/lib/perfect-scrollbar"],function(e,t,i,s,n,o,a,l,r,c,d){var u=null;return a.extend({"tagName":"div","className":"esoc-user-extended-info-text-field binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12","template":c,"util":l,"initialize":function(e){this.extendedInfo=e,u=this},"events":{"focusin .esoc-user-extended-edit-mode":"onStatusInputFocusIn","focusout .esoc-user-extended-edit-mode":"onStatusInputFocusOut","click #esoc-user-status-update":"postStatus",
"click .esoc-user-update":"updateExtendedInfoField","click .esoc-user-cancel":"cancelUpdateExtendedInfoField","click .esoc-user-extended-edit, .esoc-user-messages-content, .esoc-user-default-content":"onEditClick","click .esoc-user-see-more":"showMoreContent","click .esoc-user-see-less":"showLessContent","click .esoc-user-messages-content":"onContentClick","mouseenter .esoc-user-default-content-mode, .esoc-user-extendedinfo, .esoc-user-manager-field":"showEditLinkForText","mouseleave .esoc-user-default-content-mode, .esoc-user-extendedinfo, .esoc-user-manager-field":"hideEditLinkForText","focusin .esoc-user-manager-field":"showEditLinkForText","focusout .esoc-user-manager-field":"hideEditLinkForText","keypress .esoc-user-extended-edit-text":"submitOnEnter","change #esoc-social-status-input":"onStatusChange","input #esoc-social-status-input":"onStatusChange"},"constructor":function(e){e=e||{},e.connector=e.connector?e.connector:e.context.getObject(o),this.options=e,n.ItemView.prototype.constructor.call(this,e)},"onRender":function(){if(this.options.model.attributes.userInputField){if(this.options.model.attributes.isEditable){this.pickerView=new r({"context":this.options.context,"memberFilter":{"type":[0]},"widgetoptions":{"connector":this.options.connector,"showActions":!1}});new n.Region({"el":this.$el.find(".esoc-user-manager-picker-holder")}).show(this.pickerView),this.listenTo(this.pickerView,"item:change",this.onItemChange)}if(this.options.model.attributes.content){l.displayUserWidget(this.options.context,this.$el);var t={"userid":this.options.model.attributes.content,"context":this.options.context,"placeholder":this.$el.find(".esoc-user-manager-avatar-container"),"showUserProfileLink":!0,"showMiniProfile":!0,"showUserWidgetFor":"profilepic","source":"extendedInfoText","parentView":this};e("esoc/widgets/userwidget/userwidget").getUser(t)}else this.trigger("view:shown")}},"onStatusChange":function(e){var t=this.$el.find("#esoc-social-status-input").val(),i=e||window.event,s=this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT;if(t.length>s){var n=t.substr(0,s);this.$el.find("#esoc-social-status-input")[0].innerHTML=n,this.$el.find("#esoc-social-status-header").html("")[0].textContent=n,this.util.commonUtil.addEmoji(this.$el.find("#esoc-social-status-header"),!1,this.options.connector),this.$el.find("#esoc-social-status-header").trigger("focus"),this.util.commonUtil.placeCaretAtEnd(this.$el.find("#esoc-social-status-header")),i.preventDefault()}},"onItemChange":function(e){this.managerID=e.item.attributes.id,this.$el.find(".esoc-user-extended-edit-text").val(e.item.attributes.id)},"updateExtendedInfoField":function(e){if(this.options.model.attributes.userInputField){this.pickerView.$el.find("input").val().trim()||(this.managerID="",this.$el.find(".esoc-user-extended-edit-text").val(""))}var i=new FormData,s=this.$el.find(".esoc-user-extended-edit-input").val(),n=this.options.connector;i.append(this.util.commonUtil.globalConstants.ACTION,this.util.commonUtil.globalConstants.UPDATE_EXTENDED_INFO),i.append(this.model.attributes.formField,s),this.$el.find(".esoc-user-extended-edit-mode").addClass("esoc-extendedinfo-update-mask"),this.$el.find(".esoc-user-extended-edit-input").prop("disabled",!0);var o={"itemview":this,"url":this.util.commonUtil.getV2Url(n.connection.url)+this.util.commonUtil.REST_URLS.pulseRestUrl+this.model.attributes.userid,"type":"POST","data":i,"requestType":"updateExtendedTextField","newValue":s,"targetElement":t(e.target),"connector":n};this.util.updateAjaxCall(o)},"postStatus":function(e){var i=new FormData,s=this.$el.find(".esoc-user-extended-edit-input").val(),n=this.options.connector;i.append(this.model.attributes.formField,s),this.$el.find(".esoc-user-extended-edit-mode").addClass("esoc-extendedinfo-update-mask"),this.$el.find(".esoc-user-extended-edit-input").prop("disabled",!0);var o={"itemview":this,"url":n.connection.url+this.util.commonUtil.REST_URLS.csPostCommentRESTUrl,"type":"POST","data":i,"requestType":"postStatus","newValue":s,"targetElement":t(e.target),"connector":n};this.util.updateAjaxCall(o)},"onShow":function(e){this.showSeeMoreLink(e),this.options.model.attributes.userInputField?this.isUserModelLoaded&&this.trigger("view:shown"):this.trigger("view:shown")},"showSeeMoreLink":function(e){var t=this.$el.find(".esoc-user-content");t.length>0&&("status"===this.model.attributes.formField?(t[0].innerHTML=t.text(),t.addClass("esoc-see-more-content"),l.commonUtil.isTextOverflown(t[0])&&this.$el.find(".esoc-user-see-more").show(),this.util.commonUtil.addEmoji(this.$el.find(".esoc-user-content"),!0,this.options.connector)):(t.html(l.commonUtil.onClickableUrl(t.html(),!0)),t.addClass("esoc-see-more-content"),l.commonUtil.isTextOverflown(t[0])&&this.$el.find(".esoc-user-see-more").show()))},"onContentClick":function(e){e.stopPropagation(),this.$el.find(".esoc-user-see-more").is(":visible")?this.showMoreContent(e):this.$el.find(".esoc-user-see-less").is(":visible")&&this.showLessContent(e)},"showMoreContent":function(e){""===window.getSelection().toString()&&(this.$el.find(".esoc-user-see-less").show(),this.$el.find(".esoc-user-see-more").hide(),this.$el.find(".esoc-user-content").removeClass("esoc-see-more-content"),t("#esoc-user-focus-element").trigger("focus"))},"showLessContent":function(e){""===window.getSelection().toString()&&(this.$el.find(".esoc-user-see-less").hide(),this.$el.find(".esoc-user-see-more").show(),this.$el.find(".esoc-user-content").addClass("esoc-see-more-content"),t("#esoc-user-focus-element").trigger("focus"),this.options.parentView.triggerMethod("update:scrollbar"))},"cancelUpdateExtendedInfoField":function(e){this.render(),this.trigger("change:content"),this.model.attributes.content?this.model.attributes.userInputField?this.$el.find(".esoc-user-messages a").trigger("focus"):this.$el.find(".esoc-user-messages").trigger("focus"):this.$el.find(".esoc-user-default-content").trigger("focus"),this.showSeeMoreLink(e),this.options.parentView.triggerMethod("update:scrollbar")},"onStatusInputFocusIn":function(e){this.$el.find(".esoc-status-header-emoji").addClass("esoc-status-header-emoji-focus")},"onStatusInputFocusOut":function(e){this.$el.find(".esoc-status-header-emoji").removeClass("esoc-status-header-emoji-focus")}})}),csui.define("hbs!esoc/widgets/userwidget/impl/extendedinfolinkfield",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <a href="'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+'" target="_blank" class="'+this.escapeExpression((o=null!=(o=t.linkClass||(null!=e?e.linkClass:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"linkClass","hash":{}}):o))+' esoc-user-external-profile-link\r\n  binf-col-lg-3 binf-col-md-3 binf-col-sm-3 binf-col-xs-3" aria-label="'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'">\r\n  </a>\r\n  <div class="esoc-extended-info-link-holder binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="esoc-user-extended-label esoc-user-profile-link-label esoc-user-label">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'\r\n    </div>\r\n    <div class="esoc-user-extended-view-mode esoc-user-profile-link-content esoc-user-links">\r\n      <div class="esoc-user-messages-content esoc-user-messages esoc-user-widget-links-content">\r\n        <a href="'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+'" target="_blank">'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+"</a>\r\n      </div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"    </div>\r\n  </div>\r\n"},"2":function(e,t,i,s){var n;return'        <div class="esoc-user-extendedinfo-edit-icon">\r\n          <a class="esoc-user-extended-edit" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n        </div>\r\n'},"4":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:""},"5":function(e,t,i,s){var n,o;return'    <div\r\n        class="'+this.escapeExpression((o=null!=(o=t.linkClass||(null!=e?e.linkClass:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"linkClass","hash":{}}):o))+' esoc-user-external-profile-link binf-col-lg-3 binf-col-md-3 binf-col-sm-3 binf-col-xs-3" />\r\n    <div class="esoc-extended-info-link-holder binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class=" esoc-user-extended-label esoc-user-profile-link-label esoc-user-label">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"label","hash":{}}):o))+'\r\n      </div>\r\n      <div\r\n          class="esoc-user-extended-info esoc-user-extended-view-mode esoc-user-default-content-mode">\r\n        <div class="esoc-user-extendedinfo-default-content">\r\n          <a href="javascript:void(0);"\r\n             class="esoc-user-profile-link-content esoc-user-default-content '+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+'">'+this.escapeExpression((o=null!=(o=t.defaultMessage||(null!=e?e.defaultMessage:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"defaultMessage","hash":{}}):o))+'</a>\r\n        </div>\r\n        <div class="esoc-user-extendedinfo-edit-icon">\r\n          <a class="esoc-user-extended-edit" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n'},"6":function(e,t,i,s){return" esoc-cursor-pointer "},"8":function(e,t,i,s){var n,o;return'  <div class="esoc-extended-info-link-holder binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div\r\n        class="esoc-user-hide-element esoc-user-extended-edit-mode esoc-user-extended-edit-content">\r\n      <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-user-edit-textbox">\r\n        <input type="text" class="esoc-user-extended-edit-text esoc-user-extended-edit-input"\r\n               value="'+this.escapeExpression((o=null!=(o=t.content||(null!=e?e.content:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"content","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.defaultMessage||(null!=e?e.defaultMessage:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"defaultMessage","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.defaultMessage||(null!=e?e.defaultMessage:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"defaultMessage","hash":{}}):o))+'"/>\r\n      </div>\r\n      <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-user-text-edit-buttons">\r\n        <button class="esoc-user-update binf-btn binf-btn-primary"\r\n                title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'</button>\r\n        <button class="esoc-user-cancel binf-btn binf-btn-default"\r\n                title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+"</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.content:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(4,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.isEditable:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("esoc_widgets_userwidget_impl_extendedinfolinkfield",s),s}),csui.define("esoc/widgets/userwidget/view/extendedinfolinkfield.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","esoc/widgets/userwidget/view/extendedinfo.view","esoc/widgets/userwidget/util","hbs!esoc/widgets/userwidget/impl/extendedinfolinkfield","i18n!esoc/widgets/userwidget/nls/lang","csui/lib/perfect-scrollbar"],function(e,t,i,s,n,o,a,l){var r=null;return n.extend({"tagName":"div","className":"esoc-user-extended-info-link binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12","template":a,"util":o,"initialize":function(e){this.extendedInfo=e,r=this},"events":{"click .esoc-user-update":"updateExtendedInfoField","click .esoc-user-cancel":"cancelUpdateExtendedInfoField","click .esoc-user-extended-edit, .esoc-user-default-content":"onEditClick","mouseenter .esoc-user-links, .esoc-user-default-content-mode":"showEditLinkForText","mouseleave .esoc-user-links, .esoc-user-default-content-mode":"hideEditLinkForText","focusin .esoc-user-links":"showEditLinkForText","focusout .esoc-user-links":"hideEditLinkForText","keypress .esoc-user-extended-edit-text":"submitOnEnter"},"constructor":function(e){e=e||{},s.ItemView.prototype.constructor.call(this,e)},"onEditClick":function(e){if(this.model.attributes.isEditable){var t=this.model.attributes.content;this.$el.find(".esoc-user-extended-view-mode").hide(),this.$el.find(".esoc-user-extended-edit-mode").show(),this.$el.find(".esoc-user-extended-edit-input").trigger("focus"),this.$el.find(".esoc-user-label").removeClass("esoc-cursor-pointer"),this.$el.find(".esoc-user-extended-edit").removeClass("esoc-edit-icon"),void 0!==t&&0!==t.length||this.$el.find(".esoc-user-extended-edit-input").val(this.util.commonUtil.globalConstants.HTTP_LINK)}},"updateExtendedInfoField":function(t){var i=new FormData,s=this.$el.find(".esoc-user-extended-edit-input").val(),n=/(^(https?):\/\/)/i,o=this.options.connector;s.length>0&&null===s.match(n)&&(s=this.util.commonUtil.globalConstants.HTTP_LINK+s,this.$el.find(".esoc-user-extended-edit-input").val(s)),this.$el.find(".esoc-user-extended-edit-mode").addClass("esoc-extendedinfo-update-mask"),this.$el.find(".esoc-user-extended-edit-input").prop("disabled",!0),i.append(this.util.commonUtil.globalConstants.ACTION,this.util.commonUtil.globalConstants.UPDATE_EXTENDED_INFO),i.append(this.model.attributes.formField,s);var a={"itemview":this,"url":this.util.commonUtil.getV2Url(o.connection.url)+this.util.commonUtil.REST_URLS.pulseRestUrl+this.model.attributes.userid,"type":"POST","data":i,"requestType":"updateExtendedLink","targetElement":e(t.target),"connector":o};this.util.updateAjaxCall(a)},"onShow":function(){this.addEllipsisOnFocus(),this.trigger("view:shown")},"cancelUpdateExtendedInfoField":function(e){this.$el.find(".esoc-user-extended-edit-mode").hide(),this.$el.find(".esoc-user-extended-edit-input").val(this.model.attributes.content),this.$el.find(".esoc-user-extended-view-mode").show(),this.model.attributes.content?this.$el.find(".esoc-user-messages a").trigger("focus"):this.$el.find(".esoc-user-default-content").trigger("focus")},"addEllipsisOnFocus":function(){var t=this;this.$el.find(".esoc-user-links .esoc-user-messages").each(function(i){e(this).innerWidth()<e(this)[0].scrollWidth&&t.$el.find(".esoc-user-messages a").addClass("esoc-user-links-ellipsis-onfocus")})}})}),csui.define("hbs!esoc/widgets/userwidget/impl/general",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.chatSettings:e)?n.presenceEnabled:n,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"        "},"2":function(e,t,i,s){return'            <div id="esoc-user-profile-presence-indicator" class="esoc-user-profile-presence-indicator binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n    binf-col-xs-12"></div>\r\n'},"4":function(e,t,i,s){var n;return'        <div class="esoc-user-title binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</div>\r\n"},"6":function(e,t,i,s){var n;return'        <div\r\n            class="esoc-department-name binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">'+this.escapeExpression((n=null!=(n=t.department_name||(null!=e?e.department_name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"department_name","hash":{}}):n))+"</div>\r\n"},"8":function(e,t,i,s){var n;return'        <div\r\n            class="esoc-user-location binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">'+this.escapeExpression((n=null!=(n=t.office_location||(null!=e?e.office_location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"office_location","hash":{}}):n))+"</div>\r\n"},"10":function(e,t,i,s){var n;return'        <div class="esoc-user-email esoc-user-links binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <a href="mailto:'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.business_email||(null!=e?e.business_email:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"business_email","hash":{}}):n))+"</a>\r\n        </div>\r\n"},"12":function(e,t,i,s){var n,o;return'        <div class="esoc-user-business-phone binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <span\r\n              class="esoc-user-messages-business-phone esoc-user-general-info-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.phone:n,e))+' </span>\r\n          <span class="esoc-user-general-info-content">'+this.escapeExpression((o=null!=(o=t.business_phone||(null!=e?e.business_phone:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"business_phone","hash":{}}):o))+"</span>\r\n        </div>\r\n"},"14":function(e,t,i,s){var n,o;return'        <div class="esoc-user-business-fax binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <span\r\n              class="esoc-user-messages-business-fax esoc-user-general-info-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.fax:n,e))+' </span>\r\n          <span class="esoc-user-general-info-content">'+this.escapeExpression((o=null!=(o=t.business_fax||(null!=e?e.business_fax:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"business_fax","hash":{}}):o))+"</span>\r\n        </div>\r\n"},"16":function(e,t,i,s){var n,o;return'        <div class="esoc-user-time-zone binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <span\r\n              class="esoc-user-messages-timezone esoc-user-general-info-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.timezone:n,e))+' </span>\r\n          <span class="esoc-user-general-info-content">'+this.escapeExpression((o=null!=(o=t.time_zone||(null!=e?e.time_zone:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"time_zone","hash":{}}):o))+"</span>\r\n        </div>\r\n"},"18":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showFacebookLink:n,{"name":"if","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showLinkedinLink:n,{"name":"if","hash":{},"fn":this.program(21,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showTwitterLink:n,{"name":"if","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showReportsTo:n,{"name":"if","hash":{},"fn":this.program(25,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showLangSpoken:n,{"name":"if","hash":{},"fn":this.program(27,s,0),"inverse":this.noop}))?n:"")},"19":function(e,t,i,s){return'        <div class="esoc-user-facebook-link"></div>\r\n'},"21":function(e,t,i,s){return'        <div class="esoc-user-linked-link"></div>\r\n'},"23":function(e,t,i,s){return'        <div class="esoc-user-twitter-link"></div>\r\n'},"25":function(e,t,i,s){return'        <div class="esoc-user-reports-to"></div>\r\n'},"27":function(e,t,i,s){return'        <div class="esoc-user-languages-spoken"></div>\r\n'},"29":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.statusPost:n,{"name":"if","hash":{},"fn":this.program(30,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showAboutMe:n,{"name":"if","hash":{},"fn":this.program(32,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showJobDesc:n,{"name":"if","hash":{},"fn":this.program(34,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showExpertise:n,{"name":"if","hash":{},"fn":this.program(36,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showPastPositions:n,{"name":"if","hash":{},"fn":this.program(38,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showDegrees:n,{"name":"if","hash":{},"fn":this.program(40,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showAwards:n,{"name":"if","hash":{},"fn":this.program(42,s,0),"inverse":this.noop}))?n:"")},"30":function(e,t,i,s){return'        <div class="esoc-user-status-post"></div>\r\n'},"32":function(e,t,i,s){return'        <div class="esoc-user-about-me"></div>\r\n'},"34":function(e,t,i,s){return'        <div class="esoc-user-job-description"></div>\r\n'},"36":function(e,t,i,s){return'        <div class="esoc-user-expertise"></div>\r\n'},"38":function(e,t,i,s){return'        <div class="esoc-user-past-positions"></div>\r\n'},"40":function(e,t,i,s){return'        <div class="esoc-user-degree"></div>\r\n'},"42":function(e,t,i,s){return'        <div class="esoc-user-awards"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="esoc-general-tab-content binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="esoc-general-tab-sub-content binf-col-lg-6 binf-col-md-6 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="esoc-user-general-details binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-user-name binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.chatSettings:e)?n.chatEnabled:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+"</div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.title:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.department_name:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.office_location:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.business_email:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.business_phone:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.business_fax:e,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.time_zone:n,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+"    </div>\r\n\r\n"+(null!=(n=t.if.call(e,null!=e?e.errorMessage:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(18,s,0)}))?n:"")+'  </div>\r\n  <div class="esoc-general-tab-sub-content binf-col-lg-6 binf-col-md-6 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=t.if.call(e,null!=e?e.errorMessage:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(29,s,0)}))?n:"")+"  </div>\r\n</div>\r\n"}});return i.registerPartial("esoc_widgets_userwidget_impl_general",s),s}),csui.define("esoc/widgets/userwidget/view/general.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/connector","esoc/widgets/userwidget/model/extended.model","esoc/widgets/userwidget/util","esoc/widgets/userwidget/view/extendedinfotextfield.view","esoc/widgets/userwidget/view/extendedinfolinkfield.view","esoc/widgets/userwidget/chat/view/presence.view","esoc/widgets/userwidget/chat/chatfactory","hbs!esoc/widgets/userwidget/impl/general","i18n!esoc/widgets/userwidget/nls/lang","csui/controls/tile/behaviors/perfect.scrolling.behavior"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h){return n.ItemView.extend({"tagName":"div","className":"esoc-general-tab binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12","template":m,"util":l,"templateHelpers":function(){var e=this.options.model.attributes.extendedInfo,t=!this.options.model.attributes.otherUser&&!!e&&e.isEditable;return{"messages":{"phone":p.phone,"fax":p.fax,"timezone":p.timezone,"showFacebookLink":t||!!e&&!!e.facebookLink,"showLinkedinLink":t||!!e&&!!e.linkedinLink,"showTwitterLink":t||!!e&&!!e.twitterLink,"showReportsTo":t||!!e&&!!e.reportsTo,"showLangSpoken":t||!!e&&!!e.languagesSpoken,"showAboutMe":t||!!e&&!!e.bio,"statusPost":!1,"showJobDesc":t||!!e&&!!e.jobDescription,"showExpertise":t||!!e&&!!e.expertise,"showPastPositions":t||!!e&&!!e.pastPositions,"showDegrees":t||!!e&&!!e.degree,"showAwards":t||!!e&&!!e.awardsHonours,"time_zone":!!this.options.model.attributes.time_zone&&-1!==this.options.model.attributes.time_zone}}},"behaviors":{"PerfectScrolling":{"behaviorClass":h,"suppressScrollX":!0,"contentParent":".esoc-general-tab-content","scrollYMarginOffset":15}},"initialize":function(e){var s=[];if(this.options=e,this.options.connector||(this.options.connector=this.options.context.getObject(o)),!this.options.model.attributes.isError){var n=this,a=i.Model.extend({}),l=this.templateHelpers().messages,d=this.model.attributes.extendedInfo,u={"userid":this.model.attributes.userid,"connector":this.options.connector,"isEditable":!this.model.attributes.otherUser&&!!d&&d.isEditable};l.showFacebookLink&&(this.facebookLinkInfo=new a(t.extend({"label":p.facebookLink,"content":this.util.getValidLink(d.facebookLink),"formField":"facebookLink","defaultMessage":p.defaultfacebookMessage,"linkClass":"esoc-user-facebook-link"},u)),this.facebookLinkView=new c({"model":this.facebookLinkInfo,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.facebookLinkView)),l.showLinkedinLink&&(this.linkedLinkInfo=new a(t.extend({"label":p.linkedinLink,"content":this.util.getValidLink(d.linkedinLink),"formField":"linkedinLink","defaultMessage":p.defaultLinkedInMessage,"linkClass":"esoc-user-linkedin-link"},u)),this.linkedInLinkView=new c({"model":this.linkedLinkInfo,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.linkedInLinkView)),l.showTwitterLink&&(this.twitterLinkInfo=new a(t.extend({"label":p.twitterLink,"content":this.util.getValidLink(d.twitterLink),"formField":"twitterLink","defaultMessage":p.defaulttwitterLinkMessage,"linkClass":"esoc-user-twitter-link"},u)),this.twitterLinkView=new c({"model":this.twitterLinkInfo,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.twitterLinkView)),l.showReportsTo&&(this.reportsInfo=new a(t.extend({"label":p.manager,"content":d.reportsToID,"reportsTo":d.reportsTo&&d.reportsTo.trim()?d.reportsTo:"","formField":"reportsTo","defaultMessage":p.defaultManagerMessage,"userInputField":!0,"extendedLabelClass":"esoc-user-extended-label"},u)),this.reportsView=new r({"model":this.reportsInfo,"context":this.options.context,"parentView":n,"tabIndex":this.options.tabIndex}),s.push(this.reportsView)),l.showLangSpoken&&(this.langSpokenInfo=new a(t.extend({"label":p.languagesSpoken,"content":d.languagesSpoken&&d.languagesSpoken.trim()?d.languagesSpoken:"","formField":"languagesSpoken","defaultMessage":p.defaultLanguagesMessage,"extendedLabelClass":"esoc-user-extended-label"},u)),this.langSpokenView=new r({"model":this.langSpokenInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.langSpokenView)),l.statusPost&&(this.statusPostInfo=new a(t.extend({"label":p.statusPost,"content":d.status&&d.status.trim()?d.status:"","formField":"status","defaultMessage":p.defaultStatusPost},u)),this.statusPostView=new r({"model":this.statusPostInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.statusPostView)),l.showAboutMe&&(this.aboutMeInfo=new a(t.extend({"label":p.aboutMe,"content":d.bio&&d.bio.trim()?d.bio:"","formField":"bio","defaultMessage":p.defaultAboutMeMessage},u)),this.aboutMeView=new r({"model":this.aboutMeInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.aboutMeView)),l.showJobDesc&&(this.jobDescriptionInfo=new a(t.extend({"label":p.jobDescription,"content":d.jobDescription&&d.jobDescription.trim()?d.jobDescription:"","formField":"jobDescription","defaultMessage":p.defaultJobDesc},u)),this.jobDescriptionView=new r({"model":this.jobDescriptionInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.jobDescriptionView)),l.showExpertise&&(this.expertiseInfo=new a(t.extend({"label":p.expertiseAreas,"content":d.expertise&&d.expertise.trim()?d.expertise:"","formField":"expertise","defaultMessage":p.defaultExpertise},u)),this.expertiseView=new r({"model":this.expertiseInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.expertiseView)),l.showPastPositions&&(this.pastPositionsInfo=new a(t.extend({"label":p.pastPositions,"content":d.pastPositions&&d.pastPositions.trim()?d.pastPositions:"","formField":"pastPositions","defaultMessage":p.defaultPastPositions},u)),this.pastPositionsView=new r({"model":this.pastPositionsInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.pastPositionsView)),l.showDegrees&&(this.degreeInfo=new a(t.extend({"label":p.degrees,"content":d.degree&&d.degree.trim()?d.degree:"","formField":"degree","defaultMessage":p.defaultDegreeMessage},u)),this.degreeView=new r({"model":this.degreeInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.degreeView)),l.showAwards&&(this.awardsInfo=new a(t.extend({"label":p.awards,"content":d.awardsHonours&&d.awardsHonours.trim()?d.awardsHonours:"","formField":"awardsHonours","defaultMessage":p.defaultAwardMessage},u)),this.awardsView=new r({"model":this.awardsInfo,"parentView":n,"tabIndex":this.options.tabIndex,"connector":this.options.connector}),s.push(this.awardsView)),this.childViews=s}},"constructor":function(e){e=e||{};var i=t.extend({},e);i.model=new a(i),i.model.fetch({"success":i.model.fetchSuccess,"error":i.model.fetchError,"async":!1}),n.ItemView.prototype.constructor.call(this,i)},"errorHandle":function(e,t){},"onShow":function(i){if(this.model.attributes.chatSettings&&this.model.attributes.chatSettings.chatEnabled&&this.model.attributes.chatSettings.presenceEnabled){var s={"id":this.model.attributes.id,"context":this.options.context,
"username":this.model.attributes.name,"subscribeEvent":!0},o=new n.Region({"el":e("#esoc-user-profile-presence-indicator")}),a=new d(s);o.show(a)}var l=this.templateHelpers().messages,r=this;if(!this.options.model.attributes.isError){var c=0;if(t.each(this.childViews,function(e){r.listenToOnce(e,"view:shown",function(){++c===r.childViews.length&&r.trigger("view:shown")}),r.listenTo(e,"change:content",function(t){r.trigger("view:shown","contentChanged"),"userInputChanged"===t&&e.$el.find("a.esoc-user-container").trigger("focus")})}),l.showFacebookLink){new n.Region({"el":".esoc-user-facebook-link"}).show(this.facebookLinkView)}if(l.showLinkedinLink){new n.Region({"el":".esoc-user-linked-link"}).show(this.linkedInLinkView)}if(l.showTwitterLink){new n.Region({"el":".esoc-user-twitter-link"}).show(this.twitterLinkView)}if(l.showReportsTo){new n.Region({"el":".esoc-user-reports-to"}).show(this.reportsView)}if(l.showLangSpoken){new n.Region({"el":".esoc-user-languages-spoken"}).show(this.langSpokenView)}if(l.statusPost){new n.Region({"el":".esoc-user-status-post"}).show(this.statusPostView)}if(l.showAboutMe){new n.Region({"el":".esoc-user-about-me"}).show(this.aboutMeView)}if(l.showJobDesc){new n.Region({"el":".esoc-user-job-description"}).show(this.jobDescriptionView)}if(l.showExpertise){new n.Region({"el":".esoc-user-expertise"}).show(this.expertiseView)}if(l.showPastPositions){new n.Region({"el":".esoc-user-past-positions"}).show(this.pastPositionsView)}if(l.showDegrees){new n.Region({"el":".esoc-user-degree"}).show(this.degreeView)}if(l.showAwards){new n.Region({"el":".esoc-user-awards"}).show(this.awardsView)}}this.$el.find(".esoc-user-links.esoc-user-email").each(function(t){e(this).innerWidth()<e(this)[0].scrollWidth&&r.$el.find(".esoc-user-email a").addClass("esoc-user-links-ellipsis-onfocus")})}})}),csui.define("hbs!esoc/widgets/userwidget/impl/personal",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="binf-col-lg-12">\r\n    <span class="binf-col-lg-1 binf-col-md-1 binf-col-sm-1 binf-col-xs-1">Location  : </span>\r\n    <span class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2">'+this.escapeExpression((n=null!=(n=t.office_location||(null!=e?e.office_location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"office_location","hash":{}}):n))+" </span>\r\n</div>\r\n"}});return i.registerPartial("esoc_widgets_userwidget_impl_personal",s),s}),csui.define("esoc/widgets/userwidget/view/personal.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","hbs!esoc/widgets/userwidget/impl/personal","i18n!esoc/widgets/userwidget/nls/lang"],function(e,t,i,s,n,o){var a=null;return s.ItemView.extend({"tagName":"div","className":"esoc-personal-tab","template":n,"initialize":function(e){this.options=e,a=this},"constructor":function(e){e=e||{},s.ItemView.prototype.constructor.call(this,e)},"errorHandle":function(e,t){}})}),csui.define("esoc/widgets/userwidget/view/miniprofilecard.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","csui/utils/user.avatar.color","esoc/widgets/userwidget/view/miniprofile.view","esoc/widgets/utils/chat/chat.view","esoc/widgets/userwidget/util","esoc/widgets/userwidget/chat/chatutil","i18n!esoc/widgets/userwidget/nls/lang","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d){return a.extend({"util":r,"className":"esoc-miniprofilecard-container binf-col-lg-5 binf-col-md-5 binf-col-sm-5 binf-col-xs-5","initialize":function(e){this.options=e,this.followUnfollowActionUrl=n.combine(this.util.commonUtil.getV2Url(this.model.collection.connector.connection.url),this.util.commonUtil.REST_URLS.pulseRestUrl,this.model.attributes.id)},"constructor":function(e){e=e||{},s.ItemView.prototype.constructor.call(this,e),this.model.on("presence:update",this.onPresenceUpdate,this)},"events":{"click .esoc-viewminiprofile-action, .esoc-mini-profile-avatar, .esoc-mini-profile-user-name":"showUserProfileDialog","click .esoc-mini-profile-following-action":"followUnfollowAction","mouseenter .esoc-miniprofile-view":"showActions","mouseleave .esoc-miniprofile-view":"hideActions"},"showActions":function(){this.$el.find(".esoc-mini-profile-userinfo").addClass("esoc-mini-profile-userinfo-with-actions"),this.$el.find(".esoc-mini-profile-actions").show()},"hideActions":function(){this.$el.find(".esoc-mini-profile-actions").hide(),this.$el.find(".esoc-mini-profile-userinfo").removeClass("esoc-mini-profile-userinfo-with-actions"),this.$el.find(".esoc-mini-profile-actions").hasClass("esoc-miniprofile-has-tabindex")&&(this.options.model.attributes.business_email?this.$el.find(".esoc-mini-profile-userinfo").find(".esoc-mini-profile-user-email").trigger("focus"):this.$el.find(".esoc-mini-profile-userinfo").find(".esoc-mini-profile-user-name").trigger("focus"),this.$el.find(".esoc-mini-profile-actions").removeClass("esoc-miniprofile-has-tabindex"))},"onRender":function(t){var i=this;if(i.options.userbackgroundcolor=o.getUserAvatarColor(i.model.attributes),i.model.attributes.chatSettings&&i.model.attributes.chatSettings.chatEnabled&&i.model.attributes.chatSettings.presenceEnabled&&i.$el.find("#esoc-mini-profile-presence-indicator").addClass("esoc-user-profile-default-presence").attr("title",d.presenceUnknownTooltipText),i.model.attributes.otherUser&&i.model.attributes.chatSettings&&i.model.attributes.chatSettings.chatEnabled){i.$el.find(".esoc-chat-action-enabled-"+i.model.attributes.id).removeClass("binf-hidden");var n=new s.Region({"el":i.$el.find(".esoc-miniprofile-chat-action")}),a={"context":i.options.parentViewOptions.context,"tguser":i.model.get("screen_name")||i.model.get("name"),"domain":i.options.model.get("chatSettings")&&i.options.model.get("chatSettings").chatDomain},r=new l(a);n.show(r)}else i.$el.find(".esoc-chat-action-disabled-"+i.model.attributes.id).removeClass("binf-hidden");i.$el.find(".esoc-mini-profile-user").find(".esoc-mini-profile-pic").on("keyup",function(t){9===(t.keyCode||t.which)&&e(".esoc-mini-profile-actions").hasClass("esoc-miniprofile-has-tabindex")&&e(".esoc-mini-profile-actions").removeClass("esoc-miniprofile-has-tabindex")}),i.$el.find(".esoc-mini-profile-actions").find(".esoc-mini-profile-following-action, .esoc-viewminiprofile-action").on("keyup",function(e){9===(e.keyCode||e.which)&&i.$el.find(".esoc-mini-profile-actions").addClass("esoc-miniprofile-has-tabindex")})},"onShow":function(){this.setProfilePic()},"setProfilePic":function(){var e=this.options.model.attributes.id,t={"context":this.options.parentViewOptions.context,"userid":e,"photoElement":this.$el.find(".esoc-userprofile-img-"+r.escapeSelector(e)),"defaultPhotElement":this.$el.find(".esoc-user-default-avatar-"+r.escapeSelector(e)),"userbackgroundcolor":this.options.userbackgroundcolor};this.util.commonUtil.setProfilePic(t),this.util.commonUtil.setUserColor(t)},"showUserProfileDialog":function(e){this.trigger("show.user.dialog")},"followUnfollowAction":function(t){var i=new FormData,s=t||window.event,n=this.model.attributes.following?r.commonUtil.globalConstants.UNFOLLOW:r.commonUtil.globalConstants.FOLLOW;i.append(r.commonUtil.globalConstants.ACTION,n);var o={"itemview":this,"url":this.followUnfollowActionUrl,"type":"POST","data":i,"requestType":"relation","targetElement":e(s.target)};this.util.updateAjaxCall(o)},"onPresenceUpdate":function(e){c.setIconColor(e,this.$el.find("#esoc-mini-profile-presence-indicator"))}})}),csui.define("esoc/widgets/userwidget/view/miniprofilecollection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/connector","esoc/widgets/userwidget/view/miniprofilecard.view","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/userwidget/util","csui/controls/tile/behaviors/perfect.scrolling.behavior"],function(e,t,i,s,n,o,a,l,r){var c=null;return s.CollectionView.extend({"tagName":"div","className":"binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-miniprofile-collection","childView":o,"childViewOptions":function(){return{"context":this.options.context,"parentViewOptions":this.options}},"initialize":function(t){this.options=t,this.options.connector||(this.options.connector=this.options.context.getObject(n)),c=this,this.listenTo(this,"childview:show.user.dialog",function(e){c.trigger("collectionview.show.user.dialog",e)}),this.listenTo(l.commonUtil.globalConstants.event_bus,"changefollowingstatus",function(t,i){if(e("#esoc-user-profile-following-tab").hasClass("binf-active")&&!e("#esoc-social-comment-create-container").is(":visible")||e("#esoc-user-profile-activity-tab").hasClass("binf-active")&&!e("#esoc-social-comment-create-container").is(":visible")||e("#esoc-user-profile-followers-tab").hasClass("binf-active")&&!e("#esoc-social-comment-create-container").is(":visible")){var s,n=this.options.collection.get(t.model.attributes.id);if(n){var o=n.attributes;o.relation===l.commonUtil.globalConstants.FRIENDS?o.otherUserProfile?(s=t.model.attributes.following,o.following=s,s?(o.actions.following=a.unfollow,o.actions.followingClass="esoc-mini-profile-unfollow-icon"):(o.actions.following=a.follow,o.actions.followingClass="esoc-mini-profile-follow-icon"),this.render()):(this.options.collection.remove(t.model.attributes.id),this.options.collection.trigger("remove.relation",t,i)):o.relation===l.commonUtil.globalConstants.FOLLOWERS&&(s=t.model.attributes.following,o.following=s,o.following=s,s?(o.actions.following=a.unfollow,o.actions.followingClass="esoc-mini-profile-unfollow-icon"):(o.actions.following=a.follow,o.actions.followingClass="esoc-mini-profile-follow-icon"),this.render(),o.otherUserProfile||l.changeRelationsCounts(i.data.user))}else if(this.options.relation===l.commonUtil.globalConstants.FRIENDS&&!this.options.otherUserProfile){var r={"itemview":c,"url":c.options.connector.connection.url+l.commonUtil.REST_URLS.chatHistoryUrl+t.model.attributes.id,"type":"GET","relation":this.options.relation,"otherUserProfile":this.options.otherUserProfile,"requestType":"membersAPI","context":this.options.context};l.updateAjaxCall(r)}}}),this.listenTo(l.commonUtil.globalConstants.event_bus,"updatefollowerstab",function(t,i){if((e("#esoc-user-profile-following-tab").hasClass("binf-active")&&!e("#esoc-social-comment-create-container").is(":visible")||e("#esoc-user-profile-activity-tab").hasClass("binf-active")&&!e("#esoc-social-comment-create-container").is(":visible")||e("#esoc-user-profile-followers-tab").hasClass("binf-active")&&!e("#esoc-social-comment-create-container").is(":visible"))&&this.options.relation===l.commonUtil.globalConstants.FOLLOWERS)if(this.options.collection.get(this.options.loggedUserId))this.options.collection.remove(this.options.loggedUserId),this.options.collection.trigger("remove.relation",t,i);else{var s={"itemview":c,"url":c.options.connector.connection.url+l.commonUtil.REST_URLS.chatHistoryUrl+this.options.loggedUserId,"type":"GET","requestType":"membersAPI","context":this.options.context};l.updateAjaxCall(s)}})},"onRender":function(t){var i;this.$el.on("scroll",function(t,s){var n=e(this),o=n.height(),a=n[0].scrollHeight,l=n.scrollTop();l+17>=a-o&&(!i||i&&l-parseInt(i,10)>50)&&(i=l,e(this).find(".esoc-social-users-load-more:last").trigger("click"))})},"behaviors":{"PerfectScrolling":{"behaviorClass":r,"suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(){s.CollectionView.prototype.constructor.apply(this,arguments)},"errorHandle":function(e,t){},"events":{"click .esoc-social-users-load-more":"loadMoreItems"},"loadMoreItems":function(e){this.collection.defaults.params.cursor>0&&this.collection.fetch({"remove":!1,"params":{"cursor":this.collection.defaults.params.cursor},"success":this.collection.fetchSuccess})}})}),csui.define("esoc/widgets/activityfeedwidget/activityfeeditem.model",["csui/lib/jquery","csui/lib/backbone"],function(e,t,i){return t.Model.extend({"defaults":{"id":0,"data_id":0,"created_at":"-","text":"-","feed_event_type":0,"user":{"name":"-","screen_name":"-","profile_image_url":"-"},"noMoreData":!0},"constructor":function(){t.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("esoc/widgets/activityfeedwidget/activityfeed.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/base","csui/utils/url","csui/behaviors/default.action/impl/defaultaction","csui/models/connectable","csui/models/fetchable","csui/models/nodechildrencolumn","csui/models/nodechildrencolumns","csui/models/node/node.model","csui/models/clientsidecollection","esoc/widgets/activityfeedwidget/activityfeeditem.model","esoc/widgets/common/util"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p){var h=r.extend({}),f=(c.extend({"model":h,"getColumnModels":function(t,i){var s=c.prototype.getColumnModels.call(this,t,i);return e.each(s,function(e){var t=e.column_key;"type"!==t&&"name"!==t&&"modify_date"!==t||(e.sort=!0)}),s}}),d.extend({"parse":function(e,t){return e.name=e.text,d.prototype.parse.call(this,e,t)}}));return i.Collection.extend(e.extend({},a(i.Collection),l(i.Collection),u(),{"defaults":{"params":{"data_id":"","text":"","since_id":"","max_id":""}},"model":f,"base":s,"feedRESTUrl":"","constRESTUrl":"","maxMessageLength":"","feedtype":"","widgetOptions":{},"context":"","commonUtil":p,"config_settings":{},"url":function(){return this.constructURL(this.options),this.feedRESTUrl},"constructURL":function(e){if(e){this.options=e||{},this.constRESTUrl=e.connector?e.connector.connection.url:this.connector.connection.url,this.constRESTUrl+="/pulse/statuses/public_timeline?commands=default&count="+(e.feedsize?e.feedsize:15)+"&includes=actions,reply_count&where_feedtype="+(e.feedtype?e.feedtype:"all");var i,s,a="";void 0!==e.honorfeedsource?i=e.honorfeedsource:e.activityfeed&&void 0!==e.activityfeed.honorfeedsource&&(i=e.activityfeed.honorfeedsource),void 0!==e.objectnodeid?s=e.objectnodeid:e.activityfeed&&void 0!==e.activityfeed.objectnodeid&&(s=e.activityfeed.objectnodeid),i&&void 0!==s?a="&where_feedsource=pulsefrom&where_feedsource_id="+s:void 0!==e.feedsource&&(void 0!==e.feedsource.source&&e.feedsource.source&&(a="&where_feedsource="+e.feedsource.source),void 0!==e.feedsource.id&&e.feedsource.id&&(a=a+"&where_feedsource_id="+e.feedsource.id)),void 0!==e.updatesfrom&&(void 0!==e.updatesfrom.from&&e.updatesfrom.from&&(a=a+"&where_updatesfrom="+e.updatesfrom.from),void 0!==e.updatesfrom.id&&e.updatesfrom.id&&(a=a+"&where_updatesfrom_id="+e.updatesfrom.id));var l=new o,r={"commands":l.actionItems.getAllCommandSignatures(l.commands)};if(this.constRESTUrl=n.appendQuery(this.constRESTUrl,n.combineQueryString(r))+a,this.feedRESTUrl=this.constRESTUrl,e.params=t.extend(this.defaults.params,e.params),e.params.queryParams){var c=void 0!==e.params.queryParams?"&"+t.param(e.params.queryParams):"";this.feedRESTUrl=this.constRESTUrl+c}delete this.widgetOptions.remove,delete e.remove,this.widgetOptions=t.extend(this.widgetOptions,e)}return this.constRESTUrl},"constructor":function(e,s){if(this.options=s||{},s&&s.connector&&s.connector.assignTo(this),s){this.defaults.params=t.extend(this.defaults.params,s.params),this.constRESTUrl=s.connector.connection.url,this.constRESTUrl+="/pulse/statuses/public_timeline?commands=default&count="+(s.feedsize?s.feedsize:15)+"&includes=actions,reply_count&where_feedtype="+(s.feedtype?s.feedtype:"all");var n,o,a="";void 0!==s.honorfeedsource?n=s.honorfeedsource:s.activityfeed&&void 0!==s.activityfeed.honorfeedsource&&(n=s.activityfeed.honorfeedsource),void 0!==s.objectnodeid?o=s.objectnodeid:s.activityfeed&&void 0!==s.activityfeed.objectnodeid&&(o=s.activityfeed.objectnodeid),n&&void 0!==o?a="&where_feedsource=pulsefrom&where_feedsource_id="+o:void 0!==s.feedsource&&(void 0!==s.feedsource.source&&s.feedsource.source&&(a="&where_feedsource="+s.feedsource.source),void 0!==s.feedsource.id&&s.feedsource.id&&(a=a+"&where_feedsource_id="+s.feedsource.id)),void 0!==s.updatesfrom&&(void 0!==s.updatesfrom.from&&s.updatesfrom.from&&(a=a+"&where_updatesfrom="+s.updatesfrom.from),void 0!==s.updatesfrom.id&&s.updatesfrom.id&&(a=a+"&where_updatesfrom_id="+s.updatesfrom.id)),this.constRESTUrl=this.constRESTUrl+a,this.feedRESTUrl=this.constRESTUrl,this.enableComments=s.enableComments,this.enableFilters=s.enableFilters,this.maxMessageLength=s.maxMessageLength,this.feedtype=s.feedtype,this.context=void 0!==s.context?s.context:s.activityfeed.context,this.widgetOptions=t.extend(s,this.widgetOptions)}i.Collection.prototype.constructor.apply(this,arguments)},"fetch":function(i){return i&&!t.isEmptyObject(i)&&e.extend(this.options,i),this.Fetchable.fetch.apply(this,arguments)},"parse":function(e){var t=JSON.parse(JSON.stringify(e.data));return this.config_settings=e.config_settings,this.parseActivityFeedResponse(t)},"fetchError":function(e,t){var i={"parent":"body","errorContent":t.responseJSON?t.responseJSON.errorDetail?t.responseJSON.errorDetail:t.responseJSON.error:e.lang.defaultErrorMessageCommentsFetch};e.commonUtil.openErrorDialog(i)},"parseActivityFeedResponse":function(e){for(var i in e){var s=e[i];s.commentText=t.trim(s.text),s.maxMessageLength=this.maxMessageLength,s.feedtype=this.options.feedtype?this.options.feedtype:this.feedtype,s.widgetOptions=this.widgetOptions,s.config_settings=this.config_settings,s.created_at_iso8601=this.base.formatFriendlyDateTimeNow(s.created_at_iso8601),""!==s.modified_at_iso8601&&void 0!==s.modified_at_iso8601&&(s.modified_at_iso8601=this.base.formatFriendlyDateTimeNow(s.modified_at_iso8601))}return e}}))}),csui.define("esoc/widgets/activityfeedwidget/activityfeedfactory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/utils/namedsessionstorage","esoc/widgets/activityfeedwidget/activityfeed.model","csui/utils/contexts/factories/node"],function(e,t,i,s,n,o,a,l){return s.extend({"propertyPrefix":"activityfeed","uniqueid":"all","namedSessionStorage":new o("esoc-activity-filterinfo"),"constructor":function(o,r){s.prototype.constructor.apply(this,arguments),this.options.activityfeed=this.options[this.uniqueid]||{};var c,d=this.options.filterSource?this.options.filterSource+"_"+this.uniqueid:this.uniqueid;c=this.namedSessionStorage.get(d),this.options.activityfeed=this.options[this.uniqueid]||{},this.options.activityfeed.widgetId=this.uniqueid,c&&(c.feedtype&&(this.options.activityfeed.feedtype=c.feedtype),c.updatesfrom&&(this.options.activityfeed.updatesfrom=c.updatesfrom));var u=this.options.activityfeed||{};if(!(u instanceof i.Collection)){var m=o.getObject(n,r),p=o.getObject(l),h=e.config();this.options.connector=m,this.options.feedsize=void 0!==this.options.activityfeed.feedsize?parseInt(this.options.activityfeed.feedsize,10):15,this.options.feedtype=void 0!==this.options.activityfeed.feedtype?this.options.activityfeed.feedtype:"all",void 0!==this.options.activityfeed.feedSettings&&void 0!==this.options.activityfeed.feedSettings.enableComments?this.options.enableComments=this.options.activityfeed.feedSettings.enableComments:this.options.enableComments=!0,void 0!==this.options.activityfeed.feedSettings&&void 0!==this.options.activityfeed.feedSettings.enableFilters?this.options.enableFilters=this.options.activityfeed.feedSettings.enableFilters:this.options.enableFilters=!1;var f=void 0!==this.options.activityfeed.honorfeedsource&&this.options.activityfeed.honorfeedsource;f&&(this.options.honorfeedsource=f,void 0!==p.get("id")&&(this.options.objectnodeid=p.get("id"))),void 0!==this.options.activityfeed.feedsource?this.options.feedsource=this.options.activityfeed.feedsource:this.options.feedsource={"source":"all"},void 0!==this.options.activityfeed.updatesfrom?this.options.updatesfrom=this.options.activityfeed.updatesfrom:this.options.updatesfrom={"from":"all"},void 0!==this.options.activityfeed.wrapperClass&&(this.options.wrapperClass=this.options.activityfeed.wrapperClass);var g;void 0!==this.options.activityfeed.config_settings&&void 0!==this.options.activityfeed.config_settings.feedsAutoRefreshWait&&(g=this.options.activityfeed.config_settings.feedsAutoRefreshWait),this.options.config_settings={"feedsAutoRefreshWait":g},this.options.maxMessageLength=void 0!==this.options.activityfeed.config_settings&&void 0!==this.options.activityfeed.config_settings.maxMessageLength?parseInt(this.options.activityfeed.config_settings.maxMessageLength,10):void 0,u=new a(u.models,t.extend({"connector":m,"context":o},this.options,h.options,{"autoreset":!0}))}this.property=u},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("hbs!esoc/widgets/activityfeedwidget/activityfeed",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-comment-list-divider"></div>\r\n'},"3":function(e,t,i,s){var n;return"            "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.actionType:n,e))+"\r\n"},"5":function(e,t,i,s){var n;return"            "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.textmsg:n,e))+"\r\n"},"7":function(e,t,i,s){var n;return'            <span class="esoc-social-comment-timestamp">'+this.escapeExpression((n=null!=(n=t.created_at_iso8601||(null!=e?e.created_at_iso8601:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"created_at_iso8601","hash":{}}):n))+"</span>\r\n"},"9":function(e,t,i,s){var n,o;return'            <span class="esoc-social-comment-timestamp">\r\n              <span class="esoc-social-comment-timestamp-ago" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.modifiedAt:n,e))+'">\r\n              </span>\r\n              '+this.escapeExpression((o=null!=(o=t.modified_at_iso8601||(null!=e?e.modified_at_iso8601:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"modified_at_iso8601","hash":{}}):o))+"\r\n            </span>\r\n"},"11":function(e,t,i,s){var n,o;return'          <div class="esoc-social-comment-list-actions">\r\n            <div class="esoc-social-comment-container esoc-socialactions-getcomments">\r\n              <a class="esoc-social-comment-container" href="javascript:void(0);" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+'"\r\n                 data-value='+this.escapeExpression((o=null!=(o=t.data_id||(null!=e?e.data_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"data_id","hash":{}}):o))+'>\r\n                <span class="esoc-activity-feed-comment">\r\n                  <span class="esoc-cs-icon-feed-comment"\r\n                        data-value='+this.escapeExpression((o=null!=(o=t.data_id||(null!=e?e.data_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"data_id","hash":{}}):o))+' title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+'"></span>\r\n                </span>\r\n              </a>\r\n            </div>\r\n          </div>\r\n'},"13":function(e,t,i,s){var n;return'      <div class="esoc-comment-msg">\r\n        <span>\r\n          <span class="esoc-activity-object-info '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n            <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"\r\n               aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n            <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-object-name"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+"</a>\r\n          </span>\r\n        </span>\r\n      </div>\r\n"},"15":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 2",{"name":"xif","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:""},"16":function(e,t,i,s){var n;return'      <div class="esoc-comment-msg">\r\n        <span class="esoc-status-feed-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.statusfeed:n,e))+'"></span>\r\n        <span class="esoc-social-comment-details esoc-reply-user-widget"></span>\r\n        <span class="esoc-activityfeed-status-action"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.status:n,e))+"</span>\r\n        </span>\r\n      </div>\r\n    "},"18":function(e,t,i,s){var n;return'        <div class="esoc-social-comment-data">\r\n          <span class="esoc-activity-object-info '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype != this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(21,s,0),"inverse":this.noop}))?n:"")+'            <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-object-name"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+"</a>\r\n            </span>\r\n        </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.sgm_description != ''",{"name":"xif","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:"")+"\r\n"},"19":function(e,t,i,s){var n;return'              <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon csui-icon-group"\r\n                 title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">\r\n                <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" />\r\n                <span class="csui-icon csui-icon-shortcut-overlay"></span>\r\n              </a>\r\n'},"21":function(e,t,i,s){var n;return'              <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon  '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"\r\n                 aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n'},"23":function(e,t,i,s){var n;return'          <div class="esoc-extended-view-mode">\r\n            <div class="esoc-social-comment-data">\r\n              <div class="esoc-description">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,e))+'</div>\r\n            </div>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n               class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n              <span class="icon-arrow-down"></span></a>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n               class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n              <span class="icon-arrow-up"></span></a>\r\n          </div>\r\n'},"25":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(26,s,0),"inverse":this.program(28,s,0)}))?n:""},"26":function(e,t,i,s){var n;return'        <div class="esoc-social-comment-data">\r\n          <span class="esoc-activity-object-info '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n            <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon\r\n            '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"\r\n               aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n            <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'"\r\n               class="esoc-object-name  esoc-object-name-with-version"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'</a>\r\n            <span class="esoc-social-version">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.version:n,e))+'</span>\r\n            <span class="esoc-version-number">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.version_name:n,e))+"</span>\r\n          </span>\r\n        </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.sgm_description != ''",{"name":"xif","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:"")+"\r\n"},"28":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 9",{"name":"xif","hash":{},"fn":this.program(29,s,0),"inverse":this.program(31,s,0)}))?n:""},"29":function(e,t,i,s){var n;return'        <div class="esoc-extended-view-mode">\r\n          <div class="esoc-social-comment-data"></div>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n             class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n            <span class="icon-arrow-down"></span></a>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n             class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n            <span class="icon-arrow-up"></span></a>\r\n        </div>\r\n'},"31":function(e,t,i,s){var n,o;return'        <div class="esoc-extended-view-mode">\r\n          <div class="esoc-social-comment-data">'+(null!=(o=null!=(o=t.commentText||(null!=e?e.commentText:e))?o:t.helperMissing,n="function"==typeof o?o.call(e,{"name":"commentText","hash":{}
}):o)?n:"")+'</div>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n             class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n            <span class="icon-arrow-down"></span></a>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n             class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n            <span class="icon-arrow-up"></span></a>\r\n        </div>\r\n      '},"33":function(e,t,i,s){var n;return'      <div class="esoc-social-attachment '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentInactiveClass:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(34,s,0),"inverse":this.program(36,s,0)}))?n:"")+'        <a href="javascript:void(0);" class="esoc-social-attachment-name"\r\n           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+"</a>\r\n      </div>\r\n"},"34":function(e,t,i,s){var n;return'          <span class="csui-icon-group esoc-social-attachment-icon"\r\n                title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">\r\n            <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentMimeTypeClass:n,e))+'" />\r\n            <span class="csui-icon csui-icon-shortcut-overlay"></span>\r\n          </span>\r\n'},"36":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages\r\n        .documentAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(37,s,0),"inverse":this.noop}))?n:""},"37":function(e,t,i,s){var n;return'          <a href="javascript:void(0);" class="esoc-social-attachment-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentMimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'"></a>\r\n        '},"39":function(e,t,i,s){var n;return'  <div id="'+this.escapeExpression((n=null!=(n=t.uniqueId||(null!=e?e.uniqueId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"uniqueId","hash":{}}):n))+'" class="esoc-social-activity-load-more"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.isFirstItem:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'<a href="javascript:void(0);" class="esoc-activity-focus-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userProfileLink:n,e))+'"></a>\r\n<div class="esoc-profileimg-block">\r\n    <span class="esoc-userprofile-img">\r\n        <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.user:e)?n.id:n,e))+' binf-img-circle" src="" />\r\n    </span>\r\n</div>\r\n<div class="esoc-commentinfo-block-wrapper binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="esoc-commentinfo-block binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="esoc-social-comment-details">\r\n      <div class="esoc-comment-user-details binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n        <span class="esoc-user-widget"></span>\r\n        <span class="esoc-activityfeed-actiontype">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 4 || this.feed_event_type == 2",{"name":"xif","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7 || this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.modified_at_iso8601 == ''",{"name":"xif","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+"        </span>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.enableComments:n,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"\r\n      </div>\r\n    </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 4",{"name":"xif","hash":{},"fn":this.program(13,s,0),"inverse":this.program(15,s,0)}))?n:"")+'  </div>\r\n\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div id="esoc-social-comment-input-holder-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7",{"name":"xif","hash":{},"fn":this.program(18,s,0),"inverse":this.program(25,s,0)}))?n:"")+"    </div>\r\n\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_id != '' && (this.extended_info.attachment_subtype ==\r\n    this.messages.shortcutAttachmentSubtype || this.extended_info.attachment_subtype == this\r\n    .messages.documentAttachmentSubtype)",{"name":"xif","hash":{},"fn":this.program(33,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n</div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.noMoreData == false",{"name":"xif","hash":{},"fn":this.program(39,s,0),"inverse":this.noop}))?n:"")+'<span class="esoc-social-comment-delete"></span>\r\n'}});return i.registerPartial("esoc_widgets_activityfeedwidget_activityfeed",s),s}),csui.define("hbs!esoc/widgets/activityfeedwidget/activityfeedstandard",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-comment-list-divider"></div>\r\n'},"3":function(e,t,i,s){var n;return"            "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.actionType:n,e))+"\r\n"},"5":function(e,t,i,s){var n;return"            "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.textmsg:n,e))+"\r\n"},"7":function(e,t,i,s){var n;return'            <span class="esoc-social-comment-timestamp">'+this.escapeExpression((n=null!=(n=t.created_at_iso8601||(null!=e?e.created_at_iso8601:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"created_at_iso8601","hash":{}}):n))+"</span>\r\n"},"9":function(e,t,i,s){var n,o;return'            <span class="esoc-social-comment-timestamp">\r\n              <span class="esoc-social-comment-timestamp-ago" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.modifiedAt:n,e))+'">\r\n            </span>\r\n              '+this.escapeExpression((o=null!=(o=t.modified_at_iso8601||(null!=e?e.modified_at_iso8601:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"modified_at_iso8601","hash":{}}):o))+"\r\n            </span>\r\n"},"11":function(e,t,i,s){var n;return'        <div class="esoc-social-comment-list-actions">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.enableComments:n,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n"},"12":function(e,t,i,s){var n,o;return'            <div class="esoc-social-comment-container esoc-socialactions-getcomments">\r\n              <a class="esoc-social-comment-container" href="javascript:void(0);" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+'">\r\n                   <span class="esoc-activity-feed-comment">\r\n                     <span class="esoc-cs-icon-feed-comment"\r\n                           data-value='+this.escapeExpression((o=null!=(o=t.data_id||(null!=e?e.data_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"data_id","hash":{}}):o))+' title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+'"></span>\r\n                   </span>\r\n              </a>\r\n            </div>\r\n'},"14":function(e,t,i,s){var n;return'    <div class="esoc-comment-msg">\r\n        <span>\r\n         <span class="esoc-activity-object-info '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n           <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n            <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-object-name"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+"</a>\r\n          </span>\r\n        </span>\r\n    </div>\r\n"},"16":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 2",{"name":"xif","hash":{},"fn":this.program(17,s,0),"inverse":this.noop}))?n:""},"17":function(e,t,i,s){var n;return'      <div class="esoc-comment-msg">\r\n        <span class="esoc-status-feed-icon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.statusfeed:n,e))+'"></span>\r\n        <span class="esoc-social-comment-details esoc-reply-user-widget"></span>\r\n        <span class="esoc-activityfeed-status-action"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.status:n,e))+"</span>\r\n        </span>\r\n      </div>\r\n  "},"19":function(e,t,i,s){var n;return'      <div class="esoc-social-comment-data">\r\n      <span class="esoc-activity-object-info '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(20,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype != this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(22,s,0),"inverse":this.noop}))?n:"")+'        <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-object-name"\r\n           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+"</a>\r\n            </span>\r\n      </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.sgm_description != ''",{"name":"xif","hash":{},"fn":this.program(24,s,0),"inverse":this.noop}))?n:"")},"20":function(e,t,i,s){var n;return'                <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'"\r\n                   class="esoc-social-mime-icon csui-icon-group" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"\r\n                   aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">\r\n                  <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" />\r\n                  <span class="csui-icon csui-icon-shortcut-overlay"></span>\r\n                </a>\r\n'},"22":function(e,t,i,s){var n;return'          <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n'},"24":function(e,t,i,s){var n;return'        <div class="esoc-extended-view-mode">\r\n          <div class="esoc-social-comment-data">\r\n            <div class="esoc-description">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,e))+'</div>\r\n          </div>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n             class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n            <span class="icon-arrow-down"></span></a>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n             class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n            <span class="icon-arrow-up"></span></a>\r\n        </div>\r\n'},"26":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(27,s,0),"inverse":this.program(30,s,0)}))?n:""},"27":function(e,t,i,s){var n;return'        <div class="esoc-social-comment-data">\r\n           <span class="esoc-activity-object-info '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n              <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"\r\n                 aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n              <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'"\r\n                 class="esoc-object-name  esoc-object-name-with-version"\r\n                 title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'</a>\r\n              <span class="esoc-social-version">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.version:n,e))+'</span>\r\n              <span class="esoc-version-number">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.version_name:n,e))+"</span>\r\n            </span>\r\n        </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.sgm_description != ''",{"name":"xif","hash":{},"fn":this.program(28,s,0),"inverse":this.noop}))?n:"")+"\r\n"},"28":function(e,t,i,s){var n;return'          <div class="esoc-extended-view-mode">\r\n            <div class="esoc-social-comment-data">\r\n              <div class="esoc-description">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,e))+'</div>\r\n            </div>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n               class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n              <span class="icon-arrow-down"></span></a>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n               class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n              <span class="icon-arrow-up"></span></a>\r\n          </div>\r\n'},"30":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 9",{"name":"xif","hash":{},"fn":this.program(31,s,0),"inverse":this.program(33,s,0)}))?n:""},"31":function(e,t,i,s){var n;return'          <div class="esoc-extended-view-mode">\r\n            <div class="esoc-social-comment-data"></div>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n               class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n              <span class="icon-arrow-down"></span></a>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n               class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n              <span class="icon-arrow-up"></span></a>\r\n          </div>\r\n'},"33":function(e,t,i,s){var n,o;return'          <div class="esoc-extended-view-mode">\r\n            <div class="esoc-social-comment-data">'+(null!=(o=null!=(o=t.commentText||(null!=e?e.commentText:e))?o:t.helperMissing,n="function"==typeof o?o.call(e,{"name":"commentText","hash":{}}):o)?n:"")+'</div>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n               class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n              <span class="icon-arrow-down"></span></a>\r\n            <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n               class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n              <span class="icon-arrow-up"></span></a>\r\n          </div>\r\n      '},"35":function(e,t,i,s){var n;return'        <div class="esoc-social-attachment '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentInactiveClass:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(36,s,0),"inverse":this.program(38,s,0)}))?n:"")+'            <a href="javascript:void(0);" class="esoc-social-attachment-name"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+"</a>\r\n          </div>\r\n"},"36":function(e,t,i,s){var n;return'            <span class="csui-icon-group esoc-social-attachment-icon"\r\n                  title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">\r\n            <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentMimeTypeClass:n,e))+'" />\r\n            <span class="csui-icon csui-icon-shortcut-overlay"></span>\r\n          </span>\r\n'},"38":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages\r\n        .documentAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(39,s,0),"inverse":this.noop}))?n:""},"39":function(e,t,i,s){var n;return'              <a href="javascript:void(0);" class="esoc-social-attachment-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentMimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'"></a>\r\n          '},"41":function(e,t,i,s){var n;return'          <div id="'+this.escapeExpression((n=null!=(n=t.uniqueId||(null!=e?e.uniqueId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"uniqueId","hash":{}}):n))+'" class="esoc-social-activity-load-more"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.isFirstItem:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'<a href="javascript:void(0);" class="esoc-activity-focus-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userProfileLink:n,e))+'"></a>\r\n<div class="esoc-profileimg-block">\r\n    <span class="esoc-userprofile-img">\r\n        <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.user:e)?n.id:n,e))+' binf-img-circle" src="" />\r\n    </span>\r\n</div>\r\n<div class="esoc-commentinfo-block-wrapper binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n<div class="esoc-commentinfo-block binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="esoc-social-comment-details">\r\n    <div class="esoc-comment-user-details binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <span class="esoc-user-widget"></span>\r\n        <span class="esoc-activityfeed-actiontype">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 4 || this.feed_event_type == 2",{"name":"xif","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7 || this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.modified_at_iso8601 == ''",{"name":"xif","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+"        </span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.showCommentIcon:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"    </div>\r\n  </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 4",{"name":"xif","hash":{},"fn":this.program(14,s,0),"inverse":this.program(16,s,0)}))?n:"")+'  </div>\r\n\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div id="esoc-social-comment-input-holder-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7",{"name":"xif","hash":{},"fn":this.program(19,s,0),"inverse":this.program(26,s,0)}))?n:"")+"      </div>\r\n\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_id != '' && (this.extended_info.attachment_subtype ==\r\n    this.messages.shortcutAttachmentSubtype || this.extended_info.attachment_subtype == this\r\n    .messages.documentAttachmentSubtype)",{"name":"xif","hash":{},"fn":this.program(35,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n        </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.noMoreData == false",{"name":"xif","hash":{},"fn":this.program(41,s,0),"inverse":this.noop}))?n:"")+'        <span class="esoc-social-comment-delete"></span>\r\n'}});return i.registerPartial("esoc_widgets_activityfeedwidget_activityfeedstandard",s),s}),csui.define("hbs!esoc/widgets/activityfeedwidget/impl/activityfeedheader",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="esoc-comment-list-header-divider"></div>\r\n'},"3":function(e,t,i,s){var n;return"            "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.actionType:n,e))+"\r\n"},"5":function(e,t,i,s){var n;return"            "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.textmsg:n,e))+"\r\n"},"7":function(e,t,i,s){var n;return'            <span class="esoc-social-comment-timestamp">'+this.escapeExpression((n=null!=(n=t.created_at_iso8601||(null!=e?e.created_at_iso8601:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"created_at_iso8601","hash":{}}):n))+"</span>\r\n"},"9":function(e,t,i,s){var n,o;return'            <span class="esoc-social-comment-timestamp">\r\n              <span class="esoc-social-comment-timestamp-ago" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.modifiedAt:n,e))+'">\r\n              </span>\r\n              '+this.escapeExpression((o=null!=(o=t.modified_at_iso8601||(null!=e?e.modified_at_iso8601:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"modified_at_iso8601","hash":{}}):o))+"\r\n            </span>\r\n"},"11":function(e,t,i,s){var n;return'    <div class="esoc-comment-msg binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <span class="esoc-activity-object-information '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n        <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'"\r\n           class="esoc-social-mime-icon  '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"\r\n           aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n        <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-object-name"\r\n           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">\r\n          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+"\r\n        </a>\r\n      </span>\r\n    </div>\r\n"},"13":function(e,t,i,s){var n;return'    <div class="esoc-comment-msg binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-social-comment-details binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n        <div class="esoc-comment-user-details">\r\n          <span class="esoc-reply-user-widget"></span>\r\n        <span class="esoc-activityfeed-actiontype esoc-activityfeed-header-status">\r\n          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.status:n,e))+"\r\n        </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"},"15":function(e,t,i,s){var n;return'    <div class="esoc-comment-msg binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-activity-object-information '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(16,s,0),"inverse":this.program(18,s,0)}))?n:"")+'        <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-object-name"\r\n           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+"</a>\r\n      </div>\r\n    </div>\r\n"},"16":function(e,t,i,s){var n;return'          <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon csui-icon-group"\r\n             title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">\r\n            <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" />\r\n            <span class="csui-icon csui-icon-shortcut-overlay"></span>\r\n          </a>\r\n'},"18":function(e,t,i,s){var n;return'          <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n'},"20":function(e,t,i,s){var n;return'    <div class="esoc-comment-msg binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-activity-object-information '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.inactiveClass:n,e))+'">\r\n        <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'" class="esoc-social-mime-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></a>\r\n        <a href="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.defaultActionUrl:n,e))+'"\r\n           class="esoc-object-name  esoc-object-name-with-version"\r\n           title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'</a>\r\n        <span class="esoc-social-version">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.version:n,e))+'</span>\r\n        <span class="esoc-version-number">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.version_name:n,e))+"</span>\r\n      </div>\r\n    </div>\r\n"},"22":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.sgm_description != ''",{"name":"xif","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:""},"23":function(e,t,i,s){var n
;return'        <div class="esoc-extended-view-mode">\r\n          <div class="esoc-social-comment-data">\r\n            <div class="esoc-description">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,e))+'</div>\r\n          </div>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n             class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n            <span class="icon-arrow-down-dark"></span></a>\r\n          <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n             class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n            <span class="icon-arrow-up-dark"></span></a>\r\n        </div>\r\n'},"25":function(e,t,i,s){var n;return'      <div class="esoc-extended-view-mode">\r\n        <div class="esoc-social-comment-data"></div>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n           class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n          <span class="icon-arrow-down-dark"></span></a>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n           class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n          <span class="icon-arrow-up-dark"></span></a>\r\n      </div>\r\n    </div>\r\n'},"27":function(e,t,i,s){var n,o;return'      <div class="esoc-extended-view-mode">\r\n        <div class="esoc-social-comment-data">'+(null!=(o=null!=(o=t.commentText||(null!=e?e.commentText:e))?o:t.helperMissing,n="function"==typeof o?o.call(e,{"name":"commentText","hash":{}}):o)?n:"")+'</div>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n           class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n          <span class="icon-arrow-down-dark"></span></a>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n           class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n          <span class="icon-arrow-up-dark"></span></a>\r\n      </div>\r\n'},"29":function(e,t,i,s){var n;return'    <div class="esoc-social-comment-list-actions binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.enableComments:n,{"name":"if","hash":{},"fn":this.program(30,s,0),"inverse":this.noop}))?n:"")+"    </div>\r\n"},"30":function(e,t,i,s){var n,o;return'        <div class="esoc-social-comment-container esoc-socialactions-getcomments">\r\n          <a class="esoc-social-comment-container" href="javascript:void(0);" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+'">\r\n          <span class="esoc-activity-feed-comment">\r\n            <span class="esoc-cs-icon-feed-comment" data-value='+this.escapeExpression((o=null!=(o=t.data_id||(null!=e?e.data_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"data_id","hash":{}}):o))+' title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+'"></span>\r\n          </span>\r\n          </a>\r\n        </div>\r\n'},"32":function(e,t,i,s){var n;return'  <div class="esoc-social-attachment '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentInactiveClass:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(33,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.documentAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(35,s,0),"inverse":this.noop}))?n:"")+'\r\n    <a href="javascript:void(0);" class="esoc-social-attachment-name"\r\n       title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+"</a>\r\n  </div>\r\n"},"33":function(e,t,i,s){var n;return'      <span class="csui-icon-group esoc-social-attachment-icon"\r\n            title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">\r\n            <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentMimeTypeClass:n,e))+'" />\r\n            <span class="csui-icon csui-icon-shortcut-overlay"></span>\r\n          </span>\r\n'},"35":function(e,t,i,s){var n;return'      <a href="javascript:void(0);" class="esoc-social-attachment-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentMimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'"></a>\r\n'},"37":function(e,t,i,s){var n;return'  <div id="'+this.escapeExpression((n=null!=(n=t.uniqueId||(null!=e?e.uniqueId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"uniqueId","hash":{}}):n))+'" class="esoc-social-activity-load-more"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.isFirstItem:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'\r\n<a href="javascript:void(0);" class="esoc-activity-focus-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userProfileLink:n,e))+'"></a>\r\n<div class="esoc-profileimg-block">\r\n    <span class="esoc-userprofile-img">\r\n        <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.user:e)?n.id:n,e))+' binf-img-circle" src="" />\r\n    </span>\r\n</div>\r\n\r\n<div class="esoc-commentinfo-block-wrapper esoc-activityfeed-header binf-col-lg-12 binf-col-md-12\r\nbinf-col-sm-12 binf-col-xs-12">\r\n\r\n  \x3c!-- first line - begin: <<user-display-name>> <<action-type>> <<time-stamp>> --\x3e\r\n  <div class="esoc-commentinfo-block binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="esoc-social-comment-details binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-comment-user-details">\r\n        <span class="esoc-user-widget"></span>\r\n        <span class="esoc-activityfeed-actiontype">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 4 || this.feed_event_type == 2",{"name":"xif","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7 || this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.modified_at_iso8601 == ''",{"name":"xif","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+"        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \x3c!-- first line - end: <<user-display-name>> <<action-type>> <<time-stamp>> --\x3e\r\n\r\n  \x3c!-- second line - begin: <<object-mime-type>> <<object-name>> version <<version-number>>--\x3e\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 4",{"name":"xif","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 2",{"name":"xif","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")+"\r\n\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7",{"name":"xif","hash":{},"fn":this.program(15,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(20,s,0),"inverse":this.noop}))?n:"")+'  \x3c!-- second line - end: <<object-mime-type>> <<object-name>> version <<version-number>>--\x3e\r\n\r\n  \x3c!-- third line - begin:FFT(Free FlowText)<<comment/reply/description/attribute-change-text>>--\x3e\r\n  <div class="esoc-acitivity-feed-fft binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div id="esoc-social-comment-input-holder-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7 || this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(22,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 9",{"name":"xif","hash":{},"fn":this.program(25,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type != 7 && this.feed_event_type != 8 && this.feed_event_type != 9",{"name":"xif","hash":{},"fn":this.program(27,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n\r\n"+(null!=(n=t.if.call(e,null!=e?e.showCommentIcon:e,{"name":"if","hash":{},"fn":this.program(29,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_id != '' && (this.extended_info.attachment_subtype ==\r\n    this.messages.shortcutAttachmentSubtype || this.extended_info.attachment_subtype == this\r\n    .messages.documentAttachmentSubtype)",{"name":"xif","hash":{},"fn":this.program(32,s,0),"inverse":this.noop}))?n:"")+"\x3c!-- third line - end:FFT(Free FlowText)<<comment/reply/description/attribute-change-text>>--\x3e\r\n\r\n</div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.noMoreData == false",{"name":"xif","hash":{},"fn":this.program(37,s,0),"inverse":this.noop}))?n:"")+'<span class="esoc-social-comment-delete"></span>\r\n'}});return i.registerPartial("esoc_widgets_activityfeedwidget_impl_activityfeedheader",s),s}),csui.define("css!esoc/lib/jquery.ui/themes/opentext/jquery-ui",[],function(){}),csui.define("esoc/lib/jquery-ui",["module","csui/lib/jquery.ui/js/jquery-ui","css!esoc/lib/jquery.ui/themes/opentext/jquery-ui.css"],function(e,t){return t}),csui.define("esoc/widgets/socialactions/mentions",["module","csui/lib/jquery","esoc/widgets/common/util","esoc/lib/jquery-ui"],function(e,t,i){return function(e,t,s,n){e.widget("ui.triggeredAutocomplete",e.extend(!0,{},e.ui.autocomplete.prototype,{"options":{"trigger":"@","commonUtil":i,"allowDuplicates":!1},"_create":function(){var i=this;this.id_map={},this.stopIndex=-1,this.stopLength=-1,this.contents="",this.cursorPos=0,this.element.on("keydown.autocomplete.fix",function(t){switch(t.keyCode){case e.ui.keyCode.ESCAPE:i.close(t);break;case e.ui.keyCode.UP:case e.ui.keyCode.DOWN:i.menu.element.is(":visible")||t.stopImmediatePropagation()}});var n=this.element.attr("id_map");n&&(this.id_map=JSON.parse(n)),this.ac=e.ui.autocomplete.prototype,this.ac._create.apply(this,arguments),this.updateHidden(),this.options.select=function(t,n){sessionStorage.removeItem("esoc-user-mentions-info");var o=i.element[0].textContent,a=(i.getCursor(o),i.getCaretPosition(i.element[0]),"");if(-1===n.item.id)return a=i.options.trigger+i.userterm,!1;if(a="("+i.options.trigger+n.item.id+")","undefined"!=typeof InstallTrigger){var l=e("<span />");l.css("visibility","hidden"),l.addClass("esoc-span-mention"),l[0].innerText=a,e(i.element)[0].appendChild(l[0]);var r=e(l[0]).width();e(i.element)[0].removeChild(l[0]);var c=e("<input />");c.attr({"id":"data-userid","type":"text","value":a,"disabled":"true"}),c.addClass("esoc-user-mention"),c.css("width",r+"px")}else c=e("<input />"),c.attr({"type":"button","value":a}),c.addClass("esoc-user-mention");return setTimeout(function(){if(i.options.commonUtil.globalConstants.MAX_CHAR_LIMIT<o.length+a.length)return!1;!s.documentMode||"DIV"!==i.node.nodeName&&"P"!==i.node.nodeName?i.replaceTextNodeWithMention(i,c[0]):-1!==n.item.id&&(i.element[0].innerHTML=i.element[0].innerHTML.substring(0,i.caretPos-i.length_of_query)+c[0].innerHTML+i.element[0].innerHTML.substring(i.caretPos,i.element[0].innerHTML.length),i.replaceSelection(c[0]))},0),e(this).trigger("focus"),e(this).trigger("input"),!1},this.replaceSelection=function(){return t.getSelection?function(e){var i,n=t.getSelection(),o="string"==typeof e?s.createTextNode(e):e;n.getRangeAt&&n.rangeCount&&(i=n.getRangeAt(0),i.deleteContents(),"undefined"!=typeof InstallTrigger?(i.insertNode(s.createTextNode("\xa0")),i.insertNode(o),i.insertNode(s.createTextNode("\xa0"))):i.insertNode(o),i.setStart(o,0),t.setTimeout(function(){i=s.createRange(),i.setStartAfter(o),i.collapse(!0),n.removeAllRanges(),n.addRange(i)},0))}:s.selection&&s.selection.createRange?function(e){var t=s.selection.createRange();"string"==typeof e?t.text=e:t.pasteHTML(e.outerHTML)}:void 0}(),this.replaceTextNodeWithMention=function(e,t){e.node.splitText(e.index_for_split),e.node.nextSibling?(e.node.nextSibling.splitText(e.length_of_query),e.node.nextSibling.nodeValue=""):(e.node.nodeValue.splitText(e.length_of_query),e.node.nodeValue.nodeValue=""),e.replaceSelection(t)},this.options.focus=function(e,t){return!1},this.options.close=function(e,t){return sessionStorage.removeItem("esoc-user-mentions-info"),!1},this.menu.options.blur=function(e,t){return!1},this.element.on("focus",function(){i.updateHidden()}),this.element.on("change",function(){i.updateHidden()})},"_renderItem":function(t,i){if(-1===i.id)return e("<li></li>").append("<div class='ui-menu-item-wrapper'><a class='esoc-autosuggestion-text'>"+i.label+"</a></div>").appendTo(t);if(void 0!==i.img)return e("<li></li>").data("item.autocomplete",i).append("<div class='ui-menu-item-wrapper'><a><span class='image_user_placeholder esoc-user-mention-default-avatar'>"+i.initails+"</span><img src='esoc-user-mention-avatar"+i.img+"' /><span>"+i.label+"</span></a></div>").appendTo(t);if(void 0!==i.id){var n=s.createElement("li"),o=s.createElement("div"),a=s.createElement("a"),l=s.createElement("span"),r=s.createElement("img"),c=s.createElement("span");e(n).attr({"class":"ui-menu-item","role":"presentation"}),o.setAttribute("class","ui-menu-item-wrapper"),r.setAttribute("class","esoc-autosuggestion-img"),c.setAttribute("class","esoc-autosuggestion-name"),e(c).text(i.label+" ("+i.id+")"),l.setAttribute("class","image_user_placeholder esoc-user-mention-default-avatar"),e(l).addClass("esoc-user-default-avatar-"+i.value),e(l)[0].innerText=i.initials,e(l).css("background",i.userbackgroundcolor),a.appendChild(l),a.appendChild(r),a.appendChild(c),o.appendChild(a),n.appendChild(o);var d={"context":i.context,"userid":i.value,"photoElement":e(r),"defaultPhotElement":e(l),"photoUrl":i.photo_url};return this.options.commonUtil.setProfilePic(d),e(n).data("item.autocomplete",i).appendTo(t)}},"_move":function(e,t){if(!this.menu.element.is(":visible"))return void this.search(null,t);this.menu[e](t)},"search":function(e,i){var n=this.element.html(),o=this.getCursor(n);this.contents=n,this.cursorPos=o;var a=this,l=this.getCaretPosition(this.element[0]),r=this.element[0].textContent.substring(0,l),c=new RegExp("(^|\\s)(["+this.options.trigger+"][^W-]*)$");if(null!==r.match(/\s@/g)&&r.match(/\s@/g).length>=1){for(var d,u=new RegExp(/\s@/g),m=0;null!=(d=u.exec(r));)m=d.index;r=r.substring(m,r.length)}var p=c.exec(r);if(p&&p[2]){n=r.substring(0,l);var h=p[2].substring(1,p[2].length).toLowerCase();this.length_of_query=h.length+this.options.trigger.length;var f="";if(setTimeout(function(){if(t.getSelection&&t.getSelection().getRangeAt?f=t.getSelection().getRangeAt(0):s.selection&&s.selection.createRange&&(f=s.selection.createRange()),a.node=f.startContainer,s.documentMode)if("DIV"===a.node.nodeName||"P"===a.node.nodeName){var e=a.getCaretPosition(a.node);a.index_for_split=e-a.length_of_query,a.nodeCurPos=a.insertNodeAtCaret(a.node,s.createTextNode("\x01")),a.caretPos=a.insertNodeAtCaret(a.element[0],s.createTextNode("\x01"))}else a.index_for_split=f.startOffset-a.length_of_query;else a.index_for_split=f.startOffset-a.length_of_query},10),this.userterm=h,h.length>0)return this.updateHidden(),this._search(h);this.close()}else this.close()},"_initSource":function(){var t,i,s,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,o){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({"url":i,"data":t,"dataType":"json","success":function(i){null!=i?(o(e.map(i,function(e){if(s="string"==typeof e?e:e.label,!n.id_map[s]||n.options.allowDuplicates)return e})),n.stopLength=-1,n.stopIndex=-1):(n.stopLength=t.term.length,n.stopIndex=n.contents.lastIndexOf(n.options.trigger),n.close())}})}):this.source=this.options.source},"destroy":function(){e.Widget.prototype.destroy.call(this)},"getCursor":function(e){var i;t.getSelection&&t.getSelection().getRangeAt?i=t.getSelection().getRangeAt(0):s.selection&&s.selection.createRange&&(i=s.selection.createRange());var n=t.getSelection().focusNode.textContent;return n=n.substring(1,i.endOffset),e.lastIndexOf(n)+n.length},"insertNodeAtCaret":function(e,i){var s=t.getSelection(),n=0;if(s.rangeCount){var o=s.getRangeAt(0);o.collapse(!1),o.insertNode(i),o=o.cloneRange(),o.selectNodeContents(i),o.collapse(!1),s.removeAllRanges(),s.addRange(o),n=e.innerHTML.indexOf("\x01"),i.parentNode.removeChild(i)}return n},"getCaretCharacterOffset":function(e){var i=0;if(void 0!==t.getSelection){var n=t.getSelection().getRangeAt(0),o=n.cloneRange();o.selectNodeContents(e),o.setEnd(n.endContainer,n.endOffset),i=o.toString().length}else if(void 0!==s.selection&&"Control"!==s.selection.type){var a=s.selection.createRange(),l=s.body.createTextRange();l.moveToElementText(e),l.setEndPoint("EndToEnd",a),i=l.text.length}return i},"updateHidden":function(){var t=this.options.trigger,i=this.element.scrollTop(),s=this.element.val();for(var n in this.id_map){var o=t+n;o=o.replace(/[^a-zA-Z 0-9@]+/g,"\\$&");var a=new RegExp(o,"g"),l=s;s=s.replace(a,t+"["+this.id_map[n]+"]"),l===s&&delete this.id_map[n]}e(this.options.hidden).val(s),this.element.scrollTop(i)},"getCharacterOffsetWithin":function(e,t){for(var i=s.createTreeWalker(t,NodeFilter.SHOW_TEXT,function(t){var i=s.createRange();return i.selectNode(t),i.compareBoundaryPoints(Range.END_TO_END,e)<1?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1),n=0;i.nextNode();)n+=i.currentNode.length;return 3===e.startContainer.nodeType&&(n+=e.startOffset),n},"getCaretPosition":function(e){var i=t.getSelection().getRangeAt(0);return this.getCharacterOffsetWithin(i,e)}}))}(t,window,document),t}),csui.define("hbs!esoc/widgets/socialactions/attachmentpopovertemplate",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <span id="esoc-social-selected-attachment-dialog-title" title="'+this.escapeExpression((n=null!=(n=t.popoverTitle||(null!=e?e.popoverTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"popoverTitle","hash":{}}):n))+'"\r\n       class="esoc-social-attachment-dialog-title">\r\n    <span class="esoc-social-attachment-label" title="'+this.escapeExpression((n=null!=(n=t.popoverTitle||(null!=e?e.popoverTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"popoverTitle","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.popoverTitle||(null!=e?e.popoverTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"popoverTitle","hash":{}}):n))+"</span>\r\n  </span>\r\n"},"3":function(e,t,i,s){var n;return'  <div class="esoc-social-attachment-dialog">\r\n    <div class="esoc-social-attachment-row">\r\n      <span id="esoc-social-attachment-cs-icon-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n            class="esoc-social-attachment-cs-icon"></span>\r\n      <a href="javascript:void(0);" id="esoc-social-attachment-cs-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n         class="esoc-social-attachment-cs" title="'+this.escapeExpression((n=null!=(n=t.fromContentServer||(null!=e?e.fromContentServer:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"fromContentServer","hash":{}}):n))+'">\r\n        <span>'+this.escapeExpression((n=null!=(n=t.fromContentServer||(null!=e?e.fromContentServer:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"fromContentServer","hash":{}}):n))+'</span>\r\n      </a>\r\n    </div>\r\n    <div class="esoc-social-attachment-row">\r\n      <span id="esoc-social-attachment-desktop-icon-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n            class="esoc-social-attachment-desktop-icon"></span>\r\n      <a href="javascript:void(0);" id="esoc-social-attachment-desktop-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n         class="esoc-social-attachment-desktop" title="'+this.escapeExpression((n=null!=(n=t.fromYourDesktop||(null!=e?e.fromYourDesktop:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"fromYourDesktop","hash":{}}):n))+'">\r\n        <span>'+this.escapeExpression((n=null!=(n=t.fromYourDesktop||(null!=e?e.fromYourDesktop:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"fromYourDesktop","hash":{}}):n))+'</span>\r\n      </a>\r\n    </div>\r\n  </div><input type="file" id="'+this.escapeExpression((n=null!=(n=t.desktopAttachmentInputId||(null!=e?e.desktopAttachmentInputId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"desktopAttachmentInputId","hash":{}}):n))+'" name="AddDesktopDoc"\r\n               style="display:none" />\r\n'},"5":function(e,t,i,s){var n;return'  <div id="esoc-social-selected-attachment-dialog">\r\n    <div class="esoc-social-selected-file row-fluid">\r\n\r\n      <a href="javascript:void(0);" id="esoc-social-selected-file-icon-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.filename||(null!=e?e.filename:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filename","hash":{}}):n))+'"\r\n         class="esoc-social-selected-file-icon '+this.escapeExpression((n=null!=(n=t.filemimetypeicon||(null!=e?e.filemimetypeicon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filemimetypeicon","hash":{}}):n))+' binf-col-lg-1 binf-col-md-1 binf-col-sm-1 binf-col-xs-1 esoc-social-no-padding-right binf-pull-left" />\r\n\r\n      <a href="javascript:void(0);" id="esoc-social-attachment-name-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n         class="esoc-social-attachment-name binf-col-lg-6 binf-col-md-6 binf-col-sm-6 binf-col-xs-6 esoc-social-no-padding-right"\r\n         title="'+this.escapeExpression((n=null!=(n=t.filename||(null!=e?e.filename:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filename","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.filename||(null!=e?e.filename:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filename","hash":{}}):n))+'</a>\r\n            <span id="esoc-social-attachment-size-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" class="esoc-social-attachment-size binf-col-lg-3 binf-col-md-3 binf-col-sm-3 binf-col-xs-3\r\n                  esoc-social-no-padding-right">'+this.escapeExpression((n=null!=(n=t.filesize||(null!=e?e.filesize:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filesize","hash":{}}):n))+'</span>\r\n      <a href="javascript:void(0);" id="esoc-social-attachment-delete-icon-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" class="esoc-social-attachment-icon-delete binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2\r\n                  esoc-social-no-padding-right" title="'+this.escapeExpression((n=null!=(n=t.deletetitle||(null!=e?e.deletetitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"deletetitle","hash":{}}):n))+'"></a>\r\n    </div>\r\n  </div>\r\n'},"7":function(e,t,i,s){var n;return'  <div id="esoc-social-selected-attachment-dialog">\r\n    <div class="esoc-social-selected-file row-fluid">\r\n\r\n            <span class="csui-icon-group" title="'+this.escapeExpression((n=null!=(n=t.filename||(null!=e?e.filename:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filename","hash":{}}):n))+'">\r\n                  <span id="esoc-social-selected-file-icon-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n                        class="esoc-social-selected-file-icon esoc-social-mime-icon esoc-comment-valign '+this.escapeExpression((n=null!=(n=t.filemimetypeicon||(null!=e?e.filemimetypeicon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filemimetypeicon","hash":{}}):n))+' binf-col-lg-1 binf-col-md-1 binf-col-sm-1 binf-col-xs-1 esoc-social-no-padding-right binf-pull-left" />\r\n                  <a href="javascript:void(0);" class="csui-icon csui-icon-shortcut-overlay"></a>\r\n            </span>\r\n\r\n      <a href="javascript:void(0);" id="esoc-social-attachment-name-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n         class="esoc-social-attachment-name binf-col-lg-6 binf-col-md-6 binf-col-sm-6 binf-col-xs-6 esoc-social-no-padding-right esoc-social-shortcut-name"\r\n         title="'+this.escapeExpression((n=null!=(n=t.filename||(null!=e?e.filename:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filename","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.filename||(null!=e?e.filename:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"filename","hash":{}}):n))+'</a>\r\n      <span\r\n          class="esoc-social-attachment-size binf-col-lg-4 binf-col-md-4 binf-col-sm-4 binf-col-xs-4 esoc-social-no-padding-right"></span>\r\n      <a href="javascript:void(0);" id="esoc-social-attachment-delete-icon-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n         class="esoc-social-attachment-icon-delete binf-col-lg-1 binf-col-md-1 binf-col-sm-4 binf-col-xs-1 esoc-social-no-padding-right esoc-shortcut-delete-icon"\r\n         title="'+this.escapeExpression((n=null!=(n=t.deletetitle||(null!=e?e.deletetitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"deletetitle","hash":{}}):n))+'"></a>\r\n    </div>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.popoverTitle:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.attachFilesPopover:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.attachmentPopover:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.shortcutPopover:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("esoc_widgets_socialactions_attachmentpopovertemplate",s),s}),csui.define("hbs!esoc/widgets/socialactions/maskingtemplate",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="esoc-profile-img-load-container esoc-comment-masking-container">\r\n  <div class="esoc-profile-img-loader">\r\n    <div class="esoc-profile-img-inner-border"></div>\r\n  </div>\r\n</div>'}});return i.registerPartial("esoc_widgets_socialactions_maskingtemplate",s),s}),csui.define("esoc/widgets/socialactions/util",["module","csui/lib/jquery","csui/lib/underscore","esoc/widgets/socialactions/mentions","csui/utils/namedsessionstorage","csui/utils/url","csui/utils/base","csui/dialogs/node.picker/node.picker","hbs!esoc/widgets/socialactions/attachmentpopovertemplate","hbs!esoc/widgets/socialactions/maskingtemplate","esoc/widgets/common/util","csui/utils/nodesprites","csui/utils/user.avatar.color","esoc/widgets/userwidget/userwidget","i18n!esoc/widgets/socialactions/nls/lang","i18n"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f){var g=function(e){return e.is(":visible")?e.offset():{"top":0,"left":0}};return{"commonUtil":d,"base":a,"namedSessionStorage":new n("esoc-user-mentions-info"),"attachmentPopoverTemplate":r,"maskingTemplate":c,"lang":h,"updateCommentAjaxCall":function(e){var i=e.model,s=i.model;"AttachmentDelete"===e.requestType?t.ajax(i.options.model.collection.connector.extendAjaxOptions({"url":e.url,"type":e.type,"dataType":e.dataType,"data":e.data,"success":this.onDeleteSuccess.bind(this,e),"error":this.onDeleteFailure.bind(this,e)})):(t(document.body).hasClass("binf-comment-dialog-open")&&t(document.body).removeClass("binf-modal-open"),s.destroy({"wait":!0,"success":this.onDeleteSuccess.bind(this,e),"error":this.onDeleteFailure.bind(this,e)}))},"onDeleteSuccess":function(e,i,s,n){var o=e.model,a=e.requestType,l=o.collection,r=this,c=o.model;o.options.commentConfigOptions.commentAction=!0;var d=o.collection.models.length,u=!1,m=o.collection.models[d-1];switch(m=m||e.model.model,d=m.id,a){case"CommentDelete":l.models.length&&(u=!l.models[l.models.length-1].attributes.noMoreData,u=u&&l.models.length===r.commonUtil.globalConstants.FETCH_NEXT_PAGE_MODELS_LENGTH),r.hideMask(o.$el),o.destroy(),l.remove(o.model),u&&(l.defaults.params[r.commonUtil.globalConstants.MAX_ID]=d,l.fetch({"remove":!1}));var p=0;n.xhr.responseJSON?p=n.xhr.responseJSON.commentCount:(p=o.collection.models.length,o.collection.find(c)&&p--),o.options.commentConfigOptions.tablecellwidget&&o.util.commonUtil.updateCommentCount({"currentNodeModel":o.options.commentConfigOptions.currentNodeModel,"commentCount":p}),0===l.models.length&&(t("#esoc-social-comment-container").find(".esoc-social-comment-body-divider").each(function(){t(this).remove()}),t("#esoc-social-comment-container").css("border-bottom","0px solid #ffffff"),t("#esoc-social-comment-form-buttons-container").addClass("esoc-social-form-minheight"));break;case"ReplyDelete":var h=!1;l.models.length>0&&(h=!l.models[l.models.length-1].attributes.noMoreData),u=h&&l.models.length===r.commonUtil.globalConstants.FETCH_NEXT_PAGE_MODELS_LENGTH,u&&t(".esoc-social-reply-seemore:visible").trigger("click"),o.$el.find(".esoc-social-reply-seemore").remove(),r.hideMask(o.$el),o.destroy(),l.remove(o.model),
h&&l.models.length>r.commonUtil.globalConstants.SHOW_SEE_MORE_MODELS_LENGTH&&t(".esoc-social-reply-seemore:last").show(1e3),o.options.commentConfigOptions.parentCollectionView.triggerMethod("update:scrollbar");break;default:var f=JSON.parse(i).status;o.model.attributes.data_id=f.data_id,o.model.attributes.created_at_iso8601=f.created_at_iso8601,o.model.attributes.modified_at_iso8601=r.base.formatFriendlyDateTimeNow(f.modified_at_iso8601),o.model.attributes.text=f.text,o.model.attributes.feed_event_type=f.feed_event_type,o.model.attributes.user.name=f.user.name,o.model.attributes.user.screen_name=f.user.screen_name,o.model.attributes.user.profile_image_url=f.user.profile_image_url,a===r.commonUtil.globalConstants.REQUEST_TYPE_ATTACHMENT_DELETE&&(f.extended_info&&f.extended_info.attachment_id||(o.model.attributes.extended_info.attachment_id="")),r.hideMask(o.$el),o.render(),!1===o.model.collection.models[o.model.collection.length-1].attributes.noMoreData&&t(".esoc-social-reply-seemore:last").show()}o.showSeeMoreLink(o.$el.find(o.contentTypeElement))},"onDeleteFailure":function(e,t,i,s){var n=e.model;this.hideMask(n.$el),n.showSeeMoreLink(n.$el.find(n.contentTypeElement)),this.commonUtil.openErrorDialog({"parent":".esoc-social-comment-widget","errorContent":t.responseJSON?t.responseJSON.errorDetail?t.responseJSON.errorDetail:t.responseJSON.error:this.lang.defaultErrorMessageForUpdateComment})},"setSelectionRange":function(e,i){var s=i,n=i;if(e.setSelectionRange)t(e).trigger("focus"),e.setSelectionRange(s,n);else if(e.createTextRange){var o=e.createTextRange();o.collapse(!0),o.moveEnd("character",n),o.moveStart("character",s),o.select()}},"openConfirmationDialog":function(e){var i=t("#esoc-social-dialog");i.binf_modal({"backdrop":"static","show":!1,"paddingWhenOverflowing":!1});var s=this;i.on("show.binf.modal",function(n){var o=t(this);i.addClass("esoc-social-delete-dialog-mask"),o.find("#myModalTitle").text(e.dialogtitle),i.find(".binf-modal-backdrop").remove(),o.find("#myModalConfirmationText").text(e.dialogmessage);var a,l;a=t(this).clone(),a.css("display","block"),a.appendTo(document.body),l=Math.round((t(".esoc-social-comment-widget").height()-a.find(".binf-modal-content").height())/2)+10,l=l>0?l:0,a.remove(),t(".esoc-social-modal-content").attr("style","margin-top:"+l+"px !important"),t(".esoc-social-dialog-delete-button").off("click").on("click",function(t){i.hide(),i.off(),i.removeData("binf.modal"),s.updateCommentAjaxCall(e.ajaxParams),s.setFocusOnDefaultElement()}),t(".esoc-social-dialog-cancel-button").on("keydown",function(e){9===(e.keyCode||e.which)&&(t(".esoc-social-dialog-delete-button").trigger("focus"),e.preventDefault())})}),i.on("shown.binf.modal",function(e){t(".esoc-social-dialog-cancel-button").trigger("focus")}),i.on("hidden.binf.modal",function(n){t(document.body).hasClass("binf-comment-dialog-open")||t(document.body).addClass("binf-modal-open"),s.hideMask(e.ajaxParams.model.$el);var o=t(this);o.find("#myModalTitle").text(""),o.find("#myModalConfirmationText").text(""),i.removeClass("esoc-social-delete-dialog-mask"),i.off(),t(document.activeElement).trigger("blur");var a=t("#esoc-social-comment-title")[0];t(a).trigger("focus"),document.activeElement=a})},"closeCommentDialog":function(e,i){var s=!1,n=e||window.event;if("popstate"!==n.type&&"hashchange"!==n.type||(s=!0),!("keyup"!==n.type&&"keydown"!==n.type||27!==n.keyCode&&27!==n.which)){var o=0===t(".esoc-social-comment-attachment").next(".binf-popover:visible").length?t(".esoc-social-attachment-file").next(".binf-popover:visible"):t(".esoc-social-comment-attachment").next(".binf-popover:visible"),a=t(".esoc-social-comment-emoticon").siblings(".binf-popover.emoji-menu:visible");if(o.is(":visible"))o.binf_popover("hide"),o.hide(),o.prev().trigger("focus"),n.stopImmediatePropagation();else if(a.length)e&&e.data&&e.data.util&&e.data.util.emojiObj&&(e.data.util.emojiObj.hide(),delete e.data.util.emojiObj);else if(t(".binf-modal-dialog").is(":visible")||(s=!0),t("#esoc-social-dialog").is(":visible")&&t(this).find(".esoc-social-dialog-cancel-button").trigger("click"),!t("#esoc-social-dialog").is(":visible")&&t(".cs-dialog").is(":visible")&&(s=!0),s){t(document.body).hasClass("binf-modal-open")&&t(document.body).hasClass("binf-comment-dialog-open")?(t(document.body).removeClass("binf-modal-open"),t(document.body).removeClass("binf-comment-dialog-open")):t(document.body).hasClass("binf-comment-dialog-open")?t(document.body).removeClass("binf-comment-dialog-open"):t(document.body).addClass("binf-modal-open"),t(document).off(n.type),t("[id^='esoc-social-comment-widget-mask_']").removeAttr("tabindex"),t(".cs-expanded.activityfeed-expand.esoc.cs-dialog.binf-modal.binf-fade.binf-in").attr("tabindex","-1"),t(".esoc-user-widget-dialog.cs-dialog.binf-modal.binf-fade.binf-in").attr("tabindex","-1").prop("disabled",!1);var l=n.data.dialogOptions;if(l){var r=l.currentTarget;"keydown"===n.type&&t(r).on("keyup",function(e){t(r).is(":focus")&&(t(r).off("keyup"),e.stopPropagation())}),r&&(t(r).trigger("focus"),setTimeout(function(){t(r).trigger("focus")},1))}}}t(n.target).closest(".esoc-socialactions-getcomments").length||"click"!==n.type||t(n.target).closest("[id*=esoc-social-comment-widget]").length&&!t(n.target).closest("[id*=esoc-social-comment-widget-mask_]").length||t(n.target).closest("[class*=ui-autocomplete]").length||t("#esoc-social-dialog").is(":visible")||t("#mdAlert").is(":visible")||(s=!0),s&&n.data&&n.data.dialogOptions&&n.data.dialogOptions.commentsHeaderView&&(n.data.dialogOptions.commentsHeaderView.disengageModalKeyboardFocusOnClose(),delete n.data.dialogOptions.commentsHeaderView),s&&n.data.callbackFun(n.data.dialogOptions),27!==n.keyCode&&27!==n.which||t(".cs-dialog").length>0&&t(".cs-dialog").eq(0).trigger("focus"),t(".esoc-acitivityfeed-collection").css("overflow","")},"showBrowsePopup":function(e,t,i,s){!s.shortcutsEnabled&&s.attachementsEnabled&&0===i.val().length&&this.selectAttachment(e,i)},"selectAttachment":function(e,t){e.preventDefault(),e.stopPropagation(),t.trigger("click")},"resetAttachmentInput":function(e,t){e.length>0&&(e.val(""),e[0].files&&navigator.appVersion&&-1!==navigator.appVersion.indexOf("MSIE 10")&&(e.wrap("<form>").parent("form").trigger("reset"),e.unwrap(),e[0].files[0]=""),t.attachementsEnabled&&t.shortcutsEnabled&&e[0].files&&e.remove())},"resetAttachmentPopup":function(e,i,s,n){if(this.resetAttachmentInput(s,n),i.attr("data-binf-original-title",""),i.attr("data-binf-content",""),n.attachementsEnabled&&n.shortcutsEnabled){var o=e||window.event;o.preventDefault(),o.stopPropagation(),i.binf_popover("show"),t(".esoc-social-comment-dialog-att-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),t(".esoc-social-comment-widget").addClass("esoc-social-comment-dialog-minheight")}else i.binf_popover("hide"),i.binf_popover("destroy"),t(".esoc-social-comment-dialog-att-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),t(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-minheight");i.trigger("focus"),this.setCommentDialogPointer()},"hideAttachmentPopup":function(e,i,s){this.resetAttachmentInput(i,s),e.attr("data-binf-original-title",""),e.attr("data-binf-content",""),e.binf_popover("hide"),void 0!==s&&s.attachementsEnabled&&!s.shortcutsEnabled&&e.binf_popover("destroy"),t(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),this.setCommentDialogPointer()},"showAttachmentPopOver":function(e,i){if(void 0!==i.socialActions&&i.socialActions.attachementsEnabled&&i.socialActions.shortcutsEnabled)this.showAttachFilesPopOver(e,i);else{var s=this;e.off("click").on("click",function(n){var o=t("#"+i.desktopAttachmentInputId);!i.socialActions.attachementsEnabled&&i.socialActions.shortcutsEnabled?0===i.shortcutIdHolder.val().length&&(s.hideAttachmentPopup(e,o,i.socialActions),s.openTargetPicker(e,i)):(0===o.val().length&&s.hideAttachmentPopup(e,o,i.socialActions),o.off("change").on("change",function(t){o.val().length>0&&s.showSelectedAttachmentPopOver(e,i)}),s.showBrowsePopup(n,e,o,i.socialActions)),t(".esoc-social-comment-attachment-header").attr("title",s.commonUtil.lang.attachFile),t(".esoc-social-comment-attachment").attr("title",s.commonUtil.lang.attachFile)})}},"showAttachFilesPopOver":function(e,i){var s=this,n=i.id,o=i.uniqueId,a={"attachFilesPopover":!0,"id":n,"fromContentServer":this.commonUtil.lang.fromContentServer,"fromYourDesktop":this.commonUtil.lang.fromYourDesktop,"desktopAttachmentInputId":i.desktopAttachmentInputId},l={"popoverTitle":this.commonUtil.lang.attachFile},r=this.attachmentPopoverTemplate(a),c=this.attachmentPopoverTemplate(l);e.binf_popover({"content":r,"title":c,"delay":{"show":100},"placement":function(i,s){var a=g(t(s)),l=a.top,r=g(t("#esoc-social-comment-container")).top,c=t("#esoc-social-comment-container").height(),d=t("<div/>").attr("style","display:block; left:-5000px;").addClass("esoc-temp-attach-div").append(e.data("binf.popover").tip());t(i).addClass("esoc-social-attachment-popover"),t("#esoc-social-comment-input-holder-"+o).append(d);var u=this.$tip.height();d.remove();var m=c-(l-r),p="bottom";t(s).hasClass("esoc-social-attachment-file-alone")?p=f.settings.rtl?"left":"right":c>m+u&&m<u&&(p="top");var h=t("#esoc-social-comment-container"),v="";return e.hasClass("esoc-social-attachment-file-alone")?v="status-attachment-alone-init-min-height":e.hasClass("comment esoc-social-attachment-file")?v="status-attachment-init-min-height":e.parent().attr("id")==="esoc-social-edit-comment-icons-"+n&&(v="esoc-edit-init-min-height"),h.find(".esoc-social-comment-list-item").length<=1?h.find(".esoc-social-comment-list-item").addClass(v):h.find(".esoc-social-comment-list-item").removeClass("status-attachment-init-min-height status-attachment-alone-init-min-height esoc-edit-init-min-height"),p}}),e.on("shown.binf.popover",function(o){var a=t("#"+i.desktopAttachmentInputId);t("#esoc-social-attachment-desktop-"+n).off("click touchstart").on("click touchstart",function(e){a.val(""),e.stopPropagation(),a.trigger("click")}),a.off("change").on("change",function(t){i.attachFiles?a.val().length>0&&(a.appendTo(e),i.itemview.uploadAttachment()):a.val().length>0&&s.showSelectedAttachmentPopOver(e,i)}),t("#esoc-social-attachment-cs-"+n).off("click").on("click",function(t){s.openTargetPicker(e,i)}),t(".esoc-social-comment-widget").addClass("esoc-social-comment-dialog-minheight"),s.setCommentDialogPointer()}),this.hidePopOvers()},"openTargetPicker":function(e,i){var s=this;new l({"connector":i.connector,"dialogTitle":this.commonUtil.lang.targetPickerTitle,"resolveShortcuts":!0}).show().done(function(n){if(n.nodes.length){var o=n.nodes[0];i.node=o,i.shortcutIdHolder.length>0?(i.shortcutIdHolder.val(i.node.get("id")),i.attachFiles?i.itemview.uploadAttachment():s.showSelectedShortcutPopOver(e,i)):s.showSelectedShortcutPopOver(e,i)}t(".esoc-social-comment-attachment-header").attr("title",s.commonUtil.lang.attachFile),t(".esoc-social-comment-attachment").attr("title",s.commonUtil.lang.attachFile)}).always(function(){e.trigger("focus")})},"hidePopOvers":function(){var e=this;t(".esoc-social-comment-widget").on("click",function(i){t(".esoc-social-comment-widget [aria-describedby]").each(function(){t(this).is(i.target)||0!==t(this).has(i.target).length||0!==t(".binf-popover").has(i.target).length||t(i.target).is(t(".esoc-social-comment-load-more:last"))||(t(this).binf_popover("hide"),t(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-minheight"),t(".esoc-social-comment-dialog-att-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),e.setCommentDialogPointer())})})},"showSelectedAttachmentPopOver":function(e,i){var s,n,o=t("#"+i.desktopAttachmentInputId),a=o[0].files[0],l=this,r="0 B",c=i.id;if(0!==a.size){var d=Math.floor(Math.log(a.size)/Math.log(1024));r=Math.ceil(a.size/Math.pow(1024,d))+" "+["B","KB","MB","GB","TB"][d]}i.socialActions.attachementsEnabled&&i.socialActions.shortcutsEnabled&&o.length>0&&o.appendTo(e);var m=a.type;if(""===m){var p=a.name,h=p.split(".").pop().toLowerCase();t.inArray(h,["zip","rar","war","jar"])>-1?m="application/zip":t.inArray(h,["json","properties"])>-1&&(m="text/plain")}var f={"attributes":{"type":144},"mime_type":m,"container":!1,"get":function(e){return this[e]}};n={"attachmentPopover":!0,"id":c,"filesize":r,"filename":a.name,"filemimetypeicon":u.findClassByNode(f),"deletetitle":this.commonUtil.lang.deleteComment},s={"popoverTitle":this.commonUtil.lang.attachmentPopoverTitle};var g=this.commonUtil.lang.attachFile;e.attr("data-binf-original-title",this.attachmentPopoverTemplate(s)),e.attr("data-binf-content",this.attachmentPopoverTemplate(n)),e.binf_popover("show"),e.on("shown.binf.popover",function(s){t(".esoc-social-comment-attachment-header").attr("title",g),t(".esoc-social-comment-attachment").attr("title",g),t("#esoc-social-attachment-delete-icon-"+c).off("click keydown").on("click keydown",function(t){32!==(t.keyCode||t.which)&&"click"!==t.type||l.resetAttachmentPopup(t,e,o,i.socialActions)}),t("<div />").html(e.attr("data-binf-content")).find(".esoc-social-selected-file").length>0?(t(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-minheight"),t(".esoc-social-comment-widget").addClass("esoc-social-comment-dialog-att-minheight")):(t(".esoc-social-comment-dialog-att-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),t(".esoc-social-comment-widget").addClass("esoc-social-comment-dialog-minheight")),l.setCommentDialogPointer(),t("#esoc-social-attachment-delete-icon-"+c).trigger("focus")}),this.hidePopOvers()},"showSelectedShortcutPopOver":function(e,i){var s=!!i.node.attributes.original_id,n={"attributes":{"type":s?i.node.attributes.original_id.type:i.node.get("type")},"mime_type":s?i.node.attributes.original_id.mime_type:i.node.get("mime_type"),"container":s?i.node.attributes.original_id.container:i.node.get("container"),"get":function(e){return this[e]}},o=this,a={"shortcutPopover":!0,"id":i.node.get("id"),"filename":i.node.get("name"),"filemimetypeicon":u.findClassByNode(n),"deletetitle":this.commonUtil.lang.deleteComment},l={"popoverTitle":this.commonUtil.lang.attachmentPopoverTitle};i.shortcutIdHolder.length>0&&i.shortcutIdHolder.val(a.id);var r=o.commonUtil.lang.attachFile;e.attr("data-binf-original-title",this.attachmentPopoverTemplate(l)),e.attr("data-binf-content",this.attachmentPopoverTemplate(a)),e.binf_popover("show"),e.on("shown.binf.popover",function(s){t(".esoc-social-comment-attachment-header").attr("title",r),t(".esoc-social-comment-attachment").attr("title",r),t("#esoc-social-attachment-delete-icon-"+a.id).off("click keydown").on("click keydown",function(t){32!==(t.keyCode||t.which)&&"click"!==t.type||o.resetAttachmentPopup(t,e,i.shortcutIdHolder,i.socialActions)}),t(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-minheight"),t(".esoc-social-comment-widget").addClass("esoc-social-comment-dialog-att-minheight"),o.setCommentDialogPointer(),t("#esoc-social-attachment-delete-icon-"+a.id).trigger("focus")}),this.hidePopOvers()},"updateWithAttachmentAjaxCall":function(e){var i=e.url,s=e.type,n=e.data,o=e.itemview,a=this,l=(e.commentId,e.feedType),r=t.Deferred();return t.ajax(o.model.collection.connector.extendAjaxOptions({"url":i,"type":s,"data":n,"contentType":!1,"crossDomain":!0,"processData":!1,"success":function(e,i,s){o.options.commentConfigOptions.commentAction=!0,o.model.attributes.text=e.status.text,e.status.extended_info.attachment_id?(o.model.attributes.attachmentCommands=e.status.attachmentCommands,o.model.attributes.extended_info.attachment_parent_data_id=e.status.extended_info.object_id,o.model.attributes.extended_info.attachment_name=e.status.extended_info.attachment_name,o.model.attributes.extended_info.attachment_size=e.status.extended_info.attachment_size,o.model.attributes.extended_info.attachment_icon_id=e.status.extended_info.attachment_icon_id,o.model.attributes.extended_info.attachment_original_data_id=e.status.extended_info.attachment_original_data_id,o.model.attributes.extended_info.attachment_id=e.status.extended_info.attachment_id,o.model.attributes.extended_info.attachment_subtype=parseInt(e.status.extended_info.attachment_subtype,10),o.model.attributes.extended_info.attachment_mime_type=e.status.extended_info.attachment_mime_type,1===o.model.attributes.extended_info.attachment_subtype&&(o.model.attributes.extended_info.attachment_original_sub_type=parseInt(e.status.extended_info.attachment_original_sub_type,10),o.model.attributes.extended_info.attachment_original_mime_type=e.status.extended_info.attachment_original_mime_type,o.model.attributes.extended_info.attachment_original_container=e.status.extended_info.attachment_original_container)):o.model.attributes.extended_info.attachment_id="",o.model.attributes.modified_at_iso8601=a.base.formatFriendlyDateTimeNow(e.status.modified_at_iso8601),a.hideMask(o.$el),o.render(),!1===o.model.collection.models[o.model.collection.length-1].attributes.noMoreData&&t(".esoc-social-reply-seemore:last").show(),o.showSeeMoreLink(o.$el.find(o.contentTypeElement)),a.setFocusOnDefaultElement(),o.options.commentConfigOptions.parentCollectionView?o.options.commentConfigOptions.parentCollectionView.triggerMethod("update:scrollbar"):o.options.parentCollectionView.triggerMethod("update:scrollbar"),r.resolve()},"error":function(e,i,s){a.hideMask(o.$el);var n={"parent":".esoc-social-comment-widget","errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:a.lang.defaultErrorMessageForUpdateWithAttachment};"comment"===l?t(".esoc-comment-attachment").show():t(".esoc-reply-attachment").show(),t("[data-binf-original-title]").each(function(){"none"!==t('[id^="popover"]').css("display")&&t(this).binf_popover("hide")}),a.commonUtil.openErrorDialog(n),o.showSeeMoreLink(o.$el.find(o.contentTypeElement)),a.setFocusOnDefaultElement(),r.reject()}})),r.promise()},"triggerAutoCompleteSuggestion":function(e){var i=this,s=e.element,n=e.appendToElement;s.triggeredAutocomplete({"hidden":"#hidden_inputbox","minLength":2,"autoFocus":!0,"source":function(s,n){var o=s.term,a={};if(s.term.split(" ").length>3||1!==s.term.split(/\n/g).length||"@"===s.term[0])return this.close(),!1;i.namedSessionStorage.get("querystring"+o)?a=i.namedSessionStorage.get("querystring"+o):(a=i.autoCompleteAjax(e.connector,s),i.namedSessionStorage.set("querystring"+o,a)),n(t.map(a,function(t){var i=m.getUserAvatarColor(t);return{"label":t.first_name&&t.last_name?t.first_name+" "+t.last_name:t.name,"value":t.id,"initials":t.initials,"id":t.name,"photo_url":t.photo_url,"userbackgroundcolor":i,"context":e.context}})),(o.length<=2||o.trim().length>1)&&(a.length||(a=[{"label":i.lang.noResults,"value":""}],n(t.map(a,function(e){return{"label":e.label,"value":e.value,"id":-1}}))))},"trigger":"@","appendTo":n,"open":function(){t(".ui-autocomplete").css("width",t(n).width())}})},"autoCompleteAjax":function(e,i){var s={},n=o.combine(e.connection.url,"members"),a=1===i.term.length?i.term.trim():i.term;return t.ajax(e.extendFetchOptions({"url":n,"dataType":"json","async":!1,"data":{"limit":5,"where_type":0,"query":a},"success":function(e){s=e.data}})),s},"updateQueryStringValues":function(e,t,i){var s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),n=-1!==e.indexOf("?")?"&":"?";return e.match(s)?e.replace(s,"$1"+t+"="+i+"$2"):e+n+t+"="+i},"createRemoteObject":function(e){var i=e.socialActionsInstanse.model.attributes.roid,s=e.socialActionsInstanse.model.attributes.socialactions.ParentID,n=e.socialActionsInstanse.options.connector.connection.url,o=n+this.commonUtil.REST_URLS.csCreateROI,a={"csid":"","error":""},l=this;return t.ajax(e.socialActionsInstanse.options.connector.extendAjaxOptions({"url":o,"type":"POST","dataType":"json","data":{"name":i,"remote_object_id":i,"parent_id":s,"type":l.commonUtil.globalConstants.ROI_OBJECT_TYPE},"async":!1,"success":function(e){a.csid=e.id},"error":function(e){a.csid="",a.error=e.responseJSON.error;var t={"parent":".esoc-social-comment-widget","errorContent":e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:l.lang.defaultErrorMessageForCreateRemoteObject};l.commonUtil.openErrorDialog(t)}})),a},"hidePopover":function(e){t(".esoc-social-comment-widget [aria-describedby]").each(function(){t(this).binf_popover("hide")})},"setCommentDialogPointer":function(){this.widgetBaseElement=0===t(this.widgetBaseElement).width()?t("[data-value="+t(this.widgetBaseElement).attr("data-value")+"]"):this.widgetBaseElement;var e=t(this.widgetDialog),i=t(this.widgetDialogPointer),s=t(this.widgetBaseElement),n=!1;e.css({"position":"absolute","left":"0","top":"0"}),i.css({"position":"absolute","left":"0","top":"0"}).addClass("esoc-socialactions-widget-arrow-left");var o=parseInt(s.width()+10,10);e.position({"my":"left top","at":"left+"+o+" top -"+s.parent().height(),"of":this.widgetBaseElement,"collision":"flipfit flipfit"});var a=g(e).left,l=g(e).left+e.width(),r=g(s).left,c=g(s).top,d=s.parent().height()===s.height();d&&(c=g(s).top+Math.ceil(s.height()/4)+2),a<r?(i.css({"position":"absolute","left":l,"top":c}),f.settings.rtl?i.removeClass("esoc-socialactions-widget-arrow-right").addClass("esoc-socialactions-widget-arrow-left"):i.removeClass("esoc-socialactions-widget-arrow-left").addClass("esoc-socialactions-widget-arrow-right"),n=parseInt(t(i).css("left").replace("px",""),10)+1>g(s).left):(i.css({"position":"absolute","left":a-10,"top":c}),f.settings.rtl?i.removeClass("esoc-socialactions-widget-arrow-left").addClass("esoc-socialactions-widget-arrow-right"):i.removeClass("esoc-socialactions-widget-arrow-right").addClass("esoc-socialactions-widget-arrow-left"),n=parseInt(t(i).css("left").replace("px",""),10)+1<g(s).left+s.width());var u=g(e).top+e.height(),m=g(i).top+25;u<m?e.css("top",parseInt(g(e).top+(d?0:20),10)):u-m>20&&e.css("top",parseInt(g(e).top-(d?0:20),10)),n?(e.css({"left":t(window).width()/2-e.width()/2}),i.css({"opacity":"0"})):i.css({"opacity":"1"})},"isValidInput":function(e){return void 0!==e&&void 0!==e.val()&&e.val().length>0},"getUser":function(e){return new p(e)},"showMask":function(e){e.append(this.maskingTemplate()),e.find(".esoc-comment-masking-container").addClass("esoc-progress-display")},"hideMask":function(e){e.find(".esoc-comment-masking-container").remove()},"onMentionNameEdit":function(e){for(var i=t(e.currentTarget).children(),s=0;s<i.length;s++)if("DIV"!==t(e.currentTarget).children()[s].tagName&&"P"!==t(e.currentTarget).children()[s].tagName||"@"===t(e.currentTarget).children()[s].textContent.charAt(0)&&(t(e.currentTarget).children()[s].innerHTML=" "+t(e.currentTarget).children()[s].innerHTML,this.setCursorPosition(e,s)),"undefined"!=typeof InstallTrigger&&0!==t(e.currentTarget).children("br").length){var n=t(e.currentTarget).children("br").get(s);n&&n.nextSibling&&"@"===n.nextSibling.textContent.charAt(0)&&(t(e.currentTarget).children("br").get(s).nextSibling.textContent=" "+t(e.currentTarget).children("br").get(s).nextSibling.textContent,this.setCursorPosition(e,s))}},"setCursorPosition":function(e,i){var s=e.currentTarget.id,n=document.getElementById(s),o=document.createRange(),a=window.getSelection();"undefined"!=typeof InstallTrigger?o.setStart(t(e.currentTarget).children("br").get(i).nextSibling,2):o.setStart(n.children[i],1),a.removeAllRanges(),a.addRange(o),t(n).trigger("focus")},"setFocusOnDefaultElement":function(e){t("#esoc-social-focus-element").trigger("focus")},"createChickletForMentions":function(e){for(var i=e.find("span.esoc-widget-user-display-name"),s=0;s<i.length;s++){var n,o,a,l;for(o=t(i[s]),a=o.find("img"),n=0;n<a.length;n++)l=document.createTextNode(t(a[n]).attr("alt")),i[s].replaceChild(l,a[n]);if("undefined"!=typeof InstallTrigger){var r=t("<span />");r.css("visibility","hidden"),r.addClass("esoc-span-mention"),r[0].innerText=i[s].innerHTML,document.body.appendChild(r[0]);var c=t(r[0]).width()-i[s].innerHTML.length;document.body.removeChild(r[0]);var d=t("<input />");d.attr({"id":"data-userid","type":"text","value":i[s].innerHTML,"disabled":"true"}),d.addClass("esoc-user-mention"),d.css("width",c+"px"),e[0].replaceChild(d[0],i[s])}else{var u=t("<input />");u.attr({"id":t(i[s]).attr("data-userid"),"type":"button","value":i[s].innerHTML}),u.addClass("esoc-user-mention"),e[0].replaceChild(u[0],i[s])}}"undefined"!=typeof InstallTrigger&&(e[0].innerHTML="&nbsp;"+e[0].innerHTML+"&nbsp;")},"setCursorPositionAtStartOFMention":function(e){if(window.chrome&&window.chrome.webstore){var t=document.createRange(),i=window.getSelection();t.setStart(e.currentTarget,0),i.removeAllRanges(),i.addRange(t)}},"applySpaceKeyEvent":function(e){32===(e.keyCode||e.which)&&(e.preventDefault(),t(e.currentTarget).trigger("click"))}}}),csui.define("esoc/widgets/socialactions/comment/server.adaptor.mixin",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/utils/url","esoc/widgets/socialactions/util"],function(e,t,i,s,n){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"sync":function(e,s,o){switch(e){case"create":i.extend(o,{"contentType":!1,"crossDomain":!0,"processData":!1,"url":this.connector.connection.url+n.commonUtil.REST_URLS.csPostCommentRESTUrl});break;case"delete":i.extend(o,{"url":this.connector.connection.url+this.attributes.actions.deleteAction.href+"?id="+this.id})}return t.Collection.prototype.sync.apply(this,arguments)}})}}}),csui.define("esoc/widgets/socialactions/comment.model",["csui/lib/jquery","csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","esoc/widgets/socialactions/comment/server.adaptor.mixin"],function(e,t,i,s,n,o,a){var l=t.Model.extend({"defaults":{"id":0,"data_id":0,"created_at":"-","modified_at":"","text":"-","feed_event_type":0,"user":{"name":"-","screen_name":"-","profile_image_url":"-"},"noMoreData":!0,"actions":{},"extended_info":{}},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeResource(i).makeIncludingAdditionalResources(i).makeUploadable(i).makeExpandable(i).makeServerAdaptor(i)},"isNew":function(){return 0===this.id}});return o.mixin(l.prototype),i.mixin(l.prototype),n.mixin(l.prototype),s.mixin(l.prototype),a.mixin(l.prototype),l}),csui.define("esoc/widgets/socialactions/commentscollection/server.adaptor.mixin",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/utils/url","csui/utils/base","csui/behaviors/default.action/impl/defaultaction"],function(e,t,i,s,n,o){"use strict";return{"mixin":function(a){return i.extend(a,{"makeServerAdaptor":function(e){return this},"base":n,"url":function(){return this.getCommentsRESTUrl},"fetch":function(i){i.params=e.extend(this.defaults.params,i.params);var n=new o,a={"commands":n.actionItems.getAllCommandSignatures(n.commands)};this.getCommentsRESTUrl=s.appendQuery(this.defaults.csRESTUrl,s.combineQueryString(e.param(i.params),a)),t.Collection.prototype.fetch.apply(this,arguments)},"parse":function(e){this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT=void 0!==this.maxMessageLength&&parseInt(this.maxMessageLength,10)>0?parseInt(this.maxMessageLength,10):e.config_settings.maxMessageLength?e.config_settings.maxMessageLength:this.commonUtil.globalConstants.MAX_CHAR_LIMIT;var t=JSON.parse(JSON.stringify(e.data));return delete this.defaults.params[this.util.commonUtil.globalConstants.SINCE_ID],this.parseCommentsCollectionResponse(t)},"parseCommentsCollectionResponse":function(t){for(var i in t){var s=t[i];s.text=e.trim(s.text),s.created_at_iso8601=this.base.formatFriendlyDateTimeNow(s.created_at_iso8601),""!==s.modified_at_iso8601&&void 0!==s.modified_at_iso8601&&(s.modified_at_iso8601=this.base.formatFriendlyDateTimeNow(s.modified_at_iso8601))}return t},"sync":function(e,i,s){return t.Collection.prototype.sync.apply(this,arguments)}})}}}),csui.define("esoc/widgets/socialactions/commentscollection.model",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/utils/base","csui/utils/url","csui/utils/namedsessionstorage","csui/behaviors/default.action/impl/defaultaction","esoc/widgets/socialactions/comment.model","esoc/widgets/socialactions/util","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","esoc/widgets/socialactions/commentscollection/server.adaptor.mixin","i18n!esoc/widgets/socialactions/nls/lang"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h){var f=t.Collection.extend({"defaults":{"params":{"data_id":"","commands":"default"},"csRESTUrl":""},"model":l,"util":r,"namedSessionStorage":new o(r.commonUtil.globalConstants.ESOCIAL_USER_INFO),"getCommentsRESTUrl":"","context":"","currentNodeModel":void 0,"constructor":function(i){delete this.defaults.params[this.util.commonUtil.globalConstants.MAX_ID],delete this.defaults.params[this.util.commonUtil.globalConstants.SINCE_ID],this.defaults.params=e.extend(this.defaults.params,i.params),this.defaults.params.sort_by_nid=!0,this.defaults.params.data_id=i.nodeID,this.getCommentsRESTUrl=i.connector.connection.url,this.context=i.context,i.statusInfo&&i.statusInfo.getStatusUrl?(this.getCommentsRESTUrl+=i.statusInfo.getStatusUrl,this.getCommentsRESTUrl=r.updateQueryStringValues(this.getCommentsRESTUrl,"conversation_id",i.statusInfo.conversation_id),this.getCommentsRESTUrl=r.updateQueryStringValues(this.getCommentsRESTUrl,"item_id",i.statusInfo.item_id)):this.getCommentsRESTUrl+=this.util.commonUtil.REST_URLS.csGetCommentRESTUrl,this.defaults.csRESTUrl=this.getCommentsRESTUrl,this.getCommentsRESTUrl+=e.param(this.defaults.params),i&&i.connector&&i.connector.assignTo(this),t.Collection.prototype.constructor.apply(this,arguments),this.currentNodeModel=i.currentNodeModel,this.makeResource(i).makeIncludingAdditionalResources(i).makeUploadable(i).makeExpandable(i).makeServerAdaptor(i)},"initialize":function(){},"fetchError":function(e,t){var i={"parent":"body","errorContent":t.responseJSON?t.responseJSON.errorDetail?t.responseJSON.errorDetail:t.responseJSON.error:h.defaultErrorMessageCommentsFetch};r.commonUtil.openErrorDialog(i)}});return m.mixin(f.prototype),c.mixin(f.prototype),u.mixin(f.prototype),d.mixin(f.prototype),p.mixin(f.prototype),f}),csui.define("esoc/widgets/socialactions/socialactions.model",["csui/lib/backbone","csui/utils/url","csui/utils/namedsessionstorage","esoc/widgets/common/util"],function(e,t,i,s){return e.Model.extend({"defaults":{"attachementsEnabled":!0,"chatEnabled":!0,"commentingOpen":!0,"commentsEnabled":!0,"likesEnabled":!0,"taggingEnabled":!0,"threadingEnabled":!0,"csid":"","rockey":"","roid":""},"connector":"","commonUtil":s,"namedSessionStorage":new i,"constructor":function(t,i){this.defaults.rockey=i.rockey,this.defaults.roid=i.roid,this.defaults.csid=i.csid,e.Model.prototype.constructor.apply(this,arguments),i&&i.connector&&i.connector.assignTo(this)},"url":function(){var e=t.combine(this.connector.connection.url,this.commonUtil.REST_URLS.csGetROI);return e+="rockey="+encodeURIComponent(this.attributes.rockey)+"&roid="+encodeURIComponent(this.attributes.roid),void 0!==this.namedSessionStorage.get(this.attributes.rockey+this.attributes.roid)?e+="&csid="+this.namedSessionStorage.get(this.attributes.rockey+this.attributes.roid):""!==this.attributes.csid&&this.attributes.csid.toString().length>0&&(e+="&csid="+this.attributes.csid),e},"parse":function(e){var t=JSON.parse(JSON.stringify(e.available_settings))
;return this.attributes.rockey+this.attributes.roid!==""&&this.attributes.rockey+this.attributes.roid.toString().length>0&&this.namedSessionStorage.set(this.attributes.rockey+this.attributes.roid,t.CSID),{"socialactions":t}}})}),csui.define("esoc/widgets/socialactions/reply/server.adaptor.mixin",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/utils/url","esoc/widgets/socialactions/util"],function(e,t,i,s,n){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"sync":function(e,s,o){switch(e){case"create":i.extend(o,{"contentType":!1,"dataType":"text","crossDomain":!0,"processData":!1,"url":this.connector.connection.url+n.commonUtil.REST_URLS.csPostCommentRESTUrl});break;case"delete":i.extend(o,{"url":this.connector.connection.url+this.attributes.actions.deleteAction.href+"?id="+this.id})}return t.Collection.prototype.sync.apply(this,arguments)}})}}}),csui.define("esoc/widgets/socialactions/reply.model",["csui/lib/jquery","csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","esoc/widgets/socialactions/reply/server.adaptor.mixin"],function(e,t,i,s,n,o,a){var l=t.Model.extend({"defaults":{"id":0,"data_id":0,"created_at":"-","text":"-","feed_event_type":0,"user":{"name":"-","screen_name":"-","profile_image_url":"-"},"noMoreData":!0,"actions":{},"extended_info":{}},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeResource(i).makeIncludingAdditionalResources(i).makeUploadable(i).makeExpandable(i).makeServerAdaptor(i)},"isNew":function(){return 0===this.id}});return o.mixin(l.prototype),i.mixin(l.prototype),n.mixin(l.prototype),s.mixin(l.prototype),a.mixin(l.prototype),l}),csui.define("esoc/widgets/socialactions/replycollection/server.adaptor.mixin",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/utils/base","csui/utils/url","csui/behaviors/default.action/impl/defaultaction"],function(e,t,i,s,n,o){"use strict";return{"mixin":function(a){return i.extend(a,{"makeServerAdaptor":function(e){return this},"url":function(){return this.getRepliesUrl},"fetch":function(i){i&&i.params&&(delete i.params.data_id,delete this.defaults.params.data_id),i.params=e.extend(this.defaults.params,i.params);var s=new o,a={"commands":s.actionItems.getAllCommandSignatures(s.commands)};this.getRepliesUrl=n.appendQuery(this.defaults.csRESTUrl,n.combineQueryString(e.param(i.params),a)),t.Collection.prototype.fetch.apply(this,arguments)},"parse":function(e,t){if(void 0!==e.data[0].reply_count&&e.data[0].id===t.item_id){if(document.getElementById("reply_link_count_"+t.item_id))document.getElementById("reply_link_count_"+t.item_id).innerHTML="("+e.data[0].reply_count+")";else{var i="reply_link_count_"+e.data[0].id;document.getElementById("reply_link_"+t.item_id).innerHTML+="<span id ="+i+">("+e.data[0].reply_count+" )</span>"}t.parentCommentModel.attributes.reply_count=e.data[0].reply_count}else document.getElementById("reply_link_count_"+t.item_id)&&(document.getElementById("reply_link_count_"+t.item_id).innerHTML="");for(var s in e.data)e.data[s].id===e.data[s].extended_info.conversation_id&&e.data.splice(s,1);var n=JSON.parse(JSON.stringify(e.data));return this.parseReplyCollectionResponse(n)},"parseReplyCollectionResponse":function(t){for(var i in t){var n=t[i];n.text=e.trim(n.text),n.created_at_iso8601=s.formatFriendlyDateTimeNow(n.created_at_iso8601),""!==n.modified_at_iso8601&&void 0!==n.modified_at_iso8601&&(n.modified_at_iso8601=s.formatFriendlyDateTimeNow(n.modified_at_iso8601))}return t},"fetchSuccess":function(t,i,s){e(".esoc-social-reply-seemore").hide(),e(s.selEle).parent().parent().next().find("a:first").trigger("focus"),i.data[i.data.length-1]&&!1===i.data[i.data.length-1].noMoreData&&e(".esoc-social-reply-seemore:last").show();var n=i.data.length>0&&i.data[i.data.length-1].noMoreData;for(var o in t.models)t.models[o].attributes.noMoreData=n},"fetchError":function(e,t){}})}}}),csui.define("esoc/widgets/socialactions/replycollection.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/behaviors/default.action/impl/defaultaction","csui/utils/contexts/factories/connector","esoc/widgets/socialactions/reply.model","esoc/widgets/common/util","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","esoc/widgets/socialactions/replycollection/server.adaptor.mixin"],function(e,t,i,s,n,o,a,l,r,c,d,u,m){var p=i.Collection.extend({"defaults":{"params":{},"csRESTUrl":""},"model":a,"thisjQuery":t,"commonUtil":l,"constructor":function(e){e.connector=e.connector||e.context.getObject(o),delete this.defaults.params[this.commonUtil.globalConstants.MAX_ID],delete this.defaults.params[this.commonUtil.globalConstants.SINCE_ID],this.defaults.params=t.extend(this.defaults.params,e.params),this.defaults.params.sort_by_nid=!0,this.getRepliesUrl=e.connector.connection.url,this.getRepliesUrl+=e.getRepliesUrl,this.defaults.csRESTUrl=this.getRepliesUrl,this.getRepliesUrl+=t.param(this.defaults.params),e&&e.connector&&e.connector.assignTo(this),i.Collection.prototype.constructor.apply(this,arguments),this.makeResource(e).makeIncludingAdditionalResources(e).makeUploadable(e).makeExpandable(e).makeServerAdaptor(e)},"initialize":function(){}});return u.mixin(p.prototype),r.mixin(p.prototype),d.mixin(p.prototype),c.mixin(p.prototype),m.mixin(p.prototype),p}),csui.define("hbs!esoc/widgets/socialactions/reply",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'            <span class="esoc-social-comment-timestamp">\r\n              <span class="esoc-social-comment-timestamp-ago"></span>\r\n              <span class="esoc-social-comment-blue">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.modifiedAt:n,e))+'</span>\r\n              <span class="esoc-social-timestamp-text">'+this.escapeExpression((o=null!=(o=t.modified_at_iso8601||(null!=e?e.modified_at_iso8601:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"modified_at_iso8601","hash":{}}):o))+"</span>\r\n            </span>\r\n"},"3":function(e,t,i,s){var n;return'            <span\r\n                class="esoc-social-comment-timestamp esoc-social-timestamp-text">'+this.escapeExpression((n=null!=(n=t.created_at_iso8601||(null!=e?e.created_at_iso8601:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"created_at_iso8601","hash":{}}):n))+"</span>\r\n"},"5":function(e,t,i,s){var n;return'            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-button esoc-social-comment-icon-edit"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n'},"7":function(e,t,i,s){var n;return'            <div class="esoc-social-comment-icon-spacer"></div>\r\n            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-button esoc-social-reply-delete-confirm esoc-social-comment-icon-delete"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteReply:n,e))+'" data-binf-toggle="modal"\r\n               data-binf-target="#esoc-social-dialog" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteReply:n,e))+'"></a>\r\n'},"9":function(e,t,i,s){var n;return'            <div class="esoc-social-comment-icon-spacer"></div>\r\n            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-button esoc-social-comment-icon-hide"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.hide:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.hide:n,e))+'"></a>\r\n'},"11":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(12,s,0),"inverse":this.program(15,s,0)}))?n:""},"12":function(e,t,i,s){var n,o;return'        <div id="esoc-social-reply-attachment-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n             class="binf-col-lg-8 binf-col-md-8 binf-col-sm-10 binf-col-xs-10 esoc-social-attachment">\r\n          <span class="csui-icon-group esoc-social-attachment-icon"\r\n                title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">\r\n            <a href="javascript:void(0);" id="esoc-social-selected-file-icon-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2\r\n                  '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" />\r\n            <a href="javascript:void(0);" class="csui-icon csui-icon-shortcut-overlay"></a>\r\n          </span>\r\n\r\n          <div class="binf-col-lg-9 binf-col-md-9 binf-col-sm-9 binf-col-xs-9 esoc-social-attachment-name">\r\n            <a href="javascript:void(0);" class="esoc-social-attachment-download"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+"</a>\r\n          </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.addshortcut:n,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n"},"13":function(e,t,i,s){var n,o;return'            <a href="javascript:void(0);" id="esoc-social-reply-attachment-icon-delete-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n               class="binf-col-lg-1 binf-col-md-1 binf-col-sm-1 binf-col-xs-1 reply esoc-social-reply-attachment-icon-delete"\r\n               data-binf-toggle="modal" data-binf-target="#esoc-social-dialog"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteReply:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteReply:n,e))+'"></a>\r\n'},"15":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.documentAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:""},"16":function(e,t,i,s){var n,o;return'        <div id="esoc-social-reply-attachment-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n             class="binf-col-lg-8 binf-col-md-8 binf-col-sm-10 binf-col-xs-10 esoc-social-attachment">\r\n          <a href="javascript:void(0);"\r\n             class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2 esoc-social-attachment-icon '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'"></a>\r\n\r\n          <div class="binf-col-lg-7 binf-col-md-7 binf-col-sm-7 binf-col-xs-7 esoc-social-attachment-name">\r\n            <a href="javascript:void(0);" class="esoc-social-attachment-download"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'</a>\r\n          </div>\r\n          <div\r\n              class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2 esoc-social-attachment-size">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_size:n,e))+"</div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.addattachment:n,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n      "},"18":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.actions.addattachment || this.actions.addshortcut",{"name":"xif","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?n:""},"19":function(e,t,i,s){var n;return'        <div class="esoc-social-reply-list-actions binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n          <span class="esoc-reply-attachment">\r\n            <a class="reply esoc-social-attachment-file" href="javascript:void(0)" data-html="true"\r\n               data-binf-placement="bottom"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+" </a>\r\n          </span>\r\n        </div>\r\n"},"21":function(e,t,i,s){var n,o;return'  <div id="show_more_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <a href="javascript:void(0);" class="esoc-social-reply-seemore"\r\n       style="display:none">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.seeMoreRepiles:n,e))+"</a>\r\n  </div>\r\n"},"23":function(e,t,i,s){var n;return'  <input type="file" id="esoc-social-replyedit-desktop-attachment-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" name="AddDesktopDoc"\r\n         style="display:none" /><input type="file"\r\n                                       id="esoc-social-replylist-desktop-attachment-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n                                       name="AddDesktopDoc" style="display:none" />\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-comment-body-divider"></div>\r\n<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-comment-list-divider"></div>\r\n<div class="esoc-profileimg-block">\r\n  <span class="esoc-userprofile-img">\r\n    <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.user:e)?n.id:n,e))+' binf-img-circle" src=""></img>\r\n  </span>\r\n</div>\r\n<div class="esoc-commentinfo-block-wrapper binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="esoc-commentinfo-block binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="esoc-social-comment-details">\r\n      <div class="esoc-social-comment-user-details binf-col-lg-10 binf-col-md-10 binf-col-sm-10 binf-col-xs-10">\r\n        <span class="esoc-user-widget"></span>\r\n        <span class="esoc-social-timestamp">\r\n'+(null!=(n=t.if.call(e,null!=e?e.modified_at_iso8601:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'        </span>\r\n      </div>\r\n      <div class="esoc-social-comment-icon-holder binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2">\r\n        <div class="esoc-social-comment-icon-holder esoc-social-comment-icon-holder-inner">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.edit:n,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.deleteAction:n,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.hide:n,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+'        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="binf-alert binf-alert-danger binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-warning"\r\n         role="alert"></div>\r\n    <div class="esoc-extended-view-mode">\r\n      <div\r\n          class="esoc-social-reply-data esoc-social-reply-comment-data esoc-social-comment-text binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"\r\n          data-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+'</div>\r\n      <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n         class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n        <span class="icon-arrow-down"></span></a>\r\n      <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n         class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n        <span class="icon-arrow-up"></span></a>\r\n    </div>\r\n    <div id="esoc-social-reply-input-holder-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="esoc-social-reply-input-holder binf-col-lg-8\r\n    binf-col-md-8 binf-col-sm-7 binf-col-xs-5">\r\n            <textarea class="esoc-social-reply-data-textarea esoc-social-reply-data-textarea-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n                      placeholder="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.writeAComment:n,e))+'">'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+'</textarea>\r\n\r\n      <div id="esoc-suggestion-reply-item_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"></div>\r\n    </div>\r\n\r\n    <div class="esoc-social-reply-icons-container binf-col-lg-4 binf-col-md-4 binf-col-sm-5 binf-col-xs-7">\r\n      <div class="esoc-social-edit-icons" id="esoc-social-edit-reply-icons-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n        <a href="javascript:void(0);" id="esoc-social-reply-edit-attachment-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n           class="esoc-social-comment-attachment" data-html="true" data-binf-placement="bottom" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+'"\r\n        ></a>\r\n        <a href="javascript:void(0);"\r\n           class="esoc-social-comment-emoticon-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' esoc-social-comment-emoticon esoc-social-reply-emoticon"\r\n           id="esoc-social-reply-emoticon-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'"></a>\r\n      </div>\r\n    </div>\r\n\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.extended_info:e)?n.attachment_id:n,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.program(18,s,0)}))?n:"")+'\r\n    <div class="esoc-social-reply-list-update binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <button class="esoc-social-reply-update binf-btn binf-btn-primary">\r\n        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'\r\n      </button>\r\n      <button class="esoc-social-reply-cancel binf-btn binf-btn-default">\r\n        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'\r\n      </button>\r\n      <span class="esoc-social-reply-hidden-text">'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+"</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n"+(null!=(n=t.if.call(e,null!=e?e.noMoreData:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(21,s,0)}))?n:"")+'<span class="esoc-social-reply-delete"></span>\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.actions.addattachment && !this.actions.addshortcut",{"name":"xif","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:"")+'<input type="hidden" id="esoc-social-reply-cs-shortcut-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'-attachfiles" value="" /><input\r\n    type="hidden" id="esoc-social-reply-cs-shortcut-edit-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" value="" />\r\n<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-comment-body-divider"></div>\r\n'}});return i.registerPartial("esoc_widgets_socialactions_reply",s),s}),csui.define("esoc/widgets/socialactions/replylist.view",["require","csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/lib/marionette","csui/lib/moment","csui/lib/handlebars","csui/utils/contexts/factories/connector","i18n!esoc/widgets/socialactions/nls/lang","hbs!esoc/widgets/socialactions/reply","esoc/widgets/userwidget/userwidget","esoc/widgets/socialactions/util","csui/utils/url","csui/utils/nodesprites","csui/utils/namedsessionstorage","esoc/widgets/userwidget/util","csui/lib/handlebars.helpers.xif"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f){return n.ItemView.extend({"tagName":"li","className":"esoc-social-reply-list-item binf-col-lg-12 col-md-12 binf-col-sm-12 binf-col-xs-12","momentJS":o,"util":u,"namedSessionStorage":new h(u.commonUtil.globalConstants.ESOCIAL_USER_INFO),"template":c,"templateHelpers":function(){var e,t,i="";this.model.attributes&&this.model.attributes.extended_info&&this.model.attributes.extended_info.attachment_subtype&&(e=this.model,i="csui-icon mime_document",t=this.model.attributes.extended_info.attachment_subtype,e.attributes.type=1===t?this.model.attributes.extended_info.attachment_original_sub_type:t,e.attributes.mime_type=1===t?this.model.attributes.extended_info.attachment_original_mime_type:this.model.attributes.extended_info.attachment_mime_type,e.attributes.container=1===t?this.model.attributes.extended_info.attachment_original_container:this.model.attributes.extended_info.attachment_container,i=p.findClassByNode(e));var n={"seeMoreRepiles":r.seeMoreReplies,"attachFile":r.attachFile,"modifiedAt":r.modifiedAt,"update":r.update,"cancel":r.cancel,"writeAComment":r.writeAComment,"deleteReply":r.deleteComment,"edit":r.edit,"hide":r.hide,"attachmentDeleteDescription":r.attachmentDeleteDescription,"attachmentDeleteTitle":r.attachmentDeleteTitle,"uploadAttachment":r.uploadAttachment,"deleteReplyheader":r.deleteReplyheader,"confirmationTextforReplyDelete":r.confirmationTextforReplyDelete,"shortcutAttachmentSubtype":this.util.commonUtil.globalConstants.SHORTCUT_ATTACHMENT_SUBTYPE,"documentAttachmentSubtype":this.util.commonUtil.globalConstants.DOCUMENT_ATTACHMENT_SUBTYPE,"emoticon":r.emoticon,"more":r.more,"less":r.less,"mimeTypeClass":i};return this.uniqueId=s.uniqueId(),{"messages":n}},"initialize":function(e){if(0===e.model.collection.options.csBaseUrl.indexOf("http")&&void 0!==e.model.collection.options.csBaseUrl){var t=e.model.collection.options.csBaseUrl.split(/[\/]+/);void 0!==this.model.attributes.extended_info&&void 0!==this.model.attributes.extended_info.attachment_icon_id&&(this.model.attributes.extended_info.attachment_icon_id=t[0]+"//"+t[1]+this.model.attributes.extended_info.attachment_icon_id)}},"events":{"click .esoc-social-comment-icon-edit":"onEditReply","click .esoc-social-comment-icon-hide":"onHideReply","click .esoc-social-comment-icon-delete.esoc-social-reply-delete-confirm":"onRemoveModel","keydown .esoc-social-comment-icon-delete.esoc-social-reply-delete-confirm":"onClickWithSpaceKey","click .esoc-social-reply-update":"onUpdateReply","click .esoc-social-reply-cancel":"onUpdateCancelReply","input .esoc-social-editable":"onEditTextChanged","input .esoc-social-reply-data-textarea":"onEditTextKeyPress","input .esoc-reply-emoji-comment":"onEditTextKeyPress","keyup .esoc-reply-emoji-comment":"onEditTextKeyPress","change .esoc-social-reply-data-textarea":"onEditTextKeyPress","focus .esoc-social-reply-data-textarea":"onFocusEditTextKey","click .esoc-social-reply-seemore":"fetchMoreReplies","click .reply.esoc-social-reply-attachment-icon-delete":"onReplyAttachmentDelete","click .reply.esoc-social-attachment-file":"selectAttachment","keydown .reply.esoc-social-attachment-file":"onClickWithSpaceKey","focus .esoc-reply-emoji-comment":"onFocusEditTextKey","click .esoc-social-reply-emoticon":"onEmojiPress","click .esoc-social-comment-attachment":"onAttachementPress","click .esoc-social-attachment-icon, .esoc-social-attachment-download":"openAttachment","click .esoc-see-more-activity":"showMoreContent","click .esoc-see-less-activity":"showLessContent","mousedown .esoc-reply-emoji-comment .esoc-user-mention":"onReplyEditEmojiMentionMouseClick"},"constructor":function(e){this.options=e||{},this.options.connector=this.options.connector||this.options.context.getObject(l),n.ItemView.prototype.constructor.apply(this,arguments)},"onClickWithSpaceKey":function(e){u.applySpaceKeyEvent(e)},"remove":function(){var e=this;this.$el.fadeOut(function(){n.ItemView.prototype.remove.call(e),e.util.setCommentDialogPointer()})},"onFocusEditTextKey":function(e){e.preventDefault(),e.stopPropagation()},"openAttachment":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("click:attachment")},"onEditReply":function(e){if(e.preventDefault(),e.stopPropagation(),t(".esoc-social-comment-cancel:visible").length>0&&t(".esoc-social-comment-cancel:visible").trigger("click"),t(".esoc-social-reply-cancel:visible").length>0){var i=t(".esoc-social-reply-cancel:visible").closest("li.esoc-social-reply-list-item"),s=t(i).find(".esoc-social-reply-data").height(),n=t(i).find("#esoc-social-comment-reply-list-"+this.model.attributes.id).height(),o=parseInt(t(i.children()).find("div[data-id]")[0].getAttribute("data-id"),10);t(".esoc-social-reply-cancel:visible").trigger("click")}this.$el.find(".esoc-social-comment-icon-holder, .esoc-social-reply-list-actions").hide(),this.$el.find(".esoc-social-reply-list-update").show(),this.$el.find(".esoc-social-edit-icons").show(),this.$el.find(".esoc-social-edit-icons").animate({"opacity":1},0),this.$el.find(".esoc-social-edit-icons").addClass("esoc-social-editable-attachment-icons"),this.applyReplyEmoji(e),this.$el.find('[class*="esoc-social-reply-comment-data"]').hide();var a=this.$el.find(".emoji-wysiwyg-editor");this.util.createChickletForMentions(a),a.show().trigger("focus"),this.$el.find("#esoc-social-reply-attachment-icon-delete-"+this.model.attributes.id).addClass("esoc-social-reply-edit"),(this.model.collection.socialActions.attachementsEnabled||this.model.collection.socialActions.shortcutsEnabled)&&""===this.model.attributes.extended_info.attachment_id||(this.$el.find("#esoc-social-reply-edit-attachment-"+this.model.attributes.id).hide(),this.$el.find(".esoc-social-reply-data").hide().addClass("esoc-social-editable-icons"),this.$el.find(".esoc-social-edit-icons").addClass("esoc-social-icon-when-no-attachment"),this.$el.find(".esoc-reply-emoji-comment").addClass("esoc-social-input-when-no-attachment"));var l=t("#esoc-social-comment-container")[0];this.model.id<o&&(l.scrollTop=l.scrollTop+(s-n));var c={"socialActions":this.model.collection.socialActions,"id":this.model.attributes.id,"uniqueId":this.uniqueId,"desktopAttachmentInputId":"esoc-social-replyedit-desktop-attachment-"+this.model.attributes.id,"shortcutIdHolder":this.$el.find("#esoc-social-reply-cs-shortcut-edit-"+this.model.attributes.id),"connector":this.options.connector};this.util.showAttachmentPopOver(this.$el.find("#esoc-social-reply-edit-attachment-"+this.model.attributes.id),c),this.$el.find("#esoc-social-reply-edit-attachment-"+this.model.attributes.id).attr("title",r.attachFile),this.util.commonUtil.preventDrop(this.$el.find(".esoc-reply-emoji-comment"));var d=this;this.$el.find("#esoc-social-comment-reply-list-"+this.model.attributes.id).on("paste",function(e){var i=d.util.commonUtil.globalConstants.MAX_CHAR_LIMIT,s=t(".esoc-social-reply-data-textarea-"+d.model.id).val().length;d.util.commonUtil.onCommentFormPaste(e,s,i),t(".esoc-social-reply-data-textarea-"+d.model.id).innerHTML=t("#esoc-social-comment-reply-list-"+this.model.attributes.id).html(),d.onEditTextKeyPress(e)}),this.$el.find(".esoc-see-more").hide(),this.$el.find(".esoc-see-less").hide(),this.options.parentCollectionView.triggerMethod("update:scrollbar")},"onEditTextKeyPress":function(e){this.util.onMentionNameEdit(e);var t=this.$el.find('[class*="esoc-social-reply-data-textarea-"]'),i=t.val(),s=this.$el.find(".esoc-social-reply-data"),n=this.$el.find("#esoc-social-comment-reply-list-"+this.model.attributes.id),o=this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT;s.text(i);var a=e||window.event;if(i.length>o){var l=i.substr(0,o);t.val(l),s.text(l),n.html("")[0].textContent=l,this.util.commonUtil.addEmoji(n,!1,this.options.connector),this.util.commonUtil.placeCaretAtEnd(n),a.preventDefault()}},"onRender":function(t){var i=this.model,n=this;if(this.inactivateUnsupportedSubType(i),this.listenTo(this.options.model.collection,"sync",function(){var e=n.model;n.$el.find("#esoc-social-reply-attachment-"+e.attributes.id+" .esoc-social-attachment-name").removeClass("esoc-social-comment-inactive"),n.$el.find("#esoc-social-reply-attachment-"+e.attributes.id+" .esoc-social-attachment-icon").removeClass("esoc-social-comment-inactive"),n.inactivateUnsupportedSubType(e)}),this.model.collection.socialActions.attachementsEnabled&&this.model.collection.socialActions.shortcutsEnabled){var o={"id":"attachfile-"+this.model.attributes.id,"uniqueId":this.uniqueId,"socialActions":this.model.collection.socialActions,"desktopAttachmentInputId":"esoc-social-replylist-desktop-attachment-"+this.model.attributes.id,"shortcutIdHolder":this.$el.find("#esoc-social-reply-cs-shortcut-"+this.model.attributes.id+"-attachfiles"),"attachFiles":!0,"itemview":this,"connector":this.options.connector};this.util.showAttachmentPopOver(this.$el.find(".esoc-social-attachment-file"),o)}if(void 0!==this.model.attributes.user&&void 0!==this.model.attributes.user.id){d||(d=e("esoc/widgets/userwidget/userwidget"));var a={"userid":this.model.attributes.user.id,"context":this.options.context,"showUserProfileLink":!0,
"showMiniProfile":!0,"UserWidget":d},l=s.extend({"placeholder":this.$el.find(".esoc-user-widget")},a);d.getUser(l);var r=s.extend({"placeholder":this.$el.find(".esoc-profileimg-block"),"showUserWidgetFor":"profilepic","userWidgetWrapperClass":"esoc-social-comment-userprofile-pic"},a);d.getUser(r)}this.applyReplyEmoji(t);var c=this.options.context;f.displayUserWidget(c,this.$el)},"onShow":function(e){-1!==t.inArray(this.model.attributes.feed_event_type,[7,8])&&this.$el.find(".esoc-social-reply-data").css("white-space","inherit"),this.util.setCommentDialogPointer();var i=this.options.context;f.displayUserWidget(i,this.$el),-1===t.inArray(this.model.attributes.feed_event_type,[7,8,9])&&this.showSeeMoreLink(this.$el.find(this.contentTypeElement)),this.options.parentCollectionView.triggerMethod("update:scrollbar")},"showSeeMoreLink":function(e){var i=t(e)[0];t(i).addClass("esoc-see-more-content"),t(i).addClass("esoc-see-min-height"),this.util.setCommentDialogPointer(e);var s=this;setTimeout(function(){s.util.commonUtil.isTextOverflown(i)&&(s.$el.find(".esoc-see-more").show(),t(i).addClass("esoc-see-more-activity")),t(i).removeClass("esoc-see-min-height"),s.options.parentCollectionView.triggerMethod("update:scrollbar")},1e3)},"contentTypeElement":".esoc-extended-view-mode","showMoreContent":function(e){""===window.getSelection().toString()&&(this.util.commonUtil.showMoreContent(e,this,this.$el.find(this.contentTypeElement)),this.util.setCommentDialogPointer(e),e.preventDefault(),e.stopPropagation())},"showLessContent":function(e){""===window.getSelection().toString()&&(this.util.commonUtil.showLessContent(e,this,this.$el.find(this.contentTypeElement)),this.util.setCommentDialogPointer(e),e.preventDefault(),e.stopPropagation())},"onUpdateCancelReply":function(e){this.$el.removeClass("esoc-social-editable-parent").find(".esoc-social-reply-data-textarea-"+this.model.attributes.id).removeClass("esoc-social-editable").val(this.$el.find(".esoc-social-reply-hidden-text").text()).hide(),this.applyReplyEmoji(e),this.$el.find(".esoc-social-comment-icon-holder, .esoc-social-reply-list-actions").show(),this.$el.find("#esoc-social-reply-attachment-"+this.model.attributes.id).show(),this.$el.find(".esoc-social-reply-list-update").hide(),this.$el.find(".esoc-social-warning").hide(),this.$el.find(".esoc-social-edit-icons").hide(),this.$el.removeClass("esoc-social-editable-parent").find(".esoc-social-reply-data").removeClass("esoc-social-editable"),this.$el.find(".esoc-social-reply-data").attr("class","binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-reply-data esoc-social-reply-comment-data"),this.$el.find("#esoc-social-reply-attachment-icon-delete-"+this.model.attributes.id).removeClass("esoc-social-reply-edit"),(this.model.collection.socialActions.attachementsEnabled||this.model.collection.socialActions.shortcutsEnabled)&&""===this.model.attributes.extended_info.attachment_id||(this.$el.find(".esoc-social-reply-data").removeClass("esoc-social-editable-icons"),this.$el.find(".esoc-social-edit-icons").removeClass("esoc-social-icon-when-no-attachment"),this.$el.find(".esoc-reply-emoji-comment").removeClass("esoc-social-input-when-no-attachment"));var t=this.$el.find("#esoc-social-reply-edit-attachment-"+this.model.attributes.id),i=this.$el.find("#esoc-social-replyedit-desktop-attachment-"+this.model.attributes.id);t.attr("data-binf-original-title")&&t.attr("data-binf-original-title").length>0&&this.util.hideAttachmentPopup(t,i,this.model.collection.socialActions),this.$el.find(".esoc-comment-emoji").hide(),this.$el.find(".esoc-reply-emoji-comment").hide(),this.$el.find('[class*="esoc-social-reply-comment-data"]').show(),this.$el.find("#esoc-social-reply-cs-shortcut-edit-"+this.model.attributes.id).val(""),this.util.setFocusOnDefaultElement(e);var s=this.options.context;f.displayUserWidget(s,this.$el),this.showSeeMoreLink(this.$el.find(this.contentTypeElement)),this.options.parentCollectionView.triggerMethod("update:scrollbar"),this.$el.find(".esoc-social-comment-icon-edit:first-child").trigger("focus")},"onUpdateReply":function(e){var i,s=this.$el.find('[class*="esoc-social-reply-data-textarea-"]'),n=void 0!==s?s.val().trim():"",o=this.model.attributes.id,a=this.model.attributes.actions.edit.href,l=t("#esoc-social-reply-cs-shortcut-edit-"+o),r=new FormData,c=t("#esoc-social-replyedit-desktop-attachment-"+o);if(n=this.util.commonUtil.revHtmlEntities(n),r.append("commands","default"),""!==l.val())r.append("ATT_ID",parseInt(l.val(),10)),i=!0;else if(c.length>0){var d=c[0].files[0];d?(r.append("AddDesktopDoc",d),i=!0):i=!1}else i=this.$el.find(".esoc-social-reply-edit").is(":hidden");this.util.showMask(this.$el),r.append("status",n),r.append("id",o),r.append("replace",i);var u=this;if(""!==n){var m={"url":u.options.connector.connection.url+a,"type":u.model.attributes.actions.edit.method,"dataType":"text","data":r,"itemview":this,"baseURL":this.model.collection.options.csBaseUrl};this.util.updateWithAttachmentAjaxCall(m).done(function(){u.$el.find(".esoc-social-comment-icon-edit:first-child").trigger("focus")})}else this.$el.find("#esoc-social-comment-reply-list-"+this.model.attributes.id).trigger("focus"),this.util.hideMask(this.$el);this.$el.find("#esoc-social-reply-attachment-icon-delete-"+this.model.attributes.id).removeClass("esoc-social-reply-edit")},"onHideReply":function(e){},"onRemoveModel":function(e){this.util.showMask(this.$el);var t=this.model.attributes.id,i=this.model.attributes.actions.deleteAction.href,s=this,n={"url":s.options.connector.connection.url+i+"?id="+t,"type":s.model.attributes.actions.deleteAction.method,"model":this,"async":!1,"requestType":"ReplyDelete"},o={"dialogtitle":this.templateHelpers().messages.deleteReplyheader,"dialogmessage":this.templateHelpers().messages.confirmationTextforReplyDelete,"ajaxParams":n};this.util.openConfirmationDialog(o)},"destroy":function(e){this.undelegateEvents(),this.off(),this.remove()},"fetchMoreReplies":function(e){var t=this.model.collection;delete t.defaults.params[this.util.commonUtil.globalConstants.SINCE_ID],t.fetch({"remove":!1,"selEle":this.$el.find(".esoc-social-reply-seemore"),"params":{"max_id":this.model.attributes.id},"success":t.fetchSuccess,"error":t.fetchError})},"onReplyAttachmentDelete":function(e){if(e.target.classList.contains("esoc-social-reply-edit"))e.preventDefault(),e.stopPropagation(),this.$el.find("#esoc-social-reply-attachment-"+this.model.attributes.id).hide(),this.$el.find("#esoc-social-reply-edit-attachment-"+this.model.attributes.id).show(),this.$el.find(".esoc-social-edit-icons").removeClass("esoc-social-icon-when-no-attachment"),this.$el.find(".esoc-reply-emoji-comment").removeClass("esoc-social-input-when-no-attachment"),this.$el.find(".esoc-social-reply-data").removeClass("esoc-social-editable-icons"),this.$el.find(".esoc-social-reply-data-textarea").removeClass("esoc-social-editable-icons"),t("#esoc-social-comment-reply-list-"+this.model.attributes.id).trigger("focus");else{var i=this,s=this.model.attributes.id,n=this.model.attributes.actions.edit.href,o=t("<div />").html(this.model.attributes.text),a=o.text(),l={"url":i.options.connector.connection.url+n,"type":i.model.attributes.actions.edit.method,"dataType":"text","data":{"id":s,"status":a,"replace":!0},"model":i,"requestType":"AttachmentDelete"},r={"dialogtitle":this.templateHelpers().messages.attachmentDeleteTitle,"dialogmessage":this.templateHelpers().messages.attachmentDeleteDescription,"ajaxParams":l};this.util.openConfirmationDialog(r)}},"uploadAttachment":function(e){var i=this.model.attributes.id,s=this.model.attributes.actions.edit.href,n=this.$el.find("#esoc-social-replylist-desktop-attachment-"+i),o=t("#esoc-social-reply-cs-shortcut-"+i+"-attachfiles"),a=new FormData;if(a.append("commands","default"),""!==o.val())a.append("ATT_ID",parseInt(o.val(),10));else if(n.length>0){var l=n[0].files[0];a.append("AddDesktopDoc",l)}var r=t("<div />").html(this.model.attributes.text),c=r.text();a.append("id",i),a.append("status",c),this.$el.find(".esoc-reply-attachment").hide(),this.util.showMask(this.$el);var d={"url":this.options.connector.connection.url+s,"type":this.model.attributes.actions.edit.method,"data":a,"itemview":this,"baseURL":this.model.collection.options.csBaseUrl,"commentId":i,"feedType":"reply"};this.util.updateWithAttachmentAjaxCall(d),o.val(""),this.util.resetAttachmentInput(n,this.model.collection.socialActions)},"selectAttachment":function(e){if(this.model.collection.socialActions.attachementsEnabled&&!this.model.collection.socialActions.shortcutsEnabled){var i=this,s=this.$el.find("#esoc-social-replylist-desktop-attachment-"+this.model.attributes.id);s.off("change").on("change",function(e){s.val().length>0&&i.uploadAttachment(e)}),this.openBrowseWindow(e,s)}else if(!this.model.collection.socialActions.attachementsEnabled&&this.model.collection.socialActions.shortcutsEnabled){var n={"shortcutIdHolder":t("#esoc-social-reply-cs-shortcut-"+this.model.attributes.id+"-attachfiles"),"itemview":this,"attachFiles":!0};this.util.openTargetPicker(this.$el.find(".esoc-social-attachment-file"),n)}},"openBrowseWindow":function(e,t){t.val(""),t.trigger("click")},"applyReplyEmoji":function(e){if(void 0!==this.model.attributes.id){this.$el.find(".emoji-wysiwyg-editor").remove();var i=this.$el.find(".esoc-social-reply-data-textarea-"+this.model.attributes.id);i.val(i.val().replace(/&quot;/gi,'"'));var s=(i.emojiarea({"path":this.util.commonUtil.getEmojiPath(this.options.connector),"wysiwyg":!0,"button":".esoc-social-comment-emoticon-"+this.model.attributes.id,"id":"esoc-social-comment-reply-textarea-"+this.model.attributes.conversation_id,"parent":this.$el.find("#esoc-social-edit-reply-icons-"+this.model.attributes.id),"container":t("#esoc-social-comment-container"),"util":this.util,"widget":t(".esoc-social-comment-widget")}),this.$el.find(".emoji-wysiwyg-editor"));i.hide(),s.hide(),s.addClass("esoc-reply-emoji-comment").attr({"id":"esoc-social-comment-reply-list-"+this.model.attributes.id,"data-text":this.templateHelpers().messages.writeAComment});var n=s.html();n=this.util.commonUtil.onClickableUrl(n),this.$el.find(".esoc-social-reply-data").html(n),this.$el.find('[class*="esoc-social-reply-comment-data"]').html(n),s.html(s.html().replace(/\n/gi,"<br>"))}var o={"context":this.options.context,"connector":this.options.connector,"element":this.$el.find("#esoc-social-comment-reply-list-"+this.model.attributes.id),"appendToElement":this.$el.find("[id^='esoc-suggestion-reply-item_']")};this.util.triggerAutoCompleteSuggestion(o)},"onEmojiPress":function(e){void 0!==this.model.attributes.id&&this.util.hidePopover(this.$el.find(".esoc-social-comment-emoticon-"+this.model.attributes.id)),e.stopPropagation()},"onAttachementPress":function(e){this.$el.find(".emoji-menu").hide()},"onReplyEditEmojiMentionMouseClick":function(e){this.util.setCursorPositionAtStartOFMention(e)},"inactivateUnsupportedSubType":function(e){if(e.collection&&(this.attachmentModel=this.util.commonUtil.buildNodeModel(e,this.options.connector,!0),this.options.parentCollectionView.defaultActionController&&!this.options.parentCollectionView.defaultActionController.hasAction(this.attachmentModel))){this.$el.find("#esoc-social-reply-attachment-"+this.model.attributes.id+" .esoc-social-attachment-name").addClass("esoc-social-comment-inactive"),this.$el.find("#esoc-social-reply-attachment-"+this.model.attributes.id+" .esoc-social-attachment-icon").addClass("esoc-social-comment-inactive")}}})}),csui.define("esoc/widgets/socialactions/replycollection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","esoc/widgets/socialactions/replylist.view","csui/behaviors/default.action/default.action.behavior","esoc/widgets/socialactions/util"],function(e,t,i,s,n,o,a){return s.CollectionView.extend({"tagName":"div","className":"comments-list","childView":n,"util":a,"constructor":function(e){this.childViewOptions=e,s.CollectionView.prototype.constructor.apply(this,arguments)},"onRender":function(){this.$el.find(".esoc-social-reply-list-item").hide()},"behaviors":{"DefaultAction":{"behaviorClass":o}},"childEvents":{"click:attachment":"onClickAttachment"},"onClickAttachment":function(e){var t={"node":e.attachmentModel,"callingViewInstance":this};this.util.commonUtil.openItem(t)}})}),csui.define("hbs!esoc/widgets/socialactions/replytemplate",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'          <a href="javascript:void(0);" id="esoc-social-reply-attachment"\r\n             class="esoc-social-comment-attachment" data-html="true"\r\n             data-binf-placement="bottom" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+'"></a>\r\n'},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.shortcutsEnabled:n,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:""},"4":function(e,t,i,s){var n;return'            <a href="javascript:void(0);" id="esoc-social-reply-attachment"\r\n               class="esoc-social-comment-attachment" data-html="true"\r\n               data-binf-placement="bottom" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+'"></a>\r\n'},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.shortcutsEnabled:n,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(7,s,0)}))?n:""},"7":function(e,t,i,s){return'      <input type="file" id="esoc-social-reply-desktop-attachment" name="AddDesktopDoc"\r\n             style="display:none" />\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div id="esoc-social-reply-create-container" class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div id="esoc-social-reply-warning" style="display:none"\r\n       class="binf-alert binf-alert-danger esoc-social-warning" role="alert"></div>\r\n  <div id="esoc-social-reply-form-container" class="esoc-social-reply-form-container">\r\n    <div class="esoc-social-reply-form-mask"></div>\r\n    <div id="esoc-social-reply-input-holder" class="esoc-social-reply-input-holder">\r\n        <div class="esoc-socialactions-widget-arrow-up"></div>\r\n        <div class="esoc-social-reply-data" style="display:none"></div>\r\n        <textarea id="esoc-social-reply-input-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.replyId:n,e))+'" class="esoc-social-reply-input binf-form-control"\r\n                  placeholder="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.writeAComment:n,e))+'"></textarea>\r\n        <div id="esoc-suggestion-reply-header_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.replyId:n,e))+'"\r\n             class="esoc-suggestion-reply-header"></div>\r\n    </div>\r\n\r\n    <div id="esoc-social-reply-form-buttons-container"\r\n         class="esoc-social-reply-form-buttons-container">\r\n      <div id="esoc-social-textinput-button-holder-reply"\r\n           class="esoc-social-textinput-button-holder-reply">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.attachementsEnabled:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'        <a href="javascript:void(0);"\r\n           class="esoc-social-reply-emoticon-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.replyId:n,e))+' esoc-social-comment-emoticon"\r\n           id="esoc-social-reply-comment-emoticon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'"></a>\r\n        <button id="esoc-social-reply-submit" disabled class="binf-btn binf-btn-primary esoc-social-reply-submit"\r\n                type="submit" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.post:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.post:n,e))+"</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.attachementsEnabled:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+'  <input type="hidden" id="esoc-social-reply-cs-shortcut" value="" />\r\n\r\n  <div id="esoc-social-comment-body-divider"></div>\r\n  <div id="esoc-social-reply-container" class="binf-container esoc-social-reply-container"></div>\r\n</div>\r\n'}});return i.registerPartial("esoc_widgets_socialactions_replytemplate",s),s}),csui.define("esoc/widgets/socialactions/replyheader.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/utils/base","csui/utils/contexts/factories/connector","esoc/widgets/socialactions/reply.model","esoc/widgets/socialactions/util","hbs!esoc/widgets/socialactions/replytemplate","i18n!esoc/widgets/socialactions/nls/lang"],function(e,t,i,s,n,o,a,l,r,c,d){var u=null;return s.ItemView.extend({"initialize":function(e){this.options=e,this.options.connector=this.options.connector||this.options.context.getObject(a),u=this},"options":{},"base":o,"util":r,"_elements":{"csuiSocialReplyInput":null,"csuiSocialReplyInputHolder":null,"csuiSocialReplySubmitButton":null,"csuiSocialButtonsContainer":null,"csuiSocialFormContainer":null,"csuiSocialFormWarning":null,"csuiSocialReplyHiddenData":null,"csuiSocialReplyAttachmentPopupContent":null,"csuiSocialReplyAttachmentPopupTitle":null,"csuiSocialReplyShortcut":null},"tagName":"div","template":c,"templateHelpers":function(){var i={"post":d.post,"posting":d.posting,"writeAComment":d.writeAComment,"attachFile":d.attachFile,"replyId":this.options.item_id,"emoticon":d.emoticon};return this.uniqueId=t.uniqueId(),i=e.extend(this.options.socialActions,i),{"messages":i}},"events":{"click #esoc-social-reply-submit":"onReplyFormSubmit","focus .esoc-reply-emoji":"onReplyFormFocus","click .esoc-reply-emoji":"onReplyInputFocus","input .esoc-reply-emoji":"onReplyFormKeypress","click #esoc-social-reply-comment-emoticon":"onEmojiPress","click .esoc-social-comment-attachment":"onAttachementPress","keyup .esoc-reply-emoji":"onReplyFormKeypress","change .esoc-social-reply-input":"onReplyFormKeypress","mousedown .esoc-reply-emoji .esoc-user-mention":"onReplyEmojiMentionMouseClick"},"onRender":function(t){this._elements.csuiSocialReplyInput=this.$el.find("#esoc-social-reply-input-"+this.options.item_id),this._elements.csuiSocialEmojiInput=this.$el.find(".esoc-reply-emoji"),this._elements.csuiSocialReplyInputHolder=this.$el.find("#esoc-social-reply-input-holder"),this._elements.csuiSocialReplySubmitButton=this.$el.find("#esoc-social-reply-submit"),this._elements.csuiSocialButtonsContainer=this.$el.find("#esoc-social-textinput-button-holder-reply"),this._elements.csuiSocialFormContainer=this.$el.find("#esoc-social-reply-form-container"),this._elements.csuiSocialFormWarning=this.$el.find(".esoc-social-warning"),this._elements.csuiSocialReplyHiddenData=this.$el.find(".esoc-social-reply-data"),this._elements.csuiSocialReplyShortcut=this.$el.find("#esoc-social-reply-cs-shortcut"),this._elements.csuiSocialReplyAttachmentName=this.$el.find("#esoc-social-reply-attachment-name"),this._elements.csuiSocialReplyAttachmentSize=this.$el.find("#esoc-social-reply-attachment-size"),this._elements.csuiSocialReplyAttachmentIcon=this.$el.find("#esoc-social-reply-attachment"),this._elements.csuiSocialReplyAttachmentPopupTitle=this.$el.find("#esoc-social-reply-selected-attachment-dialog-title"),this._elements.csuiSocialReplyAttachmentPopupContent=this.$el.find("#esoc-social-reply-selected-attachment-dialog"),this.options.canReply?this._elements.csuiSocialFormContainer.show():this._elements.csuiSocialFormContainer.hide(),this._elements.csuiSocialReplySubmitButton.hide();var i={"socialActions":this.options.socialActions,"id":"reply","uniqueId":this.uniqueId,"desktopAttachmentInputId":"esoc-social-reply-desktop-attachment","shortcutIdHolder":this._elements.csuiSocialReplyShortcut,"connector":this.options.connector};this.util.showAttachmentPopOver(this._elements.csuiSocialReplyAttachmentIcon,i),this._elements.csuiSocialReplyAttachmentIcon.attr("title",d.attachFile),e(".esoc-social-comment-widget").off("mousedown touchstart").on("mousedown touchstart",function(e){u.onCommentDialogClick(e)}),this.onReplyFormBlur()},"onShow":function(t){this.applyemoji(t),e("[id^='esoc-social-comment-widget-pointer']").on("click",function(e){u.onCommentDialogClick(e)});var i=this;e("#esoc-social-comment-reply-header").on("paste",function(t){var s=i.util.commonUtil.globalConstants.MAX_CHAR_LIMIT,n=e("#esoc-social-reply-input-"+i.options.conversation_id).val().length;i.util.commonUtil.onCommentFormPaste(t,n,s),e("#esoc-social-reply-input-"+i.options.conversation_id).innerHTML=e("#esoc-social-comment-reply-header").html(),i.onReplyFormKeypress(t)}),e("#esoc-social-comment-reply-header").on("mouseleave",function(e){u.onCommentFormMouseLeave(e)}),this.util.commonUtil.preventDrop(e(".esoc-reply-emoji"))},"onCommentDialogClick":function(t){"esoc-social-comment-reply-header"===t.target.id||"esoc-social-reply-comment-emoticon"===t.target.id||"esoc-social-reply-attachment"===t.target.id||"esoc-social-reply-desktop-attachment"===t.target.id||e(t.target).parents("#esoc-social-comment-reply-header").length>0||e(t.target).closest(".binf-popover").length>0||"esoc-social-reply-submit"===t.target.id||this.onReplyFormBlur()},"onCommentFormMouseLeave":function(e){this.$el.find("#esoc-social-reply-input-"+this.options.item_id)[0].innerHTML=this.$el.find("#esoc-social-reply-input-"+this.options.item_id).val()},"onReplyInputFocus":function(e){this.$el.find(".esoc-reply-emoji").trigger("focus")},"onReplyFormFocus":function(e){var t=this._elements.csuiSocialReplyInput.val().trim();void 0!==t&&""!==t?this.$el.find("#esoc-social-reply-submit").prop("disabled",!1):this.$el.find("#esoc-social-reply-submit").prop("disabled",!0),e.stopPropagation(),e.preventDefault(),this.$el.find(".esoc-reply-emoji").addClass("emoji-wysiwyg-editor-focus"),this._elements.csuiSocialButtonsContainer.css({"display":"block"}),this.util.commonUtil.isIE()&&this.$el.find(".esoc-reply-emoji").length>0&&0===this.$el.find(".esoc-reply-emoji")[0].textContent.length&&this.$el.find(".esoc-reply-emoji").attr("data-text",""),this._elements.csuiSocialButtonsContainer.animate({"opacity":1},0),this._elements.csuiSocialReplySubmitButton.show(),this.options.socialActions.attachementsEnabled||this.options.socialActions.shortcutsEnabled||(this._elements.csuiSocialButtonsContainer.addClass("esoc-social-icon-when-no-attachment"),this._elements.csuiSocialReplyHiddenData.addClass("esoc-social-input-when-no-attachment"),this.$el.find(".esoc-reply-emoji").addClass("esoc-social-input-when-no-attachment"));var i=""===this.$el.find(".esoc-reply-emoji").html()||"<br>"===this.$el.find(".esoc-reply-emoji").html();this.adjustCommentAreaWidth(e,i),this.$el.find(".esoc-social-attachment-popover").is(":visible")&&this._elements.csuiSocialReplyAttachmentIcon.binf_popover("hide")},"adjustCommentAreaWidth":function(e,t){var i=this.$el.find(".esoc-reply-emoji");t&&(i.css("width",""),i.width(this.$el.find(".esoc-reply-emoji").width()-parseInt(this.$el.find("#esoc-social-reply-submit").outerWidth()-57,10)),this.$el.find(".esoc-suggestion-reply-header").width(i.outerWidth()))},"onReplyFormBlur":function(t){if(!this.$el.find(".esoc-social-comment-form-mask").is(":visible")){var i,s,n=this.$el.find("#esoc-social-reply-input-"+this.options.item_id).val(),o=this.$el.find(".esoc-reply-emoji").html(),a=this.$el.find("#esoc-social-reply-desktop-attachment");a.length>0&&a[0].files&&a[0].files.length>0&&(i=a[0].files[0]),this._elements.csuiSocialReplyShortcut.val().length>0&&(s=parseInt(this._elements.csuiSocialReplyShortcut.val(),10)),void 0!==n&&""!==n||void 0!==i&&""!==i||void 0!==s||void 0!==o&&""!==o&&"<br>"!==o||(this._elements.csuiSocialReplySubmitButton.hide(),this._elements.csuiSocialButtonsContainer.hide(),this._elements.csuiSocialButtonsContainer.animate({"opacity":0},0,function(){e(this).css({"display":"none"})}),e("#esoc-social-comment-reply-header").removeClass("emoji-wysiwyg-editor-focus").trigger("blur"),this.util.commonUtil.isIE()&&this.$el.find(".esoc-reply-emoji").length>0&&0===this.$el.find(".esoc-reply-emoji")[0].textContent.length&&e(".esoc-reply-emoji").attr("data-text",this.templateHelpers().messages.writeAComment),this._elements.csuiSocialReplyAttachmentIcon.attr("data-binf-original-title")&&this._elements.csuiSocialReplyAttachmentIcon.attr("data-binf-original-title").length>0&&this.util.hideAttachmentPopup(this._elements.csuiSocialReplyAttachmentIcon,this.$el.find("#esoc-social-reply-desktop-attachment"),this.options.socialActions),this.options.socialActions.attachementsEnabled||this.options.socialActions.shortcutsEnabled||(this._elements.csuiSocialButtonsContainer.removeClass("esoc-social-icon-when-no-attachment"),this._elements.csuiSocialReplyHiddenData.removeClass("esoc-social-input-when-no-attachment"),this.$el.find(".esoc-reply-emoji").removeClass("esoc-social-input-when-no-attachment")));var l=e("#esoc-social-comment-container").find(".esoc-social-comment-list-item");l.length<=1&&e(l).removeClass("").removeClass("esoc-attachment-init-min-height esoc-emoji-init-min-height")}},"onReplyFormKeypress":function(e){var t=this._elements.csuiSocialReplyInput.val().trim();void 0!==t&&""!==t?this.$el.find("#esoc-social-reply-submit").prop("disabled",!1):this.$el.find("#esoc-social-reply-submit").prop("disabled",!0),this.util.onMentionNameEdit(e);var i=this.$el.find("#esoc-social-reply-input-"+this.options.item_id),s=i.val(),n=this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT,o=e||window.event;if(s.length>n){var a=s.substr(0,n);i.val(a),this.$el.find("#esoc-social-comment-reply-header").html("")[0].textContent=a,this.util.commonUtil.addEmoji(this.$el.find("#esoc-social-comment-reply-header"),!1,this.options.model.connector),this.util.commonUtil.placeCaretAtEnd(this.$el.find("#esoc-social-comment-reply-header")),o.preventDefault()}},"onReplyFormSubmit":function(e){e.stopPropagation(),e.preventDefault(),this._elements.csuiSocialReplyAttachmentIcon.binf_popover("hide");var i,s,n=this._elements.csuiSocialReplyInput.val().trim(),o=new FormData,a=this.$el.find("#esoc-social-reply-desktop-attachment"),r={};a.length>0&&(i=a[0].files[0]),this._elements.csuiSocialReplyShortcut.val().length>0&&(s=parseInt(this._elements.csuiSocialReplyShortcut.val(),10)),n.length&&(this.$el.find(".esoc-social-reply-form-mask").show(),this.$el.find("#esoc-social-reply-submit").html(d.posting),this.adjustCommentAreaWidth(e,!0),this.util.showMask(this.$el.find(".esoc-social-reply-form-mask")),this._elements.csuiSocialReplyInput.val(""),s?r.ATT_ID=s:i&&(r.AddDesktopDoc=i),r.status=n,r.eventtype=1,r.in_reply_to_status_id=this.options.item_id,t.each(r,function(e,t){o.append(t,e)}),new l({},{"connector":this.model.connector}).save({},{"wait":!0,"dataType":"text","data":o,"jsonFormData":r,"parentCommentModel":this.model.options.parentCommentModel,"success":this.onReplySubmitSuccess,"error":this.onReplySubmitFailure.bind(this,a)})),void 0===n||""===n?this.$el.find("#esoc-social-comment-reply-header").trigger("focus"):(this.util.resetAttachmentInput(a,this.options.socialActions),this._elements.csuiSocialReplyShortcut.val(""))},"removeMask":function(e){u.$el.find("#esoc-social-reply-submit").html(d.post),u.adjustCommentAreaWidth(e,!0),u.util.hideMask(u.$el.find(".esoc-social-reply-form-mask")),u.$el.find(".esoc-social-reply-form-mask").hide()},"onReplySubmitFailure":function(t,i,s,n){this.util.resetAttachmentInput(t,this.options.socialActions),this._elements.csuiSocialReplyShortcut.val(""),this._elements.csuiSocialEmojiInput.html(""),this.removeMask(),e('textarea[id^="esoc-social-reply-input-"]').val("");var o={"parent":".esoc-social-comment-widget","errorContent":s.responseJSON?s.responseJSON.errorDetail?s.responseJSON.errorDetail:s.responseJSON.error:d.defaultErrorMessageForReply};this.util.commonUtil.openErrorDialog(o)},"onReplySubmitSuccess":function(e,t,i){u.options.commentAction=!0,u.$el.find(".esoc-reply-emoji")[0].textContent="",u.removeMask(),u.util.resetAttachmentInput(u.$el.find("#esoc-social-reply-desktop-attachment"),u.options.socialActions),u._elements.csuiSocialReplyShortcut.val(""),u._elements.csuiSocialReplyAttachmentIcon.binf_popover("hide"),u.$el.find('textarea[id^="esoc-social-reply-input-"]').text("").height("").trigger("blur"),u.$el.find("#esoc-social-reply-form-container").height(""),u.$el.find("#esoc-social-reply-warning").hide(),u.$el.find(".esoc-reply-emoji").html("").trigger("blur"),setTimeout(function(){u.onReplyFormBlur()},0);var s=u.model;if(delete s.defaults.params[u.util.commonUtil.globalConstants.MAX_ID],s.length>0){var n=s.at(0).id;s.fetch({"remove":!1,"params":{"since_id":n},"at":0})}else s.fetch({});setTimeout(function(){u.$el.find("#esoc-social-comment-reply-header").trigger("focus")},200),u.$el.find("#esoc-social-reply-submit").attr("disabled",!0)},"applyemoji":function(t){if(void 0!==this.options.item_id){this.$el.find(".emoji-wysiwyg-editor").remove();var i=this.$el.find("#esoc-social-reply-input-"+this.options.item_id);i.val(i.val().replace(/&quot;/gi,'"'));var s=(i.emojiarea({"path":this.util.commonUtil.getEmojiPath(this.options.model.connector),"wysiwyg":!0,"button":".esoc-social-reply-emoticon-"+this.options.item_id,"id":"esoc-social-comment-reply-textarea-"+this.options.item_id,"parent":this.$el.find("#esoc-social-textinput-button-holder-reply"),"container":e("#esoc-social-comment-container"),"util":this.util,"widget":e(".esoc-social-comment-widget")}),this.$el.find(".emoji-wysiwyg-editor"));s.addClass("esoc-reply-emoji").attr({"id":"esoc-social-comment-reply-header","data-text":this.templateHelpers().messages.writeAComment}),i.hide(),s.show()}this.listenToOnce(this.model,"sync",function(){var e={"context":this.options.context,"connector":this.options.connector,"element":this.$el.find("#esoc-social-comment-reply-header"),"appendToElement":this.$el.find("[id^='esoc-suggestion-reply-header_']")};this.util.triggerAutoCompleteSuggestion(e),this.$el.find(".emoji-wysiwyg-editor").removeAttr("autocomplete")})},"onEmojiPress":function(t){var i=e("#esoc-social-comment-container").find(".esoc-social-comment-list-item");i.length<=1&&e(i).removeClass("esoc-attachment-init-min-height").addClass("esoc-emoji-init-min-height"),void 0!==this.options.item_id&&this.util.hidePopover(this.$el.find(".esoc-social-reply-emoticon-"+this.options.item_id)),t.stopPropagation()},"onAttachementPress":function(t){var i=e("#esoc-social-comment-container").find(".esoc-social-comment-list-item");i.length<=1&&e(i).removeClass("esoc-emoji-init-min-height").addClass("esoc-attachment-init-min-height"),this.$el.find(".emoji-menu").hide()},"onReplyEmojiMentionMouseClick":function(e){this.util.setCursorPositionAtStartOFMention(e)}})}),csui.define("esoc/widgets/socialactions/replycollectionbase",["csui/lib/marionette","csui/lib/jquery","csui/utils/connector","esoc/widgets/socialactions/replycollection.model","esoc/widgets/socialactions/replycollection.view","esoc/widgets/socialactions/replyheader.view"],function(e,t,i,s,n,o){function a(i){var a=t(i.parentNode),l=new s(i);i.model=l,l.socialActions=i.socialActions,l.options=i,new e.Region({"el":i.parentNode}).show(new o(i));var r=new e.Region({"el":"#esoc-social-reply-container"}),c=new n({"context":l.options.context,"collection":l,"parentCollectionView":i.parentCollectionView,"commentConfigOptions":i,"sort":!0});r.show(c),i.success=l.fetchSuccess,i.error=l.fetchError,l.fetch(i),a.css({"display":"block"}),a.animate({"opacity":1}),this.getConfig=function(){return i}}return a}),
csui.define("hbs!esoc/widgets/socialactions/comment",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'            <span class="esoc-social-comment-timestamp">\r\n              <span class="esoc-social-comment-timestamp-ago"></span>\r\n              <span class="esoc-social-comment-blue">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.modifiedAt:n,e))+'</span>\r\n              <span class="esoc-social-timestamp-text">'+this.escapeExpression((o=null!=(o=t.modified_at_iso8601||(null!=e?e.modified_at_iso8601:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"modified_at_iso8601","hash":{}}):o))+"</span>\r\n            </span>\r\n"},"3":function(e,t,i,s){var n;return'            <span\r\n                class="esoc-social-comment-timestamp esoc-social-timestamp-text">'+this.escapeExpression((n=null!=(n=t.created_at_iso8601||(null!=e?e.created_at_iso8601:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"created_at_iso8601","hash":{}}):n))+"</span>\r\n"},"5":function(e,t,i,s){var n;return'            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-button esoc-social-comment-icon-edit"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.edit:n,e))+'"></a>\r\n'},"7":function(e,t,i,s){var n;return'            <div class="esoc-social-comment-icon-spacer"></div>\r\n            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-button esoc-social-comment-delete-confirm esoc-social-comment-icon-delete"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteComment:n,e))+'" data-binf-toggle="modal"\r\n               data-binf-target="#esoc-social-dialog" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteComment:n,e))+'"></a>\r\n'},"9":function(e,t,i,s){var n;return'            <div class="esoc-social-comment-icon-spacer"></div>\r\n            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-button esoc-social-comment-icon-hide"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.hide:n,e))+'"></a>\r\n'},"11":function(e,t,i,s){var n,o;return'      <div class="esoc-social-comment-data binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"\r\n           data-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n        <span class="esoc-social-text esoc-comment-valign">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.textmsg:n,e))+"</span>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?n:"")+'\r\n        <span class="esoc-object-name esoc-comment-valign" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.subtype != this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:"")+"          "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'\r\n        </span>\r\n      </div>\r\n      <div class="esoc-extended-view-mode">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+'        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n           class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n          <span class="icon-arrow-down"></span></a>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n           class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n          <span class="icon-arrow-up"></span></a>\r\n      </div>\r\n\r\n      <div class="binf-alert binf-alert-danger binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-warning"\r\n           role="alert"></div>\r\n'},"12":function(e,t,i,s){var n;return'          <span class="esoc-social-mime-icon esoc-comment-valign csui-icon-group">\r\n            <span class="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" />\r\n            <a href="javascript:void(0);" class="csui-icon csui-icon-shortcut-overlay"></a>\r\n          </span>\r\n'},"14":function(e,t,i,s){var n;return'            <span class="esoc-social-mime-icon esoc-comment-valign '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'"\r\n                  title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></span>\r\n'},"16":function(e,t,i,s){var n;return'          <div class="esoc-social-comment-data">\r\n            <div class="esoc-description">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,e))+"</div>\r\n          </div>\r\n"},"18":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 8",{"name":"xif","hash":{},"fn":this.program(19,s,0),"inverse":this.program(21,s,0)}))?n:""},"19":function(e,t,i,s){var n,o;return'      <div class="esoc-social-comment-data binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"\r\n           data-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n        <span class="esoc-social-text esoc-comment-valign">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.textmsg:n,e))+'</span>\r\n        <span class="esoc-object-name esoc-comment-valign" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'">\r\n          <span class="esoc-social-mime-icon esoc-comment-valign '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'"\r\n                title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'"></span>\r\n          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.name:n,e))+'\r\n        </span>\r\n        <span class="esoc-social-version esoc-comment-valign">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.version:n,e))+'</span>\r\n        <span class="esoc-version-number esoc-comment-valign">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.version_name:n,e))+'</span>\r\n      </div>\r\n      <div class="esoc-extended-view-mode">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.extended_info:e)?n.sgm_description:n,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+'        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n           class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n          <span class="icon-arrow-down"></span></a>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n           class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n          <span class="icon-arrow-up"></span></a>\r\n      </div>\r\n      <div class="binf-alert binf-alert-danger binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-warning"\r\n           role="alert"></div>\r\n'},"21":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 9",{"name":"xif","hash":{},"fn":this.program(22,s,0),"inverse":this.program(24,s,0)}))?n:""},"22":function(e,t,i,s){var n,o;return'      <div class="esoc-extended-view-mode">\r\n        <div class="esoc-social-comment-data binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"\r\n             data-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"></div>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n           class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n          <span class="icon-arrow-down"></span></a>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n           class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n          <span class="icon-arrow-up"></span></a>\r\n      </div>\r\n      <div class="binf-alert binf-alert-danger binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-warning"\r\n           role="alert"></div>\r\n'},"24":function(e,t,i,s){var n,o;return'      <div class="esoc-extended-view-mode">\r\n        <div\r\n            class="esoc-social-comment-data esoc-social-comment-text binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"\r\n            data-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+'</div>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'"\r\n           class="esoc-see-more esoc-see-more-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.more:n,e))+'">\r\n          <span class="icon-arrow-down"></span></a>\r\n        <a href="javascript:void(0);" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'"\r\n           class="esoc-see-less esoc-see-less-activity esoc-hide-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.less:n,e))+'">\r\n          <span class="icon-arrow-up"></span></a>\r\n      </div>\r\n      <div class="binf-alert binf-alert-danger binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-warning"\r\n           role="alert"></div>\r\n      <div id="esoc-social-comment-input-holder-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'" class="esoc-social-comment-input-holder\r\n      binf-col-lg-8 binf-col-md-8 binf-col-sm-7 binf-col-xs-5">\r\n        <textarea class="esoc-social-comment-data-textarea esoc-social-comment-data-textarea-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n                  placeholder="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.writeAComment:n,e))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+"</textarea>\r\n      </div>\r\n    "},"26":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.shortcutAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(27,s,0),"inverse":this.program(30,s,0)}))?n:""},"27":function(e,t,i,s){var n,o;return'        <div id="esoc-social-comment-attachment-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n             class="binf-col-lg-7 binf-col-md-7 binf-col-sm-9 binf-col-xs-9 esoc-social-attachment">\r\n          <span class="csui-icon-group esoc-social-attachment-icon"\r\n                title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">\r\n            <span id="esoc-social-selected-file-icon-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2\r\n                  '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" />\r\n            <a href="javascript:void(0);" class="csui-icon csui-icon-shortcut-overlay"></a>\r\n          </span>\r\n\r\n          <div class="binf-col-lg-9 binf-col-md-9 binf-col-sm-9 binf-col-xs-9 esoc-social-attachment-name">\r\n            <a href="javascript:void(0);" class="esoc-social-attachment-download"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+"</a>\r\n          </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.addshortcut:n,{"name":"if","hash":{},"fn":this.program(28,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n"},"28":function(e,t,i,s){var n,o;return'            <a href="javascript:void(0);" id="esoc-social-attachment-icon-delete-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n               class="binf-col-lg-1 binf-col-md-1 binf-col-sm-1 binf-col-xs-1 comment esoc-social-attachment-icon-delete"\r\n               data-binf-toggle="modal" data-binf-target="#esoc-social-dialog"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteComment:n,e))+'"></a>\r\n'},"30":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_subtype == this.messages.documentAttachmentSubtype",{"name":"xif","hash":{},"fn":this.program(31,s,0),"inverse":this.noop}))?n:""},"31":function(e,t,i,s){var n,o;return'        <div id="esoc-social-comment-attachment-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n             class="binf-col-lg-7 binf-col-md-7 binf-col-sm-9 binf-col-xs-9 esoc-social-attachment">\r\n          <a href="javascript:void(0);" class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2 esoc-social-attachment-icon\r\n             '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mimeTypeClass:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'"></a>\r\n\r\n          <div class="binf-col-lg-7 binf-col-md-7 binf-col-sm-7 binf-col-xs-7 esoc-social-attachment-name">\r\n            <a href="javascript:void(0);" class="esoc-social-attachment-download"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_name:n,e))+'</a>\r\n          </div>\r\n          <div\r\n              class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2 esoc-social-attachment-size">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.extended_info:e)?n.attachment_size:n,e))+"</div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.addattachment:n,{"name":"if","hash":{},"fn":this.program(28,s,0),"inverse":this.noop}))?n:"")+"        </div>\r\n      "},"33":function(e,t,i,s){var n;return'        <span class="esoc-comment-reply">\r\n'+(null!=(n=t.if.call(e,null!=e?e.reply_count:e,{"name":"if","hash":{},"fn":this.program(34,s,0),"inverse":this.program(37,s,0)}))?n:"")+"        </span>\r\n"},"34":function(e,t,i,s){var n,o;return'            <a id="reply_link_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="esoc-reply_link" href="javascript:void(0)">\r\n              '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.reply:n,e))+'\r\n              <span id="reply_link_count_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">('+this.escapeExpression((o=null!=(o=t.reply_count||(null!=e?e.reply_count:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"reply_count","hash":{}}):o))+")</span>\r\n            </a>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_id == '' && (this.actions.addattachment || this.actions.addshortcut)",{"name":"xif","hash":{},"fn":this.program(35,s,0),"inverse":this.noop}))?n:"")},"35":function(e,t,i,s){return'              <span class="item-separator">|</span>\r\n'},"37":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=(n=null!=e?e.actions:e)?n.reply:n)?n.can_reply:n,{"name":"if","hash":{},"fn":this.program(38,s,0),"inverse":this.noop}))?n:""},"38":function(e,t,i,s){var n,o;return'              <a id="reply_link_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="esoc-reply_link"\r\n                 href="javascript:void(0)"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.reply:n,e))+" </a>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_id == '' && (this.actions.addattachment || this.actions.addshortcut)",{"name":"xif","hash":{},"fn":this.program(39,s,0),"inverse":this.noop}))?n:"")},"39":function(e,t,i,s){return'                <span class="item-separator">|</span>\r\n'},"41":function(e,t,i,s){var n;return'          <a class="comment esoc-social-attachment-file '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachmentPositionClass:n,e))+'"\r\n             href="javascript:void(0)" data-html="true"\r\n             data-binf-placement="bottom"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+" </a>\r\n"},"43":function(e,t,i,s){var n;return'      <input type="file" id="esoc-social-commentedit-desktop-attachment-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" name="AddDesktopDoc"\r\n             style="display:none" />\r\n      <input type="file" id="esoc-social-commentlist-desktop-attachment-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" name="AddDesktopDoc"\r\n             style="display:none" />\r\n'},"45":function(e,t,i,s){var n;return'  <div id="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" class="esoc-social-comment-load-more"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-comment-body-divider"></div>\r\n<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-comment-list-divider"></div>\r\n<div class="esoc-profileimg-block">\r\n  <span class="esoc-userprofile-img">\r\n    <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.user:e)?n.id:n,e))+' binf-img-circle" src="" />\r\n  </span>\r\n</div>\r\n\r\n<div class="esoc-commentinfo-block-wrapper binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n\r\n  <div class="esoc-commentinfo-block binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n    <div class="esoc-social-comment-details">\r\n      <div class="esoc-social-comment-user-details binf-col-lg-10 binf-col-md-10 binf-col-sm-10 binf-col-xs-10">\r\n        <span class="esoc-user-widget"></span>\r\n        <span class="esoc-social-timestamp">\r\n'+(null!=(n=t.if.call(e,null!=e?e.modified_at_iso8601:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'        </span>\r\n      </div>\r\n      <div class="esoc-social-comment-icon-holder binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2">\r\n        <div class="esoc-social-comment-icon-holder esoc-social-comment-icon-holder-inner">\r\n\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.edit:n,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.messages.feedEventType != 1 && this.actions.deleteAction",{"name":"xif","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.actions:e)?n.hide:n,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+'        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.feed_event_type == 7",{"name":"xif","hash":{},"fn":this.program(11,s,0),"inverse":this.program(18,s,0)}))?n:"")+'    <div class="esoc-social-icons-container binf-col-lg-4 binf-col-md-4 binf-col-sm-5 binf-col-xs-7">\r\n      <div class="esoc-social-edit-icons" id="esoc-social-edit-comment-icons-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n        <a href="javascript:void(0);" id="esoc-social-comment-edit-attachment-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n           class="esoc-social-comment-attachment" data-html="true" data-binf-placement="bottom" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.editAttachment:n,e))+'"\r\n        ></a>\r\n        <a href="javascript:void(0);"\r\n           class="esoc-social-comment-emoticon esoc-social-comment-emotion-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n           id="esoc-social-comment-emoticon-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'"></a>\r\n      </div>\r\n    </div>\r\n    <div id="esoc-suggestion-comment-list_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"></div>\r\n\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.extended_info:e)?n.attachment_id:n,{"name":"if","hash":{},"fn":this.program(26,s,0),"inverse":this.noop}))?n:"")+'\r\n    <div class="esoc-social-comment-list-actions binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.messages.feedEventType != 1 && this.messages.feedEventType != 2",{"name":"xif","hash":{},"fn":this.program(33,s,0),"inverse":this.noop}))?n:"")+'\r\n      <span class="esoc-comment-attachment">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.extended_info.attachment_id == '' && (this.actions.addattachment || this.actions.addshortcut)",{"name":"xif","hash":{},"fn":this.program(41,s,0),"inverse":this.noop}))?n:"")+"      </span>\r\n    </div>\r\n"+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.actions.addattachment && !this.actions.addshortcut",{"name":"xif","hash":{},"fn":this.program(43,s,0),"inverse":this.noop}))?n:"")+'    <input type="hidden" id="esoc-social-comment-cs-shortcut-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'-attachfiles" value="" />\r\n    <input type="hidden" id="esoc-social-comment-cs-shortcut-edit-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" value="" />\r\n\r\n    <div id="reply_'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" data-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'"\r\n         class="reply-thread-list binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n\r\n    <div class="esoc-social-comment-list-update binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <button class="esoc-social-comment-update binf-btn binf-btn-primary" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'">\r\n        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.update:n,e))+'\r\n      </button>\r\n      <button class="esoc-social-comment-cancel binf-btn binf-btn-default" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'">\r\n        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+'\r\n      </button>\r\n      <span class="esoc-social-comment-hidden-text">'+this.escapeExpression((o=null!=(o=t.text||(null!=e?e.text:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"text","hash":{}}):o))+"</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.noMoreData:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(45,s,0)}))?n:"")+'<span class="esoc-social-comment-delete"></span>\r\n<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-comment-body-divider"></div>\r\n'}});return i.registerPartial("esoc_widgets_socialactions_comment",s),s}),csui.define("esoc/widgets/socialactions/commentslist.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/moment","csui/lib/handlebars","csui/utils/contexts/factories/connector","i18n!esoc/widgets/socialactions/nls/lang","esoc/widgets/socialactions/replycollectionbase","esoc/widgets/userwidget/userwidget","hbs!esoc/widgets/socialactions/comment","esoc/widgets/socialactions/util","csui/utils/url","csui/utils/nodesprites","csui/utils/namedsessionstorage","esoc/widgets/userwidget/util","csui/lib/handlebars.helpers.xif"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g){return n.ItemView.extend({"tagName":"li","momentJS":o,"util":m,"namedSessionStorage":new f(m.commonUtil.globalConstants.ESOCIAL_USER_INFO),"className":"esoc-social-comment-list-item binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12","template":u,"templateHelpers":function(){var e,s,n="csui-icon mime_document",o=this.model;-1!==i.inArray(this.model.attributes.feed_event_type,[7,8,9])?(s=1===this.model.attributes.extended_info.subtype,o.attributes.type=s?this.model.attributes.extended_info.sgm_original_sub_type:this.model.attributes.extended_info.subtype,o.attributes.mime_type=s?this.model.attributes.extended_info.sgm_original_mime_type:this.model.attributes.extended_info.mime_type,o.attributes.container=s?this.model.attributes.extended_info.sgm_original_container:this.model.attributes.extended_info.sgm_container,n=h.findClassByNode(o)):this.model.attributes.extended_info&&this.model.attributes.extended_info.attachment_subtype&&(e=this.model.attributes.extended_info.attachment_subtype,o.attributes.type=1===e?this.model.attributes.extended_info.attachment_original_sub_type:e,o.attributes.mime_type=1===e?this.model.attributes.extended_info.attachment_original_mime_type:this.model.attributes.extended_info.attachment_mime_type,o.attributes.container=1===e?this.model.attributes.extended_info.attachment_original_container:this.model.attributes.extended_info.attachment_container,n=h.findClassByNode(o));var a={"reply":r.reply,"replyCount":this.model.get(this.util.commonUtil.globalConstants.REPLY_COUNT)?t.str.sformat(r.replyCount,this.model.get(this.util.commonUtil.globalConstants.REPLY_COUNT)):"","attachFile":r.attachFile,"modifiedAt":r.modifiedAt,"update":r.update,"cancel":r.cancel,"deleteComment":r.deleteComment,"edit":r.edit,"hide":r.hide,"post":r.post,"writeAComment":r.writeAComment,"attachmentDeleteDescription":r.attachmentDeleteDescription,"attachmentDeleteTitle":r.attachmentDeleteTitle,"deleteCommentheader":r.deleteCommentheader,"confirmationText1":r.confirmationText1,"confirmationText2":r.confirmationText2,"shortcutAttachmentSubtype":this.util.commonUtil.globalConstants.SHORTCUT_ATTACHMENT_SUBTYPE,"documentAttachmentSubtype":this.util.commonUtil.globalConstants.DOCUMENT_ATTACHMENT_SUBTYPE,"emoticon":r.emoticon,"feedEventType":parseInt(this.model.attributes.feed_event_type,10),"version":r.version,"more":r.more,"less":r.less,"mimeTypeClass":n,"editAttachment":r.editAttachmentTitle};if(a.attachmentPositionClass=1===parseInt(this.model.attributes.feed_event_type,10)||this.model.attributes.actions&&this.model.attributes.actions.reply&&!this.model.attributes.actions.reply.can_reply?"esoc-social-attachment-file-alone":"",7===this.model.attributes.feed_event_type){var l=void 0===this.model.attributes.extended_info.subtype_name?"":this.model.attributes.extended_info.subtype_name;a.textmsg=""!==l?r.addMsg+l+" ":this.model.attributes.text}return 8===this.model.attributes.feed_event_type&&(a.textmsg=r.versionMsg),this.uniqueId=t.uniqueId(),{"uniqueId":this.uniqueId,"messages":a}},"initialize":function(e){if(e.connector=e.connector||e.context.getObject(l),0===e.model.collection.baseURL.indexOf("http")&&void 0!==e.model.collection.baseURL){var t=e.model.collection.baseURL.split(/[\/]+/);void 0!==this.model.attributes.extended_info&&void 0!==this.model.attributes.extended_info.attachment_icon_id&&(this.model.attributes.extended_info.attachment_icon_id=t[0]+"//"+t[1]+this.model.attributes.extended_info.attachment_icon_id)}this.listenTo(this.model,"change",this.render)},"events":{"click .esoc-social-comment-icon-edit":"onEditComment","keydown .esoc-social-comment-icon-edit":"onClickWithSpaceKey","click .esoc-social-comment-icon-hide":"onHideComment","click .esoc-social-comment-icon-delete.esoc-social-comment-delete-confirm":"onRemoveModel","keydown .esoc-social-comment-icon-delete.esoc-social-comment-delete-confirm":"onClickWithSpaceKey","click .esoc-social-comment-update":"onUpdateComment","click .esoc-social-comment-cancel":"onUpdateCancelComment","input .esoc-social-editable":"onEditTextChanged","input .esoc-social-comment-data-textarea":"onEditTextKeyPress","focus .esoc-social-comment-data-textarea":"onFocusCommentEdit","click .esoc-reply_link":"onCommentReply","keydown .esoc-reply_link":"onClickWithSpaceKey","click .comment.esoc-social-attachment-icon-delete":"onAttachmentDelete","keydown .comment.esoc-social-attachment-icon-delete":"onClickWithSpaceKey",
"click .comment.esoc-social-attachment-file":"selectAttachment","keydown .comment.esoc-social-attachment-file":"onClickWithSpaceKey","input .esoc-comment-emoji":"onEditTextKeyPress","keyup .esoc-comment-emoji":"onEditTextKeyPress","change .esoc-social-comment-data-textarea":"onEditTextKeyPress","focus .esoc-comment-emoji":"onFocusCommentEdit","click .esoc-social-comment-emoticon":"onEmojiPress","click .esoc-social-comment-attachment":"onAttachementPress","click .esoc-object-name, .esoc-social-mime-icon":"openItem","click .esoc-social-attachment-icon, .esoc-social-attachment-download":"openAttachment","keydown .esoc-social-attachment-icon, .esoc-social-attachment-download":"onClickWithSpaceKey","click .esoc-see-more-activity":"showMoreContent","click .esoc-see-less-activity":"showLessContent","mousedown .esoc-comment-emoji .esoc-user-mention":"onCommentEmojiMentionMouseClick"},"_elements":{"csuisocialcommentdatatextarea":null},"constructor":function(){n.ItemView.prototype.constructor.apply(this,arguments)},"onClickWithSpaceKey":function(e){m.applySpaceKeyEvent(e)},"onRender":function(s){var n=this.model,o=this;this.inactivateUnsupportedSubType(n),this.listenTo(this.options.model.collection,"sync",function(){var e=this.model,t="esoc-social-comment-inactive";o.$el.find(".esoc-social-comment-data .esoc-social-mime-icon").removeClass(t),o.$el.find(".esoc-social-comment-data .esoc-object-name").removeClass(t),o.$el.find("#esoc-social-comment-attachment-"+e.attributes.id+" .esoc-social-attachment-name").removeClass(t),o.$el.find("#esoc-social-comment-attachment-"+e.attributes.id+" .esoc-social-attachment-icon").removeClass(t),o.inactivateUnsupportedSubType(e)}),this.options.model.collection.models.length>0&&0===i("#esoc-social-comment-container").find(".esoc-social-comment-body-divider").length&&0!==this.options.model.collection.models[0].id&&(i("#esoc-social-comment-container").css("border-bottom","2px solid #ffffff"),i("#esoc-social-comment-form-buttons-container").removeClass("esoc-social-form-minheight")),2===this.model.attributes.feed_event_type&&(this.$el.addClass("esoc-social-status-reply"),this.$el.find(".esoc-social-attachment").attr("class","binf-col-lg-8 binf-col-md-8 binf-col-sm-10 binf-col-xs-10 esoc-social-attachment")),0===this.$el.find(".esoc-comment-reply").children().length&&0===this.$el.find(".esoc-comment-attachment").children().length&&this.$el.find(".esoc-social-comment-list-actions").hide();this.$el.find(".esoc-social-comment-data").html(),this.model.attributes.extended_info?this.model.attributes.extended_info.user_photo_id:this.model.attributes.data_id;if(this._elements.csuisocialcommentdatatextarea=this.$el.find(".esoc-social-comment-data-textarea"),void 0!==this.model.collection.socialActions&&this.model.collection.socialActions.attachementsEnabled&&this.model.collection.socialActions.shortcutsEnabled){var a={"socialActions":this.model.collection.socialActions,"id":this.model.attributes.id,"uniqueId":this.uniqueId,"desktopAttachmentInputId":"esoc-social-commentlist-desktop-attachment-"+this.model.attributes.id,"attachFiles":!0,"itemview":this,"shortcutIdHolder":this.$el.find("#esoc-social-comment-cs-shortcut-"+this.model.attributes.id+"-attachfiles"),"connector":this.options.connector};this.util.showAttachmentPopOver(this.$el.find(".esoc-social-attachment-file"),a)}if(7!==this.model.attributes.feed_event_type&&8!==this.model.attributes.feed_event_type&&9!==this.model.attributes.feed_event_type&&this.applyemoji(s),9===this.model.attributes.feed_event_type){var l=this.util.commonUtil.onClickableUrl(this.model.attributes.text);l=1===this.model.attributes.extended_info.subtype?l.replace("[MimeType]","<span class='csui-icon-group esoc-social-mime-icon esoc-comment-valign'><span class='"+this.templateHelpers().messages.mimeTypeClass+"'></span><span class='csui-icon csui-icon-shortcut-overlay'></span></span></span>"):l.replace("[MimeType]","<span class='"+this.templateHelpers().messages.mimeTypeClass+" esoc-social-mime-icon esoc-comment-valign'></span>"),this.$el.find(".esoc-social-comment-data").html(l),this.$el.find(".esoc-object-name").addClass("esoc-comment-valign"),this.$el.find(".esoc-social-comment-data").addClass("esoc-social-sgm-attr-change"),this.$el.find(".esoc-object-name").attr("title",this.model.attributes.extended_info.name),this.$el.find(".esoc-social-mime-icon").attr("title",this.model.attributes.extended_info.name)}if(void 0!==this.model.attributes.user&&void 0!==this.model.attributes.user.id){d||(d=e("esoc/widgets/userwidget/userwidget"));var r={"userid":this.model.attributes.user.id,"context":this.model.collection.context,"showUserProfileLink":!0,"showMiniProfile":!0,"UserWidget":d},c=t.extend({"placeholder":this.$el.find(".esoc-profileimg-block"),"showUserWidgetFor":"profilepic","userWidgetWrapperClass":"esoc-social-comment-userprofile-pic","commentsHeaderView":this.options.commentConfigOptions&&this.options.commentConfigOptions.commentsHeaderView},r);d.getUser(c);var u=t.extend({"placeholder":this.$el.find(".esoc-user-widget"),"commentsHeaderView":this.options.commentConfigOptions&&this.options.commentConfigOptions.commentsHeaderView},r);d.getUser(u)}var m=this.options.context?this.options.context:this.model.attributes.widgetOptions.activityfeed.context;g.displayUserWidget(m,this.$el),1===this.model.attributes.feed_event_type&&this.showSeeMoreLink(this.$el.find(this.contentTypeElement))},"onShow":function(t){if(-1!==i.inArray(this.model.attributes.feed_event_type,[7,8])&&(this.$el.find(".esoc-social-comment-data").css("white-space","inherit"),this.$el.find(".esoc-description").length>0)){var s=this.$el.find(".esoc-description").html();s=this.util.commonUtil.onClickableUrl(s),this.$el.find(".esoc-description").html(s)}this.util.setCommentDialogPointer(),d||(d=e("esoc/widgets/userwidget/userwidget"));var n=this;this.$el.find(".esoc-old-user-display-name").each(function(){var e={"userid":i(this).data("userid"),"context":n.options.context?n.options.context:n.model.attributes.widgetOptions.activityfeed.context,"placeholder":this,"showUserProfileLink":!0,"showMiniProfile":!0};d.getUser(e)}),this.$el.find(".esoc-new-user-display-name").each(function(){var e={"userid":i(this).data("userid"),"context":n.options.context?n.options.context:n.model.attributes.widgetOptions.activityfeed.context,"placeholder":this,"showUserProfileLink":!0,"showMiniProfile":!0};d.getUser(e)});var o=this.options.context?this.options.context:this.model.attributes.widgetOptions.activityfeed.context;g.displayUserWidget(o,this.$el),this.showSeeMoreLink(this.$el.find(this.contentTypeElement))},"showSeeMoreLink":function(e){var t=i(e)[0];i(t).addClass("esoc-see-more-content"),this.util.setCommentDialogPointer(e);var s=this;setTimeout(function(){s.util.commonUtil.isTextOverflown(t)&&(s.$el.find(".esoc-see-more").show(),i(t).addClass("esoc-see-more-activity")),s.options.parentCollectionView.triggerMethod("update:scrollbar")},1e3)},"contentTypeElement":".esoc-extended-view-mode","showMoreContent":function(e){""===window.getSelection().toString()&&(this.util.commonUtil.showMoreContent(e,this,this.$el.find(this.contentTypeElement)),this.util.setCommentDialogPointer(e),e.preventDefault(),e.stopPropagation())},"showLessContent":function(e){""===window.getSelection().toString()&&(this.util.commonUtil.showLessContent(e,this,this.$el.find(this.contentTypeElement)),this.util.setCommentDialogPointer(e),e.preventDefault(),e.stopPropagation())},"remove":function(){var e=this;this.$el.fadeOut(function(){n.ItemView.prototype.remove.call(e),e.util.setCommentDialogPointer()})},"openItem":function(){this.trigger("click:item")},"openAttachment":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("click:attachment")},"onFocusCommentEdit":function(e){e.preventDefault(),e.stopPropagation()},"onEditComment":function(e){e.stopPropagation(),e.preventDefault();var t=i("#esoc-social-comment-container")[0].scrollTop,s="",n=0,o=0,a=0,l=0;i(".esoc-social-comment-cancel:visible").length>0&&(s=i(".esoc-social-comment-cancel:visible").closest("li.esoc-social-comment-list-item"),n=i(s).find(".esoc-social-comment-data").height(),o=i(s).find("#esoc-social-comment-edit-"+this.model.attributes.id).height(),a=parseInt(i(s).find(".esoc-social-comment-data").attr("data-id"),10),l=parseInt(n-o,10),i(".esoc-social-comment-cancel:visible").trigger("click")),i(".esoc-social-reply-cancel:visible").length>0&&(s=i(".esoc-social-reply-cancel:visible").closest("li.esoc-social-reply-list-item"),n=i(s).find(".esoc-social-reply-comment-data").height(),o=i(s).find("#esoc-social-comment-reply-list-"+this.model.attributes.id).height(),a=parseInt(i(s).closest(".reply-thread-list").attr("data-id"),10),l=parseInt(n-o,10),i(".esoc-social-reply-cancel:visible").trigger("click")),7!==this.model.attributes.feed_event_type&&8!==this.model.attributes.feed_event_type&&9!==this.model.attributes.feed_event_type&&this.applyemoji(e),this.$el.find('[id^="esoc-social-comment-edit-textarea-"]').hide();var c=this.$el.find(".emoji-wysiwyg-editor");this.util.createChickletForMentions(c),c.show().trigger("focus"),c.first().trigger("focus"),this.$el.find(".esoc-social-comment-data").hide(),this.$el.find(".esoc-social-comment-icon-holder, .esoc-social-comment-list-actions, .reply-thread-list").hide(),this.$el.find(".esoc-social-comment-list-update").show(),this.$el.find(".esoc-social-edit-icons").show(),this.$el.find(".esoc-social-edit-icons").animate({"opacity":1},0);var d=this.model.id;i("#esoc-social-comment-container")[0].scrollTop=null===s||void 0===s||null!==s&&a<d?t:parseInt(t+l-36,10),(this.model.collection.socialActions.attachementsEnabled||this.model.collection.socialActions.shortcutsEnabled)&&""===this.model.attributes.extended_info.attachment_id||(this.$el.find("#esoc-social-comment-edit-attachment-"+this.model.attributes.id).hide(),this.$el.find(".esoc-social-comment-data").hide().addClass("esoc-social-editable-icons"),this.$el.find(".esoc-social-edit-icons").addClass("esoc-social-icon-when-no-attachment"),this.$el.find(".esoc-comment-emoji").addClass("esoc-social-input-when-no-attachment"));var u={"socialActions":this.model.collection.socialActions,"id":this.model.attributes.id,"uniqueId":this.uniqueId,"desktopAttachmentInputId":"esoc-social-commentedit-desktop-attachment-"+this.model.attributes.id,"shortcutIdHolder":this.$el.find("#esoc-social-comment-cs-shortcut-edit-"+this.model.attributes.id),"connector":this.options.connector};this.util.showAttachmentPopOver(this.$el.find("#esoc-social-comment-edit-attachment-"+this.model.attributes.id),u),this.$el.find("#esoc-social-comment-edit-attachment-"+this.model.attributes.id).attr("title",r.attachFile),this.$el.find("#esoc-social-attachment-icon-delete-"+this.model.attributes.id).addClass("esoc-social-comment-edit"),this.$el.find('[id^="esoc-suggestion-comment-list_"]').width(c.outerWidth()),this.util.commonUtil.preventDrop(this.$el.find(".esoc-comment-emoji"));var m=this;this.$el.find("#esoc-social-comment-edit-"+this.model.attributes.id).on("paste",function(e){var t=m.util.commonUtil.globalConstants.MAX_CHAR_LIMIT,s=i(".esoc-social-comment-data-textarea-"+m.model.id).val().length;m.util.commonUtil.onCommentFormPaste(e,s,t),i(".esoc-social-comment-data-textarea-"+m.model.id).innerHTML=i("#esoc-social-comment-edit-"+m.model.attributes.id).html(),m.onEditTextKeyPress(e)}),this.$el.find(".esoc-see-more").hide(),this.$el.find(".esoc-see-less").hide(),this.options.parentCollectionView.triggerMethod("update:scrollbar"),this.options.commentsHeaderView.triggerMethod("dom:refresh")},"onEditTextKeyPress":function(e){this.util.onMentionNameEdit(e);var t=this.$el.find(".esoc-social-comment-data-textarea-"+this.model.attributes.id),i=t.val(),s=this.$el.find(".esoc-social-comment-data"),n=this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT;s.text(i);var o=e||window.event;if(i.length>n){var a=i.substr(0,n);t.val(a),s.text(a),this.$el.find("#esoc-social-comment-edit-"+this.model.attributes.id).html("")[0].textContent=a,this.util.commonUtil.addEmoji(this.$el.find("#esoc-social-comment-edit-"+this.model.attributes.id),!1,this.options.connector),this.util.commonUtil.placeCaretAtEnd(this.$el.find("#esoc-social-comment-edit-"+this.model.attributes.id)),o.preventDefault()}},"onUpdateCancelComment":function(e){var t=i("#esoc-social-comment-container").find(".esoc-social-comment-list-item");t.length<=1&&i(t).removeClass("status-attachment-init-min-height status-attachment-alone-init-min-height esoc-edit-init-min-height"),this.$el.removeClass("esoc-social-editable-parent").find(".esoc-social-comment-data-textarea-"+this.model.attributes.id).removeClass("esoc-social-editable").val(this.$el.find(".esoc-social-comment-hidden-text").text()).hide(),this.applyemoji(e),this.$el.find("#esoc-social-comment-data-textarea-"+this.model.attributes.id).css("display","none"),this.$el.find("#esoc-social-comment-reply-textarea").css("display","none"),this.$el.find(".esoc-social-comment-icon-holder, .esoc-social-comment-list-actions").show(),this.$el.find("#esoc-social-comment-attachment-"+this.model.attributes.id).show(),this.$el.find(".esoc-social-comment-list-update").hide(),this.$el.find(".esoc-social-warning").hide(),this.$el.find(".esoc-social-edit-icons").hide(),this.$el.removeClass("esoc-social-editable-parent").find(".esoc-social-comment-data").removeClass("esoc-social-editable"),this.$el.find(".esoc-social-comment-data").css("display","block"),this.$el.find(".esoc-social-comment-data").attr("class","binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-social-comment-data"),this.$el.find("#esoc-social-attachment-icon-delete-"+this.model.attributes.id).removeClass("esoc-social-comment-edit"),(this.model.collection.socialActions.attachementsEnabled||this.model.collection.socialActions.shortcutsEnabled)&&""===this.model.attributes.extended_info.attachment_id||(this.$el.find(".esoc-social-comment-data").removeClass("esoc-social-editable-icons"),this.$el.find(".esoc-social-comment-data-textarea").removeClass("esoc-social-editable-icons"),this.$el.find(".esoc-comment-emoji").removeClass("esoc-social-input-when-no-attachment"));var s=this.$el.find("#esoc-social-comment-edit-attachment-"+this.model.attributes.id),n=this.$el.find("#esoc-social-commentedit-desktop-attachment-"+this.model.attributes.id);s.attr("data-binf-original-title")&&s.attr("data-binf-original-title").length>0&&this.util.hideAttachmentPopup(s,n,this.model.collection.socialActions),this.$el.find("#esoc-social-comment-cs-shortcut-edit-"+this.model.attributes.id).val(""),this.util.setFocusOnDefaultElement(e);var o=this.options.context?this.options.context:this.model.attributes.widgetOptions.activityfeed.context;g.displayUserWidget(o,this.$el),this.showSeeMoreLink(this.$el.find(this.contentTypeElement)),this.options.parentCollectionView.triggerMethod("update:scrollbar"),this.$el.find(".esoc-social-comment-icon-edit:first-child").trigger("focus")},"onUpdateComment":function(e){var t=i("#esoc-social-comment-container").find(".esoc-social-comment-list-item");t.length<=1&&i(t).removeClass("status-attachment-init-min-height status-attachment-alone-init-min-height esoc-edit-init-min-height");var s,n=this.$el.find(".esoc-social-comment-data-textarea-"+this.model.attributes.id),o=void 0!==n?n.val().trim():"",a=this.model.attributes.id,l=this.model.attributes.actions.edit.href,r=i("#esoc-social-comment-cs-shortcut-edit-"+a),c=new FormData,d=i("#esoc-social-commentedit-desktop-attachment-"+a);if(c.append("commands","default"),r.val().length>0)c.append("ATT_ID",parseInt(r.val(),10)),s=!0;else if(d.length>0){var u=d[0].files[0];u?(c.append("AddDesktopDoc",u),s=!0):s=!1}else s=this.$el.find(".esoc-social-comment-edit").is(":hidden");this.util.showMask(this.$el),c.append("status",o),c.append("id",a),c.append("replace",s);var m=this;if(""!==o){var p={"url":m.options.connector.connection.url+l,"type":m.model.attributes.actions.edit.method,"data":c,"itemview":this,"baseURL":this.model.collection.baseURL};this.util.updateWithAttachmentAjaxCall(p).done(function(){m.$el.find(".esoc-social-comment-icon-edit:first-child").trigger("focus")})}else this.$el.find("#esoc-social-comment-edit-"+this.model.attributes.id).trigger("focus"),this.util.hideMask(this.$el);this.$el.find("#esoc-social-attachment-icon-delete-"+this.model.attributes.id).removeClass("esoc-social-comment-edit")},"onHideComment":function(e){},"onRemoveModel":function(e){this.util.showMask(this.$el);var t=this.model.attributes.id,i=this.model.attributes.actions.deleteAction.href,s=this,n={"url":s.options.connector.connection.url+i+"?id="+t,"type":s.model.attributes.actions.deleteAction.method,"model":this,"async":!1,"requestType":"CommentDelete"},o={"dialogtitle":this.templateHelpers().messages.deleteCommentheader,"dialogmessage":this.templateHelpers().messages.confirmationText1+" "+this.templateHelpers().messages.confirmationText2,"ajaxParams":n};this.util.openConfirmationDialog(o)},"destroy":function(e){this.undelegateEvents(),this.off(),this.remove()},"onCommentReply":function(e){var t="#reply_"+this.model.id;if(i(t).is(":visible"))i(t).children("div").remove(),i(t).hide(),this.$el.find(".esoc-social-comment-icon-holder").show(),this.options.parentCollectionView.triggerMethod("update:scrollbar"),this.util.setCommentDialogPointer();else{var s=parseInt(i('div[id^="reply_"]:visible').attr("data-id"),10),n=this.model.id,o=i("#esoc-social-comment-container").height(),a=i("#esoc-social-comment-container")[0].scrollHeight,l=i("#esoc-social-comment-container")[0].scrollTop,r=i('div[id^="reply_"]:visible').height(),d=i("#esoc-social-comment-container")[0];n<s&&(r<l||r-l<o)&&(d.scrollHeight=a-r,d.scrollTop=l-r),i('div[id^="reply_"]').children("div").remove(),i('div[id^="reply_"]').hide();var u={"parentNode":t,"csBaseUrl":this.options.model.collection.baseURL,"context":this.options.context,"getRepliesUrl":p.appendQuery(this.model.attributes.actions.reply.href,""),"conversation_id":this.model.attributes.extended_info.conversation_id,"item_id":this.model.id,"parentCommentModel":this.model,"parentCollectionView":this.options.parentCollectionView,"canReply":this.model.attributes.actions.reply.can_reply,"socialActions":this.model.collection.socialActions};new c(u),this.$el.find(".esoc-reply-emoji").trigger("focus")}},"onAttachmentDelete":function(e){if(e.target.classList.contains("esoc-social-comment-edit"))e.preventDefault(),e.stopPropagation(),this.$el.find("#esoc-social-comment-attachment-"+this.model.attributes.id).hide(),this.$el.find("#esoc-social-comment-edit-attachment-"+this.model.attributes.id).show(),this.$el.find(".esoc-social-edit-icons").removeClass("esoc-social-icon-when-no-attachment "),this.$el.find(".esoc-comment-emoji").removeClass("esoc-social-input-when-no-attachment"),this.$el.find(".esoc-social-comment-data").removeClass("esoc-social-editable-icons"),this.$el.find(".esoc-social-comment-data-textarea").removeClass("esoc-social-editable-icons"),i("#esoc-social-comment-edit-"+this.model.attributes.id).trigger("focus");else{var t=this,s=this.model.attributes.id,n=this.model.attributes.actions.edit.href,o=i("<div />").html(this.model.attributes.text),a=o.text(),l={"url":t.options.connector.connection.url+n,"type":t.model.attributes.actions.edit.method,"dataType":"text","data":{"id":s,"status":a,"ATT_ID":0,"replace":!0},"model":t,"requestType":"AttachmentDelete"},r={"dialogtitle":this.templateHelpers().messages.attachmentDeleteTitle,"dialogmessage":this.templateHelpers().messages.attachmentDeleteDescription,"ajaxParams":l};this.util.openConfirmationDialog(r)}},"uploadAttachment":function(e){var t=this.model.attributes.id,s=this.model.attributes.actions.edit.href,n=i("#esoc-social-comment-cs-shortcut-"+this.model.attributes.id+"-attachfiles"),o=new FormData,a=this.$el.find("#esoc-social-commentlist-desktop-attachment-"+t);if(o.append("commands","default"),""!==n.val())o.append("ATT_ID",parseInt(n.val(),10));else if(a.length>0){var l=a[0].files[0];l&&o.append("AddDesktopDoc",l)}this.$el.find(".esoc-comment-attachment").hide(),this.$el.find(".item-separator").hide(),this.util.showMask(this.$el);var r=i("<div />").html(this.model.attributes.text),c=r.text();o.append("status",c),o.append("id",t);var d={"url":this.options.connector.connection.url+s,"type":this.model.attributes.actions.edit.method,"data":o,"itemview":this,"baseURL":this.model.collection.baseURL,"commentId":t,"feedType":"comment"};this.util.updateWithAttachmentAjaxCall(d),n.val(""),this.util.resetAttachmentInput(a,this.model.collection.socialActions)},"selectAttachment":function(e){if(this.model.collection.socialActions.attachementsEnabled&&!this.model.collection.socialActions.shortcutsEnabled){var t=this,s=this.$el.find("#esoc-social-commentlist-desktop-attachment-"+this.model.attributes.id);s.off("change").on("change",function(e){s.val().length>0&&t.uploadAttachment(e)}),this.openBrowseWindow(e,s)}else if(!this.model.collection.socialActions.attachementsEnabled&&this.model.collection.socialActions.shortcutsEnabled){var n={"shortcutIdHolder":i("#esoc-social-comment-cs-shortcut-"+this.model.attributes.id+"-attachfiles"),"itemview":this,"attachFiles":!0};this.util.openTargetPicker(this.$el.find(".esoc-social-attachment-file"),n)}},"openBrowseWindow":function(e,t){t.val(""),t.trigger("click")},"applyemoji":function(e){if(void 0!==this.model.attributes&&void 0!==this.model.attributes.id){this.$el.find(".emoji-wysiwyg-editor").remove();var t=this.$el.find(".esoc-social-comment-data-textarea-"+this.model.attributes.id);t.val(t.val().replace(/&quot;/gi,'"'));var s=(t.emojiarea({"path":this.util.commonUtil.getEmojiPath(this.options.connector),"wysiwyg":!0,"button":".esoc-social-comment-emotion-"+this.model.attributes.id,"id":"esoc-social-comment-edit-textarea-"+this.model.attributes.id,"parent":this.$el.find("#esoc-social-edit-comment-icons-"+this.model.attributes.id),"container":i("#esoc-social-comment-container"),"util":this.util,"widget":i(".esoc-social-comment-widget")}),this.$el.find(".emoji-wysiwyg-editor"));s.addClass("esoc-comment-emoji").attr({"id":"esoc-social-comment-edit-"+this.model.attributes.id,"data-text":this.templateHelpers().messages.writeAComment}),t.hide(),s.hide();var n=s.html();n=this.util.commonUtil.onClickableUrl(n),this.$el.find(".esoc-social-comment-data").html(n),s.html(s.html().replace(/\n/gi,"<br>"))}var o={"context":this.options.context,"connector":this.options.connector,"element":this.$el.find("#esoc-social-comment-edit-"+this.model.attributes.id),"appendToElement":this.$el.find("[id^='esoc-suggestion-comment-list_']")};this.util.triggerAutoCompleteSuggestion(o),this.$el.find(".emoji-wysiwyg-editor").removeAttr("autocomplete")},"onEmojiPress":function(e){e.target.parentNode.id==="esoc-social-edit-comment-icons-"+this.model.attributes.id&&i("#esoc-social-comment-container").find(".esoc-social-comment-list-item").length<=1&&i("#esoc-social-comment-container").find(".esoc-social-comment-list-item").addClass("esoc-edit-init-min-height"),void 0!==this.model.attributes&&void 0!==this.model.attributes.id&&this.util.hidePopover(this.$el.find(".esoc-social-comment-emotion-"+this.model.attributes.id)),e.stopPropagation()},"onAttachementPress":function(e){this.$el.find(".emoji-menu").hide()},"onCommentEmojiMentionMouseClick":function(e){this.util.setCursorPositionAtStartOFMention(e)},"inactivateUnsupportedSubType":function(e){var t="esoc-social-comment-inactive",s=this.options.parentCollectionView.defaultActionController;-1!==i.inArray(this.model.attributes.feed_event_type,[7,8,9])?(this.sgmModel=this.util.commonUtil.buildNodeModel(e,this.options.connector),s&&!s.hasAction(this.sgmModel)&&(this.$el.find(".esoc-social-comment-data .esoc-social-mime-icon").addClass(t),this.$el.find(".esoc-social-comment-data .esoc-object-name").addClass(t))):this.model.attributes.extended_info&&this.model.attributes.extended_info.attachment_subtype&&(this.attachmentModel=this.util.commonUtil.buildNodeModel(e,this.options.connector,!0),s&&!s.hasAction(this.attachmentModel)&&(this.$el.find("#esoc-social-comment-attachment-"+this.model.attributes.id+" .esoc-social-attachment-name").addClass(t),this.$el.find("#esoc-social-comment-attachment-"+this.model.attributes.id+" .esoc-social-attachment-icon").addClass(t)))}})}),csui.define("esoc/widgets/socialactions/social.infinite.scrolling.behavior",["csui/controls/tile/behaviors/infinite.scrolling.behavior"],function(e){"use strict";return e.extend({"_checkScrollPositionFetch":function(){var e=this._content,t=e.height(),i=e[0].scrollHeight;e.scrollTop()+30>=i-t&&this._content.find(".esoc-social-comment-load-more:last").trigger("click")}})}),csui.define("esoc/widgets/socialactions/commentscollection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/behaviors/default.action/default.action.behavior","esoc/widgets/socialactions/commentslist.view","esoc/widgets/socialactions/util","csui/controls/tile/behaviors/perfect.scrolling.behavior","esoc/widgets/socialactions/social.infinite.scrolling.behavior"],function(e,t,i,s,n,o,a,l,r){return s.CollectionView.extend({"tagName":"ul","className":"comments-list","childView":o,"util":a,"constructor":function(e){this.childViewOptions=e,this.childViewOptions.parentCollectionView=this,s.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this.collection,"remove sync",this.triggerMethod("update:scrollbar"))},"events":{"click .esoc-social-comment-load-more":"loadMoreItems"},"onRender":function(){var t=this;this.$el.find(".esoc-social-comment-list-item").hide(),this.util.setCommentDialogPointer(),e(window).on("resize",function(i){e("[id*=esoc-social-comment-widget]")&&e("[id*=esoc-social-comment-widget]").length>0&&t.util.setCommentDialogPointer()})},"behaviors":{"PerfectScrolling":{"behaviorClass":l,"suppressScrollX":!0},"InfiniteScrolling":{"behaviorClass":r},"DefaultAction":{"behaviorClass":n}},"childEvents":{"click:item":"onClickItem","click:attachment":"onClickAttachment"},"onClickItem":function(e){var t={"node":e.sgmModel,"callingViewInstance":this};this.util.commonUtil.openItem(t)},"onClickAttachment":function(e){var t={"node":e.attachmentModel,"callingViewInstance":this};this.util.commonUtil.openItem(t)},"loadMoreItems":function(e){this.collection.models[this.collection.models.length-1].attributes.noMoreData||(delete this.collection.defaults.params[this.util.commonUtil.globalConstants.SINCE_ID],this.collection.defaults.params[this.util.commonUtil.globalConstants.MAX_ID]=e.target.id,this.collection.fetch({"remove":!1}))}})}),csui.define("hbs!esoc/widgets/socialactions/commentsheadertemplate",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'    <div id="esoc-social-comment-form-container" class="esoc-social-comment-form-container">\r\n      <div class="esoc-social-comment-form-mask"></div>\r\n      <div id="esoc-social-comment-form-buttons-container"\r\n           class="row-fluid esoc-social-form-minheight">\r\n        <div class="esoc-social-comment-avatar-container">\r\n          \x3c!-- TODO: need to replace this image with current logged-in user\'s profile image and remove the background related css properties --\x3e\r\n          <span id="esoc-social-default-avatar" class="image_user_placeholder\r\n          esoc-social-comment-default-avatar">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n          <img id="esoc-social-comment-avatar" class="binf-img-circle esoc-social-comment-avatar"\r\n               src="#" alt="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'"/>\r\n        </div>\r\n        <div class="esoc-social-comment-input-container">\r\n          <div class="esoc-social-add-comment-data" style="display:none;"></div>\r\n                    <textarea id="esoc-social-comment-input"\r\n                              class="binf-form-control esoc-social-comment-input"\r\n                              placeholder="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.writeAComment:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.writeAComment:n,e))+'"></textarea>\r\n\r\n          <div id="esoc-suggestion-comment-header"></div>\r\n          <div id="esoc-social-textinput-button-holder" class="esoc-social-textinput-button-holder">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.attachementsEnabled:n,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+'            <a href="javascript:void(0);"\r\n               class="esoc-social-comment-header-emotion esoc-social-comment-emoticon"\r\n               id="esoc-social-comment-emoticon" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.emoticon:n,e))+'"></a>\r\n            <button id="esoc-social-comment-submit" disabled\r\n                    class="binf-btn binf-btn-primary esoc-social-comment-submit" type="submit"\r\n                    title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.post:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.post:n,e))+"</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.attachementsEnabled:n,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+'      <input type="hidden" id="esoc-social-comment-cs-shortcut" value="" />\r\n    </div>\r\n'},"2":function(e,t,i,s){var n;return'              <a href="javascript:void(0);" id="esoc-social-comment-attachment"\r\n                 class="esoc-social-comment-attachment esoc-social-comment-attachment-header"\r\n                 data-html="true" data-binf-placement="bottom" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+'"></a>\r\n'},"4":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.shortcutsEnabled:n,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:""},"5":function(e,t,i,s){var n;return'                <a href="javascript:void(0);" id="esoc-social-comment-attachment"\r\n                   class="esoc-social-comment-attachment esoc-social-comment-attachment-header"\r\n                   data-html="true" data-binf-placement="bottom" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attachFile:n,e))+'"></a>\r\n'},"7":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.shortcutsEnabled:n,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(8,s,0)}))?n:""},"8":function(e,t,i,s){return'          <input type="file" id="esoc-social-comment-desktop-attachment" name="AddDesktopDoc"\r\n                 style="display:none" />\r\n'},"10":function(e,t,i,s){return"    <hr>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n
;return'<div id="esoc-social-comment-create-container" class="">\r\n  <div id="esoc-social-comment-title-bar" class="esoc-social-comment-title-bar">\r\n    <div id="esoc-social-comment-title"\r\n         class="esoc-social-comment-title"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+' </div>\r\n    <div id="esoc-social-comment-title-actions" class="esoc-social-comment-title-actions">\r\n      <a href="javascript:void(0);" id="esoc-social-comment-close-button"\r\n         class="esoc-social-comment-close-button" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.close:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.close:n,e))+'"></a>\r\n      <a href="javascript:void(0);" id="esoc-social-focus-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.close:n,e))+'"></a>\r\n    </div>\r\n  </div>\r\n  <div id="esoc-social-comment-warning"\r\n       class="binf-alert binf-alert-danger esoc-social-warning esoc-social-comment-warning" role="alert">\r\n    '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.commentBlank:n,e))+"\r\n  </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.commentingOpen:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(10,s,0)}))?n:"")+'  <div id="esoc-social-comment-loading-indication"\r\n       class="esoc-social-comment-loading-indication">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.loadingComments:n,e))+'</div>\r\n  <div id="esoc-social-comment-container" class="binf-container esoc-social-comment-container"></div>\r\n</div>\r\n\r\n<div class="binf-modal binf-fade" id="esoc-social-dialog" tabindex="-1" role="dialog"\r\n     aria-labelledby="myModalTitle" aria-hidden="true">\r\n  <div class="binf-modal-dialog">\r\n    <div class="binf-modal-content esoc-social-modal-content">\r\n      <div class="binf-modal-header">\r\n        <h4 class="binf-modal-title" id="myModalTitle"></h4>\r\n      </div>\r\n      <div class="binf-modal-body">\r\n        <div class="binf-row">\r\n          <div class="binf-col-sm-2">\r\n            <span class="esoc-dialog-warning-icon"></span>\r\n            \x3c!-- need to change to warning icon as per mockup--\x3e\r\n          </div>\r\n          <div id="myModalConfirmationText" class="binf-col-sm-8"></div>\r\n        </div>\r\n        <div class="binf-row esoc-dialog-warning-margin">\r\n          <div class="binf-col-md-12 esoc-dialog-warning-buttons-align-middle">\r\n            <button type="button"\r\n                    class="binf-btn binf-btn-default esoc-social-dialog-delete-button">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.deleteComment:n,e))+'</button>\r\n            <button type="button" class="binf-btn binf-btn-default esoc-social-dialog-cancel-button"\r\n                    data-binf-dismiss="modal">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.cancel:n,e))+"</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>"}});return i.registerPartial("esoc_widgets_socialactions_commentsheadertemplate",s),s}),csui.define("esoc/widgets/socialactions/commentsheader.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/utils/url","csui/utils/contexts/factories/user","csui/utils/user.avatar.color","csui/utils/contexts/factories/connector","csui/controls/mixins/keyboard.navigation/modal.keyboard.navigation.mixin","i18n!esoc/widgets/socialactions/nls/lang","hbs!esoc/widgets/socialactions/commentsheadertemplate","esoc/widgets/socialactions/util","esoc/widgets/socialactions/comment.model","esoc/widgets/socialactions/mentions","esoc/lib/jquery.emojiarea/jquery.emojiarea.custom","esoc/lib/jquery.emojiarea/packs/custom/emojis","css!esoc/lib/jquery.emojiarea/jquery.emojiarea.css","css!esoc/lib/jquery.emojiarea/jquery.emojiarea.custom.css","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g){var v=null,b=s.ItemView.extend({"initialize":function(e){this.options=e,this.options.connector=this.options.connector||this.options.context.getObject(r),v=this},"options":{},"_elements":{"csuiSocialCommentInput":null,"csuiSocialSubmitButton":null,"csuiSocialButtonsContainer":null,"csuiSocialAvatarIcon":null,"csuiSocialFormContainer":null,"csuiSocialCommentInputHolder":null,"csuiSocialCommentInputHiddenData":null,"csuiSocialFormWarning":null,"csuiSocialCommentShortcut":null,"csuiSocialCommentAttachmentName":null,"csuiSocialCommentAttachmentSize":null,"csuiSocialCommentAttachmentIcon":null,"csuiSocialCommentAttachmentPopupTitle":null,"csuiSocialCommentAttachmentPopupContent":null,"csuiSocialCommentDiv":null},"textareaScrollThresh":45,"tagName":"div","util":m,"emojis":g,"emojiarea":new f,"mentions":h,"template":u,"templateHelpers":function(){var i={"comments":d.comments,"commentBlank":d.commentBlank,"post":d.post,"posting":d.posting,"writeAComment":d.writeAComment,"loadingComments":d.loadingComments,"confirmationText1":d.confirmationText1,"confirmationText2":d.confirmationText2,"cancel":d.cancel,"deleteComment":d.deleteComment,"deleteCommentheader":d.deleteCommentheader,"close":d.close,"emoticon":d.emoticon,"attachFile":d.attachFile};return this.uniqueId=t.uniqueId(),i=e.extend(this.options.socialActions,i),{"messages":i}},"events":{"keydown .esoc-social-attachment-file":"_refreshtabs","click #esoc-social-comment-create-container":"onCommentDialogClick","touchstart #esoc-social-comment-create-container":"onCommentDialogClick","focus .esoc-header-emoji":"onCommentFormFocus","click .esoc-header-emoji":"onCommentInputFocus","click #esoc-social-comment-submit":"onCommentFormSubmit","input .esoc-header-emoji":"onCommentFormKeypress","click #esoc-social-comment-close-button":"onCloseButton","keydown #esoc-social-comment-close-button":"onClickWithSpaceKey","click #esoc-social-comment-emoticon":"onEmojiPress","keydown #esoc-social-comment-emoticon":"onClickWithSpaceKey","click .esoc-social-comment-attachment":"onAttachementPress","keydown .esoc-social-comment-attachment":"onClickWithSpaceKey","change #esoc-social-comment-input":"onCommentChange","keyup .esoc-header-emoji":"onCommentEmojiKeypress","mousedown .esoc-header-emoji .esoc-user-mention":"onCommentEmojiMentionMouseDown","keydown .esoc-social-attachment-cs":"onCSAttachmentKeyDown","keydown .esoc-social-attachment-desktop":"onDesktopAttachmentKeyDown"},"onClickWithSpaceKey":function(e){m.applySpaceKeyEvent(e)},"onCSAttachmentKeyDown":function(t){9===(t.keyCode||t.which)&&t.shiftKey&&e(t.target.closest(".binf-popover")).binf_popover("hide")},"onDesktopAttachmentKeyDown":function(t){9!==(t.keyCode||t.which)||t.shiftKey||e(t.target.closest(".binf-popover")).binf_popover("hide")},"onRender":function(i){this._elements.csuiSocialCommentInput=this.$el.find("#esoc-social-comment-input"),this._elements.csuiSocialCommentInputHiddenData=this.$el.find(".esoc-social-add-comment-data"),this._elements.csuiSocialSubmitButton=this.$el.find("#esoc-social-comment-submit"),this._elements.csuiSocialButtonsContainer=this.$el.find("#esoc-social-textinput-button-holder"),this._elements.csuiSocialAvatarIcon=this.$el.find("#esoc-social-comment-avatar"),this._elements.csuiSocialFormContainer=this.$el.find("#esoc-social-comment-form-container"),this._elements.csuiSocialFormWarning=this.$el.find(".esoc-social-warning"),this._elements.csuiSocialCommentShortcut=this.$el.find("#esoc-social-comment-cs-shortcut"),this._elements.csuiSocialCommentAttachmentName=this.$el.find("#esoc-social-comment-header-attachment-name"),this._elements.csuiSocialCommentAttachmentSize=this.$el.find("#esoc-social-comment-header-attachment-size"),this._elements.csuiSocialCommentAttachmentIcon=this.$el.find("#esoc-social-comment-attachment"),this._elements.csuiSocialCommentAttachmentPopupTitle=this.$el.find("#esoc-social-selected-attachment-dialog-title"),this._elements.csuiSocialCommentAttachmentPopupContent=this.$el.find("#esoc-social-selected-attachment-dialog"),this._elements.csuiSocialSubmitButton.hide(),this._elements.csuiSocialButtonsContainer.hide();var s={"socialActions":this.options.socialActions,"id":"comment","uniqueId":this.uniqueId,"desktopAttachmentInputId":"esoc-social-comment-desktop-attachment","shortcutIdHolder":this._elements.csuiSocialCommentShortcut,"connector":this.options.connector};this.util.showAttachmentPopOver(this._elements.csuiSocialCommentAttachmentIcon,s),this._elements.csuiSocialCommentAttachmentIcon.attr("title",d.attachFile),this.onCommentFormBlur();var n=this;e(window).on("resize",function(e){n.adjustCommentAreaWidth(e,!0)}),this.listenTo(this,"collection:sync:callback",t.bind(function(){var e=this.$el.closest(".esoc-social-comment-widget");e.show();var i=e.parent();(i.find(".esoc-socialactions-widget-arrow-right").length?i.find(".esoc-socialactions-widget-arrow-right"):i.find(".esoc-socialactions-widget-arrow-left")).show(),m.setCommentDialogPointer(),this.addFocus(),this.applyReplyEmoji(),e.find("[id^='esoc-social-comment-widget-pointer']").on("click",function(e){v.onCommentDialogClick(e)}),this._elements.csuiSocialCommentDiv=this.$el.find(".esoc-header-emoji");var s=e.find("#esoc-social-comment-header");s.length&&(s.on("paste",t.bind(function(t){var i=this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT,n=e.find("#esoc-social-comment-input").val().length;this.util.commonUtil.onCommentFormPaste(t,n,i),e.find("#esoc-social-comment-input").innerHTML=s.html(),this.onCommentChange(t)},this)),s.off("mouseleave").on("mouseleave",t.bind(function(e){this.onCommentFormMouseLeave(e)},this)),this.util.commonUtil.preventDrop(s.find(".esoc-header-emoji")),s.trigger("focus"),this.engageModalKeyboardFocusOnOpen(this.el))},this))},"_refreshtabs":function(){this.triggerMethod("dom:refresh")},"onCommentDialogClick":function(t){"esoc-social-comment-header"===t.target.id||"esoc-social-comment-emoticon"===t.target.id||"esoc-social-comment-attachment"===t.target.id||"esoc-social-comment-desktop-attachment"===t.target.id||e(t.target).parents("#esoc-social-comment-header").length>0||e(t.target).closest(".binf-popover").length>0||"esoc-social-comment-submit"===t.target.id||this.onCommentFormBlur(t);var i=e("#esoc-social-comment-container").find(".esoc-social-comment-list-item");e(t.target.parentNode).hasClass("esoc-social-attachment-cs")||e(t.target.parentNode).hasClass("esoc-social-attachment-desktop")||e(t.target).hasClass("esoc-social-attachment-file-alone")||e(t.target).hasClass("esoc-social-comment-attachment")||e(t.target).hasClass("esoc-social-comment-emoticon")||e(t.target.parentNode.parentNode).hasClass("myemoji")||e(t.target).hasClass("esoc-social-attachment-file")||setTimeout(function(){e(i).removeClass("status-attachment-alone-init-min-height"),e(i).removeClass("esoc-attachment-init-min-height").removeClass("esoc-emoji-init-min-height"),e("#esoc-social-comment-container").find(".esoc-social-comment-list-item").removeClass("esoc-edit-init-min-height").removeClass("status-attachment-init-min-height")},100)},"onShow":function(){this.user=this.options.context.getModel(a),this.listenTo(this.model,"sync",function(){this.user&&this.user.get("id")&&this.updateUserProfilePicture(this.user.get("id"),this.user)})},"addFocus":function(t){e(".cs-expanded.activityfeed-expand.esoc.cs-dialog.binf-modal.binf-fade.binf-in").removeAttr("tabindex").prop("disabled",!0),e("[id^='esoc-social-comment-widget-mask_']").attr("tabindex","-1"),e(".cs-expanded.activityfeed-expand.esoc.cs-dialog.binf-modal.binf-fade.binf-in").removeAttr("tabindex").prop("disabled",!1)},"onCommentFormMouseLeave":function(e){this._elements.csuiSocialCommentInput[0].innerHTML=this._elements.csuiSocialCommentInput.val()},"updateUserProfilePicture":function(e,t){var i=t.get("initials"),s=l.getUserAvatarColor(t.attributes);if(void 0!==e&&""!==e){var n=this.$el.find("#esoc-social-comment-avatar"),o=this.$el.find("#esoc-social-default-avatar");o[0].innerText=i,n.addClass("esoc-userprofile-img-"+e),o.addClass("esoc-user-default-avatar-"+e),o.css("background",s);var a={"userid":e,"context":this.options.context,"photoElement":n,"defaultPhotElement":o}}this.util.commonUtil.setProfilePic(a)},"onCommentInputFocus":function(e){this.$el.find(".esoc-header-emoji").trigger("focus")},"onCommentFormFocus":function(t){var i=this._elements.csuiSocialCommentInput.val().trim();void 0!==i&&""!==i?this.$el.find("#esoc-social-comment-submit").prop("disabled",!1):this.$el.find("#esoc-social-comment-submit").prop("disabled",!0),t.stopPropagation(),this.$el.find(".esoc-header-emoji").addClass("emoji-wysiwyg-editor-focus"),this._elements.csuiSocialButtonsContainer.css({"display":"block"}),this.util.commonUtil.isIE()&&this.$el.find(".esoc-header-emoji").length>0&&0===this.$el.find(".esoc-header-emoji")[0].textContent.length&&this.$el.find(".esoc-header-emoji").attr("data-text",""),this.options.socialActions.attachementsEnabled||this.options.socialActions.shortcutsEnabled||(this._elements.csuiSocialButtonsContainer.addClass("esoc-social-textinput-without-attachment"),this.$el.find(".esoc-header-emoji").addClass("esoc-social-input-when-no-attachment"),this._elements.csuiSocialCommentInputHiddenData.addClass("esoc-social-input-when-no-attachment")),this._elements.csuiSocialButtonsContainer.animate({"opacity":1},0),this._elements.csuiSocialAvatarIcon.animate({"opacity":1},0),this._elements.csuiSocialButtonsContainer.show(),this._elements.csuiSocialSubmitButton.show();var s=""===this.$el.find(".esoc-header-emoji").html()||"<br>"===this.$el.find(".esoc-header-emoji").html();this.adjustCommentAreaWidth(t,s),this.$el.find(".esoc-social-attachment-popover").is(":visible")&&(this._elements.csuiSocialCommentAttachmentIcon.binf_popover("hide"),e(".esoc-social-comment-dialog-att-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),e(".esoc-social-comment-dialog-minheight").removeClass("esoc-social-comment-dialog-minheight"),this.util.setCommentDialogPointer())},"adjustCommentAreaWidth":function(e,t){var i=this.$el.find(".esoc-header-emoji");t&&(i.css("width",""),i.width(this.$el.find(".esoc-header-emoji").width()-parseInt(this.$el.find("#esoc-social-comment-submit").outerWidth()+14,10)),this.$el.find("#esoc-suggestion-comment-header").width(i.outerWidth()))},"onCommentFormBlur":function(t){if(!this.$el.find(".esoc-social-comment-form-mask").is(":visible")){var i,s,n=this._elements.csuiSocialCommentInput.val(),o=this.$el.find(".esoc-header-emoji").html(),a=this.$el.find("#esoc-social-comment-desktop-attachment");a.length>0&&a[0].files&&a[0].files.length>0&&(i=a[0].files[0]),this.util.isValidInput(this._elements.csuiSocialCommentShortcut)&&(s=parseInt(this._elements.csuiSocialCommentShortcut.val(),10)),void 0!==n&&""!==n||void 0!==i&&""!==i||void 0!==s||void 0!==o&&""!==o&&"<br>"!==o||(this._elements.csuiSocialAvatarIcon.animate({"opacity":.3},0),void 0===this.options.socialActions||this.options.socialActions.attachementsEnabled||this.options.socialActions.shortcutsEnabled||(this._elements.csuiSocialButtonsContainer.removeClass("esoc-social-textinput-without-attachment"),this.$el.find(".esoc-header-emoji").removeClass("esoc-social-input-when-no-attachment"),this._elements.csuiSocialCommentInputHiddenData.removeClass("esoc-social-input-when-no-attachment")),this.$el.find(".esoc-header-emoji").removeClass("emoji-wysiwyg-editor-focus"),this._elements.csuiSocialButtonsContainer.hide(),this._elements.csuiSocialSubmitButton.hide(),this._elements.csuiSocialButtonsContainer.animate({"opacity":0},0,function(){e(this).css({"display":"none"})}),this.$el.find(".esoc-header-emoji").css("width","95%"),e("#esoc-social-comment-header").removeClass("emoji-wysiwyg-editor-focus").trigger("blur"),this.util.commonUtil.isIE()&&this.$el.find(".esoc-header-emoji").length>0&&0===this.$el.find(".esoc-header-emoji")[0].textContent.length&&e(".esoc-header-emoji").attr("data-text",this.templateHelpers().messages.writeAComment),this._elements.csuiSocialCommentAttachmentIcon.attr("data-binf-original-title")&&this._elements.csuiSocialCommentAttachmentIcon.attr("data-binf-original-title").length>0&&this.util.hideAttachmentPopup(this._elements.csuiSocialCommentAttachmentIcon,this.$el.find("#esoc-social-comment-desktop-attachment"),this.options.socialActions))}},"onCommentChange":function(e){var t=this._elements.csuiSocialCommentInput.val().trim();void 0!==t&&""!==t?this.$el.find("#esoc-social-comment-submit").prop("disabled",!1):this.$el.find("#esoc-social-comment-submit").prop("disabled",!0),this.triggerMethod("dom:refresh");var i=this._elements.csuiSocialCommentInput.val(),s=e||window.event,n=this.util.commonUtil.globalConstants.MAX_CHAR_LIMIT;if(i.length>n){var o=i.substr(0,n);this._elements.csuiSocialCommentInput[0].innerHTML=o,this._elements.csuiSocialCommentInputHiddenData.val(o),this.$el.find("#esoc-social-comment-header").html("")[0].textContent=o,this.util.commonUtil.addEmoji(this.$el.find("#esoc-social-comment-header"),!1,this.options.connector),this.$el.find("#esoc-social-comment-header").trigger("focus"),this.util.commonUtil.placeCaretAtEnd(this.$el.find("#esoc-social-comment-header")),s.preventDefault(),this.util.setCommentDialogPointer()}},"onCommentFormSubmit":function(e){e.stopPropagation(),e.preventDefault(),this._elements.csuiSocialCommentAttachmentIcon.binf_popover("hide");var i,s,n=this._elements.csuiSocialCommentInput.val().trim(),o=new FormData,a=this.$el.find("#esoc-social-comment-desktop-attachment"),l={};a.length>0&&(i=a[0].files[0]),this._elements.csuiSocialCommentShortcut.val().length>0&&(s=parseInt(this._elements.csuiSocialCommentShortcut.val(),10)),n.length&&(this.$el.find(".esoc-social-comment-form-mask").show(),this.$el.find("#esoc-social-comment-submit").html(d.posting),this.adjustCommentAreaWidth(e,!0),this.util.showMask(this.$el.find(".esoc-social-comment-form-mask")),this._elements.csuiSocialCommentInput.val(""),s?l.ATT_ID=s:i&&(l.AddDesktopDoc=i),l.status=n,l.eventtype=1,this.options.statusInfo&&this.options.statusInfo.getStatusUrl?l.in_reply_to_status_id=this.options.statusInfo.conversation_id:l.in_comment_on_obj_id=this.options.nodeID,t.each(l,function(e,t){o.append(t,e)}),new p({},{"connector":this.model.connector}).save({},{"wait":!0,"data":o,"jsonFormData":l,"currentNodeModel":this.model.currentNodeModel,"success":this.onCommentSubmitSuccess.bind(this),"error":this.onCommentSubmitFailure.bind(this,a)})),void 0===n||""===n?this.$el.find("#esoc-social-comment-header").trigger("focus"):(this.util.resetAttachmentInput(a,this.options.socialActions),this._elements.csuiSocialCommentShortcut.val(""))},"removeMask":function(e){v.$el.find("#esoc-social-comment-submit").html(d.post),v.adjustCommentAreaWidth(e,!0),v.util.hideMask(v.$el.find(".esoc-social-comment-form-mask")),v.$el.find(".esoc-social-comment-form-mask").hide()},"onCommentSubmitFailure":function(e,t,i){this._elements.csuiSocialCommentShortcut.val(""),this.$el.find(".esoc-header-emoji").html(""),this.removeMask(),this.util.hideAttachmentPopup(this._elements.csuiSocialCommentAttachmentIcon,e,this.options.socialActions);i.responseJSON?i.responseJSON.errorDetail?i.responseJSON.errorDetail:i.responseJSON.error:d.defaultErrorMessageCommentSubmit},"onCommentSubmitSuccess":function(e,t){v.options.commentAction=!0;var i=t.commentCount;void 0===i&&(i=v.model.length+1),v.options.tablecellwidget&&v.util.commonUtil.updateCommentCount({"currentNodeModel":v.options.currentNodeModel,"commentCount":i}),v.$el.find(".esoc-header-emoji")[0].textContent="",v.removeMask(),v.onCommentFormBlur();var s=0;v.options.statusInfo&&v.options.statusInfo.getStatusUrl&&(s=1),v.util.resetAttachmentInput(v.$el.find("#esoc-social-comment-desktop-attachment"),v.options.socialActions),v._elements.csuiSocialCommentShortcut.val(""),v._elements.csuiSocialCommentAttachmentIcon.binf_popover("hide"),v.$el.find("#esoc-social-comment-input").text("").height("").trigger("blur"),v.$el.find("#esoc-social-comment-form-container").height(""),v.$el.find("#esoc-social-comment-warning").hide(),v.$el.find("#esoc-social-comment-container").scrollTop(0),v.$el.find(".esoc-header-emoji").html("").trigger("blur");var n=v.model;if(n.length>s){var o=n.at(s).id;delete n.defaults.params[v.util.commonUtil.globalConstants.MAX_ID],n.defaults.params[v.util.commonUtil.globalConstants.SINCE_ID]=o,n.fetch({"remove":!1,"at":s})}else 0===n.length&&delete n.defaults.params[v.util.commonUtil.globalConstants.MAX_ID],n.fetch({});v.$el.find(".comments-list").scrollTop(0),setTimeout(function(){v.$el.find("#esoc-social-comment-header").trigger("focus")},200),v.$el.find("#esoc-social-comment-submit").prop("disabled",!0),this.trigger("dom:refresh")},"onCloseButton":function(t){e("[id^='esoc-social-comment-widget-mask_']").removeAttr("tabindex"),e(".cs-expanded.activityfeed-expand.esoc.cs-dialog.binf-modal.binf-fade.binf-in").attr("tabindex","-1"),e(".esoc-user-widget-dialog.cs-dialog.binf-modal.binf-fade.binf-in").attr("tabindex","-1").prop("disabled",!1);var i=this.options.currentTarget;i&&(e(i).trigger("focus"),setTimeout(function(){e(i).trigger("focus")},1)),e(document).off("keyup"),this.util.commonUtil.unbindWidget(this.options),this.disengageModalKeyboardFocusOnClose(),e(".esoc-acitivityfeed-collection").css("overflow",""),e(document.body).hasClass("binf-modal-open")&&e(document.body).hasClass("binf-comment-dialog-open")?(e(document.body).removeClass("binf-modal-open"),e(document.body).removeClass("binf-comment-dialog-open")):e(document.body).hasClass("binf-comment-dialog-open")?e(document.body).removeClass("binf-comment-dialog-open"):e(document.body).addClass("binf-modal-open")},"onEmojiPress":function(t){var i=this._elements.csuiSocialCommentDiv;this.util.hidePopover(i);var s=function(e){return e.is(":visible")?e.offset():{"top":0,"left":0}},n=s(e(this.options.baseElement)),o=s(i);parseInt(n.top-o.top,10)<150&&(e(".esoc-social-comment-dialog-att-minheight").removeClass("esoc-social-comment-dialog-att-minheight"),e(".esoc-social-comment-widget").addClass("esoc-social-comment-dialog-minheight"),this.util.setCommentDialogPointer()),t.stopPropagation()},"onAttachementPress":function(t){this.$el.find(".emoji-menu").hide(),e(".esoc-social-comment-widget").removeClass("esoc-social-comment-dialog-minheight"),this.util.setCommentDialogPointer()},"applyReplyEmoji":function(t){this.$el.find(".emoji-wysiwyg-editor").remove(),this.$el.find("#esoc-social-comment-input").emojiarea({"path":this.util.commonUtil.getEmojiPath(this.options.connector),"wysiwyg":!0,"button":".esoc-social-comment-header-emotion","id":"esoc-social-comment-header","parent":this.$el.find("#esoc-social-textinput-button-holder"),"util":this.util,"widget":e(".esoc-social-comment-widget")}),this.$el.find(".emoji-wysiwyg-editor").addClass("esoc-header-emoji").attr({"id":"esoc-social-comment-header","data-text":this.templateHelpers().messages.writeAComment}),this.listenToOnce(this.model,"sync",function(){var e={"context":this.options.context,"connector":this.options.connector,"element":this.$el.find("#esoc-social-comment-header"),"appendToElement":this.$el.find("#esoc-suggestion-comment-header")};this.util.triggerAutoCompleteSuggestion(e),this.$el.find(".emoji-wysiwyg-editor").removeAttr("autocomplete")})},"onCommentEmojiKeypress":function(e){this.util.onMentionNameEdit(e)},"onCommentEmojiMentionMouseDown":function(e){this.util.setCursorPositionAtStartOFMention(e)}});return c.mixin(b.prototype),b}),csui.define("css!esoc/widgets/socialactions/socialactions",[],function(){}),csui.define("esoc/widgets/socialactions/commentscollectionwidget",["csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/lib/jquery","csui/utils/connector","i18n!esoc/widgets/socialactions/nls/lang","esoc/widgets/socialactions/commentscollection.model","esoc/widgets/socialactions/socialactions.model","esoc/widgets/socialactions/commentscollection.view","esoc/widgets/socialactions/commentsheader.view","esoc/widgets/socialactions/util","esoc/widgets/common/util","csui/utils/contexts/factories/connector","esoc/lib/jquery-ui","css!esoc/widgets/socialactions/socialactions.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m){function p(e){s(document).on("keyup",{"callbackFun":d.commonUtil.unbindWidget,"dialogOptions":e,"util":d},d.closeCommentDialog);var t;if(e=e||{},e.CSID=e.nodeID=e.baseElement.dataset?e.baseElement.dataset.value:s(e.baseElement).attr("data-value"),""===e.CSID){var n=d.createRemoteObject(e);if(""!==n.error)return s(e.baseElement).parent().parent().find(".esoc-error-socialactions").length>0?(s(e.baseElement).parent().parent().find(".esoc-error-socialactions").show(),s(e.baseElement).parent().parent().find(".binf-panel-title").html(n.error),s(e.baseElement).hide()):s(e.baseElement).text(n.error),void(this.show=function(){});e.CSID=e.nodeID=t=n.csid,s(e.baseElement).attr("data-value",t)}else parseInt(e.CSID,10)>0?e.statusInfo={}:t=e.CSID;var o=e.socialActionsInstanse&&e.socialActionsInstanse.options.model.id?e.CSID+"_"+e.socialActionsInstanse.options.model.id:e.CSID,p="#esoc-social-comment-widget_"+o,h="#esoc-social-comment-widget-pointer_"+o,f="#esoc-social-comment-widget-mask_"+o;if(s(p).is(":visible"))s(p).remove(),s(h).remove(),s(f).remove(),this.show=function(){};else{var g,v,b;document.getElementById("esoc-social-comment-widget_"+o)?(g=document.getElementById("esoc-social-comment-widget_"+o),v=document.getElementById("esoc-social-comment-widget-pointer_"+o),b=document.getElementById("esoc-social-comment-widget-mask_"+o)):(p.indexOf("esoc-social-comment-widget")>0&&d.commonUtil.unbindWidget(this.options),g=document.createElement("div"),g.id="esoc-social-comment-widget_"+o,g.setAttribute("class","esoc-social-comment-widget esoc"),v=document.createElement("div"),v.id="esoc-social-comment-widget-pointer_"+o,b=document.createElement("div"),b.id="esoc-social-comment-widget-mask_"+o),s(document.body).hasClass("binf-modal-open")||s(document.body).addClass("binf-comment-dialog-open"),d.widgetDialog=g,d.widgetDialogPointer=v,d.widgetDialogMask=b,e.socialActionsInstanse&&e.socialActionsInstanse.model&&e.socialActionsInstanse.options.connector?e.connector=e.socialActionsInstanse.model.connector:e.connector=e.context.getObject(m),e.params={"page":1,"data_id":t},e.rockey=e.roid="",e.csid=t;var w=new l("",e);e.model=w,e.socialActionsInstanse&&(e.socialActions=e.socialActionsInstanse.model.attributes.socialactions),e.context||(e.context=e.socialActionsInstanse.options.context),d.widgetBaseElement=e.baseElement;var y=s(p);e.params={"page":1,"data_id":t};var x=new a(e);x.baseURL=e.connector.connection.url,x.nodeID=e.nodeID,x.socialActions=e.socialActions,e.maxMessageLength&&(x.maxMessageLength=e.maxMessageLength),e.model=x,this.show=function(){var t=s.fn.binf_modal.getDefaultContainer();s(t).append(b).append(g).append(v),s("[id^='esoc-social-comment-widget-mask_']").on("keydown click",{"callbackFun":d.commonUtil.unbindWidget,"dialogOptions":e},d.closeCommentDialog),s(window).on("popstate hashchange",{"callbackFun":d.commonUtil.unbindWidget,"dialogOptions":e},d.closeCommentDialog),this.initializeWidget(),u.createEmojiIcons()},this.initializeWidget=function(){var t=new i.Region({"el":p}),s=new c(e);t.show(s),e.originatingView=t.currentView;var n=new i.Region({"el":"#esoc-social-comment-container"}),o=new r({"context":x.context,"collection":x,"commentConfigOptions":e,"commentsHeaderView":s,"sort":!0});n.show(o),x.fetch({"success":function(){s.trigger("collection:sync:callback")},"error":x.fetchError}),y.css({"display":"block"}),y.animate({"opacity":1})},this.getConfig=function(){return e}}}return p}),csui.define("css!esoc/widgets/tablecell/impl/social",[],function(){}),csui.define("esoc/widgets/activityfeedwidget/activityfeeditem.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/moment","csui/lib/handlebars","csui/utils/contexts/factories/connector","hbs!esoc/widgets/activityfeedwidget/activityfeed","hbs!esoc/widgets/activityfeedwidget/activityfeedstandard","hbs!esoc/widgets/activityfeedwidget/impl/activityfeedheader","esoc/widgets/socialactions/commentscollectionwidget","esoc/widgets/userwidget/userwidget","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","esoc/widgets/common/util","esoc/widgets/userwidget/util","csui/utils/log","csui/utils/url","csui/utils/nodesprites","csui/utils/node.links/node.links","csui/utils/namedsessionstorage","csui/lib/handlebars.helpers.xif","css!esoc/widgets/tablecell/impl/social.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v,b,w,y){return n.ItemView.extend({"regions":{"tableRegion":"#tableview"},"momentJS":o,"commonUtil":h,"log":g,"namedSessionStorage":new y(h.globalConstants.ESOCIAL_USER_INFO),"className":function(){return this.options.strdViewOptions?"esoc-activityfeed-list-item binf-row object-group-item":"esoc-activityfeed-list-item binf-row object-group-item esoc-activityfeed-expanded-view"},"template":r,"templateHelpers":function(){var e,i,s,n="csui-icon mime_document",o="",a="",l="",r=this.model,c=this.options.defaultActionController?this.options.defaultActionController:this.options.parentCollectionView.defaultActionController;try{""===this.model.attributes.extended_info.display_icon_id?n="":(s=1===this.model.attributes.extended_info.subtype,r.attributes.type=s?this.model.attributes.extended_info.sgm_original_sub_type:this.model.attributes.extended_info.subtype,r.attributes.mime_type=s?this.model.attributes.extended_info.sgm_original_mime_type:this.model.attributes.extended_info.mime_type,r.attributes.container=s?this.model.attributes.extended_info.sgm_original_container:this.model.attributes.extended_info.sgm_container,n=b.findClassByNode(r),this.sgmModel=this.commonUtil.buildNodeModel(r,r.connector),i=w.getUrl(this.sgmModel),c&&(c.hasAction(this.sgmModel)||(a="esoc-social-activityfeeditem-inactive"))),""!==this.model.attributes.extended_info.attachment_subtype&&(o="csui-icon mime_document",e=this.model.attributes.extended_info.attachment_subtype,r.attributes.type=1===e?this.model.attributes.extended_info.attachment_original_sub_type:e,r.attributes.mime_type=1===e?this.model.attributes.extended_info.attachment_original_mime_type:this.model.attributes.extended_info.attachment_mime_type,r.attributes.container=1===e?this.model.attributes.extended_info.attachment_original_container:this.model.attributes.extended_info.attachment_container,o=b.findClassByNode(r),this.attachmentModel=this.commonUtil.buildNodeModel(r,r.connector,!0),c&&(c.hasAction(this.attachmentModel)||(l="esoc-social-activityfeeditem-inactive")))}catch(e){this.log.error(e)}var d={"commentLabel":p.commentLabel,"modifiedAt":p.modifiedAt,"shortcutAttachmentSubtype":this.commonUtil.globalConstants.SHORTCUT_ATTACHMENT_SUBTYPE,"documentAttachmentSubtype":this.commonUtil.globalConstants.DOCUMENT_ATTACHMENT_SUBTYPE,"mimeTypeClass":n,"attachmentMimeTypeClass":o,"inactiveClass":a,"attachmentInactiveClass":l,"more":p.more,"less":p.less,"comments":p.comments,"statusfeed":p.statusfeed,"userProfileLink":p.userProfileLink,"defaultActionUrl":i};return 4===this.model.attributes.feed_event_type&&(d.actionType=""!==this.model.attributes.extended_info.name&&this.model.attributes.extended_info.conversation_id===this.model.attributes.id?p.commentMsg:p.replyMsg),2===this.model.attributes.feed_event_type&&(d.actionType=p.commentMsg),7===this.model.attributes.feed_event_type&&(d.textmsg=p.addMsg),8===this.model.attributes.feed_event_type&&(d.textmsg=p.versionMsg),d.enableComments=void 0===this.model.collection.enableComments||this.model.collection.enableComments,d.status=p.status,d.version=p.version,d.isFirstItem=this.model.collection.at(0).cid!==this.model.cid,{"uniqueId":t.uniqueId(),"messages":d}},"events":{"click .esoc-socialactions-getcomments .esoc-social-comment-container":"getComments","click .esoc-object-name, .esoc-social-mime-icon":"openItem",
"click .esoc-social-attachment-name, .esoc-social-attachment-icon":"openAttachment","click .esoc-see-more-activity":"showMoreContent","click .esoc-see-less-activity":"showLessContent"},"_elements":{},"constructor":function(e){e=e||{},this.options=e,this.isHeaderView=!!e.strdViewOptions&&!!e.strdViewOptions.headerView,n.ItemView.prototype.constructor.apply(this,arguments),this.options.connector=this.options.connector||this.options.context.getObject(l),this.isHeaderView?(e.model.attributes.showCommentIcon=e.strdViewOptions.showCommentIcon,this.template=d):e.strdViewOptions?(e.model.attributes.showCommentIcon=e.strdViewOptions.showCommentIcon,this.template=c):this.template=r,this.listenTo(this.model,"change",this.render),this.on("commentdialog:action",function(e){this.trigger("childview:comment:action")}),this.on("start:notification",function(e){this.trigger("childview:start:notification")})},"openItem":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("click:item",this)},"openAttachment":function(){this.trigger("click:attachment",this)},"onRender":function(i){var s,n;this.model.attributes.user.id;if(m||(m=e("esoc/widgets/userwidget/userwidget")),void 0!==this.model.attributes.user&&void 0!==this.model.attributes.user.id){n={"userid":this.model.attributes.user.id,"context":this.options.context,"showUserProfileLink":!0,"showMiniProfile":!0},s=t.extend({"placeholder":this.$el.find(".esoc-user-widget")},n),m.getUser(s);var o=t.extend({"placeholder":this.$el.find(".esoc-profileimg-block"),"userWidgetWrapperClass":"esoc-activityfeed-userprofile-pic","showUserWidgetFor":"profilepic"},n);m.getUser(o)}if(2===this.model.attributes.feed_event_type&&""!==this.model.attributes.in_reply_to_user_id){var a=t.extend({},s);a.userid=this.model.attributes.in_reply_to_user_id,a.placeholder=this.$el.find(".esoc-reply-user-widget"),m.getUser(a)}var l=this.options.context;f.displayUserWidget(l,this.$el)},"onShow":function(s){if(0===this.options.index?(this.$el.find("a").prop("tabindex","-1").attr("data-cstabindex","-1"),this.$el.find(".esoc-profileimg-block a").prop("tabindex","0").attr("data-cstabindex","0")):this.$el.find("a").prop("tabindex","-1").attr("data-cstabindex","-1"),1===this.model.attributes.feed_event_type&&this.$el.find(".esoc-commentinfo-block").addClass("esoc-commentinfo-status"),-1!==i.inArray(this.model.attributes.feed_event_type,[7,8,9])){if(this.$el.find(".esoc-commentinfo-block").addClass("esoc-commentinfo-sgm"),this.$el.find(".esoc-social-comment-data").css("white-space","inherit"),this.$el.find(".esoc-description").length>0){var n=this.$el.find(".esoc-description").html();n=this.commonUtil.onClickableUrl(n,!0),this.$el.find(".esoc-description").html(n)}}else this.commonUtil.addEmoji(this.$el.find(".esoc-social-comment-data"),!0,this.options.connector);if(9===this.model.attributes.feed_event_type){var o=this.commonUtil.onClickableUrl(this.model.attributes.text,!0);o=1===this.model.attributes.extended_info.subtype?o.replace("[MimeType]","<span class='csui-icon-group esoc-social-mime-icon'><span class='"+this.templateHelpers().messages.mimeTypeClass+"'></span><span class='csui-icon csui-icon-shortcut-overlay'></span></span></span>"):o.replace("[MimeType]","<span class='"+this.templateHelpers().messages.mimeTypeClass+" esoc-social-mime-icon'></span>"),this.$el.find(".esoc-social-comment-data").html(o),this.$el.find(".esoc-social-comment-data").addClass("esoc-social-sgm-attr-change"),this.$el.find(".esoc-object-name").attr("title",this.model.attributes.extended_info.name),this.$el.find(".esoc-social-mime-icon").attr("title",this.model.attributes.extended_info.name),this.$el.find(".esoc-object-name").addClass(this.templateHelpers().messages.inactiveClass),this.$el.find(".esoc-social-mime-icon").addClass(this.templateHelpers().messages.inactiveClass)}m||(m=e("esoc/widgets/userwidget/userwidget"));var a=this.options.context;if(this.$el.find(".esoc-old-user-display-name").each(function(){var e={"userid":i(this).data("userid"),"context":a,"placeholder":this,"showUserProfileLink":!0,"showMiniProfile":!0};m.getUser(e)}),this.$el.find(".esoc-new-user-display-name").each(function(){var e={"userid":i(this).data("userid"),"context":a,"placeholder":this,"showUserProfileLink":!0,"showMiniProfile":!0};m.getUser(e)}),f.displayUserWidget(a,this.$el),this.showSeeMoreLink(this.$el.find(this.contentTypeElement)),this.isHeaderView&&this.$el.find(".esoc-activityfeed-header").length>0&&this.$el.find(".esoc-activityfeed-header").each(t.bind(function(e){var t=i(this.$el.find(".esoc-activityfeed-actiontype")[e]).width()+(0===e?10:7);t="calc(100% - "+t+"px)",0===e?i(this.$el.find(".esoc-activityfeed-header .esoc-commentinfo-block .esoc-userwidget-wrapper")).css("max-width",t):i(this.$el.find(".esoc-activityfeed-header .esoc-comment-msg .esoc-userwidget-wrapper")).css("max-width",t)},this)),!this.isHeaderView&&this.$el.find(".esoc-reply-user-widget").length>0){var l=this.$el.find(".esoc-activityfeed-status-action").width()+10;l="calc(100% - "+l+"px)",i(this.$el.find(".esoc-reply-user-widget .esoc-userwidget-wrapper")).css("max-width",l)}},"showSeeMoreLink":function(e){if(i(e).length>0){var t=i(e).eq(0);i(t).addClass("esoc-see-more-content");var s=this;setTimeout(function(){s.commonUtil.isTextOverflown(t)&&(s.$el.find(".esoc-see-more").show(),i(t).addClass("esoc-see-more-activity"),i(t).find("a.esoc-see-more-activity").removeClass("esoc-hide-element"))},2e3)}},"contentTypeElement":".esoc-extended-view-mode","showMoreContent":function(e){""===window.getSelection().toString()&&(this.commonUtil.showMoreContent(e,this,this.$el.find(this.contentTypeElement)),this.$el.find(".esoc-extended-view-mode").trigger("focus"))},"showLessContent":function(e){""===window.getSelection().toString()&&this.commonUtil.showLessContent(e,this,this.$el.find(this.contentTypeElement))},"addFocus":function(e){i(".esoc-user-widget-dialog.cs-dialog.binf-modal.binf-fade.binf-in").removeAttr("tabindex").attr("disabled","true"),i("[id^='esoc-social-comment-widget-mask_']").attr("tabindex","-1")},"getComments":function(t){var s={"baseElement":t.target,"currentTarget":t.currentTarget,"socialActionsInstanse":this,"placeholder":this.model.collection.placeholder,"context":this.options.context,"maxMessageLength":this.options.model.attributes.maxMessageLength,"activityfeeditem":this};this.addFocus(t);var n,o=this;if(1!==this.model.attributes.feed_event_type&&2!==this.model.attributes.feed_event_type){var a=this.model.attributes.data_id,l=v.combine(this.options.connector.connection.url,this.commonUtil.REST_URLS.csGetROI)+"CSID="+a;i.ajax(this.options.connector.extendAjaxOptions({"type":"GET","async":!1,"cache":!1,"url":l,"success":function(e){n=JSON.parse(JSON.stringify(e.available_settings))},"error":function(){o.log.error("TEMP.  ERROR Getting available settings")}}))}else n={"attachementsEnabled":!0,"commentingOpen":!0,"commentsEnabled":!0,"CSID":0,"likesEnabled":!0,"shortcutsEnabled":!0,"taggingEnabled":!0,"threadingEnabled":!0};s.socialActionsInstanse.model.attributes.socialactions=n,s.statusInfo={},!this.model.attributes.feed_event_type||1!==this.model.attributes.feed_event_type&&2!==this.model.attributes.feed_event_type||(s.statusInfo={"getStatusUrl":this.model.attributes.actions.filter(function(e){return"reply"===e.signature})[0].href,"conversation_id":this.model.attributes.extended_info.conversation_id,"item_id":this.model.attributes.id}),clearInterval(this.model.collection.widgetOptions.expNotificationInterval),e(["esoc/widgets/socialactions/commentscollectionwidget"],function(e){new e(s).show(),i(document.activeElement).trigger("blur");var t=i("#esoc-social-comment-title").eq(0);i(t).trigger("focus"),document.activeElement=t,i(".esoc-acitivityfeed-collection").css("overflow","hidden")})}})}),csui.define("hbs!esoc/widgets/activityfeedwidget/impl/emptyactivityfeed",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="esoc-empty-activityfeed-message" title="'+this.escapeExpression((n=null!=(n=t.emptyActivityFeed||(null!=e?e.emptyActivityFeed:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"emptyActivityFeed","hash":{}}):n))+'"><p\r\n    class="esoc-empty-activityfeed-text">'+this.escapeExpression((n=null!=(n=t.emptyActivityFeed||(null!=e?e.emptyActivityFeed:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"emptyActivityFeed","hash":{}}):n))+"</p></div>"}});return i.registerPartial("esoc_widgets_activityfeedwidget_impl_emptyactivityfeed",s),s}),csui.define("css!esoc/widgets/activityfeedwidget/activityfeed",[],function(){}),csui.define("esoc/widgets/activityfeedwidget/emptyactivityfeed.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","hbs!esoc/widgets/activityfeedwidget/impl/emptyactivityfeed","css!esoc/widgets/activityfeedwidget/activityfeed.css"],function(e,t,i,s,n){return i.ItemView.extend({"className":"esoc-empty-activityfeed-wrapper","template":n,"templateHelpers":function(){return{"emptyActivityFeed":this.options&&this.options.parentCollectionView&&e.contains(["userwidget","metadata"],this.options.parentCollectionView.options.origin)?s.emptyactivityfeedforuserprofile:s.emptyactivityfeed}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("esoc/widgets/utils/adaptivepoll",["module"],function(e){return function(e,t,i){var s=this;this.init=function(s){this.timer=0,this.iterations=0,this.PERIOD_VISIBLE=i,this.IDLE_TIMEOUT=this.PERIOD_VISIBLE/1e3-1,this._localStorageKey=t,this._idleSecondsTimer=null,this._lastResetTimeStamp=(new Date).getTime(),this._localStorage=null,this.noActivity=!1,this.lastState=0,this.LAST_STATE_LIMIT=8,this._callback=e,this.AttachEvent(document,"click",this.ResetTime),this.AttachEvent(document,"mousemove",this.ResetTime),this.AttachEvent(document,"keypress",this.ResetTime),this.AttachEvent(window,"load",this.ResetTime),this.param1=s[3],this.param2=s[4];try{this._localStorage=window.localStorage}catch(e){}this._idleSecondsTimer=window.setInterval(this.CheckIdleTime,i),document.addEventListener&&document.addEventListener("visibilitychange",this.ResetTime)},this.GetLastResetTimeStamp=function(){var e=0;return s._localStorage?(e=parseInt(s._localStorage[s._localStorageKey],10),(isNaN(e)||e<0)&&(e=(new Date).getTime())):e=s._lastResetTimeStamp,e},this.SetLastResetTimeStamp=function(e){s._localStorage?s._localStorage[s._localStorageKey]=e:s._lastResetTimeStamp=e},this.ResetTime=function(){s.lastState>1&&setTimeout(s._callback,1e3,s.param1,s.param2),s.noActivity=!1,s.SetLastResetTimeStamp((new Date).getTime()),s.setUpdateTimer()},this.AttachEvent=function(e,t,i){return e.addEventListener?(e.addEventListener(t,i,!1),!0):!!e.attachEvent&&(e.attachEvent("on"+t,i),!0)},this.RemoveEvent=function(e,t,i){return e.addEventListener?(e.removeEventListener(t,i,!1),!0):!!e.attachEvent&&(e.attachEvent("off"+t,i),!0)},this.CheckIdleTime=function(){var e=(new Date).getTime(),t=s.GetLastResetTimeStamp(),i=Math.floor((e-t)/1e3);i<=0&&(s.ResetTime(),i=0),i>=s.IDLE_TIMEOUT&&(s.noActivity||(s.noActivity=!0,s.setUpdateTimer()))},this.setUpdateTimer=function(){return s.noActivity?(clearInterval(s.timer),s.lastState=Math.min(s.LAST_STATE_LIMIT,s.lastState+2),s.lastState===s.LAST_STATE_LIMIT?clearInterval(s.timer):s.timer=setInterval(s._callback,s.PERIOD_VISIBLE*s.lastState,s.param1,s.param2)):s.lastState>0&&(clearInterval(s.timer),s.timer=setInterval(s._callback,s.PERIOD_VISIBLE,s.param1,s.param2),s.lastState=0),s.timer},this.destroy=function(){clearInterval(s._idleSecondsTimer),clearInterval(s.timer),s.RemoveEvent(document,"click",this.ResetTime),s.RemoveEvent(document,"mousemove",this.ResetTime),s.RemoveEvent(document,"keypress",this.ResetTime),s.RemoveEvent(window,"load",this.ResetTime),document.removeEventListener("visibilitychange",s.ResetTime)},this.init(arguments)}}),csui.define("esoc/widgets/activityfeedwidget/activityfeed.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/connector","esoc/widgets/activityfeedwidget/activityfeeditem.view","esoc/widgets/activityfeedwidget/emptyactivityfeed.view","esoc/widgets/common/util","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","hbs!esoc/widgets/activityfeedwidget/impl/newupdates","esoc/widgets/utils/adaptivepoll"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p){var h=null;return n.CollectionView.extend({"tagName":"div","className":"activityfeed-list binf-container-fluid","childView":r,"emptyView":c,"log":o,"commonUtil":d,"feedtype":"","options":{},"childViewOptions":function(e,t){return{"context":this.options.context,"defaultActionController":this.defaultActionController,"parentCollectionView":this.options.parentCollectionView?this.options.parentCollectionView:this.options.activityfeed&&this.options.activityfeed.parentCollectionView,"index":t}},"setParentView":function(e){this.parentView=e},"initialize":function(t){h=this,this.listenTo(this.collection,"request",function(){this.$el.find(".esoc-empty-activityfeed-wrapper").hide()}).listenTo(this.collection,"sync",function(){this.$el.find(".esoc-empty-activityfeed-wrapper").show()}),this.childView||(this.childView=e("esoc/widgets/activityfeedwidget/activityfeeditem.view")),this.on("refresh:collection",function(e){if(e){var t=i.extend({},this.options);e.feedtype&&(t.feedtype=e.feedtype),e.updatesfrom&&(t.updatesfrom=e.updatesfrom),this.collection.fetch(i.extend({"error":this.collection.fetchError},t)),this.triggerMethod("update:notification")}})},"constructor":function(e){e.connector=e.connector?e.connector:e.context.getObject(l),n.CollectionView.prototype.constructor.apply(this,arguments)},"behaviors":{"DefaultAction":{"behaviorClass":a}},"childEvents":{"click:item":"onClickItem","click:attachment":"onClickAttachment","childview:comment:action":"onCommentdialogAction","childview:start:notification":"resumeNotification"},"events":{"click .esoc-social-activity-load-more":"loadMoreItems"},"onCommentdialogAction":function(){t(".esoc-activityfeed-expand-getnewupdates.esoc-activityfeed-expand-getnewupdates-"+this.collection.widgetOptions.activityfeed.widgetId).hide(),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+this.collection.widgetOptions.activityfeed.widgetId).hide(),t(".esoc-acitivityfeed-collection").scrollTop(0),t(".esoc-afw-object-view").has(".esoc-activityfeed-list-"+this.collection.widgetOptions.activityfeed.widgetId).scrollTop(0),this.collection.fetch(i.extend(this.collection.widgetOptions,{"remove":!0}));var e=this.collection.config_settings&&this.collection.config_settings.feedsAutoRefreshWait;this.updateGetNotification(e)},"resumeNotification":function(e){var t=this.collection.config_settings&&this.collection.config_settings.feedsAutoRefreshWait;this.updateGetNotification(t)},"onClickItem":function(e){var t={"node":e.sgmModel,"callingViewInstance":this};this.commonUtil.openItem(t)},"onClickAttachment":function(e){var t={"node":e.attachmentModel,"callingViewInstance":this};this.commonUtil.openItem(t)},"onShow":function(e){var i=this.options.collection.widgetOptions;void 0!==i.activityfeed&&(i=i.activityfeed);var s=i.wrapperClass;if(s&&s.trim().length>0){var n=this.$el.parent().parent();n.addClass(s);var o=this.$el.closest(".activityfeed-expand").find("."+s),a=t("."+s).css("background-color");n.css("background-color",a),this.$el.closest(".activityfeed-expand").find(".tile-content").css("background-color",a),o.find(".object-group-item").css("background-color",a),o.find(".tile-header").css("background-color",a),this.$el.closest(".activityfeed-expand").find(".binf-container-fluid").css("background-color",a),this.$el.closest(".activityfeed-expand").find(".binf-modal-body").css("background-color",a)}var l=this.options.collection.config_settings&&this.options.collection.config_settings.feedsAutoRefreshWait;if(l)this.updateGetNotification(l),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+i.widgetId)&&0!==l&&this.getExpandNewSinceId();else{var r=this;this.listenToOnce(this.options.collection,"sync",function(){l=r.options.collection.config_settings&&r.options.collection.config_settings.feedsAutoRefreshWait,r.updateGetNotification(l),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+i.widgetId)&&0!==l&&r.getExpandNewSinceId()})}},"onDestroy":function(){clearInterval(this.collection.widgetOptions.expNotificationInterval),this.adaptivepollObj&&this.adaptivepollObj.destroy()},"onUpdateNotification":function(){var e=this.collection.widgetOptions.activityfeed.widgetId;t(".esoc-activityfeed-expand-getnewupdates.esoc-activityfeed-expand-getnewupdates-"+e).hide(),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+e).hide();var i=this.collection.config_settings&&this.collection.config_settings.feedsAutoRefreshWait;i&&this.updateGetNotification(i)},"loadMoreItems":function(e){var t=this.collection.models[this.collection.models.length-1];if(!t.attributes.noMoreData){delete this.collection.defaults.params.since_id,this.collection.defaults.params.queryParams={},this.collection.defaults.params.queryParams.max_id=t.get("id");void 0!==this.options.context?this.options.context:this.options.activityfeed.context;this.collection.widgetOptions.remove&&(this.collection.widgetOptions.remove=!1),this.collection.fetch(i.extend({"remove":!1},this.collection.widgetOptions)),delete this.collection.defaults.params.queryParams.max_id}},"updateGetNotification":function(e){var i=this.collection.widgetOptions.activityfeed.widgetId;0===t(".esoc-activityfeed-expand-getnewupdates.esoc-activityfeed-expand-getnewupdates-"+i).length&&setTimeout(this.alignUpdateButton,1e3,this.$el,i),0!==e&&(clearInterval(this.collection.widgetOptions.expNotificationInterval),this.adaptivepollObj=this.adaptivepollObj||new p(this.getExpandLatestSinceId,"global_countdown_last_reset_timestamp",e,i,this),this.adaptivepollObj.lastState=1)},"alignUpdateButton":function(e,i){var s=t("<div />",{"class":"esoc-activityfeed-new-updates-wrapper","html":m({"messages":u,"newUpdatesWrapperClass":"esoc-activityfeed-expand-getnewupdates esoc-activityfeed-expand-getnewupdates-"+i})}),n=t("<div />",{"class":"activityfeed-expand-invisiblebutton-"+i});s.css({"position":"absolute","top":"15px","left":"50%","transform":"translate(-50%, -50%)"}),e.closest(".esoc-afw-newupdates").parent().append(s),e.append(n)},"getNewUpdates":function(e){var s=e.data,n=s.options.config_settings&&s.options.config_settings.feedsAutoRefreshWait||s.collection.config_settings&&s.collection.config_settings.feedsAutoRefreshWait;if(!t(e.target).hasClass("esoc-activityfeed-close")){delete s.collection.defaults.params.since_id,delete s.collection.defaults.params.max_id,s.collection.defaults.params.queryParams={};void 0!==s.options.context?s.options.context:s.options.activityfeed.context;t(".esoc-acitivityfeed-collection").scrollTop(0),s.collection.fetch(i.extend(s.options,{"remove":!0})),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+s.options.activityfeed.widgetId).trigger("click")}t(".esoc-activityfeed-expand-getnewupdates.esoc-activityfeed-expand-getnewupdates-"+s.options.activityfeed.widgetId).hide(),n&&s.updateGetNotification(n)},"getExpandNewSinceId":function(e){e=e&&e.data?e.data:h;var i=e.collection.models.length>0?e.collection.models[0].attributes.id:0,s=this.options.connector,n=e.options.hideHeader;e.feedtype=e.collection.widgetOptions.feedtype,e.updatesfrom=e.collection.widgetOptions.updatesfrom?e.collection.widgetOptions.updatesfrom:e.options.updatesfrom;var o="",a=e.collection.models.length>0?e.collection.models[0].attributes.widgetOptions:e.collection.widgetOptions;e.options=!1===t.isEmptyObject(a)?a:e.options;var l=void 0!==e.options.context?e.options.context:e.options.activityfeed.context,r=l._factories[e.collection.widgetOptions.activityfeed.widgetId];void 0!==r&&void 0!==r.options&&void 0!==r.options.honorfeedsource&&r.options.honorfeedsource&&void 0!==r&&void 0!==r.options&&void 0!==r.options.objectnodeid?o="&where_feedsource=pulsefrom&where_feedsource_id="+r.options.objectnodeid:void 0!==e.options.feedsource&&(void 0!==e.options.feedsource.source&&e.options.feedsource.source&&(o="&where_feedsource="+e.options.feedsource.source),void 0!==e.options.feedsource.id&&e.options.feedsource.id&&(o=o+"&where_feedsource_id="+e.options.feedsource.id)),void 0!==e.updatesfrom&&(void 0!==e.updatesfrom.from&&e.updatesfrom.from&&(o=o+"&where_updatesfrom="+e.updatesfrom.from),void 0!==e.updatesfrom.id&&e.updatesfrom.id&&(o=o+"&where_updatesfrom_id="+e.updatesfrom.id)),t.ajax(s.extendAjaxOptions({"url":s.connection.url+e.commonUtil.REST_URLS.csGetAFSinceId+e.feedtype+o,"type":"GET","success":function(s,o,a){if(void 0!==s.lastestIDReturned&&parseInt(s.lastestIDReturned,10)!==parseInt(i,10)){var l=t(".esoc-activityfeed-expand-getnewupdates.esoc-activityfeed-expand-getnewupdates-"+e.options.activityfeed.widgetId);t(l).addClass(n?"":"esoc-activityfeed-expand-getnewupdates-top").show(),t(l).on("focus",function(i){var s=t(i.target),n=e.parentView;s.is(":visible")&&n&&h.commonUtil.addTabableClass(n,s)}),t(l).length>0&&(clearInterval(e.collection.widgetOptions.expNotificationInterval),null!==e.adaptivepollObj&&(e.adaptivepollObj.destroy(),e.adaptivepollObj=null)),t(l).on("keydown",h,function(t){var i=t.keyCode||t.which;13!==i&&32!==i||e.getNewUpdates(t)}),t(l).one("click",e,e.getNewUpdates)}},"error":function(e,t,i){h.log.error("Error while retriving the latest since Id...")}}))},"getExpandLatestSinceId":function(e,i){t(".activityfeed-expand-invisiblebutton-"+e).length>0&&(i.getExpandNewSinceId(i),i.collection.widgetOptions.expNotificationInterval=i.adaptivepollObj&&i.adaptivepollObj.setUpdateTimer())}})}),csui.define("esoc/widgets/activityfeedwidget/util",["module","csui/lib/jquery","csui/lib/underscore","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/common/util"],function(e,t,i,s,n){return{"lang":s,"commonUtil":n}}),csui.define("hbs!esoc/widgets/activityfeedwidget/impl/activityfilter",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return" icon-checkbox-selected "},"3":function(e,t,i,s){return" icon-checkbox "},"5":function(e,t,i,s){var n;return'          <div class="csui-facet">\r\n            <a href="javascript:void(0);" class="esoc-activityfeed-filter-updatesfrom"\r\n               data-binf-toggle="collapse"\r\n               data-binf-target="#esoc-activityfeed-updatesfromfilter-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.widgetid:n,e))+'">\r\n              <div class="csui-facet-header">\r\n                <div class="header-label"\r\n                     title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.updatesfrom:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.updatesfrom:n,e))+'</div>\r\n                <div class="cs-icon csui-button-icon icon-expandArrowDown"></div>\r\n                <div class="cs-icon csui-button-icon icon-expandArrowUp"></div>\r\n                <div class="csui-right-shadow"></div>\r\n              </div>\r\n            </a>\r\n\r\n            <div id="esoc-activityfeed-updatesfromfilter-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.widgetid:n,e))+'"\r\n                 class="binf-in csui-facet-content esoc-activity-filter-content">\r\n              <div class="cs-filter-group">\r\n                <div class="csui-facet-item">\r\n                  <div class="esoc-activity-filter-selection-label">\r\n                    <input type="radio" name="updatesfrom" id="esoc_activityfeed_filter_allusers"\r\n                           class="esoc_activityfeed_filter"\r\n                           value="all" checked="'+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.all:n,e))+'">\r\n                    <span id="esoc_activityfeed_filter_allusers_radio"\r\n                          class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.all:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'"></span>\r\n                  </div>\r\n\r\n                  <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.allusers:n,e))+'">\r\n                      <label for="esoc_activityfeed_filter_allusers" class="csui-name">\r\n                          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.allusers:n,e))+'\r\n                      </label>\r\n                  </div>\r\n                </div>\r\n\r\n                <div class="csui-facet-item">\r\n                  <div class="esoc-activity-filter-selection-label">\r\n                    <input type="radio" name="updatesfrom"\r\n                           id="esoc_activityfeed_filter_iamfollowing"\r\n                           value="following"  checked="'+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.following:n,e))+'"\r\n                           class="esoc_activityfeed_filter">\r\n                    <span id="esoc_activityfeed_filter_iamfollowing_radio"\r\n                          class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.following:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'"></span>\r\n                  </div>\r\n\r\n                  <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.iamfollowing:n,e))+'">\r\n                      <label for="esoc_activityfeed_filter_iamfollowing" class="csui-name">\r\n                          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.iamfollowing:n,e))+'\r\n                      </label>\r\n                  </div>\r\n                </div>\r\n\r\n                <div class="csui-facet-item">\r\n                  <div class="esoc-activity-filter-selection-label">\r\n                    <input type="radio" name="updatesfrom" id="esoc_activityfeed_filter_myfollowers"\r\n                           class="esoc_activityfeed_filter"\r\n                           value="followers"  checked="'+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.followers:n,e))+'">\r\n                    <span id="esoc_activityfeed_filter_myfollowers_radio"\r\n                          class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.followers:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'"></span>\r\n                  </div>\r\n\r\n                  <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.myfollowers:n,e))+'">\r\n                      <label for="esoc_activityfeed_filter_myfollowers" class="csui-name">\r\n                          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.myfollowers:n,e))+'\r\n                      </label>\r\n                  </div>\r\n                </div>\r\n                <div class="csui-facet-item">\r\n                  <div class="esoc-activity-filter-selection-label">\r\n                    <input type="radio" name="updatesfrom" id="esoc_activityfeed_filter_myupdates"\r\n                           value="myupdates" checked="'+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.myupdates:n,e))+'"\r\n                           class="esoc_activityfeed_filter">\r\n                    <span id="esoc_activityfeed_filter_myupdates_radio"\r\n                          class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.myupdates:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'"></span>\r\n                  </div>\r\n\r\n                  <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.myupdates:n,e))+'">\r\n                      <label for="esoc_activityfeed_filter_myupdates" class="csui-name">\r\n                          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.myupdates:n,e))+'\r\n                      </label>\r\n                  </div>\r\n                </div>\r\n\r\n                <div class="csui-facet-item">\r\n                  <div class="esoc-activity-filter-selection-label">\r\n                    <input type="radio" name="updatesfrom" id="esoc_activityfeed_filter_mentions"\r\n                           value="mentions"\r\n                           class="esoc_activityfeed_filter"\r\n                           checked="'+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.mentions:n,e))+'">\r\n                    <span id="esoc_activityfeed_filter_mentions_radio"\r\n                          class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.mentions:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'"></span>\r\n                  </div>\r\n\r\n                  <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mentions:n,e))+'">\r\n                      <label for="esoc_activityfeed_filter_mentions" class="csui-name">\r\n                          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.mentions:n,e))+'\r\n                      </label>\r\n                  </div>\r\n                </div>\r\n\r\n                <div class="csui-facet-item">\r\n                  <div class="esoc-activity-filter-selection-label">\r\n                    <input type="radio" name="updatesfrom" id="esoc_activityfeed_filter_myfavorites"\r\n                           value="myfavorites"\r\n                           class="esoc_activityfeed_filter" '+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.myfavorites:n,e))+'>\r\n                    <span id="esoc_activityfeed_filter_myfavorites_radio"\r\n                          class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.from:n)?n.myfavorites:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'"></span>\r\n                  </div>\r\n\r\n                  <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.myfavorites:n,e))+'">\r\n                      <label for="esoc_activityfeed_filter_myfavorites" class="csui-name">\r\n                          '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.myfavorites:n,e))+"\r\n                      </label>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n            </div>\r\n          </div>\r\n"},"6":function(e,t,i,s){return" icon-radiobutton-selected "},"8":function(e,t,i,s){return" icon-radiobutton "},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n
;return'<div class="esoc-activityfeed-filter">\r\n  <div class="cs-simplelist csui-facet-panel">\r\n    <div class="cs-header binf-panel-heading">\r\n      <span class="cs-title">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.refineby:n,e))+'</span>\r\n\r\n      <div class="csui-right-shadow"></div>\r\n    </div>\r\n    <div class="esoc-activityfeed-filters cs-content">\r\n      <div class="cs-list-group">\r\n        <div class="csui-facet">\r\n          <a href="javascript:void(0);" class="esoc-activityfeed-filter-types"\r\n             data-binf-toggle="collapse"\r\n             data-binf-target="#esoc-activityfeed-filtertypes-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.widgetid:n,e))+'">\r\n            <div class="csui-facet-header">\r\n              <div class="header-label esoc-activityfeed-allfilter-label binf-hidden"\r\n                   title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.allselectedlabel:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.allselectedlabel:n,e))+'</div>\r\n              <div class="header-label esoc-activityfeed-filter-feedtypes binf-hidden"\r\n                   title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.activitytypes:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.activitytypes:n,e))+'</div>\r\n              <div class="cs-icon csui-button-icon icon-expandArrowDown"></div>\r\n              <div class="cs-icon csui-button-icon icon-expandArrowUp"></div>\r\n              <div class="csui-right-shadow"></div>\r\n            </div>\r\n          </a>\r\n\r\n          <div id="esoc-activityfeed-filtertypes-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.widgetid:n,e))+'"\r\n               class="binf-in csui-facet-content esoc-activity-filter-content">\r\n            <div class="cs-filter-group">\r\n              <div class="csui-facet-item">\r\n                <div class="esoc-activity-filter-selection-label">\r\n                  <input type="checkbox" name="feedtype" value="status"\r\n                         id="esoc_activityfeed_filter_status"\r\n                         class="esoc_activityfeed_filter" '+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.status:n,e))+' >\r\n                  <span id="esoc_activityfeed_filter_status_checkbox"\r\n                        class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.status:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'"></span>\r\n                </div>\r\n\r\n                <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.statusupdates:n,e))+'">\r\n                    <label for="esoc_activityfeed_filter_status" class="csui-name">\r\n                        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.statusupdates:n,e))+'\r\n                    </label>\r\n                </div>\r\n              </div>\r\n              <div class="csui-facet-item">\r\n                <div class="esoc-activity-filter-selection-label">\r\n                  <input type="checkbox" name="feedtype" value="content"\r\n                         id="esoc_activityfeed_filter_content"\r\n                         class="esoc_activityfeed_filter" '+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.content:n,e))+'>\r\n                  <span id="esoc_activityfeed_filter_content_checkbox"\r\n                        class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.content:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'"></span>\r\n                </div>\r\n\r\n                <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.contentupdates:n,e))+'">\r\n                    <label for="esoc_activityfeed_filter_content" class="csui-name">\r\n                        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.contentupdates:n,e))+'\r\n                    </label>\r\n                </div>\r\n              </div>\r\n              <div class="csui-facet-item">\r\n                <div class="esoc-activity-filter-selection-label">\r\n                  <input type="checkbox" name="feedtype" value="attribute"\r\n                         id="esoc_activityfeed_filter_attribute"\r\n                         class="esoc_activityfeed_filter" '+this.escapeExpression(this.lambda(null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.attribute:n,e))+'>\r\n                  <span id="esoc_activityfeed_filter_attribute_checkbox"\r\n                        class="'+(null!=(n=t.if.call(e,null!=(n=null!=(n=null!=e?e.messages:e)?n.fieldValue:n)?n.attribute:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'"></span>\r\n                </div>\r\n\r\n                <div class="csui-filter-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attributeupdates:n,e))+'">\r\n                    <label for="esoc_activityfeed_filter_attribute" class="csui-name">\r\n                        '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.attributeupdates:n,e))+"\r\n                    </label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.hideupdatesfrom:n,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(5,s,0)}))?n:"")+"      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("esoc_widgets_activityfeedwidget_impl_activityfilter",s),s}),csui.define("esoc/widgets/activityfeedwidget/activityfeedfilter.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/namedsessionstorage","csui/utils/contexts/factories/user","esoc/widgets/activityfeedwidget/util","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","hbs!esoc/widgets/activityfeedwidget/impl/activityfilter","csui/lib/perfect-scrollbar"],function(e,t,i,s,n,o,a,l,r){var c=null;return s.ItemView.extend({"className":"esoc-activity-filter-view","isAlreadyClicked":!1,"template":r,"namedSessionStorage":new n("esoc-activity-filterinfo"),"util":a,"templateHelpers":function(){return{"messages":{"fieldValue":this.fillFormFields(),"hideupdatesfrom":this.options.hideupdatesfrom,"contentupdates":l.contentupdates,"attributeupdates":l.attributeupdates,"statusupdates":l.statusupdates,"allusers":l.allusers,"iamfollowing":l.iamfollowing,"myfollowers":l.myfollowers,"myupdates":l.myupdates,"mentions":l.mentions,"myfavorites":l.myfavorites,"activitytypes":l.activitytypes,"refineby":l.refineby,"updatesfrom":l.updatesfrom,"allselectedlabel":l.allselectedlabel,"widgetid":this.options.widgetId||this.options.collection.widgetOptions.activityfeed.widgetId}}},"initialize":function(e){this.options=e,c=this},"constructor":function(e,t){e=e||{},s.ItemView.prototype.constructor.call(this,e),this.firstFilterIndex=0,this.lastFilterIndex=0,this.parentView=t},"onKeyInView":function(t,i){var s=t.keyCode,n=e(t.target);switch(s){case 32:case 13:n.prop("checked")?n.prop("checked",!1):n.prop("checked",!0),n.triggerHandler("click",!0);break;case 38:case 40:this.moveToNextFilter(this,38===s,n,i);break;default:return!0}return!1},"moveToNextFilter":function(e,t,i,s){s?this.processFilter(".csui-facet:first .csui-facet-item",t,"firstFilter"):this.processFilter(".csui-facet:last .csui-facet-item",t,"lastFilter")},"processFilter":function(t,i,s){var n=this.$el.find(t),o=n.length-1,l=s+"Index",r=s+"Element",c=e(n[this[l]]).find(".esoc_activityfeed_filter");this[l]=i?0===this[l]?o:--this[l]:this[l]===o?0:++this[l],this[r]=e(n[this[l]]).find(".esoc_activityfeed_filter"),this.parentView&&a.commonUtil.moveFocusFromSrcToDest(this.parentView,c,this[r],!0);var d=this[r].first();"radio"!==d.attr("type")&&d.trigger("focus")},"onAfterShow":function(){var e,t=this;t.$el.find(".esoc_activityfeed_filter").on("click",function(e,i){if(i)t.updateActivityFeed(e),t.isAlreadyClicked=!0;else{if(t.isAlreadyClicked)return t.isAlreadyClicked=!1,e.preventDefault(),e.stopPropagation(),!1;t.updateActivityFeed(e)}}),this.parentView&&(e=this.parentView,"userwidget"!==e.options.origin?(t.$el.find(".cs-filter-group:first .esoc_activityfeed_filter").on("keydown",function(e){t.onKeyInView(e,!0)}),t.$el.find(".cs-filter-group:last .esoc_activityfeed_filter").on("keydown",function(e){t.onKeyInView(e,!1)})):t.$el.find(".cs-filter-group .esoc_activityfeed_filter").on("keydown",function(e){t.onKeyInView(e,!0)})),this.$el.find(".esoc-activityfeed-filters").perfectScrollbar({"suppressScrollX":!0}),this.options.connector.authenticator.on("loggedOut",function(){t.namedSessionStorage.storage.removeItem("esoc-activity-filterinfo")})},"fillFormFields":function(){var t=(this.options.feedtype,{"status":"","content":"","attribute":""}),i={"all":"","following":"","followers":"","myupdates":"","mentions":"","myfavorites":""},s={},n={},o=c.options.widgetId||c.options.collection.widgetOptions.activityfeed.widgetId,a=c.options.filterSource?c.options.filterSource+"_"+o:o;return c.namedSessionStorage.get(a)?(s=c.namedSessionStorage.get(a),s.feedtype=s.feedtype,s.updatesfrom&&s.updatesfrom.from&&(s.updatesfrom=s.updatesfrom.from)):(s.feedtype=this.options.feedtype,c.options.updatesfrom&&c.options.updatesfrom.from&&(s.updatesfrom=c.options.updatesfrom.from)),i[s.updatesfrom]=!!s.updatesfrom,"all"===s.feedtype?e.each(t,function(e,t){n[e]="checked"}):s.feedtype&&(t="string"==typeof s.feedtype?s.feedtype.split(","):s.feedtype,t.forEach(function(e){n[e]="checked"})),n.from=i,n},"onShow":function(e){this.changeLabel()},"updateActivityFeed":function(i){if(this.parentView){var s=e(i.target);s.prop("tabindex","0").attr("data-cstabindex","0"),this.parentView.focusedElement=s}this.parentView.activityview.adaptivepollObj&&this.parentView.activityview.adaptivepollObj.destroy(),this.changeLabel(),this.util.commonUtil.updateSelection(i,this,"updatesfrom");var n={},a=0,l=[],r="";this.$el.find("input[type=checkbox]:checked").each(function(){l[a++]=e(this).val()}),this.$el.find("input[type=radio]").each(function(){e(this).is(":checked")&&(r=e(this).val())}),n=t.extend(n,{"feedtype":l}),this.user=this.options.context?this.options.context.getModel(o):void 0,r&&(n=-1!==e.inArray(r,["following","followers"])?t.extend(n,{"updatesfrom":{"from":r,"id":c.user&&c.user.get("id")?c.user.get("id"):0}}):t.extend(n,{"updatesfrom":{"from":r}}));var d=c.options.widgetId||c.options.collection.widgetOptions.activityfeed.widgetId,u=!1;this.namedSessionStorage.get(d)||(this.storeFilterInfo(n),u=!0),!0!==u&&this.namedSessionStorage.get(d).updatesfrom.from===r&&"feedtype"!==i.currentTarget.name||(u=!1,this.storeFilterInfo(n),this.trigger("select:filter",n))},"storeFilterInfo":function(e){if(!c.options.otherUser){var t=c.options.widgetId||c.options.collection.widgetOptions.activityfeed.widgetId,i=c.options.filterSource?c.options.filterSource+"_"+t:t;this.namedSessionStorage.set(i,e)}},"changeLabel":function(){var e=this.$el.find("input[name='feedtype']:checked").length;0===e||e===this.$el.find("input[name='feedtype']").length?(this.$el.find(".esoc-activityfeed-allfilter-label").removeClass("binf-hidden"),this.$el.find(".esoc-activityfeed-filter-feedtypes").addClass("binf-hidden")):(this.$el.find(".esoc-activityfeed-filter-feedtypes").removeClass("binf-hidden"),this.$el.find(".esoc-activityfeed-allfilter-label").addClass("binf-hidden"))}})}),csui.define("hbs!esoc/widgets/activityfeedwidget/impl/activityfeedwithfilter",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2 esoc-activityfeed-filter"></div>\r\n  <div\r\n      class="binf-col-lg-10 binf-col-md-10 binf-col-sm-10 binf-col-xs-10 esoc-acitivityfeed-collection\r\n      esoc-afw-newupdates esoc-acitivity-feed-filter-enabled"></div>\r\n'},"3":function(e,t,i,s){return'  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 esoc-acitivityfeed-collection esoc-afw-newupdates"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.enableFilters:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("esoc_widgets_activityfeedwidget_impl_activityfeedwithfilter",s),s}),csui.define("esoc/widgets/activityfeedwidget/activityfeedwithfilter.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","esoc/widgets/activityfeedwidget/activityfeedfactory","esoc/widgets/activityfeedwidget/activityfeed.view","esoc/widgets/activityfeedwidget/activityfeedfilter.view","esoc/widgets/activityfeedwidget/util","hbs!esoc/widgets/activityfeedwidget/impl/activityfeedwithfilter","csui/utils/contexts/factories/connector","csui/controls/progressblocker/blocker","csui/utils/namedsessionstorage","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabables.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g){var v=n.LayoutView.extend({"className":"esoc-activityfeed-with-filter","feedCount":0,"initialActivationWeight":0,"template":c,"namedSessionStorage":new m("esoc-activity-filterinfo"),"regions":{"filterRegion":".esoc-activityfeed-filter","feedRegion":".esoc-acitivityfeed-collection"},"templateHelpers":function(){return{"messages":{"enableFilters":this.options.feedSettings.enableFilters}}},"behaviors":{"PerfectScrolling":{"behaviorClass":p,"contentParent":".esoc-acitivityfeed-collection","suppressScrollX":!0},"TabableRegionBehavior":{"behaviorClass":f}},"onLastTabElement":function(e){var i=this.$("[data-cstabindex=0]").filter(":visible"),s=i.length-1;if(i.length){var n=e?i[0]:i[s];return t(n).hasClass(f.accessibilityActiveElementClass)}return!0},"currentlyFocusedElement":function(e){var i=this.focusedElement;return e&&e.shiftKey?i&&t(i).length?i:void 0:this.$el.find("a.esoc-activityfeed-filter-types")},"events":{"keydown":"onKeyInView"},"constructor":function(i){if(i||(i={}),i.connector=i.connector?i.connector:i.context.getObject(d),this.options=i,this.listenToOnce(this,"before:hide",h.popTabableHandler),this.propagateEventsToRegions(),!this.options.collection){r.commonUtil.fillDefaultActivityOptions(i),void 0!==this.options.feedtype&&(o.prototype.propertyPrefix=r.commonUtil.getActivityWidgetId(this.options),o.prototype.uniqueid=r.commonUtil.getActivityWidgetId(this.options));var s,c=this.options.filterSource?this.options.filterSource+"_"+o.prototype.uniqueid:o.prototype.uniqueid;s=this.namedSessionStorage.get(c),s&&(s.feedtype&&(this.options.feedtype=s.feedtype),s.updatesfrom&&(this.options.updatesfrom=s.updatesfrom)),"userwidget"===this.options.origin&&delete this.options.context._factories[r.commonUtil.getActivityWidgetId(this.options)],this.options.collection=this.options.context.getCollection(o,this.options)}var m=this;this.options.parentCollectionView=this,a||(a=e("esoc/widgets/activityfeedwidget/activityfeed.view")),this.activityview=new a(this.options,{"collection":this.options.collection}),this.activityview.setParentView(this),this.activityview.listenTo(this.options.collection,"sync",function(e,i){m.triggerMethod("dom:refresh"),m.$el.find("[data-cstabindex=0]").attr("tabindex","0"),m.focusedElement&&t(m.focusedElement).trigger("focus"),m.triggerMethod("update:scrollbar")}),this.options.feedSettings.enableFilters&&(this.filterview=new l(this.options,this),this.filterview.on("select:filter",function(e){m.$el.find(".esoc-acitivityfeed-collection").scrollTop(0),m.activityview.trigger("refresh:collection",e)})),n.LayoutView.prototype.constructor.apply(this,i),this.options.blockingParentView?u.delegate(this,this.options.blockingParentView):u.imbue(this),this.listenTo(this.options.collection,"request",this.blockActions).listenTo(this.options.collection,"sync",this.unblockActions).listenTo(this.options.collection,"error",this.unblockActions)},"onRender":function(){this.feedRegion.show(this.activityview),this.options.feedSettings.enableFilters&&this.filterRegion.show(this.filterview)},"onShow":function(e){this.options.userActivity&&this.onAfterShow(e)},"onAfterShow":function(e){if(this.$el.find(".csui-facet .esoc_activityfeed_filter").prop("tabindex","-1").attr("data-cstabindex","-1"),this.$el.find(".esoc-activityfeed-filter-types").prop("tabindex","0").attr("data-cstabindex","0"),this.$el.find("#esoc_activityfeed_filter_status").prop("tabindex","0").attr("data-cstabindex","0"),this.$el.find(".esoc-activityfeed-filter-updatesfrom").prop("tabindex","0").attr("data-cstabindex","0"),this.$el.find("input[type=radio][checked]").each(function(){t(this).prop("tabindex","0").attr("data-cstabindex","0")}),r.commonUtil.navigationWithArrowKeys(this,"div.activityfeed-list"),this.options.selectedTab){var i=this,s=t(".activityfeed-expand");s.length>0&&s.find(".cs-close").on("click",function(e){i.options.selectedTab===r.commonUtil.globalConstants.FRIENDS?t("#esoc-user-profile-following-tab").trigger("click"):i.options.selectedTab===r.commonUtil.globalConstants.FOLLOWERS&&t("#esoc-user-profile-followers-tab").trigger("click")})}this.options.feedSettings.enableFilters&&this.filterview.triggerMethod("after:show");var n=this,o=n.$el.find(".esoc-acitivityfeed-collection");o.on("scroll",function(e,t){var i=o.height(),s=o[0].scrollHeight;o.scrollTop()+30>=s-i&&o.find(".esoc-social-activity-load-more:last").trigger("click")})}});return i.extend(v.prototype,g),v}),csui.define("esoc/widgets/activityfeedwidget/afw.infinite.scrolling.behavior",["csui/controls/tile/behaviors/infinite.scrolling.behavior"],function(e){"use strict";return e.extend({"_checkScrollPositionFetch":function(){var e=this._content,t=e.height(),i=e[0].scrollHeight;e.scrollTop()+30>=i-t&&this._content.find(".esoc-social-activity-load-more:last").trigger("click")}})}),csui.define("hbs!esoc/widgets/activityfeedwidget/object/impl/object",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="esoc-activityfeed-list esoc-activityfeed-list-'+this.escapeExpression((n=null!=(n=t.feedtype||(null!=e?e.feedtype:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"feedtype","hash":{}}):n))+'">\r\n  <div class="object-group"></div>\r\n  <div class="tile-footer"></div>\r\n</div>'}});return i.registerPartial("esoc_widgets_activityfeedwidget_object_impl_object",s),s}),csui.define("css!esoc/widgets/activityfeedwidget/object/impl/object",[],function(){}),csui.define("esoc/widgets/activityfeedwidget/object/object.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/connector","esoc/widgets/common/util","esoc/widgets/activityfeedwidget/activityfeeditem.view","esoc/widgets/activityfeedwidget/emptyactivityfeed.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/tile/behaviors/blocking.behavior","esoc/widgets/activityfeedwidget/afw.infinite.scrolling.behavior","esoc/widgets/activityfeedwidget/util","csui/utils/contexts/factories/node","hbs!esoc/widgets/activityfeedwidget/object/impl/object","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","esoc/widgets/utils/adaptivepoll","css!esoc/widgets/activityfeedwidget/object/impl/object"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g){return i.CompositeView.extend({"className":"esoc-afw-object-view esoc-afw-newupdates  esoc","initialize":function(i){var s=this;this.options.connector=this.options.connector?this.options.connector:this.options.context.getObject(o),this.listenTo(this.collection,"request",function(){this.$el.find(".esoc-empty-activityfeed-wrapper").hide()}).listenTo(this.collection,"sync",function(){this.$el.find(".esoc-empty-activityfeed-wrapper").show(),this.triggerMethod("update:scrollbar")});var n=this.options.context?this.options.context.getObject(p):void 0;n&&(this._lastContainerId=n.get("id"),this.listenTo(this.options.context,"request",function(){this.handleContainerChange(n)}),this.listenTo(n,"change:id",function(){this.handleContainerChange(n)})),this.on("refresh:collection",function(i){if(i){var n=e.extend({},s.options);i.feedtype&&(n.feedtype=i.feedtype),i.updatesfrom&&(n.updatesfrom=i.updatesfrom),s.collection.fetch(n),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+n.collection.widgetOptions.activityfeed.widgetId).hide()}this.triggerMethod("update:notification")})},"log":s,"commonUtil":a,"template":h,"templateHelpers":function(){var e="";void 0!==this.options.wrapperClass&&(e=this.options.wrapperClass);return void 0!==this.options.feedtype&&this.options.feedtype,{"title":this.options.title||f.dialogTitle,"icon":this.options.titleBarIcon,"searchPlaceholder":f.searchPlaceholder,"wrapperClass":e,"feedtype":this.options.widgetId||this.options.collection.widgetOptions.activityfeed.widgetId,"feedOptions":this.options,"noActivityFeedMessage":f.noactivities}},"childViewContainer":".object-group","childView":l,"emptyView":r,"childViewOptions":function(e,t){return{"strdViewOptions":this.options,"context":this.options.context,"parentCollectionView":this,"index":t}},"events":{"click .esoc-social-activity-load-more":"loadMoreItems","click .esoc-activityfeed-invisiblebutton":"getNewSinceId"},"triggers":{"click .tile-header":"click:header"},"behaviors":{"Blocking":{"behaviorClass":d},"PerfectScrolling":{"behaviorClass":c,"suppressScrollX":!0},"InfiniteScrolling":{"behaviorClass":u},"DefaultAction":{"behaviorClass":n}},"childEvents":{"click:item":"onClickItem","click:attachment":"onClickAttachment","childview:comment:action":"onCommentdialogAction","childview:start:notification":"resumeNotification"},"onShow":function(){var e=this;this.options.headerView&&setTimeout(function(){e.triggerMethod("dom:refresh"),m.commonUtil.navigationWithArrowKeys(e,".object-group")},1e3);var t=this.collection.widgetOptions.config_settings&&this.collection.widgetOptions.config_settings.feedsAutoRefreshWait?this.collection.widgetOptions.config_settings.feedsAutoRefreshWait:void 0;t&&this.updateGetNotification(t),this.listenToOnce(this.collection,"sync",function(){t=t||this.collection.config_settings&&this.collection.config_settings.feedsAutoRefreshWait,setTimeout(function(){e.options.headerView||m.commonUtil.navigationWithArrowKeys(e,".object-group"),e.updateGetNotification(t)},500)})},"updateGetNotification":function(e){var i=this.collection.widgetOptions.activityfeed.widgetId;if(0===t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+i).length&&setTimeout(this.commonUtil.alignUpdateButton,1e3,i,!0),0!==e){clearInterval(this.collection.widgetOptions.notificationInterval);(void 0===this.collection.widgetOptions.getNewUpdates||this.collection.widgetOptions.getNewUpdates)&&(this.adaptivepollObj=this.adaptivepollObj||new g(this.getLatestSinceId,"global_countdown_last_reset_timestamp",e,i,this),this.adaptivepollObj.lastState=1)}},"isSameContainer":function(e){var t=e.get("id");return t===this._lastContainerId||(this._lastContainerId=t,!1)},"handleContainerChange":function(e){if(!this.isSameContainer(e)&&this.options&&void 0!==this.options.honorfeedsource&this.options.honorfeedsource){this.options.objectnodeid=e.get("id");var i=this.collection.widgetOptions.activityfeed.widgetId,s=this.options.context._factories[i];void 0!==s&&(s.options.objectnodeid=this.options.objectnodeid),this.collection.fetch(this.options),this.triggerMethod("update:notification");var n=t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+i);n.length>0&&n.hide()}},"getLatestSinceId":function(e,i){t(".esoc-activityfeed-list.esoc-activityfeed-list-"+e).find(".esoc-activityfeed-invisiblebutton").length>0&&(i.getNewSinceId(),i.collection.widgetOptions.notificationInterval=i.adaptivepollObj&&i.adaptivepollObj.setUpdateTimer())},"onUpdateNotification":function(){var e=this.collection.widgetOptions.activityfeed.widgetId;t(".esoc-activityfeed-expand-getnewupdates.esoc-activityfeed-expand-getnewupdates-"+e).hide(),t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+e).hide();var i=this.options.config_settings&&this.options.config_settings.feedsAutoRefreshWait||this.collection.config_settings&&this.collection.config_settings.feedsAutoRefreshWait;i&&this.updateGetNotification(i)},"onCommentdialogAction":function(){t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+this.collection.widgetOptions.activityfeed.widgetId).hide(),this.collection.fetch(e.extend(this.collection.widgetOptions,{"remove":!0}))},"resumeNotification":function(){var e=this.collection.config_settings&&this.collection.config_settings.feedsAutoRefreshWait;this.updateGetNotification(e)},"loadMoreItems":function(t){this.options=e.extend(this.options,{});var i=this.collection.models[this.collection.models.length-1];i.attributes.noMoreData||(delete this.collection.defaults.params.since_id,i.collection.defaults.params.queryParams={},this.collection.defaults.params.queryParams.max_id=i.get("id"),this.collection.fetch(e.extend({"remove":!1},this.collection.widgetOptions)),delete this.collection.defaults.params.queryParams.max_id)},"onClickItem":function(e){var t={"node":e.sgmModel,"callingViewInstance":this};this.commonUtil.openItem(t)},"onClickAttachment":function(e){var t={"node":e.attachmentModel,"callingViewInstance":this};this.commonUtil.openItem(t)},"onDestroy":function(){clearInterval(this.collection.widgetOptions.notificationInterval),this.adaptivepollObj&&this.adaptivepollObj.destroy()},"getNewSinceId":function(e){var i=this.collection.models.length>0?this.collection.models[0].attributes.id:0,s=this.options.connector,n=this.options.hideHeader,o=this,a="",l=void 0!==o.options.context?o.options.context:o.options.activityfeed.context,r=o.collection.widgetOptions.activityfeed.widgetId;o.feedtype=this.collection.widgetOptions.feedtype?this.collection.widgetOptions.feedtype:this.options.feedtype,o.updatesfrom=this.collection.widgetOptions.updatesfrom?this.collection.widgetOptions.updatesfrom:this.options.updatesfrom,o.widgetId=r;var c=l._factories[r];void 0!==c&&void 0!==c.options&&void 0!==c.options.honorfeedsource&&c.options.honorfeedsource&&void 0!==c.options.objectnodeid?(i=this.collection.models.length>0?this.collection.models[0].attributes.id:0,a="&where_feedsource=pulsefrom&where_feedsource_id="+c.options.objectnodeid):void 0!==this.options.feedsource&&(void 0!==this.options.feedsource.source&&this.options.feedsource.source&&(a="&where_feedsource="+this.options.feedsource.source),void 0!==this.options.feedsource.id&&this.options.feedsource.id&&(a=a+"&where_feedsource_id="+this.options.feedsource.id)),void 0!==o.updatesfrom&&(void 0!==o.updatesfrom.from&&o.updatesfrom.from&&(a=a+"&where_updatesfrom="+o.updatesfrom.from),void 0!==o.updatesfrom.id&&o.updatesfrom.id&&(a=a+"&where_updatesfrom_id="+o.updatesfrom.id)),t.ajax(s.extendAjaxOptions({"url":s.connection.url+this.commonUtil.REST_URLS.csGetAFSinceId+o.feedtype+a,"type":"GET","success":function(e,s,a){if(void 0!==e.lastestIDReturned&&parseInt(e.lastestIDReturned,10)!==parseInt(i,10)){var l=t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+o.widgetId);t(l).addClass(n?"":"esoc-activityfeed-getnewupdates-top").show(),t(l).one("click",o,o.getNewUpdates),t(l).on("keydown",o,function(e){var t=e.keyCode||e.which;13!==t&&32!==t||o.getNewUpdates(e)}),clearInterval(o.options.collection.widgetOptions.notificationInterval),null!==o.adaptivepollObj&&(o.adaptivepollObj.destroy(),o.adaptivepollObj=null)}},"error":function(e,t,i){o.log.error("Error while retriving the latest since Id...")}}))},"getNewUpdates":function(i){var s=i.data,n=s.options.widgetId||s.collection.widgetOptions.activityfeed.widgetId,o=s.options.config_settings&&s.options.config_settings.feedsAutoRefreshWait||s.collection.config_settings&&s.collection.config_settings.feedsAutoRefreshWait;if(!t(i.target).hasClass("esoc-activityfeed-close")){delete s.collection.defaults.params.since_id,delete s.collection.defaults.params.max_id,s.collection.defaults.params.queryParams={};void 0!==s.options.context?s.options.context:s.options.activityfeed.context;s.$el.scrollTop(0),s.collection.fetch(e.extend(s.collection.widgetOptions,{"remove":!0}))}t(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+n).hide(),t(".esoc-activityfeed-new-updates-wrapper").css("outline","none"),o&&s.updateGetNotification(o)}})}),csui.define("hbs!esoc/widgets/activityfeedwidget/impl/activityfeedcontent",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="binf-col-lg-2 binf-col-md-2 binf-col-sm-2 binf-col-xs-2 esoc-activityfeed-filter "></div>\r\n  <div\r\n      class="binf-col-lg-10 binf-col-md-10 binf-col-sm-10 binf-col-xs-10  eosc-acitivity-feed-content esoc-acitivity-feed-filter-enabled"></div>\r\n'},"3":function(e,t,i,s){return'  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 eosc-acitivity-feed-content"></div>\r\n'},"5":function(e,t,i,s){return'  <div class="tile-footer"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.enableFiltersForStandardView:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.hideExpandIcon:n,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(5,s,0)}))?n:"")}});return i.registerPartial("esoc_widgets_activityfeedwidget_impl_activityfeedcontent",s),s}),csui.define("esoc/widgets/activityfeedwidget/activityfeedcontent",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/controls/tile/behaviors/expanding.behavior","esoc/widgets/activityfeedwidget/activityfeedfactory","esoc/widgets/activityfeedwidget/activityfeed.view","esoc/widgets/activityfeedwidget/activityfeedwithfilter.view","csui/utils/contexts/page/page.context","esoc/widgets/activityfeedwidget/object/object.view","esoc/widgets/activityfeedwidget/activityfeedfilter.view","esoc/widgets/activityfeedwidget/util","hbs!esoc/widgets/activityfeedwidget/impl/activityfeedcontent","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","csui/controls/progressblocker/blocker","csui/utils/namedsessionstorage","css!esoc/widgets/activityfeedwidget/activityfeed.css","csui/controls/list/list.view","csui/controls/tile/tile.view"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v){function b(i){p.commonUtil.fillDefaultActivityOptions(i),void 0!==i.feedtype&&(l.prototype.propertyPrefix=p.commonUtil.getActivityWidgetId(i),l.prototype.uniqueid=p.commonUtil.getActivityWidgetId(i));var s=n.LayoutView.extend({"className":"esoc-activityfeed-contentwidget cs-list","template":h,"regions":{"listRegion":".eosc-acitivity-feed-content","filterRegion":".esoc-activityfeed-filter"},"namedSessionStorage":new v("esoc-activity-filterinfo"),"templateHelpers":function(){return{"messages":{"hideExpandIcon":this.options.hideExpandIcon,"enableFiltersForStandardView":this.options.enableFiltersForStandardView}}},"constructor":function(i){i||(i={}),this.options=i,n.LayoutView.prototype.constructor.apply(this,arguments);var s=this;void 0!==this.options.wrapperClass&&this.$el.addClass(this.options.wrapperClass)
;var o,a=i.filterSource?i.filterSource+"_"+l.prototype.uniqueid:l.prototype.uniqueid;o=this.namedSessionStorage.get(a),o&&(o.feedtype&&(i.feedtype=o.feedtype),o.updatesfrom&&(i.updatesfrom=o.updatesfrom)),"userwidget"===i.origin&&delete i.context._factories[l.prototype.uniqueid],this.collection=i.context.getCollection(l,i);var r=t.extend(i,{"collection":this.collection}),c=c||e("esoc/widgets/activityfeedwidget/object/object.view");this.listView=new c(r),this.options.enableFiltersForStandardView&&(this.activityFeedFilterView=new m(r),this.activityFeedFilterView.on("select:filter",function(e){s.listView.trigger("refresh:collection",e)})),this.options.blockingParentView?g.delegate(this,this.options.blockingParentView):g.imbue(this),this.listenTo(this,"dom:refresh",function(){p.commonUtil.navigationWithArrowKeys(this,".object-group")}),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"error",this.unblockActions)},"events":{"keydown .icon-tileExpand":"onTileExpandKeydown"},"behaviors":{"Expanding":{"behaviorClass":a,"expandedView":function(){return this.options.feedSettings&&this.options.feedSettings.enableFilters?c:r},"titleBarIcon":i.titleBarIcon||"title-activityfeed","dialogTitle":i.title||f.dialogTitle,"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"activityfeed-expand esoc","expandedViewOptions":t.extend(i,{"collection":this.collection})}},"onTileExpandKeydown":function(e){var t=e.keyCode||e.which;32!==t&&13!==t||this.triggerMethod("expand")},"onShow":function(){this.options.enableFiltersForStandardView&&(this.filterRegion.show(this.activityFeedFilterView),this.activityFeedFilterView.triggerMethod("after:show")),this.listRegion.show(this.listView),this.options.headerView&&this.listRegion.$el&&this.listRegion.$el.addClass("esoc-activityfeed-header-container"),this.$el.find(".icon-tileExpand").attr("tabindex","0").attr("data-cstabindex","0")}}),o=new s(i);this.contentView=o}return b}),csui.define("esoc/widgets/userwidget/model/miniprofilecard.model",["csui/lib/backbone","esoc/widgets/userwidget/util"],function(e,t){return e.Model.extend({"defaults":{"userid":"","display_name":"","business_email":"","title":"","className":"esoc-miniprofile-view","otherUser":"","following":"","otherUserProfile":""},"constructor":function(t){e.Model.prototype.constructor.apply(this,arguments)},"parse":function(e,t){return e.user.business_email=e.user.email,e.user.id=parseInt(e.user.id,10),e.user.display_name=e.user.name,e.user}})}),csui.define("esoc/widgets/userwidget/model/relations.model",["csui/lib/jquery","csui/lib/backbone","esoc/widgets/userwidget/model/miniprofilecard.model","esoc/widgets/userwidget/util","csui/utils/url","csui/utils/contexts/factories/user","esoc/widgets/userwidget/chat/chatfactory","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model","i18n!esoc/widgets/userwidget/nls/lang"],function(e,t,i,s,n,o,a,l,r){return t.Collection.extend({"getRelationsRESTUrl":"","util":s,"defaults":{"params":{"cursor":-1},"relationsRESTUrl":"","loggedUserId":"","relation":"","otherUserProfile":"","extendedmodel":""},"model":i,"constructor":function(e){var i=this.util.commonUtil.updateQueryStringValues(this.util.commonUtil.updateQueryStringValues(n.combine(this.util.commonUtil.REST_URLS.pulseRestUrl,e.userid),this.util.commonUtil.globalConstants.COUNT,this.util.commonUtil.globalConstants.PULSE_RESOURCE_COUNT),this.util.commonUtil.globalConstants.FIELDS,e.relation),s=this.util.commonUtil.globalConstants.FIELDS+"="+this.util.commonUtil.globalConstants.CHAT_SEETING;i=n.appendQuery(i,s),this.getRelationsRESTUrl=n.combine(this.util.commonUtil.getV2Url(e.connector.connection.url),i),this.relationsRESTUrl=this.getRelationsRESTUrl,this.defaults.loggedUserId=e.context.getModel(o)||e.loggedUserId,this.defaults.relation=e.relation,this.defaults.extendedmodel=e.userwidgetmodel,this.defaults.otherUserProfile=e.userwidgetmodel.attributes.otherUser,e&&e.connector&&e.connector.assignTo(this),t.Collection.prototype.constructor.apply(this,arguments)},"url":function(){return this.getRelationsRESTUrl},"parse":function(e){var t=e.results;this.defaults.extendedmodel.attributes.followers_count=t.followers_count,this.defaults.extendedmodel.attributes.friends_count=t.friends_count,this.defaults.extendedmodel.attributes.following=t.following;var i=t[this.defaults.relation];this.defaults.params.cursor=i.next_cursor;for(var s in i.users){var n=i.users[s].user,o=parseInt(n.id,10)===parseInt(this.defaults.loggedUserId,10);t.chatSettings&&(n.chatSettings=t.chatSettings);var a={"relation":this.defaults.relation,"selfUser":o,"otherUserProfile":this.defaults.otherUserProfile,"following":n.following};this.util.setRelationModel(n,a)}return JSON.parse(JSON.stringify(i.users))},"fetch":function(i){i&&i.params&&(i.params=e.extend(this.defaults.params,i.params),this.getRelationsRESTUrl=this.relationsRESTUrl+"&"+e.param(i.params)),t.Collection.prototype.fetch.apply(this,arguments)},"fetchSuccess":function(e,t,i){if(t.results.chatSettings.chatEnabled&&t.results.chatSettings.presenceEnabled){var s,n=[],o=[],r=[],c=Math.ceil(e.length/10);if(e.defaults.relation===e.util.commonUtil.globalConstants.FRIENDS?(s=t.results.friends.users,t.results.friends_count):e.defaults.relation===e.util.commonUtil.globalConstants.FOLLOWERS&&(s=t.results.followers.users,t.results.followers_count),s.length>0){for(var d in s)n[d]=s[d].user.screen_name+"@"+t.results.chatSettings.chatDomain,r[d]="esoc-mini-profile-presence-indicator-"+s[d].user.id,o[d]=e.models[10*(c-1)+parseInt(d,10)];var u={"presenceHolder":r,"email":n,"context":i.context,"models":o};l.isPluginEnabled()?a.getProvider().showUserPresence(u):a.getProvider().updateEventPresence(u)}}}})}),csui.define("hbs!esoc/widgets/userwidget/impl/relations",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.isFollowingTab:n,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:""},"2":function(e,t,i,s){return'      <div id="esoc-user-picker"\r\n           class="esoc-user-picker-holder binf-col-lg-4 binf-col-md-6 binf-col-sm-6 binf-col-xs-8"></div>\r\n'},"4":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.isFollowingTab:n,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:""},"5":function(e,t,i,s){var n;return'      <div\r\n          class="esoc-user-hide-element esoc-user-no-relations binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n        <div id="esoc-user-no-relations"\r\n             class="esoc-user-relations-list esoc-user-default-content">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followingListEmptyMessage:n,e))+"</div>\r\n      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="esoc-user-relations-container binf-col-lg-8 binf-col-md-8 binf-col-sm-8 binf-col-xs-8">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.otherUser:n,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(1,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.otherUser:n,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(4,s,0)}))?n:"")+'  <div id="esoc-user-relations-list"\r\n       class="esoc-user-relations-list binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"></div>\r\n</div>\r\n<div id="esoc-user-relations-activity-list"\r\n     class="esoc-user-relations-activity-list binf-col-lg-4 binf-col-md-4 binf-col-sm-4 binf-col-xs-4"></div>\r\n'}});return i.registerPartial("esoc_widgets_userwidget_impl_relations",s),s}),csui.define("esoc/widgets/userwidget/view/relations.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/user","esoc/widgets/userwidget/view/miniprofilecollection.view","esoc/widgets/activityfeedwidget/activityfeedcontent","esoc/widgets/userwidget/model/relations.model","esoc/widgets/userwidget/view/customuserpicker.view","hbs!esoc/widgets/userwidget/impl/relations","esoc/widgets/userwidget/util","esoc/widgets/userwidget/chat/chatutil","esoc/widgets/userwidget/chat/chatfactory","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/userwidget/chat/skype/skypeucwa.attribute.model"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f){var g=null;return n.ItemView.extend({"tagName":"div","className":"esoc-user-relation-tab","template":d,"miniProfileCollectionView":"","activityFeedView":"","activityFeedOptions":"","ActivityFeedWidgetView":"","templateHelpers":function(){return{"messages":{"isFollowingTab":this.options.selectedtab===u.commonUtil.globalConstants.FRIENDS,"followingListEmptyMessage":h.noFriendsMessage,"otherUser":this.options.userwidgetmodel.attributes.otherUser}}},"initialize":function(s){this.options=s,g=this;var n=u.commonUtil,l=s.selectedtab===n.globalConstants.FRIENDS?"following":n.globalConstants.FOLLOWERS;this.ActivityFeedContent=e("esoc/widgets/activityfeedwidget/activityfeedcontent"),s.relation=s.selectedtab===n.globalConstants.FRIENDS?n.globalConstants.FRIENDS:n.globalConstants.FOLLOWERS;var d=new r(s);this.activityFeedOptions={"context":s.context,"otherUser":s.userwidgetmodel.attributes.otherUser,"hideupdatesfrom":!0,"updatesfrom":{"from":l,"id":s.userwidgetmodel.attributes.userid},"feedSettings":{"enableFilters":!0},"filterSource":"userprofile","selectedTab":s.selectedtab,"origin":"userwidget"},d.fetch({"async":!1,"success":d.fetchSuccess,"context":s.context}),t(".esoc-userprofile-action-names a.esoc-userprofile-following-action").show().html(this.options.userwidgetmodel.attributes.following?h.unfollow:h.follow),t(".esoc-userprofile-action-names a.esoc-userprofile-following-action").attr("title",this.options.userwidgetmodel.attributes.following?h.unfollow:h.follow);var m=s.context?s.context.getModel(o):void 0,p=m&&m.get("id")?m.get("id"):s.loggedUserId;this.miniProfileCollectionView=new a({"collection":d,"loggedUserId":p,"relation":s.relation,"otherUserProfile":s.userwidgetmodel.attributes.otherUser,"context":s.context});var f=this.options.selectedtab===u.commonUtil.globalConstants.FRIENDS?this.options.userwidgetmodel.attributes.friends_count:this.options.userwidgetmodel.attributes.followers_count;u.changeRelationsCounts(this.options.userwidgetmodel.attributes),this.options.userwidgetmodel.attributes.relationCount=f,this.activityFeedView=new this.ActivityFeedContent(this.activityFeedOptions),this.listenTo(this.miniProfileCollectionView,"collectionview.show.user.dialog",function(e){g.trigger("relationsview.show.user.dialog",e)}),d.on("remove.relation",function(e,t){void 0!==g.activityFeedView.contentView.collection.widgetOptions.getNewUpdates&&delete g.activityFeedView.contentView.collection.widgetOptions.getNewUpdates;var s=void 0!==t.friends_count?t.friends_count:t.data.user.friends_count,n=void 0!==t.followers_count?t.followers_count:t.data.user.followers_count,o=g.activityFeedOptions.collection.widgetOptions.activityfeed.widgetId,a={"friends_count":s,"followers_count":n};u.changeRelationsCounts(a),(g.options.selectedtab===u.commonUtil.globalConstants.FRIENDS&&0===parseInt(s,10)||g.options.selectedtab===u.commonUtil.globalConstants.FOLLOWERS&&0===parseInt(n,10))&&(g.options.userwidgetmodel.attributes.followers_count=parseInt(n,10),g.options.userwidgetmodel.attributes.friends_count=parseInt(s,10),g.options.userwidgetmodel.attributes.relationCount=g.options.selectedtab===u.commonUtil.globalConstants.FRIENDS?g.options.userwidgetmodel.attributes.friends_count:g.options.userwidgetmodel.attributes.followers_count,g.options.selectedtab===u.commonUtil.globalConstants.FRIENDS&&(g.$el.find(".esoc-user-no-relations").show(),g.$el.find("#esoc-user-no-relations").show()),g.$el.find("#esoc-user-relations-list").hide(),g.$el.find("#esoc-user-relations-activity-list").hide(),g.activityFeedView.contentView.collection.widgetOptions=i.extend({"getNewUpdates":!1},g.activityFeedView.contentView.collection.widgetOptions),!g.options.userwidgetmodel.attributes.otherUser&&g.templateHelpers().messages.isFollowingTab&&g.$el.find(".esoc-user-no-relations").show()),g.$el.find(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+o).hide(),g.options.context._factories[o].fetch(g.activityFeedOptions)}),this.listenTo(d,"add.follower",this.onAddFollower),this.options.showActions=!0,this.pickerView=new c({"context":this.options.context,"limit":5,"memberFilter":{"type":[0]},"widgetoptions":this.options,"placeholder":h.userpickerplaceholder,"prettyScrolling":!0,"scrollContainerHeight":"auto"})},"constructor":function(e){e=e||{},n.ItemView.prototype.constructor.call(this,e)},"errorHandle":function(e,t){},"onShow":function(){void 0!==g.activityFeedView.contentView.collection.widgetOptions.getNewUpdates&&delete g.activityFeedView.contentView.collection.widgetOptions.getNewUpdates,g.showUserPicker();var e=new n.Region({"el":"#esoc-user-relations-list"}),t=new n.Region({"el":"#esoc-user-relations-activity-list"});if(e.show(this.miniProfileCollectionView),t.show(this.activityFeedView.contentView),0===this.options.userwidgetmodel.attributes.relationCount&&(g.activityFeedView.contentView.collection.widgetOptions=i.extend({"getNewUpdates":!1},g.activityFeedView.contentView.collection.widgetOptions),g.$el.find("#esoc-user-relations-list").hide(),g.$el.find("#esoc-user-relations-activity-list").hide(),!g.options.userwidgetmodel.attributes.otherUser&&g.templateHelpers().messages.isFollowingTab&&g.$el.find(".esoc-user-no-relations").show()),g.options.context._factories[g.activityFeedOptions.collection.widgetOptions.activityfeed.widgetId].fetch(g.activityFeedOptions).done(function(){g.trigger("view:shown")}),f.getPresenceEnabled()&&f.isPluginEnabled()){var s=g.miniProfileCollectionView.collection.length,o=g.miniProfileCollectionView.collection,a=[],l=[];if(s>0){for(var r=0;r<s;r++)a[r]=o.models[r].attributes.screen_name+"@"+o.models[r].attributes.chatSettings.chatDomain,l[r]="esoc-mini-profile-presence-indicator-"+o.models[r].attributes.id;var c={"presenceHolder":l,"email":a,"context":g.options.context};a.length>0&&l.length>0&&p.getProvider().showUserPresence(c)}}},"onAddFollower":function(e){var t=g.activityFeedOptions.collection.widgetOptions.activityfeed.widgetId;0===g.options.userwidgetmodel.attributes.relationCount&&(void 0!==g.activityFeedView.contentView.collection.widgetOptions.getNewUpdates&&delete g.activityFeedView.contentView.collection.widgetOptions.getNewUpdates,g.options.selectedtab===u.commonUtil.globalConstants.FRIENDS&&g.$el.find("#esoc-user-no-relations").hide(),g.$el.find("#esoc-user-relations-list").show(),g.$el.find("#esoc-user-relations-activity-list").show(),u.commonUtil.alignUpdateButton(t,!1),this.options.relation===u.commonUtil.globalConstants.FOLLOWERS&&(g.options.userwidgetmodel.attributes.relationCount=g.options.userwidgetmodel.attributes.followers_count),g.activityFeedView instanceof l||(g.activityFeedView=new this.ActivityFeedContent(g.activityFeedOptions))),g.$el.find(".esoc-activityfeed-getnewupdates.esoc-activityfeed-getnewupdates-"+t).hide(),g.options.context._factories[t].fetch(g.activityFeedOptions)},"showUserPicker":function(){if(!g.options.userwidgetmodel.attributes.otherUser&&g.options.relation===u.commonUtil.globalConstants.FRIENDS){new n.Region({"el":this.$el.find("#esoc-user-picker")}).show(this.pickerView),this.$el.find(".esoc-user-relations-list").addClass("esoc-user-relations-with-picker")}},"onDestroy":function(){g.activityFeedView.contentView.destroy()}})}),csui.define("hbs!esoc/widgets/userwidget/impl/settings",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"checked"},"3":function(e,t,i,s){return" icon-checkbox-selected "},"5":function(e,t,i,s){return" icon-checkbox "},"7":function(e,t,i,s){var n;return'    <div\r\n        class="esoc-setting-privacySettings csui-facet-panel binf-col-lg-6 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-setting-name">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacySettings:n,e))+'</div>\r\n      <span class="esoc-sub-setting-name">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyMyUpdatesTo:n,e))+'</span>\r\n\r\n      <div class="csui-facet-item">\r\n        <div class="esoc-settings-selection-label">\r\n          <input type="radio" name="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.CONTENT_PRIVACY:n,e))+'" value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'"\r\n                 id="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'" class="esoc_setting_edit_field"\r\n                 '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacyEveryOne:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' >\r\n          <span id="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'_radio"\r\n                class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacyEveryOne:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'"></span>\r\n        </div>\r\n\r\n        <div class="csui-filter-name">\r\n            <label for="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyEveryOne:n,e))+'">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyEveryOne:n,e))+'\r\n\t    </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="csui-facet-item">\r\n        <div class="esoc-settings-selection-label">\r\n          <input type="radio" name="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.CONTENT_PRIVACY:n,e))+'" value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'"\r\n                 id="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'" class="esoc_setting_edit_field"\r\n                 '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacyFollow:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' >\r\n          <span id="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'_radio"\r\n                class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacyFollow:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'"></span>\r\n        </div>\r\n\r\n        <div class="csui-filter-name">\r\n            <label for="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyFollow:n,e))+'">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyFollow:n,e))+'\r\n\t    </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="csui-facet-item">\r\n        <div class="esoc-settings-selection-label">\r\n          <input type="radio" name="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.CONTENT_PRIVACY:n,e))+'" value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'"\r\n                 id="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'" class="esoc_setting_edit_field"\r\n                 '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacyNone:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' >\r\n          <span id="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'_radio"\r\n                class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacyNone:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'"></span>\r\n        </div>\r\n\r\n        <div class="csui-filter-name">\r\n            <label for="esoc_privacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyNone:n,e))+'">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyNone:n,e))+"\r\n            </label>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n"},"8":function(e,t,i,s){return" icon-radiobutton-selected "},"10":function(e,t,i,s){return" icon-radiobutton "},"12":function(e,t,i,s){var n;return'    <div\r\n        class="esoc-setting-status-privacySettings csui-facet-panel binf-col-lg-6 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="esoc-setting-name">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacySettingsForStatusMessages:n,e))+'</div>\r\n      <span class="esoc-sub-setting-name">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyMyUpdatesTo:n,e))+'</span>\r\n\r\n      <div class="csui-facet-item">\r\n        <div class="esoc-settings-selection-label">\r\n          <input type="radio" name="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.STATUS_PRIVACY:n,e))+'" value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'"\r\n                 id="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'"\r\n                 class="esoc_setting_edit_field"\r\n                 '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacyEveryOne:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' >\r\n          <span id="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'_radio"\r\n                class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacyEveryOne:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'"></span>\r\n        </div>\r\n\r\n        <div class="csui-filter-name">\r\n            <label for="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.EVERYONE:n,e))+'" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyEveryOne:n,e))+'">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyEveryOne:n,e))+'\r\n            </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="csui-facet-item">\r\n        <div class="esoc-settings-selection-label">\r\n          <input type="radio" name="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.STATUS_PRIVACY:n,e))+'" value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'"\r\n                 id="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'" class="esoc_setting_edit_field"\r\n                 '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacyFollow:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' >\r\n          <span id="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'_radio"\r\n                class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacyFollow:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'"></span>\r\n        </div>\r\n\r\n        <div class="csui-filter-name">\r\n            <label for="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.FOLLOW:n,e))+'" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyFollow:n,e))+'">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyFollow:n,e))+'\r\n\t    </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="csui-facet-item">\r\n        <div class="esoc-settings-selection-label">\r\n          <input type="radio" name="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.STATUS_PRIVACY:n,e))+'" value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'"\r\n                 id="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'" class="esoc_setting_edit_field"\r\n                 '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacyNone:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+' >\r\n          <span id="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'_radio"\r\n                class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacyNone:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'"></span>\r\n        </div>\r\n\r\n        <div class="csui-filter-name">\r\n            <label for="esoc_statusPrivacySettings_'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.NONE:n,e))+'" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyNone:n,e))+'">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.privacyNone:n,e))+"\r\n            </label>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'\x3c!--This class(esoc_setting_edit_field) is used for click event, do not use it for styling --\x3e\r\n<div class="esoc-settings-tab-content binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n  <div class="esoc-setting-notification csui-facet-panel">\r\n    <div class="esoc-setting-name">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notification:n,e))+'</div>\r\n\r\n    <div class="csui-facet-item">\r\n      <div class="esoc-settings-selection-label">\r\n        <input type="checkbox" name="notification" value="notifyMentions"\r\n               id="esoc_setting_notifyMentions" class="esoc_setting_edit_field"\r\n               '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyMentions:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'>\r\n        <span id="esoc_setting_notifyMentions_checkbox"\r\n              class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyMentions:n,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'"></span>\r\n      </div>\r\n\r\n      <div class="csui-filter-name">\r\n          <label for="esoc_setting_notifyMentions" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyMentions:n,e))+'">\r\n              '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyMentions:n,e))+'\r\n\t  </label>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="csui-facet-item">\r\n      <div class="esoc-settings-selection-label">\r\n        <input type="checkbox" name="notification" value="notifyNewFollower"\r\n               id="esoc_setting_notifyNewFollower" class="esoc_setting_edit_field"\r\n               '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyNewFollower:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'>\r\n        <span id="esoc_setting_notifyNewFollower_checkbox"\r\n              class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyNewFollower:n,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'"></span>\r\n      </div>\r\n\r\n      <div class="csui-filter-name">\r\n          <label for="esoc_setting_notifyNewFollower" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyNewFollower:n,e))+'">\r\n              '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyNewFollower:n,e))+'\r\n\t  </label>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="csui-facet-item">\r\n      <div class="esoc-settings-selection-label">\r\n        <input type="checkbox" name="notification" value="notifyCommentsMyPosts"\r\n               id="esoc_setting_notifyCommentsMyPosts" class="esoc_setting_edit_field"\r\n               '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyCommentsMyPosts:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'>\r\n        <span id="esoc_setting_notifyCommentsMyPosts_checkbox"\r\n              class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyCommentsMyPosts:n,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'"></span>\r\n      </div>\r\n\r\n      <div class="csui-filter-name">\r\n          <label for="esoc_setting_notifyCommentsMyPosts" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyCommentsMyPosts:n,e))+'">\r\n              '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyCommentsMyPosts:n,e))+'\r\n\t  </label>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="csui-facet-item">\r\n      <div class="esoc-settings-selection-label">\r\n        <input type="checkbox" name="notification" value="notifyCommentsMyThreads"\r\n               id="esoc_setting_notifyCommentsMyThreads" class="esoc_setting_edit_field"\r\n               '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyCommentsMyThreads:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'>\r\n        <span id="esoc_setting_notifyCommentsMyThreads_checkbox"\r\n              class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyCommentsMyThreads:n,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'"></span>\r\n      </div>\r\n\r\n      <div class="csui-filter-name">\r\n          <label for="esoc_setting_notifyCommentsMyThreads" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyCommentsMyThreads:n,e))+'">\r\n              '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyCommentsMyThreads:n,e))+'\r\n\t  </label>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="csui-facet-item">\r\n      <div class="esoc-settings-selection-label">\r\n        <input type="checkbox" name="notification" value="notifyPrivateMessages"\r\n               id="esoc_setting_notifyPrivateMessages" class="esoc_setting_edit_field"\r\n               '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyPrivateMessages:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'>\r\n        <span id="esoc_setting_notifyPrivateMessages_checkbox"\r\n              class="'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.notifyPrivateMessages:n,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)
}))?n:"")+'"></span>\r\n      </div>\r\n\r\n      <div class="csui-filter-name">\r\n          <label for="esoc_setting_notifyPrivateMessages" class="csui-name" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyPrivateMessages:n,e))+'">\r\n              '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.notifyPrivateMessages:n,e))+"\r\n\t  </label>\r\n      </div>\r\n    </div>\r\n  </div>\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.contentPrivacy:n,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.settings:e)?n.statusPrivacy:n,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n"}});return i.registerPartial("esoc_widgets_userwidget_impl_settings",s),s}),csui.define("esoc/widgets/userwidget/model/settings.model",["csui/lib/backbone","csui/lib/jquery","csui/lib/underscore","csui/utils/url","esoc/widgets/userwidget/util"],function(e,t,i,s,n){return e.Model.extend({"connector":"","restUrl":"","constructor":function(t){this.options=t,this.restUrl=s.combine(n.commonUtil.getV2Url(t.connector.connection.url),n.commonUtil.REST_URLS.pulseRestUrl,t.userWidgetView.model.attributes.userid),this.restUrl=n.commonUtil.updateQueryStringValues(this.restUrl,n.commonUtil.globalConstants.FIELDS,n.commonUtil.globalConstants.SETTINGS),e.Model.prototype.constructor.apply(this,arguments),t&&t.connector&&t.connector.assignTo(this)},"url":function(){return this.restUrl},"fetch":function(){e.Model.prototype.fetch.apply(this,arguments)},"parse":function(e,i){var s=e.results,o=n.commonUtil.globalConstants.USER_PRIVACY_SETTINGS,a=["PrivacyEveryOne","PrivacyFollow","PrivacyNone"],l=a[t.inArray(s.settings.contentPrivacy,o)],r=a[t.inArray(s.settings.statusPrivacy,o)];return s.settings["content"+l]="on",s.settings["status"+r]="on",s}})}),csui.define("esoc/widgets/userwidget/view/settings.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","hbs!esoc/widgets/userwidget/impl/settings","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/userwidget/model/settings.model","esoc/widgets/userwidget/util","csui/controls/tile/behaviors/perfect.scrolling.behavior"],function(e,t,i,s,n,o,a,l,r,c){return s.ItemView.extend({"tagName":"div","className":"esoc-settings-tab","template":o,"util":r,"templateHelpers":function(){return{"messages":{"notification":a.notification,"notifyMentions":a.notifyMentions,"notifyNewFollower":a.notifyNewFollower,"notifyCommentsMyPosts":a.notifyCommentsMyPosts,"notifyCommentsMyThreads":a.notifyCommentsMyThreads,"notifyPrivateMessages":a.notifyPrivateMessages,"privacySettings":a.privacySettings,"privacySettingsForStatusMessages":a.privacySettingsForStatusMessages,"notifyMyUpdatesTo":a.notifyMyUpdatesTo,"privacyEveryOne":a.privacyEveryOne,"privacyFollow":a.privacyFollow,"privacyNone":a.privacyNone,"EVERYONE":r.commonUtil.globalConstants.USER_PRIVACY_SETTINGS[0],"FOLLOW":r.commonUtil.globalConstants.USER_PRIVACY_SETTINGS[1],"NONE":r.commonUtil.globalConstants.USER_PRIVACY_SETTINGS[2],"CONTENT_PRIVACY":r.commonUtil.globalConstants.CONTENT_PRIVACY,"STATUS_PRIVACY":r.commonUtil.globalConstants.STATUS_PRIVACY}}},"events":{"click .esoc_setting_edit_field ":"updateSetting"},"behaviors":{"PerfectScrolling":{"behaviorClass":c,"suppressScrollX":!0,"contentParent":".esoc-settings-tab-content","scrollYMarginOffset":15}},"initialize":function(e){this.options=e,this.editSettingUrl=n.combine(this.util.commonUtil.getV2Url(this.options.connector.connection.url),this.util.commonUtil.REST_URLS.pulseRestUrl,this.model.attributes.userid)},"constructor":function(e){e=e||{};var i=t.extend({},e);i.model=new l(i),i.model.fetch({"async":!1}),s.ItemView.prototype.constructor.call(this,i)},"onDomRefresh":function(){this.trigger("view:shown",this)},"errorHandle":function(e,t){},"updateSetting":function(t){var i=e(t.target).val(),s=e(t.target).attr("name"),n=new FormData;n.append(this.util.commonUtil.globalConstants.ACTION,this.util.commonUtil.globalConstants.UPDATE_SETTINGS_ACTION),s===this.util.commonUtil.globalConstants.CONTENT_PRIVACY||s===this.util.commonUtil.globalConstants.STATUS_PRIVACY?n.append(s,i):e(t.target).is(":checked")?n.append(i,"on"):n.append(i,"off");var o={"itemview":this,"url":this.editSettingUrl,"type":"POST","data":n,"requestType":"updateSettings","targetElement":e(t.target)};this.util.updateAjaxCall(o),e(t.target).prop("disabled",!0),this.util.commonUtil.updateSelection(t,this,s)}})}),csui.define("esoc/widgets/userwidget/model/view.simple.user.form",["csui/lib/underscore","csui/utils/url","csui/models/form","csui/lib/moment","csui/models/mixins/resource/resource.mixin","esoc/widgets/userwidget/util"],function(e,t,i,s,n,o){"use strict";var a=i.extend({"util":o,"constructor":function(e,t){i.prototype.constructor.apply(this,arguments),this.makeResource(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"url":function(){return t.combine(this.connector.connection.url,"forms","users",this.attributes.userId,"view")},"parse":function(e){return!!e.forms&&e.forms[0]}});return n.mixin(a.prototype),a}),csui.define("hbs!esoc/controls/form/view.simple.user.info/impl/view.simple.user.form",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="binf-row">\r\n  <div class="esoc-simple-user-widget-form binf-col-md-12 binf-col-sm-12\r\n  binf-col-lg-12\r\n  binf-col-xs-12">\r\n    <div id="metadata-pane-left-{{options.cid}}" class="cs-form-singlecolumn">\r\n      <div id="reportsToID-{{options.cid}}" class="esoc-simple-user-widget-manager"></div>\r\n      <div id="OfficeLocation-{{options.cid}}"\r\n           class="esoc-simple-user-widget-office-location"></div>\r\n      <div id="MailAddress-{{options.cid}}" class="esoc-simple-user-widget-email"></div>\r\n      <div id="Contact-{{options.cid}}" class="esoc-simple-user-widget-phone"></div>\r\n      <div id="CellularPhone-{{options.cid}}" class="esoc-simple-user-widget-mobile"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("esoc_controls_form_view.simple.user.info_impl_view.simple.user.form",s),s}),csui.define("esoc/controls/form/view.simple.user.info/view.simple.user.form",["csui/lib/underscore","csui/lib/jquery","csui/controls/form/form.view","esoc/widgets/userwidget/util","hbs!esoc/controls/form/view.simple.user.info/impl/view.simple.user.form"],function(e,t,i,s,n){"use strict";return i.extend({"className":"cs-form esoc-simple-user-widget-view-form","formTemplate":n,"util":s,"formTemplateHelpers":function(){return{"cid":this.model.cid}},"constructor":function(s){i.prototype.constructor.call(this,s),this.listenTo(this,"change:field",this._saveField),this.onWinResize=e.bind(this.windowResize,this),t(window).on("resize.app",this.onWinResize),this.originalHeight=0},"windowResize":function(){this.formHeight(),this.triggerMethod("dom:refresh")},"formHeight":function(){0===this.originalHeight&&(this.originalHeight=t(".esoc-simple-user-widget-body .tab-links > .esoc-simple-user-widget-form-body").length>0?t(".esoc-simple-user-widget-form-content").height()+52:t(".esoc-simple-user-widget-body").height()),t(".esoc-simple-user-widget-dialog .binf-modal-content").css("height",this.originalHeight+t(".esoc-simple-user-widget-header").height()+t(".esoc-simple-user-widget-dialog .esoc-simple-user-widget-footer").height()+2),t(".esoc-simple-user-widget-body").css("height",t(".esoc-simple-user-widget-dialog .binf-modal-content").height()-t(".esoc-simple-user-widget-header").height()-t(".esoc-simple-user-widget-dialog .esoc-simple-user-widget-footer").height()),t(".esoc-simple-user-widget-body .tab-links > .esoc-simple-user-widget-form-body").length>0&&t(".esoc-simple-user-widget-form-body").css("height",t(".esoc-simple-user-widget-body").height()-48),t(".esoc-simple-user-widget-dialog .esoc-simple-user-widget-footer").css("display","block"),this.options.orginatingView.triggerMethod("update:scrollbar")},"onRenderForm":function(){this.formHeight(),this.handleManagerAttributes(),this.options.orginatingView.trigger("view:shown")},"_getLayout":function(){return{"parent":"bootstrap-csui","layout":{"template":this.getOption("formTemplate").call(this,{"data":this.alpaca.data,"mode":this.mode}),"bindings":this._getBindings()}}},"_getBindings":function(){return{"reportsToID":e.str.sformat("reportsToID-{0}",this.model.cid),"OfficeLocation":e.str.sformat("OfficeLocation-{0}",this.model.cid),"MailAddress":e.str.sformat("MailAddress-{0}",this.model.cid),"Contact":e.str.sformat("Contact-{0}",this.model.cid),"CellularPhone":e.str.sformat("CellularPhone-{0}",this.model.cid)}},"_saveField":function(e){var t=new FormData,i=e.value?e.value:"",s=this.model.connector;if("reportsToID"==e.name){t.append(this.util.commonUtil.globalConstants.ACTION,this.util.commonUtil.globalConstants.UPDATE_EXTENDED_INFO),t.append("reportsTo",i);var n={"itemview":this,"url":this.util.commonUtil.getV2Url(s.connection.url)+this.util.commonUtil.REST_URLS.pulseRestUrl+e.model.attributes.userId,"type":"PUT","data":t,"connector":s}}else{switch(e.name){case"OfficeLocation":t.append("office_location",i);break;case"MailAddress":t.append("business_email",i);break;case"Contact":t.append("business_phone",i);break;case"CellularPhone":t.append("cell_phone",i)}var n={"itemview":this,"url":this.util.commonUtil.getV2Url(s.connection.url)+"/members/"+e.model.attributes.userId,"type":"PUT","data":t,"connector":s}}this.util.updateAjaxCall(n),this.handleManagerAttributes()},"handleManagerAttributes":function(){this.$el.find(".cs-field-read-inner button").attr("tabindex","0"),this.$el.find(".esoc-user-container").on("keypress",function(e){e.stopPropagation()})}})}),csui.define("hbs!esoc/widgets/userwidget/impl/simple.userwidget.form.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="esoc-simple-user-widget-form-view">\r\n  <div class="esoc-simple-user-widget-form-content"></div>\r\n</div>'}});return i.registerPartial("esoc_widgets_userwidget_impl_simple.userwidget.form.view",s),s}),csui.define("esoc/widgets/userwidget/view/simple.userwidget.form.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/handlebars","csui/lib/marionette","csui/controls/tile/behaviors/perfect.scrolling.behavior","esoc/widgets/userwidget/model/view.simple.user.form","esoc/controls/form/view.simple.user.info/view.simple.user.form","hbs!esoc/widgets/userwidget/impl/simple.userwidget.form.view","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r){return n.ItemView.extend({"className":"esoc-simple-user-widget-profile-view","template":r,"behaviors":{"PerfectScrolling":{"behaviorClass":o,"suppressScrollX":!0,"contentParent":".esoc-simple-user-widget-form-view","scrollYMarginOffset":15}},"constructor":function(e){e=e||{},n.ItemView.prototype.constructor.call(this,e);var t=new a({"userId":this.options.userwidgetmodel.attributes.id},{"connector":this.options.connector}),i=this;t.fetch().done(function(){i.formView=new l({"context":i.options.context,"orginatingView":i,"model":t}),i.render()})},"onRender":function(){if(this.formView){new n.Region({"el":this.$el.find(".esoc-simple-user-widget-form-content")}).show(this.formView)}}})}),csui.define("esoc/widgets/userwidget/userprofile",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/userwidget/view/general.view","esoc/widgets/userwidget/view/personal.view","esoc/widgets/userwidget/view/relations.view","esoc/widgets/userwidget/view/settings.view","esoc/widgets/activityfeedwidget/activityfeedwithfilter.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","esoc/widgets/userwidget/view/simple.userwidget.form.view","csui-ext!esoc/widgets/userprofile/tab.extension","esoc/widgets/common/util"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h){var f,g={"userProfileTabViewMapping":{"esoc-user-profile-general-tab":a,"esoc-user-profile-personal-tab":l,"esoc-user-profile-activity-tab":d,"esoc-user-profile-following-tab":r,"esoc-user-profile-followers-tab":r,"esoc-user-profile-settings-tab":c},"showTab":function(e,o,a,l){this.uniqueId=s.uniqueId();var r,c=new n.Region({"el":l.$el.find("#"+o)}),d=this;if("esoc-user-profile-following-tab"===e?a.selectedtab=h.globalConstants.FRIENDS:"esoc-user-profile-followers-tab"===e&&(a.selectedtab=h.globalConstants.FOLLOWERS),f&&i("esoc-simple-user-profile-tab-"+a.uniqueId).length>0&&f.destroy(),"esoc-user-profile-activity-tab"===e){var u=t("esoc/widgets/activityfeedwidget/activityfeedwithfilter.view");r={"context":a.context,"otherUser":a.model.attributes.otherUser,"hideupdatesfrom":!0,"hideExpandIcon":!0,"feedSettings":{"enableFilters":!0},"updatesfrom":{"from":"user","id":a.model.attributes.userid},"filterSource":"userprofile","userActivity":!0,"showCommentIcon":!0,"origin":"userwidget","userProfileView":l},f=new u(r)}else{var p=s.extend({},a);p.userwidgetmodel=a.model,delete p.model,this.userProfileTabViewMapping["esoc-simple-user-profile-tab-"+a.uniqueId]=m,f=new this.userProfileTabViewMapping[e](p)}f.on("relationsview.show.user.dialog",function(e){l.trigger("userprofileview.show.user.dialog",e)});var g="a[href],input[type!='radio'],input[type='radio']:checked,textarea,*[tabindex] *[data-cstabindex],button";l.on("view:shown",function(){var t=l.$el.find("img.esoc-full-profile-avatar-cursor");"#"!==t.attr("src")?t.attr("tabindex","0").attr("data-cstabindex","0"):l.$el.find("span.esoc-full-profile-avatar-cursor").attr("tabindex","0").attr("data-cstabindex","0"),l.setTabIndexForNonTabs&&l.setTabIndexForNonTabs(),l.trigger("dom:refresh"),l.options.viewShown?(d.setTabbing(l,g,e),l.options.tabClicked=!0):l.options.viewShown=!0}),f.on("view:shown",function(t){l.options.viewShown?(d.setTabbing(l,g,e,t),l.options.tabClicked=!0):l.options.viewShown=!0}),c.show(f),"esoc-user-profile-activity-tab"===e&&a.context._factories[r.collection.widgetOptions.activityfeed.widgetId].fetch(r).done(function(){f.trigger("view:shown")})},"setTabbing":function(e,t,s,n){var o=this;"esoc-user-profile-activity-tab"!==s&&(o.setTabIndexForViewElements(e),o.setTabIndexForViewInstanceElements(f,t)),i(".esoc-user-widget-dialog-back").attr("tabindex","0").attr("data-cstabindex","0"),e.$el.find("[data-cstabindex=0]").filter(":not(a:empty)").on("focus",function(t){o.addTabableClass(e,t)}),e.options.tabClicked&&"contentChanged"!==n&&f.$el.find("[data-cstabindex=0]").filter(":visible").filter(":not(a:empty)").first().trigger("focus")},"setTabIndexForViewElements":function(e){e.setTabIndexForTabs&&e.setTabIndexForTabs()},"addTabableClass":function(e,t){var s=i(t.target);e.options.focusedElement&&e.options.focusedElement.removeClass(u.accessibilityActiveElementClass),s.addClass(u.accessibilityActiveElementClass),e.options.focusedElement=s},"setTabIndexForViewInstanceElements":function(e,t){e.$el.find(t).attr("tabindex","0").attr("data-cstabindex","0")}};return p&&(p=s.flatten(p,!0),s.each(p,function(e){var t="esoc-user-profile-"+e.tabName+"-tab";g.userProfileTabViewMapping[t]=e.tabContentView})),g}),csui.define("hbs!esoc/widgets/userwidget/impl/userprofile",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"\r\n      esoc-full-profile-avatar-cursor "},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:""},"4":function(e,t,i,s){return'          <a href="javascript:void(0);">\r\n            <div id="esoc-userprofile-chat-action" class="esoc-user-profile-chat-action"></div>\r\n          </a>\r\n          <a href="javascript:void(0);" class="esoc-userprofile-following-action">\r\n          </a>\r\n'},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.enableUploadProfilePicture:n,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:""},"7":function(e,t,i,s){var n;return'            <a href="javascript:void(0);" class="esoc-update-profilepic"\r\n               title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.updatePic:n,e))+'">\r\n              <div class="esoc-userprofile-actions-name">\r\n                '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.updatePic:n,e))+'\r\n              </div>\r\n            </a>\r\n            <input type="file" id="esoc-profilepic-desktop-attachment" name="updateProfilePic"\r\n                   accept="image/*" style="display:none" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.updatePic:n,e))+'"/>\r\n'},"9":function(e,t,i,s){var n;return'        <li role="presentation" class="esoc-user-profile-tab" id="esoc-user-profile-personal-tab">\r\n          <a href="#tab3" data-binf-toggle="tab">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.personal:n,e))+"</a>\r\n        </li>\r\n"},"11":function(e,t,i,s){var n;return(null!=(n=t.unless.call(e,null!=e?e.hideFollowing:e,{"name":"unless","hash":{},"fn":this.program(12,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.unless.call(e,null!=e?e.hideFollowers:e,{"name":"unless","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:"")},"12":function(e,t,i,s){var n;return'\t\t\t\t<li role="presentation" class="esoc-user-profile-tab esoc-user-pulse-enabled-tabs"\r\n\t\t\t\t  id="esoc-user-profile-following-tab">\r\n\t\t\t\t\t<a href="#tab4" data-binf-toggle="tab" class="esoc-user-following-tab-label"\r\n\t\t\t\t\t   title= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followingCount:n,e))+'>\r\n\t\t\t\t\t  <span class="esoc-user-following-tab-label"\r\n\t\t\t\t\t\t\ttitle= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followingCount:n,e))+">"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.following:n,e))+'</span>\r\n\t\t\t\t\t  <span class="esoc-user-following-count esoc-user-following-tab-label"\r\n\t\t\t\t\t\t\ttitle= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followingCount:n,e))+"></span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n"},"14":function(e,t,i,s){var n;return'\t\t\t\t<li role="presentation" class="esoc-user-profile-tab esoc-user-pulse-enabled-tabs"\r\n\t\t\t\t  id="esoc-user-profile-followers-tab">\r\n\t\t\t\t\t<a href="#tab5" data-binf-toggle="tab" class="esoc-user-followers-tab-label"\r\n\t\t\t\t\t   title= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followersCount:n,e))+'>\r\n\t\t\t\t\t  <span class="esoc-user-followers-tab-label"\r\n\t\t\t\t\t\t\ttitle= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followersCount:n,e))+">"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followers:n,e))+'</span>\r\n\t\t\t\t\t  <span class="esoc-user-followers-count esoc-user-followers-tab-label"\r\n\t\t\t\t\t\t\ttitle= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.followersCount:n,e))+"></span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n"},"16":function(e,t,i,s){var n;return'\t\t\t<li role="presentation" class="esoc-user-profile-tab esoc-user-pulse-enabled-tabs"\r\n\t\t\t\tid="esoc-user-profile-activity-tab">\r\n\t\t\t  <a href="#tab6" data-binf-toggle="tab" class="esoc-user-activity-tab-label"\r\n\t\t\t\t title= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.activity:n,e))+'>\r\n\t\t\t\t<span class="esoc-user-activity-tab-label"\r\n\t\t\t\t\t  title= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.activity:n,e))+">"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.activity:n,e))+"</span></a>\r\n\t\t\t</li>\r\n"},"18":function(e,t,i,s){var n;return null!=(n=t.unless.call(e,null!=e?e.hideSettings:e,{"name":"unless","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?n:""},"19":function(e,t,i,s){var n;return'\t\t\t\t<li role="presentation" class="esoc-user-profile-tab esoc-user-pulse-enabled-tabs"\r\n\t\t\t\t  id="esoc-user-profile-settings-tab">\r\n\t\t\t\t\t<a href="#tab7" data-binf-toggle="tab" class="esoc-user-settings-tab-label"\r\n\t\t\t\t\t   title= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.settings:n,e))+'>\r\n\t\t\t\t\t  <span class="esoc-user-settings-tab-label" title= '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.settings:n,e))+">"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.settings:n,e))+"</span></a>\r\n\t\t\t\t</li>\r\n"},"21":function(e,t,i,s){var n;return null!=(n=t.blockHelperMissing.call(e,this.lambda(e,e),{"name":"this","hash":{},"fn":this.program(22,s,0),"inverse":this.noop}))?n:""},"22":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.show:e,{"name":"if","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:""},"23":function(e,t,i,s){var n,o;return'            <li role="presentation" class="esoc-user-profile-tab"\r\n                id="esoc-user-profile-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-tab">\r\n              <a href="#'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'" data-binf-toggle="tab"\r\n                 class="esoc-user-profile-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-tab-label" title= '+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'>\r\n              <span class="esoc-user-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-tab-label esoc-user-profile-tab-label"\r\n                    title="'+this.escapeExpression((o=null!=(o=t.tabDisplayName||(null!=e?e.tabDisplayName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabDisplayName","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.tabDisplayName||(null!=e?e.tabDisplayName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabDisplayName","hash":{}}):o))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.tabCount:e,{"name":"if","hash":{},"fn":this.program(24,s,0),"inverse":this.noop}))?n:"")+"              </a>\r\n            </li>\r\n"},"24":function(e,t,i,s){var n,o;return'                  <span class="esoc-user-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-count\r\n              esoc-user-profile-tab-count esoc-user-profile-tab-label"\r\n                        title= "'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.tabCount:e)?n.count:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.tabCount:e)?n.count:n,e))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12  esoc-nopadding-right">\r\n  <div class="esoc-userprofile-actions">\r\n    <div class="esoc-userprofile-pic-actions">\r\n      <span class="'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"!this.messages.isOtherUser && this.messages.enableUploadProfilePicture",{"name":"xif","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"\r\n      image_user_placeholder esoc-userprofile-default-avatar esoc-full-profile-avatar-update\r\n    esoc-user-default-avatar-"+this.escapeExpression((o=null!=(o=t.userid||(null!=e?e.userid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"userid","hash":{}}):o))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.displayname:n,e))+'">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n      <img class="'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"!this.messages.isOtherUser && this.messages.enableUploadProfilePicture",{"name":"xif","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+" esoc-full-profile-avatar\r\n    esoc-full-profile-avatar-update binf-img-circle esoc-image\r\n    esoc-upload-image-style\r\n    esoc-userprofile-img-"+this.escapeExpression((o=null!=(o=t.userid||(null!=e?e.userid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"userid","hash":{}}):o))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.displayname:n,e))+'"\r\n           alt="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.display_name:n,e))+'" src="#"/>\r\n    </div>\r\n    <div class="esoc-profile-img-load-container esoc-social-progress-style">\r\n      <div class="esoc-profile-img-outer-border">\r\n        <div class="esoc-profile-img-loader">\r\n          <div class="esoc-profile-img-inner-border"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="esoc-userprofile-action-names">\r\n'+(null!=(n=t.if.call(e,null!=e?e.deleted:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(3,s,0)}))?n:"")+'    </div>\r\n  </div>\r\n  <a href="javascript:void(0);" id="esoc-user-focus-element" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.updatePic:n,e))+'"></a>\r\n\r\n  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 tab-links esoc-profile-tabs\r\n  esoc-nopadding-right">\r\n    <div class="tab-links-bar">\r\n      <div class="left-toolbar"></div>\r\n      <ul class=\'binf-nav binf-nav-pills esoc-user-profile-tabcontainer\'>\r\n        <li role="presentation" class="esoc-user-profile-tab binf-active"\r\n            id="esoc-user-profile-general-tab">\r\n          <a href="#tab1" data-binf-toggle="tab" class="esoc-user-general-tab-label"\r\n             title='+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.general:n,e))+'>\r\n          <span class="esoc-user-general-tab-label"\r\n                title='+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.general:n,e))+">"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.general:n,e))+"</span></a>\r\n        </li>\r\n        \x3c!--\r\n"+(null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(9,s,0)}))?n:"")+"      //--\x3e\r\n"+(null!=(n=t.if.call(e,null!=e?e.deleted:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(11,s,0)}))?n:"")+(null!=(n=t.unless.call(e,null!=e?e.hideActivity:e,{"name":"unless","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(18,s,0)}))?n:"")+(null!=(n=t.each.call(e,null!=e?e.extraTabs:e,{"name":"each","hash":{},"fn":this.program(21,s,0),"inverse":this.noop}))?n:"")+'      </ul>\r\n      <div class="right-toolbar"></div>\r\n      <div id="esoc-user-profile-tab-content"\r\n           class="esoc-user-profile-tab-content binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n'}});return i.registerPartial("esoc_widgets_userwidget_impl_userprofile",s),s}),csui.define("hbs!esoc/widgets/userwidget/impl/customchatbtn",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return"<a class='esoc-social-chat-control' title='"+this.escapeExpression((n=null!=(n=t.labeltext||(null!=e?e.labeltext:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"labeltext","hash":{}}):n))+"'> "+this.escapeExpression((n=null!=(n=t.chat||(null!=e?e.chat:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"chat","hash":{}}):n))+" </a>"}});return i.registerPartial("esoc_widgets_userwidget_impl_customchatbtn",s),s}),csui.define("esoc/widgets/userwidget/view/userprofile.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","csui/controls/tab.panel/tab.links.ext.scroll.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/utils/user.avatar.color","esoc/widgets/userwidget/userprofile","esoc/widgets/userwidget/util","esoc/widgets/utils/chat/chat.view","csui-ext!esoc/widgets/userprofile/tab.extension","hbs!esoc/widgets/userwidget/impl/userprofile","hbs!esoc/widgets/userwidget/impl/customchatbtn","i18n!esoc/widgets/userwidget/nls/lang","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v,b){var w,y,x,_=e.config(),C=null,E=function(){var e=i.Deferred();return w&&y&&x?e.resolve():csui.require(["csui/controls/tab.panel/tab.panel.view","csui/controls/tab.panel/impl/tab.contents.view","csui/controls/tab.panel/impl/tab.links.view"],function(t,n,o){w=n.extend({"className":"esoc-userprofile-widget","constructor":function(e){e||(e={}),s.defaults(e,{"toolbar":!0,"searchTabContentForTabableElements":!0}),n.prototype.constructor.apply(this,arguments)}}),y=t.extend({"className":"esoc-userprofile-widget","constructor":function(e){e||(e={}),s.defaults(e,{"toolbar":!0,"searchTabContentForTabableElements":!0}),t.prototype.constructor.apply(this,arguments)},"behaviors":{"TabableRegionBehavior":{"behaviorClass":c}},"currentlyFocusedElement":function(e){var t=this.options.focusedElement;return e&&e.shiftKey?t&&i(t).length?t:void 0:this.$el.find("[data-cstabindex=0]")[0]},"onLastTabElement":function(e){var t=this.$("[data-cstabindex=0]").filter(":visible"),s=t.length-1;if(t.length){var n=e?t[0]:t[s];return i(n).hasClass(c.accessibilityActiveElementClass)}return!0}}),x=o.extend({"className":"esoc-userprofile-widget","constructor":function(e){e||(e={}),s.defaults(e,{"toolbar":!0,"searchTabContentForTabableElements":!0}),o.prototype.constructor.apply(this,arguments)}}),e.resolve()},e.reject),e.promise()},k=o.ItemView.extend({"className":"esoc-userprofile-widget","template":g,"util":p,"templateHelpers":function(){return{"hideFollowing":_.hideFollowing,"hideFollowers":_.hideFollowers,"hideActivity":_.hideActivity,"hideSettings":_.hideSettings,"extraTabs":this.getExtraTabs(f),"messages":{"general":b.general,"extended":b.extended,"personal":b.personal,"following":b.following,"followers":b.followers,"activity":b.activity,"settings":b.settings,"unfollow":b.unfollow,"follow":b.follow,"updatePic":b.updatePic,"displayname":this.model.attributes.display_name?this.model.attributes.display_name:this.options.display_name,"enableUploadProfilePicture":!!this.options.enableUploadProfilePicture,"isOtherUser":!!this.model.attributes.otherUser}}},"behaviors":{"TabableRegionBehavior":{"behaviorClass":c}},"initialize":function(e){this.options=e,C=this;var t=this.model.id?this.model.id:this.options.userid;C.userProfileFollowingUrl=a.combine(this.util.commonUtil.getV2Url(this.options.connector.connection.url),this.util.commonUtil.REST_URLS.pulseRestUrl,t),C.userPulseInfoUrl=a.combine(C.util.commonUtil.getV2Url(C.options.connector.connection.url),C.util.commonUtil.REST_URLS.pulseRestUrl,t),i(window).on("popstate hashchange",this.util.closeUserWidgetDialog),this.listenTo(this.util.commonUtil.globalConstants.event_bus,"updateuserfollowingstatus",function(e,t){if(this.model.attributes.otherUser){if(e.model.attributes.id===this.model.attributes.id){
this.model.attributes.following=e.model.attributes.following,e.model.attributes.following?(i(".esoc-userprofile-following-action").html(b.unfollow),i(".esoc-userprofile-following-action").attr("title",b.unfollow)):(i(".esoc-userprofile-following-action").html(b.follow),i(".esoc-userprofile-following-action").attr("title",b.follow));var s={"itemview":C,"url":C.userPulseInfoUrl,"type":"GET","requestType":"pulseInfo"};C.util.updateAjaxCall(s)}}else this.util.changeRelationsCounts(t.data.user)})},"events":{"click .esoc-user-profile-tab":"showTab","click .esoc-userprofile-following-action":"followUnFollowAction","click .esoc-update-profilepic":"updateProfilePicAction","touchend .esoc-update-profilepic":"updateProfilePicAction","click .esoc-full-profile-avatar-update":"updateProfilePicAction","keydown .esoc-full-profile-avatar-update":"updateProfilePicAction","touchend .esoc-full-profile-avatar-update":"updateProfilePicAction"},"constructor":function(e){e=e||{},s.defaults(e,{"toolbar":!0,"tabClickedOnce":!1,"initialActivationWeight":0}),this.options=e,this.listenToOnce(this,"before:hide",r.popTabableHandler),o.ItemView.prototype.constructor.call(this,e),i(window).on("resize",s.bind(this._onWindowResize,this))},"errorHandle":function(e,t){},"onDestroy":function(){var e=this.options.targetEle;e&&i(e).is(":visible")?i(e).trigger("focus"):e||(e=i(".nav-profile"))&&e.length&&i(e).trigger("focus"),i(window).off("resize",this._onWindowResize)},"_onWindowResize":function(){this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(s.bind(function(){this._enableToolbarState()},this),200)},"_initializeOthers":function(){var e={"gotoPreviousTooltip":b.previous,"gotoNextTooltip":b.next};this._initializeToolbars(e),this._listenToTabEvent(),setTimeout(s.bind(this._enableToolbarState,this),300)},"onRender":function(e){var t=this;t.options.userbackgroundcolor=u.getUserAvatarColor(this.model.attributes),E().done(function(){t.propagateEventsToRegions();var e=new y(s.extend(t));e.tabLinks=new x(s.extend(t)),e.tabContent=new w(s.extend(t)),e.options=t.options,i.extend(t,e),t.on("userprofileview.show.user.dialog",function(e){t.options.userWidgetView.trigger("userwidgetview.show.user.dialog",e)}),t._initializeOthers()})},"tabItemsFocus":function(e){this.options.focusedElement&&this.options.focusedElement.removeClass(c.accessibilityActiveElementClass);var t=i(e.target);t.addClass(c.accessibilityActiveElementClass),this.options.focusedElement=t,"radio"===t.attr("type")&&(t[0].checked=!0)},"setTabIndexForTabs":function(){this.$el.find("a[href][title],*[tabindex] *[data-cstabindex]").filter(":visible").filter(":not(a:empty)").attr("tabindex","0").attr("data-cstabindex","0")},"onAfterShow":function(e){var t=this;this._initializeOthers(),this.$el.find("#esoc-user-profile-general-tab").trigger("click");var i=this.model.id?this.model.id:this.options.userid,n={"userid":i,"context":t.options.context,"photoElement":t.$el.find(".esoc-userprofile-img-"+p.escapeSelector(i)),"defaultPhotElement":t.$el.find(".esoc-user-default-avatar-"+p.escapeSelector(i)),"userbackgroundcolor":this.options.userbackgroundcolor,"parentView":this,"viewShownEvent":!0};if(t.util.commonUtil.setProfilePic(n),t.util.commonUtil.setUserColor(n),this.options.model.attributes.otherUser&&!this.options.model.attributes.deleted&&this.options.model.attributes.chatSettings&&this.options.model.attributes.chatSettings.chatEnabled){var a={"chat":b.chat,"labeltext":s.str.sformat(b.chatlabeltext,this.options.model.attributes.name)},l=new o.Region({"el":"#esoc-userprofile-chat-action"}),r={"context":this.options.context,"tguser":this.options.model.attributes.name,"customtemplate":v(a),"domain":this.options.model.attributes.chatSettings.chatDomain},c=new h(r);l.show(c)}},"showTab":function(e){m.showTab(e.currentTarget.id,"esoc-user-profile-tab-content",C.options,this)},"followUnFollowAction":function(e){var t=new FormData,s=this.model.attributes.following?p.commonUtil.globalConstants.UNFOLLOW:p.commonUtil.globalConstants.FOLLOW;t.append(p.commonUtil.globalConstants.ACTION,s);var n={"itemview":this,"url":this.userProfileFollowingUrl,"type":"POST","data":t,"requestType":"userProfileFollowingAction","targetElement":i(e.target)};this.util.updateAjaxCall(n)},"updateProfilePicAction":function(e){if(!this.processKeyEvent(e)){var t=this,i=this.$el.find("#esoc-profilepic-desktop-attachment");i.off("change").on("change",function(e){if(i.val().length>0){var s=new FormData,n=i[0].files[0];n&&s.append("photo",n),t.$el.find(".esoc-userprofile-actions .esoc-full-profile-avatar").addClass("esoc-profile-opacity"),t.$el.find(".esoc-userprofile-actions .esoc-profile-img-load-container").addClass("esoc-progress-display");var o=t.options.connector.connection.url.replace("/v1","/v2"),l={"itemview":t,"url":a.combine(o,t.util.commonUtil.REST_URLS.updatePhotoUrl),"type":"POST","requestType":"updatePhoto","data":s,"targetElement":e.target,"connector":t.options.connector};t.util.commonUtil.updateAjaxCall(l)}}),e.preventDefault(),i.trigger("click")}},"processKeyEvent":function(e){if("keydown"===e.type){var t=e.keyCode||e.which;if(32!==t&&13!==t)return!0}return!1},"getExtraTabs":function(e){var t=this;return e=s.flatten(e,!0),s.each(e,function(e){e.tabCount&&(e.tabCount.count=e.tabCount.getItemCount(t.model,t.options)),e.show=!0,e.showTab&&(e.show=e.showTab(t.model,t.options))}),e}});return s.extend(k.prototype,l),s.extend(k.prototype,d),k}),csui.define("hbs!esoc/widgets/userwidget/impl/simple.userwidget.tabs",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 tab-links esoc-profile-tabs\r\n  esoc-nopadding-right">\r\n    <div class="tab-links">\r\n     <div class="tab-links-header">\r\n       <div class="left-toolbar"></div>\r\n       <div class="tab-links-bar">\r\n        <ul class=\'binf-nav binf-nav-pills esoc-user-profile-tabcontainer\'>\r\n        <li class="esoc-user-profile-tab binf-active"\r\n            id="esoc-simple-user-profile-tab-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'">\r\n          <a href="#tab1" data-binf-toggle="tab" class="esoc-simple-user-profile-tab-label" title='+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.profile:n,e))+'>\r\n          <span class="esoc-simple-user-profile-tab-label"\r\n                title='+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.profile:n,e))+">"+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.profile:n,e))+"</span></a>\r\n        </li>\r\n\r\n"+(null!=(n=t.each.call(e,null!=e?e.extraTabs:e,{"name":"each","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'      </ul>\r\n       </div>\r\n      <div class="right-toolbar"></div>\r\n      </div>\r\n      <div id="esoc-simple-user-widget-form-body-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'"\r\n      class="esoc-simple-user-widget-form-body" role="tabpanel"></div>\r\n    </div>\r\n  </div>\r\n'},"2":function(e,t,i,s){var n;return null!=(n=t.blockHelperMissing.call(e,this.lambda(e,e),{"name":"this","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:""},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.show:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:""},"4":function(e,t,i,s){var n,o;return'              <li class="esoc-user-profile-tab"\r\n                  id="esoc-user-profile-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-tab">\r\n                <a href="#'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'" data-binf-toggle="tab" class="esoc-user-profile-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-tab-label" title= '+this.escapeExpression((o=null!=(o=t.tabDisplayName||(null!=e?e.tabDisplayName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabDisplayName","hash":{}}):o))+'>\r\n              <span class="esoc-user-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-tab-label esoc-user-profile-tab-label"\r\n                    title="'+this.escapeExpression((o=null!=(o=t.tabDisplayName||(null!=e?e.tabDisplayName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabDisplayName","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.tabDisplayName||(null!=e?e.tabDisplayName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabDisplayName","hash":{}}):o))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.tabCount:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+"                </a>\r\n              </li>\r\n"},"5":function(e,t,i,s){var n,o;return'                    <span class="esoc-user-'+this.escapeExpression((o=null!=(o=t.tabName||(null!=e?e.tabName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"tabName","hash":{}}):o))+'-count\r\n              esoc-user-profile-tab-count esoc-user-profile-tab-label"\r\n                          title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.tabCount:e)?n.count:n,e))+'">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.tabCount:e)?n.count:n,e))+"</span>\r\n"},"7":function(e,t,i,s){var n;return'  <div id="esoc-simple-user-widget-form-body-'+this.escapeExpression((n=null!=(n=t.uniqueId||(null!=e?e.uniqueId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"uniqueId","hash":{}}):n))+'" class="esoc-simple-user-widget-form-body" role="tabpanel"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.extraTabs:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(7,s,0)}))?n:""}});return i.registerPartial("esoc_widgets_userwidget_impl_simple.userwidget.tabs",s),s}),csui.define("esoc/widgets/userwidget/view/simple.userwidget.tabs.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","csui/controls/tab.panel/tab.links.ext.scroll.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","esoc/widgets/userwidget/userprofile","esoc/widgets/userwidget/view/simple.userwidget.form.view","csui-ext!esoc/widgets/userprofile/tab.extension","hbs!esoc/widgets/userwidget/impl/simple.userwidget.tabs","i18n!esoc/widgets/userwidget/nls/lang","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f){var g,v,b,w=function(){var e=t.Deferred();return g&&v&&b?e.resolve():csui.require(["csui/controls/tab.panel/tab.panel.view","csui/controls/tab.panel/impl/tab.contents.view","csui/controls/tab.panel/impl/tab.links.view"],function(s,n,o){g=n.extend({"className":"esoc-simple-user-widget-tab-view","constructor":function(e){e||(e={}),i.defaults(e,{"toolbar":!0,"searchTabContentForTabableElements":!0}),n.prototype.constructor.apply(this,arguments)}}),v=s.extend({"className":"esoc-simple-user-widget-tab-view","constructor":function(e){e||(e={}),i.defaults(e,{"toolbar":!0,"searchTabContentForTabableElements":!0}),s.prototype.constructor.apply(this,arguments)},"behaviors":{"TabableRegionBehavior":{"behaviorClass":c}},"currentlyFocusedElement":function(e){var i=this.options.focusedElement;return void 0===e||!1===e.shiftKey?t(this.$el.find("a[title]").filter(":visible").filter(":not(a:empty)")[0]):i&&t(i).length?i:void 0},"onLastTabElement":function(e){var i=this.$el.find("[tabindex="+this.options.tabCount+"]").filter(":visible").filter(":not(a:empty)"),s=e?this.$el.find("a[title]").filter(":visible").filter(":not(a:empty)")[0]:i.last();return e||1!==i.length||this.options.tabIndex+1!==this.options.tabCount?t(s).hasClass(c.accessibilityActiveElementClass):(this.options.tabIndex=0,!0)}}),b=o.extend({"className":"esoc-simple-user-widget-tab-view","constructor":function(e){e||(e={}),i.defaults(e,{"toolbar":!0,"searchTabContentForTabableElements":!0}),o.prototype.constructor.apply(this,arguments)}}),e.resolve()},e.reject),e.promise()},y=o.ItemView.extend({"className":"esoc-simple-user-widget-tab-view","template":h,"templateHelpers":function(){return{"uniqueId":this.options.uniqueId,"extraTabs":this.getExtraTabs(p),"messages":{"profile":f.profile,"settings":f.settings}}},"events":{"click .esoc-user-profile-tab":"showTab"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":c}},"constructor":function(e){e=e||{},i.defaults(e,{"toolbar":!0,"tabClickedOnce":!1,"initialActivationWeight":1}),t(window).on("resize",{"view":this},this._onWindowResize),o.ItemView.prototype.constructor.call(this,e),this.uniqueId=i.uniqueId()},"onRender":function(e){var s=this;w().done(function(){s.propagateEventsToRegions();var e=new v(i.extend(s));e.tabLinks=new b(i.extend(s)),e.tabContent=new g(i.extend(s)),e.options=s.options,t.extend(s,e),s._initializeOthers()})},"onShow":function(){if(0===this.templateHelpers().extraTabs.length){this.options.userwidgetmodel=this.options.model;var e=new m(this.options);new o.Region({"el":this.$el.find("#esoc-simple-user-widget-form-body-"+this.options.uniqueId)}).show(e)}},"onAfterShow":function(){w()},"_onWindowResize":function(e){e&&e.data&&e.data.view&&e.data.view._enableToolbarState()},"_initializeOthers":function(){var e={"gotoPreviousTooltip":f.previous,"gotoNextTooltip":f.next};this._initializeToolbars(e),this._listenToTabEvent(),setTimeout(i.bind(this._enableToolbarState,this),300)},"showTab":function(e){u.showTab(e.currentTarget.id,"esoc-simple-user-widget-form-body-"+this.options.uniqueId,this.options,this);var t=this.$el.find("#"+e.currentTarget.id);t.find("a").attr("aria-selected",!0),t.siblings().find("a").attr("aria-selected",!1)},"getExtraTabs":function(e){var t=this;return e=i.flatten(e,!0),i.each(e,function(e){e.tabCount&&(e.tabCount.count=e.tabCount.getItemCount(t.model,t.options)),e.show=!0,e.showTab&&(e.show=e.showTab(t.model,t.options))}),e}});return i.extend(y.prototype,l),i.extend(y.prototype,d),y}),csui.define("hbs!esoc/widgets/userwidget/impl/simple.userwidget",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=(n=null!=e?e.chatSettings:e)?n.presenceEnabled:n,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")},"2":function(e,t,i,s){return'          <div id="esoc-user-profile-presence-indicator" class="esoc-user-profile-presence-indicator binf-col-lg-12 binf-col-md-12 binf-col-sm-12\r\n    binf-col-xs-12"></div>\r\n'},"4":function(e,t,i,s){var n;return'          <div role="button" class="esoc-user-profile-chat-comment" aria-label="'+this.escapeExpression((n=null!=(n=t.chatLabel||(null!=e?e.chatLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"chatLabel","hash":{}}):n))+'"\r\n               tabindex="0" data-cstabindex="0"></div>\r\n'},"6":function(e,t,i,s){return" esoc-full-profile-avatar-cursor "},"8":function(e,t,i,s){var n;return'            <span class="edit-user-image-placeholder edit-user"></span>\r\n            <input type="file" id="esoc-profilepic-desktop-attachment"\r\n                   class="esoc-profilepic-desktop-attachment" name="updateProfilePic" accept="image/*"\r\n                   aria-label="'+this.escapeExpression((n=null!=(n=t.simpleUserProfileLabel||(null!=e?e.simpleUserProfileLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"simpleUserProfileLabel","hash":{}}):n))+'"/>\r\n\r\n            <div class="esoc-simple-profile-img-load-container esoc-social-progress-style">\r\n                <div class="esoc-simple-profile-img-outer-border">\r\n                    <div class="esoc-simple-profile-img-loader">\r\n                        <div class="esoc-simple-profile-img-inner-border"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n'},"10":function(e,t,i,s){var n;return'        <div\r\n            class="esoc-user-title binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="esoc-simple-user-widget">\r\n  <div class="esoc-simple-user-widget-header">\r\n    <div class="cs-close binf-close esoc-user-widget-dialog-close" role="button"\r\n         title="'+this.escapeExpression((o=null!=(o=t.dialogCloseButtonTooltip||(null!=e?e.dialogCloseButtonTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogCloseButtonTooltip","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.closeDialogLabel||(null!=e?e.closeDialogLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"closeDialogLabel","hash":{}}):o))+'" tabindex="0"\r\n         data-cstabindex="0"></div>\r\n    <div class="esoc-userprofile-pic-actions">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.chatSettings:e)?n.chatEnabled:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'      <span role="button" class="'+(null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(6,s,0)}))?n:"")+"\r\n      image_user_placeholder esoc-userprofile-default-avatar esoc-full-profile-avatar-update\r\n    esoc-user-default-avatar-"+this.escapeExpression((o=null!=(o=t.userid||(null!=e?e.userid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"userid","hash":{}}):o))+'" id="esoc-simple-user-default-avatar-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.displayname:n,e))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.simpleUserProfileLabel||(null!=e?e.simpleUserProfileLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"simpleUserProfileLabel","hash":{}}):o))+'" tabindex="0"\r\n            data-cstabindex="0">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n      <img role="button" class="'+(null!=(n=t.if.call(e,null!=e?e.otherUser:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(6,s,0)}))?n:"")+"\r\n      esoc-full-profile-avatar\r\n    esoc-full-profile-avatar-update binf-img-circle esoc-image\r\n    esoc-upload-image-style\r\n    esoc-userprofile-img-"+this.escapeExpression((o=null!=(o=t.userid||(null!=e?e.userid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"userid","hash":{}}):o))+'" id="esoc-simple-user-image-avatar-'+this.escapeExpression((o=null!=(o=t.uniqueId||(null!=e?e.uniqueId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"uniqueId","hash":{}}):o))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.displayname:n,e))+'" alt="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.displayname:n,e))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.simpleUserProfileLabel||(null!=e?e.simpleUserProfileLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"simpleUserProfileLabel","hash":{}}):o))+'"\r\n           tabindex="0" data-cstabindex="0" src="#"/>\r\n\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.isEnableUploadProfilePicture && !this.otherUser",{"name":"xif","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+'    </div>\r\n\r\n    <div class="esoc-user-name binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      '+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+"\r\n"+(null!=(n=t.if.call(e,null!=e?e.title:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+'    </div>\r\n  </div>\r\n  <div class="esoc-simple-user-widget-body">\r\n    <div class="esoc-simple-user-widget-tabs"></div>\r\n  </div>\r\n  <div class="esoc-simple-user-widget-footer"></div>\r\n</div>\r\n<div class="esoc-simple-user-widget-backdrop"></div>\r\n'}});return i.registerPartial("esoc_widgets_userwidget_impl_simple.userwidget",s),s}),csui.define("hbs!esoc/widgets/userwidget/impl/edit.profile.photo",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="esoc-simple-user-profile-pic-update">\r\n  <div class="esoc-simple-user-profile-pic-edit\r\n  esoc-profile-pic-edit" role="button" aria-label="'+this.escapeExpression((n=null!=(n=t.uploadProfilePicture||(null!=e?e.uploadProfilePicture:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"uploadProfilePicture","hash":{}}):n))+'"\r\n       tabindex="-1">'+this.escapeExpression((n=null!=(n=t.uploadProfilePicture||(null!=e?e.uploadProfilePicture:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"uploadProfilePicture","hash":{}}):n))+'</div>\r\n  <div class="esoc-simple-user-profile-pic-delete\r\n  esoc-profile-pic-edit" role="button" aria-label="'+this.escapeExpression((n=null!=(n=t.deleteProfilePicture||(null!=e?e.deleteProfilePicture:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"deleteProfilePicture","hash":{}}):n))+'"\r\n       tabindex="-1">'+this.escapeExpression((n=null!=(n=t.deleteProfilePicture||(null!=e?e.deleteProfilePicture:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"deleteProfilePicture","hash":{}}):n))+"</div>\r\n</div>"}});return i.registerPartial("esoc_widgets_userwidget_impl_edit.profile.photo",s),s}),csui.define("esoc/widgets/userwidget/view/simple.userwidget.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/handlebars","csui/lib/marionette","csui/utils/url","csui/controls/form/fields/userfield.view","csui/utils/user.avatar.color","esoc/widgets/userwidget/model/extended.model","esoc/widgets/userwidget/userprofile","esoc/widgets/userwidget/util","esoc/widgets/userwidget/view/extendedinfotextfield.view","esoc/widgets/userwidget/chat/view/presence.view","esoc/widgets/userwidget/chat/chatfactory","esoc/widgets/utils/chat/impl/util","esoc/widgets/userwidget/view/simple.userwidget.form.view","esoc/widgets/userwidget/view/simple.userwidget.tabs.view","hbs!esoc/widgets/userwidget/impl/simple.userwidget","hbs!esoc/widgets/userwidget/impl/edit.profile.photo","i18n!esoc/widgets/userwidget/nls/lang","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v,b,w){return n.ItemView.extend({"className":"esoc-simple-user-widget-view","template":v,"editProfilePhotoTemplate":b,"util":d,"ui":{"initialsPlaceholder":".image_user_placeholder"},"templateHelpers":function(){var e=this.options.model.attributes.extendedInfo,t=!this.options.model.attributes.otherUser&&!!e&&e.isEditable,i=this.model.attributes.chatSettings&&this.model.attributes.chatSettings.chatEnabled,s=i&&this.model.attributes.chatSettings.presenceEnabled&&this.options.showPresenceIndicator;return{"uniqueId":this.uniqueId,"messages":{"displayname":this.model.attributes.display_name?this.model.attributes.display_name:this.options.display_name,"showReportsTo":t||!!e&&!!e.reportsTo},"simpleUserProfileLabel":w.simpleUserProfileLabel,"isEnableUploadProfilePicture":!!this.options.enableUploadProfilePicture,"dialogCloseButtonTooltip":w.dialogCloseButtonTooltip,"chatLabel":w.chatLabel,"closeDialogLabel":w.closeDialogLabel,"chatSettings":{"chatEnabled":i,"presenceEnabled":s}}},"events":{"mouseover .esoc-simple-user-widget-header .edit-user":"onMouseoverProfilePic","mouseout .edit-user":"onMouseoutProfilePic","focusin .edit-user":"onMouseoverProfilePic","focusout .edit-user":"onMouseoutProfilePic","click .esoc-simple-user-widget-header .edit-user":"editProfilePhoto","click .esoc-user-profile-chat-comment":"launchChatWindow","keydown .esoc-user-profile-chat-comment":"launchChatWindow","keydown .esoc-user-widget-dialog-close":"closeSimpleUserWidget","click .esoc-simple-user-profile-pic-edit":"uploadPhoto","click .esoc-simple-user-profile-pic-delete":"deletePhoto","keydown .esoc-simple-user-profile-pic-edit":"uploadPhoto","keydown .esoc-simple-user-profile-pic-delete":"deletePhoto","keydown":"onKeyDown"},"onKeyDown":function(e){if(9===e.keyCode||e.shiftKey){var t=this.$el.find(this.focusablesSelector).filter(":visible");e.target===t[0]&&e.shiftKey&&9===e.which?(t.last().trigger("focus"),e.preventDefault()):e.target!==t[t.length-1]||e.shiftKey||(t.first().trigger("focus"),e.preventDefault())}},"initialize":function(e){if(this.options=e,!this.options.model.attributes.isError){var s=(i.Model.extend({}),this.templateHelpers().messages,this.model.attributes.extendedInfo);this.model.attributes.userid,this.options.connector,!this.model.attributes.otherUser&&!!s&&s.isEditable}this.uniqueId=t.uniqueId();var n="mouseover #esoc-simple-user-default-avatar-"+this.uniqueId;this.events[n]="onMouseoverProfilePic";var o="focusin #esoc-simple-user-default-avatar-"+this.uniqueId;this.events[o]="onMouseoverProfilePic";var a="mouseout #esoc-simple-user-default-avatar-"+this.uniqueId;this.events[a]="onMouseoutProfilePic";var l="focusout #esoc-simple-user-default-avatar-"+this.uniqueId;this.events[l]="onMouseoutProfilePic";var r="keydown #esoc-simple-user-default-avatar-"+this.uniqueId;this.events[r]="editProfilePhoto";this.uniqueId;this.events[n]="onMouseoverProfilePic";var c="focusin #esoc-simple-user-image-avatar-"+this.uniqueId;this.events[c]="onMouseoverProfilePic";var d="mouseout #esoc-simple-user-image-avatar-"+this.uniqueId;this.events[d]="onMouseoutProfilePic";var u="focusout #esoc-simple-user-image-avatar-"+this.uniqueId;this.events[u]="onMouseoutProfilePic";var m="keydown #esoc-simple-user-image-avatar-"+this.uniqueId;this.events[m]="editProfilePhoto",this.focusablesSelector="a[href], area[href], input:not([disabled]), select:not([disabled]),textarea:not([disabled]),  button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",this.delegateEvents()},"constructor":function(e){e=e||{};var i=t.extend({},e);i.model=new r(i),i.model.fetch({"success":i.model.fetchSuccess,"error":i.model.fetchError,"async":!1}),n.ItemView.prototype.constructor.call(this,i),this.listenTo(this,"render",this._assignUserColor)},"onAfterShow":function(e){var i=new n.Region({"el":this.$el.find(".esoc-simple-user-widget-tabs")});this.options.uniqueId=t.uniqueId();var s=new g(this.options);i.show(s),s.triggerMethod("after:show"),i.$el.find("#esoc-simple-user-profile-tab-"+this.options.uniqueId).trigger("click");var o=this.options.model.id?this.options.model.id:this.options.userid,a={"userid":o,"context":this.options.context,"photoElement":this.$el.find(".esoc-userprofile-img-"+d.escapeSelector(o)),"defaultPhotElement":this.$el.find(".esoc-user-default-avatar-"+d.escapeSelector(o)),"parentView":this,"viewShownEvent":!0};if(this.util.commonUtil.setProfilePic(a),this.model.attributes.chatSettings&&this.model.attributes.chatSettings.chatEnabled&&this.model.attributes.chatSettings.presenceEnabled&&this.options.showPresenceIndicator){var l={"id":this.model.attributes.id,"context":this.options.context,"username":this.model.attributes.name,"subscribeEvent":!0},r=new n.Region({"el":this.$el.find("#esoc-user-profile-presence-indicator")});p.initializeApplication(this.options).promise().done(function(){var e=new m(l);r.show(e)})}this.options.enableUploadProfilePicture&&!this.model.attributes.otherUser||(this.$el.find("#esoc-simple-user-default-avatar-"+this.uniqueId).attr("tabindex","-1"),this.$el.find("#esoc-simple-user-image-avatar-"+this.uniqueId).attr("tabindex","-1"))},"uploadPhoto":function(t){if(!this.processKeyEvent(t)){var i=this,s=this.$el.find("#esoc-profilepic-desktop-attachment");s.off("change").on("change",function(t){if(s.val().length>0){var n=new FormData,a=s[0].files[0];a&&n.append("photo",a),i.$el.find(".esoc-userprofile-actions .esoc-full-profile-avatar").addClass("esoc-profile-opacity"),i.$el.find(".esoc-userprofile-actions .esoc-profile-img-load-container").addClass("esoc-progress-display"),e(".esoc-simple-profile-img-load-container").addClass("esoc-simple-profile-img-load-icon");var l=i.options.connector.connection.url.replace("/v1","/v2"),r={"itemview":i,"url":o.combine(l,i.util.commonUtil.REST_URLS.updatePhotoUrl),"type":"POST","requestType":"updatePhoto","data":n,"targetElement":t.target,"connector":i.options.connector};i.util.commonUtil.updateAjaxCall(r)}}),t.preventDefault(),s.trigger("click"),this.$el.find(".edit-user").css("opacity","0"),this.$el.find(".esoc-full-profile-avatar-cursor").trigger("focus")}},"editProfilePhoto":function(t){if(!this.processKeyEvent(t))if(this.$el.find(".esoc-simple-user-edit-pic-popover").is(":visible"))this.popoverTarget.binf_popover("destroy");else{var i=this,s=function(e){return e.is(":visible")?e.offset():{"top":0,"left":0}};if(i.options.enableUploadProfilePicture&&i.model.attributes.photo_url){this.popoverTarget=i.$el.find(".edit-user");var n={"uploadProfilePicture":w.uploadProfilePicture,"deleteProfilePicture":w.deleteProfilePicture},o=this.editProfilePhotoTemplate(n);this.popoverTarget.binf_popover({"content":o,"html":!0,"placement":function(t,n){e(t).addClass("esoc-simple-user-edit-pic-popover");var o=e("<div/>").addClass("esoc-simple-user-edit-pic-popover binf-popover esoc-simple-user-edit-pic-popover-temp-div").append(i.editProfilePhotoTemplate);i.popoverTarget.find(".edit-user").append(o);var a=e(".esoc-simple-user-edit-pic-popover-temp-div").height()+40;e(".esoc-simple-user-edit-pic-popover-temp-div").width();o.remove();var l=s(e(n)),r=l.top;return e(window).height()-(r+i.popoverTarget.outerHeight(!0))>a?"bottom":r>a?"top":"auto"}}),this.popoverTarget.binf_popover("show"),e("*").one("scroll",function(){i.popoverTarget.binf_popover("destroy")}),e(".esoc-simple-user-widget-dialog").on("click",function(t){e(".esoc-simple-user-widget-dialog [aria-describedby]").each(function(){i.popoverTarget.is(t.target)||0!==i.popoverTarget.has(t.target).length||0!==e(".binf-popover").has(t.target).length||i.popoverTarget.binf_popover("destroy")})}),e(".esoc-simple-user-widget-dialog .csui-icon-edit").on("click",function(e){i.popoverTarget.binf_popover("destroy")}),e(".esoc-simple-user-widget-dialog .btn-container").on("click",function(e){i.popoverTarget.binf_popover("destroy")}),this.$el.find(".esoc-simple-user-profile-pic-update").on("keydown",function(t){var s=t.keyCode||t.which;13!==s&&(t.preventDefault(),t.stopPropagation()),27===s&&(i.popoverTarget.binf_popover("destroy"),i.popoverTarget.siblings("img").first().trigger("focus")),t.target.classList.contains("esoc-simple-user-profile-pic-edit")?40!==s&&38!==s||e(".esoc-simple-user-profile-pic-delete").trigger("focus"):t.target.classList.contains("esoc-simple-user-profile-pic-delete")&&(40!==s&&38!==s||e(".esoc-simple-user-profile-pic-edit").trigger("focus"))}),this.$el.find(".esoc-simple-user-profile-pic-edit").trigger("focus"),this.$el.find(".esoc-simple-user-profile-pic-edit").attr("tabindex","0"),
this.$el.find(".esoc-simple-user-profile-pic-delete").attr("tabindex","0")}else this.uploadPhoto(t)}},"deletePhoto":function(e){if(!this.processKeyEvent(e)){this.popoverTarget.binf_popover("destroy");var t=this.options.connector.connection.url.replace("/v1","/v2"),i={"itemview":this,"url":o.combine(t,this.util.commonUtil.REST_URLS.deletePhotoUrl),"type":"DELETE","requestType":"deletePhoto","targetElement":e.target,"connector":this.options.connector};this.util.commonUtil.updateAjaxCall(i)}},"onMouseoverProfilePic":function(){this.$el.find(".edit-user").css("opacity","1")},"onMouseoutProfilePic":function(){this.$el.find(".edit-user").css("opacity","0")},"launchChatWindow":function(e){this.processKeyEvent(e)||(this.options.tguser=this.options.model.get("name"),this.options.domain=this.options.model.get("chatSettings")&&this.options.model.get("chatSettings").chatDomain,h.launchChatWindow(this.options))},"onDestroy":function(){var t=this.options.targetEle;t&&e(t).is(":visible")?e(t).trigger("focus"):t||(t=e(".nav-profile"))&&t.length&&t.trigger("focus"),this.$el.find(".esoc-simple-user-profile-pic-update").off("keydown"),this.$el.hasClass("csui-dialog-page-reload")&&location.reload()},"closeSimpleUserWidget":function(t){if(!this.processKeyEvent(t)){e(t.target).trigger("click")}},"processKeyEvent":function(e){if("keydown"===e.type){var t=e.keyCode||e.which;if(32!==t&&13!==t)return!0}return!1},"_assignUserColor":function(){var e=l.getUserAvatarColor(this.model.attributes);this.ui.initialsPlaceholder.css("background","#FFFFFF"),this.ui.initialsPlaceholder.css("color",e)}})}),csui.define("hbs!esoc/widgets/userwidget/impl/userwidget",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return' \x3c!-- For user show mini profile and user profile --\x3e\r\n  <a href="javascript:void(0);" class="esoc-user-container\r\n  '+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showUserProfilePicture:n,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"\r\n    "+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showUserProfileLink:n,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+"\r\n    "+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showMiniProfile:n,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+"\r\n    "+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userWidgetWrapperClass:n,e))+'">\r\n\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showUserProfilePicture:n,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showUserDisplayName:n,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+"\r\n  </a>\r\n"},"2":function(e,t,i,s){return"esoc-user-profile-pic-container"},"4":function(e,t,i,s){return" esoc-user-profile-link "},"6":function(e,t,i,s){return" esoc-user-mini-profile "},"8":function(e,t,i,s){var n,o;return'      <span class="image_user_placeholder esoc-userwidget-default-avatar esoc-user-default-avatar-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userid:n,e))+'">'+this.escapeExpression((o=null!=(o=t.initials||(null!=e?e.initials:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"initials","hash":{}}):o))+'</span>\r\n      <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userid:n,e))+' binf-img-circle esoc-user-widget-avatar" alt="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'" src="#">\r\n'},"10":function(e,t,i,s){var n,o;return'      <span class="esoc-user-display-name" id="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.uniqueId:n,e))+'">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showPresenceIndicator:n,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"        "+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+"\r\n    </span>\r\n"},"11":function(e,t,i,s){var n;return'      <span id="user-presence-indicator-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userid:n,e))+'" class="user-presence-indicator"></span>\r\n'},"13":function(e,t,i,s){var n;return' \x3c!-- For group show only plain text and/or image without any miniprofile or user profile--\x3e\r\n  <span class="esoc-group-container '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userWidgetWrapperClass:n,e))+'">\r\n\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showUserProfilePicture:n,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showUserDisplayName:n,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+"\r\n  </span>\r\n"},"14":function(e,t,i,s){var n,o;return'      <span class="image_group_placeholder esoc-userwidget-default-avatar esoc-user-default-avatar-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userid:n,e))+'"></span>\r\n      <img class="esoc-userprofile-img-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.userid:n,e))+' binf-img-circle esoc-user-widget-avatar" alt="'+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+'" src="#">\r\n'},"16":function(e,t,i,s){var n,o;return'      <span class="esoc-user-group-name" id="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.uniqueId:n,e))+'">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.messages:e)?n.showPresenceIndicator:n,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"        "+this.escapeExpression((o=null!=(o=t.display_name||(null!=e?e.display_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"display_name","hash":{}}):o))+"\r\n    </span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.type === 0",{"name":"xif","hash":{},"fn":this.program(1,s,0),"inverse":this.program(13,s,0)}))?n:""}});return i.registerPartial("esoc_widgets_userwidget_impl_userwidget",s),s}),csui.define("esoc/controls/userwidget/userwidget.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/user","csui/utils/user.avatar.color","esoc/widgets/userwidget/model/userwidget.model","esoc/widgets/userwidget/view/miniprofile.view","esoc/widgets/userwidget/view/userprofile.view","esoc/widgets/userwidget/view/simple.userwidget.view","esoc/widgets/userwidget/userprofile","esoc/widgets/userwidget/util","hbs!esoc/widgets/userwidget/impl/userwidget","i18n!esoc/widgets/userwidget/nls/lang","esoc/widgets/userwidget/chat/chatfactory","css!esoc/widgets/userwidget/impl/userwidget.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f){var g=null;return n.ItemView.extend({"tagName":"span","className":"esoc-userwidget-wrapper","template":p,"util":m,"ui":{"initialsPlaceholder":".image_user_placeholder"},"templateHelpers":function(){return{"messages":{"showPresenceIndicator":this.options.showPresenceIndicator,"showMiniProfile":this.options.showMiniProfile,"showUserProfileLink":this.options.showUserProfileLink,"showUserProfilePicture":this.showProfilePic,"showUserDisplayName":!this.showProfilePic,"userWidgetWrapperClass":this.options.userWidgetWrapperClass,"myProfile":h.myProfile,"othersProfile":h.othersProfile,"userid":this.options.userid,"uniqueId":i.uniqueId(),"xFrame":this.options.xFrame}}},"initialize":function(e){this.options=e;var t=this.options.context.getModel(o).get("id")||this.options.loggedUserId;this.options.model.attributes.otherUser=parseInt(t,10)!==parseInt(this.options.userid,10),g=this,void 0!==this.options.showPresenceIndicator&&this.options.showPresenceIndicator&&setInterval(this.getCurrentUserStatus(),5e3),this.showProfilePic=!!this.options.showUserWidgetFor&&"profilepic"===this.options.showUserWidgetFor},"onRender":function(e){if(!this.options.unKnownUser&&this.showProfilePic&&void 0!==this.options.model.attributes.photo_url){var t={"userModel":this.options.model,"context":this.options.context,"userid":this.options.userid,"photoElement":this.$el.find('[class^="esoc-userprofile-img-'+m.escapeSelector(this.options.userid)+'"]'),"defaultPhotElement":this.$el.find(".esoc-user-default-avatar-"+m.escapeSelector(this.options.userid))};m.commonUtil.setProfilePic(t)}this.options.showMiniProfile&&this.$el.find(".esoc-user-mini-profile").trigger("mouseover",{"stopPropagation":!0})},"getCurrentUserStatus":function(){},"events":{"click .esoc-user-profile-link":"showUserProfileDialog","keydown .esoc-user-profile-link":"showUserProfileDialogWithSpaceKey","mouseover .esoc-user-mini-profile":"showMiniProfilePopup"},"showUserProfileDialogWithSpaceKey":function(e){32===(e.keyCode||e.which)&&(e.preventDefault(),t(e.currentTarget).trigger("click"))},"showMiniProfilePopup":function(e,t){if(0===this.model.attributes.type){var i=e||window.event;t&&t.stopPropagation&&i.stopPropagation(),this.options.targetEle=i.target,this.options.userWidgetView=this,this.options.userprofileView=c;new r(this.options).render(e)}},"showUserProfileDialog":function(e){if(0===this.model.attributes.type){e&&(this.options.targetEle=e.currentTarget),this.options.originatingView&&this.options.originatingView.disengageModalKeyboardFocusOnClose&&this.options.originatingView.disengageModalKeyboardFocusOnClose(),m.showUserProfileDialog(this,c,d);m.userStack.length>0&&m.userStack[m.userStack.length-1].model.id===this.model.id||m.userStack.push(this)}},"constructor":function(t){var i=this;if(t=t||{},t=this.setDefaultWidgetOptions(t),f.initializeApplication(t),t.model)t.model.connector=t.connector,t.model.userid=t.model.attributes.id,t.model.attributes.userid=t.model.attributes.id;else{var s={"userid":t.userid,"connector":t.connector,"context":t.context};t.model=m.commonUtil.getUserWidgetModel(s),this.isUserModelLoaded=!1,t.model.ensureFetched().done(function(){"extendedInfoText"===t.source&&(i.$el?t.parentView.trigger("view:shown"):(i.isUserModelLoaded=!0,i.parentView=t.parentView)),t.model.userid=t.model.attributes.id,t.model.attributes.userid=t.model.attributes.id,t.model.attributes.department_name=t.model.attributes.group_id?t.model.attributes.group_id.name:""})}var o=e.config();o&&(void 0!==o.enableSimpleUserProfile&&(t.enableSimpleSettingsModel=o.enableSimpleUserProfile),void 0!==o.enableProfilePicture&&(t.enableUploadProfilePicture=o.enableProfilePicture)),n.ItemView.prototype.constructor.call(this,t),this.model.on("change",this.render,this),this.model.on("error",this.errorHandle,this),this.listenTo(this,"render",this._assignUserColor)},"onShow":function(){this.isUserModelLoaded&&this.parentView&&(this.parentView.isUserModelLoaded=!0)},"setDefaultWidgetOptions":function(e){return e.unKnownUser=-3===e.userid,e.showMiniProfile=!e.unKnownUser&&!!e.showMiniProfile&&e.showMiniProfile,e.showUserProfileLink=!e.unKnownUser&&!!e.showUserProfileLink&&e.showUserProfileLink,e.showPresenceIndicator=!e.unKnownUser&&!1,e},"errorHandle":function(e,t){},"_assignUserColor":function(){var e=a.getUserAvatarColor(this.model.attributes);this.ui.initialsPlaceholder.css("background",e)}})}),csui.define("esoc/widgets/utils/commentdialog/commentdialog.model",["csui/lib/backbone","csui/utils/url","esoc/widgets/common/util","csui/models/mixins/resource/resource.mixin"],function(e,t,i,s){var n=e.Model.extend({"defaults":{"attachementsEnabled":!0,"chatEnabled":!0,"commentingOpen":!0,"commentsEnabled":!0,"likesEnabled":!0,"taggingEnabled":!0,"threadingEnabled":!0,"csid":"","commentCount":0},"connector":"","commonUtil":i,"constructor":function(t,i){this.defaults.csid=i.nodeid,this.options=i||{},e.Model.prototype.constructor.apply(this,arguments),i&&i.connector&&i.connector.assignTo(this),this.makeResource(i)},"url":function(){var e=t.combine(this.connector.connection.url,this.commonUtil.REST_URLS.csGetROI);return e+="csid="+this.options.csid+"&includes=comment_count"},"parse":function(e){var t=JSON.parse(JSON.stringify(e.available_settings)),i={"socialactions":t};return i.id=t.CSID,i.showSocialActions=t.pulseEnabled,i.wnd_comments=t.commentCount,i.wnd_comments_validated=t.commentCount>0?t.commentCount>99?"99+":t.commentCount:"",i}});return s.mixin(n.prototype),n}),csui.define("hbs!esoc/widgets/tablecell/impl/tablecell",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <span class="esoc-social-actions-widget-area esoc-column-social" data-csid="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.socialactions:e)?n.commentsEnabled:n,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"  </span>\r\n"},"2":function(e,t,i,s){var n,o;return'      <span class="esoc-column-social-comment-wrapper">\r\n      <span class="esoc-socialactions-comment"\r\n            data-value="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"wnd_comments_title","hash":{}}):o))+'">\r\n\t\t<span class="esoc-socialactions-comment-container">\t\r\n          <a href="javascript:void(0);" class="cs-icon cs-icon-comment"\r\n             title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.addComments:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.addComments:n,e))+'"></a>\r\n\t\t</span>   \r\n          <span title="'+this.escapeExpression((o=null!=(o=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"wnd_comments_title","hash":{}}):o))+'"\r\n                class="cs-text wnd_comments_validated" data-csid="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.wnd_comments_validated||(null!=e?e.wnd_comments_validated:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"wnd_comments_validated","hash":{}}):o))+'</span>\r\n      </span>\r\n      <span class="binf-sr-only">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.addAComment:n,e))+"</span>\r\n    </span>\r\n"},"4":function(e,t,i,s){var n;return'  <span class="esoc-socialactions-comment" data-value="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"\r\n        aria-label="'+this.escapeExpression((n=null!=(n=t.wnd_no_comments||(null!=e?e.wnd_no_comments:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_no_comments","hash":{}}):n))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.showSocialActions:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(4,s,0)}))?n:""}});return i.registerPartial("esoc_widgets_tablecell_impl_tablecell",s),s}),csui.define("esoc/factory/commentmodelfactory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","esoc/widgets/utils/commentdialog/commentdialog.model"],function(e,t,i,s,n,o){"use strict";return s.extend({"propertyPrefix":"comment","constructor":function(a,l){s.prototype.constructor.apply(this,arguments);var r=this.options.comment||{},c=e.config();if(!(r instanceof i.Model)){var d={"connector":this.options.connector||a.getObject(n,l),"csid":this.options.attributes.id};r=new o(r.attributes,t.extend(d,r.options,c.options))}this.property=r},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("esoc/widgets/tablecell/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/widgets/tablecell/nls/root/lang",{"addComments":"Comments","addAComment":"Add a comment","commentCount":"comments","noComments":"No comments","oneComment":"comment"}),csui.define("esoc/widgets/utils/commentdialog/commentdialog.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/connector","esoc/widgets/utils/commentdialog/commentdialog.model","hbs!esoc/widgets/tablecell/impl/tablecell","esoc/widgets/socialactions/commentscollectionwidget","esoc/widgets/common/util","esoc/factory/commentmodelfactory","csui/utils/log","csui/utils/url","i18n!esoc/widgets/tablecell/nls/lang","css!esoc/widgets/socialactions/socialactions.css","css!esoc/widgets/tablecell/impl/social.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m){var p=null;return s.ItemView.extend({"className":"esoc-socialactions-wrapper","template":a,"templateHelpers":function(){return{"messages":{"addComments":m.addComments},"wnd_comments_title":this.model.attributes.wnd_comments>0?this.model.attributes.wnd_comments>1?this.model.attributes.wnd_comments+" "+m.commentCount:this.model.attributes.wnd_comments+" "+m.oneComment:""}},"initialize":function(t){this.options=t,p=this,e(document).on("keydown click",this.closeCommentDialog)},"events":{"click .esoc-socialactions-comment .cs-icon-comment":"onClickComments"},"log":d,"commonUtil":r,"constructor":function(e){if(e=e||{},e.connector=e.connector?e.connector:e.context.getObject(n),e.model){this.updateSocailActions(e.model);var t=e.model.attributes.wnd_comments>0?e.model.attributes.wnd_comments>99?"99+":e.model.attributes.wnd_comments:"";e.model=new o({"wnd_comments_validated":t,"wnd_comments":e.model.attributes.wnd_comments,"socialactions":e.model.attributes.socialactions,"id":e.model.attributes.id,"showSocialActions":e.model.attributes.showSocialActions},{"connector":e.connector,"csid":e.nodeid})}else e.model=e.context.getModel(c,{"attributes":{"id":e.nodeid},"connector":e.connector}),e.model.ensureFetched();s.ItemView.prototype.constructor.call(this,e),this.model.on("change",this.render,this),this.model.on("error",this.errorHandle,this)},"errorHandle":function(e,t){var i=t.responseJSON?t.responseJSON.errorDetail?t.responseJSON.errorDetail:t.responseJSON.error:m.defaultErrorMessageCommentsFetch;p.log.info("Error Occured :"+i)},"updateSocailActions":function(e){var t=!!e.actions.get("comment");e.attributes.showSocialActions=t,e.attributes.socialactions={"attachementsEnabled":t,"chatEnabled":t,"commentingOpen":t,"commentsEnabled":t,"CSID":e.attributes.id,"likesEnabled":t,"taggingEnabled":t,"threadingEnabled":t,"shortcutEnabled":t}},"onClickComments":function(t){var i={"tablecellwidget":!0,"currentNodeModel":this.model,"baseElement":this.$el.find(".esoc-socialactions-comment"),"currentTarget":t.currentTarget,"socialActionsInstanse":this,"nodeID":this.options.CSID,"context":this.options.context},s=i.nodeID;i.csId=s;var n={"url":u.combine(r.getV2Url(this.options.connector.connection.url),"nodes",s),"type":"GET","connector":this.options.connector,"currentNodeModel":this.model,"requestType":"updateCommentCount"};r.updateAjaxCall(n);var o,a=u.combine(this.options.connector.connection.url,this.commonUtil.REST_URLS.csGetROI)+"CSID="+s;e.ajax(this.options.connector.extendAjaxOptions({"type":"GET","async":!1,"cache":!1,"url":a,"success":function(e){o=JSON.parse(JSON.stringify(e.available_settings))},"error":function(){p.log.error("Error while getting available settings")}})),this.model.attributes.socialactions=o,i.socialActionsInstanse.options.connector.connection.url=this.options.connector.connection.url,new l(i).show(),e(document.activeElement).trigger("blur")}})}),csui.define("esoc/widgets/utils/commentdialog/commentdialog",["module","require","csui/lib/jquery","csui/lib/marionette","csui/utils/connector","esoc/widgets/utils/commentdialog/commentdialog.view","csui/utils/contexts/factories/connector"],function(e,t,i,s,n,o,a){return{"getCommentButton":function(e){e.connector||(e.connector=e.context.getObject(a)),i(e.placeholder).ready(function(){var t=new s.Region({"el":i(e.placeholder)}),n=new o({"connector":e.connector,"CSID":e.nodeid,"baseElement":i(e.placeholder),"context":e.context});t.show(n)})}}}),csui.define("hbs!esoc/widgets/utils/command/comment/comment.toolitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return""},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.icon:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(12,s,0)}))?n:""},"4":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.renderIconAndText:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?n:""},"5":function(e,t,i,s){var n;return'      <a href="#" class="needsclick csui-acc-focusable" tabindex="-1" data-cstabindex="-1"\r\n         aria-label="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'">\r\n        <span class="'+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" data-cstabindex="-1"></span>\r\n        <span>'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n        <span title="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'"\r\n              class="cs-text wnd-comment-count wnd_comments_validated" data-csid="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.wnd_comments_validated||(null!=e?e.wnd_comments_validated:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_validated","hash":{}}):n))+"</span>\r\n      </a>\r\n"},"7":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.renderTextOnly:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:""},"8":function(e,t,i,s){var n;return'        <a href="#" class="needsclick csui-acc-focusable" tabindex="-1" data-cstabindex="-1"\r\n           aria-label="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'">\r\n          <span>'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n          <span title="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'"\r\n                class="cs-text wnd-comment-count wnd_comments_validated" data-csid="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.wnd_comments_validated||(null!=e?e.wnd_comments_validated:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_validated","hash":{}}):n))+"</span>\r\n        </a>\r\n"},"10":function(e,t,i,s){var n;return'        <a href="#" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" class="needsclick csui-acc-focusable" tabindex="-1"\r\n           data-cstabindex="-1" aria-label="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'">\r\n          <span class="'+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" data-cstabindex="-1"></span>\r\n          <span title="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'"\r\n                class="cs-text wnd-comment-count wnd_comments_validated" data-csid="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.wnd_comments_validated||(null!=e?e.wnd_comments_validated:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_validated","hash":{}}):n))+"</span>\r\n        </a>\r\n"},"12":function(e,t,i,s){var n;return'    <a href="#" class="needsclick csui-acc-focusable" tabindex="-1" data-cstabindex="-1"\r\n       aria-label="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n      <span title="'+this.escapeExpression((n=null!=(n=t.wnd_comments_title||(null!=e?e.wnd_comments_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_title","hash":{}}):n))+'"\r\n            class="cs-text wnd-comment-count wnd_comments_validated" data-csid="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.wnd_comments_validated||(null!=e?e.wnd_comments_validated:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"wnd_comments_validated","hash":{}}):n))+"</span>\r\n    </a>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isSeparator:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("esoc_widgets_utils_command_comment_comment.toolitem",s),s}),csui.define("esoc/widgets/utils/command/comment/comment.toolitem.view",["module","csui/lib/jquery","csui/lib/underscore","csui/utils/log","hbs!esoc/widgets/utils/command/comment/comment.toolitem","csui/controls/toolbar/toolitem.view","i18n!esoc/widgets/tablecell/nls/lang"],function(e,t,i,s,n,o,a){return o.extend({"tagName":"li","template":n,"templateHelpers":function(){var e=this.model.attributes.commandData.wnd_comments;return{"renderIconAndText":!0===this.options.renderIconAndText,"renderTextOnly":!0===this.options.renderTextOnly,"isSeparator":this.model.isSeparator(),"id":this.model.attributes.commandData.id,"wnd_comments_title":this._getCommentsTitle(e),"wnd_comments_validated":e>99?"99+":e>0?e:""}},"constructor":function(){o.prototype.constructor.apply(this,arguments)},"_getCommentsTitle":function(e){return Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},e=Number.isInteger(e)?e:0,1!==e?e+" "+a.commentCount:"1 "+a.oneComment}})}),csui.define("esoc/commands/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/commands/nls/root/lang",{"commentLabel":"Comment"}),csui.define("esoc/commands/comment/comment.command",["require","csui/lib/marionette","csui/lib/jquery","csui/lib/underscore","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/command.error","csui/utils/url","i18n!esoc/commands/nls/lang"],function(e,t,i,s,n,o,a,l,r){"use strict";return o.extend({"constructor":function(e,t){o.prototype.constructor.call(this,arguments);var i=this;csui.require(["esoc/widgets/utils/command/comment/comment.toolitem.view"],function(e){i.customView=e})},"defaults":{"signature":"Comment","command_key":["comment","Comment"],"scope":"single","name":r.name,"verb":r.verb,"doneVerb":r.doneVerb},"enabled":function(e){var t;return e&&e.data?(t=e.data.useContainer?e.container:n.getJustOneNode(e))&&e.toolItem&&e.toolItem.set({"commandData":s.defaults({"wnd_comments":t.get("wnd_comments"),"id":t.get("id"),"customView":this.customView},e.toolItem.get("commandData"))}):t=n.getJustOneNode(e),t&&!!t.actions.get("comment")},"execute":function(e,t){var o=e.data&&e.data.useContainer?e.container:n.getJustOneNode(e),r=i.Deferred();return csui.require(["esoc/widgets/socialactions/commentscollectionwidget","esoc/widgets/common/util"],function(t,i){var n,c=void 0!==window.require?window.require.s.contexts._.config:window.csui.require.s.contexts._.config,d=s.extend(c,{"tablecellwidget":!0,"currentNodeModel":o,"nodeID":o.get("id"),"CSID":o.get("id"),"context":e.context,"baseElement":e.toolItemView.$el,"connector":o.connector,"currentTarget":document.activeElement}),u=l.combine(o.connector.connection.url,i.REST_URLS.csGetROI)+"CSID="+d.CSID;o.connector.makeAjaxCall({"type":"GET","cache":!1,"url":u,"success":function(e){n=JSON.parse(JSON.stringify(e.available_settings)),o.attributes.socialactions=n,d.socialActions=n,d.baseElement.dataset={"value":o.get("id")},new t(d).show(),r.resolve()},"error":function(e,t){r.reject(new a(t))}})},function(e){r.reject(new a(e))}),r.promise()}})}),csui.define("esoc/commands/open.roi",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,t){return t.extend({"defaults":{"signature":"OpenROI"},"enabled":function(t){var i=e.getJustOneNode(t);return i&&952===i.get("type")},"getUrlQueryParameters":function(e,t){return{"func":"ll","objAction":"info","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("esoc/widgets/utils/esocactionitems",[],function(){"use strict";return[{"type":952,"signature":"OpenROI","sequence":20}]}),csui.define("css!esoc/widgets/utils/esocnodesprites",[],function(){}),csui.define("esoc/widgets/utils/esocnodesprites",["css!esoc/widgets/utils/esocnodesprites"],function(){"use strict";return[{"equals":{"type":951},"className":"csui-icon esoc-icon-pulse-roc","mimeType":"Remote Object Container","sequence":100},{"equals":{"type":952},"className":"csui-icon esoc-icon-pulse-roi","mimeType":"Remote Object Instance","sequence":100},{"equals":{"type":907},"className":"csui-icon esoc-icon-activity-manager","sequence":1e3}]}),csui.define("hbs!esoc/widgets/socialactions/socialactions",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <span class="esoc-socialactions-getcomments" data-value="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.socialactions:e)?n.CSID:n,e))+'">\r\n            <div class="binf-btn binf-btn-primary"> '+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.comments:n,e))+" </div>\r\n        </span>\r\n"},"3":function(e,t,i,s){return'      <span>\r\n        <div class="binf-btn binf-btn-success">Like</div>\r\n      </span>\r\n'},"5":function(e,t,i,s){return'      <span>\r\n        <div class="binf-btn btn-binf-warning">Tag</div>\r\n      </span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n
;return'<span>\r\n  <div class="esoc-error-socialactions" style="display: none;">\r\n    <div class="binf-panel-danger">\r\n      <div class="binf-panel-heading">\r\n        <h4 class="binf-panel-title"></h4>\r\n      </div>\r\n    </div>\r\n  </div>\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.socialactions:e)?n.commentsEnabled:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"  \x3c!--\r\n"+(null!=(n=t.if.call(e,null!=(n=null!=e?e.socialactions:e)?n.likesEnabled:n,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=(n=null!=e?e.socialactions:e)?n.taggingEnabled:n,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+"  --\x3e\r\n</span>\r\n"}});return i.registerPartial("esoc_widgets_socialactions_socialactions",s),s}),csui.define("esoc/widgets/socialactions/socialactions.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","esoc/widgets/socialactions/socialactions.model","i18n!esoc/widgets/socialactions/nls/lang","hbs!esoc/widgets/socialactions/socialactions","esoc/widgets/socialactions/commentscollectionwidget","css!esoc/widgets/socialactions/socialactions.css"],function(e,t,i,s,n,o,a,l){var r=null;return s.ItemView.extend({"className":"esoc-socialactions-wrapper panel panel-default","template":a,"templateHelpers":function(){return{"messages":{"comments":o.comments}}},"initialize":function(t){this.options=t,r=this,e(document).on("keydown click",this.closeCommentDialog)},"events":{"click .esoc-socialactions-getcomments":"getComments","click .esoc-socialactions-getlikes":"getLikes","click .esoc-socialactions-gettags":"getTags"},"constructor":function(e){e=e||{},e.model||(e.model=new n(void 0,{"connector":e.connector,"rockey":e.rockey,"roid":e.roid,"csid":e.csid}),e.model.fetch()),s.ItemView.prototype.constructor.call(this,e),this.model.on("change",this.render,this),this.model.on("error",this.errorHandle,this)},"errorHandle":function(e,t){this.$el.find(".esoc-error-socialactions").show(),this.$el.find(".binf-panel-title").html(t.responseJSON.error)},"getComments":function(e){var t={"baseElement":this.$el.find(".esoc-socialactions-getcomments"),"socialActionsInstanse":this,"maxMessageLength":this.options.maxMessageLength,"context":this.options.context};new l(t).show()}})}),csui.define("esoc/widgets/socialactions/socialactions.main",["module","require","csui/lib/jquery","csui/lib/marionette","csui/utils/connector","csui/utils/namedsessionstorage","esoc/widgets/socialactions/socialactions.view","csui/utils/contexts/factories/connector"],function(e,t,i,s,n,o,a,l){function r(e){e.connector||(e.connector=e.context.getObject(l));var t=new o;i(e.placeholder).ready(function(){i(e.placeholder).each(function(){var n=new s.Region({"el":i(this)}),o=i(this).data("rockey"),l=i(this).data("roid");void 0!==t.get(o+l)&&t.get(o+l).length>0&&i(this).attr("data-csid",t.get(o+l));var r=new a({"connector":e.connector,"context":e.context,"rockey":o,"roid":l,"csid":i(this).data("csid"),"baseElement":i(this),"maxMessageLength":e.config_settings.maxMessageLength});n.show(r)})})}return r}),csui.define("esoc/widgets/activityfeedwidget/activityfeedwidget.view",["csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","esoc/widgets/activityfeedwidget/object/object.view","csui/controls/tile/tile.view","csui/behaviors/limiting/limiting.behavior","csui/controls/tile/behaviors/expanding.behavior","csui/behaviors/default.action/default.action.behavior","csui/lib/jquery","csui/utils/connector","esoc/widgets/activityfeedwidget/activityfeed.model","esoc/widgets/activityfeedwidget/activityfeed.view","esoc/widgets/activityfeedwidget/activityfeedwithfilter.view","esoc/widgets/activityfeedwidget/activityfeedfactory","i18n!esoc/widgets/activityfeedwidget/impl/nls/lang","esoc/widgets/activityfeedwidget/util","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","css!esoc/widgets/activityfeedwidget/activityfeed.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h,f,g,v){return n.extend({"constructor":function(e){e||(e={}),e.title=e.title||h.dialogTitle,e.icon=e.titleBarIcon||"title-activityfeed",f.commonUtil.fillDefaultActivityOptions(e),n.prototype.constructor.apply(this,arguments)},"initialize":function(t){t=t.data?e.extend(t,t.data):t,delete t.data,this.options=t,void 0!==this.options.feedtype&&(p.prototype.propertyPrefix=f.commonUtil.getActivityWidgetId(this.options),p.prototype.uniqueid=f.commonUtil.getActivityWidgetId(this.options)),void 0!==this.options.wrapperClass&&this.$el.addClass(this.options.wrapperClass),this.collection=t.context.getCollection(p,t),this.contentViewOptions=e.extend(this.options,{"collection":this.collection}),v.mixin(p),g.mixin(p)},"childEvents":{"click:item":"onClickItem"},"events":{"keydown .icon-tileExpand":"onKeydownHeader"},"contentView":s,"behaviors":{"Expanding":{"titleBarIcon":function(){return this.options.icon||"title-activityfeed"},"behaviorClass":a,"expandedView":m,"dialogTitle":function(){return this.options.title||h.dialogTitle},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"activityfeed-expand esoc","expandedViewOptions":function(){return e.extend(this.options,{"collection":this.collection})}},"DefaultAction":{"behaviorClass":l}},"onClickItem":function(e){this.triggerMethod("execute:defaultAction",e.model)},"onClickHeader":function(e){this.triggerMethod("expand")},"onKeydownHeader":function(e){var t=e.keyCode||e.which;32!==t&&13!==t||this.triggerMethod("expand")},"onDomRefresh":function(){var e=this.$el.find(".icon-tileExpand");e.attr("title",h.expandTitle),e&&r(e).length&&r(e[0]).attr("tabindex",0)}})}),csui.define("esoc/widgets/tablecell/server.adaptor.mixin",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","esoc/widgets/common/util"],function(e,t,i,s){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.attributes.csId,t=this.attributes.currentNodeModel,n=this.connector,o=t.get("parent_id"),a=o&&o instanceof Object?o.id:o,l=s.updateQueryStringValues(i.combine(s.getV2Url(n.connection.url),"nodes",a,"nodes"),"where_name",t.get("name")),r={"url":l,"type":"GET","currentNodeModel":t,"connector":n,"requestType":"getCommentCount"};return s.updateAjaxCall(r),i.combine(t.connector.connection.url,s.REST_URLS.csGetROI)+"CSID="+e},"sync":function(e,i,s){return s.cache=!1,t.Model.prototype.sync.apply(this,arguments)}})}}}),csui.define("esoc/widgets/tablecell/tablecell.model",["csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin","esoc/widgets/tablecell/server.adaptor.mixin"],function(e,t,i,s,n,o){"use strict";var a=e.Model.extend({"constructor":function(t,i){e.Model.prototype.constructor.call(this,t,i),this.makeResource(i).makeIncludingAdditionalResources(i).makeUploadable(i).makeExpandable(i).makeServerAdaptor(i)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return n.mixin(a.prototype),t.mixin(a.prototype),s.mixin(a.prototype),i.mixin(a.prototype),o.mixin(a.prototype),a}),csui.define("esoc/widgets/tablecell/tablecell.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/controls/table/table.columns","csui/utils/url","csui/utils/log","hbs!esoc/widgets/tablecell/impl/tablecell","esoc/widgets/socialactions/commentscollectionwidget","esoc/widgets/tablecell/tablecell.model","esoc/widgets/common/util","i18n!esoc/widgets/tablecell/nls/lang","css!esoc/widgets/tablecell/impl/social.css","css!esoc/widgets/socialactions/socialactions.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p,h){i.registerHelper("value-if",function(t,i,s){return e.isObject(s)&&e.isObject(s.hash)&&(s=""),t?i:s});var f=o.extend({"className":"csui-nowrap","template":d,"title":"","events":{"keydown":"onKeyInView","click .esoc-socialactions-comment .cs-icon-comment":"onClickComment"},"log":c,"commonUtil":p,"constructor":function(){o.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"getValueData":function(){var e=this.model&&this.model.collection&&this.model.collection.delayedActions,t=this;return this.updateSocailActions(this.model),e&&this.listenTo(e,"sync",function(){t.updateSocailActions(t.model),t.render()}),this.model.attributes.messages=h,this.model.attributes.wnd_comments_title=this.model.attributes.wnd_comments>0?this.model.attributes.wnd_comments>1?this.model.attributes.wnd_comments+" "+h.commentCount:this.model.attributes.wnd_comments+" "+h.oneComment:"",this.model.attributes.wnd_comments_validated=this.model.attributes.wnd_comments>0?this.model.attributes.wnd_comments>99?"99+":this.model.attributes.wnd_comments:"",this.model.attributes.wnd_no_comments=h.noComments,this.model.toJSON()},"updateSocailActions":function(e){var t=!!e.actions.get("comment");e.attributes.showSocialActions=t,e.attributes.socialactions={"attachementsEnabled":t,"chatEnabled":t,"commentingOpen":t,"commentsEnabled":t,"CSID":e.attributes.id,"likesEnabled":t,"taggingEnabled":t,"threadingEnabled":t,"shortcutEnabled":t}},"onClickComment":function(e){this.options.connector=this.options.connector||this.options.context.getObject(n);var i={"tablecellwidget":!0,"currentNodeModel":this.model,"currentTarget":t(e.currentTarget).closest("td"),"baseElement":this.$el.find(".esoc-socialactions-comment"),"socialActionsInstanse":this},s=this.$el.find(".esoc-socialactions-comment")[0],o=s.getAttribute("data-value")||s.dataset.value;i.csId=o,new m({"csId":o,"currentNodeModel":this.model},{"connector":this.options.connector}).fetch().then(function(e){this.model.attributes.socialactions=e.available_settings,i.socialActionsInstanse.options.connector.connection.url=this.options.connector.connection.url,new u(i).show()}.bind(this),function(e,t,i){this.log.error("TEMP.  ERROR Getting available settings")}.bind(this))},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){!!this.model.actions.get("comment")&&(e.preventDefault(),this.onClickComment(e))}}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-esoc-social"});a.registerByColumnKey("wnd_comments",f),l.add({"key":"wnd_comments","sequence":905,"permanentColumn":!0})}),csui.define("esoc/widgets/tablecell/thumbnail.content.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/handlebars","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/thumbnail.content","csui/utils/url","csui/utils/log","hbs!esoc/widgets/tablecell/impl/tablecell","esoc/widgets/socialactions/commentscollectionwidget","esoc/widgets/tablecell/tablecell.model","esoc/widgets/common/util","i18n!esoc/widgets/tablecell/nls/lang","css!esoc/widgets/tablecell/impl/social.css","css!esoc/widgets/socialactions/socialactions.css"],function(e,t,i,s,n,o,a,l,r,c,d,u,m,p){i.registerHelper("value-if",function(t,i,s){return e.isObject(s)&&e.isObject(s.hash)&&(s=""),t?i:s});var h=s.ItemView.extend({"className":"csui-nowrap csui-thumbnail-test","template":c,"title":"","events":{"keydown":"onKeyInView","click .esoc-socialactions-comment .cs-icon-comment":"onClickComment"},"log":r,"commonUtil":m,"constructor":function(){s.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"templateHelpers":function(){var e=this.model.collection&&this.model.collection.delayedActions,t=this;return this.updateSocailActions(this.model),e&&this.listenTo(e,"sync",function(){t.updateSocailActions(t.model),t.render()}),this.model.attributes.messages=p,this.model.attributes.wnd_comments_title=this.model.attributes.wnd_comments>0?this.model.attributes.wnd_comments>1?this.model.attributes.wnd_comments+" "+p.commentCount:this.model.attributes.wnd_comments+" "+p.oneComment:"",this.model.attributes.wnd_comments_validated=this.model.attributes.wnd_comments>0?this.model.attributes.wnd_comments>99?"99+":this.model.attributes.wnd_comments:"",this.model.attributes.wnd_no_comments=p.noComments,this.model.toJSON()},"updateSocailActions":function(e){var t=!!e.actions.get("comment");e.attributes.showSocialActions=t,e.attributes.socialactions={"attachementsEnabled":t,"chatEnabled":t,"commentingOpen":t,"commentsEnabled":t,"CSID":e.attributes.id,"likesEnabled":t,"taggingEnabled":t,"threadingEnabled":t,"shortcutEnabled":t}},"onClickComment":function(e){this.options.connector||(this.options.connector=this.options.context.getObject(n));var i={"tablecellwidget":!0,"currentNodeModel":this.model,"currentTarget":t(e.currentTarget).closest("td"),"baseElement":this.$el.find(".esoc-socialactions-comment"),"socialActionsInstanse":this},s=this.$el.find(".esoc-socialactions-comment")[0],o=s.getAttribute("data-value")||s.dataset.value;i.csId=o,new u({"csId":o,"currentNodeModel":this.model},{"connector":this.options.connector}).fetch().then(function(e){this.model.attributes.socialactions=e.available_settings,i.socialActionsInstanse.options.connector.connection.url=this.options.connector.connection.url,new d(i).show()}.bind(this),function(e,t,i){this.log.error("TEMP.  ERROR Getting available settings")}.bind(this))},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){!!this.model.actions.get("comment")&&this.onClickComment(e)}}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-esoc-social"});o.registerByKey("wnd_comments",h),a.add({"key":"wnd_comments","sequence":905,"permanentColumn":!0})}),csui.define("json!esoc/widgets/activityfeedwidget/activityfeedwidget.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{title}}","description":"{{description}}","kind":"tile","schema":{"type":"object","properties":{"wrapperClass":{"title":"{{wrapperClassTitle}}","description":"{{wrapperClassDescription}}","type":"string","default":""},"feedsize":{"title":"{{feedSizeTitle}}","description":"{{feedSizeDescription}}","type":"number","default":20},"feedtype":{"title":"{{feedTypeTitle}}","description":"{{feedTypeDescription}}","type":"string","default":"all","enum":["all","content","status","attribute"]},"feedSettings":{"title":"{{feedSettingsTitle}}","description":"{{feedSettingsDescription}}","type":"object","properties":{"enableComments":{"title":"{{enableCommentsTitle}}","description":"{{enableCommentsDescription}}","type":"boolean","default":!0},"enableFilters":{"title":"{{enableFiltersTitle}}","description":"{{enableFiltersDescription}}","type":"boolean","default":!1}}},"honorfeedsource":{"title":"{{honorfeedsourceTitle}}","description":"{{honorfeedsourceDescription}}","type":"boolean","default":!1},"headerView":{"title":"{{headerViewTitle}}","description":"{{headerViewDescription}}","type":"boolean","default":!1},"feedsource":{"title":"{{feedsourceTitle}}","description":"{{feedsourceDescription}}","type":"object","properties":{"source":{"title":"{{sourceTitle}}","description":"{{sourceDescription}}","type":"string","default":"all","enum":["all","node","pulsefrom"]},"id":{"title":"{{feedsourceIdTitle}}","description":"{{feedsourceIdDescription}}","type":"string","default":""}}},"updatesfrom":{"title":"{{updatesfromTitle}}","description":"{{updatesfromDescription}}","type":"object","properties":{"from":{"title":"{{fromTitle}}","description":"{{fromDescription}}","type":"string","default":"all","enum":["all","iamfollowing","myfollowers","following","followers","myupdates","mentions","myfavorites","user","group"]},"id":{"title":"{{updatesfromIdTitle}}","description":"{{updatesfromIdDescription}}","type":"string","default":""}}},"config_settings":{"title":"{{configSettingsTitle}}","description":"{{configSettingsDescription}}","type":"object","properties":{"feedsAutoRefreshWait":{"title":"{{feedsAutoRefreshWaitTitle}}","description":"{{feedsAutoRefreshWaitDescription}}","type":"number","default":6e4},"maxMessageLength":{"title":"{{maxMessageLengthTitle}}","description":"{{maxMessageLengthDescription}}","type":"number","default":1e3}}}}}}),csui.define("esoc/widgets/activityfeedwidget/impl/nls/activityfeedwidget.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("esoc/widgets/activityfeedwidget/impl/nls/root/activityfeedwidget.manifest",{"title":"Activity Feed","description":"Shows activity feeds for the given option parameters.","wrapperClassTitle":"Wrapper class","wrapperClassDescription":"Wrapper class to be apply on top of activity feed list","feedSizeTitle":"Feed size","feedSizeDescription":"Number of feed items to be fetched per page","feedTypeTitle":"Feed type","feedTypeDescription":"Type of the feeds that should be consider","feedSettingsTitle":"Feed settings","feedSettingsDescription":"Feed settings to be considered","enableCommentsTitle":"Enable comments","enableCommentsDescription":"Whether to show comment button or not respective to each feed","enableFiltersTitle":"Enable filters","enableFiltersDescription":"Whether to show filter panel at left side or not in expanded view","honorfeedsourceTitle":"Honor feed source","honorfeedsourceDescription":"Whether to consider pulsefrom or consider widget options as feed source","headerViewTitle":"Header View","headerViewDescription":"Show feeds in horizontal view with dark theme","feedsourceTitle":"Feed source","feedsourceDescription":"Source for the feed to be considered","sourceTitle":"Source","sourceDescription":"Consider feed source as all or node or pulsefrom","feedsourceIdTitle":"id","feedsourceIdDescription":"Object id to be consider as feed source and applicable only when feedsource.source is either node or pulsefrom","updatesfromTitle":"Updates from","updatesfromDescription":"Feed updates from all/iamfollowing/myfollowers/following/followers/myupdates/mentions/myfavorites/user/group","fromTitle":"From","fromDescription":"Consider feed updates from different available sources","updatesfromIdTitle":"id","updatesfromIdDescription":"User id or group id and applicable only if updatesfrom.from is following/followers/user/group","configSettingsTitle":"Config settings","configSettingsDescription":"Widget instance level config settings","feedsAutoRefreshWaitTitle":"Activity feed auto refresh wait","feedsAutoRefreshWaitDescription":"Auto feed refresh interval time","maxMessageLengthTitle":"Maximum message length","maxMessageLengthDescription":"Maximum text length should be allowed while posting a comment or reply"}),csui.define("bundles/esoc-all",["esoc/controls/userwidget/userwidget.view","esoc/widgets/utils/commentdialog/commentdialog","esoc/widgets/utils/commentdialog/commentdialog.view","esoc/widgets/utils/command/comment/comment.toolitem.view","esoc/commands/comment/comment.command","esoc/commands/open.roi","esoc/widgets/utils/esocactionitems","esoc/widgets/utils/esocnodesprites","esoc/widgets/socialactions/socialactions.main","esoc/widgets/activityfeedwidget/activityfeedwidget.view","esoc/widgets/activityfeedwidget/activityfeedfactory","esoc/widgets/activityfeedwidget/activityfeedcontent","esoc/widgets/tablecell/tablecell.view","esoc/widgets/tablecell/thumbnail.content.view","esoc/widgets/userwidget/userwidget","json!esoc/widgets/activityfeedwidget/activityfeedwidget.manifest.json","i18n!esoc/widgets/activityfeedwidget/impl/nls/activityfeedwidget.manifest"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"esoc/bundles/esoc-all",!0)});
//# sourceMappingURL=esoc-all.js.map