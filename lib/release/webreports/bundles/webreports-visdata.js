csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanding.behavior",["require","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/tile/behaviors/expanding.behavior"],function(t,e,i,a,n){"use strict";function s(t){var i=this.options||{},a=i[t];return e.isFunction(a)?i[t].call(this.view):a}return n.extend({"_expand":function(){if(this.view&&this.view.contentView&&!this.view.contentView.collection.isEmpty()){var a=this.getOption("expandedView"),n=a.prototype instanceof i.View?a:a.call(this.view),l=["csui/controls/dialog/dialog.view"],r=this;e.isString(n)&&l.push(n),t(l,function(t){e.isString(n)&&(n=arguments[1]);var i=s.call(r,"expandedViewOptions"),a=new n(i);r._dialog=new t({"iconLeft":s.call(r,"titleBarIcon"),"imageLeftUrl":s.call(r,"titleBarImageUrl"),"imageLeftClass":s.call(r,"titleBarImageClass"),"title":s.call(r,"dialogTitle"),"iconRight":s.call(r,"dialogTitleIconRight"),"className":"cs-expanded "+(s.call(r,"dialogClassName")||""),"buttons":i.data.buttons,"largeSize":!0,"view":a}),r.listenTo(r._dialog,"hide",function(){r.triggerMethod("collapse"),i.data.isExpanded=!1}),i.data.isExpanded=!0,r.view.overlayVisible&&r.view.ui.toggleSettings.trigger("click"),r._dialog.show()})}}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/filtered.count.facets",["csui/lib/underscore","csui/lib/jquery","csui/models/facets"],function(t,e,i){"use strict";return i.extend({"constructor":function(t,e){i.prototype.constructor.apply(this,arguments),this.filters=e&&e.filters||[]},"addFilter":function(t){return this.filters.push(t),JSON.parse(JSON.stringify(this.filters))},"removeFilter":function(t,e){var i=this.filters[t];return i.values.splice(e,1),0===i.values.length&&this.filters.splice(t,1),JSON.parse(JSON.stringify(this.filters))},"clearFilters":function(){return this.filters&&this.filters.length>0&&(this.filters=[]),[]}})}),csui.define("webreports/utils/url.webreports",["csui/lib/underscore","csui/utils/url","csui/utils/contexts/factories/node"],function(t,e,i){return t.extend({"appendWebReportParameters":function(e,i){return t.isUndefined(i)||(e=t.isArray(i)?this.combineQueryString(e,this._serializeWebReportParameters(i)):this.combineQueryString(e,i)),e},"appendCurrentContainer":function(e,i){var a;return t.isUndefined(i)||(a=this.getCurrentContainerID(i))&&(e=this.combineQueryString(e,"csuiContainerID="+a)),e},"appendSWRCellID":function(t,e){var i;return e&&e.data&&e.data.swrLaunchCell&&e.data.swrLaunchCell.id&&("number"!=typeof(i=parseInt(e.data.swrLaunchCell.id,10))||isNaN(i)||(t=this.combineQueryString(t,"subwebreport_id="+i))),t},"getCurrentContainerID":function(e){var a,n=e.getModel(i);return t.isUndefined(n)||(a=n.get("id")),a},"_serializeWebReportParameters":function(e){var i="";return t.each(e,function(t){""!==t.name&&(i.length?i+="&"+t.name+"="+t.value:i+=t.name+"="+t.value)}),i},"getWebReportParametersAsData":function(e){var i={};return t.isArray(e)&&t.each(e,function(t){""!==t.name&&(i[t.name]=t.value)}),i},"getDataAsWebReportParameters":function(e){var i=[];return t.isObject(e)&&t.mapObject(e,function(t,e){i.push({"name":e,"value":t})}),i}},e)}),csui.define("webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.model",["csui/lib/underscore","csui/lib/backbone","webreports/utils/url.webreports","csui/models/mixins/connectable/connectable.mixin"],function(t,e,i,a){return e.Model.extend({"constructor":function(t,i){e.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/overlay.model",["csui/lib/underscore","csui/lib/backbone"],function(t,e){return e.Model.extend({"defaults":{"vis_type":"","active_column":"","active_column_formatted":"","count_column":"","column_names":[],"column_names_formatted":[],"sort_by":"Count","sort_order":"desc","view_value_as_percentage":!1,"group_after":10,"fc_filters":[]},"constructor":function(t,i){e.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.model",["csui/lib/backbone"],function(t){return t.Model.extend({"defaults":{"active_column":!1,"client_format":{"type":"none"},"column_key":"","count_column":!1,"data_type":10,"id":void 0,"name":"","tag_format":""},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.collection",["csui/lib/backbone","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.model"],function(t,e){return t.Collection.extend({"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)},"model":e})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/root/visual.data.lang",{"dialogTitle":"Visual Data Filtered Count","barChart":"Bar chart","pieChart":"Pie chart","donutChart":"Donut chart","scatterChart":"Scatter chart","areaChart":"Area chart","lineChart":"Line chart","chartType":"Chart type","activeColumn":"Active column","sortBy":"Sort by","total":"Total","count":"Count","totalCount":"Total Count","asc":"asc","desc":"desc","filters":"Filters","showValuesAs":"Show values as","groupAfter":"Group after","dontGroup":"Don't group","items":"items","actual":"Actual","percentage":"Percentage","update":"Update","cancel":"Cancel","launchReport":"Launch WebReport","launchReportTooltip":"Launch a classic WebReport in a new window using the current filter configuration.","tooManyRows":"Please refine your filter further. The maximum number of items that can be processed is ","noValue":"(No value)","invalidActiveColumn":"An invalid Active Column was specified.","emptyChartText":"No results found.","settings":"Settings"}),csui.define("webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.collection",["csui/lib/underscore","csui/lib/backbone","csui/lib/d3","csui/dialogs/modal.alert/modal.alert","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/filtered.count.facets","csui/models/facettopics","webreports/utils/url.webreports","webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.model","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/overlay.model","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.collection","csui/models/mixins/connectable/connectable.mixin","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","csui/utils/deepClone/deepClone"],function(t,e,i,a,n,s,l,r,o,c,u,d){var p=e.Collection.extend({"constructor":function(i,a){e.Collection.prototype.constructor.apply(this,arguments),t.isUndefined(a)&&(a={}),a&&a.id&&!this.id&&(this.id=a.id),this.options=a,this.makeConnectable(a),this.overlayModel=new o({"vis_type":a.type,"active_column":a.activeColumn,"sort_by":a.sortBy||"Count","sort_order":a.sortOrder||"desc","view_value_as_percentage":a.viewValueAsPercentage,"group_after":a.groupAfter,"fc_filters":a.filters||[]}),this.listenTo(this.overlayModel,"change",this.onOverlayUpdate)},"model":r,"url":function(){return this.connector.connection.url+"/nodes/"+this.id+"/output"},"parse":function(t){return t.data&&t.data.length>0?(this._isEmpty=!1,this._isFetched=!0,this.grouped_on_server=t.grouped_on_server||!1,this.sorted_on_server=t.sorted_on_server||!1,this.setColumns(t.columns),this._isResponseValid(t)?(t.grouped_on_server?(this.groupedData=t,t.fc_filters&&this.overlayModel.set({"fc_filters":t.fc_filters},{"silent":!0})):this.rawCollection=t.data,this.filteredData=this.sortGroupAndFilter(),this.filteredData):void 0):(this._isEmpty=!0,this._isFetched=!0,[])},"_isEmpty":!0,"_isFetched":!1,"isEmpty":function(){return this._isEmpty&&this._isFetched},"isFetched":function(){return this._isFetched},"_isResponseValid":function(t){var e=!0;return t.grouped_on_server||this._isActiveColumnValid(t)||(a.showError(d.invalidActiveColumn),e=!1),e},"_isActiveColumnValid":function(e){return!t.isUndefined(this._getCaseInsensitiveProperty(t.first(e.data),this.getActiveColumn()))},"filteredData":{},"rawCollection":{},"overlayModel":{},"getFilteredCountParms":function(){var e={};return e.filterable=!0===this.options.filterable,e.expandable=!0===this.options.expandable,t.extend(e,this.overlayModel.attributes),"ordinal"===e.sort_by&&(e.sort_by=e.active_column),e.fc_filters=JSON.stringify(e.fc_filters),e},"getFilteredCountQuery":function(){var e,i={},a=this.options.context||void 0,n=this.options.parameters||void 0;return t.isUndefined(n)||(i=t.extend(i,l.getWebReportParametersAsData(n))),e=l.getCurrentContainerID(a),t.isUndefined(e)||(i=t.extend(i,{"csuiContainerID":e})),i=t.extend(i,this.getFilteredCountParms())},"getActiveColumn":function(){var t,e;return this.columns&&(e=this.columns.findWhere({"active_column":!0}))&&(t=e.get("name")),t},"getCountColumn":function(){var t,e;return this.columns&&(e=this.columns.findWhere({"count_column":!0}))&&(t=e.get("name")),t},"getFilters":function(){return t.deepClone(this.overlayModel.get("fc_filters"))},"getSortOptions":function(){return{"sortBy":this.overlayModel.get("sort_by"),"sortOrder":this.overlayModel.get("sort_order")}},"getTotalCount":function(){return this.models.reduce(function(t,e){return t+e.get("value")},0)},"getPercentageOfTotal":function(t){return t/this.getTotalCount()*100},"getGroupAfter":function(){return this.overlayModel.get("group_after")},"mapFacetData":function(i){var a=[],l=this.columns.toJSON(),r=t.findWhere(l,{"active_column":!0}),o={},c={},u=[];o[r.id]=t.map(i,t.bind(function(e){return{"name":e.key_formatted||e.key,"value":t.isUndefined(e.key)?e.key_formatted:e.key,"total":e.value,"percentage":this.getPercentageOfTotal(e.value)}},this)),o[r.id]=t.reject(o[r.id],function(t){return"Other"===t.name}),a[0]=o,t.each(l,function(t){c[t.id]=t}),t.each(a,t.bind(function(i){var a,n=t.keys(i)[0],l=i[n],r={},o=-1,d=[];this.facetFilters&&this.facetFilters.filters&&(d=this._getAppliedFacetNames(),o=d.indexOf(c[n].name)),r[n]=c[n],c[n].name=c[n].name_formatted,a=new e.Model(c[n]),a.topics=-1===o?new s(l):new s,u.push(a)},this)),this.facetFilters?this.facetFilters.reset(u):this.facetFilters=new n(u)},"_getAppliedFacetNames":function(){return t.map(this.facetFilters.filters,t.bind(function(t){return this.getActiveColumnByFormattedName(t.facetName)},this))},"mapFilterData":function(e){return t.map(e,function(t){return{"facetName":t.column,"values":[{"topicName":t.value}]}})},"unmapFilterData":function(e){var i=t.map(e.values,function(t){return t.topicName});return i=this.resolveToActualValues(i),{"column":this.getActiveColumnByFormattedName(e.facetName),"operator":"IN","value":i}},"resolveToActualValues":function(e){var i,a=this.map(function(t){return t.get("key")});return this.models[0].has("key_formatted")?(i=this.map(function(t){return t.get("key_formatted")}),t.map(e,t.bind(function(t){var e=i.indexOf(t);return-1!==e&&(t=a[e]),t},this))):e},"addFilter":function(t){var e=this._getNextActiveColumn(),i=this.getFilters();i.push(this.unmapFilterData(t)),this.overlayModel.set({"fc_filters":i,"active_column":e,"active_column_formatted":this._getFormattedActiveColumnByName(e)})},"clearFilters":function(){var t=this._getNextActiveColumn();this.overlayModel.set({"fc_filters":[],"active_column":t,"active_column_formatted":this._getFormattedActiveColumnByName(t)})},"_getNextActiveColumn":function(){var e=this.overlayModel.get("column_names"),i=this._getAppliedFacetNames(),a=t.difference(e,i);return 0===a.length?t.first(i):0!==i.length?t.first(a):t.first(e)},"getActiveColumnByFormattedName":function(t){return this.columns.findWhere({"name_formatted":t}).get("name")},"_getFormattedActiveColumnByName":function(t){var e=this.columns.findWhere({"name":t});return e.get("name_formatted")||e.get("name")},"_getCaseInsensitiveProperty":function(e,i){return e&&i?e[i]||e[t.find(t.keys(e),function(t){return t.toLowerCase()===i.toLowerCase()})]:void 0},"updateFilters":function(e,i){var a,n,s=this.getFilters(),l=s.length,r=[],o=!1,c=!1;t.each(s,function(t){c=!1,t.column===e?t.value.length>1&&(n=t.value.indexOf(i),-1!==n?(t.value.splice(n,1),c=!0,o=!0):c=!0):c=!0,c&&r.push(t)}),a=this._getNextActiveColumn(),r.length>0?(this.overlayModel.set({"fc_filters":r,"active_column":a,"active_column_formatted":this._getFormattedActiveColumnByName(a)}),o&&l===r.length&&this.overlayModel.trigger("change",this.overlayModel)):this.overlayModel.set({"active_column":a,"active_column_formatted":this._getFormattedActiveColumnByName(a)})},"updateColumnModels":function(e){var i=this.columns.models;t.each(i,function(t){!0===t.get("active_column")&&t.get("name")!==e&&t.set({"active_column":!1}),t.get("name")===e&&t.set({"active_column":!0})}),this.columns.set(i)},"setColumns":function(e){var i,a=t.findWhere(e,{"active_column":!0}),n=t.findWhere(e,{"count_column":!0});(!a||!n)&&(e=t.map(e,t.bind(function(t){return this.options.activeColumn&&t.name.toLowerCase()===this.options.activeColumn.toLowerCase()&&(t.active_column=!0),this.options.countColumn&&t.name.toLowerCase()===this.options.countColumn.toLowerCase()&&(t.active_column=!0),t},this))),this.columns=new c(e),this.setColumnNames(),i=this.getActiveColumn(),this.overlayModel.set({"active_column":i,"active_column_formatted":this._getFormattedActiveColumnByName(i),"count_column":this.getCountColumn()},{"silent":!0})},"setColumnNames":function(){var e=this.columns.filter(function(t){return!0!==t.get("count_column")});this.overlayModel.set({"column_names":t.map(e,function(t){return t.get("name")})},{"silent":!0}),this.overlayModel.set({"column_names_formatted":t.map(e,function(t){return t.get("name_formatted")||t.get("name")})},{"silent":!0})},"sortGroupAndFilter":function(t){var e,i;return this.grouped_on_server?(e=this._mapGroupedData(),(!this.sorted_on_server||t&&t.sort)&&(e=this.sortNest(e,this.getSortOptions()))):(i=this.nest(this.filterBy(this.rawCollection,this.getFilters()),this.getActiveColumn()),e=this.groupOutlyingValues(this.sortNest(i,this.getSortOptions()),this.getGroupAfter())),this.mapFacetData(e),this.facetFilters.filters||(this.facetFilters.filters=this.mapFilterData(this.getFilters()),this.facetFilters.trigger("reset")),e},"_mapGroupedData":function(){var e={};return this.groupedData&&this.groupedData.data&&(e=t.map(this.groupedData.data,function(t){var e=this.getActiveColumn(),i=this.getCountColumn(),a=this._getCaseInsensitiveProperty(t,e),n=this._getCaseInsensitiveProperty(t,i),s=this._getCaseInsensitiveProperty(t,e+"_formatted")||a,l=this._getCaseInsensitiveProperty(t,i+"_formatted")||n;return{"key":a,"key_formatted":this._removeEmptyValues(s),"value":n,"value_formatted":l}},this)),e},"_removeEmptyValues":function(t){return null===t||""===t||void 0===t?d.noValue:t},"nest":function(e,i){var a,n,s,l=[],r={};return t.each(e,t.bind(function(e){n=this._removeEmptyValues(e[i]),a=t.findIndex(l,function(t){return t.key===n}),-1===a?l.push({"key":n,"key_formatted":n.toString(),"value":1,"value_formatted":"1"}):(r=l[a],s=r.value,s+=1,r.value=s,r.value_formatted=s.toString(),l[a]=r)},this)),l},"filterBy":function(e,i){function a(t){var e,i=this._removeEmptyValues(t[n]);switch(l){case"==":e=i===s;break;case"IN":e=-1!==s.indexOf(i);break;default:e=-1!==s.indexOf(i)}return e}var n=null,s=null,l=null;return t.each(i,t.bind(function(i){s=this._removeEmptyValues(i.value),n=i.column,l=i.operator,e=e.filter(t.bind(a,this))},this)),e},"sortNest":function(t,e){var a,n,s=[];return a=e.sortBy,n=e.sortOrder,t=t.sort(function(t,e){switch(a.toLowerCase()){case"ordinal":s=isNaN(t.key)?i.ascending(t.key,e.key):t.key-e.key;break;case"count":s=t.value-e.value}return s}),"asc"===n?t:t.reverse()},"groupOutlyingValues":function(e,i){if(e.length>i+1&&i>-1){var a=e.slice(0,i),n=e.slice(i),s=t.pluck(n,"value"),l=t.reduce(s,function(t,e){return t+e},0),r={"key":"Other","value":l};return a.push(r),a}return e},"onOverlayUpdate":function(){var e=this.overlayModel.changedAttributes(),i=0===t.keys(t.omit(e,["sort_by","sort_order","view_value_as_percentage"])).length,a=this.grouped_on_server&&!i;t.has(e,"column_names")||(a?(this._isFetched=!1,this._isEmpty=!0,this.fetch({"type":"POST"})):i?this.reset(this.sortGroupAndFilter({"sort":!0})):(t.has(e,"active_column")&&this.updateColumnModels(e.active_column),this.reset(this.sortGroupAndFilter())))}});u.mixin(p.prototype);var h=p.prototype.fetch;return p.prototype.fetch=function(e){e||(e={});var i,a={"format":"webreport","method":"GET"},n=this.getFilteredCountQuery();return a=t.extend(a,n),i={"type":"POST","data":a},e?t.extend(e,i):e=i,h.call(this,e)},p}),csui.define("webreports/widgets/visual.data.filtered.count/impl/utils/contexts/factories/visual.data.collection.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.collection"],function(t,e,i,a,n,s){return a.extend({"propertyPrefix":"visualdata","constructor":function(l,r){a.prototype.constructor.apply(this,arguments);var o=l.getObject(n,r);r.connector=o;var c=this.options.visualdata||{};if(!(c instanceof i.Collection)){var u=t.config();c=new s(c.models,e.extend({"connector":o},c.attributes,u.options,{"autoreset":!0}))}this.property=c},"fetch":function(t){return this.property.fetch(t)}})}),csui.define("webreports/mixins/webreports.view.mixin",["csui/lib/underscore","webreports/utils/url.webreports"],function(t,e){"use strict";return{"mixin":function(i){return t.extend(i,{"setCommonModelOptions":function(i){var a,n={};return i&&i.data&&(t.has(i.data,"parameters")&&(a=i.data.parameters,t.isUndefined(a)||"object"!=typeof a||(t.extend(n,{"parameters":a}),t.extend(n,e.getWebReportParametersAsData(a)))),i.data.id&&t.extend(n,{"id":i.data.id}),i.context&&t.extend(n,{"context":i.context})),n}})}}}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.content",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){return'<div class="visual-data-container"></div>'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.content",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/lib/numeral","csui/lib/d3","csui/controls/progressblocker/blocker","csui/controls/list/emptylist.view","webreports/widgets/visual.data.filtered.count/impl/utils/contexts/factories/visual.data.collection.factory","webreports/mixins/webreports.view.mixin","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.content","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data"],function(t,e,i,a,n,s,l,r,o,c,u,d){var p=i.ItemView.extend({"defaults":{"marginTop":20,"marginRight":20,"marginBottom":100,"marginLeft":60,"groupAfter":10,"groupAfterMax":20},"groupAfterValidValues":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"ui":{"dataVisContainer":" .visual-data-container","dataVisOverlay":" .visual-data-overlay"},"visType":"","constructor":function(a){if(a&&a.data){var n,s=!t.has(a.data,"header")||!t.isBoolean(a.data.header)||a.data.header,r=!t.has(a.data,"scroll")||!t.isBoolean(a.data.scroll)||a.data.scroll,c=!(!t.has(a.data,"filterable")||!t.isBoolean(a.data.filterable))&&a.data.filterable,u=!(!t.has(a.data,"expandable")||!t.isBoolean(a.data.expandable))&&a.data.expandable,d=!(!t.has(a.data,"viewValueAsPercentage")||!t.isBoolean(a.data.viewValueAsPercentage))&&a.data.viewValueAsPercentage,p=t.has(a.data,"groupAfter")&&-1!==this.groupAfterValidValues.indexOf(parseInt(a.data.groupAfter,10))?parseInt(a.data.groupAfter,10):this.defaults.groupAfter||5;a.data.header=s,a.data.scroll=r,a.data.visType=this.visType,a.data.groupAfter=p,a.data.filterable=c,a.data.expandable=u,a.data.viewValueAsPercentage=d,n=this.setCommonModelOptions(a),t.extend(n,{"visType":a.data.type,"type":a.data.type,"activeColumn":a.data.activeColumn,"filters":a.data.filters,"filterable":c,"expandable":u,"viewValueAsPercentage":d,"sortBy":a.data.sortBy,"sortOrder":a.data.sortOrder,"groupAfter":p}),l.imbue({"parent":this}),a.collection=a.context.getCollection(o,{"attributes":n}),this.listenTo(a.collection,"sync",this.resetAndRender).listenTo(a.collection,"reset",this.resetAndRender).listenTo(a.collection,"request",this.blockActions).listenTo(a.collection,"sync error",this.unblockActions)}i.ItemView.prototype.constructor.apply(this,arguments),this.onWinRefresh=t.bind(this.resetAndRender,this),e(window).on("resize.app",this.onWinRefresh),this.model=a.collection.overlayModel},"template":d,"className":"visual-data-wrapper","changeChartType":function(){console.log("change chart!"),console.log(this),this.visType=this.model.get("vis_type"),this.resetAndRender()},"onDomRefresh":function(){this.collection.isFetched()&&(this.draw(),this.isChartRendered=!0)},"callBackAlreadyHit":!1,"appendVisElements":function(){},"update":function(){},"isChartRendered":!1,"createRootElement":function(){var i=this.width()>0?this.width():e(this.$el).width()-this.marginLeft()-this.marginRight(),a=this.height()>0?this.height():e(this.$el).height()-this.marginTop()-this.marginBottom();this.uniqueID&&e("#"+this.uniqueID).length&&e("#"+this.uniqueID).remove(),this.uniqueID=t.uniqueId("vis_"),this.visElement=s.select(this.ui.dataVisContainer[0]).append(this.rootElementType).attr("id",this.uniqueID).attr("width",i+this.marginLeft()+this.marginRight()).attr("height",a+this.marginTop()+this.marginBottom())},"onDestroy":function(){e(window).off("resize.app",this.onWinRefresh)},"draw":function(){this.collection.isEmpty()?this.renderEmptyView():(this.createRootElement(),this.appendVisElements(),this.update())},"renderEmptyView":function(){var t=this.ui.dataVisContainer.closest(".tile-content"),e=new r({"text":u.emptyChartText});t.html(e.render().el),t.siblings(".visual-data-btn-settings").addClass("binf-hidden"),t.siblings(".tile-footer").children(".tile-expand").addClass("binf-hidden")},"resetAndRender":function(){this.render()},"checkSign":function(t){return Math.sign||function(t){return t=+t,0===t||isNaN(t)?Number(t):t>0?1:-1}},"shortenText":function(t){t=t||"";return t=t.length>=20?t.substr(0,20)+"\u2026":t},"formatCount":function(t){var e,i;switch(this.collection.columns.findWhere({"count_column":!0}).get("client_format").type){case"si":e=this.shortenNumber(t);break;case"bytes":i=t<1024?"0b":"0.0b",e=n(t).format(i);break;default:e=t.toString()}return e},"shortenNumber":function(t){t=t.toPrecision(3)||0,t=Number(t);var e=s.format(".3s");return t<1e3&&t>-1e3?t.toString():e(t)},"width":function(){return this.$el.parent().width()-this.marginLeft()-this.marginRight()},"height":function(){return this.$el.parent().height()-this.marginTop()-this.marginBottom()},"marginTop":function(){return this.defaults.marginTop},"marginBottom":function(){return this.defaults.marginBottom},"marginLeft":function(){return this.defaults.marginLeft},"marginRight":function(){return this.defaults.marginRight},"rootElementType":"svg"});return c.mixin(p.prototype),p}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.overlay",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"1":function(t,e,i,a){return"binf-hidden"},"3":function(t,e,i,a){var n,s;return'                        <option value="'+this.escapeExpression((s=null!=(s=e.column||(null!=t?t.column:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"column","hash":{}}):s))+'" '+(null!=(n=e.if.call(t,null!=t?t.selected:t,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((s=null!=(s=e.column_formatted||(null!=t?t.column_formatted:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"column_formatted","hash":{}}):s))+"</option>\r\n"},"4":function(t,e,i,a){return'selected="selected"'},"6":function(t,e,i,a){var n,s;return'                    <option value="'+this.escapeExpression((s=null!=(s=e.value||(null!=t?t.value:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"value","hash":{}}):s))+'" '+(null!=(n=e.if.call(t,null!=t?t.selected:t,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((s=null!=(s=e.label||(null!=t?t.label:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"label","hash":{}}):s))+"</option>\r\n"},"8":function(t,e,i,a){var n,s;return'                    <option value="'+this.escapeExpression((s=null!=(s=e.value||(null!=t?t.value:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"value","hash":{}}):s))+'" '+(null!=(n=e.if.call(t,null!=t?t.selected:t,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((s=null!=(s=e.display||(null!=t?t.display:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"display","hash":{}}):s))+"</option>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n,s;return'<div id="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'" class="visual-data-controls">\r\n    <div class="visual-data-control-group controls-lhs '+(null!=(n=e.unless.call(t,null!=t?t.multipleColumns:t,{"name":"unless","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'">\r\n        <ul>\r\n            <li>\r\n                <label for="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-active-column">'+this.escapeExpression(this.lambda(null!=(n=null!=t?t.lang:t)?n.activeColumn:n,t))+'</label>\r\n                <select name="visual-data-active-column" id="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-active-column">\r\n'+(null!=(n=e.each.call(t,null!=t?t.columnnames:t,{"name":"each","hash":{},"fn":this.program(3,a,0),"inverse":this.noop}))?n:"")+'                </select>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="visual-data-control-group controls-rhs">\r\n        <ul>\r\n            <li> <label for="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-sort-options">'+this.escapeExpression(this.lambda(null!=(n=null!=t?t.lang:t)?n.sortBy:n,t))+'</label><select name="visual-data-sort-options" id="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-sort-options">\r\n'+(null!=(n=e.each.call(t,null!=t?t.sortOptions:t,{"name":"each","hash":{},"fn":this.program(6,a,0),"inverse":this.noop}))?n:"")+'            </select></li>\r\n            <li><label for="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-value-as-percentage">'+this.escapeExpression(this.lambda(null!=(n=null!=t?t.lang:t)?n.showValuesAs:n,t))+'</label><select name="visual-data-value-as-percentage" id="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-value-as-percentage">\r\n'+(null!=(n=e.each.call(t,null!=t?t.viewValueAsPercentage:t,{"name":"each","hash":{},"fn":this.program(6,a,0),"inverse":this.noop}))?n:"")+'            </select></li>\r\n            <li><label for="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-group-after">'+this.escapeExpression(this.lambda(null!=(n=null!=t?t.lang:t)?n.groupAfter:n,t))+'</label> <select name="visual-data-group-after" id="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'_visual-data-group-after">\r\n'+(null!=(n=e.each.call(t,null!=t?t.groupAfter:t,{"name":"each","hash":{},"fn":this.program(8,a,0),"inverse":this.noop}))?n:"")+"            </select></li>\r\n        </ul>\r\n    </div>\r\n</div>"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.overlay",a),a}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.overlay.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.overlay","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data"],function(t,e,i,a,n,s){return i.ItemView.extend({"constructor":function(e){this.model=e.overlayModel,this.uniqueID=t.uniqueId("visual-data-controls_"),i.ItemView.prototype.constructor.apply(this,arguments)},"ui":function(){return{"settingsField":"#"+this.uniqueID+" select"}},"template":s,"events":{"change @ui.settingsField":"onChangeSetting"},"templateHelpers":function(){var e=t.map([2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],function(t){return{"value":t,"display":t,"selected":this.model.get("group_after")===t}},this),i=[{"visType":"bar","name":n.barChart,"selected":"bar"===this.model.get("vis_type")},{"visType":"donut","name":n.donutChart,"selected":"donut"===this.model.get("vis_type")},{"visType":"pie","name":n.pieChart,"selected":"pie"===this.model.get("vis_type")}],a=[{"value":"true","selected":this.model.get("view_value_as_percentage"),"label":n.percentage},{"value":"false","selected":!this.model.get("view_value_as_percentage"),"label":n.actual}],s=[{"value":"Count|asc","selected":"Count"===this.model.get("sort_by")&&"asc"===this.model.get("sort_order"),"label":n.count+":"+n.asc},{"value":"Count|desc","selected":"Count"===this.model.get("sort_by")&&"desc"===this.model.get("sort_order"),"label":n.count+":"+n.desc},{"value":"ordinal|asc","selected":"ordinal"===this.model.get("sort_by")&&"asc"===this.model.get("sort_order"),"label":n.activeColumn+":"+n.asc},{"value":"ordinal|desc","selected":"ordinal"===this.model.get("sort_by")&&"desc"===this.model.get("sort_order"),"label":n.activeColumn+":"+n.desc}],l=t.map(this.model.get("column_names"),function(t,e){return{"column":t,"column_formatted":this.model.get("column_names_formatted")[e],"selected":this.model.get("active_column")===t}},this);return{"chartoptions":i,"columnnames":l,"groupAfter":e,"viewValueAsPercentage":a,"sortOptions":s,"lang":n,"id":this.uniqueID,"multipleColumns":l.length>1}},"onChangeSetting":function(t){t.preventDefault(),this.updateSettings()},"updateSettings":function(){var i,a,n,s,l,r=e("#"+this.uniqueID+" select"),o=r.serializeArray();o=t.object(t.map(o,t.values)),i=o["visual-data-active-column"],n=o["visual-data-sort-options"],n=n.split("|"),s=n[0],l=n[1],
a=e("#"+this.uniqueID+" select[name='visual-data-active-column'] option[value='"+i+"']").text(),this.model.set({"active_column":i,"active_column_formatted":a,"sort_by":s,"sort_order":l,"view_value_as_percentage":"true"===o["visual-data-value-as-percentage"].toLowerCase(),"group_after":+o["visual-data-group-after"]})}})}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"1":function(t,e,i,a){var n;return'<div class="csui-header">'+this.escapeExpression((n=null!=(n=e.label||(null!=t?t.label:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"label","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n,s;return(null!=(n=e.if.call(t,null!=t?t.header:t,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'\r\n\x3c!--outer/inner wrappers used to size and identify when number of --\x3e\r\n\x3c!--chicklets cannot fit within provided outer wrapper width.--\x3e\r\n<div class="csui-facet-list-area">\r\n  <ol class="csui-facet-list"></ol>\r\n  <div class="binf-dropdown dropdown-facet-list csui-hidden">\r\n    <button type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n            data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="true">\r\n      <span class="csui-icon icon-more"></span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((s=null!=(s=e.id||(null!=t?t.id:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"id","hash":{}}):s))+'">\r\n    </ul>\r\n  </div>\r\n</div>\r\n\r\n<div class="csui-clear-all" tabindex="-1">\r\n  <div class=\'cs-icon binf-close\'></div>\r\n  <div class=\'clear-label\'>'+this.escapeExpression((s=null!=(s=e.clearAll||(null!=t?t.clearAll:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"clearAll","hash":{}}):s))+"</div>\r\n</div>\r\n\r\n\r\n\r\n"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.bar_impl_facet.bar",a),a}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.item",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n;return'\r\n<li class="csui-facet-item zero-height">\r\n  <a tabindex="-1">\r\n  <span class="csui-label">'+this.escapeExpression((n=null!=(n=e.label||(null!=t?t.label:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"label","hash":{}}):n))+'</span>\r\n  <span class="csui-icon binf-close" data-facet="'+this.escapeExpression((n=null!=(n=e.facetIndex||(null!=t?t.facetIndex:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"facetIndex","hash":{}}):n))+'" data-topic="'+this.escapeExpression((n=null!=(n=e.topicIndex||(null!=t?t.topicIndex:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"topicIndex","hash":{}}):n))+'"></span>\r\n  </a>\r\n</li>\r\n'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.bar_impl_facet.item",a),a}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/nls/root/lang",{"clearAll":"Clear all"}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/facet.bar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/models/facets","csui/models/facettopics","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.item","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/nls/lang","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar"],function(t,e,i,a,n,s,l,r,o,c){return a.ItemView.extend({"listItemContext":o,"template":r,"className":"csui-facet-bar","ui":{"facetListArea":"> div.csui-facet-list-area","facetList":"> div.csui-facet-list-area .csui-facet-list","facetDropdown":".dropdown-facet-list","facetDropdownList":".dropdown-facet-list > ul","dropdownBtn":".binf-dropdown button","facetHeaderLabel":"> .csui-header","clearAll":".csui-clear-all"},"triggers":{"click .csui-clear-all":"clear:all"},"events":{"click .csui-facet-item .binf-close":"onRemoveFilter","keydown":"onKeyInView"},"behaviors":{"TabableRegion":{"behaviorClass":l}},"templateHelpers":function(){var t=this.options;return{"clearAll":c.clearAll,"header":t.header,"label":t.label}},"constructor":function(i){i||(i={}),a.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.collection,"reset",this.render,this),this.onWinResize=e.bind(function(){this.render()},this),t(window).bind("resize.facetview",this.onWinResize)},"currentlyFocusedElement":function(){var i=this.ui.dropdownBtn,a=this.$(".csui-facet-item > a[tabindex=-1]");return a.length&&(a.prop("tabindex",0),e.isFunction(this.ui.clearAll.prop)&&this.ui.clearAll.prop("tabindex",0)),e.isFunction(this.ui.facetDropdown.hasClass)&&(this.ui.facetDropdown.hasClass("csui-hidden")?i.prop("tabindex",-1):i.prop("tabindex",0)),t(this.$("[tabindex]")[0])},"onKeyInView":function(e){var i=e.keyCode,a=!0,n=t(e.target);switch(i){case 46:n.parent().hasClass("csui-facet-item")&&(n=n.find(".binf-close"),this.trigger("remove:filter",{"facetIndex":n.attr("data-facet"),"filterIndex":n.attr("data-topic")}),a=!1);break;case 13:n.hasClass("csui-clear-all")&&(this.trigger("remove:all"),a=!1);break;case 32:a=!1}return a},"onDestroy":function(){t(window).unbind("resize.facetview",this.onWinResize)},"onRender":function(){this.collection.filters.length>0?this.$el.show():this.$el.hide()},"onDomRefresh":function(){this.ui.facetList[0].innerHTML="";var t=this.collection.filters,e=this.addToFacetBar(t);e&&(this.ui.facetDropdown.removeClass("csui-hidden"),this.addToOverFlowDropDown(t,e))},"addToOverFlowDropDown":function(e,i){for(var a=i.startFilter,n=this.ui.facetDropdownList;a<e.length;a++)for(var s=e[a],l=s.values,r=a===i.startFilter?i.startValue:0;r<l.length;r++){var o=s.facetName+" : "+l[r].topicName,c=t(this.listItemContext({"label":o,"facetIndex":a,"topicIndex":r}));c.removeClass("zero-height"),n.append(c)}},"addToFacetBar":function(e){for(var i=this.ui,a=i.facetListArea,n=i.facetList,s=0;s<e.length;s++)for(var l=e[s],r=l.values,o=0;o<r.length;o++){var c=l.facetName+" : "+r[o].topicName,u=t(this.listItemContext({"label":c,"facetIndex":s,"topicIndex":o}));n.append(u);var d=a.width(),p=i.facetDropdown.width(),h=n.width()+p;if(!(h<d))return u.remove(),{"startFilter":s,"startValue":o};u.removeClass("zero-height")}},"onClearAll":function(){this.trigger("remove:all")},"onRemoveFilter":function(e){var i=t(e.target);this.trigger("remove:filter",{"facetIndex":i.attr("data-facet"),"filterIndex":i.attr("data-topic")})},"applyFilter":function(t){this.trigger("apply:filter",t.newFilter)},"updateHeaderLabel":function(t){this.options.label=t,this.ui.facetHeaderLabel.text(t)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.key.navigation",["csui/lib/underscore","csui/lib/jquery"],function(t,e){"use strict";return{"onKeyInView":function(t){var e=t.keyCode,i=!1;switch(e){case 27:this.trigger("escape:focus"),this.activeChild.removeClass("csui-focus");break;case 32:case 13:this.execute(this.activeChild);break;case 38:case 33:case 40:case 34:if(this.activeChild&&this.activeChild.hasClass("csui-focus"))break;i=!0;break;case 9:if(this.activeChild&&this.$el.hasClass("csui-focus")){i=this.tab(t.shiftKey);break}i=!0;break;default:i=!0}return i},"execute":function(t){this.$el.addClass("csui-focus"),this.$el.find(".facet-disabled").length?this.onShowFacet():this.setfocus(t)},"setfocus":function(t){if(t&&t.is(":visible")||(t=this.getActiveChild()),t.hasClass("csui-focus"))switch(t){case this.ui.facetHeaderIcon:if(this.ui.facetHeader.hasClass("binf-disabled"))break;t.trigger("click"),t.addClass("csui-focus");break;case this.ui.apply:case this.ui.cancel:t.trigger("click"),this.trigger("escape:focus"),this.activeChild=void 0;break;case this.ui.facetMore:t.trigger("click"),t===this.ui.facetMore&&this.activateChild(t)}else this.activateChild(t)},"tab":function(t){var e=this.$el.find(".csui-facet-item:not(.binf-hidden)");return!this.activeChild.hasClass("csui-focus")||(this.activeChild=t?this._getPrevActiveChild(e):this._getNextActiveChild(e),this.activateChild(this.activeChild),!1)},"activateChild":function(t){t||(t=this.getActiveChild()),this.prevChild&&this.prevChild.removeClass("csui-focus"),t.addClass("csui-focus"),t.focus(),this.prevChild=this.activeChild},"getActiveChild":function(){var t=this.$el.find(".csui-facet-item:not(.binf-hidden)");return this.activeChild&&this.activeChild.is(":visible")||(this.ui.facetHeaderIcon.hasClass(".icon-expandArrowDown")?this.activeChild=this.ui.facetHeaderIcon:(this.activeChild=e(t[0]).find("span"),this.activeChildIndex=0)),this.activeChild},"cursorNextFilter":function(t,i,a){var n=this.$el.find(".csui-facet-item:not(.binf-hidden)"),s=n.length-1;this.activeChildIndex=i?0===this.activeChildIndex?s:--this.activeChildIndex:this.activeChildIndex===s?0:++this.activeChildIndex,a.hasClass("icon")?this.activeChild=e(n[this.activeChildIndex]).find("span"):this.activeChild=e(n[this.activeChildIndex]).find(".csui-filter-name"),this.children.findByIndex(this.activeChildIndex).activeChild=this.activeChild,this.activateChild(this.activeChild)},"_getLastFilterFocus":function(t){var e=this.activeChildIndex;return this.activeChildIndex=e&&e<t.length?e:0,this.children.findByIndex(this.activeChildIndex).activeChild},"_getNextActiveChild":function(t){var e=this.activeChild;switch(this.activeChild){case this.ui.facetHeaderIcon:this.ui.facetHeaderIcon.hasClass("icon-expandArrowUp")&&(e=this._getLastFilterFocus(t));break;case this.ui.facetMore:this.$el.find(".csui-multi-select").length>0&&(e=this.ui.apply);break;case this.ui.cancel:break;case this.ui.apply:e=this.ui.cancel;break;default:this.ui.facetMore.length>0?e=this.ui.facetMore:this.$el.find(".csui-multi-select").length>0&&(e=this.ui.apply)}return e},"_getPrevActiveChild":function(t){var e=this.activeChild;switch(this.activeChild){case this.ui.facetHeaderIcon:break;case this.ui.facetMore:e=this._getLastFilterFocus(t);break;case this.ui.cancel:e=this.ui.apply;break;case this.ui.apply:e=this.ui.facetMore.length>0?this.ui.facetMore:this._getLastFilterFocus(t);break;default:if(this.ui.facetHeader.hasClass("binf-disabled"))break;e=this.ui.facetHeaderIcon}return e}}}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"1":function(t,e,i,a){var n;return'    <span class="icon icon-checkbox '+this.escapeExpression((n=null!=(n=e.showOnHover||(null!=t?t.showOnHover:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"showOnHover","hash":{}}):n))+'" tabindex="-1">\r\n    <input type="checkbox" />\r\n  </span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n,s;return(null!=(n=e.if.call(t,null!=t?t.enableCheckBox:t,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'<div class="csui-filter-name" tabindex="-1" title="'+this.escapeExpression((s=null!=(s=e.name||(null!=t?t.name:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"name","hash":{}}):s))+" ("+this.escapeExpression((s=null!=(s=e.total||(null!=t?t.total:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"total","hash":{}}):s))+')">\r\n    <div class="csui-name">'+this.escapeExpression((s=null!=(s=e.name||(null!=t?t.name:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"name","hash":{}}):s))+'</div>\r\n    <div class="csui-total">'+this.escapeExpression((s=null!=(s=e.total||(null!=t?t.total:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"total","hash":{}}):s))+"</div>\r\n</div>"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.panel_impl_facet_facet.item",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item.view",["csui/lib/jquery","csui/utils/base","csui/lib/underscore","csui/lib/marionette","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item"],function(t,e,i,a,n){return a.ItemView.extend({"template":n,"className":"csui-facet-item","constructor":function(t){a.ItemView.prototype.constructor.apply(this,arguments),this.showInputOnHover=!e.isTouchBrowser(),this.uniqueID=i.uniqueId("visual-data-controls_")},"triggers":{"click .csui-filter-name":"single:filter:select"},"events":{"click input":"onCheckBoxSelect","change input":"onChangeValue","keydown > span":"onKeyInView","keydown .csui-filter-name":"onKeyInView"},"ui":{"icon":"> span","checkbox":"> span input","filterName":"> .csui-filter-name"},"templateHelpers":function(){return{"showOnHover":this.showInputOnHover?"":"csui-showAlways","id":this.uniqueID,"enableCheckBox":this.options.enableCheckBoxes}},"onKeyInView":function(e){var i=e.keyCode,a=t(e.target);switch(i){case 32:case 13:a.hasClass("icon")?this.ui.checkbox.trigger("click"):this.trigger("single:filter:select",this);break;case 39:case 37:this.activeChild=a.hasClass("icon")?this.ui.filterName:this.ui.icon,this.activeChild.focus();break;case 38:case 40:this.trigger("keyupdown",38===i,a);break;default:return!0}return!1},"onCheckBoxSelect":function(t){this.trigger("multi:filter:select",this)},"onChangeValue":function(t){var e=t.target;e.disabled?this.ui.icon.removeClass("icon-checkbox icon-checkbox-selected").addClass("icon-checkbox-disabled"):e.checked?this.ui.icon.removeClass("icon-checkbox icon-checkbox-disabled").addClass("icon-checkbox-selected"):this.ui.icon.removeClass("icon-checkbox-selected icon-checkbox-disabled").addClass("icon-checkbox")},"getIndex":function(){return this._index}})}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"1":function(t,e,i,a){var n;return'    <div class="csui-filter-more" tabindex="-1">\r\n        <div class="csui-more-text">'+this.escapeExpression((n=null!=(n=e.more||(null!=t?t.more:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"more","hash":{}}):n))+'</div>\r\n        <div class="cs-icon '+this.escapeExpression((n=null!=(n=e["more-icon"]||(null!=t?t["more-icon"]:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"more-icon","hash":{}}):n))+'"></div>\r\n    </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n,s;return'<div class="csui-facet-header">\r\n  <div class="header-label" title="'+this.escapeExpression((s=null!=(s=e.name||(null!=t?t.name:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=e.name||(null!=t?t.name:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"name","hash":{}}):s))+'</div>\r\n  <div class="header-count" title="'+this.escapeExpression((s=null!=(s=e.count||(null!=t?t.count:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"count","hash":{}}):s))+'"> ('+this.escapeExpression((s=null!=(s=e.count||(null!=t?t.count:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"count","hash":{}}):s))+')</div>\r\n  <div class="cs-icon csui-button-icon icon-expandArrowUp" tabindex="-1"></div>\r\n  <div class="csui-right-shadow"></div>\r\n</div>\r\n\r\n<div class="csui-facet-content '+this.escapeExpression((s=null!=(s=e["show-content"]||(null!=t?t["show-content"]:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"show-content","hash":{}}):s))+'">\r\n  <div class="cs-filter-group"></div>\r\n'+(null!=(n=e.if.call(t,null!=t?t.more:t,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'  <div class="csui-facet-controls '+this.escapeExpression((s=null!=(s=e["show-controls"]||(null!=t?t["show-controls"]:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"show-controls","hash":{}}):s))+'">\r\n      <button class="csui-btn binf-btn binf-btn-primary csui-apply">'+this.escapeExpression((s=null!=(s=e.apply||(null!=t?t.apply:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"apply","hash":{}}):s))+'</button>\r\n      <button class="csui-btn binf-btn binf-btn-secondary csui-clear">'+this.escapeExpression((s=null!=(s=e.clear||(null!=t?t.clear:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"clear","hash":{}}):s))+"</button>\r\n</div>\r\n\r\n</div>\r\n"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.panel_impl_facet_facet",a),a}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/root/lang",{"facetTitle":"Refine by","searchIconTooltip":"Search by {0}","searchClearIconTooltip":"Clear all","emptyFacetMessage":"No filters available.","emptyFilteredFacetMessage":"No more filters available.","loadingFacetMessage":"Loading filters...","failedFacetMessage":"Loading filters failed.","noFiles":"No drop files were provided.","addTypeDenied":"Cannot add documents to {1}.","showMore":"Show more","showLess":"Show less","apply":"Apply","clear":"Cancel"}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/facettopics","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.key.navigation","csui/utils/log","csui/behaviors/keyboard.navigation/tabable.region.behavior","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item.view","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/lang","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet"],function(t,e,i,a,n,s,l,r,o,c,u){var d=a.CompositeView.extend({"childView":o,"template":c,"className":"csui-facet","childViewContainer":".cs-filter-group","ui":{"facetContent":".csui-facet-content","facetHeader":".csui-facet-header","facetHeaderIcon":".csui-facet-header > .cs-icon","facetSubmitControls":".csui-facet-controls","facetCollapseControls":".csui-facet-collapse-controls","facetMoreText":".csui-more-text","facetMoreIcon":".csui-filter-more .cs-icon","facetMore":".csui-filter-more","apply":".csui-facet-controls .csui-apply","cancel":".csui-facet-controls .csui-clear","selectCount":".header-count"},"childEvents":{"single:filter:select":"onSingleFilterSelect","multi:filter:select":"onMultiFilterSelect","keyupdown":"cursorNextFilter","keyleftright":"cursorInsideFilter"},"events":{"click .csui-filter-more:not(.binf-disabled)":"onShowMore","click .csui-facet-header":"onShowFacet","mouseleave":"onMouseLeave","keydown":"onKeyInView"},"triggers":{"click .csui-clear":"clear:all","click .csui-apply":"apply:all"},"templateHelpers":function(){var t=this.showAll?u.showLess:u.showMore;return{"more":this.collection.length>this.itemsToShow?t:void 0,"more-icon":this.showAll?"icon-expandArrowUp":"icon-expandArrowDown","apply":u.apply,"clear":u.clear,"show-controls":this.selectItems.length>0?"csui-multi-select":"","show-content":this.showFacet?"":"binf-hidden"}},"childViewOptions":function(){return{"enableCheckBoxes":this.options.enableCheckBoxes}},"constructor":function(t){a.CompositeView.prototype.constructor.apply(this,arguments),this.$el.attr("tabindex",0),this.options=t||{},this.collection=this.model.topics,this.itemsToShow=this.model.get("items_to_show"),this.showAll=!1,this.showFacet=!0,this.selectItems=[]},"onClearAll":function(){var t=this.$el.find("input:checkbox");this.selectItems=[],this.ui.facetCollapseControls.removeClass("multi-select"),this.ui.selectCount.text("(0)"),t.prop("checked",!1).trigger("change"),this._setDisabledFilters(0),this.$el.removeClass("multi-select"),this._updateFacetSubmitControls(),this.ui.facetHeader.removeClass("binf-disabled"),this.trigger("activate:facet",this)},"onApplyAll":function(){var t=this.model,e=this._getFilterArray();this.newFilter={"id":t.get("id"),"facetName":t.get("name"),"values":e},this.trigger("apply:filter")},"onAddChild":function(t){if(t.getIndex()>=this.itemsToShow){var e=this.showAll?"more":"more binf-hidden";t.$el.addClass(e)}},"onRender":function(){0===this.collection.length&&this.$el.hide()},"onSingleFilterSelect":function(t){if(!t.$el.hasClass("binf-disabled"))if(this.$el.hasClass("multi-select"))t.$el.find("input:checkbox").click();else{var e=this.model;this.newFilter={"id":e.get("id"),"facetName":e.get("name"),"values":[{"id":t.model.get("value"),"topicName":t.model.get("name")}]},this.trigger("apply:filter")}},"onShowMore":function(t){t&&(t.preventDefault(),t.stopPropagation()),this.showAll=!this.showAll,this._setMoreLabel(this.showAll),this.trigger("facet:size:change")},"onShowFacet":function(t){if(t&&(t.preventDefault(),t.stopPropagation()),this.showFacet=!this.showFacet,this.showFacet)this.ui.facetContent.removeClass("binf-hidden"),this.ui.facetCollapseControls.removeClass("multi-select"),this.ui.facetHeaderIcon[0].className="cs-icon csui-button-icon icon-expandArrowUp";else{var e=this.$el.find("input:checked").length;this.ui.facetContent.addClass("binf-hidden"),this.ui.facetHeaderIcon[0].className="cs-icon csui-button-icon icon-expandArrowDown",e&&this.ui.facetCollapseControls.addClass("multi-select")}this.trigger("facet:size:change")},"onMouseLeave":function(t){t.preventDefault(),t.stopPropagation()},"getIndex":function(){return this._index},"onMultiFilterSelect":function(t){var e=this.$el.find("input:checked").length;this._updateSelectList(t),this._updateFacetSubmitControls(e),this._setDisabledFilters(e),this.selectItems=0===e?[]:this.selectItems,this.trigger("activate:facet",this)},"_updateFacetSubmitControls":function(){this.$el.find("input:checked").length>0?(this.ui.facetSubmitControls.addClass("csui-multi-select"),this.$el.addClass("multi-select"),this.ui.facetHeader.addClass("binf-disabled")):(this.ui.facetSubmitControls.removeClass("csui-multi-select"),this.$el.removeClass("multi-select"),this.ui.facetHeader.removeClass("binf-disabled"))},"_updateSelectList":function(t){var e=t.getIndex();this.selectItems[e]?delete this.selectItems[e]:this.selectItems[e]=t},"_setDisabledFilters":function(t){var e=this.$el.find("input:not(:checked)"),i=t;t<5?(e.prop("disabled",!1).trigger("change"),e.parent().parent().removeClass("binf-disabled")):(e.prop("disabled",!0).trigger("change"),e.parent().parent().addClass("binf-disabled")),this.ui.selectCount.text(i)},"_setMoreLabel":function(t){var e=this.$el.find(".csui-facet-item.more");this.ui.facetMoreIcon[0]&&(t?(e.removeClass("binf-hidden"),this.ui.facetMoreIcon[0].className="cs-icon icon-expandArrowUp",this.ui.facetMoreText.text(u.showLess)):(e.addClass("binf-hidden"),this.ui.facetMoreIcon[0].className="cs-icon icon-expandArrowDown",this.ui.facetMoreText.text(u.showMore))),this.trigger("facet:size:change")},"_getFilterArray":function(){var t=[];return e.each(this.selectItems,function(e){e&&t.push({"id":e.model.get("value"),"topicName":e.model.get("name")})}),t}});return d.version="1.0",e.extend(d.prototype,s),d}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel.key.navigation",["csui/lib/underscore","csui/lib/jquery"],function(t,e){"use strict";return{"currentlyFocusedElement":function(){var t=this.$(".cs-list-group .csui-facet[tabindex=-1]");return t.length&&t.prop("tabindex",0),this.getActiveChild()},"onSetNextChildFocus":function(t){this.activeChildIndex=t.getIndex()},"accActivateTabableRegion":function(){e(document).unbind("mousedown",this._onRemoveKeyboardFocus),e(document).bind("mousedown",this._onRemoveKeyboardFocus)},"_removeKeyboardFocus":function(){this.$el.find(".csui-focus").removeClass("csui-focus"),e(document).unbind("mousedown",this._onRemoveKeyboardFocus)},"onKeyInView":function(t){switch(t.keyCode){case 38:case 33:this._getPrevActiveChild().focus();break;case 40:case 34:this._getNextActiveChild().focus();break;default:return!0}return!1},"resetFacetFocus":function(t){t.$el.focus()},"getActiveChild":function(){if(!this.$childViewContainer)return e();if(!this.activeChild){var t=this.$childViewContainer[0];t&&t.childNodes[0]&&(this.activeChild=e(t.childNodes[0]),this.activeChildIndex=0)}return this.activeChild},"_getNextActiveChild":function(){var t=this.$childViewContainer[0].childNodes;return t.length-1>this.activeChildIndex?this.activeChildIndex++:this.activeChildIndex=0,e(t[this.activeChildIndex])},"_getPrevActiveChild":function(){var t=this.$childViewContainer[0].childNodes;return this.activeChildIndex>0?this.activeChildIndex--:this.activeChildIndex=t.length-1,e(t[this.activeChildIndex])}}}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n;return'<div class="cs-header binf-panel-heading">\r\n  <span class="cs-title">'+this.escapeExpression((n=null!=(n=e.title||(null!=t?t.title:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"title","hash":{}}):n))+'</span>\r\n</div>\r\n\r\n\x3c!--<div class="csui-horizontal-separator"></div>--\x3e\r\n<div class="cs-content">\r\n  <div class="cs-list-group"></div>\r\n</div>\r\n\r\n\x3c!--Need one shadow strip over the header and one over cs-content. The reason why one over the entire\r\n    simple list will not work, is because cs-content has a z-index of 5 with a scroll index of 8. If\r\n    we had one shadow strip with an index higher than cs-content, the scroll-bar will not show.--\x3e\r\n<div class="csui-right-shadow"></div>\r\n\r\n'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.panel_impl_facet.panel",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/facet.panel.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/facets","csui/models/facettopics","csui/controls/list/simplelist.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.view","csui/behaviors/collection.state/collection.state.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel.key.navigation","csui/controls/progressblocker/blocker","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/lang","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel"],function(t,e,i,a,n,s,l,r,o,c,u,d,p){"use strict";var h=s.extend({"template":d,"className":"cs-simplelist csui-facet-panel","behaviors":{"CollectionState":{"behaviorClass":r,"stateMessages":function(){return{"empty":t.isEmpty(this.collection.filters)?p.emptyFacetMessage:p.emptyFilteredFacetMessage,"loading":p.loadingFacetMessage,"failed":p.failedFacetMessage}}},"TabableRegion":{"behaviorClass":o}},"childView":l,"childViewOptions":function(){return{"enableCheckBoxes":this.options.enableCheckBoxes}},"childEvents":{"apply:filter":"applyFilter","activate:facet":"setActiveFacet","facet:size:change":"_updateScrollbar","escape:focus":"resetFacetFocus"},"events":{"keydown":"onKeyInView"},"onAddChild":function(t){var e=t.$el,i=this;t.getIndex()===this.collection.length-1&&e.css("border-bottom","0px"),e.on("focus",function(){i.onSetNextChildFocus(t)})},"constructor":function(e){s.prototype.constructor.apply(this,arguments),this.options.data.title=p.facetTitle,this._onRemoveKeyboardFocus=t.bind(this._removeKeyboardFocus,this),this.options.blockingParentView?u.delegate(this,this.options.blockingParentView):u.imbue({"parent":this,"local":this.options.blockingLocal})},"isTabable":function(){return!this.$el.parent().hasClass("binf-hidden")},"onRenderCollection":function(){this.trigger("refresh:tabindexes")},"onBeforeDestroy":function(){e(document).unbind("mousedown",this._onRemoveKeyboardFocus)},"applyFilter":function(t){this.trigger("apply:filter",t.newFilter)},"setActiveFacet":function(t){t.selectItems.length>0?this.children.each(function(e){e.getIndex()!==t.getIndex()&&e.$el.find(".csui-facet-content").addClass("facet-disabled")}):this.$el.find(".csui-facet-content").removeClass("facet-disabled")},"_updateScrollbar":function(){this.triggerMethod("update:scrollbar",this)}});return t.extend(h.prototype,c),h}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){return'<div class="visual-data-expanded-view-wrapper">\r\n    <div class="csui-facet-table-container">\r\n        <div id="facetview"></div>\r\n        \x3c!--outer div is needed in order to float table contents right to accommodate  facets--\x3e\r\n        <div id="outertablecontainer" class="reduce-for-facets">\r\n            \x3c!--inner div is needed in order to have tableview sized to remaining height of container--\x3e\r\n            <div id="innertablecontainer">\r\n                <div class="facetbarview"></div>\r\n                <div class="visual-data-controls-parent"></div>\r\n                <div class="visual-data-visualization"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.expanded",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded",[],function(){}),
csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.expanded.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/facet.bar.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/facet.panel.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.overlay.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded"],function(t,e,i,a,n,s,l,r,o){return a.LayoutView.extend({"className":"expanded-visualization-container","template":o,"regions":{"chicklets":".facetbarview","facetRegion":"#facetview","visualizationControls":".visual-data-controls-parent","visualization":".visual-data-visualization"},"constructor":function(t){var e;a.LayoutView.prototype.constructor.apply(this,arguments),this.contentView=t.data.expandedContentView,this.facetFilters=this.contentView.collection.facetFilters,e=this.contentView.collection.getFilters(),0===this.facetFilters.filters.length&&e.length>0&&(this.facetFilters.filters=this.contentView.collection.mapFilterData(e))},"callBackAlreadyHit":!1,"onDomRefresh":function(){this.callBackAlreadyHit&&(this._renderFacetBar(),this._renderFacetPanel(),this._renderExpandedControls(),this._renderChart()),this.callBackAlreadyHit=!0},"_clearFilters":function(){this.facetFilters.clearFilters(),this.contentView.collection.clearFilters()},"_addToFacetFilter":function(t){this.facetFilters.addFilter(t),this.contentView.collection.addFilter(t),this._renderFacetBar(),this._renderExpandedControls(),this._renderFacetPanel()},"_renderChart":function(){this.getRegion("visualization").show(this.contentView),this.contentView.resetAndRender()},"_renderFacetBar":function(){this.facetBarView=new n({"collection":this.facetFilters}),this.listenTo(this.facetBarView,"remove:filter",this._removeFacetFilter,this).listenTo(this.facetBarView,"remove:all",this._removeAll,this).listenTo(this.contentView,"apply:filter",this._addToFacetFilter,this),this.facetFilters.filters.length>0&&this.getRegion("chicklets").show(this.facetBarView)},"_renderFacetPanel":function(){this.getRegion("facetRegion").empty(),this._setFacetView(),this.getRegion("facetRegion").show(this.facetView)},"_setFacetView":function(){this.facetView=new s({"collection":this.facetFilters,"enableCheckBoxes":!0,"blockingLocal":!0}),this.listenTo(this.facetView,"apply:filter",this._addToFacetFilter)},"_renderExpandedControls":function(){this.expandedControls=new l({"overlayModel":this.contentView.collection.overlayModel}),this.getRegion("visualizationControls").show(this.expandedControls)},"_removeFacetFilter":function(t){var e=this.contentView.collection.getActiveColumnByFormattedName(this.facetFilters.filters[t.facetIndex].facetName),i=this.facetFilters.filters[t.facetIndex].values[t.filterIndex].id;0===this.facetFilters.removeFilter(t.facetIndex,t.filterIndex).length?(this.contentView.collection.clearFilters(e,i),this.getRegion("chicklets").empty()):this.contentView.collection.updateFilters(e,i),this._renderExpandedControls()},"_removeAll":function(){this._clearFilters(),this.getRegion("chicklets").empty(),this._renderExpandedControls()}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.bar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/d3","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang"],function(t,e,i,a,n){return a.extend({"constructor":function(t){a.prototype.constructor.apply(this,arguments)},"visType":"bar","defaults":{"marginTop":20,"marginRight":20,"marginBottom":100,"marginLeft":80,"groupAfter":15},"appendVisElements":function(){this.visElement=this.visElement.append("g").attr("transform","translate("+this.marginLeft()+","+this.marginTop()+")").attr("class","bar-chart")},"update":function(){function e(t){return l.collection.overlayModel.get("view_value_as_percentage")?(t.get("value")/c*100).toFixed(1)+"%":l.formatCount(t.get("value"))}function a(){return m(0)}function s(t){return m(t.get("value"))}var l=this,r=l.visElement,o=l.collection.models,c=o.reduce(function(t,e){return t+e.get("value")},0),u=this.width(),d=this.height(),p=i.schemeCategory20,h=i.scaleOrdinal(p),f=i.scaleBand().range([0,u]).round(!0).padding(.1),m=i.scaleLinear(),v=i.extent(o.map(function(t){return t.get("value")})),g=i.axisBottom(f).tickFormat(l.shortenText),b=i.axisLeft(m).tickFormat(t.bind(l.formatCount,l));v=v[0]>0?[0,v[1]]:v,m.domain(v).range([d,0]).nice(),f.domain(o.map(function(t){return l.collection.grouped_on_server?t.get("key_formatted"):t.get("key")}));r.selectAll(".bar").data(o).enter().append("rect").attr("class",function(){return"bar"}).attr("fill-opacity",.9).style("fill",function(t,e){return h(e)}).style("stroke",function(t,e){return h(e)}).attr("x",function(t){return f(l.collection.grouped_on_server?t.get("key_formatted"):t.get("key"))}).attr("y",function(t){return t.get("value")<0?a():s(t)}).attr("width",f.bandwidth()).attr("height",function(t){return Math.abs(s(t)-a())});r.append("g").attr("class","chart-labels").selectAll("text").data(o).enter().append("text").style("text-anchor","middle").text(e).attr("class",function(){return this.getBoundingClientRect().width<=f.bandwidth()?"chart-label":"chart-label hidden"}).attr("x",function(t){return l.collection.grouped_on_server?f(t.get("key_formatted"))+f.bandwidth()/2:f(t.get("key"))+f.bandwidth()/2}).attr("y",function(t){var e=Math.abs(d-s(t)),n=a()-s(t),r=0;return-1===l.checkSign(t.get("value"))?(n<-24?(r=-6,i.select(this).classed("outside",!1)):(r=16,i.select(this).classed("outside",!0)),d+r-e):(n>24?(r=16,i.select(this).classed("outside",!1)):(r=-6,i.select(this).classed("outside",!0)),d+r-e)});var w=!1;r.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(g).selectAll("text").style("text-anchor","middle").attr("dy","6").attr("class",function(){return this.getBoundingClientRect().width>=f.bandwidth()&&(w=!0),null}),w&&r.select(".x.axis").selectAll("text").attr("transform","rotate(-30)").style("text-anchor","end"),r.append("g").attr("class","x axis zero").attr("transform","translate(0,"+a()+")").call(g.tickFormat("").tickSize(0)),r.append("g").call(b).attr("class","y axis"),r.append("g").call(b.tickFormat("").tickSize(-u)).selectAll("line").attr("class","gridline"),r.append("text").attr("class","y-label").text(n.totalCount).attr("transform","rotate(-90)").attr("y",15-this.marginLeft()).attr("x",-d/2).attr("dy","1em").style("text-anchor","middle"),r.append("text").attr("class","x-label").text(this.model.get("active_column_formatted")).attr("y",d+this.marginBottom()-15).attr("x",u/2).attr("dx","1em").style("text-anchor","middle"),r.append("text").attr("class","total").attr("text-anchor","left").attr("alignment-baseline","baseline").attr("y",d+this.marginBottom()-15).attr("x",0-this.marginLeft()+20).text(n.total+": "+l.formatCount(c))}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.pie.view",["csui/lib/underscore","csui/lib/d3","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang"],function(t,e,i,a){return i.extend({"constructor":function(t){i.prototype.constructor.apply(this,arguments)},"defaults":{"marginTop":40,"marginRight":30,"marginBottom":40,"marginLeft":30,"groupAfter":5},"visType":"pie","appendVisElements":function(){this.visElement.append("g").attr("transform","translate("+this.marginLeft()+","+this.marginTop()+")").attr("class","vis-wrapper"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-chart").attr("transform","translate("+this.width()/3+","+this.height()/2+")"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-legend-container").attr("height",this.height()).attr("transform","translate("+(this.width()/3*2+40)+","+this.height()/2+")")},"update":function(){function t(t,e){var i=u[e].get("value"),a=((t.endAngle-t.startAngle)/(2*Math.PI)*100).toFixed(1),n=t.endAngle-t.startAngle,s=l.collection.overlayModel.get("view_value_as_percentage")?a+" %":l.formatCount(i);return s=f*n>=44&&f>=100?s:""}function i(t,e,i){var a=(t.startAngle+t.endAngle)/2;return"translate("+Math.sin(a)*i+","+-Math.cos(a)*i+")"}function n(t,e){return r.selectAll(".arc path,.pie-legend rect,.pie-legend text").filter(function(e,i){return e.index!==t.index}),i(t,e,15)}function s(t,e){return r.selectAll(".arc path,.pie-legend rect").attr("fill-opacity",m),i(t,e,0)}var l=this,r=l.visElement,o=e.schemeCategory20,c=e.scaleOrdinal(o),u=l.collection.models,d=u.reduce(function(t,e){return t+e.get("value")},0),p=this.width(),h=this.height(),f=Math.min(p/3,h/2),m=.9,v=e.arc().innerRadius(0).outerRadius(f-10),g=e.arc().innerRadius(f-10).outerRadius(f+30),b=e.pie().sort(null).value(function(t){return t.get("value")}),w=r.select(".pie-chart").selectAll(".arc").data(b(u)).enter().append("g").attr("class",function(){return"arc"});w.append("path").attr("d",v).attr("fill-opacity",m).style("fill",function(t,e){return c(e)}),w.append("text").attr("class","chart-label outside").attr("transform",function(t){return"translate("+g.centroid(t)+")"}).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",14).text(t);var y=r.select(".pie-legend-container"),x=y.selectAll(".pie-legend").data(b(u)).enter().append("g").attr("class","pie-legend").on("mouseover",function(t){r.selectAll(".arc").filter(function(e,i){return e.index===t.index}).attr("transform",n)}).on("mouseout",function(t){r.selectAll(".arc").filter(function(e,i){return e.index===t.index}).attr("transform",s)}),C=function(){var t,e=u.length||1;return t=2*h/e/2,t=t<14?14:t,t=t>24?24:t}();y.style("font-size",C/2+"px"),x.append("text").attr("class","pie-legend-text").attr("dy","1.2em").attr("transform",function(t,e){var i=C*u.length/2;return"translate("+(C+10)+","+(e*C-i)+")"}).text(function(t,e){return l.collection.grouped_on_server?t.data.get("key_formatted"):t.data.get("key")}),x.append("rect").attr("class","pie-legend-swatch").attr("width","2em").attr("height",C-4).attr("fill-opacity",m).attr("transform",function(t,e){var i=C*u.length/2;return"translate(0,"+(e*C-i)+")"}).attr("fill",function(t,e){return c(e)}),r.select(".vis-wrapper").append("g").attr("class","pie-total-container").append("text").attr("class","total").attr("text-anchor","left").attr("alignment-baseline","baseline").attr("y",h+this.marginBottom()-15).attr("x",0-this.marginLeft()+20).text(a.total+": "+l.formatCount(d)),y.append("text").attr("class","pie-legend-active-column").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("y",0).attr("x",0).attr("dy",-20).text(this.model.get("active_column_formatted"))}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.donut.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/d3","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang"],function(t,e,i,a,n){return a.extend({"constructor":function(t){a.prototype.constructor.apply(this,arguments)},"defaults":{"marginTop":30,"marginRight":30,"marginBottom":30,"marginLeft":30,"groupAfter":5},"visType":"donut","appendVisElements":function(){this.visElement.append("g").attr("transform","translate("+this.marginLeft()+","+this.marginTop()+")").attr("class","vis-wrapper"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-chart").attr("transform","translate("+this.width()/3+","+this.height()/2+")"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-legend-container").attr("transform","translate("+(this.width()/3*2+40)+","+this.height()/2+")")},"update":function(){function t(t,e){var i=d[e].get("value"),a=((t.endAngle-t.startAngle)/(2*Math.PI)*100).toFixed(1),n=t.endAngle-t.startAngle,s=r.collection.overlayModel.get("view_value_as_percentage")?a+" %":r.formatCount(i);return s=m*n>=44&&m>=100?s:""}function e(t,e,i){var a=(t.startAngle+t.endAngle)/2;return"translate("+Math.sin(a)*i+","+-Math.cos(a)*i+")"}function a(t,i){return o.selectAll(".arc path,.pie-legend rect,.pie-legend text").filter(function(e,i){return e.index!==t.index}),e(t,i,15)}function s(t,i){return o.selectAll(".arc path,.pie-legend rect").attr("fill-opacity",v),e(t,i,0)}function l(t){var e=r.formatCount(p).length,i=[1.4,1.6,1.8,2,2.2,2.4,2.6,2.8];return t/(e<=i.length?i[e-1]:12)}var r=this,o=r.visElement,c=i.schemeCategory20,u=i.scaleOrdinal(c),d=r.collection.models,p=d.reduce(function(t,e){return t+e.get("value")},0),h=this.$el[0].clientWidth-this.marginLeft()-this.marginRight(),f=this.$el[0].clientHeight-this.marginTop()-this.marginBottom(),m=Math.min(h/3,f/2),v=.9,g=i.arc().innerRadius(m/1.5).outerRadius(m),b=i.pie().sort(null).value(function(t){return t.get("value")}),w=o.select(".pie-chart").selectAll(".arc").data(b(d)).enter().append("g").attr("class",function(){return"arc"});w.append("path").attr("d",g).attr("fill-opacity",v).style("fill",function(t,e){return u(e)}),w.append("text").attr("class","chart-label").attr("transform",function(t){return"translate("+g.centroid(t)+")"}).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",14).text(t);var y=o.select(".pie-legend-container"),x=y.selectAll(".pie-legend").data(b(d)).enter().append("g").attr("class","pie-legend").on("mouseover",function(t){o.selectAll(".arc").filter(function(e,i){return e.index===t.index}).attr("transform",a)}).on("mouseout",function(t){o.selectAll(".arc").filter(function(e,i){return e.index===t.index}).attr("transform",s)}),C=function(){var t,e=d.length||1;return t=2*f/e/2,t=t<14?14:t,t=t>24?24:t}();y.style("font-size",C/2+"px"),x.append("text").attr("class","pie-legend-text").attr("dy","1.2em").attr("transform",function(t,e){var i=C*d.length/2;return"translate("+(C+10)+","+(e*C-i)+")"}).text(function(t,e){return r.collection.grouped_on_server?t.data.get("key_formatted"):t.data.get("key")}),x.append("rect").attr("class","pie-legend-swatch").attr("width","2em").attr("height",C-4).attr("fill-opacity",v).attr("transform",function(t,e){var i=C*d.length/2;return"translate(0,"+(e*C-i)+")"}).attr("fill",function(t,e){return u(e)});var _=o.select(".pie-chart").append("g").attr("class","pie-total-container"),k=l(m/1.5)>=10?l(m/1.5):10;_.append("g").attr("class","pie-total-label-disc").append("circle").attr("cx",0).attr("cy",0).attr("r",m/1.5-10),_.append("text").attr("transform","translate(0,"+-k/1.5+")").attr("class","pie-total-label").attr("text-anchor","middle").attr("font-size",k/2.3).text(function(){return k/2.3>=8?n.total:""}),_.append("text").attr("class","total").attr("transform","translate(0,"+k/10+")").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",k).text(r.formatCount(p)),y.append("text").attr("class","pie-legend-active-column").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("y",0).attr("x",0).attr("dy",-20).text(this.model.get("active_column_formatted"))}})}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.tile",["module","hbs","csui/lib/handlebars"],function(t,e,i){var a=i.template({"1":function(t,e,i,a){var n;return'        <div class="tile-type-icon">\r\n            <span class="icon title-icon '+this.escapeExpression((n=null!=(n=e.icon||(null!=t?t.icon:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"icon","hash":{}}):n))+'" aria-hidden="true"></span>\r\n        </div>\r\n'},"3":function(t,e,i,a){var n;return null!=(n=e.if.call(t,null!=t?t.imageUrl:t,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:""},"4":function(t,e,i,a){var n;return'            <div class="tile-type-image '+this.escapeExpression((n=null!=(n=e.imageClass||(null!=t?t.imageClass:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"imageClass","hash":{}}):n))+'">\r\n                <img src="'+this.escapeExpression((n=null!=(n=e.imageUrl||(null!=t?t.imageUrl:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"imageUrl","hash":{}}):n))+'" aria-hidden="true">\r\n            </div>\r\n'},"6":function(t,e,i,a){var n;return'\x3c!-- Note: the options button must be available even when there is no header. In the case of no header, it will be positioned absolute --\x3e\r\n<div class="csui-favorite csui-acc-tab-region visual-data-btn-settings">\r\n    <span class="binf-glyphicon binf-glyphicon-cog" role="button" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=e.settings||(null!=t?t.settings:t))?n:e.helperMissing,"function"==typeof n?n.call(t,{"name":"settings","hash":{}}):n))+'"></span>\r\n</div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(t,e,i,a){var n,s;return'<div class="tile-header">\r\n\r\n'+(null!=(n=e.if.call(t,null!=t?t.icon:t,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.program(3,a,0)}))?n:"")+'\r\n    <div class="tile-title" title="'+this.escapeExpression((s=null!=(s=e.title||(null!=t?t.title:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"title","hash":{}}):s))+'">\r\n        <h2 class="csui-heading">'+this.escapeExpression((s=null!=(s=e.title||(null!=t?t.title:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"title","hash":{}}):s))+'</h2>\r\n    </div>\r\n\r\n    <div class="tile-controls" title="'+this.escapeExpression((s=null!=(s=e.title||(null!=t?t.title:t))?s:e.helperMissing,"function"==typeof s?s.call(t,{"name":"title","hash":{}}):s))+'"></div>\r\n\r\n</div>\r\n\r\n<div class="tile-content"></div>\r\n\r\n<div class="tile-footer"></div>\r\n\r\n<div class="visual-data-overlay-clip">\r\n    <div class="visual-data-overlay">\r\n        <div class="visual-data-overlay-content binf-modal-dialog">\r\n        <form class="csui-inlineform-group visual-data-settings-form">\r\n            <div class="binf-modal-content">\r\n                <div class="binf-modal-body">\r\n                    <div class="visual-data-controls-parent"></div>\r\n                </div>\r\n            </div>\r\n        </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n'+(null!=(n=e.if.call(t,null!=t?t.filterable:t,{"name":"if","hash":{},"fn":this.program(6,a,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.tile",a),a}),csui.define("css!webreports/style/webreports",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/controls/tile/tile.view","csui/utils/contexts/factories/connector","csui/utils/url","csui/utils/base","csui/dialogs/modal.alert/modal.alert","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanding.behavior","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.overlay.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.expanded.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.bar.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.pie.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.donut.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.tile","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data","css!webreports/style/webreports.css"],function(t,e,i,a,n,s,l,r,o,c,u,d,p,h,f,m,v,g){return n.extend({"contentView":u,"ui":{"overlayClip":".visual-data-overlay-clip","toggleSettings":".visual-data-btn-settings span","overlay":".visual-data-overlay"},"constructor":function(t){t.data&&t.data.contentView&&(this.contentView=t.data.contentView),this.contentViewOptions=t,t.context&&(this.connector=t.context.getObject(s,t)),n.prototype.constructor.apply(this,arguments)},"behaviors":function(){var e={},i=this.options.data.launchButtonConfig;return this.launchable=this.options.data.expandable&&i&&i.launchButtons&&i.launchButtons.length>0,this.options.data.expandable&&(e.Expanding={"behaviorClass":c,"titleBarIcon":function(){return this.options.data.titleBarIcon},"dialogTitle":function(){return r.getClosestLocalizedString(this.options.data.title,v.dialogTitle)},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"webreports-visual-data","expandedView":function(){return p},"expandedViewOptions":function(){var e,a=this.options;switch(this.options.data.type){case"bar":e=h;break;case"pie":e=f;break;case"donut":e=m;break;default:return!1}return this.launchable&&(this.rowLimit=i.rowLimit,a.data.buttons=t.map(i.launchButtons,t.bind(function(e){return{"label":r.getClosestLocalizedString(e.launchButtonLabel,v.launchReport),"toolTip":r.getClosestLocalizedString(e.launchButtonTooltip,v.launchReportTooltip),"click":t.bind(function(){this.checkRowLimit(this.contentView.collection.getTotalCount(),this.rowLimit)?this._launchReport(e.launchButtonID):o.showError(v.tooManyRows+this.rowLimit)},this)}},this))),a.data.isExpanded=!0,a.data.expandedContentView=new e(this.contentView.options),a}}),e},"regions":function(){return t.extend({"visualizationControls":".visual-data-controls-parent"},n.prototype.regions)},"events":{"click @ui.toggleSettings":"toggleSettings","keyup @ui.toggleSettings":"toggleSettings"},"checkRowLimit":function(t,e){var i;return i=e?e<=5e4?e:5e4:5e3,this.rowLimit=i,t<=i},"toggleSettings":function(t){if(t.preventDefault(),"click"===t.type||"keyup"===t.type&&(13===t.keyCode||32===t.keyCode))if(this.overlayVisible)e(".visual-data-overlay",this.$el).removeClass("visible"),this.overlayVisible=!1;else{var i=new d({"overlayModel":this.contentView.collection.overlayModel});this.getRegion("visualizationControls").show(i),e(".visual-data-overlay",this.$el).addClass("visible"),this.overlayVisible=!0}},"template":g,"templateHelpers":function(){var e={"title":r.getClosestLocalizedString(this.options.data.title,v.dialogTitle),"icon":this.options.data.titleBarIcon||"title-webreports","activeColumn":this.options.data.activeColumn||"","filterable":this.options.data.filterable,"settings":v.settings};return!0===this.options.data.header&&t.extend(e,{"header":this.options.data.header}),e},"_launchReport":function(i){var a,n=new l(this.connector.connection.url).getCgiScript(),s=e("<form></form>"),r=this.contentView.collection.getFilteredCountParms(),o={"func":"ll","objAction":"RunReport","objId":i,"nexturl":location.href},c=t.extend(o,r);c.total_count=this.contentView.collection.getTotalCount(),s.attr("method","POST").attr("action",n).attr("target","_blank").attr("id","launch-webreport-form"),t.each(t.keys(c),function(t){a=e("<input>").attr("type","hidden").attr("name",t).val(c[t]),s.append(a)}),e(".binf-modal-footer").append(s),s.submit(),e("#launch-webreport-form").remove()}})}),csui.define("webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.view",["csui/lib/underscore","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.donut.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.bar.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.pie.view","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data"],function(t,e,i,a,n){return e.extend({"constructor":function(i){i.data.titleBarIcon=t.has(i.data,"titleBarIcon")?"title-icon "+i.data.titleBarIcon:"title-icon title-webreports",this.contentView=this._getContentView(i),this.contentViewOptions=i,e.prototype.constructor.apply(this,arguments)},"_getContentView":function(t){var e=a;if(t&&t.data&&t.data.type)switch(t.data.type){case"donut":e=i;break;case"pie":e=n;break;default:e=a}return e}})}),csui.define("json!webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","kind":"header","supportedKinds":["tile","header"],"schema":{"type":"object","properties":{"title":{"title":"{{tileTitle}}","description":"{{tileDescription}}","type":"object"},"type":{"title":"{{typeTitle}}","description":"{{typeDescription}}","type":"string","enum":["bar","donut","pie"],"default":"bar"},"id":{"title":"{{sourceTitle}}","description":"{{sourceDescription}}","type":"integer"},"activeColumn":{"title":"{{activeTitle}}","description":"{{activeDescription}}","type":"string"},"viewValueAsPercentage":{"title":"{{percentTitle}}","description":"{{percentDescription}}","type":"boolean","enum":[!0,!1],"default":!1},"groupAfter":{"title":"{{groupTitle}}","type":"integer","description":"{{groupDescription}}","enum":[-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"default":-1},"sortBy":{"title":"{{sortTitle}}","description":"{{sortDescription}}","type":"string","enum":["ordinal","Count"],"default":"Count"},"sortOrder":{"title":"{{directionTitle}}","description":"{{directionDescription}}","type":"string","enum":["desc","asc"],"default":"desc"},"filterable":{"title":"{{optionsTitle}}","description":"{{optionsDescription}}","type":"boolean","enum":[!0,!1],"default":!1},"expandable":{"title":"{{expandedTitle}}","description":"{{expandedDescription}}","type":"boolean","enum":[!0,!1],"default":!1},"launchButtonConfig":{"type":"object","title":"{{buttonTitle}}","description":"{{buttonDescription}}","properties":{"rowLimit":{"title":"{{maxTitle}}","description":"{{maxDescription}}","type":"integer"},"launchButtons":{"type":"array","title":"{{customButtonTitle}}","description":"{{customButtonDescription}}","items":{"type":"object","title":"{{addButtonTitle}}","description":"{{addButtonDescription}}","properties":{"launchButtonID":{"title":"{{reportButtonTitle}}","description":"{{reportButtonDescription}}","type":"integer"},"launchButtonLabel":{"title":"{{labelButtonTitle}}","description":"{{labelButtonDescription}}","type":"object"},"launchButtonTooltip":{"title":"{{buttonToolTitle}}","description":"{{buttonToolDescription}}","type":"object"}}}}}},"parameters":{"type":"array","title":"{{paramSourceTitle}}","description":"{{paramSourceDescription}}","items":{"type":"object","title":"{{paramPairTitle}}","description":"{{paramPairDescription}}","properties":{"name":{"type":"string","title":"{{paramNameTitle}}","description":"{{paramNameDescription}}"},"value":{"type":"string","title":"{{paramValueTitle}}","description":"{{paramValueDescription}}"}}}}},"required":["activeColumn","id"]},"options":{"fields":{"id":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[30303]}}},"title":{"type":"otcs_multilingual_string"},"launchButtonConfig":{"fields":{"launchButtons":{"items":{"fields":{"launchButtonID":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[30303]}}},"launchButtonLabel":{"type":"otcs_multilingual_string"},"launchButtonTooltip":{"type":"otcs_multilingual_string"}}}}}},"type":{"type":"select","optionLabels":["{{optionsTypeBar}}","{{optionsTypeDonut}}","{{optionsTypePie}}"]},"groupAfter":{"type":"select","optionLabels":["{{optionsGroupAfterDefault}}","2","3","4","{{optionsPieDonutDefault}}","6","7","8","9","10","11","12","13","14","{{optionsBarDefault}}","16","17","18","19","20"]},"sortBy":{"type":"select","optionLabels":["{{optionsSortByActive}}","{{optionsSortByCount}}"]},"sortOrder":{"type":"select","optionLabels":["{{optionsSortOrderDsc}}","{{optionsSortOrderAsc}}"]}}}}),csui.define("webreports/widgets/visual.data.filtered.count/impl/nls/visual.data.filtered.count.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/nls/root/visual.data.filtered.count.manifest",{"widgetTitle":"Visual Count","widgetDescription":"This widget visualizes the total count of values matching given criteria.","tileTitle":"Title","tileDescription":"Enter the title for the widget. This title appears in the Tile header.","typeTitle":"Chart Type","typeDescription":"Select the type of chart appropriate for your data.","sourceTitle":"Source WebReport","sourceDescription":"Browse to select the WebReport that retrieves the data that you want to visualize.","activeTitle":"Active Column","activeDescription":"Enter the name of the data source column that provides the matching values to be counted.","optionsTitle":"Chart Options","optionsDescription":"Choose whether end users have access to chart filtering options in the Tile view.","expandedTitle":"Expanded View","expandedDescription":"Choose whether end users have access to the Expanded view of the chart.","percentTitle":"Values as Percentage","percentDescription":"Choose whether to show the chart values as percentages of the total count or as the actual count.","groupTitle":"Group After","groupDescription":"Select the threshold for the number of discrete values whose total count will appear in the chart. Values above the threshold will be grouped as 'Other' and the combined total will appear. The Chart Default is a threshold value appropriate to the chart type.","sortTitle":"Sort By","sortDescription":"Select whether to sort the chart by the value names in the Active Column or by the count of the values.","directionTitle":"Sort Direction","directionDescription":"Select whether to sort the chart in Ascending or Descending order.","buttonTitle":"Button WebReports","buttonDescription":"Configure the options for Button WebReports launched by Custom Buttons in the Expanded view","maxTitle":"Maximum Items to Process","maxDescription":"Enter the maximum number of data items to pass to the Button WebReport.","customButtonTitle":"Custom Buttons","customButtonDescription":"Set the properties for the Custom Button that appears in the Expanded View, then click the 'Add To Array' button. Repeat as required to add multiple buttons.","addButtonTitle":"Add Custom Buttons","addButtonDescription":"Configure custom buttons that will appear in the Expanded view and which will launch Button Webreports.","reportButtonTitle":"Button WebReport","reportButtonDescription":"Browse to select the WebReport that will open when you click the button.","labelButtonTitle":"Button Label","labelButtonDescription":"Enter a custom label for the button.","buttonToolTitle":"Button Tooltip","buttonToolDescription":"Enter a tool tip for the button.","paramSourceTitle":"Source Parameters","paramSourceDescription":"Specify one or more Key/Value pairs of parameters to pass into the Source WebReport, as required.","paramPairTitle":"Source Parameters","paramPairDescription":"Specify one or more Key/Value pairs of parameters to pass into the Source WebReport, as required.","paramNameTitle":"Parameter Name",
"paramNameDescription":"The name of the URL parameter.","paramValueTitle":"Parameter Value","paramValueDescription":"The value of the URL parameter.","optionsTypeBar":"Bar","optionsTypeDonut":"Donut","optionsTypePie":"Pie","optionsGroupAfterDefault":"Use Chart Default","optionsPieDonutDefault":"5 - Pie and Donut default","optionsBarDefault":"15 - Bar default","optionsSortByActive":"Active Column","optionsSortByCount":"Count","optionsSortOrderDsc":"Descending","optionsSortOrderAsc":"Ascending"}),csui.define("bundles/webreports-visdata",["webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.view","json!webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.manifest.json","i18n!webreports/widgets/visual.data.filtered.count/impl/nls/visual.data.filtered.count.manifest"],{}),csui.require(["require","css"],function(t,e){e.styleLoad(t,"webreports/bundles/webreports-visdata")});
//# sourceMappingURL=webreports-visdata.js.map