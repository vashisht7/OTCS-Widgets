csui.define("css!xecmpf/pages/start/perspectivewithoutheader",[],function(){}),csui.define("xecmpf/pages/start/perspective-only.page.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/fastclick","csui/utils/namedlocalstorage","csui/utils/contexts/perspective/perspective.context","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/user","csui/pages/start/perspective.routing","csui/utils/url","csui/utils/base","csui/controls/perspective.panel/perspective.panel.view","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/utils/page.leaving.blocker","csui/controls/globalmessage/globalmessage","csui/controls/iconpreload/icon.preload.view","css!xecmpf/pages/start/perspectivewithoutheader"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w){var v=(e.config(),n.ItemView.extend({"behaviors":{"TabablesBehavior":{"behaviorClass":f}},"template":!1,"constructor":function(e){n.ItemView.prototype.constructor.call(this,e),this.options.el||this.setElement(document.body);var t=new r,a=t.getObject(c);if(t.options=t.options||{},t.options.suppressReferencePanel=!0,!a.connection.credentials&&!a.authenticator.isAuthenticated()&&!a.authenticator.syncStorage().isAuthenticated())return void this._navigateToSignIn();this.perspectivePanel=new h({"context":t}),this.propagateEventsToViews(this.perspectivePanel);var l;d.getInstance({"context":t});l=d.routesWithSlashes()?{"pushState":!0,"root":p.combine(new p(new p(location.pathname).getCgiScript()).getPath(),"/xecm")}:{"root":location.pathname},o.history.start(l),u.isAppleMobile()&&this.$el.addClass("csui-on-ipad"),s.attach(this.el),i(window).on("unload",function(){}),this.perspectivePanel.on("show:perspective swap:perspective",function(){var e=window.opener?window.opener:window!==window.parent?window.parent:void 0;e&&(0===this.$el.find(".conws-header-wrapper").length?e.postMessage({"status":"showDialogHeader"},"*"):e.postMessage({"status":"hideDialogHeader"},"*"))}),i(document).on("keyup",function(e){if(27===e.keyCode){e.stopPropagation();var t=window.opener?window.opener:window!==window.parent?window.parent:void 0;t&&t.postMessage({"status":"closeDialog"},"*")}})},"onRender":function(){if(!this._redirecting){this.$el.addClass("binf-widgets xecm-page-widget"),this.$el.append("<div class='binf-widgets'></div>"),w.ensureOnThePage(),b.setMessageRegionView(this,{"classes":"xecm-global-message","useClass":!0,"sizeToParentContainer":!0});var e=new n.Region({"el":this.$el.find("div")});e.show(this.perspectivePanel)}},"_navigateToSignIn":function(){d.routesWithSlashes()&&(g.forceDisable(),location.reload()),this._redirecting=!0}}));return t.extend(v.prototype,m),v}),csui.define("xecmpf/widgets/integration/folderbrowse/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/integration/folderbrowse/impl/nls/root/localized.strings",{"BackButtonToolItem":"Back","PageWidgetToolItem":"Open Full Page Workspace","SearchToolItem":"Search From Here","SearchFromHerePlaceHolder":"Search From Here","CloseToolTip":"Close"}),csui.define("css!xecmpf/widgets/integration/folderbrowse/impl/folderbrowse",[],function(){}),csui.define("xecmpf/widgets/integration/folderbrowse/search.box.view",["module","csui/lib/underscore","csui/lib/jquery","csui/widgets/search.box/search.box.view","i18n!xecmpf/widgets/integration/folderbrowse/impl/nls/localized.strings","css!xecmpf/widgets/integration/folderbrowse/impl/folderbrowse"],function(e,t,i,o,n){"use strict";var s=t.defaults({},e.config(),{"showOptionsDropDown":!1,"showSearchInput":!0,"searchFromHere":!0,"customSearchIconClass":"xecmpf-icon-search","customSearchIconEnabledClass":"xecmpf-icon-search-md","placeholder":n.SearchFromHerePlaceHolder}),a=o.extend({"constructor":function(e){e=e||{},e.data=t.defaults({},e.data,s),o.prototype.constructor.call(this,e)},"searchIconClicked":function(e){e.preventDefault(),e.stopPropagation(),o.prototype.searchIconClicked.call(this,e)},"inputTyped":function(e){32===e.which?e.stopPropagation():o.prototype.inputTyped.call(this,e)}});return a}),csui.define("xecmpf/utils/commands/workspaces/workspace.delete",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/commandhelper","conws/utils/commands/delete","csui/integration/folderbrowser/commands/go.to.node.history","csui/utils/commands/confirmable","csui/controls/globalmessage/globalmessage"],function(e,t,i,o,n,s,a,r,c){"use strict";var l=e.config();i.defaults(l,{"extSystemViewModes":["folderBrowse","fullPage"],"extSystemEl":"#widgetWMainWindow"});var d=new a,p=s.prototype._executeDelete,u=s.extend({"_executeDelete":function(e,t){t||(t={});var s=this.get("viewMode")||l.viewMode,a=s?void 0===s.viewIFrame?!0:s.viewIFrame:void 0,u=this.get("openFullPageWorkspaceEnabled"),h=this.get("goToNodeHistoryEnabled"),m=this.get("fullPageOverlayEnabled");i.extend(e,{"viewMode":s&&(s.mode?s.mode:s),"viewIFrame":a,"wkspId":this.get("id")||l.id});var f=n.getJustOneNode(e);if(t.originatingView=e.originatingView,-1===l.extSystemViewModes.indexOf(e.viewMode)||!f||f.get("id")!==e.wkspId)return p.apply(this,arguments);i.extend(e,{"busObjectId":this.get("busObjectId")||l.busObjectId,"busObjectType":this.get("busObjectType")||l.busObjectType,"extSystemId":this.get("extSystemId")||l.extSystemId});var g=o.Deferred(),b=e.data||{},w=e.context||t.context,v=null!=b.showProgressDialog?b.showProgressDialog:!0,y=this;return r.execute.call(this,e,t).done(function(t){v&&c.hideFileUploadProgress(),csui.require(["xecmpf/widgets/workspaces/workspaces.widget"],function(t){if(d.clearHistory(w),"fullPage"===e.viewMode){var i={"busObjectId":e.busObjectId,"busObjectType":e.busObjectType,"extSystemId":e.extSystemId,"folderBrowserWidget":{"commands":{"open.full.page.workspace":{"enabled":u,"fullPageOverlay":m},"go.to.node.history":{"enabled":h}}},"viewMode":{"mode":e.viewMode}};void 0===e.viewIFrame||e.viewIFrame?window.parent.postMessage(JSON.stringify(i),"*"):y.trigger("xecm:delete:workspace:noiframe")}else y.trigger("xecm:delete:workspace:folderBrowse")}),g.resolve(t)}).fail(function(e){g.reject(e)}),g.promise()}});return s.prototype=u.prototype,u}),csui.define("hbs!xecmpf/widgets/integration/folderbrowse/impl/full.page.workspace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'    <iframe id="xecm-full-page-frame" width="100%" height="100%" src="'+this.escapeExpression((n=null!=(n=t.fullPageWorkspaceUrl||(null!=e?e.fullPageWorkspaceUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"fullPageWorkspaceUrl","hash":{}}):n))+'" />\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return null!=(n=t["if"].call(e,null!=e?e.viewIFrame:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:""}});return i.registerPartial("xecmpf_widgets_integration_folderbrowse_impl_full.page.workspace",o),o}),csui.define("xecmpf/widgets/integration/folderbrowse/full.page.workspace.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/contexts/factories/node","csui/models/node/node.model","csui/utils/contexts/perspective/plugins/node/node.extra.data","csui/utils/contexts/perspective/perspective.context","csui/controls/perspective.panel/perspective.panel.view","csui/utils/commands","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage","xecmpf/utils/commands/workspaces/workspace.delete","hbs!xecmpf/widgets/integration/folderbrowse/impl/full.page.workspace","css!xecmpf/widgets/integration/folderbrowse/impl/folderbrowse"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h){"use strict";var m=o.ItemView.extend({"className":"xecm-full-page-workspace","constructor":function(e){e=e||{},o.ItemView.prototype.constructor.apply(this,arguments),csui.require.config({"config":{"conws/widgets/header/header.view":{"hideActivityFeed":!0,"hideDescription":!0,"hideWorkspaceType":!0,"toolbarBlacklist":["SearchFromHere"],"hideToolbarExtension":!0},"xecmpf/widgets/header/header.view":{"hideMetadata":!0,"hideDescription":!0,"hideActivityFeed":!0,"pageWidget":!0,"toolbarBlacklist":["SearchFromHere"],"hideToolbarExtension":!0},"csui/integration/folderbrowser/commands/go.to.node.history":{"enabled":!0},"xecmpf/utils/commands/folderbrowse/search.container":{"pageWidget":!0,"enabled":!0}}})},"template":h,"templateHelpers":function(){return{"fullPageWorkspaceUrl":this.options.fullPageWorkspaceUrl,"viewIFrame":this.isIFrameRequired()}},"commands":l,"onRender":function(){if(!this.isIFrameRequired()){var e=new s({"id":this.options.nodeID},{"connector":this.options.connector,"includeResources":["perspective","metadata"],"fields":a.getModelFields(),"commands":this.commands.getAllSignatures()}),i=this;e.fetch().done(function(){var s={"connector":i.options.connector},a=new r({"factories":s}),d=new c({"context":a});if(void 0===i.options.renderType||"dialog"!==i.options.renderType){var h=l.get("Delete");h&&l.remove(h);var m={};m.id=i.options.nodeID,m.viewMode={},m.viewMode.mode=i.options.data.viewMode.mode,m.viewMode.viewIFrame=i.options.data.viewMode.viewIFrame,m.openFullPageWorkspaceEnabled=i.options.openFullPageWorkspaceEnabled,m.fullPageOverlayEnabled=i.options.fullPageOverlayEnabled,m.goToNodeHistoryEnabled=i.options.goToNodeHistoryEnabled,m.busObjectId=i.options.data.busObjectId,m.busObjectType=i.options.data.busObjectType,m.extSystemId=i.options.data.extSystemId;var f=new u(m);l.add(f),i.listenTo(f,"xecm:delete:workspace:noiframe",function(){t.defaults(i.options.data,{"deletecallback":!0}),i.options.status.wksp_controller.selectWorkspace(i.options);var e=l.get("Back");e&&e.clearHistory&&i.options.context&&e.clearHistory(i.options.context)})}a.options.suppressReferencePanel=!0,i.listenTo(a,"clear",function(){var t=a.getModel(n);t.get("id")||t.set(e.toJSON())}),p.setMessageRegionView(d,{"classes":"xecm-global-message","useClass":!0,"sizeToParentContainer":!0});var g=new o.Region({"el":i.el});i.$el.addClass("binf-widgets xecm-page-widget xecm-no-iframe-wrap"),g.show(d),a.applyPerspective(e)}).fail(function(e){d.showError(e.responseJSON.error),console.error(e)})}},"isIFrameRequired":function(){return this.options.data&&this.options.data.viewMode&&void 0!==this.options.data.viewMode.viewIFrame&&!this.options.data.viewMode.viewIFrame?!1:!0}});return m}),csui.define("xecmpf/widgets/integration/folderbrowse/search.results/search.results.view",["module","csui/lib/underscore","csui/lib/jquery","csui/widgets/search.results/search.results.view","i18n!xecmpf/widgets/integration/folderbrowse/impl/nls/localized.strings","css!xecmpf/widgets/integration/folderbrowse/impl/folderbrowse"],function(e,t,i,o,n){"use strict";var s=o.extend({"constructor":function(e){e=e||{},e=t.extend(e,e.data),o.prototype.constructor.call(this,e),this.listenTo(this,"go:back",function(){history.back()})}});return s}),csui.define("hbs!xecmpf/widgets/integration/folderbrowse/modaldialog/impl/modal.dialog",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="binf-modal-dialog binf-modal-lg">\r\n  <div class="binf-modal-content">\r\n    <div class="xecm-modal-header">\r\n      <div title="'+this.escapeExpression((n=null!=(n=t.closeToolTip||(null!=e?e.closeToolTip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"closeToolTip","hash":{}}):n))+'"\r\n          class="cs-close icon-tileCollapse icon-pagewidget-collapse csui-acc-focusable-active" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=t.closeToolTip||(null!=e?e.closeToolTip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"closeToolTip","hash":{}}):n))+'" role="button"></div>\r\n    </div>\r\n    <div class="binf-modal-body"></div>\r\n  </div>\r\n</div>'}});return i.registerPartial("xecmpf_widgets_integration_folderbrowse_modaldialog_impl_modal.dialog",o),o}),csui.define("css!xecmpf/widgets/integration/folderbrowse/modaldialog/impl/modal.dialog",[],function(){}),csui.define("xecmpf/widgets/integration/folderbrowse/modaldialog/modal.dialog.view",["csui/lib/underscore","csui/controls/dialog/dialog.view","hbs!xecmpf/widgets/integration/folderbrowse/modaldialog/impl/modal.dialog","i18n!xecmpf/widgets/integration/folderbrowse/impl/nls/localized.strings","css!xecmpf/widgets/integration/folderbrowse/modaldialog/impl/modal.dialog"],function(e,t,i,o){var n=t.extend({"template":i,"templateHelpers":function(){return{"closeToolTip":o.CloseToolTip}},"events":function(){return e.extend({},t.prototype.events,{"keypress .cs-close":"onKeyPress"})},"onKeyPress":function(e){var t=e.keyCode;(13===t||32===t)&&(e.preventDefault(),e.stopPropagation(),this.destroy())}});return n}),csui.define("xecmpf/utils/commands/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/utils/commands/nls/root/localized.strings",{"DetachPageLeavingWarning":"If you leave the page now, pending items will not be detached.","DetachBusAtts":"Detaching {0} business objects","DetachingOneBusAtt":"Detaching business object","DetachBusAttsNoneMessage":"No business objects detached.","DetachOneBusAttSuccessMessage":"1 business object succeeded to detach.","DetachSomeBusAttsSuccessMessage":"{0} business objects succeeded to detach.","DetachManyBusAttsSuccessMessage":"{0} business objects succeeded to detach.","DetachOneBusAttFailMessage":"1 business object failed to detach.","DetachSomeBusAttsFailMessage":"{0} business objects failed to detach.","DetachManyBusAttsFailMessage2":"{2} business objects failed to detach.","DetachSomeBusAttsFailMessage2":"{2} business objects failed to detach.","DetachingSomeBusAtts":"Detaching {0} business objets","DetachBusAttsCommandConfirmDialogTitle":"Detach","DetachBusAttsCommandConfirmDialogSingleMessage":"Do you want to detach {0}?","DetachBusAttsCommandConfirmDialogMultipleMessage":"Do you want to detach {0} items?","CommandDoneVerbDetached":"detached","CommandNameDetach":"Detach Business Attachment","AttachPageLeavingWarning":"If you leave the page now, pending items will not be detached.","AttachBusAtts":"Attaching {0} business objects","AttachingOneBusAtt":"Attaching business object","AttachBusAttsNoneMessage":"No business objects attached.","AttachOneBusAttSuccessMessage":"1 business object succeeded to attach.","AttachSomeBusAttsSuccessMessage":"{0} business objects succeeded to attach.","AttachManyBusAttsSuccessMessage":"{0} business objects succeeded to attach.","AttachOneBusAttFailMessage":"1 business object failed to attach.","AttachSomeBusAttsFailMessage":"{0} business objects failed to attach.","AttachManyBusAttsFailMessage":"{0} business objects failed to attach.","AttachManyBusAttsFailMessage2":"{2} business objects failed to attach.","AttachSomeBusAttsFailMessage2":"{2} business objects failed to attach.","AttachingSomeBusAtts":"attaching {0} business objets","AttachBusAttsCommandConfirmDialogTitle":"Attach","AttachBusAttsCommandConfirmDialogSingleMessage":"Do you want to attach {0}?","AttachBusAttsCommandConfirmDialogMultipleMessage":"Do you want to attach {0} items?","AttachBusAttsCommandConfirmDialogHtml":"<span class='msgIcon WarningIcon'><%- message %></span>","CommandDoneVerbAttached":"attached","CommandNameAttach":"Attach Business Attachment","CommandNameOpenSapObject":"Open Sap Object","CommandNameGoToWorkspace":"Go To Workspace","GoToWorkpsaceHistory":"Go To Workspace History","OpenFullPageWorkpsace":"Open Full Page Wokspace","SearchWorkspace":"Search From Here","SearchBackTooltip":"Go Back to '{0}'","BOAttachmentCreate":{"name":"Add business attachment","verb":"attach","doneVerb":"attached","addButtonLabel":"Attach","pageLeavingWarning":"If you leave the page now, pending items will not be attached.","successMessages":{"formatForNone":"No business attachments attached.","formatForOne":"1 business attachment succeeded to attach.","formatForMultiple":"{0} business attachments succeeded to attach."},"errorMessages":{"formatForOne":"1 business attachment failed to attach.","formatForMultiple":"{0} business attachments failed to attach."},"progressBarMessages":{"oneFileTitle":"Attaching business attachment","multiFilePending":"Attaching {0} business attachments","multiFileFailure":"{2} business attachments failed to attach."}},"backButtonToolTip":"Go back","CommandSnapshot":"Snapshot","snapshotCreated":"Snapshot created","snapshotCreatedWithName":"Snapshot '{0}' created","snapshotFailed":"Snapshot creation failed","CommandDoneVerbCreated":"created","Refresh":"Events refreshed.","RefreshError":"Error while refreshing.","AuthenticationError":"Authentication failed"}),csui.define("xecmpf/utils/commands/folderbrowse/go.to.workspace.history",["module","csui/lib/jquery","csui/lib/underscore","csui/models/command","csui/lib/backbone","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s){var a,r=[location.href],c=o.extend({"defaults":{"signature":"WorkspaceHistory","name":s.GoToWorkpsaceHistory},"enabled":function(t,o){var s=i.extend({"enabled":!1},e.config());return a||(a=!0,window.addEventListener("popstate",function(){r.length>1&&r[r.length-2]===location.href&&r.pop()}),n.history.on("navigate",function(){r.push(location.href)})),s.enabled&&r.length>1},"execute":function(e,i){return history.back(),t.Deferred().resolve().promise()}});return c}),csui.define("xecmpf/utils/commands/folderbrowse/search.container",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/command","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,a){var r=s.extend({"defaults":{"signature":"SearchFromHere","name":a.SearchWorkspace},"enabled":function(t,o){var n=i.extend({"enabled":!1},e.config());return n.enabled},"execute":function(t,s){var r=i.extend({"pageWidget":!1},e.config()),c=this,l=o.Deferred();return csui.require(["xecmpf/widgets/integration/folderbrowse/search.box.view","xecmpf/controls/search.textbox/search.textbox.view","csui/widgets/search.results/search.results.view","csui/utils/contexts/factories/node","csui/utils/contexts/factories/next.node","csui/utils/contexts/factories/search.query.factory",this.get("commands")],function(e,d,p,u,h,m,f){var g=t.originatingView.$el.find(".csui-search-button");g.find("div.csui-searchbox-holder").length||g.append("<div class='csui-searchbox-holder'></div>");var b=new n.Region({"el":s.el?s.el:g.find("div.csui-searchbox-holder")}),w=t.originatingView&&t.originatingView.context?t.originatingView.context:s&&s.context,v=w?w.getModel(u):null,y=v?v.get("id"):0,x=t.originatingView&&t.originatingView.options&&t.originatingView.options.workspaceContext&&t.originatingView.options.workspaceContext.wkspid&&t.originatingView.options.workspaceContext.wkspid.get("id")?t.originatingView.options.workspaceContext.wkspid.get("id"):0;r.pageWidget||delete w._factories.searchQuery;var _=!1,k=0===x?e:d;if(_=0===x?!1:!0,c.searchBoxView=new k({"context":w,"originatingView":t.originatingView,"data":{"nodeId":0===x?y:x}}),c.originatingViewElement=t.originatingView.$el,c.listenTo(c.searchBoxView,"hide:searchbar",function(){c.searchBoxView.destroy(),c.originatingViewElement.find("a.csui-toolitem").show(),c.originatingViewElement.find("a.csui-toolitem").trigger("focus")}),c.listenTo(c.searchBoxView,"show",function(){setTimeout(function(){var e=_?".xecmpf-input":".csui-input";c.originatingViewElement.find(e).trigger("focus")},25)}),t.originatingView.$el.find(".csui-search-button > a.csui-toolitem").hide(),b.show(c.searchBoxView),(!r.pageWidget||_)&&t.originatingView){var C,T,V,A=w.getModel(m);_?(C=c.searchBoxView,T=c.searchBoxView,V="search:results"):(C=t.originatingView,T=A,V="change"),C.listenTo(T,V,function(){delete w._factories.searchResults;var e,s=new p({"container":t.container,"originatingView":t.originatingView,"context":w,"commands":f,"enableBackButton":!0,"backButtonToolTip":i.str.sformat(a.SearchBackTooltip,t.container.get("name"))}),r=c.originatingViewElement.parent();r.find(".cs-search-results-wrapper").remove(),r.append("<div class='cs-search-results-wrapper'></div>"),c.$csSearchResults=o(r.find(".cs-search-results-wrapper")[0]),c.$csSearchResults.hide(),s.render(),_?s.collection.fetch():w.fetch(),n.triggerMethodOn(s,"before:show"),c.$csSearchResults.append(s.el),_?c.originatingViewElement.hide():c.originatingViewElement.hide("blind",{"direction":"left","complete":function(){c.$csSearchResults.show("blind",{"direction":"right","complete":function(){n.triggerMethodOn(s,"show")}},100)}},100),e=function(){c.$csSearchResults.hide("blind",{"direction":"right","complete":function(){c.originatingViewElement.show("blind",{"direction":"left","complete":function(){delete w._factories.searchResults,delete w._factories.searchFacets,t.originatingView.triggerMethod("dom:refresh")}},100),s.destroy(),c.$csSearchResults.remove()}},100)},c._nextNode=w.getModel(h),c.listenToOnce(c._nextNode,"change:id",i.bind(e,c)),c.listenToOnce(s,"go:back",i.bind(e,c))})}l.resolve()},function(e){l.reject(e)}),l.promise()}});return r}),csui.define("xecmpf/utils/commands/folderbrowse/open.full.page.workspace",["module","require","csui/lib/jquery","csui/lib/underscore","csui/models/command","csui/utils/contexts/factories/connector","csui/utils/url","csui/dialogs/modal.alert/modal.alert","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,a,r,c){var l=n.extend({"defaults":{"signature":"WorkspacePage","name":c.OpenFullPageWorkpsace,"scope":"single"},"enabled":function(t,i){var n=o.extend({"enabled":!1},e.config());return n.enabled&&!!t.container},"execute":function(t,n){var r=this,c=o.extend({"fullPageOverlay":!1},e.config()),l=i.Deferred(),d=t.originatingView?t.originatingView.context:n&&n.context,p="xecm",u=d.getObject(s),h=u&&u.connection&&u.connection.url?u.connection.url.replace("/api/v1",""):"",m=window,f=!!t&&!!t.data&&!!t.data.applyTheme,g=f?i(m.document).find("head > link[data-csui-theme-overrides]").attr("href"):void 0,b=a.combine(h,p,"nodes",t.container.get("id")),w=new XMLHttpRequest,v=new a(h).getAbsolute();if(c.fullPageOverlay)csui.require(["xecmpf/widgets/integration/folderbrowse/modaldialog/modal.dialog.view","xecmpf/widgets/integration/folderbrowse/full.page.workspace.view","csui/models/node/node.model","csui/utils/contexts/factories/node","csui/utils/contexts/perspective/perspective.context","csui/controls/perspective.panel/perspective.panel.view","csui/utils/commands","csui/utils/contexts/perspective/plugins/node/node.extra.data"],function(e,i,o,n,s,p,y,x){r.authenticate(w,h,u),w.onreadystatechange=function(){if(w.readyState===XMLHttpRequest.DONE&&200===w.status){var o=d.options.viewMode||{};if(void 0===o.viewIFrame||o.viewIFrame){if(c.extSystemId&&c.busObjectType&&c.busObjectId){var n="where_ext_system_id="+c.extSystemId+"&where_bo_type="+c.busObjectType+"&where_bo_id="+c.busObjectId+"&view_mode=fullPage";b=a.appendQuery(b,n)}b=a.appendQuery(b,"pageOverlay=true");var s=new i({"fullPageWorkspaceUrl":b}),r=new e({"title":t.container.get("name"),"className":"xecm-modal-dialog","iconRight":"icon-tileCollapse","view":s});if(r.show(),m.addEventListener("message",function(e){e.origin&&new RegExp(e.origin,"i").test(new a(h).getOrigin())&&e.data&&("closeDialog"===e.data.status?r.$el.find(".cs-close").trigger("click"):"showDialogHeader"===e.data.status?r.$el.find(".xecm-modal-header").show():"hideDialogHeader"===e.data.status&&r.$el.find(".xecm-modal-header").hide())}),f){var l=function(e){e.origin&&new RegExp(e.origin,"i").test(new a(h).getOrigin())&&e.data&&"ok"===e.data.status&&(e.source.postMessage({"themePath":g},v),m.removeEventListener("message",l,!1))};m.addEventListener("message",l)}}else{var p={"viewMode":o},y={"data":p,"nodeID":t.container.get("id"),"status":t,"context":d,"connector":u,"renderType":"dialog"},x=new i(y);r=new e({"title":t.container.get("name"),"className":"xecm-modal-dialog","iconRight":"icon-tileCollapse","view":x}),r.show(),csui.require.config({"config":{"conws/widgets/header/header.view":{"enableCollapse":c.fullPageOverlay},"xecmpf/widgets/header/header.view":{"enableCollapse":c.fullPageOverlay},"xecmpf/utils/commands/folderbrowse/open.full.page.workspace":{"enabled":!1}}})}}},l.resolve()},function(e){l.reject(e)});else{var y=m.open("");this.authenticate(w,h,u),w.onreadystatechange=function(){4===w.readyState&&(y.location.href=b,f&&m.addEventListener("message",function(e){e.origin&&new RegExp(e.origin,"i").test(new a(h).getOrigin())&&e.data&&"ok"===e.data.status&&y.postMessage({"themePath":g},v)})),l.resolve()}}return l.promise()},"authenticate":function(e,t,i){if(i.connection.session&&i.connection.session.ticket)this.authenticateworkspace(e,t,i);else if(i.connection.credentials){var o=this,n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)try{if(200!==n.status)throw new Error(n.status+" "+n.statusText);var s=n.getResponseHeader("content-type");if(!/^application\/json/i.test(s))throw new Error("Unsupported content type: "+s);var a=JSON.parse(n.responseText);i.connection.session=a,o.authenticateworkspace(e,t,i)}catch(r){console.error(r)}},n.open("POST",i.connection.url+"/auth",!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send("username="+encodeURIComponent(i.connection.credentials.username)+"&password="+encodeURIComponent(i.connection.credentials.password))}else r.showError(c.AuthenticationError)},"authenticateworkspace":function(e,t,i){e.open("GET",t+"/xecmauth",!0),e.setRequestHeader("OTCSTicket",i.connection.session.ticket),e.withCredentials=!0,e.send(null)}});return l}),csui.define("xecmpf/utils/commands/boattachments/boattachments.create",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/commandhelper","csui/utils/command.error","csui/utils/commands/multiple.items","csui/models/command","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,a,r,c,l){"use strict";var d=i.extend({"nodesSelectionType":"savedQuery"},e.config()),p=c.extend({});i.extend(p.prototype,r);var u,h,m=p.extend({"defaults":{"signature":"BOAttachmentsCreate","command_key":["BOAttachmentsCreate"],"name":l.BOAttachmentCreate.name,"verb":l.BOAttachmentCreate.verb,"doneVerb":l.BOAttachmentCreate.doneVerb,"pageLeavingWarning":l.BOAttachmentCreate.pageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":l.BOAttachmentCreate.successMessages.formatForNone,"formatForOne":l.BOAttachmentCreate.successMessages.formatForOne,"formatForTwo":l.BOAttachmentCreate.successMessages.formatForMultiple,"formatForFive":l.BOAttachmentCreate.successMessages.formatForMultiple},"errorMessages":{"formatForNone":l.BOAttachmentCreate.successMessages.formatForNone,"formatForOne":l.BOAttachmentCreate.errorMessages.formatForOne,"formatForTwo":l.BOAttachmentCreate.errorMessages.formatForMultiple,"formatForFive":l.BOAttachmentCreate.errorMessages.formatForMultiple}},"enabled":function(e){if(e.data&&e.data.enabledAttach){var t=s.getAtLeastOneNode(e);return!!t.length}return!!e.collection&&!!e.collection.businessObjectActions&&!!e.collection.businessObjectActions.data&&i.has(e.collection.businessObjectActions.data,this.defaults.signature)},"execute":function(e,t){var n=o.Deferred();e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,e.context=e.context||t&&t.context,t=i.extend(t,e.data,{"collection":e.collection});var a=s.getAtLeastOneNode(e);return a.length&&e.originatingView?(e.originatingView.triggerMethod("set:picker:result",{"nodes":a.models}),n.resolve(),e.originatingView.triggerMethod("close")):(e.nodesSelectionType=e.nodesSelectionType||t&&t.nodesSelectionType||d.nodesSelectionType,csui.require(["csui/controls/globalmessage/globalmessage","xecmpf/widgets/boattachments/impl/boattachment.model"],function(){u=arguments[0],h=arguments[1],this._selectNodes(e,t).then(function(i){this._showProgressbarAndPerformActions(i.nodes,e,t).then(n.resolve,n.reject)}.bind(this),function(e){e&&!e.cancelled&&u.showMessage("error",e),n.reject()})}.bind(this),n.reject)),n},"_selectNodes":function(e,t){var n=o.Deferred(),s=this;return csui.require(["csui/dialogs/node.picker/node.picker","xecmpf/controls/savedquery.node.picker/savedquery.node.picker.view","csui/controls/toolbar/toolitems.factory"],function(t,o,a){var r=new a({"main":[{"signature":s.get("signature"),"name":l.BOAttachmentCreate.addButtonLabel,"commandData":{"enabledAttach":!0}}]},{"maxItemsShown":1,"dropDownText":l.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),c="savedQuery"===e.nodesSelectionType?new o(i.extend({"title":l.BOAttachmentCreate.name,"enableBackButton":!0,"backButtonToolTip":l.backButtonToolTip,"toolbarItems":{"otherToolbar":r,"inlineToolbar":[],"tableHeaderToolbar":r}},i.omit(e,"collection","toolbarItems"))):new t(i.extend({"selectMultiple":!0,"selectableTypes":[],"unselectableTypes":[],"showAllTypes":!0,"dialogTitle":l.BOAttachmentCreate.name,"selectButtonLabel":l.selectButtonLabel}));c.show().then(n.resolve,n.reject)},n.reject),n},"_showProgressbarAndPerformActions":function(e,t,n){var s=o.Deferred();return csui.require(["csui/models/fileuploads"],function(o){var a=i.map(e,function(e){return{"name":e.get("name"),"state":"pending","count":0,"total":1,"node":e}}),r=new o(a),c=i.defaults({"nodes":r,"suppressMultipleFailMessage":!0},t);r.each(function(e){e.node=e.get("node"),e.unset("node",{"silent":!0})}),u.showFileUploadProgress(r,{"oneFileTitle":l.BOAttachmentCreate.progressBarMessages.oneFileTitle,"oneFileSuccess":l.BOAttachmentCreate.successMessages.formatForOne,"multiFileSuccess":l.BOAttachmentCreate.successMessages.formatForMultiple,"oneFilePending":l.BOAttachmentCreate.progressBarMessages.oneFileTitle,"multiFilePending":l.BOAttachmentCreate.progressBarMessages.multiFilePending,"oneFileFailure":l.BOAttachmentCreate.errorMessages.formatForOne,"multiFileFailure":l.BOAttachmentCreate.progressBarMessages.multiFileFailure,"someFileSuccess":l.BOAttachmentCreate.successMessages.formatForMultiple,"someFilePending":l.BOAttachmentCreate.progressBarMessages.multiFilePending,"someFileFailure":l.BOAttachmentCreate.progressBarMessages.multiFileFailure,"enableCancel":!1}),this._performActions(c,n).then(function(){u.hideFileUploadProgress(),s.resolve.apply(s,arguments)}.bind(this),s.reject)}.bind(this),s.reject),s},"_performAction":function(e,t){var i=e.node,o=i.connector;return o.makeAjaxCall({"url":n.combine(o.connection.url.replace("/v1","/v2"),"businessobjects",encodeURIComponent(t.extId),encodeURIComponent(t.boType),encodeURIComponent(t.boid),"businessattachments",i.get("id")),"type":"POST","data":{"expand":{"properties":{"fields":["original_id","ancestors","parent_id","reserved_user_id","createdby","modifiedby"]}}},"success":function(i,n,s){var a=new h(i.results[0],{"connector":o,"parse":!0});a.isLocallyCreated=!0,t.collection.add(a,{"at":0}),e.deferred.resolve(e)},"error":function(t,o,n){var s=t?new a(t,i):t;e.deferred.reject(e,s)},"complete":function(t,i){e.set("count",1)}})}});return m}),csui.define("xecmpf/widgets/eac/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/eac/impl/nls/root/lang",{"dialogTitle":"Event Action Center","emptyListText":"No Events found.","ToolbarItemBack":"Back","ToolbarItemRefresh":"Refresh","ToolbarItemFilter":"Filter","actionPlan":"Action plan","addActionPlan":"Add action plan","columnEventName":"Event Name","columnSystemName":"System Name","columnActionPlan":"Action Plan","sourceLabel":"Source","rulesLabel":"Rules","runAs":"Run as","processMode":"Process mode","conjunctionAndLabel":"And","conjunctionOrLabel":"Or","operatorEqualtoLabel":"Equal to","operatorNotequaltoLabel":"Not equal to","synchronouslyProcessLabel":"Synchronously","asynchronouslyProcessLabel":"Asynchronously","csObjLabel":"Content Server object","evtPropLabel":"Event property","prevActLabel":"Result from previous action",
"labelExtendedECMVolume":"Extended ECM","saveLabel":"Save","cancelLabel":"Cancel","deleteActionPlanButton":"Delete","deleteActionPlanButtonAria":"Delete action plan","actionPlansGroup":"Action plans","backTitle":"Back","rulesTabLabel":"Rules","actionsTabLabel":"Actions","processModeTabLabel":"Process mode","rulesSetLegend":"Conditions","deleteActionPlanConfirmatonTitle":"Delete action plan","deleteActionPlanConfirmatonText":"Are you sure you want to delete {0}? ","newActionPlan":"New action plan","actionPlansListHeader":"Action plans","createLabel":"Create","closeLabel":"Close","genericWarningMsgOnDeletion":"Server Error: Unable to perform the action","warningMsgOnActionPlanNavigation":"All unsaved changes will be lost. Are you sure you want to continue?","actionPlanNavigationDialogTitle":"Unsaved changes","actionAttrParameterNameLabel":"Parameter name","actionAttrSourceLabel":"Source","actionAttrValueLabel":"Value"}),csui.define("xecmpf/models/eac/eac.eventlist.columns.definitions",["i18n!xecmpf/widgets/eac/impl/nls/lang"],function(e){var t={"event_name":{"hidden":!1,"key":"event_name","name":e.documentTypeLabel,"type":-1,"type_name":"String","sort":!0},"namespace":{"key":"namespace","name":e.documentNameLabel,"type":-2,"type_name":"String"},"action_plan":{"key":"action_plan","name":e.documentStatusLabel,"type":-1,"type_name":"String"}};return t}),csui.define("xecmpf/models/eac/eventactionplans.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/expandable/expandable.mixin","csui/models/browsable/client-side.mixin","csui/models/columns","xecmpf/models/eac/eac.eventlist.columns.definitions"],function(e,t,i,o,n,s,a,r,c){var l=i.Model.extend({"idAttribute":"","constructor":function(e,t){t||(t={}),i.Model.prototype.constructor.apply(this,arguments)},"parse":function(e){return e&&(e.has_action_plan="false",e.action_plans&&(e.has_action_plan=(!!e.action_plans.length).toString())),e}}),d=i.Collection.extend({"model":l,"constructor":function(e,t){this.options=t||{},i.Collection.prototype.constructor.apply(this,arguments),this.makeConnectable(t).makeClientSideBrowsable(t),this.columns=new r,this.columns.reset(this.getColumnModels())},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2");return e=o.combine(e,"eventactioncenter","actionplan")},"getColumnModels":function(){var t=c,i=e.keys(t),o=e.reduce(i,function(i,o){var n=t[o];return n&&i.push(e.extend({"column_key":o},n)),i},[]);return o},"parse":function(e){for(var t=e.results.data,i=0;i<t.length;i++)t[i].action_plan_count&&parseInt(t[i].action_plan_count)>0&&(t[i].enableActionPlanCount=!0),t[i].eventIndexCount=i;return t}});return n.mixin(d.prototype),a.mixin(d.prototype),d}),csui.define("xecmpf/utils/commands/eac/eac.refresh",["csui/lib/underscore","i18n!xecmpf/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/command.error","xecmpf/models/eac/eventactionplans.model","csui/controls/globalmessage/globalmessage"],function(e,t,i,o,n,s,a){"use strict";var r=o.extend({"defaults":{"signature":"EACRefresh","command_key":["EACRefresh"]},"enabled":function(e,t){return!0},"execute":function(i,o){i.suppressSuccessMessage=!0,i.suppressFailMessage=!0,this.eacCollection&&(this.eacCollection=null),this.eacCollection=new s(void 0,e.extend({},i.collection.options));var n=this.eacCollection.fetch();return n.done(function(){i.collection.reset(this.eacCollection.models),a.showMessage("success",t.Refresh)}.bind(this)),n.done().fail(function(){a.showMessage("error",t.RefreshError)}),n}});return r}),csui.define("xecmpf/utils/commands/eac/eac.back",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/command.error"],function(e,t,i,o,n,s,a,r){"use strict";var c=a.extend({"defaults":{"signature":"EACBack","command_key":["EACBack"]},"enabled":function(e,t){return!0},"execute":function(e,t){}});return c}),csui.define("xecmpf/widgets/boattachments/impl/boattachment.table/commands/snapshot",["csui/lib/jquery","csui/lib/underscore","csui/models/command","csui/utils/commandhelper","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n){var s=i.extend({"defaults":{"signature":"Snapshot","name":n.CommandSnapshot,"scope":"multiple","doneVerb":n.CommandDoneVerbCreated},"enabled":function(e){return e&&e.container&&e.nodes&&e.nodes.length>0},"execute":function(i,o){i.suppressSuccessMessage=!0,i.suppressFailMessage=!0;var s=e.Deferred(),a=i.container;return csui.require(["csui/utils/url","csui/utils/base","csui/utils/contexts/factories/node","csui/utils/contexts/factories/children","csui/utils/contexts/factories/children2","csui/controls/globalmessage/globalmessage","csui/widgets/nodestable/nodestable.view","csui/utils/contexts/factories/next.node","csui/behaviors/default.action/default.action.behavior"],function(e,r,c,l,d,p,u,h,m){function f(e,t){t.isLocallyCreated=!0,t.fetch().always(function(){e.add(t,{"at":0}),g(),s.resolve()})}function g(){var e={"context":i.context,"nextNodeModelFactory":h,"link_url":m.getDefaultActionNodeUrl(_),"targetFolder":_},o=t.str.sformat(n.snapshotCreatedWithName,x);p.showMessage("success_with_link",o,void 0,e)}var b=new FormData,w=JSON.stringify(i.nodes.map(function(e){return e.get("id")})).replace("[","{").replace("]","}"),v=r.formatISODateTime(new Date((new Date).getTime())),y=i.collection.options.data.snapshot||{},x=i.collection.options.data.foldername||y.folderNamePrefix||"";x=x.trim()+" "+v.substring(0,v.indexOf(".")).replace(/T/g," ").replace(/:/g,"."),x=x.trim(),b.append("body",JSON.stringify(t.extend({},{"snapshot_parent_name":y.parentFolderName,"snapshot_name":x,"bus_attach_ids":w})));var _,k=e.combine(a.connector.connection.url.replace("/v1","/v2"),"nodes",a.get("id"),"snapshots"),C={"type":"POST","url":k,"data":b,"contentType":!1,"processData":!1},T=i.context||o.context;a.connector.makeAjaxCall(C).done(function(e,t,i){u.useV2RestApi&&(l=d);var o=T.getModel(c),n=T.getCollection(l),r=Math.abs(e.results.data.parent_id);_=T.getModel(c,{"connector":a.connector,"attributes":{"id":e.results.data.id}});var p;e.results.parent&&(p=T.getModel(c,{"connector":a.connector,"attributes":e.results.parent})),o.get("id")===r?f(n,_):p&&o.get("id")===Math.abs(p.get("parent_id"))?f(n,p):(o=n.findWhere({"id":r}),o?o.fetch().always(function(){g(),s.resolve()}):(g(),s.resolve()))}).fail(function(e,t,i){var o=e.responseJSON&&new r.Error(e.responseJSON).error;p.showMessage("error",n.snapshotFailed,o),s.reject()})}),s.promise()}});return s}),csui.define("xecmpf/behaviors/toggle.header/toggle.header.behavior",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/utils/non-emptying.region/non-emptying.region","csui/lib/jquery.redraw"],function(e,t,i,o,n){"use strict";var s=500,a=i.Behavior.extend({"initialize":function(){this.listenTo(this.view,{"before:render":this.setTableRowSelectionToolbar,"render":this._setTableRowSelectionToolbarEventListeners}),this.tableHeader=this.options.tableHeader,this.container=this.options.alternatingTableContainer,this.tableToolbar=this.options.tableToolbar,this.tableRowSlectionToolbarViewOptions=this.options.tableRowSlectionToolbarViewOptions},"setTableRowSelectionToolbar":function(){if(this.view.tableView){this.view._tableRowSelectionToolbarView=new o(t.extend({"toolItemFactory":this.view.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.view.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"toolbarCommandController":this.view.commandController,"showCondensedHeaderToggle":!0,"commands":this.view.defaultActionController.commands,"selectedChildren":this.view.tableView.selectedChildren,"container":this.view.collection.node,"context":this.view.context,"originatingView":this.view,"collection":this.view.collection},this.tableRowSlectionToolbarViewOptions));var e=this.view._tableRowSelectionToolbarView;this.listenTo(e,"toggle:condensed:header",function(){var t,i=this.$el.find(this.tableHeader),o=this.$el.find(this.container);i.is(":visible")?(t=!1,i.slideUp(s),o.removeClass("xecmpf-show-header")):(t=!0,i.slideDown(s),o.addClass("xecmpf-show-header")),e.trigger("toolbar:activity",!0,t)})}},"_setTableRowSelectionToolbarEventListeners":function(){var e=new n({"el":this.tableToolbar});this.listenTo(this.view.tableView.selectedChildren,"reset",function(){e.show(this.view._tableRowSelectionToolbarView),this._onSelectionDisplayOrHide(this.view.tableView.selectedChildren.length)})},"_onSelectionDisplayOrHide":function(e){var t=this.$el.find(this.tableHeader),i=this.$el.find(this.tableToolbar),o=this.$el.find(this.container);e>0?i.is(":hidden")&&(t.slideUp(s),i.slideDown(s),this._triggerToolbarActivityEvent(!0,!1)):i.is(":visible")&&(i.slideUp(s),t.slideDown(s),o.removeClass("xecmpf-show-header"),this._triggerToolbarActivityEvent(!1,!0))},"_triggerToolbarActivityEvent":function(e,t){var i=this.view._tableRowSelectionToolbarView;i.trigger("toolbar:activity",e,t)}});return a}),csui.define("xecmpf/widgets/integration/folderbrowse/toolbaritems",["i18n!xecmpf/widgets/integration/folderbrowse/impl/nls/localized.strings","css!xecmpf/widgets/integration/folderbrowse/impl/folderbrowse"],function(e){var t={"leftToolbar":[{"signature":"WorkspaceHistory","name":e.BackButtonToolItem,"icon":"icon arrow_back "}],"rightToolbar":[{"signature":"SearchFromHere","name":e.SearchToolItem,"icon":"icon xecmpf-icon-search","group":"main","className":"csui-search-button"},{"signature":"WorkspacePage","name":e.PageWidgetToolItem,"icon":"icon csui-icon-open-full-page","group":"main","options":{"hAlign":"right"},"commandData":{"applyTheme":!0}}]};return t}),csui.define("xecmpf/widgets/boattachments/impl/boattachment.table/tablecell/createdby.view",["csui/lib/underscore","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/utils/base"],function(e,t,i,o){"use strict";var n=t.extend({"className":"csui-truncate","getValueText":function(){return n.getValue(this.model,this.options.column)}},{"getValue":function(t,i){var n,s=i.name,a=t.get(s+"_expand")||t.get(s)||"";return n=e.isObject(a)?o.formatMemberName(a):t.get(s+"_formatted")||a.toString()},"getModelExpand":function(e){return{"properties":[e.column.name]}}});return i.registerByDataType(14,n),i.registerByDataType(19,n),i.registerByColumnKey("createdby",n),n}),csui.define("xecmpf/widgets/boattachments/impl/boattachment.table/tablecell/modifiedby.view",["csui/lib/underscore","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/utils/base"],function(e,t,i,o){"use strict";var n=t.extend({"className":"csui-truncate","getValueText":function(){return n.getValue(this.model,this.options.column)}},{"getValue":function(t,i){var n,s=i.name,a=t.get(s+"_expand")||t.get(s)||"";return n=e.isObject(a)?o.formatMemberName(a):t.get(s+"_formatted")||a.toString()},"getModelExpand":function(e){return{"properties":[e.column.name]}}});return i.registerByDataType(14,n),i.registerByDataType(19,n),i.registerByColumnKey("modifiedby",n),n}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.listitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="xecmpf-eac-action-plan-list-item-selection-marker"></div>\r\n<a role="button" href="#" class="binf-flex-row xecmpf-eac-action-plan-name-link" aria-label="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" tabindex="'+this.escapeExpression((n=null!=(n=t.tabindex||(null!=e?e.tabindex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'" >\r\n    <span class="xecmpf-eac-action-plan-name">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n</a>\r\n<div role="button" class="binf-btn xecmpf-eac-action-plan-list-item-delete-btn"\r\n        aria-label="'+this.escapeExpression((n=null!=(n=t.deleteAria||(null!=e?e.deleteAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"deleteAria","hash":{}}):n))+'" tabindex="'+this.escapeExpression((n=null!=(n=t.tabindex||(null!=e?e.tabindex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="icon circle_delete_grey" title="'+this.escapeExpression((n=null!=(n=t.deleteTooltip||(null!=e?e.deleteTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"deleteTooltip","hash":{}}):n))+'"></span>\r\n</div>'}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.list_impl_actionplan.listitem",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.listitem",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.list/actionplan.listitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.listitem","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.listitem"],function(e,t,i,o,n,s){var a=o.ItemView.extend({"tagName":"li","className":function(){var e="xecmpf-eac-action-plan-list-item";return e+=this.model.get("plan_id")?"":" xecmpf-new-eac-action-plan-list-item"},"template":n,"constructor":function(e){e=e||{},o.ItemView.call(this,e)},"modelEvents":{"change":"onActionPlanListItemModelUpdate"},"templateHelpers":function(){var t=s.actionPlan+(this.model.get("plan_id")?" "+e.str.pad(this._index+1,2,"0"):"");return this.model.set("name",t,{"silent":!0}),{"tabindex":0===this._index?"0":"-1","name":this.model.get("name"),"deleteTooltip":s.deleteActionPlanButton,"deleteAria":s.deleteActionPlanButtonAria+" "+this.model.get("name")}},"triggers":{"click .xecmpf-eac-action-plan-name-link":"click:actionplan:item","click .xecmpf-eac-action-plan-list-item-delete-btn":"click:actionplan:delete"},"ui":{"actionPlanNameButton":".xecmpf-eac-action-plan-name-link","deleteButton":".xecmpf-eac-action-plan-list-item-delete-btn"},"events":{"focusout":function(e){this.trigger("actionplan:focusout",e)},"focus @ui.actionPlanNameButton":function(e){this._hasFocus=!0,this.$el.find(".xecmpf-eac-action-plan-list-item-delete-btn").show()},"keydown ":"onkeyInView"},"onkeyInView":function(e){switch(e.keyCode){case 37:e.preventDefault(),e.stopPropagation(),this.ui.actionPlanNameButton.trigger("focus");break;case 39:e.preventDefault(),e.stopPropagation(),this.ui.deleteButton.trigger("focus");break;case 46:e.preventDefault(),e.stopPropagation(),this.trigger("click:actionplan:delete");break;case 13:case 32:e.target.classList.contains("xecmpf-eac-action-plan-list-item-delete-btn")&&(e.preventDefault(),e.stopPropagation(),this.trigger("click:actionplan:delete"))}},"_setFocus":function(){this.ui.actionPlanNameButton.length>0&&this.ui.actionPlanNameButton.trigger("focus")},"onActionPlanListItemModelUpdate":function(){this.updateNewActionPlanIndication()},"updateNewActionPlanIndication":function(){this.$el.removeClass("xecmpf-new-eac-action-plan-list-item"),this.model.get("plan_id")||this.$el.addClass("xecmpf-new-eac-action-plan-list-item")}});return a}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'  <div class="cs-header xecmpf-eac-action-plan-header-region">\r\n    <div class="xecmpf-eac-action-plan-header">\r\n      <span class="cs-title xecmpf-eac-action-plan-header-text">'+this.escapeExpression((n=null!=(n=t.actionPlansListHeader||(null!=e?e.actionPlansListHeader:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"actionPlansListHeader","hash":{}}):n))+'</span>\r\n      <div title="'+this.escapeExpression((n=null!=(n=t.newActionPlanLabel||(null!=e?e.newActionPlanLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"newActionPlanLabel","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.newActionPlanLabel||(null!=e?e.newActionPlanLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"newActionPlanLabel","hash":{}}):n))+'" tabindex="0" role="button" class="binf-btn csui-groups-header-plus xecmpf-eac-add-action-plan-btn">\r\n        <span class="icon icon-toolbarAdd"></span>\r\n      </div>\r\n    </div> \r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return(null!=(n=t["if"].call(e,null!=e?e.showAddActionPlan:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")+'<div class="cs-content xecmpf-eac-action-plan-list binf-flex-column" role="navigation" aria-label="'+this.escapeExpression((s=null!=(s=t.actionPlansGroup||(null!=e?e.actionPlansGroup:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"actionPlansGroup","hash":{}}):s))+'"></div>'}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.list_impl_actionplan.list",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.list",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.list/actionplan.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/controls/tile/behaviors/perfect.scrolling.behavior","xecmpf/models/eac/eventactionplans.model","xecmpf/widgets/eac/impl/actionplan.list/actionplan.listitem.view","hbs!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.list","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.list/impl/actionplan.list"],function(e,t,i,o,n,s,a,r,c,l){var d=o.CollectionView.extend({"className":"xecmpf-action-plan-list-rows","tagName":"ul","constructor":function(e){e=e||{},this.options=e,this._focusIndex=0,o.CollectionView.prototype.constructor.call(this,e)},"childView":r,"childEvents":{"click:actionplan:item":"onActionPlanClickItem","click:actionplan:delete":"onActionPlanDelete","actionplan:focusout":"onFocusoutActionPlan"},"events":{"keydown":"onkeyInView"},"childViewOptions":function(e,t){return{"context":this.options.context}},"onActionPlanClickItem":function(e){this.triggerMethod("actionplan:click:item",e)},"onActionPlanDelete":function(e){this.triggerMethod("actionplan:click:delete",e)},"onkeyInView":function(e){var t,i=this.children.findByModel(this.collection.at(this._focusIndex));switch(e.keyCode){case 38:case 40:e.preventDefault(),e.stopPropagation(),38===e.keyCode&&this._focusIndex>0?this._focusIndex--:40===e.keyCode&&this._focusIndex<this.children.length-1&&this._focusIndex++,t=this.children.findByModel(this.collection.at(this._focusIndex)),this._changeTabIndexesAndSetFocus(i,t,!0),t._setFocus();break;case 36:e.preventDefault(),e.stopPropagation(),this._focusIndex=0,t=this.children.findByModel(this.collection.at(this._focusIndex)),this._changeTabIndexesAndSetFocus(i,t,!0),t._setFocus();break;case 35:e.preventDefault(),e.stopPropagation(),this._focusIndex=this.children.length-1,t=this.children.findByModel(this.collection.at(this._focusIndex)),this._changeTabIndexesAndSetFocus(i,t,!0),t._setFocus()}},"_changeTabIndexesAndSetFocus":function(e,t,i){e.$el.find("a").prop("tabindex",-1),e.$el.find(".xecmpf-eac-action-plan-list-item-delete-btn").prop("tabindex",-1),e.$el.find(".xecmpf-eac-action-plan-list-item-delete-btn").hide(),e._hasFocus=!1,t.$el.find("a").prop("tabindex",0),t.$el.find(".xecmpf-eac-action-plan-list-item-delete-btn").prop("tabindex",0),i&&t.$el.find(".xecmpf-eac-action-plan-list-item-delete-btn").show(),t._hasFocus=!0},"onFocusoutActionPlan":function(e,i){i.relatedTarget&&t.contains(this.el,i.relatedTarget)===!1&&e.$el.find(".xecmpf-eac-action-plan-list-item-delete-btn").hide()}}),p=o.LayoutView.extend({"className":"xecmpf-eac-action-plan-list-view","constructor":function(e){e=e||{},e.collection||(e.model.attributes.action_plans=e.model.attributes.action_plans.map(function(t){return t.namespace=e.model.attributes.namespace,t.event_name=e.model.attributes.event_name,t.event_id=e.model.attributes.event_id,t}),e.collection=new i.Collection(e.model.attributes.action_plans)),this.options=e,o.LayoutView.prototype.constructor.call(this,e)},"template":c,"templateHelpers":function(){return{"showAddActionPlan":!!this.options.showAddActionPlan,"newActionPlanLabel":l.newActionPlan,"actionPlansListHeader":l.actionPlansListHeader,"actionPlansGroup":l.actionPlansGroup}},"behaviors":{"PerfectScrolling":{"behaviorClass":s,"contentParent":".xecmpf-action-plan-list-rows","suppressScrollX":!0,"scrollYMarginOffset":15}},"regions":{"actionPlanListRegion":".xecmpf-eac-action-plan-list"},"onRender":function(){this.actionPlanListItemCollectionView=new d({"collection":this.options.collection,"context":this.options.context}),this.actionPlanListRegion.show(this.actionPlanListItemCollectionView),0===this.options.collection.length&&this.addNewActionPlan()},"ui":{"addActionEle":".xecmpf-eac-add-action-plan-btn"},"events":{"click @ui.addActionEle":"onAddActionPlanClick"},"childEvents":{"actionplan:click:item":"onActionPlanClick","actionplan:click:delete":"onActionPlanDelete"},"onActionPlanClick":function(e,t){this.trigger("actionplan:click:item",t)},"onActionPlanDelete":function(e,t){this.trigger("actionplan:click:delete",t)},"onAddActionPlanClick":function(e){this.trigger("actionplan:add:item",e)},"addNewActionPlan":function(){var e,t=new i.Model({"plan_id":"","process_mode":"","rule_id":"","rules":[{}],"namespace":this.options.model.attributes.namespace,"event_name":this.options.model.attributes.event_name,"event_id":this.options.model.attributes.event_id});this.actionPlanListItemCollectionView.collection.add(t),e=this.actionPlanListItemCollectionView.children.findByModel(t),e.trigger("click:actionplan:item")},"fetchEventActionPlans":function(){var e=t.Deferred(),i=new a(void 0,{"connector":this.options.context.getObject(n)});return i.fetch().done(function(){e.resolve(i)},function(){e.reject()}),e.promise()},"refreshCurrentActionPlanItem":function(e){var i,o=e.planID,n=t.Deferred();if(i="create"===e.operation?this.actionPlanListItemCollectionView.collection.findWhere({"plan_id":""}):this.actionPlanListItemCollectionView.collection.findWhere({"plan_id":o})){var s=this.actionPlanListItemCollectionView.children.findByModel(i);this.fetchEventActionPlans().then(function(t){var a=t.findWhere({"event_id":e.event_id});if(a&&a.get("action_plans")){var r=a.get("action_plans").filter(function(e){return e.plan_id===o});r.length>0&&i.set(r[0],{"sort":!1})}n.resolve(s)},function(){n.reject()})}else n.reject();return n.promise()}});return p}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.header/impl/actionplan.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="xecmpf-back-button-container" title="'+this.escapeExpression((n=null!=(n=t.backTitle||(null!=e?e.backTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"backTitle","hash":{}}):n))+'" tabindex="0"\r\n     aria-label="'+this.escapeExpression((n=null!=(n=t.backTitle||(null!=e?e.backTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"backTitle","hash":{}}):n))+'" role="button">\r\n  <span class="arrow_back cs-go-back"></span>\r\n</div>\r\n<div class="xecmpf-actionplan-title">\r\n  <h2 class="title">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</h2>\r\n</div>\r\n"}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.header_impl_actionplan.header",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.header/impl/actionplan.header",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.header/actionplan.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!xecmpf/widgets/eac/impl/actionplan.header/impl/actionplan.header","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.header/impl/actionplan.header"],function(e,t,i,o,n){var s=i.ItemView.extend({"className":"xecmpf-actionplan-header","template":o,"events":{"keydown .xecmpf-back-button-container":"onKeyInView","click .cs-go-back":"onClickBackButton"},"templateHelpers":function(){return{"title":this.model.get("event_name"),"backTitle":n.backTitle}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments)},"onKeyInView":function(e){(32===e.keyCode||13===e.keyCode)&&this.onClickBackButton()},"onClickBackButton":function(){this.trigger("actionplan:click:back")}});return s}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.processmode/impl/actionplan.processmode",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div class=\'xecmpf-eac-processmode-view\'>\r\n    <div class="xecmpf-eac-header">\r\n        <h4 class="xecmpf-eac-processmode-header" title="{{options.header}}" aria-label="{{options.header}}"><span class="binf-glyphicon binf-glyphicon-star alpaca-icon-required"></span>{{options.header}}</h4>\r\n    </div>\r\n    <div class="xecmpf-eac-processmode-form">\r\n        <div class="xecmpf-eac-processmode-runas" id="xecmpf-eac-processmode-run_as"></div>\r\n        <div class="xecmpf-eac-processmode-processmode" id="xecmpf-eac-processmode-process_mode"></div>\r\n    </div>\r\n</div>'}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.processmode_impl_actionplan.processmode",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.processmode/impl/actionplan.processmode",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.processmode/actionplan.processmode.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/controls/form/form.view","hbs!xecmpf/widgets/eac/impl/actionplan.processmode/impl/actionplan.processmode","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.processmode/impl/actionplan.processmode"],function(e,t,i,o,n,s,a){var r=n.extend({"constructor":function(e){n.prototype.constructor.call(this,e)},"formTemplate":s,"formTemplateHelpers":function(){return{"header":a.processModeTabLabel}},"_getLayout":function(){var e=this.getOption("formTemplate"),t=e.call(this,{"data":this.alpaca.data,"mode":this.mode}),i=this._getBindings(),o={"parent":"bootstrap-csui","layout":{"template":t,"bindings":i}};return o},"_getBindings":function(){return{"run_as":"xecmpf-eac-processmode-run_as","process_mode":"xecmpf-eac-processmode-process_mode"}}});return r}),csui.define("xecmpf/widgets/eac/impl/actionplan.processmode/impl/actionplan.processmode.form.model",["csui/models/form","i18n!xecmpf/widgets/eac/impl/nls/lang"],function(e,t){var i=e.extend({"constructor":function(t,i){this.options=i||(i={}),t||(t={"schema":{"properties":{}},"options":{"fields":{}},"date":{}}),e.prototype.constructor.call(this,t,i)},"initialize":function(e,t){this._setAttributes()},"_setAttributes":function(){var e=this,i="",o="";this.options.eventModel&&this.options.eventModel.attributes&&this.options.eventModel.attributes.process_mode&&(o=this.options.eventModel.attributes.process_mode),this.options.eventModel&&this.options.eventModel.attributes&&this.options.eventModel.attributes.run_as_key&&(i=this.options.eventModel.attributes.run_as_key),this.set({"schema":{"properties":{"run_as":{"required":!0,"type":"otcs_user_picker"},"process_mode":{"enum":["Synchronously","Asynchronously"],"required":!0,"type":"string"}}},"options":{"fields":{"run_as":{"label":t.runAs,"type":"otcs_user_picker","events":{"change":function(){e.setValue(this.path,this.getValue())}}},"process_mode":{"label":t.processMode,"type":"select","optionLabels":[t.synchronouslyProcessLabel,t.asynchronouslyProcessLabel],"events":{"change":function(){e.setValue(this.path,this.getValue())}},"removeDefaultNone":!0}}},"data":{"run_as":i,"process_mode":o}})}});return i}),csui.define("xecmpf/models/eac/eac.planproperties.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/utils/url"],function(e,t,i,o,n,s){var a=i.Model.extend({"constructor":function(e,t){this.options=t||{},i.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(t)},"parse":function(e){return e}});o.mixin(a.prototype);var r=i.Collection.extend({"model":a,"constructor":function(e,t){this.options=t||{},i.Collection.prototype.constructor.apply(this,arguments),this.makeConnectable(t).makeFetchable(t)},"url":function(){var e=new s(this.connector.connection.url).getApiBase("v2");return e=s.combine(e,"eventactioncenter","eventproperties"),e+this.queryParamsToString(this.options.query)},"parse":function(e){return e.results.data},"queryParamsToString":function(i){var o="";return e.isEmpty(i)||(o="?"+t.param(i)),o.replace(/%5B%5D/g,"")}});return o.mixin(r.prototype),n.mixin(r.prototype),r}),csui.define("xecmpf/models/eac/eac.planproperties.factory",["csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","xecmpf/models/eac/eac.planproperties.model"],function(e,t,i,o,n){var s=i.extend({"propertyPrefix":"EACPlanPropertiesCollection","constructor":function(s,a){i.prototype.constructor.apply(this,arguments);var r=this.options.EACPlanPropertiesCollection||{};if(!(r instanceof t.Collection)){var c,l;a.eventModel.get?(c=a.eventModel.get("namespace"),l=a.eventModel.get("event_name")):(c=a.eventModel.attributes.namespace,l=a.eventModel.attributes.event_name),r=new n(r.models,e.extend({"connector":s.getModel(o),"query":{"event_name":l,"system_name":c},"autofetch":!0},r.options))}this.property=r},"fetch":function(e){return this.property.fetch(e)}});return s}),csui.define("xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules.form.model",["csui/lib/underscore","csui/models/form","xecmpf/models/eac/eac.planproperties.factory","i18n!xecmpf/widgets/eac/impl/nls/lang"],function(e,t,i,o){var n=t.extend({"constructor":function(e,i){this.options=i||(i={}),e||(e={"data":{},"schema":{"properties":{}},"options":{"fields":{}}}),t.prototype.constructor.call(this,e,i)},"initialize":function(e,t){var o=t.eventModel.get("namespace")||"",n=t.eventModel.get("event_name")||"",s=t.context.getCollection(i,{"eventModel":t.eventModel,"attributes":{"namespace":o,"event_name":n}});s.planProperties?this._setAttributes(s.planProperties):(this.listenToOnce(s,"sync",function(){s.planProperties=s.map(function(e){return e.get("name")}),this._setAttributes(s.planProperties)}),s.fetch())},"_setAttributes":function(e){var t=[];this.options.collection&&(t=this.options.collection.models.map(function(e,t){return{"from":e.get("operand"),"operator":e.get("operator"),"to":e.get("to"),"conjunction":e.get("conjunction")}})),this.set({"data":{"rulesSet":t},"options":{"fields":{"rulesSet":{"fields":{"item":{"fields":{"from":{"hidden":!1,"hideInitValidationError":!0,"label":"","readonly":!1,"type":"select","validator":function(e){var t=!1,i=(this.getValue(),this.getParent().getParent()),o=!1,n=this.getParent();1!==i.children.length||n.data.operator||n.data.to||(o=!0),(this.getValue()||o)&&(t=!0),e({"status":t})}},"operator":{"hidden":!1,"hideInitValidationError":!0,"optionLabels":[o.operatorEqualtoLabel,o.operatorNotequaltoLabel],"label":"","readonly":!1,"type":"select","validator":function(e){var t=!1,i=(this.getValue(),this.getParent().getParent()),o=!1,n=this.getParent();
1!==i.children.length||n.data.from||n.data.to||(o=!0),(this.getValue()||o)&&(t=!0),e({"status":t})}},"to":{"hidden":!1,"hideInitValidationError":!0,"label":"","readonly":!1,"type":"text","validator":function(e){var t=!1,i=(this.getValue(),this.getParent().getParent()),o=!1,n=this.getParent();1!==i.children.length||n.data.operator||n.data.from||(o=!0),(this.getValue()||o)&&(t=!0),e({"status":t})}},"conjunction":{"hidden":!1,"hideInitValidationError":!0,"optionLabels":[o.conjunctionAndLabel,o.conjunctionOrLabel],"label":"","readonly":!1,"type":"select","removeDefaultNone":!0,"validator":function(e){var t=!1,i=this.getParent().getParent(),o=i.children[i.children.length-1].id===this.getParent().id;(this.getValue()||o)&&(t=!0),e({"status":t})}}},"type":"object"}},"hidden":!1,"hideInitValidationError":!0,"items":{"showMoveDownItemButton":!1,"showMoveUpItemButton":!1},"label":"","toolbarSticky":!0,"showMessages":!1,"isSetType":!0}}},"schema":{"properties":{"rulesSet":{"items":{"defaultItems":1,"maxItems":50,"minItems":1,"properties":{"from":{"enum":e,"readonly":!1,"title":"","type":"string"},"operator":{"enum":["Equal to","Not equal to"],"readonly":!1,"title":"","type":"string"},"to":{"maxLength":248,"minLength":1,"readonly":!1,"title":"","type":"string"},"conjunction":{"enum":["And","Or"],"readonly":!1,"title":"","type":"string"}},"type":"object"},"title":"","type":"array"}},"type":"object"}})}});return n}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div>\r\n    <div class="xecmpf-eac-rules-header-wrapper binf-col-md-12 xecmpf-eac-header">\r\n        <h4 class="xecmpf-eac-rules-header" title="{{options.rulesLabel}}" aria-label="{{options.rulesLabel}}">{{options.rulesLabel}}</h4>\r\n    </div>\r\n    <div class="xecmpf-eac-rules-container-wrapper">\r\n        <div class="binf-row">\r\n            <div class="xecmpf-eac-rules-container binf-col-md-12 cs-form-singlecolumn csui-form-set-array-wrapper cs-form-set"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.rules_impl_actionplan.rules",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.rules/actionplan.rules.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/controls/form/form.view","csui/controls/progressblocker/blocker","xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules.form.model","hbs!xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules","csui/controls/globalmessage/globalmessage","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules"],function(e,t,i,o,n,s,a,r,c,l,d){var p=s.extend({"className":function(){var e=s.prototype.className.call(this);return e+=" xecmpf-eac-rules xecmpf-eac-rules-hide-validation-errors",e+=this.options.isNewActionPlan?" xecmpf-eac-new-action-plan-rules":""},"constructor":function(e){s.prototype.constructor.call(this,e)},"ui":{"pullRight":".cs-pull-right"},"events":{"mouseenter @ui.pullRight":"onMouseEnterOnActionButtons","mouseleave @ui.pullRight":"onMouseLeaveFromActionButtons"},"formTemplate":c,"formTemplateHelpers":function(){return{"rulesLabel":d.rulesLabel,"rulesSetLegend":d.rulesSetLegend}},"onRenderForm":function(){var e=".xecmpf-eac-rules-container .cs-form-set .cs-array.alpaca-container-item";this.$el.find(e).addClass("xecmpf-eac-existing-rule")},"_getLayout":function(){s.prototype._getLayout.call(this);var e=this.getOption("formTemplate"),t=e.call(this,{"data":this.alpaca.data,"mode":this.mode}),i=this._getBindings(),o={"parent":"bootstrap-csui","layout":{"template":t,"bindings":i}};return o},"_getBindings":function(){return{"rulesSet":".xecmpf-eac-rules-container"}},"isFormValid":function(){return this.$el.removeClass("xecmpf-eac-rules-hide-validation-errors"),this.validate()},"getSubmitData":function(){var e=this.getValues().rulesSet;return 1===e.length&&!e[0].operator&&!e[0].from&&!e[0].to&&(e=[]),e},"onMouseEnterOnActionButtons":function(e){var i=t(e.currentTarget);i.find("button").hasClass("binf-hidden")&&i.parent().find(".cs-pull-left .cs-field-write").trigger("mouseenter")},"onMouseLeaveFromActionButtons":function(e){var i=t(e.currentTarget);i.find("button").hasClass("binf-hidden")||i.parent().find(".cs-pull-left .cs-field-write").trigger("mouseleave")}});return p}),csui.define("xecmpf/models/eac/eac.defaultplans.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/utils/url"],function(e,t,i,o,n,s){var a=i.Model.extend({"constructor":function(e,t){t||(t={}),i.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(t)},"parse":function(e){return e}});o.mixin(a.prototype);var r=i.Collection.extend({"model":a,"constructor":function(e,t){this.options=t||{},i.Collection.prototype.constructor.apply(this,arguments),this.makeConnectable(t).makeFetchable(t)},"url":function(){var e=new s(this.connector.connection.url).getApiBase("v2");return e=s.combine(e,"eventactioncenter","actions"),e+this.queryParamsToString(this.options.query)},"parse":function(e){return e.results.actions},"queryParamsToString":function(i){var o="";return e.isEmpty(i)||(o="?"+t.param(i)),o.replace(/%5B%5D/g,"")}});return o.mixin(r.prototype),n.mixin(r.prototype),r}),csui.define("xecmpf/models/eac/eac.defaultplans.factory",["csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","xecmpf/models/eac/eac.defaultplans.model"],function(e,t,i,o,n){var s=i.extend({"propertyPrefix":"EACDefaultPlansCollection","constructor":function(s,a){i.prototype.constructor.apply(this,arguments);var r=this.options.EACDefaultPlansCollection||{};r instanceof t.Collection||(r=new n(r.models,e.extend({"connector":s.getModel(o),"autofetch":!0},r.options))),this.property=r},"fetch":function(e){return this.property.fetch(e)}});return s}),csui.define("xecmpf/widgets/eac/impl/actionplan.actions/impl/actionplan.actions.form.model",["csui/lib/underscore","csui/lib/jquery","csui/models/form","xecmpf/models/eac/eac.planproperties.factory","xecmpf/models/eac/eac.defaultplans.factory","i18n!xecmpf/widgets/eac/impl/nls/lang"],function(e,t,i,o,n,s){var a=i.extend({"constructor":function(e,t){this.options=t||(t={}),e||(e={"data":{},"options":{},"schema":{}}),i.prototype.constructor.call(this,e,t)},"initialize":function(e,i){var s=[],a=i.eventModel.get("namespace"),r=i.eventModel.get("event_name"),c=i.context.getCollection(n),l=i.context.getCollection(o,{"eventModel":i.eventModel,"attributes":{"namespace":a,"event_name":r}});c.fetched||s.push(c.fetch()),l.planProperties||s.push(l.fetch()),t.when.apply(t,s).done(function(){l.planProperties=l.map(function(e){return e.get("name")}),e&&e.data&&e.data.action?(c.actions=e.data[e.data.action+"_fields"],this._setAttributes(c,l.planProperties)):this._setAttributes(c,l.planProperties)}.bind(this))},"_setAttributes":function(e,t){for(var i={"options":{"fields":{"actionsData":{"fields":{"item":{"type":"object","fields":{"action":{"readonly":!1,"type":"select"}}}}}}},"schema":{"type":"object","properties":{"actionsData":{"type":"array","items":{"defaultItems":1,"maxItems":50,"minItems":1,"type":"object","properties":{"action":{"enum":["CreateOrUpdateEventAction.Create Or Update Workspace","DocGenEventAction.Create document"],"readonly":!1,"required":!0,"type":"string"}}}}}}},o=[],n=[],a=0;a<e.models.length;a++){var r=e.models[a].get("action_key");o.push(r),n.push(e.models[a].get("action_name"));var c,l;c=i.schema,c.properties.actionsData.items.properties[r+"_fields"]={"properties":{},"dependencies":"action","type":"object"};var d=c.properties.actionsData.items.properties[r+"_fields"].properties;l=i.options,l.fields.actionsData.fields.item.fields[r+"_fields"]={"fields":{},"dependencies":{"action":r}};var p=l.fields.actionsData.fields.item.fields[r+"_fields"].fields;if(d.actionattributes={"type":"object","properties":{"parametername":{"readonly":!0,"required":!1,"type":"text","default":s.actionAttrParameterNameLabel},"sourcelabel":{"readonly":!0,"required":!1,"type":"text","default":s.actionAttrSourceLabel},"valuelabel":{"readonly":!0,"required":!1,"type":"text","default":s.actionAttrValueLabel}}},p.actionattributes={"type":"object","fields":{"parametername":{"type":"text","label":s.actionAttrParameterNameLabel,"readonly":!0},"sourcelabel":{"type":"text","label":s.actionAttrSourceLabel,"readonly":!0},"valuelabel":{"type":"text","label":s.actionAttrValueLabel,"readonly":!0}}},e.models[a].get("actions_attributes").length>0)for(var u=e.models[a].get("actions_attributes"),h=0;h<u.length;h++){var m=u[h].required,f=u[h].key;d[f]={"type":"object","properties":{"actionattrname":{"readonly":!0,"required":!1,"type":"text","default":e.models[a].attributes.actions_attributes[h].name},"source":{"type":"string","required":m,"enum":["csObj","evtProp","prevAct"]},"csObj_field":{"dependencies":"source","type":"string","required":!0},"evtProp_field":{"dependencies":"source","type":"string","required":!0,"enum":t},"prevAct_field":{"dependencies":"source","type":"string","required":!0,"readonly":!0}}},p[f]={"type":"object","fields":{"actionattrname":{"type":"text","readonly":!0,"fieldClass":"eac-mandatory-field-indication","label":e.models[a].attributes.actions_attributes[h].name},"source":{"type":"select","label":s.sourceLabel,"optionLabels":[s.csObjLabel,s.evtPropLabel,s.prevActLabel]},"csObj_field":{"type":"otcs_node_picker","label":e.models[a].get("actions_attributes")[h].name,"type_control":{"parameters":{"startLocations":["csui/dialogs/node.picker/start.locations/current.location","csui/dialogs/node.picker/start.locations/enterprise.volume","csui/dialogs/node.picker/start.locations/personal.volume","csui/dialogs/node.picker/start.locations/favorites","csui/dialogs/node.picker/start.locations/recent.containers","csui/dialogs/node.picker/start.locations/category.volume","csui/dialogs/node.picker/start.locations/perspective.assets.volume","recman/dialogs/node.picker/start.locations/classifications.volume","xecmpf/dialogs/node.picker/start.locations/extended.ecm.volume.container"]}},"dependencies":{"source":"csObj"}},"evtProp_field":{"type":"select","label":e.models[a].get("actions_attributes")[h].name,"dependencies":{"source":"evtProp"}},"prevAct_field":{"label":e.models[a].get("actions_attributes")[h].name,"type":"text","dependencies":{"source":"prevAct"}}}}}}i.schema.properties.actionsData.items.properties.action["enum"]=o,i.options.fields.actionsData.fields.item.fields.action.optionLabels=n,i.data=this.getFormData(this.options.collection,e),this.set(i)},"getFormData":function(e,t){var i=[];if(e.models&&e.models.length>0)i=e.models.map(function(e,i){var o=e.get("action_key"),n={"action":o};return t.models.forEach(function(t){var i=t.get("action_key")+"_fields";n[i]={"actionattributes":{"parametername":s.actionAttrParameterNameLabel,"sourcelabel":s.actionAttrSourceLabel,"valuelabel":s.actionAttrValueLabel}},t.get("actions_attributes").filter(function(e){n[i][e.key]={"actionattrname":"","source":"","csObj_field":"","evtProp_field":"","prevAct_field":""}}),t.get("action_key")===o&&e.get("attribute_mappings").forEach(function(e){var i=t.get("actions_attributes").filter(function(t){return t.key===e.action_attr_name}),s="",a="",r="",c="";i=i.length>0?i[0]:i,s=e.mapping_method,a=e.mapping_data,"Content Server Object"===s?(s="csObj",r=a):"Event Property"===s?(s="evtProp",c=a):"Result from previous Action"===s&&(s="prevAct"),n[o+"_fields"][e.action_attr_name]={"actionattrname":i.name,"source":s,"csObj_field":r,"evtProp_field":c,"prevAct_field":"Result from previous action"}})}),n});else{var o={"action":""};t.models.forEach(function(e){var t=e.get("action_key")+"_fields";o[t]={"actionattributes":{"parametername":s.actionAttrParameterNameLabel,"sourcelabel":s.actionAttrSourceLabel,"valuelabel":s.actionAttrValueLabel}},e.get("actions_attributes").filter(function(e){o[t][e.key]={"actionattrname":"","source":"","csObj_field":"","evtProp_field":"","prevAct_field":""}})}),i.push(o)}return{"actionsData":i}}});return a}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.actions/impl/actionplan.actions",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div>\r\n    <div class="xecmpf-eac-actions-header-wrapper binf-col-md-12 xecmpf-eac-header">\r\n        <h4 class="xecmpf-eac-actions-header" title="{{options.actionsLabel}}" aria-label="{{options.actionsLabel}}"><span class="binf-glyphicon binf-glyphicon-star alpaca-icon-required"></span>{{options.actionsLabel}}</h4>\r\n    </div>\r\n    <div class="xecmpf-eac-actions-container-wrapper">\r\n        <div class="binf-row">\r\n            <div class="xecmpf-eac-actions-container binf-col-md-12 csui-form-set-array-wrapper">\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.actions_impl_actionplan.actions",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.actions/impl/actionplan.actions",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.actions/actionplan.actions.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/controls/form/form.view","csui/controls/progressblocker/blocker","csui/controls/globalmessage/globalmessage","xecmpf/widgets/eac/impl/actionplan.actions/impl/actionplan.actions.form.model","hbs!xecmpf/widgets/eac/impl/actionplan.actions/impl/actionplan.actions","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.actions/impl/actionplan.actions"],function(e,t,i,o,n,s,a,r,c,l,d){var p=s.extend({"className":function(){var e=s.prototype.className.call(this);return e+=" xecmpf-eac-actions xecmpf-eac-actions-hide-validation-errors"},"constructor":function(e){var t,o=e.eventModel&&e.eventModel.get("actions")||[];t=o.map(function(e,t){return new i.Model({"sequence":t+1,"action_key":e.action_key,"attribute_mappings":e.attribute_mappings})}),this.collection=new i.Collection,this.collection.add(t),e.model=new c(void 0,{"context":e.context,"eventModel":e.eventModel,"collection":this.collection}),e.mode="create",e.layoutMode="doubleCol",e.breakFieldsAt=3,s.prototype.constructor.call(this,e)},"formTemplate":l,"formTemplateHelpers":function(){return{"actionsLabel":d.actionsTabLabel}},"_getLayout":function(){var e=(s.prototype._getLayout.call(this),this.getOption("formTemplate")),t=e.call(this,{"data":this.alpaca.data,"mode":this.mode}),i=this._getBindings(),o={"parent":"bootstrap-csui","layout":{"template":t,"bindings":i}};return o},"_getBindings":function(){return{"actionsData":".xecmpf-eac-actions-container"}},"getSubmitData":function(){var e=this.getValues().actionsData;return e}});return p}),csui.define("xecmpf/widgets/eac/impl/actionplan.tab.content/actionplan.tab.content.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/base","csui/utils/contexts/factories/connector","csui/controls/tab.panel/tab.panel.view","csui/controls/tab.panel/tab.links.ext.view","csui/controls/tab.panel/tab.links.ext.scroll.mixin","csui/models/form","csui/controls/form/form.view","csui/controls/globalmessage/globalmessage","csui/widgets/metadata/metadata.properties.view","csui/controls/progressblocker/blocker","csui/controls/tile/behaviors/perfect.scrolling.behavior","xecmpf/widgets/eac/impl/actionplan.processmode/actionplan.processmode.view","xecmpf/widgets/eac/impl/actionplan.processmode/impl/actionplan.processmode.form.model","xecmpf/widgets/eac/impl/actionplan.rules/impl/actionplan.rules.form.model","xecmpf/widgets/eac/impl/actionplan.rules/actionplan.rules.view","xecmpf/widgets/eac/impl/actionplan.actions/actionplan.actions.view","i18n!xecmpf/widgets/eac/impl/nls/lang"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v){var y={"ERROR_ACTION_PLAN_CREATION":v.genericWarningMsgOnDeletion},x=s.extend({"className":(o.isTouchBrowser()?"cs-touch-browser ":"")+"cs-metadata-actionplan-content cs-metadata-properties binf-panel binf-panel-default","contentView":function(t){var i=l,o=e.findWhere(this._propertyPanels,{"model":t});if(o)return o.contentView||l;switch(t.get("role_name")){case"rules":i=b;break;case"actions":i=w;break;case"processMode":i=m}return i},"contentViewOptions":function(t){var o=this.options.node,n={"eventModel":o,"context":this.options.context},s=e.findWhere(this._propertyPanels,{"model":t});switch(t.get("role_name")){case"rules":var a,r,c=new i.Collection,l=[{}];o&&o.get("rules")&&o.get("rules").length>0&&(l=o.get("rules")),a=l.map(function(e,t){return new i.Model({"sequence":t+1,"operand":e.operand||"","operator":e.operator||"","to":e.value||"","conjunction":e.conjunction||""})}),c.set(a),r=new g(void 0,{"context":this.options.context,"eventModel":o,"collection":c}),e.extend(n,{"mode":"create","model":r,"isNewActionPlan":!o.get("plan_id")});break;case"actions":e.extend(n,{"summary":!1});break;case"processMode":var d=new f(void 0,{"context":this.options.context,"eventModel":o});e.extend(n,{"mode":"create","model":d})}return s&&e.extend(n,s.contentViewOptions),n},"isTabable":function(){return this.options.notTabableRegion===!0?!1:!0},"constructor":function(o){o||(o={}),e.defaults(o,{"tabType":"binf-nav-pills","mode":"spy","extraScrollTopOffset":3,"formMode":"create","toolbar":!0,"contentView":this.getContentView,"TabLinkCollectionViewClass":a,"tabContentAccSelectors":"a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[cstabindex], *[contenteditable]"}),o.collection=new i.Collection;var r=new i.Collection,c=[{"role_name":"rules","title":v.rulesTabLabel},{"role_name":"actions","title":v.actionsTabLabel,"required":!0},{"role_name":"processMode","title":v.processModeTabLabel,"required":!0}];c.forEach(function(e){r.push(new i.Model(e))}),this.eacEventActionPlans=r,s.prototype.constructor.apply(this,arguments),this.connector=this.options.context.getObject(n),this.options.blockingParentView?u.delegate(this,this.options.blockingParentView):u.imbue(this),this.listenTo(this.eacEventActionPlans,"request",this.blockActions).listenTo(this.eacEventActionPlans,"request",this._checkFormFetching).listenTo(this.eacEventActionPlans,"sync",this._syncForms).listenTo(this.eacEventActionPlans,"sync",this.unblockActions).listenTo(this.eacEventActionPlans,"destroy",this.unblockActions).listenTo(this.eacEventActionPlans,"error",this.unblockActions).listenTo(this.collection,"reset",this.render),this.eacEventActionPlans.trigger("sync"),this.eacEventActionPlans.fetching&&this.blockActions(),t(window).on("resize",e.bind(this._onWindowResize,this)),this.listenTo(this,"render",this.onRendered)},"behaviors":{"PerfectScrolling":{"behaviorClass":h,"contentParent":"> .binf-tab-content","scrollXMarginOffset":30,"scrollYMarginOffset":15}},"onBeforeDestroy":function(){t(window).off("resize",this._onWindowResize)},"render":function(){return s.prototype.render.apply(this),this._initializeOthers(),this},"onRendered":function(){this._setTablinksAttributes(),setTimeout(e.bind(this._setTablinksAttributes,this),300),this.tabLinks.stopListening(this.collection,"reset"),this.tabContent.stopListening(this.collection,"reset"),this.tabLinks.$el.addClass("binf-hidden"),this.tabContent.$el.addClass("binf-hidden"),this.blockActions();var i=[],o=this;this.tabContent.children.each(e.bind(function(e){var o=t.Deferred();i.push(o.promise()),e.content instanceof l?this.listenTo(e.content,"render:form",function(){o.resolve()}):o.resolve()},this)),t.when.apply(t,i).done(function(){o.unblockActions(),o.tabLinks.$el.removeClass("binf-hidden"),o.tabContent.$el.removeClass("binf-hidden"),o._initializeOthers(),o.triggerMethod("render:forms",this);var e=t.Event("tab:content:render");o.$el.trigger(e),o.trigger("update:scrollbar")})},"onPanelActivated":function(){setTimeout(e.bind(function(){this._setTablinksAttributes(),this._enableToolbarState(".tab-links .tab-links-bar > ul li")},this),300)},"_setTablinksAttributes":function(){var e,i,o=5,n=this.$el.parent();for(e=0;o>e;e++){if(i=n.siblings(".cs-tab-links.binf-dropdown"),i.length>0){var s=t(i[0]).width();if(s>15){var a=s-12,r=a+"px",c=this.rtlEnabled?"margin-right":"margin-left",l=this.$el.find(".tab-links");l.css({"width":function(){return"calc(100% - "+r+")"}}),l.css(c,r)}break}n=n.parent()}},"_syncForms":function(){this._fetchingForms=!1;var t=this.eacEventActionPlans.where({"role_name":"rules"});t=e.union(t,this.eacEventActionPlans.where({"role_name":"actions"})),t=e.union(t,this.eacEventActionPlans.where({"role_name":"processMode"})),this.panelModelsLength=t.length,this._normalizeModels(t),this.collection.reset(t)},"_normalizeModels":function(t){e.each(t,function(e){if(e instanceof c){var t=e.get("schema");t&&t.title&&e.set("title",t.title)}null==e.get("id")&&e.set("id",e.cid),e.collection&&e.collection.remove(e)})},"_initializeOthers":function(){var t={"gotoPreviousTooltip":"","gotoNextTooltip":""};this._initializeToolbars(t),this._listenToTabEvent(),setTimeout(e.bind(this._enableToolbarState,this),300)},"_onWindowResize":function(){this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(e.bind(function(){this._setTablinksAttributes(),this._enableToolbarState()},this),200)},"saveActionPlanContent":function(){return this.isAllFormsValid()?this.makeActionPlanServiceCall():t.Deferred().reject("FORM_NOT_VALID")},"isAllFormsValid":function(){var e=!0;return this.tabContent.children.forEach(function(t){t.model.get("role_name");t.content.isFormValid?t.content.isFormValid()||(e=!1):t.content instanceof l&&(t.content.validate()||(e=!1))}),e},"getFormsData":function(){var e={};return this.tabContent.children.forEach(function(t){var i=t.model.get("role_name");i="processMode"===i?"summary":i,t.content.getSubmitData?e[i]=t.content.getSubmitData():t.content instanceof l&&(e[i]=t.content.getValues())}),e},"getGeneralInformation":function(){var e={},t=this.options.node;return e.event_id=t.get("event_id"),e.namespace=t.get("namespace"),e.event_name=t.get("event_name"),e.rule_id=t.get("rule_id"),e.plan_id=t.get("plan_id"),e},"makeActionPlanServiceCall":function(){var e=this,i=this.connector.getConnectionUrl().getApiBase("v2")+"/eventactioncenter/actionplan",o=new FormData,n=this.getFormsData(),s=t.Deferred();return n.gen_information=this.getGeneralInformation(),o.append("action_plan_items",JSON.stringify(n)),this.blockActions(),this.connector.makeAjaxCall({"type":"PUT","url":i,"data":o,"processData":!1,"contentType":!1}).then(function(t){if(200===t.results.statusCode&&t.results.ok){d.showMessage("success",t.results.msg);var i={"planID":t.results.data.planID,"operation":""!==n.gen_information.plan_id?"update":"create","event_id":n.gen_information.event_id};e.trigger("refresh:current:action:plan:item",i),s.resolve()}else s.reject("FORM_NOT_SAVED")},function(e){var t=e.responseJSON&&(e.responseJSON.errorDetail||e.responseJSON.error)||y.ERROR_ACTION_PLAN_CREATION;d.showMessage("error",t),s.reject("FORM_NOT_SAVED")}).always(function(){e.unblockActions()}),s.promise()}});return e.extend(x.prototype,r),x}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.tab.content/impl/actionplan.tabbed.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="xecmpf-eac-actionplan-content"></div>\r\n<div class="xecmpf-eac-actionplan-footer-container">\r\n    <div class="xecmpf-eac-actionplan-footer binf-right">\r\n        <button title="'+this.escapeExpression((n=null!=(n=t.save||(null!=e?e.save:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"save","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.save||(null!=e?e.save:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"save","hash":{}}):n))+'" class="binf-btn binf-btn-primary xecmpf-eac-save-actionplan">\r\n            '+this.escapeExpression((n=null!=(n=t.save||(null!=e?e.save:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"save","hash":{}}):n))+'</button>\r\n        <button title="'+this.escapeExpression((n=null!=(n=t.cancel||(null!=e?e.cancel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.cancel||(null!=e?e.cancel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel","hash":{}}):n))+'" class="cancel-btn binf-btn binf-btn-default xecmpf-eac-cancel-actionplan">'+this.escapeExpression((n=null!=(n=t.cancel||(null!=e?e.cancel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel","hash":{}}):n))+"</button>\r\n    </div>\r\n</div>"}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.tab.content_impl_actionplan.tabbed.view",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.tab.content/impl/actionplan.tabbed.view",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.tab.content/actionplan.tabbed.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/utils/page.leaving.blocker","xecmpf/widgets/eac/impl/actionplan.tab.content/actionplan.tab.content.view","i18n!xecmpf/widgets/eac/impl/nls/lang","hbs!xecmpf/widgets/eac/impl/actionplan.tab.content/impl/actionplan.tabbed.view","css!xecmpf/widgets/eac/impl/actionplan.tab.content/impl/actionplan.tabbed.view"],function(e,t,i,o,n,s,a,r,c){var l=o.ItemView.extend({"className":"metadata-inner-wrapper xecmpf-eac-actionplan-tabbed-inner-wrapper","template":c,"templateHelpers":function(){return{"save":this.model.get("plan_id")?r.saveLabel:r.createLabel,"cancel":r.closeLabel}},"events":{"click .xecmpf-eac-save-actionplan":"saveEventActionPlan","click .xecmpf-eac-cancel-actionplan":"cancelEventActionPlan"},"constructor":function(e){e||(e={}),o.ItemView.prototype.constructor.call(this,e);var t={"context":this.options.context,"node":this.options.model,"eventname":this.options.eventname,"namespace":this.options.namespace,"actionplanSettingsView":this};this.actionPlanContentView=new a(t),this.propagateEventsToViews(this.actionPlanContentView)},"onRender":function(){var e=this,t=this.actionPlanContentView.render();o.triggerMethodOn(t,"before:show",t,this),this.$el.find(".xecmpf-eac-actionplan-content").append(t.el),o.triggerMethodOn(t,"show",t,this),this.listenTo(this.actionPlanContentView,"refresh:current:action:plan:item",function(t){e.trigger("refresh:current:action:plan:item",t)});var i=null;Object.defineProperty(this,"tabbedViewContainsChanges",{"get":function(){return i},"set":function(t){i=t,e.updateSaveButtonDisableStatus(!t),t&&!s.isEnabled()?s.enable(r.warningMsgOnActionPlanNavigation):t||s.disable()}}),this.model.get("plan_id")?this.tabbedViewContainsChanges=!1:this.tabbedViewContainsChanges=!0,this.actionPlanContentView.tabContent.children.forEach(function(t){e.listenTo(t.content,"change:field",function(t){e.tabbedViewContainsChanges=!0})})},"saveEventActionPlan":function(){var e=this;this.actionPlanContentView.saveActionPlanContent().then(function(){e.tabbedViewContainsChanges=!1},function(e){})},"cancelEventActionPlan":function(){this.trigger("actionplan:click:back")},"updateSaveButtonDisableStatus":function(e){var t=this.$el.find(".xecmpf-eac-save-actionplan");t.prop("disabled",e)},"onDestroy":function(){s.isEnabled()&&s.disable()}});return e.extend(l.prototype,n),l}),csui.define("hbs!xecmpf/widgets/eac/impl/actionplan.details/impl/actionplan.details",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div class="xecmpf-actionplan-header-view"></div>\r\n<div class="xecmpf-actionplan-master-view">\r\n  <div class="xecmpf-actionplan-list-view"></div>\r\n  <div class="xecmpf-actionpan-details-view"></div>\r\n</div>'}});return i.registerPartial("xecmpf_widgets_eac_impl_actionplan.details_impl_actionplan.details",o),o}),csui.define("css!xecmpf/widgets/eac/impl/actionplan.details/impl/actionplan.details",[],function(){}),csui.define("xecmpf/widgets/eac/impl/actionplan.details/actionplan.details.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/dialogs/modal.alert/modal.alert","csui/utils/url","csui/utils/contexts/factories/connector","csui/controls/globalmessage/globalmessage","csui/controls/progressblocker/blocker","xecmpf/widgets/eac/impl/actionplan.list/actionplan.list.view","xecmpf/widgets/eac/impl/actionplan.header/actionplan.header.view","xecmpf/widgets/eac/impl/actionplan.tab.content/actionplan.tabbed.view","hbs!xecmpf/widgets/eac/impl/actionplan.details/impl/actionplan.details","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/actionplan.details/impl/actionplan.details"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f){"use strict";var g=n.LayoutView.extend({"className":"xecmpf-actionplan-details","template":m,"regions":{"headerRegion":".xecmpf-actionplan-header-view","actionPlanListRegion":".xecmpf-actionplan-list-view","actionPlanDetailsRegion":".xecmpf-actionpan-details-view"},"initialize":function(){this.setHeaderView(),this.setActionPlanListView()},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions()},"onRender":function(){var e=this;this.listenTo(this.actionPlanListView,"actionplan:click:item",function(t){this.isContentViewCanbeUpdated(t.model).then(function(){e.updateContentView(t)})}),this.listenTo(this.actionPlanListView,"actionplan:add:item",function(t){this.isContentViewCanbeUpdated().then(function(){e.actionplanTabbedView.destroy(),e.actionPlanListView.addNewActionPlan()})}),this.listenTo(this.actionPlanListView,"actionplan:click:delete",function(e){this.deleteActionPlan(e)}),this.actionPlanListRegion.on("show",i.bind(this.onActionPlanListShown,this)),this.headerRegion.show(this.headerView),this.actionPlanListRegion.show(this.actionPlanListView)},"isContentViewCanbeUpdated":function(e){var i=t.Deferred(),o=null;return this.actionplanTabbedView&&!this.actionplanTabbedView.isDestroyed?(o=this.actionplanTabbedView.options.model,o===e?i.reject():this.actionplanTabbedView.tabbedViewContainsChanges?a.confirmQuestion(f.warningMsgOnActionPlanNavigation,f.actionPlanNavigationDialogTitle,{"buttons":a.OkCancel}).done(function(){i.resolve()}).fail(function(){i.reject()}):i.resolve()):i.resolve(),i.promise()},"updateContentView":function(e){this.setActionPlanTabbedView(e.model),this.actionPlanDetailsRegion.show(this.actionplanTabbedView),this.actionPlanListView.$el.find(".binf-active").removeClass("binf-active"),e.$el.addClass("binf-active")},"setHeaderView":function(){this.headerView=new u(this.options),this.listenTo(this.headerView,"actionplan:click:back",function(){this.isContentViewCanbeUpdated().then(function(){this.trigger("actionplan:close")}.bind(this))})},"setActionPlanListView":function(){this.actionPlanListView=new p({"showAddActionPlan":!0,"context":this.options.context,"model":this.options.model})},"setActionPlanTabbedView":function(e){var t=this;this.actionplanTabbedView&&this.actionplanTabbedView.destroy(),this.actionplanTabbedView=new h({"context":this.options.context,"model":e,"eventname":this.options.eventname,"namespace":this.options.namespace,"originatingView":this.options.originatingView}),this.listenTo(this.actionplanTabbedView,"actionplan:click:back",function(){
this.trigger("actionplan:close")}),this.listenTo(this.actionplanTabbedView,"refresh:current:action:plan:item",function(e){this.actionPlanListView.refreshCurrentActionPlanItem(e).then(function(e){t.updateContentView(e)})})},"onActionPlanListShown":function(e){var t=e.actionPlanListRegion.currentView.children.findByIndex(0);t&&t.trigger("click:actionplan:item")},"deleteActionPlan":function(e){var t=this,o=e.model,n=i.str.sformat(f.deleteActionPlanConfirmatonText,o.get("name")),s=o.get("plan_id");s?a.confirmQuestion(n,f.deleteActionPlanConfirmatonTitle,{"buttons":a.OkCancel}).done(function(){var i=t.options.context.getObject(c,t.options),n=new r(i.connection.url).getApiBase("v2");n=r.combine(n,"eventactioncenter","actionplan");var a=r.combineQueryString({"rule_id":o.attributes.rule_id,"plan_id":s});n=r.combine(n+"?"+a),i.makeAjaxCall({"type":"DELETE","url":n,"processData":!1,"contentType":!1,"success":function(i){t.updateActionPlanSelection(e),l.showMessage("success",i.results.msg)},"error":function(e){t.trigger("error");var i=e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:"Server Error: Unable to perform the action";l.showMessage("error",i)}})}).fail(function(){e._setFocus()}):t.updateActionPlanSelection(e)},"updateActionPlanSelection":function(e){var t=this.actionPlanListView.actionPlanListItemCollectionView,i=t.children,o=e._index,n=i.findByIndex(o+1),s=i.findByIndex(o-1),a=n?n:s?s:void 0,r=e.$el.hasClass("binf-active");a&&e._hasFocus&&t._changeTabIndexesAndSetFocus(e,a,!1),e.model.destroy(),r===!0&&(this.actionplanTabbedView.destroy(),a&&a.trigger("click:actionplan:item"))}});return i.extend(g.prototype,s),g}),csui.define("hbs!xecmpf/controls/table/cells/impl/actionplan",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'    <a href="" class = "action-plan-edit"> '+this.escapeExpression((n=null!=(n=t.count||(null!=e?e.count:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"count","hash":{}}):n))+" "+this.escapeExpression((n=null!=(n=t.actionPlan||(null!=e?e.actionPlan:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"actionPlan","hash":{}}):n))+"</a>\r\n"},"3":function(e,t,i,o){var n;return'    <button class="action-plan-add">'+this.escapeExpression((n=null!=(n=t.addActionPlan||(null!=e?e.addActionPlan:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"addActionPlan","hash":{}}):n))+"</button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return"<div>\r\n"+(null!=(n=t["if"].call(e,null!=e?e.count:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.program(3,o,0)}))?n:"")+"</div>"}});return i.registerPartial("xecmpf_controls_table_cells_impl_actionplan",o),o}),csui.define("css!xecmpf/controls/table/cells/impl/actionplan",[],function(){}),csui.define("xecmpf/controls/table/cells/eac.actionplan.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/contexts/factories/node","csui/controls/dialog/dialog.view","xecmpf/models/eac/eventactionplans.model","xecmpf/widgets/eac/impl/actionplan.details/actionplan.details.view","hbs!xecmpf/controls/table/cells/impl/actionplan","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/controls/table/cells/impl/actionplan"],function(e,t,i,o,n,s,a,r,c,l,d,p){var u=n.extend({"template":d,"className":"csui-nowrap","triggers":{"click .action-plan-add":"click:ActionPlanAdd"},"events":{"click .action-plan-edit":"editActionPlan"},"getValueData":function(){var e=this.model,t=e.get("action_plans").length;return{"count":t,"actionPlan":p.actionPlan,"addActionPlan":p.addActionPlan}},"onClickActionPlanAdd":function(){this.showActionPlanDetailsView()},"editActionPlan":function(e){e.preventDefault(),e.stopPropagation(),this.showActionPlanDetailsView()},"showActionPlanDetailsView":function(){var i,n=new l({"context":this.options.context,"model":this.options.model}),s=this.options.tableView,a=s.options.originatingView,r=s.options.originatingView.$el;r.parent().append("<div class='xecmpf-actionplan-details-wrapper'></div>"),i=e(r.parent().find(".xecmpf-actionplan-details-wrapper")[0]),i.hide(),n.render(),o.triggerMethodOn(n,"before:show"),i.append(n.el),a.actionPlanDetailsView=n,r.hide("blind",{"direction":"left","complete":function(){i.show("blind",{"direction":"right","complete":function(){o.triggerMethodOn(n,"show")}},100)}},100);var c=function(){var e=this;i.hide("blind",{"direction":"right","complete":function(){a.$el.show("blind",{"direction":"left","complete":function(){a.actionPlanDetailsView&&a.actionPlanDetailsView.destroy(),a.blockActions(),e.options.tableView.collection.fetch({"reload":!0}).fail(function(){}).always(function(){a.triggerMethod("dom:refresh"),a.unblockActions()})}},100),n.destroy(),i.remove()}},100)};this.listenTo(n,"actionplan:close",t.bind(c,this))}},{"hasFixedWidth":!0,"columnClassName":"xecmpf-table-cell-action-plan"});return s.registerByColumnKey("action_plan",u),u}),csui.define("xecmpf/controls/bosearch/searchform/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,t){var i=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":t}},"constructor":function(t){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,t=this.model.attributes;e.text(t.label),e.addClass(t["default"]?"binf-btn-primary":"binf-btn-default"),t.toolTip&&e.attr("title",t.toolTip),t.separate&&e.addClass("cs-separate"),this.updateButton(t)},"updateButton":function(e){var t=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?t.addClass("binf-hidden"):t.removeClass("binf-hidden")),void 0!==e.disabled&&t.prop("disabled",e.disabled)}}),o=e.CollectionView.extend({"childView":i,"constructor":function(t){e.CollectionView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"getButtons":function(){return this.children.toArray()},"updateButton":function(e,t){var o=this.collection.get(e);o?this.children.findByModel(o).updateButton(t):i.updateButton(this.$('[data-cs-id="'+e+'"]'),t)}});return o}),csui.define("xecmpf/controls/bosearch/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/controls/bosearch/impl/nls/root/lang",{"boSearchFormTitle":"Search {0}","boSearchFormButtonSearch":"Search","boSearchFormButtonCancel":"Cancel","boResultListButtonAttach":"Attach","noBusinessObjectsFound":"No business objects found.","resultListBannerMessage":"Search for {0}","resultListRefineMessage":"More results are available but result limit has been reached. Refine your search.","zeroSearchFields":"No search fields configured in the business application","labelBusinessObjectId":"ID","ERR_COLUMNS_CHANGED":"Configuration has changed during your search. Close the search and start a new one.","errorGettingSearchForm":"Error getting form for business object search.","errorSearchingBusinessObjects":"Error searching for business objects."}),csui.define("hbs!xecmpf/controls/bosearch/searchform/impl/bosearchform",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="conws-bosearchform-body csui-content-without-footer">\r\n  <div class="conws-bosearchheader">\r\n    <div class="conws-bosearchheader-title" title="'+this.escapeExpression((n=null!=(n=t.search_form_title||(null!=e?e.search_form_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"search_form_title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.search_form_title||(null!=e?e.search_form_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"search_form_title","hash":{}}):n))+'</div>\r\n    <div class="conws-spacer"></div>\r\n  </div>\r\n  <div class="conws-bosearchfields">\r\n  </div>\r\n  <div style="display:none;" class="conws-bosearchfields-zero" title="'+this.escapeExpression((n=null!=(n=t.zero_fields_title||(null!=e?e.zero_fields_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"zero_fields_title","hash":{}}):n))+'">\r\n      "'+this.escapeExpression((n=null!=(n=t.zero_fields_title||(null!=e?e.zero_fields_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"zero_fields_title","hash":{}}):n))+'"\r\n  </div>\r\n</div>\r\n<div class="conws-bosearchform-footer binf-modal-footer">\r\n</div>\r\n<div class="conws-right-shadow"></div>\r\n'}});return i.registerPartial("xecmpf_controls_bosearch_searchform_impl_bosearchform",o),o}),csui.define("xecmpf/controls/bosearch/searchform/bosearchform.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/log","csui/controls/form/form.view","csui/utils/contexts/factories/connector","csui/dialogs/modal.alert/modal.alert","xecmpf/controls/bosearch/searchform/impl/footer.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tab.panel/behaviors/tab.contents.keyboard.behavior","xecmpf/controls/bosearch/searchform/bosearchform.model","i18n!xecmpf/controls/bosearch/impl/nls/lang","hbs!xecmpf/controls/bosearch/searchform/impl/bosearchform"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b){var w=r.extend({"events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":h},"TabContentKeyboardBehavior":{"behaviorClass":m},"PerfectScrolling":{"behaviorClass":p,"suppressScrollX":!0}},"defaults":{"tabContentAccSelectors":"a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[cstabindex], *[contenteditable]"},"onKeyDown":function(e){if(9===e.keyCode||32===e.keyCode||13===e.keyCode){var t=this.onKeyInView(e);t&&(e.preventDefault(),e.stopPropagation(),t.prop("tabindex","0"),t.trigger("focus"))}},"onDomRefresh":function(){this.trigger("refresh:tabable:elements")},"constructor":function(e){i.defaults(e,this.defaults),e.searchTabContentForTabableElements=!0,r.prototype.constructor.apply(this,arguments)}}),v=n.LayoutView.extend({"events":{"keydown":"onKeyDown"},"className":"conws-bosearchform","template":b,"triggers":{"click .binf-btn.search":"bosearchform:search","click .binf-btn.cancel":"bosearchform:cancel"},"regions":{"searchFields":".conws-bosearchfields","footer":".binf-modal-footer"},"ui":{"footer":".binf-modal-footer"},"constructor":function(e){i.defaults(e,this.defaults),n.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.listenTo(this,"bosearchform:search",this._triggerSearch),this.listenTo(this,"bosearchform:cancel",this._triggerCancel),this.listenTo(this.model,"change:bo_type_name",this._updateTitle),this.searchFormModel=new f({"id":this.model.get("bo_type_id"),"name":this.model.get("bo_type_name")},{"connector":this.options.context.getObject(c)}),this.listenTo(this.searchFormModel,"change:name",function(){this.model.set("bo_type_name",this.searchFormModel.get("name"))}),this.listenTo(this.searchFormModel,"change",function(){this.model.set("bus_att_metadata_mapping",this.searchFormModel.get("bus_att_metadata_mapping"))}),this.listenTo(this.searchFormModel,"error",function(e,t,i){var o=t&&new s.Error(t).message||g.errorGettingSearchForm;a.error("Fetching the search forms failed: {0}",o)&&console.error(a.last),l.showError(o)}),this.listenTo(this.searchFormModel,"sync",function(){var e=this.searchFormModel.get("data");t.isEmptyObject(e)?(this._updateFormFieldsZero(!0),this.focusOnSearchButton()):(this._updateFormFieldsZero(!1),this.listenToOnce(this.searchForm,"render",function(){this.focusOnFirstFormField()}))})},"templateHelpers":function(){return{"search_form_title":this._getTitle(),"search_button_text":g.boSearchFormButtonSearch,"cancel_button_text":g.boSearchFormButtonCancel,"zero_fields_title":g.zeroSearchFields}},"onKeyDown":function(e){13===e.keyCode&&e.ctrlKey&&this.searchForm.$el.has(e.originalEvent.srcElement).length>0&&this.focusOnSearchButton()},"_getTitle":function(){return i.str.sformat(g.boSearchFormTitle,this.model.get("bo_type_name"))},"_updateTitle":function(){var e=this.$el.find(".conws-bosearchheader-title"),t=this._getTitle();e.text(t),e.attr({"title":t})},"_updateFormFieldsZero":function(e){var t=this.$el.find(".conws-bosearchfields"),i=this.$el.find(".conws-bosearchfields-zero");e?(t.css({"display":"none"}),i.css({"display":""})):(t.css({"display":""}),i.css({"display":"none"}))},"focusOnSearchButton":function(){var e=this.footerView.getButtons();e&&e[0]&&e[0].$el.trigger("focus")},"focusOnFirstFormField":function(){var e=this.searchFields.$el.find(".alpaca-container-item-first input");e&&e.trigger("focus")},"onRender":function(){this.searchForm=new w({"model":this.searchFormModel,"mode":"create","layoutMode":"singleCol"}),this.searchForm.model.fetch();var e=[{"default":!0,"label":g.boSearchFormButtonSearch,"click":i.bind(this._triggerSearch,this)},{"label":g.boSearchFormButtonCancel,"click":i.bind(this._triggerCancel,this)}];this.footerView=new d({"collection":new o.Collection(e)}),this.listenTo(this.footerView,"childview:click",this.onClickButton),this.searchFields.show(this.searchForm),this.footer.show(this.footerView);var t=this.footerView.getButtons();t&&t[0]&&t[0].$el.addClass("search"),t&&t[1]&&t[1].$el.addClass("cancel")},"onClickButton":function(e){var t=e.model.attributes;t.click&&t.click()},"_triggerSearch":function(){a.debug("trigger bosearch:search")&&console.log(a.last);var e=this.searchForm.getValues(),t={"data":this.searchFormModel.get("data"),"options":this.searchFormModel.get("options"),"schema":this.searchFormModel.get("schema")};this.model.trigger("bosearch:search",{"searchParams":e,"searchForms":t})},"_triggerCancel":function(){a.debug("trigger bosearch:cancel")&&console.log(a.last),this.model.trigger("bosearch:cancel")}});return i.extend(v.prototype,u),v}),csui.define("xecmpf/controls/bosearch/resultlist/boresult.collection",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/base","csui/utils/log","csui/models/mixins/resource/resource.mixin","csui/models/browsable/browsable.mixin","i18n!xecmpf/controls/bosearch/impl/nls/lang"],function(e,t,i,o,n,s,a,r){function c(e,i,o){return t.object(t.map(t.pairs(e),function(e){return t.iteratee(i,o)(e)}))}function l(e,t,i){var o=Math.max(e||0,t&&t.length||0,i||0,v);return o=Math.min(o,60)}function d(e,t,i){var o=e>v?.53:.6,s=(g-w)/(b*o),a=e/s;return n.debug("csui_average {0}",s)&&console.log(n.last),Math.min(a,.8)}var p=i.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)}}),u=i.Collection.extend({"model":p,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)}}),h=i.Model.extend({"idAttribute":"column_key","constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)}}),m=i.Collection.extend({"model":h,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)}}),f=i.Model.extend({"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)},"get":function(){return i.Model.prototype.get.apply(this,arguments)}}),g=120,b=14,w=32,v=4,y=i.Collection.extend({"model":f,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),this.makeResource(t),this.makeBrowsable(t),this.boSearchModel=t.boSearchModel,this.searchParams=t.searchParams,this.labelToKey={},this.nameToKey={},this.columns=new m,this.tableColumns=new u,this.totalCount=0,this.skipCount=0,this.topCount=t.pageSize||100,this.maxCount=t.maxRowCount,this.options=t}},{"ERR_COLUMNS_CHANGED":"ERR_COLUMNS_CHANGED"});s.mixin(y.prototype),a.mixin(y.prototype);var x=t.defaults({},y.prototype);return t.extend(y.prototype,{"fetch":function(t){var i=t&&t.reset;return this.searchParams&&(i||void 0===this.maxCount||this.length<this.maxCount)?(i&&(t.url=this.url(t)),x.fetch.apply(this,arguments)):e.Deferred().resolve().promise()},"url":function(i){var n="businessobjects",s=i&&i.reset?0:this.skipCount||0,a=t.omit(t.defaults({"bo_type_id":this.boSearchModel.get("bo_type_id"),"limit":this.topCount,"page":this.topCount?Math.floor(s/this.topCount)+1:void 0},c(this.searchParams,function(e){return["where_"+e[0],e[1]]},this)),function(e){return null===e||""===e}),r=n+"?"+e.param(a),l=this.connector.connection.url,d=o.Url.combine(l&&l.replace("/v1","/v2")||l,r);return d},"parse":function(i,o){function s(e,t){var i;if(t){for(var o=0,n=0;n<t.length;n++){var s=t[n];o+=void 0!==e[s.fieldName]?1:0}0===o&&(i="incompatible")}return i}function a(e,t){var i;if(t)for(var o=0;o<t.length;o++){var n=t[o],s=e[o];if(!s||s.fieldName!==n.fieldName)return"incompatible";(s.fieldLabel!==n.fieldLabel||s.position!==n.position||s.length!==n.length)&&(i="significant")}return i}delete this.errorMessage;var r=[];if(this.searchParams&&i&&i.results){var p,u=i.results.column_descriptions,h=e.isEmptyObject(this.searchParams)||e.isEmptyObject(u)?"significant":s(this.searchParams,u),m="incompatible"!==h;if(m&&!o.reset&&this.columnDescriptions&&(p=a(this.columnDescriptions,u),m="incompatible"!==p),m){u&&u.length||(u=[{"fieldLabel":"Business Object ID","fieldName":"businessObjectId","keyField":"","length":15,"position":1}]);var f=t.extend({},this.searchParams),g=t.extend({},this.searchForms),b={};if(o.reset||!this.columnDescriptions||"significant"===h||"significant"===p){var w,v,x=[],_={},k={},C=0,T=0;t.each(u,function(e,i){var o="conws_col_"+i,n=0;if(g&&g.options&&g.options.fields&&g.options.fields[e.fieldName]&&g.options.fields[e.fieldName].optionLabels&&g.schema&&g.schema.properties&&g.schema.properties[e.fieldName]&&g.schema.properties[e.fieldName]["enum"]&&g.options.fields[e.fieldName].optionLabels.length===g.schema.properties[e.fieldName]["enum"].length){var s=g.options.fields[e.fieldName].optionLabels,a=g.schema.properties[e.fieldName]["enum"],r=b[o]={};t.each(s,function(e,t){r[a[t]]=e,e.length>n&&(n=e.length)},this)}var c=t.extend({"align":"left","name":e.fieldLabel,"persona":"","sort":!0,"type":-1,"width_weight":0},e,{"correctedLength":l(e.length,e.fieldLabel,n),"column_key":o});c.correctedLength&&(C+=c.correctedLength,T+=1,(void 0===w||c.correctedLength<w)&&(w=c.correctedLength),(void 0===v||c.correctedLength>v)&&(v=c.correctedLength)),x.push(c),_[c.fieldLabel]=c.column_key,k[c.fieldName]=c.column_key},this);var V,A,M=t.map(x,function(e){var t=e.column_key,i=e.position+1;return void 0!==i&&(void 0===A||A>i)&&(A=i,V=t),V||(V=t),{"key":t,"sequence":i}});if(T>1&&w&&w>0&&v&&v>w){var S=C/T,P=d(w,S,v),I=S*P,F=I>w?(P*S-w)/(1-P):0,B=0,O=0,E=0;n.debug("minFactor {0}",P)&&console.log(n.last),S+=F,t.each(x,function(e,t){e.correctedLength=e.correctedLength?e.correctedLength+F:S;var i=e.correctedLength/S;n.debug("widthFactor {0}",i)&&console.log(n.last),M[t].widthFactor=i,B+=i,i>=O&&(O=i,E=t)},this),n.debug("widthFactorSum {0}",B)&&console.log(n.last);var D=T-B;n.debug("widthFactorRest {0}",D)&&console.log(n.last),0!==D&&(O+=D,B+=D,M[E].widthFactor=O,n.debug("widthFactorSum {0}",B)&&console.log(n.last))}this.orderByDefaultKey=V,this.mappedValues=b,this.labelToKey=_,this.nameToKey=k,this.columns.reset(x,{"silent":!0}),this.tableColumns.reset(M),this.columnDescriptions=i.results.column_descriptions}if(this.searchedParams=f,this.searchedForms=g,i.results.result_rows)for(var j=void 0===this.maxCount?this.topCount:Math.min(this.topCount,this.maxCount-this.length),R=0;j>R&&!(R>=i.results.result_rows.length);R++){var L=i.results.result_rows[R],N=t.extend(c(L,function(e){var t=this.labelToKey[e[0]]||this.nameToKey[e[0]]||e[0],i=this.mappedValues[t],o=i&&i[e[1]]||e[1];return[t,o]},this),{"id":L.rowId});r.push(N)}this.totalCount=i&&i.paging&&i.paging.total_count,o.reset&&(this.skipCount=0),this.maxRowsExceeded=i&&i.results&&i.results.max_rows_exceeded}else this.errorMessage=y.ERR_COLUMNS_CHANGED}return r}}),y}),csui.define("xecmpf/controls/bosearch/resultlist/botable.view",["require","csui/lib/jquery","csui/lib/underscore","csui/utils/log","csui/lib/backbone","csui/lib/marionette","csui/controls/table/table.view","csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools","xecmpf/controls/bosearch/resultlist/boresult.collection","i18n!xecmpf/controls/bosearch/impl/nls/lang"],function(e,t,i,o,n,s,a,r,c,l){function d(e){var t=this.options||{},o=t[e];return i.isFunction(o)?t[e].call(this.view):o}var p=s.Behavior.extend({"defaults":{"content":null,"contentParent":null,"fetchMoreItemsThreshold":95},"constructor":function(e,t){s.Behavior.prototype.constructor.apply(this,arguments),t.infiniteScrollingBehavior=this,this.listenTo(t,"render",this._bindScrollingEvents),this.listenTo(t,"before:destroy",this._unbindScrollingEvents)},"_scrollToPosition":function(e,o){var n=d.call(this,"contentParent"),s=this._contentParent.height(),a=d.call(this,"content"),r=a?this.view.$(a):n?this._contentParent.children().first():this.view.$el,c=i.reduce(r,function(e,i){return e+t(i).height()},0);if(s>c)e=0;else if("middle"===o?e-=s/2:"bottom"===o&&(e-=s),e=Math.floor(e),0>e)e=0;else{var l=d.call(this,"fetchMoreItemsThreshold"),p=Math.floor((c-s)*(l/100));e>=p&&(e=p-1)}this._contentParent.scrollTop(e)},"scrollTop":function(e){this._scrollToPosition(e,"top")},"scrollMiddle":function(e){this._scrollToPosition(e,"middle")},"scrollBottom":function(e){this._scrollToPosition(e,"bottom")},"_bindScrollingEvents":function(){this._unbindScrollingEvents();var e=d.call(this,"contentParent");this._contentParent=e?this.view.$(e):this.view.$el,this._contentParent.on("scroll."+this.view.cid,i.bind(this._checkScrollPosition,this))},"_checkScrollPosition":function(){var e=d.call(this,"contentParent"),o=d.call(this,"content"),n=o?this.view.$(o):e?this._contentParent.children().first():this.view.$el,s=d.call(this,"fetchMoreItemsThreshold"),a=i.reduce(n,function(e,i){return e+t(i).height()},0),r=a-this._contentParent.height(),c=this._contentParent.scrollTop(),l=100*c/r;this.view.lastScrollPosition=c,l>=s&&this._checkScrollPositionFetch()},"_checkScrollPositionFetch":function(){var e=this.view.collection;if(e.length<e.totalCount&&!e.fetching&&e.skipCount<e.length){o.debug("fetching from {0}",e.length)&&console.log(o.last);var t=e.skipCount;e.setSkip(e.length,!1);var n=d.call(this,"contentParent");this.$(".ps-scrollbar-y-rail").trigger("mouseup"),e.fetch({"reset":!1,"remove":!1,"merge":!1,"silent":!0,"success":i.bind(function(){e.errorMessage&&e.errorMessage===c.ERR_COLUMNS_CHANGED?(e.setSkip(t,!1),this.view.lastScrollPosition>0&&this.view.$(n).scrollTop(this.view.lastScrollPosition-1)):this.view.render()},this)})}},"_unbindScrollingEvents":function(){this._contentParent&&this._contentParent.off("scroll."+this.view.cid)}}),u=a.extend({"events":{"keydown":"onKeyDown"},"behaviors":i.defaults({"InfiniteScrolling":{"behaviorClass":p,"contentParent":"tbody","content":"tbody>tr:visible","fetchMoreItemsThreshold":100}},a.prototype.behaviors),"constructor":function(){a.prototype.constructor.apply(this,arguments),this.listenTo(this,"clicked:cell",this._clickedCell),this.options.disableItemsWithWorkspace&&this.listenTo(this,"tableRowRendered",this._disableRow),this.listenTo(this.collection,"request",function(e,t,i){i.reset&&delete this.lastScrollPosition})},"_disableRow":function(e){var i=e.target,o=e.node;if(o.get("has_workspace")){var n=t(i);n.addClass("conws-boresulttable-disabled-row"),n.off("pointerenter"),n.off("pointerleave"),n.find("td").not(".csui-table-cell-_toggledetails").off("click")}},"onKeyDown":function(e){if(this.options&&"single"===this.options.selectRows&&(32===e.keyCode||13===e.keyCode)){var t=e.target.classList.contains("csui-table-cell-_toggledetails");t||(e.preventDefault(),e.stopPropagation(),e.target.click())}},"_clickedCell":function(e){if(!this.ignoreSelectEvents){var t={"model":e.model,"target":this.table.row(e.rowIndex).node()};this.lastSelectedRow=t,this.trigger("row:selected",t)}},"setSelection":function(e,o){function n(){return this.tableTools||(this.tableTools=r.fnGetInstance(this.table.table().node()))}function s(e){this.table&&e&&i.each(e,function(e){var t=this.collection.get(e),i=this.collection.indexOf(t),s=n.call(this),a=this.table.row(i).node();o?s.fnSelect(a):s.fnDeselect(a)},this)}if(this.ignoreSelectEvents=!0,o=o||void 0===o,s.call(this,e),delete this.lastSelectedRow,this.table&&e&&e.length>0&&o){var a=e[0],c=this.collection.get(a),l=this.collection.indexOf(c),d=this.table.row(l).node();this.lastSelectedRow={"model":c,"target":t(d)}}if(this.lastSelectedRow&&this.infiniteScrollingBehavior){var p=this.lastSelectedRow.target.position().top+this.lastSelectedRow.target.height()/2;this.infiniteScrollingBehavior.scrollMiddle(p)}delete this.ignoreSelectEvents},"clearSelection":function(){this.ignoreSelectEvents=!0,delete this.lastSelectedRow,this.clearChildrenSelection(),void 0!==this.lastScrollPosition&&this.infiniteScrollingBehavior&&this.infiniteScrollingBehavior.scrollTop(this.lastScrollPosition),delete this.ignoreSelectEvents}});return u}),csui.define("hbs!xecmpf/controls/bosearch/resultlist/impl/boresultlist",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'      <div class="conws-boresultbanner-container">\r\n        <div class="conws-boresultbanner">'+this.escapeExpression((n=null!=(n=t.banner_message||(null!=e?e.banner_message:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"banner_message","hash":{}}):n))+"</div>\r\n      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return'<div class="conws-boresultlist-body">\r\n  <div class="conws-boresulttable">\r\n'+(null!=(n=t["if"].call(e,null!=e?e.banner_message:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")+'  </div>\r\n  <div class="conws-boresultfooter">\r\n    <div class="conws-boresultfooter-message-container  binf-modal-footer">\r\n      <div class="conws-boresultfooter-message">'+this.escapeExpression((s=null!=(s=t.footer_message||(null!=e?e.footer_message:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"footer_message","hash":{}}):s))+'</div>\r\n    </div>\r\n    <div class="conws-boresultfooter-attach-container  binf-modal-footer">\r\n      <button type="button" disabled class="binf-btn binf-btn-default attach">'+this.escapeExpression((s=null!=(s=t.attach_button_text||(null!=e?e.attach_button_text:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"attach_button_text","hash":{}}):s))+"</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("xecmpf_controls_bosearch_resultlist_impl_boresultlist",o),o}),csui.define("xecmpf/controls/bosearch/resultlist/boresultlist.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/log","csui/utils/contexts/factories/connector","csui/dialogs/modal.alert/modal.alert","xecmpf/controls/bosearch/resultlist/botable.view","xecmpf/controls/bosearch/resultlist/boresult.collection","hbs!xecmpf/controls/bosearch/resultlist/impl/boresultlist","i18n!xecmpf/controls/bosearch/impl/nls/lang"],function(e,t,i,o,n,s,a,r,c,l,d,p,u){var h=n.LayoutView.extend({"className":"conws-boresultlist","template":p,"regions":{"tableRegion":".conws-boresulttable"},"triggers":{"click .binf-btn.attach":"attach:clicked"},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.call(this,e),this.listenTo(this.model,"change:bo_type_name",this._updateBanner),this.listenTo(this.model,"bosearch:search",this._triggerSearch),this.listenTo(this,"attach:clicked",this._triggerAttach)},"_triggerSearch":function(e){this.collection||(this.collection=new d(void 0,{"connector":this.options.context.getObject(r),"boSearchModel":this.options.model,"autoreset":!0}),this.render(),this.listenTo(this.collection,"sync",this._updateFooter),this.listenTo(this.collection,"sync",this._showSyncError),this.listenTo(this.collection,"error",this._showSearchError)),this.collection.searchParams=e?e.searchParams:void 0,this.collection.searchForms=e?e.searchForms:void 0;var t=this;this.collection.fetch({"reset":!0}).then(function(){var e=t.resultTable.currentlyFocusedElement();e&&e.trigger("focus")});var i=this.model.get("bus_att_metadata_mapping");if(this.options.multipleSelect&&!i){var o=this.$el.find(".conws-boresultfooter>.conws-boresultfooter-attach-container");if(o){o.css({"display":"block"});var n=o.children();n&&(n[0].disabled=!0)}this.$el.addClass("conws-with-attachbtn")}},"_selectedRow":function(e){a.debug("trigger reference:clicked")&&console.log(a.last),this.listenToOnce(this.model,"reference:selected",function(){t(e.target).trigger("mouseleave")}),this.model.trigger("boresult:select",{"selectedItems":[e.model]})},"_enableAttachBtn":function(e){if(e.nodes.length>0){var t=this.resultTable.getSelectedChildren();if(t.length>0){var i=this.$el.find(".conws-boresultfooter .binf-btn.binf-btn-default.attach");i&&(i[0].disabled=!1)}}},"_disableAttachBtn":function(e){if(e.nodes.length>0){var t=this.resultTable.getSelectedChildren();if(0===t.length){var i=this.$el.find(".conws-boresultfooter .binf-btn.binf-btn-default.attach");i&&(i[0].disabled=!0)}}},"templateHelpers":function(){return{"banner_message":this._getBannerMessage(),"footer_message":this._getFooterMessage(),"attach_button_text":u.boResultListButtonAttach}},"_updateBanner":function(){var e=this._getBannerMessage();e&&this.$el.find(".conws-boresultbanner").text(this._getBannerMessage())},"_getBannerMessage":function(){return this.collection?void 0:i.str.sformat(u.resultListBannerMessage,this.model.get("bo_type_name"))},"_updateFooter":function(){var e=this._getFooterMessage();e?(this.$el.find(".conws-boresultfooter-message").text(e),this.$el.addClass("conws-with-footer")):this.$el.removeClass("conws-with-footer")},"_getFooterMessage":function(){return this.collection&&this.collection.maxRowsExceeded?u.resultListRefineMessage:void 0},"_showSyncError":function(){this.collection.errorMessage&&this.collection.errorMessage===d.ERR_COLUMNS_CHANGED&&c.showError(u[this.collection.errorMessage]||this.collection.errorMessage)},"_showSearchError":function(e,t,i){var o=t&&new s.Error(t).message||u.errorSearchingBusinessObjects;a.error("Searching for business objects failed: {0}",o)&&console.error(a.last),c.showError(o)},"_triggerAttach":function(){a.debug("trigger boresult:select")&&console.log(a.last),this.model.trigger("boresult:select",{"selectedItems":this.resultTable.getSelectedChildren()})},"onRender":function(){if(this._updateFooter(),this.collection){var e="single",t=!1,i=this.model.get("bus_att_metadata_mapping");this.options.multipleSelect&&!i&&(e="multiple",t=!0);var o=!0;void 0!==this.options.enableSorting&&(o=this.options.enableSorting),this.resultTable=new l({"context":this.options.context,"connector":this.options.context.getObject(r),"collection":this.collection,"columns":this.collection.columns,"tableColumns":this.collection.tableColumns,"selectRows":e,"selectColumn":t,"enableSorting":o,"nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!0,"disableItemsWithWorkspace":this.options.disableItemsWithWorkspace,"tableTexts":{"zeroRecords":u.noBusinessObjectsFound}}),!this.options.multipleSelect||i?this.listenTo(this.resultTable,"row:selected",this._selectedRow):(this.listenTo(this.resultTable,"tableRowSelected",this._enableAttachBtn),
this.listenTo(this.resultTable,"tableRowUnselected",this._disableAttachBtn)),this.tableRegion.show(this.resultTable)}else this.resultTable&&(this.stopListening(this.resultTable),delete this.resultTable)}});return h}),csui.define("hbs!xecmpf/controls/bosearch/impl/bosearch",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="conws-bosearch-wrapper">\r\n  <div class="conws-bosearch-panel">\r\n    <div class="conws-bosearch-title">\r\n      '+this.escapeExpression((n=null!=(n=t.bosearch_title||(null!=e?e.bosearch_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"bosearch_title","hash":{}}):n))+'\r\n    </div>\r\n    <div class="conws-bosearch-form">\r\n    </div>\r\n    <div class="conws-bosearch-result">\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("xecmpf_controls_bosearch_impl_bosearch",o),o}),csui.define("css!xecmpf/controls/bosearch/impl/bosearch",[],function(){}),csui.define("xecmpf/controls/bosearch/bosearch.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/widgets/metadata/metadata.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","xecmpf/controls/bosearch/searchform/bosearchform.view","xecmpf/controls/bosearch/resultlist/boresultlist.view","hbs!xecmpf/controls/bosearch/impl/bosearch","css!xecmpf/controls/bosearch/impl/bosearch"],function(e,t,i,o,n,s,a,r,c){var l=o.LayoutView.extend({"className":"conws-bosearch csui-metadata-overlay","template":c,"regions":{"searchRegion":".conws-bosearch-form","resultRegion":".conws-bosearch-result"},"constructor":function(e){o.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions(),this.listenTo(this.model,"reference:search",this._referenceSearchOpen)},"templateHelpers":function(){return{"bosearch_title":this.options.title}},"onRender":function(){this.searchView=new a({"model":this.model,"context":this.options.context}),this.resultView=new r({"model":this.model,"context":this.options.context,"multipleSelect":this.options.multipleSelect,"enableSorting":!1,"disableItemsWithWorkspace":this.options.disableItemsWithWorkspace}),this.options.title&&this.$el.addClass("display-title"),this.searchRegion.show(this.searchView),this.resultRegion.show(this.resultView)},"_referenceSearchOpen":function(){var e=this;if(e.searchView&&e.searchView.searchForm){e.searchView.searchForm.$el.hide();var t=e.searchView.searchForm.model.get("id"),o=e.searchView.model.get("bo_type_id");t!==o&&e.resultView&&e.resultView.collection&&(delete e.resultView.collection,e.resultView.render()),e.searchView.searchForm.model.set({"id":o,"name":e.searchView.model.get("bo_type_name")}),e.searchView.searchForm.model.fetch({"reset":!0,"silent":!0}).then(function(){if(e.resultView&&e.resultView.collection&&e.resultView.collection.searchedParams){var t=e.searchView.searchForm.model.get("data"),o=i.keys(t),n=e.resultView.collection.searchedParams,s=o.length,a=i.keys(n).length,r=i.reduce(t,function(e,t,i){return i in n?e+1:e},0);if(r>0&&r>=o.length/2||s===a){if(i.extend(t,i.pick(n,o)),e.resultView.resultTable){var c=e.model.get("row_id");c&&e.resultView.resultTable.collection.get(c)?e.resultView.resultTable.setSelection([c]):e.resultView.resultTable.clearSelection()}}else{var l=e.resultView.collection;delete e.resultView.collection,l&&(l.stopListening(),e.resultView.stopListening(l)),e.resultView.render()}}e.searchView.searchForm.render(),e.searchView.searchForm.$el.show()},function(){e.searchView.searchForm.$el.show()})}}});return i.extend(l.prototype,s),l}),csui.define("xecmpf/controls/bosearch/bosearch.dialog.controller",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","xecmpf/controls/bosearch/bosearch.view"],function(e,t,i,o,n){var s=o.Controller.extend({"constructor":function(e){o.Controller.prototype.constructor.apply(this,arguments),this.listenTo(this.options.boSearchModel,"reference:search",this._referenceSearchOpen),this.listenTo(this.options.boSearchModel,"boresult:select",this._boresultSelect),this.listenTo(this.options.boSearchModel,"reference:selected",this._referenceSelected),this.listenTo(this.options.boSearchModel,"reference:rejected",this._referenceRejected),this.listenTo(this.options.boSearchModel,"bosearch:cancel",this._referenceSearchCanceled)},"_transitionEnd":i.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if("undefined"!=typeof i.style[e])return t[e]}),"_referenceSearchOpen":function(){this._showSearchView()},"_boresultSelect":function(){this._showModalContent()},"_referenceSelected":function(){this._hideSearchView()},"_referenceRejected":function(){this._hideModalContent()},"_referenceSearchCanceled":function(){this._showModalContent(),this._hideSearchView()},"_hideSearchView":function(){"workspace_reference_edit"===this.options.mode&&this.bosearchview.$el.parent().removeClass("cs-item-action-metadata"),"business_attachment_add"===this.options.mode&&this.bosearchview.$el.parent().removeClass("cs-item-action-metadata"),this.modalcontent.removeClass("conws-bosearch-showing"),this.bosearchview.$el.detach()},"_showModalContent":function(){"workspace_reference_create"===this.options.mode&&(this.modalcontent.find(">.binf-modal-header .cs-close").show(),this.modalcontent.find(">.binf-modal-body").show(),this.modalcontent.find(">.binf-modal-footer").show()),"workspace_reference_edit"===this.options.mode&&(this.modalcontent.find(">.metadata-content-wrapper").show(),this.modalcontent.find(">.metadata-wrapper .metadata-sidebar .cs-content").show(),this.modalcontent.find(">.metadata-wrapper .metadata-content .metadata-content-wrapper").show()),"business_attachment_add"===this.options.mode&&(this.modalcontent.find(">.metadata-content-wrapper").show(),this.modalcontent.find(">.metadata-wrapper .metadata-sidebar .cs-content").show(),this.modalcontent.find(">.metadata-wrapper .metadata-content .metadata-content-wrapper").show())},"_hideModalContent":function(){"workspace_reference_create"===this.options.mode&&(this.modalcontent.find(">.binf-modal-header .cs-close").hide(),this.modalcontent.find(">.binf-modal-body").hide(),this.modalcontent.find(">.binf-modal-footer").hide()),"workspace_reference_edit"===this.options.mode&&(this.modalcontent.find(">.metadata-content-wrapper").hide(),this.modalcontent.find(">.metadata-wrapper .metadata-sidebar .cs-content").hide(),this.modalcontent.find(">.metadata-wrapper .metadata-content .metadata-content-wrapper").hide()),"business_attachment_add"===this.options.mode&&(this.modalcontent.find(">.metadata-content-wrapper").hide(),this.modalcontent.find(">.metadata-wrapper .metadata-sidebar .cs-content").hide(),this.modalcontent.find(">.metadata-wrapper .metadata-content .metadata-content-wrapper").hide())},"_showSearchView":function(){this.options||{};this.modalcontent=t(this.options.htmlPlace),this.modalcontent.addClass("conws-bosearch-beforeshow"),this.bosearchview||(this.bosearchview=new n({"model":this.options.boSearchModel,"context":this.options.context,"multipleSelect":this.options.multipleSelect,"disableItemsWithWorkspace":this.options.disableItemsWithWorkspace,"title":this.options.title}),this.bosearchview.render(),this.bosearchview.$el.addClass(this.options.mode),"workspace_reference_create"===this.options.mode&&this.bosearchview.$el.addClass("csui-content-without-header"),"workspace_reference_edit"===this.options.mode&&(this.bosearchview.$el.addClass("csui-content-without-header"),this.bosearchview.$el.find(">*").addClass("binf-modal-content")),"business_attachment_add"===this.options.mode&&(this.bosearchview.$el.addClass("csui-content-without-header"),this.bosearchview.$el.find(">*").addClass("binf-modal-content"))),this.modalcontent.append(this.bosearchview.$el),"workspace_reference_edit"===this.options.mode&&this.bosearchview.$el.parent().addClass("cs-item-action-metadata"),"business_attachment_add"===this.options.mode&&this.bosearchview.$el.parent().addClass("cs-item-action-metadata"),this.bosearchview.$el.position(),this.bosearchview.triggerMethod("dom:refresh");var e=this;this.bosearchview.$el.one(this._transitionEnd(),function(){e.modalcontent.removeClass("conws-bosearch-animating"),e.modalcontent.addClass("conws-bosearch-showing"),e._hideModalContent()}),this.modalcontent.addClass("conws-bosearch-animating"),this.modalcontent.removeClass("conws-bosearch-beforeshow")}});return s}),csui.define("hbs!xecmpf/controls/property.panels/reference/impl/reference.panel",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'    <div class="conws-reference-override-note">'+this.escapeExpression((n=null!=(n=t.override_note||(null!=e?e.override_note:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"override_note","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return'<div class="conws-reference-panel binf-row alpaca-field">\r\n  <div class="alpaca-container-label">\r\n    <h3>'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'</h3>\r\n  </div>\r\n  <div class="conws-reference-initial">\r\n  </div>\r\n  <div class="conws-reference-replace">\r\n  </div>\r\n'+(null!=(n=t["if"].call(e,null!=e?e.change_reference:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")+"</div>\r\n"}});return i.registerPartial("xecmpf_controls_property.panels_reference_impl_reference.panel",o),o}),csui.define("hbs!xecmpf/controls/property.panels/reference/impl/reference.panel-initial",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'  <div class="conws-label-search">'+this.escapeExpression((n=null!=(n=t.search_button_label||(null!=e?e.search_button_label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"search_button_label","hash":{}}):n))+'</div>\r\n  <button type="button" class="binf-btn binf-btn-default search">'+this.escapeExpression((n=null!=(n=t.search_button_title||(null!=e?e.search_button_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"search_button_title","hash":{}}):n))+"</button>\r\n"},"3":function(e,t,i,o){var n;return'  <div  class="conws-reference-override-note">'+this.escapeExpression((n=null!=(n=t.cannot_complete_business_reference||(null!=e?e.cannot_complete_business_reference:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cannot_complete_business_reference","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return null!=(n=t["if"].call(e,null!=e?e.complete_reference:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.program(3,o,0)}))?n:""}});return i.registerPartial("xecmpf_controls_property.panels_reference_impl_reference.panel-initial",o),o}),csui.define("hbs!xecmpf/controls/property.panels/reference/impl/reference.panel-replace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n,s;return'  <div class="conws-reference-buttons">\r\n    <div class="conws-label-buttons">'+this.escapeExpression((s=null!=(s=t.reference_buttons_label||(null!=e?e.reference_buttons_label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"reference_buttons_label","hash":{}}):s))+"</div>\r\n\r\n"+(null!=(n=t["if"].call(e,null!=e?e.allow_remove_reference_from_create:e,{"name":"if","hash":{},"fn":this.program(2,o,0),"inverse":this.noop}))?n:"")+'\r\n    <button type="button" class="binf-btn binf-btn-default replace">'+this.escapeExpression((s=null!=(s=t.replace_button_title||(null!=e?e.replace_button_title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"replace_button_title","hash":{}}):s))+"</button>\r\n\r\n"+(null!=(n=t["if"].call(e,null!=e?e.allow_remove_reference_from_edit:e,{"name":"if","hash":{},"fn":this.program(2,o,0),"inverse":this.noop}))?n:"")+"\r\n  </div>\r\n"},"2":function(e,t,i,o){var n;return'      <button type="button" class="binf-btn binf-btn-default remove">'+this.escapeExpression((n=null!=(n=t.remove_button_title||(null!=e?e.remove_button_title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"remove_button_title","hash":{}}):n))+"</button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="conws-reference-metadata"></div>\r\n'+(null!=(n=t["if"].call(e,null!=e?e.change_reference:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("xecmpf_controls_property.panels_reference_impl_reference.panel-replace",o),o}),csui.define("css!xecmpf/controls/property.panels/reference/impl/reference.panel",[],function(){}),csui.define("xecmpf/controls/property.panels/reference/impl/reference.panel.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca","csui/utils/log","csui/controls/form/form.view","csui/utils/base","csui/dialogs/modal.alert/modal.alert","xecmpf/controls/bosearch/bosearch.model","xecmpf/controls/bosearch/bosearch.dialog.controller","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/globalmessage/globalmessage","hbs!xecmpf/controls/property.panels/reference/impl/reference.panel","hbs!xecmpf/controls/property.panels/reference/impl/reference.panel-initial","hbs!xecmpf/controls/property.panels/reference/impl/reference.panel-replace","i18n!xecmpf/controls/property.panels/reference/impl/nls/lang","css!xecmpf/controls/property.panels/reference/impl/reference.panel"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g){"use strict";var b=o.ItemView.extend({"className":"conws-reference reference-initial","template":m,"constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments)},"ui":{"searchButton":".binf-btn.search"},"triggers":{"click .binf-btn.search":"referencetab:search"},"templateHelpers":function(){var t=this.options.actionContext.workspaceReference,i=t&&t.get("bo_type_name"),o=t&&t.get("ext_system_name");return{"search_button_label":e.str.sformat(g.referenceSearchButtonLabel,i,o),"search_button_title":g.referenceSearchButtonTitle,"complete_reference":t.get("complete_reference"),"cannot_complete_business_reference":g.cannotCompleteBusinessReference}}}),w=o.LayoutView.extend({"className":"conws-reference reference-replace","template":f,"constructor":function(e){o.LayoutView.prototype.constructor.apply(this,arguments)},"ui":{"replaceButton":".binf-btn.replace"},"triggers":{"click .binf-btn.remove":"referencetab:remove","click .binf-btn.replace":"referencetab:replace"},"regions":{"metadataRegion":".conws-reference-metadata"},"templateHelpers":function(){var t=this.options.actionContext.workspaceReference,i=t&&t.get("bo_type_name"),o=t&&t.get("ext_system_name");return{"allow_remove_reference_from_create":"workspace_reference_create"===this.options.actionContext.mode,"allow_remove_reference_from_edit":"workspace_reference_edit"===this.options.actionContext.mode,"remove_button_title":g.referenceRemoveButtonTitle,"replace_button_title":g.referenceReplaceButtonTitle,"reference_buttons_label":e.str.sformat(g.referenceSearchButtonLabel,i,o),"change_reference":t.get("change_reference")}},"onRender":function(){var e,t,o;"workspace_reference_create"===this.options.actionContext.mode&&(e=this.options.actionContext.workspaceReference.get("data")||{},t=this.options.actionContext.workspaceReference.get("options")||{},o=this.options.actionContext.workspaceReference.get("schema")||{}),"workspace_reference_edit"===this.options.actionContext.mode&&(e={"BOID":this.options.actionContext.workspaceReference.get("bo_id")},t={"fields":{"BOID":{}}},o={"properties":{"BOID":{"readonly":!0,"required":!1,"title":g.businessObjectIdLabel,"type":"string"}}}),e&&t&&o&&(this.formModel=new i.Model({"data":e,"options":t,"schema":o}),this.metdataForm=new a({"model":this.formModel,"context":this.options.context}),this.metadataRegion.show(this.metdataForm))}}),v=o.LayoutView.extend({"className":"conws-reference reference-panel cs-form cs-form-create","template":h,"regions":{"initialRegion":".conws-reference-initial","replaceRegion":".conws-reference-replace"},"behaviors":{"TabableRegion":{"behaviorClass":p}},"constructor":function(t){o.LayoutView.prototype.constructor.apply(this,arguments),this.options.actionContext.referencePanelView&&this.options.actionContext.referencePanelView.destroy(),this.options.actionContext.referencePanelView=this;var i,n;if("create"===this.options.mode){this.options.actionContext.mode="workspace_reference_create",i=this.options.metadataView;var a=t&&t.fetchedModels,p=a&&a.formCollection,u=p&&p.options,h=u&&u.metadataAddItemController,m=h&&h.dialog;n=m&&m.$(".binf-modal-content")}else"update"===this.options.mode&&(this.options.actionContext.mode="workspace_reference_edit",i=this.options.metadataView&&this.options.metadataView.options.metadataNavigationView?this.options.metadataView.options.metadataNavigationView:this.options.metadataView,n=".cs-metadata:has(> .metadata-content-wrapper)");i!==this.options.actionContext.viewContext&&(delete this.options.actionContext.boSearchModel,delete this.options.actionContext.boSearchDialogController,this.options.actionContext.viewContext=i);var f=this.options.actionContext.workspaceReference;this.options.actionContext.boSearchModel?this.options.actionContext.boSearchModel.set({"bo_type_id":f.get("bo_type_id"),"bo_type_name":f.get("bo_type_name"),"row_id":f.get("row_id")}):this.options.actionContext.boSearchModel=new l({"bo_type_id":f.get("bo_type_id"),"bo_type_name":f.get("bo_type_name"),"row_id":f.get("row_id")}),this.options.actionContext.boSearchDialogController?(this.options.actionContext.boSearchDialogController.options.mode=this.options.actionContext.mode,this.options.actionContext.boSearchDialogController.options.htmlPlace=n):this.options.actionContext.boSearchDialogController=new d({"mode":this.options.actionContext.mode,"context":this.options.context,"htmlPlace":n,"boSearchModel":this.options.actionContext.boSearchModel,"disableItemsWithWorkspace":!0}),this.listenTo(this.options.actionContext.boSearchModel,"boresult:select",this._replaceReference),this.listenTo(this.options.actionContext.boSearchModel,"bosearch:cancel",this._cancelSearch),this.listenTo(this.options.actionContext.boSearchModel,"change:bo_type_name",e.bind(function(){this.options.actionContext.workspaceReference.set("by_type_name",this.options.actionContext.boSearchModel.get("bo_type_name")),this.render()},this)),this.listenTo(this.options.actionContext.workspaceReference,"error",function(e,t,i){var o,n=i&&i.invoker&&"remove_bo_ref"===i.invoker;n?(o=t&&new r.Error(t).message||g.errorRemovingWorkspaceReference,s.error("Removing the workspace reference failed: {0}",o)&&console.error(s.last)):(o=t&&new r.Error(t).message||g.errorUpdatingWorkspaceReference,s.error("Updating the workspace reference failed: {0}",o)&&console.error(s.last)),c.showError(o)}),this.listenTo(t.originatingView,"render:forms",this._formsRendered),"workspace_reference_create"===this.options.actionContext.mode&&(this.options.actionContext.scrollToPanel=!0,this.options.actionContext.focusButton=!0),this.listenTo(this.options.actionContext.boSearchModel,"boresult:select",function(){this.options.originatingView.blockActions&&this.options.originatingView.blockActions()}).listenTo(this.options.actionContext.boSearchModel,"reference:selected",function(){this.options.originatingView.unblockActions&&this.options.originatingView.unblockActions()}).listenTo(this.options.actionContext.boSearchModel,"reference:rejected",function(){this.options.originatingView.unblockActions&&this.options.originatingView.unblockActions()})},"onDestroy":function(){this===this.options.actionContext.referencePanelView&&delete this.options.actionContext.referencePanelView},"templateHelpers":function(){return{"title":g.referenceTabTitle,"override_note":g.referencePanelOverrideNote,"change_reference":this.options.actionContext.workspaceReference.get("change_reference")}},"currentlyFocusedElement":function(){var e;return e=this.options.actionContext.workspaceReference.get("bo_id")?this.replaceView&&this.replaceView.ui.replaceButton:this.initialView&&this.initialView.ui.searchButton,e&&e.attr&&e.prop?(s.debug("currently focused element of {0} count {1} class {2}",this.cid,e?e.length:"no el",e.attr("class"))&&console.log(s.last),e):void 0},"onRender":function(){this.options.actionContext.workspaceReference.get("bo_id")?(delete this.initialView,this.replaceView=new w(this.options),this.listenTo(this.replaceView,"referencetab:remove",this._removeReference),this.listenTo(this.replaceView,"referencetab:replace",this._triggerSearch),this.replaceRegion.show(this.replaceView)):(delete this.replaceView,this.initialView=new b(this.options),this.listenTo(this.initialView,"referencetab:search",this._triggerSearch),this.initialRegion.show(this.initialView))},"_triggerSearch":function(){s.debug("trigger reference:search")&&console.log(s.last),this.options.actionContext.boSearchModel.trigger("reference:search")},"_removeReference":function(){if(s.debug("clear reference")&&console.log(s.last),"workspace_reference_create"===this.options.actionContext.mode)this._refetchForms({"data":void 0,"options":{},"schema":{},"bo_id":void 0,"row_id":void 0});else if("workspace_reference_edit"===this.options.actionContext.mode){var i=this,o=t.Deferred();c.confirmQuestion(e.str.sformat(g.removeBOReferenceAlertDescription,this.options.actionContext.workspaceReference.get("bo_id")),g.removeBOReferenceAlertTitle).done(function(e){var t=i.options.actionContext.workspaceReference;return t.destroy({"wait":!0,"invoker":"remove_bo_ref"}).done(function(e,t){u.showMessage("success",g.removeBOReferenceSuccessMessage),i.options.actionContext.viewContext.triggerMethod("metadata:close"),o.resolve()}).fail(function(e,t,i){o.reject(e.responseJSON.error)}),o.promise()})}},"_cancelSearch":function(){this._focusButton({"cancelSearch":!0})},"_replaceReference":function(t){if(s.debug("set reference")&&console.log(s.last),t&&t.selectedItems&&t.selectedItems.length>0&&t.selectedItems[0]){var i=t.selectedItems[0],o={},n={},a={},r=i.collection,c=r.columns,l=r.tableColumns,d=l.toArray().sort(function(e,t){return e.get("sequence")-t.get("sequence")});e.each(d,function(e){var t=e.get("key"),s=c.get(t),r=s.get("fieldName");o[r]=i.get(t),n[r]={},a[r]={"readonly":!0,"required":!1,"title":s.get("fieldLabel"),"type":"string"}}),this._refetchForms({"data":o,"options":{"fields":n},"schema":{"properties":a},"bo_id":i.get("businessObjectId"),"row_id":i.get("id")},"select")}else this.render(),this.options.actionContext.boSearchModel.trigger("reference:selected"),this._scrollToPanel(),this._focusButton()},"_getAllValues":function(){var t={},i=this.options&&this.options.metadataView;if(i){t={"name":i.metadataHeaderView.getNameValue(),"type":i.options.model.get("type"),"parent_id":i.options.model.get("parent_id")};var o=i.metadataPropertiesView.getFormsValues();e.extend(t,o)}return t},"_refetchForms":function(e,t){var i=this,o=this.options.actionContext.workspaceReference,n=e.bo_id,s=this.options.actionContext,a=this.options.originatingView,r=this.options.fetchedModels;if("workspace_reference_create"===s.mode){var c=r.formCollection;n?(c.bo_type_id=o.get("bo_type_id"),c.bo_id=n):(delete c.bo_type_id,delete c.bo_id),c.formsValues=this._getAllValues(),c.formsSchema=c.serverForms,r.fetch().then(function(){o.set(e),"select"===t&&a.once("render:forms",function(){i.options.actionContext.boSearchModel.trigger("reference:selected")}),s.scrollToPanel=!0,s.focusButton=!0},function(){"select"===t&&i.options.actionContext.boSearchModel.trigger("reference:rejected")})}else if("workspace_reference_edit"===s.mode){var l=o.get("bo_id"),d=this.options.node;o.set("bo_id",n),o.save({},{"wait":!0}).then(function(){d.fetch().then(function(){r.fetch().then(function(){o.set(e),"select"===t&&a.once("render:forms",function(){i.options.actionContext.boSearchModel.trigger("reference:selected")}),s.scrollToPanel=!0,s.focusButton=!0},function(){o.set("bo_id",l),"select"===t&&i.options.actionContext.boSearchModel.trigger("reference:rejected")})},function(){o.set("bo_id",l),"select"===t&&i.options.actionContext.boSearchModel.trigger("reference:rejected")})},function(){o.set("bo_id",l),"select"===t&&i.options.actionContext.boSearchModel.trigger("reference:rejected")})}else o.set(e),this.render(),"select"===t&&i.options.actionContext.boSearchModel.trigger("reference:selected"),this._scrollToPanel(),this._focusButton()},"_scrollToPanel":function(){var e=this.options&&this.options.originatingView,t=e&&e.tabLinks;if(t){var i;t.children.each(function(e){"conws-reference"===e.model.id&&(i=e)}),i&&i.activate()}},"_focusButton":function(e){var i=this.options&&this.options.metadataView,o=i&&i.metadataHeaderView,n=o&&o.metadataItemNameView;if(!n||n.readonly||n.model&&n.model.get("name")||e&&e.cancelSearch){if(this.options.actionContext.workspaceReference.get("bo_id")){var s;this.replaceView&&(s=t(this.replaceView.ui.replaceButton),s.trigger("focus"))}else this.initialView&&(s=t(this.initialView.ui.searchButton),s.trigger("focus"));var a=this.options.originatingView,r=a.$el.find("div[id='conws-reference']");if(r&&r.length>0){var c=r[0].offsetTop;if(s&&s.length>0){var l=s[0].offsetTop,d=s.height(),p=a.tabContent.$el.height();if(l+d>c+p){var u=Math.max(a.getOption("extraScrollTopOffset")||0,5),h=l+d-p+u;a.tabContent.$el.animate({"scrollTop":h},300)}}}}else n.setEditModeFocus()},"_formsRendered":function(){this.options.actionContext.scrollToPanel&&(delete this.options.actionContext.scrollToPanel,this._scrollToPanel()),this.options.actionContext.focusButton&&(delete this.options.actionContext.focusButton,this._focusButton())},"validate":function(){return!0},"getValues":function(){return{"bo_id":this.options.actionContext.workspaceReference.get("bo_id"),"bo_type_id":this.options.actionContext.workspaceReference.get("bo_type_id")}},"hideNotRequired":function(e){return!0}});return v}),csui.define("xecmpf/widgets/boattachments/impl/boattachments.factory",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/node","xecmpf/widgets/boattachments/impl/boattachments.model","xecmpf/models/boattachmentcontext/attachmentcontext.busobjinfo.factory"],function(e,t,i,o,n,s,a,r){var c=n.extend({"propertyPrefix":"boAttachments","constructor":function(i,r){n.prototype.constructor.apply(this,arguments);var c=this.options.boAttachments||{};c instanceof o.Collection||(this.property=new a(c.models,t.extend({"context":i,"node":i.getModel(s,r)},c.options,e.config().options,{"autoreset":!0},r)))},"fetch":function(e){return this.property.fetch(e)}});return c}),csui.define("xecmpf/widgets/boattachments/impl/boattachment.table/toolbaritems",["module","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.factory","i18n!xecmpf/widgets/boattachments/impl/nls/lang","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings"],function(e,t,i,o,n){var s={"tableHeaderToolbar":new i({"main":[{"signature":"Snapshot","name":o.CommandSnapshot}]},{"maxItemsShown":15,"dropDownIcon":"icon icon-toolbar-more"})};return s}),csui.define("xecmpf/widgets/boattachments/impl/boattachment.table/boattachments.columns",["csui/lib/backbone","i18n!xecmpf/widgets/boattachments/impl/nls/lang"],function(e,t){var i=e.Model.extend({"defaults":{"key":null,"sequence":0}}),o=e.Collection.extend({"model":i,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new o(this.map(function(e){return e.attributes}))}}),n=new o([{"key":"type","permanentColumn":!0,"sequence":10},{"key":"name","permanentColumn":!0,"sequence":20},{"key":"parent_id","title":t.parent_id,"permanentColumn":!0,"sequence":30},{"key":"reserved","sequence":40,"noTitleInHeader":!0,"permanentColumn":!0},{"key":"modify_date","permanentColumn":!0,"sequence":50},{"key":"version","sequence":60},{"key":"size","sequence":70},{"key":"create_date","sequence":80},{"key":"createdby","sequence":90},{"key":"modifiedby","sequence":100},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}]);return n}),csui.define("xecmpf/widgets/boattachments/impl/headertoolbaritems",["csui/controls/toolbar/toolitems.factory","i18n!xecmpf/widgets/boattachments/impl/nls/lang"],function(e,t){var i={"AddToolbar":new e({"main":[{"signature":"BOAttachmentsCreate","name":t.addBusinessAttachment,"icon":"icon icon-toolbarAdd"}]},{"maxItemsShown":1,"dropDownIcon":"icon icon-toolbar-more"})};return i}),csui.define("hbs!xecmpf/controls/dialogheader/impl/dialogheader",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'  <div class="cs-close" title="'+this.escapeExpression((n=null!=(n=t.dialogCloseButtonTooltip||(null!=e?e.dialogCloseButtonTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"dialogCloseButtonTooltip","hash":{}}):n))+'">\r\n    <div class="icon circular '+this.escapeExpression((n=null!=(n=t.iconRight||(null!=e?e.iconRight:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconRight","hash":{}}):n))+'" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=t.ariaDialogClose||(null!=e?e.ariaDialogClose:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaDialogClose","hash":{}}):n))+'"\r\n         role="button"></div>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="left-section"></div>\r\n<div class="center-section"></div>\r\n<div class="right-section"></div>\r\n\r\n'+(null!=(n=t["if"].call(e,null!=e?e.hideDialogClose:e,{"name":"if","hash":{},"fn":this.noop,"inverse":this.program(1,o,0)}))?n:"")}});return i.registerPartial("xecmpf_controls_dialogheader_impl_dialogheader",o),o}),csui.define("xecmpf/controls/dialogheader/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/controls/dialogheader/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","ariaDialogClose":"Close dialog"}),csui.define("css!xecmpf/controls/dialogheader/impl/dialogheader",[],function(){}),csui.define("xecmpf/controls/dialogheader/dialogheader.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!xecmpf/controls/dialogheader/impl/dialogheader","i18n!xecmpf/controls/dialogheader/impl/nls/lang","css!xecmpf/controls/dialogheader/impl/dialogheader"],function(e,t,i,o,n,s,a){var r=o.LayoutView.extend({"className":"xecmpf-header","template":s,"behaviors":{"TabableRegion":{"behaviorClass":n}},"regions":{"LeftRegion":".left-section","CenterRegion":".center-section","RightRegion":".right-section"},"events":{"keydown":"onKeyInView"},"templateHelpers":function(){return{"iconRight":this.options.iconRight?this.options.iconRight:"cs-icon-cross","dialogCloseButtonTooltip":a.dialogCloseButtonTooltip,"ariaDialogClose":a.ariaDialogClose,"hideDialogClose":this.options.hideDialogClose?this.options.hideDialogClose:!1}},"constructor":function(e){o.LayoutView.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.options.leftView,t=this.options.centerView,i=this.options.rightView;e&&this.LeftRegion.show(e),t&&this.CenterRegion.show(t),i&&this.RightRegion.show(i)},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),t(e&&e.shiftKey?i[i.length-1]:i[0])},"onLastTabElement":function(e,t){return e&&t.target===this.$("*[tabindex]")[0]},"onKeyInView":function(e){var i=e.keyCode;
(13===i||32===i)&&t(e.target).trigger("click")}});return r}),csui.define("hbs!xecmpf/controls/headertoolbar/impl/headertoolbar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div class="filter-toolbar"></div>\r\n<div class="add-toolbar"></div>\r\n<div class="other-toolbar"></div>'}});return i.registerPartial("xecmpf_controls_headertoolbar_impl_headertoolbar",o),o}),csui.define("css!xecmpf/controls/headertoolbar/impl/headertoolbar",[],function(){}),csui.define("xecmpf/controls/headertoolbar/headertoolbar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/toolbar.command.controller","hbs!xecmpf/controls/headertoolbar/impl/headertoolbar","css!xecmpf/controls/headertoolbar/impl/headertoolbar"],function(e,t,i,o,n,s,a,r){var c=o.LayoutView.extend({"className":"xecmpf-header-toolbar","template":r,"regions":{"FilterToolbarRegion":".filter-toolbar","AddToolbarRegion":".add-toolbar","OtherToolbarRegion":".other-toolbar"},"constructor":function(e){this.commands=e.commands,this.commandController=e.commandController?e.commandController:new a({"commands":this.commands}),this.originatingView=e.originatingView?e.originatingView:this,this.context=e.context,this.nodes=e.selectedNodes,this.container=e.container,this.collection=e.collection,this.addableTypes=e.addableTypes,this.toolbarNames=["Filter","Add","Other"],this.toolbarItems=e.toolbarItems||[],o.LayoutView.prototype.constructor.apply(this,arguments)},"initialize":function(t){var i={"context":this.context,"nodes":this.selectedNodes,"container":this.container,"collection":this.collection,"originatingView":this.originatingView,"data":{"addableTypes":this.addableTypes}};e.each(this.toolbarNames,function(t){var o=t+"Toolbar",a=this.toolbarItems[o];if(a){e.any(a.collection.models,function(e){return"disabled"===e.attributes.signature?(a.collection.remove(e),!0):void 0});var r=new n(a,{"status":i,"commands":this.commandController.commands}),c=new s(e.extend({"collection":r,"toolbarName":t,"originatingView":this.originatingView},a.options));this[t+"ToolbarView"]=c,this.listenTo(c,"childview:toolitem:action",this._toolbarItemClicked)}},this)},"onRender":function(){e.each(this.toolbarNames,function(e){this[e+"ToolbarView"]&&this[e+"ToolbarRegion"].show(this[e+"ToolbarView"])},this)},"_toolbarItemClicked":function(e,t){this.options.toolItemView=e,this.commandController.toolitemClicked(t.toolItem,this.options)}});return c}),csui.define("hbs!xecmpf/controls/title/impl/title",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'  <div class="tile-type-icon">\r\n    <span class="icon title-icon '+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" aria-hidden="true"></span>\r\n  </div>\r\n'},"3":function(e,t,i,o){var n;return null!=(n=t["if"].call(e,null!=e?e.imageUrl:e,{"name":"if","hash":{},"fn":this.program(4,o,0),"inverse":this.noop}))?n:""},"4":function(e,t,i,o){var n;return'    <div class="tile-type-image '+this.escapeExpression((n=null!=(n=t.imageClass||(null!=e?e.imageClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageClass","hash":{}}):n))+'">\r\n      <span class="tile-type-icon tile-type-icon-img">\r\n        <img src="'+this.escapeExpression((n=null!=(n=t.imageUrl||(null!=e?e.imageUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageUrl","hash":{}}):n))+'" alt="" aria-hidden="true">\r\n      </span>\r\n    </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return(null!=(n=t["if"].call(e,null!=e?e.icon:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.program(3,o,0)}))?n:"")+'\r\n<div class="title-name">\r\n  <h4 class="title-name-block" title="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+"</h4>\r\n</div>\r\n"}});return i.registerPartial("xecmpf_controls_title_impl_title",o),o}),csui.define("css!xecmpf/controls/title/impl/title",[],function(){}),csui.define("xecmpf/controls/title/title.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!xecmpf/controls/title/impl/title","css!xecmpf/controls/title/impl/title"],function(e,t,i,o,n){var s=o.ItemView.extend({"className":"title-wrapper","template":n,"templateHelpers":function(){return{"icon":this.options.icon,"imageUrl":this.options.imageUrl,"imageClass":this.options.imageClass,"title":this.options.title}},"constructor":function(){o.ItemView.prototype.constructor.apply(this,arguments)}});return s}),csui.define("hbs!xecmpf/widgets/boattachments/impl/boattachment.table/boattachmentstable",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div class="xecmpf-boattachmentstable">\r\n    <div class="xecmpf-alternating-toolbars">\r\n        <div class="xecmpf-widget-table-header"></div>\r\n        <div id="botabletoolbar" class="xecmpf-rowselection-toolbar"></div>\r\n    </div>\r\n    <div id="botableview"></div>\r\n    <div id="bopaginationview"></div>\r\n</div>'}});return i.registerPartial("xecmpf_widgets_boattachments_impl_boattachment.table_boattachmentstable",o),o}),csui.define("css!xecmpf/widgets/boattachments/impl/boattachment.table/boattachmentstable",[],function(){}),csui.define("xecmpf/widgets/boattachments/impl/boattachment.table/boattachmentstable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/connector","csui/controls/table/table.view","csui/controls/pagination/nodespagination.view","csui/dialogs/modal.alert/modal.alert","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/utils/commands","csui/controls/table/rows/description/description.view","xecmpf/widgets/boattachments/impl/boattachment.table/toolbaritems","xecmpf/widgets/boattachments/impl/boattachment.table/boattachments.columns","xecmpf/widgets/boattachments/impl/headertoolbaritems","xecmpf/controls/dialogheader/dialogheader.view","xecmpf/controls/headertoolbar/headertoolbar.view","xecmpf/controls/title/title.view","xecmpf/behaviors/toggle.header/toggle.header.behavior","i18n!xecmpf/widgets/boattachments/impl/nls/lang","hbs!xecmpf/widgets/boattachments/impl/boattachment.table/boattachmentstable","css!xecmpf/widgets/boattachments/impl/boattachment.table/boattachmentstable"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x,_){var k=e.config();i.defaults(k,{"defaultPageSize":30,"orderBy":{"sortColumn":"{name}","sortOrder":"asc"}});var C=n.LayoutView.extend({"className":"xecmpf-boattachments-table","template":_,"regions":{"tableHeaderRegion":".xecmpf-widget-table-header","tableRegion":"#botableview","paginationRegion":"#bopaginationview"},"behaviors":{"DefaultAction":{"behaviorClass":a},"ToggleHeader":{"behaviorClass":y,"tableHeader":".xecmpf-widget-table-header","alternatingTableContainer":".xecmpf-alternating-toolbars","tableToolbar":".xecmpf-rowselection-toolbar"}},"constructor":function(e){e||(e={}),i.defaults(e,{"data":{},"pageSize":k.defaultPageSize,"toolbarItems":m,"toolbarItemsMasks":{"toolbars":{}}}),i.defaults(e.data,{"pageSize":k.defaultPageSize,"orderBy":k.orderBy}),this.context=e.context,this.collection=e.collection,this.titleBarIcon=e.titleBarIcon,this.title=e.title,this.extId=e.extId,this.boId=e.boId,this.boType=e.boType,n.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(e){this.setHeaderView(),this.setTableView(),this.setPagination(),e.collection&&(this.collection.fetched=!1)},"setTableView":function(){this.columns=this.collection.columns,this.connector=this.collection.node&&this.collection.node.connector||this.context.getObject(r);var e=[""];i.each(this.columns.models,function(t){t.get("sort")===!0&&-1===t.get("type")&&e.push(t.get("column_key"))});var t=f.clone();this.tableView=new c({"context":this.options.context,"haveDetailsRowExpandCollapseColumn":!0,"descriptionRowView":h,"descriptionRowViewOptions":{"firstColumnIndex":2,"lastColumnIndex":2,"showDescriptions":!0,"collapsedHeightIsOneLine":!0},"connector":this.connector,"collection":this.collection,"columns":this.columns,"tableColumns":t,"columnsWithSearch":e,"selectColumn":!0,"pageSize":this.options.data.pageSize,"orderBy":this.collection.options.boAttachments.attributes.sortExpanded||this.collection.orderBy,"nameEdit":!1,"tableTexts":{"zeroRecords":x.noAttachmentsFound},"maxColumnsDisplayed":10}),this.listenTo(this.tableView,"execute:defaultAction",function(e){var t={"node":e};this.trigger("before:defaultAction",t),t.cancel||this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){this.trigger("executed:defaultAction",t)}.bind(this))})},"setPagination":function(){this.paginationView=new l({"collection":this.collection,"pageSize":this.options.data.pageSize})},"onRender":function(){this.collection.fetch({"reload":!0}),this.tableHeaderRegion.show(this.headerView),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)},"onBeforeShow":function(){this._renderTitleIconWaterMark()},"_renderTitleIconWaterMark":function(){var e=this.$el.find(".tile-type-image img")[0];e&&t(e).after('<span class="csui-icon xecmpf-icon-boattachment-overlay" title="'+x.businessAttachments+'"></span>')},"setHeaderView":function(){var e=new w({"commands":u,"originatingView":this,"context":this.context,"collection":this.collection,"toolbarItems":g,"data":{"extId":this.extId,"boType":this.boType,"boid":this.boId}}),t=this.titleBarIcon,i=new v({"imageUrl":t.src,"imageClass":t.cssClass,"title":this.title});this.headerView=new b({"iconRight":"icon-tileCollapse","leftView":e,"centerView":i})}});return i.extend(C.prototype,p),C}),csui.define("hbs!xecmpf/widgets/boattachments/impl/boattitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'              <span class="xecmpf-value">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.title:e)?n.value:n,e))+"</span>\r\n"+(null!=(n=t["if"].call(e,null!=e?e.reserved_by:e,{"name":"if","hash":{},"fn":this.program(2,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=e?e.reserved_by_other:e,{"name":"if","hash":{},"fn":this.program(4,o,0),"inverse":this.noop}))?n:"")},"2":function(e,t,i,o){var n;return'                  <span class="csui-icon icon-reserved_self" title="'+this.escapeExpression((n=null!=(n=t.reserved_by||(null!=e?e.reserved_by:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reserved_by","hash":{}}):n))+'"></span>\r\n'},"4":function(e,t,i,o){var n;return'                  <span class="csui-icon icon-reserved_other" title="'+this.escapeExpression((n=null!=(n=t.reserved_by_other||(null!=e?e.reserved_by_other:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reserved_by_other","hash":{}}):n))+'"></span>\r\n'},"6":function(e,t,i,o){var n;return'            <span class="xecmpf-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.title:e)?n.label:n,e))+"</span>\r\n"},"8":function(e,t,i,o){return'            <!-- add element to get proper distance to description -->\r\n            <div class="xecmpf-description-spacer"></div>\r\n'},"10":function(e,t,i,o){var n;return'          <div class="xecmpf-right">\r\n'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.topRight:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(11,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.topRight:e)?n.label:n,{"name":"if","hash":{},"fn":this.program(14,o,0),"inverse":this.noop}))?n:"")+"          </div>\r\n"},"11":function(e,t,i,o){var n;return'              <span class="xecmpf-value">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.topRight:e)?n.value:n,e))+"</span>\r\n"+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.topRight:e)?n.label:n,{"name":"if","hash":{},"fn":this.program(12,o,0),"inverse":this.noop}))?n:"")},"12":function(e,t,i,o){return'                <!-- add element to get proper distance to value -->\r\n                <div class="xecmpf-spacer"></div>\r\n'},"14":function(e,t,i,o){var n;return'              <span class="xecmpf-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.topRight:e)?n.label:n,e))+"</span>\r\n"},"16":function(e,t,i,o){var n;return'          <div class="xecmpf-body">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.description:e)?n.value:n,e))+"</div>\r\n"},"18":function(e,t,i,o){var n;return'          <div class="xecmpf-left">\r\n'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.bottomLeft:e)?n.label:n,{"name":"if","hash":{},"fn":this.program(19,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.bottomLeft:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(21,o,0),"inverse":this.noop}))?n:"")+"          </div>\r\n"},"19":function(e,t,i,o){var n;return'              <span class="xecmpf-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.bottomLeft:e)?n.label:n,e))+"</span>\r\n"+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.bottomLeft:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(12,o,0),"inverse":this.noop}))?n:"")},"21":function(e,t,i,o){var n;return'              <span class="xecmpf-value">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.bottomLeft:e)?n.value:n,e))+"</span>\r\n"},"23":function(e,t,i,o){var n;return'          <div class="xecmpf-right">\r\n'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.bottomRight:e)?n.label:n,{"name":"if","hash":{},"fn":this.program(24,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.bottomRight:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(26,o,0),"inverse":this.noop}))?n:"")+"          </div>\r\n"},"24":function(e,t,i,o){var n;return'              <span class="xecmpf-label">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.bottomRight:e)?n.label:n,e))+"</span>\r\n"+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.bottomRight:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(12,o,0),"inverse":this.noop}))?n:"")},"26":function(e,t,i,o){var n;return'              <span class="xecmpf-value">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.bottomRight:e)?n.value:n,e))+"</span>\r\n"},"28":function(e,t,i,o){return'  <div class="xecmpf-attachmentitem-divider"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return'<div class="xecmpf-attachmentitem-action-area">\r\n  <a class="xecmpf-nostyle" href="'+this.escapeExpression((s=null!=(s=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"defaultActionUrl","hash":{}}):s))+'">\r\n    <div class="xecmpf-attachmentitem-border">\r\n        <div class="xecmpf-attachmentitem-top">\r\n            <span class="csui-type-icon '+this.escapeExpression((s=null!=(s=t.icon||(null!=e?e.icon:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"icon","hash":{}}):s))+'" aria-hidden="true"></span>\r\n            <div class="xecmpf-title xecmpf-left">\r\n'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.title:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.title:e)?n.label:n,{"name":"if","hash":{},"fn":this.program(6,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.description:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(8,o,0),"inverse":this.noop}))?n:"")+"        </div>\r\n\r\n"+(null!=(n=t["if"].call(e,null!=e?e.topRight:e,{"name":"if","hash":{},"fn":this.program(10,o,0),"inverse":this.noop}))?n:"")+'      </div>\r\n\r\n      <div class="xecmpf-attachmentitem-center">\r\n'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.description:e)?n.value:n,{"name":"if","hash":{},"fn":this.program(16,o,0),"inverse":this.noop}))?n:"")+'      </div>\r\n\r\n      <div class="xecmpf-attachmentitem-bottom">\r\n'+(null!=(n=t["if"].call(e,null!=e?e.bottomLeft:e,{"name":"if","hash":{},"fn":this.program(18,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t["if"].call(e,null!=e?e.bottomRight:e,{"name":"if","hash":{},"fn":this.program(23,o,0),"inverse":this.noop}))?n:"")+"      </div>\r\n    </div>\r\n  </a>\r\n</div>\r\n\r\n"+(null!=(n=t["if"].call(e,null!=e?e.notLastItem:e,{"name":"if","hash":{},"fn":this.program(28,o,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("xecmpf_widgets_boattachments_impl_boattitem",o),o}),csui.define("css!xecmpf/widgets/boattachments/impl/boattitem",[],function(){}),csui.define("xecmpf/widgets/boattachments/impl/boattitem.view",["module","csui/lib/underscore","csui/lib/marionette","csui/lib/jquery","csui/behaviors/default.action/default.action.behavior","csui/utils/base","csui/lib/numeral","csui/utils/contexts/factories/user","xecmpf/widgets/boattachments/impl/boattachmentutil","i18n!xecmpf/widgets/boattachments/impl/nls/lang","hbs!xecmpf/widgets/boattachments/impl/boattitem","css!xecmpf/widgets/boattachments/impl/boattitem"],function(e,t,i,o,n,s,a,r,c,l,d){var p=i.ItemView.extend({"behaviors":{"DefaultAction":{"behaviorClass":n}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.user=this.options.context.getModel(r)},"triggers":{"click .xecmpf-attachmentitem-border":"click:item"},"onClickItem":function(){this.triggerMethod("execute:defaultAction",this.model)},"className":"xecmpf-attachmentitem-object clearfix","template":d,"_checkValue":function(e){return t.isUndefined(e.value)||t.isNull(e.value)?!1:!0},"_convValueToString":function(e){return!t.isString(e.value)&&(e.value=e.value+""),e},"serializeData":function(){var e=this._getObject(this.options.data||{}),t={};if(e.title&&(t.title=e.title),e.description&&(t.description=e.description),e.topRight&&this._checkValue(e.topRight)&&(t.topRight=this._convValueToString(e.topRight)),e.bottomLeft&&this._checkValue(e.bottomLeft)&&(t.bottomLeft=this._convValueToString(e.bottomLeft)),e.bottomRight&&this._checkValue(e.bottomRight)&&(t.bottomRight=this._convValueToString(e.bottomRight)),t.title||(t.title={"value":this.model.get("name")}),t.name||(t.name=this.model.get("name")),t.id||(t.id=this.model.get("id")),t.defaultActionUrl=n.getDefaultActionNodeUrl(this.model),this.model.get("id")!==this.model.collection.models[this.model.collection.models.length-1].get("id")&&(t.notLastItem=!0),this.model.get("reserved_user_id")){var i=l.reservedBy.replace("%1",this.model.get("reserved_user_id_expand").name_formatted);this.user.get("id")===this.model.get("reserved_user_id")?t.reserved_by=i:t.reserved_by_other=i}return t},"templateHelpers":function(e){return e},"_getObject":function(e){return t.reduce(e,function(e,t,i){if("object"!=typeof t)t=this.self._getValue(t);else if("object"==typeof t)if("value"===i||"label"===i){var o=s.getClosestLocalizedString(t);t=this.self._getValue(o)}else t=this.self._getObject(t);return e[i]=t,e},{},{"self":this})},"_getValue":function(e){for(var t,i,o,n,s,a=/{([^:}]+)(:([^}]+))?}/g,r=e;t=a.exec(e);)o=t[0],i=t[1],s=t[3],this.model.collection.columns.models&&(n=this._formatPlaceholder(i,s,this.model.attributes,this.model.collection.columns.models)),r=r.replace(o,n);return r},"_formatPlaceholder":function(e,i,o,n){var r,c,l,d="_expand",p=e;switch(c=t.find(n,function(t){return t.get("column_key")===e}),l=c&&c.get("type")||void 0,e=o[e+d]?e+d:e,r=t.isUndefined(o[e])?"":o[e],l){case-7:("modify_date"===e||"modified"===e)&&(r=o.modified||o.modify_date),r=s.formatDate(r);break;case 5:r=o[e+"_formatted"],(null===r||void 0===r)&&(r="");break;case 2:case 14:"size"===e||"modifiedby"===e||"createdby"===e?r=o[e+"_formatted"]:-1===e.indexOf(d,this.length-d.length)||"User"!==o[e].type_name&&"Group"!==o[e].type_name||(r=s.formatMemberName(r));default:"currency"===i&&(r=a(r).format()),"object"==typeof r&&(r=o[p]||"")}return r}});return p}),csui.define("css!xecmpf/widgets/boattachments/impl/boattachments",[],function(){}),csui.define("xecmpf/widgets/boattachments/boattachments.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/base","csui/controls/list/list.view","csui/utils/nodesprites","csui/behaviors/limiting/limiting.behavior","csui/behaviors/expanding/expanding.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/list/behaviors/list.view.keyboard.behavior","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/utils/contexts/factories/node","csui/controls/progressblocker/blocker","csui/dialogs/modal.alert/modal.alert","csui/utils/log","csui/controls/node-type.icon/node-type.icon.view","csui/utils/commands","xecmpf/widgets/boattachments/impl/boattachments.factory","xecmpf/widgets/boattachments/impl/boattachment.table/boattachmentstable.view","xecmpf/widgets/boattachments/impl/boattitem.view","xecmpf/models/boattachmentcontext/attachmentcontext.factory","xecmpf/widgets/boattachments/impl/boattachmentutil","xecmpf/models/boattachmentcontext/attachmentcontext.busobjinfo.factory","i18n!xecmpf/widgets/boattachments/impl/nls/lang","css!xecmpf/widgets/boattachments/impl/boattachments"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x,_,k,C,T,V){var A=t.config(),M=a.extend({"constructor":function(e){if(this.viewClassName="xecmpf-businessattachments",!e||!e.context)throw new Error("Context required to create AttachmentsView");if(e.businessAttachmentContext||(e.businessAttachmentContext=e.context.getObject(_,e.data),e.businessAttachmentContext.setAttachmentSpecific(v)),e.data||(e.data={}),e.data.businessattachment||(e.data.businessattachment={}),i.defaults(e.data.businessattachment.properties,{"busObjectId":"","busObjectType":"","extSystemId":""}),this.busobjinfo=e.businessAttachmentContext.getModel(C,{"data":e.data.businessattachment.properties,"attributes":e.data.businessattachment.properties}),a.prototype.constructor.apply(this,arguments),this.options.blockingParentView?m.delegate(this,this.options.blockingParentView):m.imbue(this),this.options.data.pageSize=A.defaultPageSize||30,this.configOptionsData=i.clone(e.data),this.lastFilterValue="",this.limit=0,this.listenTo(this.collection,"sync",this._renderBusinessAttachmentTitleIcon),this.listenTo(this.collection,"error",this._renderBusinessAttachmentTitleIcon),this.nodeModel=this.getContext().getObject(h,e.context.options),this.listenTo(this.nodeModel,"change:id",this._reset),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",function(){this.messageOnError=void 0,this.unblockActions.apply(this,arguments)}).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",function(){this.unblockActions.apply(this,arguments),this.messageOnError?(f.showError(this.messageOnError),this.messageOnError=void 0):f.showError(arguments[1].responseJSON.error)}),this.listenTo(this.collection,"request",this.destroyEmptyView),this.options&&this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.orderBy)if(i.isString(this.options.data.collapsedView.orderBy))g.error(T.errorOrderByMustNotBeString)&&console.log(g.last),f.showError(T.errorOrderByMustNotBeString);else if(this.options.data.collapsedView.orderBy.sortColumn){var t=/{([^:}]+)(:([^}]+))?}/g,o=t.exec(this.options.data.collapsedView.orderBy.sortColumn);o||(g.error(T.errorOrderByMissingBraces)&&console.log(g.last),f.showError(T.errorOrderByMissingBraces))}if(this.options&&this.options.data&&this.options.data.collapsedView){var n=[],s=this;["title","description","topRight","bottomLeft","bottomRight"].forEach(function(e){s.options.data.collapsedView[e]&&s.options.data.collapsedView[e].format&&n.push(e)}),n.length>0&&f.showError(i.str.sformat(T.errorFieldFormatTagUnrecognized,n.join(", ")))}},"getContext":function(){return this.options.businessAttachmentContext},"initialize":function(){this.collection=this.completeCollection},"onRender":function(){this._resetInfiniteScrolling(),a.prototype.onRender.call(this)},"onClickHeader":function(e){this.triggerMethod("expand")},"_resetInfiniteScrolling":function(){this.collection.setLimit(0,this.options.data.pageSize,!1)},"templateHelpers":function(){return{"title":this._getTitle(),"imageUrl":this._getTitleIcon().src,"imageClass":"xecmpf-attachmentstitleicon","searchPlaceholder":this._getSearchPlaceholder()}},"childEvents":{"render":"onRenderItem","before:destroy":"onBeforeDestroyItem"},"className":function(){var e=this.viewClassName,t=i.result(a.prototype,"className");return t&&(e=e+" "+t),e},"_reset":function(){this.collection&&this.collection.resetLimit(),this.ui.searchInput&&""!==this.ui.searchInput.val()&&(this.collection&&this.collection.clearFilter(!1),this.ui.searchInput.val("")),this.ui.searchInput&&this.ui.searchInput.is(":visible")&&this.searchClicked(new CustomEvent(""))},"dialogClassName":"xecmpf-businessattachments","behaviors":{"LimitedList":{"behaviorClass":c,"limit":function(){return this.limit},"completeCollection":function(){return this.getContext().getCollection(v,{"attributes":this._getCollectionAttributes(),"options":{"data":this.options.data,"query":this._getCollectionUrlQuery()}})}},"ExpandableList":{"behaviorClass":l,"expandedView":y,"expandedViewOptions":function(){return{"title":this._getTitle(),"titleBarIcon":this._getTitleIcon(),"data":i.clone(this.configOptionsData),"collection":this._getExpandedViewCollection(!0),"context":this.getContext(),"extId":this.busobjinfo.get("extSystemId"),"boType":this.busobjinfo.get("busObjectType"),"boId":this.busobjinfo.get("busObjectKey")}},"dialogClassName":function(){return this.dialogClassName}},"InfiniteScrolling":{"behaviorClass":u,"content":".binf-list-group","contentParent":".tile-content","fetchMoreItemsThreshold":80},"TabableRegion":{"behaviorClass":d},"ListViewKeyboardBehavior":{"behaviorClass":p}},"_getExpandedViewCollection":function(e){return e&&(this.expandViewCollection=this.completeCollection?this.completeCollection.clone():this.collection.clone(),this.expandViewCollection.businessObjectActions=this.completeCollection.businessObjectActions||this.collection.businessObjectActions,this.expandViewCollection.columns=this.completeCollection.columns||this.collection.columns,this.listenTo(this.expandViewCollection,{"add":function(e){this.collection.add(e,{"at":0})}})),this.expandViewCollection},"filterChanged":function(e){e&&"keyup"===e.type&&27===e.keyCode&&this.searchClicked();var t=this.ui.searchInput.val();this.lastFilterValue!==t&&(this.lastFilterValue=t,this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(e){e.filterTimeout=void 0,e._resetInfiniteScrolling(),e.collection.reset();var i;e._getFilterPropertyName&&(i=e._getFilterPropertyName());var o={};o[i||"name"]=t,e.collection.setFilter(o,{"fetch":!1})&&(e.messageOnError=T.errorFilteringFailed,e.collection.fetch())},1e3,this))},"_getTitleIcon":function(){var e={"src":"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==","cssClass":void 0};return this.busobjinfo.get("titleIcon")?(e.src=this.busobjinfo.get("titleIcon"),e.cssClass="csui-icon"):e.cssClass="xecmpf-attachmentstitleicondefault "+r.findClass("equals","type",848),e},"_renderBusinessAttachmentTitleIcon":function(){var e=this.$el.find(".tile-type-image")[0],t=e&&this.$el.find(".tile-type-image").find("img")[0];if(t){var i=this._getTitleIcon();n(t).attr("src")!==i.src&&n(t).attr("src",i.src),i.cssClass&&n(t).attr("class")!==i.cssClass&&n(t).attr("class",i.cssClass),n(t).attr("alt",""),n(t).after('<span class="csui-icon xecmpf-icon-boattachment-overlay" title="'+T.businessAttachments+'"></span>')}},"_getTitle":function(){var e=T.dialogTitle;return this.options.data.title&&(e=s.getClosestLocalizedString(this.options.data.title,T.dialogTitle)),e},"_getSearchPlaceholder":function(){return T.searchPlaceholder.replace("%1",this._getTitle())},"childView":x,"childViewOptions":function(){return i.defaults(this.options.data,{"collapsedView":{"title":{"value":"{name}"}}}),i.defaults(this.options.data.collapsedView.title,{"value":"{name}"}),(i.isEmpty(this.options.data.collapsedView.title)||i.isEmpty(this.options.data.collapsedView.title.value))&&(this.options.data.collapsedView.title={"value":"{name}"}),{"context":this.options.context,"data":this.options.data.collapsedView}},"emptyViewOptions":{"templateHelpers":function(){var e=this._parent.busobjinfo.invalidConfigurationShown?this._parent.busobjinfo.invalidErrorMessage:"";return{"text":this._parent._getNoResultsPlaceholder()+e}}},"_getCollectionAttributes":function(){var e=this.options.data.busObjectId&&this.options.data||this.options.data&&this.options.data.businessattachment&&this.options.data.businessattachment.properties||{};return{"busObjectType":e&&e.busObjectType,"extSystemId":e&&e.extSystemId,"busObjectId":e&&e.busObjectId,"sortExpanded":this.options.data.expandedView&&k.orderByAsString(this.options.data.expandedView.orderBy)||this._getDefaultSortOrder()||void 0,"sortCollapsed":this.options.data.collapsedView&&k.orderByAsString(this.options.data.collapsedView.orderBy)||this._getDefaultSortOrder()||void 0}},"_getDefaultSortOrder":function(){return this._getFilterPropertyName()?this._getFilterPropertyName()+" asc":void 0},"_getCollectionUrlQuery":function(){var e,t=this.options,i={};return t.data.collapsedView&&(e=k.orderByAsString(t.data.collapsedView.orderBy)),e||(e=this._getDefaultSortOrder()),e&&(i.sort=e),i},"_getFirstPlaceholder":function(e){for(var t,i,o,n,s=/{([^:}]+)(:([^}]+))?}/g;t=s.exec(e);)if(o=t[0],i=t[1]){n=t;break}return n},"_getFilterPropertyName":function(){var e;if(this.options&&this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.title&&this.options.data.collapsedView.title.value){var t=this._getFirstPlaceholder(this.options.data.collapsedView.title.value);t&&(e=t[1])}return e},"getElementByIndex":function(e){if(isNaN(e)||0>e)return null;var t=this.$(i.str.sformat(".xecmpf-attachmentitem-object:nth-child({0}) .xecmpf-attachmentitem-border",e+1));return this.$(t[0])},"_getNoResultsPlaceholder":function(){var e=this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.noResultsPlaceholder;return e=e?s.getClosestLocalizedString(e,T.noResultsPlaceholder):T.noResultsPlaceholder},"collectionEvents":{"reset":"onCollectionSync"},"onCollectionSync":function(){this.synced=!0},"isEmpty":function(){return this.synced&&0===this.collection.models.length},"onRenderItem":function(e){e._nodeIconView=new b({"el":e.$(".csui-type-icon").get(0),"node":e.model}),e._nodeIconView.render()},"onBeforeDestroyItem":function(e){e._nodeIconView&&e._nodeIconView.destroy()}});return M}),csui.define("css!xecmpf/widgets/workspaces/controls/tile/impl/tile",[],function(){}),csui.define("xecmpf/widgets/workspaces/controls/tile/tile.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/tile/tile.view","css!xecmpf/widgets/workspaces/controls/tile/impl/tile"],function(e,t,i,o,n,s,a,r){var c=r.extend({"constructor":function(e){r.prototype.constructor.apply(this,arguments)}});return c}),csui.define("xecmpf/widgets/workspaces/factories/workspace.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","xecmpf/widgets/workspaces/models/workspace.collection","csui/utils/contexts/factories/connector","csui/utils/commands"],function(e,t,i,o,n,s,a){
"use strict";var r=o.extend({"propertyPrefix":"workspaces","constructor":function(e,r){r||(r={}),o.prototype.constructor.apply(this,arguments);var c=this.options.workspaces||{};c instanceof i.Collection||(c=new n(c.models,t.extend({},this.options.workspaces,{"autoreset":!0,"commands":a.getAllSignatures(),"includeActions":!1,"connector":e.getObject(s)}))),this.property=c},"fetch":function(e){return this.property.fetch(e)}});return r}),csui.define("xecmpf/widgets/workspaces/factories/workspace.types.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","xecmpf/widgets/workspaces/models/workspace.types.collection","csui/utils/contexts/factories/connector"],function(e,t,i,o,n,s){var a=o.extend({"propertyPrefix":"workspaceTypes","constructor":function(e,t){o.prototype.constructor.apply(this,arguments);var i=new n(void 0,{"autoreset":!0,"config":this.options.workspaceTypes,"connector":e.getObject(s)});this.property=i},"fetch":function(e){return this.property.fetch(e)}});return a}),csui.define("xecmpf/widgets/workspaces/controls/workspaces.table/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/workspaces/controls/workspaces.table/impl/nls/root/lang",{"NodeTableNoFilteredItems":"There are no early workspaces to display.","createNew":"Create new","createNewTooltip":"Create business workspace"}),csui.define("xecmpf/widgets/workspaces/controls/workspaces.table/tabletoolbar.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.view","csui/utils/commands","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/tabletoolbar/tabletoolbar.view","csui/utils/url","xecmpf/widgets/workspaces/factories/workspace.types.factory","i18n!xecmpf/widgets/workspaces/controls/workspaces.table/impl/nls/lang"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g){"use strict";var b=d.extend({"cssPrefix":"binf-","ui":{"dropdown":".binf-dropdown-toggle"},"events":{"click @ui.dropdown":"adjustDropdown"},"_makeDropDown":function(){var e='<a href="#" class="'+this.cssPrefix+'dropdown-toggle csui-acc-focusable"  data-binf-toggle="dropdown" aria-expanded="true"';return e+=this.options.dropDownText?' title="'+this.options.dropDownText+'">':">",this.options.dropDownIcon?e+='<span class="'+this.options.dropDownIcon+'"></span>':this.options.dropDownText&&(e+=this.options.dropDownText),e+="<span class='toolbarlabel'>"+g.createNew+"</span></a>"},"adjustDropdown":function(e){if(this.collection.length<=1){this.$el.find("."+this.cssPrefix+"dropdown-menu").css("display","none");var t={"toolItem":this.collection.at(0)};this.children.first().triggerMethod("before:toolitem:action",t),this.children.first().triggerMethod("toolitem:action",t)}}}),w=h.extend({"constructor":function(e){s.LayoutView.prototype.constructor.apply(this,arguments),this.context=this.options.context,this.commands=this.options.commands||p,this.toolbarNames=["add"];var t=this.options.toolbarItems.addToolbar,i=this.addToolbarView=new b(o.extend({"collection":new l(t,{"status":{},"commands":this.commands,"delayedActions":!1}),"toolbarName":"add"},t.options));this.listenTo(i,"childview:toolitem:action",function(e,t){this.trigger("toolbarItem:clicked",t.toolItem.attributes.commandData)}).listenTo(i,"dom:refresh",function(){this.triggerMethod("refresh:tabindexes")}),this._updateAddToolbar(),this.propagateEventsToRegions()},"updateForSelectedChildren":function(e){},"_addMenuItems":function(e,t){t.models.forEach(function(t){o.isEmpty(t.get("templates"))||o.each(t.get("templates"),function(i){var o=new c({"signature":"AddConnectedWorkspace","name":i.name,"group":"conws","commandData":{"wksp_type_name":t.get("wksp_type_name"),"wksp_type_id":t.get("wksp_type_id"),"template":i,"type":i.subType,"rm_enabled":t.get("rm_enabled")}});e.push(o)})})},"onBeforeShow":function(){this.$el.find("li").remove(),this.options.toolbarItems.addToolbar.reset(this.toolbarItems)},"_updateAddToolbar":function(){this.toolbarItems=[],this.workspaceTypesCollection=this.options.context.getCollection(f,{"busObjectType":this.options.data.busObjectType,"extSystemId":this.options.data.extSystemId}),this._addMenuItems(this.toolbarItems,this.workspaceTypesCollection)}});return o.extend(w.prototype,u),w}),csui.define("xecmpf/widgets/workspaces/controls/workspaces.table/table.columns",["csui/lib/backbone"],function(e){var t=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),i=e.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new i(this.map(function(e){return e.attributes}))}}),o=new i([{"key":"name","sequence":1,"permanentColumn":!0},{"key":"modify_date","sequence":2,"permanentColumn":!0}]);return o}),csui.define("xecmpf/widgets/workspaces/controls/workspaces.table/toolbaritems",["csui/lib/underscore","csui/utils/base","csui/controls/toolbar/toolitems.factory","i18n!xecmpf/widgets/workspaces/controls/workspaces.table/impl/nls/lang"],function(e,t,i,o){var n={"addToolbar":new i({"add":[]},{"maxItemsShown":0,"dropDownIcon":"icon icon-toolbarAdd","dropDownText":o.createNewTooltip,"addTrailingDivider":!1})};return n}),csui.define("hbs!xecmpf/widgets/workspaces/controls/workspaces.table/impl/workspacestable",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div id="tabletoolbar"></div>\r\n<div id="tableview"></div>\r\n<div id="paginationview"></div>\r\n'}});return i.registerPartial("xecmpf_widgets_workspaces_controls_workspaces.table_impl_workspacestable",o),o}),csui.define("css!xecmpf/widgets/workspaces/controls/workspaces.table/impl/workspacestable",[],function(){}),csui.define("xecmpf/widgets/workspaces/controls/workspaces.table/workspaces.table.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/contexts/factories/connector","csui/controls/progressblocker/blocker","csui/controls/table/cells/name/name.view","csui/behaviors/default.action/default.action.behavior","xecmpf/widgets/workspaces/factories/workspace.factory","csui/utils/contexts/factories/columns","csui/controls/table/table.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","xecmpf/widgets/workspaces/controls/workspaces.table/tabletoolbar.view","xecmpf/widgets/workspaces/controls/workspaces.table/table.columns","xecmpf/widgets/workspaces/controls/workspaces.table/toolbaritems","csui/controls/pagination/nodespagination.view","i18n!xecmpf/widgets/workspaces/controls/workspaces.table/impl/nls/lang","hbs!xecmpf/widgets/workspaces/controls/workspaces.table/impl/workspacestable","css!xecmpf/widgets/workspaces/controls/workspaces.table/impl/workspacestable"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x){var _=e.config();i.defaults(_,{"defaultPageSize":30,"clearFilterOnChange":!0,"resetOrderOnChange":!1,"resetLimitOnChange":!0,"fixedFilterOnChange":!1}),l.prototype.getValueData=function(){var e=this.options.column,t=this.model,i=t.get(e.name);return{"defaultAction":"displayWorkspace","defaultActionUrl":"","contextualMenu":e.contextualMenu,"name":i,"inactive":t.get("inactive")}};var k=n.LayoutView.extend({"template":y,"className":"xecmpf_workspacestable","regions":{"tableToolbarRegion":"#tabletoolbar","tableRegion":"#tableview","paginationRegion":"#paginationview"},"ui":{"outerTableContainer":"#outertablecontainer","innerTableContainer":"#innertablecontainer","tableView":"#tableview","paginationView":"#paginationview"},"behaviors":{"DefaultAction":{"behaviorClass":d}},"constructor":function(e){e||(e={}),i.defaults(e,{"data":{},"pageSize":_.defaultPageSize,"toolbarItems":b,"defaultPageSize":_.defaultPageSize,"clearFilterOnChange":_.clearFilterOnChange,"resetOrderOnChange":_.resetOrderOnChange,"resetLimitOnChange":_.resetLimitOnChange,"fixedFilterOnChange":_.fixedFilterOnChange}),this.context=e.context,this.connector=this.context.getObject(r);var o=e.data.height||e.height;o&&this.$el.height(o),c.imbue(this),n.LayoutView.prototype.constructor.apply(this,arguments),this.collection=this.options.collection=this.context.getCollection(p,{"attributes":"early"}),this.columns=this.collection.columns,this.tableColumns=g.deepClone(),this._setToolBar(b),this.defaultActionController.executeAction=function(e){return t.Deferred().resolve()},this._setTableView(),this._setPagination(),this.propagateEventsToRegions()},"_setTableView":function(){this.tableView=new h({"selectRows":"none","context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.columns,"selectColumn":!1,"tableColumns":this.tableColumns,"pageSize":this.options.data.pageSize,"originatingView":this,"columnsWithSearch":["name"],"orderBy":this.options.orderBy,"filterBy":this.options.filterBy,"blockingParentView":this,"tableTexts":{"zeroRecords":v.NodeTableNoFilteredItems}}),this.listenTo(this.tableView,"render",function(){this.tableView.$el.append(t("<div>")[0])}),this._setTableViewEvents()},"_setTableViewEvents":function(){return this.listenTo(this.tableView,"dom:refresh",function(){t(".csui-nodetable")[0]&&!t(".csui-not-ready")[0]&&t(".csui-nodetable").trigger("focus")}),this.listenTo(this.tableView,"execute:defaultAction",function(e){var t={"node":e};if(this.trigger("before:defaultAction",t),!t.cancel){var i=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){i.trigger("executed:defaultAction",t)})}}),!0},"_setToolBar":function(e){return this.tableToolbarView=new f(i.defaults(this.options,{"context":this.options.context,"toolbarItems":e,"collection":this.collection,"originatingView":this})),this.listenTo(this.tableToolbarView,"before:execute:command",this._beforeExecuteCommand),this.listenTo(this.tableToolbarView,"after:execute:command",this._toolbarActionTriggered),this.listenTo(this.tableToolbarView,"toolbarItem:clicked",function(e){this.trigger("toolbarItem:clicked",e)}),!0},"_setPagination":function(){return this.paginationView=new w({"collection":this.collection,"pageSize":this.options.data.pageSize||this.options.pageSize,"defaultDDList":this.options.ddItemsList,"externalWidget":this.options.externalWidget}),!0},"onShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("show")})},"onAfterShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})},"onRender":function(){this.tableToolbarRegion.show(this.tableToolbarView),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)}});return i.extend(k.prototype,m),k}),csui.define("xecmpf/widgets/workspaces/pages/select.workspace/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/workspaces/pages/select.workspace/impl/nls/root/lang",{"pageTitle":"Create or complete business workspace"}),csui.define("hbs!xecmpf/widgets/workspaces/pages/select.workspace/impl/select.workspace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div id="content"></div>\r\n\r\n'}});return i.registerPartial("xecmpf_widgets_workspaces_pages_select.workspace_impl_select.workspace",o),o}),csui.define("css!xecmpf/widgets/workspaces/pages/select.workspace/impl/select.workspace",[],function(){}),csui.define("xecmpf/widgets/workspaces/pages/select.workspace/select.workspace.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","xecmpf/widgets/workspaces/controls/tile/tile.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","xecmpf/widgets/workspaces/controls/workspaces.table/workspaces.table.view","i18n!xecmpf/widgets/workspaces/pages/select.workspace/impl/nls/lang","hbs!xecmpf/widgets/workspaces/pages/select.workspace/impl/select.workspace","css!xecmpf/widgets/workspaces/pages/select.workspace/impl/select.workspace"],function(e,t,i,o,n,s,a,r,c,l,d,p,u){var h=n.LayoutView.extend({"tagName":"div","id":"xecmpf-select_wksp","className":"xecmpf-page","template":p,"regions":{"content":"#content"},"constructor":function(e){n.LayoutView.prototype.constructor.apply(this,arguments),this.context=this.options.context,this.propagateEventsToRegions()},"_getController":function(){return this.options.status.wksp_controller},"onBeforeShow":function(){var e=this.options;this.tileView=new r({"title":d.pageTitle,"contentView":l,"contentViewOptions":e}),this.getRegion("content").show(this.tileView),this.listenTo(this.tileView.contentView,"toolbarItem:clicked",function(n){return i.defaults(e.status,{"workspaceType":new o.Model(n)}),this._getController().createWorkspace(e),t.Deferred().resolve()}),this.listenTo(this.tileView.contentView,"executed:defaultAction",function(t){e.status||(e.status={}),e.status.workspace=t.node,this._getController().updateWorkspace(e)})}});return i.extend(h.prototype,c),h}),csui.define("css!xecmpf/widgets/workspaces/controls/footer/impl/footer",[],function(){}),csui.define("xecmpf/widgets/workspaces/controls/footer/footer.view",["csui/lib/marionette","csui/lib/underscore","csui/lib/jquery","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/behaviors/keyboard.navigation/tabables.behavior","css!xecmpf/widgets/workspaces/controls/footer/impl/footer"],function(e,t,i,o){var n=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(t){e.ItemView.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el;e.text(this.model.get("label")),e.addClass(this.model.get("primary")?"binf-btn-primary":"binf-btn-default"),e.attr("title",this.model.get("toolTip")?this.model.get("toolTip"):""),this.model.get("separate")&&e.addClass("cs-separate"),this.updateButton(this.model)},"updateButton":function(e){var t=this.$el;void 0!==e.get("hidden")&&(e.get("hidden")?t.addClass("hidden"):t.removeClass("hidden")),e.get("primary")===!0?(t.removeClass("binf-btn-default"),t.addClass("binf-btn-primary")):t.addClass("binf-btn-default"),void 0!==e.get("disabled")&&t.prop("disabled",e.get("disabled"))}}),s=e.CollectionView.extend({"id":"wksp_footer","tagName":"div","className":"binf-modal-footer","childView":n,"constructor":function(t){e.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this,"childview:click",this.onClickButton)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"onClickButton":function(e){e.$el.prop("disabled",!0),e.model.get("click")&&e.model.get("click")().fail(function(){e.$el.prop("disabled",!1)})},"update":function(){var e=this;this.collection.models.forEach(function(t){e.children.findByModel(t).updateButton(t)})}});return s}),csui.define("xecmpf/widgets/workspaces/pages/create.workspace/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/workspaces/pages/create.workspace/impl/nls/root/lang",{"pageTitle":"Create business workspace","createWorkspace":"Create","cancel":"Cancel","failedToCreateItem":"Failed to create the new item.","nameIsGeneratedAutomatically":"Workspace name is generated automatically.","errorGettingCreateForm":"Error getting form for workspace creation.","businessWorkspaceTypeName":"Business Workspace","createWorkspaceTooltip":"Create business workspace"}),csui.define("hbs!xecmpf/widgets/workspaces/pages/create.workspace/impl/create.workspace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div id="content" class="cs-properties-wrapper"></div>\r\n<div id="footer"></div>\r\n'}});return i.registerPartial("xecmpf_widgets_workspaces_pages_create.workspace_impl_create.workspace",o),o}),csui.define("css!xecmpf/widgets/workspaces/pages/create.workspace/impl/create.workspace",[],function(){}),csui.define("xecmpf/widgets/workspaces/pages/create.workspace/create.workspace.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/namedsessionstorage","xecmpf/widgets/workspaces/controls/tile/tile.view","xecmpf/widgets/workspaces/controls/footer/footer.view","csui/widgets/metadata/metadata.add.item.controller","csui/widgets/metadata/metadata.action.one.item.properties.view","conws/models/workspacecreateforms","conws/models/metadata.controller","csui/models/node/node.model","conws/models/metadata.controller","csui/utils/contexts/factories/connector","csui/dialogs/modal.alert/modal.alert","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/widgets/metadata/metadata.properties.view","csui/utils/url","i18n!xecmpf/widgets/workspaces/pages/create.workspace/impl/nls/lang","hbs!xecmpf/widgets/workspaces/pages/create.workspace/impl/create.workspace","css!xecmpf/widgets/workspaces/pages/create.workspace/impl/create.workspace"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x,_,k,C){var T=n.LayoutView.extend({"tagName":"div","id":"xecmpf-create_wksp","className":"xecmpf-page","template":k,"regions":{"content":"#content","footer":"#footer"},"behaviors":{"TabablesBehavior":{"behaviorClass":v,"recursiveNavigation":!0,"containTabFocus":!0}},"constructor":function(e){n.LayoutView.prototype.constructor.apply(this,arguments);var s=this;this.context=this.options.context||{},this.buttonCollecion=new o.Collection,this.propagateEventsToRegions(),this.on("dom:refresh",function(){if(t._data){var e=t._data(this.el,"events");if(e&&e.keydown&&e.keydown.length>1){var o=i.isEmpty(e.keydown[1].namespace)?e.keydown[1].type:e.keydown[1].type+"."+e.keydown[1].namespace;o&&e.keydown[1].handler&&s.$el.off(o,e.keydown[1].handler)}}}),csui.require(["classifications/widgets/metadata/general.fields/classifications/metadata.general.form.field.controller","classifications/utils/commands/add.classifications"],function(e,t){e.prototype.getGeneralFormFieldsForCreate=function(){return null},t.prototype.enabled=function(){return!1}},function(){})},"_getController":function(){return this.options.status.wksp_controller},"_create":function(e){var o=new r("create_complete_wksp"),n=this.metadataAddItemPropView.getValues(),s=t.Deferred();return i.isEmpty(n)?s.reject():(n.bo_id=this.options.data.busObjectId,n.type=848,this.metadataController.createItem(this.node,n).done(i.bind(function(t){if(t){var n=t.results&&t.results.data,s=n&&n.properties&&n.properties.id;i.extend(e.status,{"workspaceNode":new m({"id":s,"container":!0}),"viewMode":{"mode":e.data.viewMode?e.data.viewMode.mode:"folderBrowse"}}),o.set(e.data.busObjectType+"-"+e.data.busObjectId,s),this._getController().displayWorkspace(e)}},this)).fail(function(e){var t=_.failedToCreateItem;e&&(e.responseJSON&&e.responseJSON.error?t=e.responseJSON.error:e.responseText&&(t=e.responseText),b.showError(t)),s.reject()})),s.promise()},"_createFormCollection":function(){var e=this.options||{},o=e.status||{},n=e.context||{},r=o.workspaceType,c=this;this.formCollection=new u(void 0,i.defaults(e,{"type":r.get("type"),"wsType":r.get("wksp_type_id"),"node":new m({},{"connector":n.getObject(g)}),"actionContext":{"mode":"create"}})),this.formCollection.bo_id=e.data.busObjectId,this.formCollection.url=function(){var o="forms/businessworkspaces/create",s={"bo_id":e.data.busObjectId,"bo_type":e.data.busObjectType,"ext_system_id":e.data.extSystemId},a=o+"?"+t.param(i.omit(s,function(e){return null===e||void 0===e||""===e})),r=n.getObject(g).connection.url;return x.combine(r&&r.replace("/v1","/v2")||r,a)},this.formCollection.on("error",function(e,t,n){var r=t&&new a.Error(t).message||_.errorGettingCreateForm;s.error("Fetching the create forms failed: {0}",r)&&console.error(s.last),b.showError(r),i.isEmpty(o.mode)&&c.buttonCollecion.length>=2&&c.buttonCollecion.at(1).set("disabled",!1),c.tileView.contentView.metadataHeaderView.metadataItemNameView.remove(),c.footerView&&c.footerView.update()}),this.formCollection.on("sync",function(){c._updateNameAndView(c.node,c.formCollection)})},"_updateNameAndView":function(e,t){var i=t.at(0),o=i.get("data");if(o){var n=o.name;s.debug("name fetched and used: {0}",n)&&console.log(s.last),e.set({"name":n})}else s.debug("name set to empty.")&&console.log(s.last),e.set({"name":""});var a=this.tileView.contentView,r=a&&a.metadataHeaderView,c=r&&r.metadataItemNameView;if(c){var l=i.get("schema"),d=l&&l.properties&&l.properties.name&&l.properties.name.readonly?!0:!1,p=d?_.nameIsGeneratedAutomatically:void 0;c.setPlaceHolder(p),(d?!0:!1)!=(c.readonly?!0:!1)&&c.setReadOnly(d)}},"render":function(){var e=this,o=this.options||{},s=o.context||{},a=this.options.status||{};n.LayoutView.prototype.render.apply(this,arguments),this.buttonCollecion.add({"click":i.bind(this._create,this,this.options),"disabled":!0,"primary":!1,"label":_.createWorkspace,"toolTip":_.createWorkspaceTooltip}),i.isEmpty(a.mode)&&this.buttonCollecion.add({"click":i.bind(function(){var e=t.Deferred();return this._getController().selectWorkspace(),e.resolve(),e.promise()},this,this.options),"disabled":!0,"primary":!1,"toolTip":_.cancel,"label":_.cancel,"separate":!1}),this.footerView=new l({"collection":this.buttonCollecion}),this.node=new m({"type_name":_.businessWorkspaceTypeName,"type":848,"container":!0,"rm_enabled":this.options.status.workspaceType.get("rm_enabled"),"name":""},{"connector":s.getObject(g)}),this._createFormCollection(),this.metadataController=new h(void 0,{});var r=p.extend({"constructor":function(t){p.prototype.constructor.apply(this,arguments),void 0!==this.metadataPropertiesView&&this.metadataPropertiesView.stopListening(this),this.metadataPropertiesView=new y({"node":e.node,"context":e.options.context,"formMode":"create","action":"create","metadataView":this,"formCollection":e.formCollection}),this.listenTo(this.metadataPropertiesView,"render:forms",function(){e.buttonCollecion.at(0).set("disabled",!1),i.isEmpty(a.mode)?(e.buttonCollecion.at(1).set("disabled",!1),e.buttonCollecion.at(0).set("primary",!0)):e.buttonCollecion.at(0).set("primary",!0),e.footerView.update()}),this.listenTo(this.metadataPropertiesView,"before:render",function(){var e=this.metadataPropertiesView.collection.findWhere({"id":"conws-reference"});e&&this.metadataPropertiesView.collection.remove(e,{"silent":!0})})}});this.tileView=new c({"title":_.pageTitle,"contentView":r,"contentViewOptions":{"model":this.node,"context":s,"action":"create","formCollection":this.formCollection}})},"onBeforeShow":function(){this.content.show(this.tileView),this.footer.show(this.footerView),this.metadataAddItemPropView=this.tileView.contentView}});return i.extend(T.prototype,w),T}),csui.define("xecmpf/widgets/workspaces/pages/display.workspace/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/workspaces/pages/display.workspace/impl/nls/root/lang",{"failedAuthentication":"Authentication failed."}),csui.define("hbs!xecmpf/widgets/workspaces/pages/display.workspace/impl/display.workspace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div id="display_wksp_content">\r\n</div>'}});return i.registerPartial("xecmpf_widgets_workspaces_pages_display.workspace_impl_display.workspace",o),o}),csui.define("css!xecmpf/widgets/workspaces/pages/display.workspace/impl/display.workspace",[],function(){}),csui.define("xecmpf/widgets/workspaces/pages/display.workspace/display.workspace.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/contexts/page/page.context","csui/utils/commands","xecmpf/utils/commands/workspaces/workspace.delete","csui/models/node/node.model","csui/utils/contexts/factories/node","csui/utils/contexts/perspective/perspective.context","csui/controls/perspective.panel/perspective.panel.view","csui/integration/folderbrowser/folderbrowser.widget","csui/utils/contexts/factories/connector","xecmpf/utils/commands/folderbrowse/open.full.page.workspace","csui-ext!xecmpf/widgets/workspaces/pages/display.workspace/display.workspace.view","csui/dialogs/modal.alert/modal.alert","i18n!xecmpf/widgets/workspaces/pages/display.workspace/impl/nls/lang","hbs!xecmpf/widgets/workspaces/pages/display.workspace/impl/display.workspace","css!xecmpf/widgets/workspaces/pages/display.workspace/impl/display.workspace"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x){var _=n.LayoutView.extend({"template":y,"tagName":"div","id":"xecmpf-display_wksp","className":"xecmpf-page","commands":c,"templateHelpers":function(){return{"noIFrame":this.options.data&&this.options.data.viewMode&&!this.options.data.viewMode.viewIFrame?!0:!1}},"regions":{"content":"#display_wksp_content"},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.apply(this,arguments)},"authenticateXecm":function(e,i){var o=this;if(i=i||t.Deferred(),this.connector.connection.session&&this.connector.connection.session.ticket){var n=new XMLHttpRequest,s=new g;n.onreadystatechange=function(){4===n.readyState&&(200===n.status?i.resolve():i.reject(v.failedAuthentication+new Error(n.statusText)))},s.authenticate(n,e,this.connector)}else this.options.context.once("sync",function(){o.authenticateXecm(e,i)});return i.promise()},"onShow":function(){var e=this.options||{},o=e.status||{};this.connector=this.options.context.getObject(f);var n=(window.csui&&window.csui.require||window.require,e.data&&e.data.folderBrowserWidget&&e.data.folderBrowserWidget.commands||{}),s=n["go.to.node.history"]||{},a=i.isUndefined(s.enabled)?!0:s.enabled,r=n["open.full.page.workspace"]||{},d=i.isUndefined(r.enabled)?!0:r.enabled,p=i.isUndefined(r.fullPageOverlay)?!0:r.fullPageOverlay,u=e.data.viewMode?e.data.viewMode.mode:"folderBrowse",h=n["search.container"]||{},g=i.isUndefined(h.enabled)?!0:h.enabled;if("fullPage"===u){this.cgiUrl=this.connector&&this.connector.connection&&this.connector.connection.url?this.connector.connection.url.replace("/api/v1",""):"";var v=this;this.authenticateXecm(this.cgiUrl).done(function(){csui.require(["xecmpf/widgets/integration/folderbrowse/full.page.workspace.view","csui/utils/url"],function(n,s){if(void 0===e.data.viewMode.viewIFrame||e.data.viewMode.viewIFrame){var r,c="xecm",l="where_ext_system_id="+e.data.extSystemId+"&where_bo_type="+e.data.busObjectType+"&where_bo_id="+e.data.busObjectId+"&view_mode="+e.data.viewMode.mode,u=s.appendQuery(s.combine(v.cgiUrl,c,"nodes",o.workspaceNode.attributes.id),l),h=window,m=t(h.document).find("head > link[data-csui-theme-overrides]").attr("href"),f=new s(v.cgiUrl).getAbsolute(),g=function(e){e.origin&&new RegExp(e.origin,"i").test(new s(v.cgiUrl).getOrigin())&&e.data&&"ok"===e.data.status&&(e.source.postMessage({"themePath":m},f),h.removeEventListener("message",g,!1))};csui.require.config({"config":{"csui/integration/folderbrowser/commands/go.to.node.history":{"enabled":!0}}}),r=new n({"fullPageWorkspaceUrl":u,"connector":v.connector}),v.content.show(r),h.addEventListener("message",g)}else{var b=i.extend(v.options,{"nodeID":v.options.status.workspaceNode.get("id"),"connector":v.connector,"openFullPageWorkspaceEnabled":d,"fullPageOverlayEnabled":p,"goToNodeHistoryEnabled":a}),w=new n(b);v.content.show(w)}})}).fail(function(e){w.showError(e.toString()),console.error(e)})}else if(void 0!==b&&b.length>0){var y=new b[0](e);if(this.connector.connection.session)this.content.show(y);else{var x=this;this.options.context.once("sync",function(){x.content.show(y)})}}else{csui.require.config({"config":{"csui/integration/folderbrowser/commands/go.to.node.history":{"enabled":a}}}),csui.require.config({"config":{"xecmpf/utils/commands/folderbrowse/search.container":{"enabled":g},"xecmpf/utils/commands/folderbrowse/open.full.page.workspace":{"enabled":d,"fullPageOverlay":p,"busObjectType":e.data.busObjectType,"busObjectId":e.data.busObjectId,"extSystemId":e.data.extSystemId}}});var _=c.get("Delete");_&&c.remove(_),e.data.id=o.workspaceNode.attributes.id,e.data.viewMode.mode=u,e.data.openFullPageWorkspaceEnabled=d,e.data.fullPageOverlayEnabled=p,e.data.goToNodeHistoryEnabled=a;var k=new l(e.data);c.add(k);var C={};C.all=!0,this.options.context.clear(C),this.options.context.options.suppressReferencePanel=!0,void 0===this.options.context.options.viewMode&&(this.options.context.options.viewMode={}),this.options.context.options.viewMode.viewIFrame=this.options.data.viewMode.viewIFrame,this.browser=new m({"breadcrumb":!a,"connection":this.connector.connection,"start":{"id":o.workspaceNode.attributes.id},"context":this.options.context}),x=this,this.listenTo(k,"xecm:delete:workspace:folderBrowse",function(){i.defaults(x.options.data,{"deletecallback":!0}),x.options.status.wksp_controller.selectWorkspace(x.options);var e=c.get("Back");e&&e.clearHistory&&x.browser.options.context&&e.clearHistory(x.browser.options.context)}),this.browser.show({"placeholder":"#display_wksp_content"})}}});return _}),csui.define("xecmpf/widgets/workspaces/pages/update.workspace/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/workspaces/pages/update.workspace/impl/nls/root/lang",{"pageTitle":"Complete workspace","completeWorkspace":"Complete","completeWorkspaceTooltip":"Complete workspace","failedToUpdateItem":"Failed to update the item.","cancel":"Cancel","nameIsGeneratedAutomatically":"Workspace name is generated automatically.","errorGettingCreateForm":"Error getting form for workspace creation."}),csui.define("hbs!xecmpf/widgets/workspaces/pages/update.workspace/impl/update.workspace",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div id="content" class="cs-properties-wrapper"></div>\r\n<div id="footer"></div>\r\n\r\n'}});return i.registerPartial("xecmpf_widgets_workspaces_pages_update.workspace_impl_update.workspace",o),o}),csui.define("css!xecmpf/widgets/workspaces/pages/update.workspace/impl/update.workspace",[],function(){}),csui.define("xecmpf/widgets/workspaces/pages/update.workspace/update.workspace.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/namedsessionstorage","xecmpf/widgets/workspaces/controls/tile/tile.view","xecmpf/widgets/workspaces/controls/footer/footer.view","csui/widgets/metadata/metadata.properties.view","csui/widgets/metadata/metadata.action.one.item.properties.view","csui/models/node/node.model","csui/utils/contexts/factories/connector","csui/dialogs/modal.alert/modal.alert","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/utils/url","csui/utils/commands","conws/models/workspacecreateforms","i18n!xecmpf/widgets/workspaces/pages/update.workspace/impl/nls/lang","hbs!xecmpf/widgets/workspaces/pages/update.workspace/impl/update.workspace","css!xecmpf/widgets/workspaces/pages/update.workspace/impl/update.workspace"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x,_){var k=w.clone();k.reset();var C=n.LayoutView.extend({"tagName":"div","id":"xecmpf-update_wksp","className":"xecmpf-page","template":x,"regions":{
"content":"#content","footer":"#footer"},"behaviors":{"TabablesBehavior":{"behaviorClass":g,"recursiveNavigation":!0,"containTabFocus":!0}},"constructor":function(e){var o=this;n.LayoutView.prototype.constructor.apply(this,arguments),this.context=this.options.context||{},this.propagateEventsToRegions(),this.readOnlyCats={},this.readOnlyCatVals={},this.on("dom:refresh",function(){if(t._data){var e=t._data(this.el,"events");if(e&&e.keydown&&e.keydown.length>1){var n=i.isEmpty(e.keydown[1].namespace)?e.keydown[1].type:e.keydown[1].type+"."+e.keydown[1].namespace;n&&e.keydown[1].handler&&o.$el.off(n,e.keydown[1].handler)}}});var s=this.readOnlyCats,a=this.readOnlyCatVals;this._saveField=function(e){if("create"!==this.mode){var t=this.getValues(),o=this.model.get("id");i.chain(s).each(function(e,n){return void 0!==o&&o!==n?!0:void i.chain(e.properties).each(function(e,o){if("object"===e.type)i.chain(e.properties).each(function(e,i){e.readonly===!0&&(t[o][i]=a[n+":"+o+":"+i])});else if("array"===e.type&&i.has(e,"items")){var s=e.items.properties;i.chain(s).each(function(e,s){e.readonly===!0&&i.chain(t[o]).each(function(e,t){var r=a[n+":"+o+":"+t+":"+s];i.isUndefined(r)||(e[s]=r)})})}else e.readonly===!0&&(t[o]=a[n+":"+o])})}),this._saveChanges(t)}}},"_getController":function(){return this.options.status.wksp_controller},"_createFormCollection":function(){var e=this.options||{},o=e.context,n=e.status,r=n.workspace;this.formCollection=new v(void 0,i.defaults(e,{"type":r.get("type"),"wsType":r.get("wnf_wksp_type_id"),"node":new u(void 0,{"connector":o.getObject(h)})})),this.formCollection.bo_id=e.data.busObjectId,this.formCollection.url=function(){var n="forms/businessworkspaces/create",s={"template_id":r.get("wnf_wksp_template_id"),"parent_id":r.get("parent_id"),"ext_system_id":e.data.extSystemId,"bo_type":e.data.busObjectType,"bo_id":e.data.busObjectId,"completeWorkspace":!0},a=n+"?"+t.param(i.omit(s,function(e){return null===e||void 0===e||""===e})),c=o.getObject(h).connection.url;return b.combine(c&&c.replace("/v1","/v2")||c,a)},this.formCollection.on("error",function(e,t,i){var o=t&&new a.Error(t).message||y.errorGettingCreateForm;s.error("Fetching the create forms failed: {0}",o)&&console.error(s.last),m.showError(o)})},"_updateWorkspaceReference":function(e,t){var i=new FormData;i.append("body",JSON.stringify(t));var o={"type":"PUT","url":b.combine(e.connector.connection.url.replace("/v1","/v2"),"businessworkspaces",e.get("id"),"workspacereferences"),"data":i,"contentType":!1,"processData":!1};return e.connector.makeAjaxCall(o)},"_complete":function(e){var o=new r("create_complete_wksp"),n=this,s=this.tileView.contentView.getValues(),a=t.Deferred();if(i.isEmpty(s))t(".binf-has-error")&&t(".binf-has-error")[0].scrollIntoView(),a.reject();else{var c=e.context||{},l=e.status,d=l.workspace,p=d.get("id");n._updateWorkspaceReference(new u({"id":p},{"connector":c.getObject(h)}),{"bo_type":n.getOption("data").busObjectType,"bo_id":n.getOption("data").busObjectId,"ext_system_id":n.getOption("data").extSystemId}).done(i.bind(function(t){a.resolve(),t&&(i.extend(l,{"workspaceNode":new u({"id":p,"container":!0}),"viewMode":{"mode":e.data.viewMode?e.data.viewMode.mode:"folderBrowse"}}),o.set(e.data.busObjectType+"-"+e.data.busObjectId,p),n._getController().displayWorkspace(e))},this)).fail(function(e){var t=y.failedToUpdateItem;e&&(e.responseJSON&&e.responseJSON.error?t=e.responseJSON.error:e.responseText&&(t=e.responseText),m.showError(t)),a.reject()})}return a.promise()},"_setHeader":function(e){var t=this.formCollection.at(0),i=t.get("data");if(i){var o=i.name;s.debug("name fetched and used: {0}",o)&&console.log(s.last),this.node.set("name",o)}else s.debug("name set to empty.")&&console.log(s.last),this.node.set("name","");var n=this.tileView.contentView.metadataHeaderView,a=n&&n.metadataItemNameView;if(a){var r=t.get("schema"),c=r&&r.properties&&r.properties.name&&r.properties.name.readonly?!0:!1,l=c?y.nameIsGeneratedAutomatically:void 0;a.setPlaceHolder(l),(c?!0:!1)!=(a.readonly?!0:!1)&&a.setReadOnly(c),a.stopListening(this.node)}},"_updateModel":function(e){var t=this;this._setHeader(e),e&&this.formCollection.models.forEach(function(o){var n=o.get("data"),s=o.get("schema");if(i.has(s.properties,e.get("id"))){var a=e.get("id"),r=e.get("schema"),c=s.properties[a];o=n[a],i.chain(c.properties).each(function(n,s,c){if(i.has(r.properties,s)){var l=n.properties,d=e.get("data")[s],p=r.properties[s],u=o[s];if("object"===n.type){var h=p.properties;i.chain(l).each(function(e,i){e.readonly===!0&&(h[i].readonly=e.readonly,t.readOnlyCatVals[a+":"+s+":"+i]=d[i],t.readOnlyCats[a]=r,d[i]=u[i])})}else if("array"===n.type&&i.has(n,"items")){var m=n.items.properties,f=p.items.properties;i.chain(m).each(function(e,o){e.readonly===!0&&(f[o].readonly=e.readonly,i.chain(u).each(function(e,i){d[i]||(d[i]={}),t.readOnlyCatVals[a+":"+s+":"+i+":"+o]=d[i][o],d[i][o]=e[o]}),t.readOnlyCats[a]=r)})}else n.readonly&&(p.readonly=n.readonly,t.readOnlyCatVals[a+":"+s]=d,t.readOnlyCats[a]=r,e.get("data")[s]=u)}})}})},"fetchForm":function(){return this._createFormCollection(),this.formCollection.fetch()},"render":function(){var e=this,s=this.options.status,a=s.workspace,r=new o.Collection([{"click":i.bind(this._complete,this,this.options),"disabled":!0,"primary":!1,"label":y.completeWorkspace,"toolTip":y.completeWorkspaceTooltip},{"click":i.bind(function(){var e=t.Deferred();return this._getController().selectWorkspace(),e.resolve(),e.promise()},this,this.options),"disabled":!0,"primary":!1,"toolTip":y.cancel,"label":y.cancel,"separate":!1}]);n.LayoutView.prototype.render.apply(this,arguments),this.node=new u({"type_name":a.get("type_name"),"type":a.get("type"),"name":a.get("name"),"id":a.get("id"),"container":!0},{"connector":this.context.getObject(h)});var m=d.extend({"contentViewOptions":function(t){return e._updateModel(t),d.prototype.contentViewOptions.apply(this,arguments)}}),f=p.extend({"constructor":function(t){p.prototype.constructor.apply(this,arguments),void 0!==this.metadataPropertiesView&&this.metadataPropertiesView.stopListening(this),this.metadataPropertiesView=new m({"node":e.node,"commands":k,"context":e.options.context,"formMode":"update","action":"update","metadataView":this}),this.listenTo(this.metadataPropertiesView,"render:forms",function(){r.at(0).set("disabled",!1),r.at(1).set("disabled",!1),r.at(0).set("primary",!0),e.footerView.update(),this.metadataPropertiesView.tabContent.children.each(function(t,i){"categories"===t.model.get("role_name")&&(t.content.off("change:field"),t.content._saveField=function(t){e._saveField.apply(this,t)},t.content.listenTo(t.content,"change:field",t.content._saveField))})}),this.listenTo(this.metadataPropertiesView,"before:render",function(){var e=this.metadataPropertiesView.collection.findWhere({"id":"conws-reference"});e&&this.metadataPropertiesView.collection.remove(e,{"silent":!0})})}});this.footerView=new l({"collection":r}),this.tileView=new c({"title":y.pageTitle,"contentView":f,"contentViewOptions":{"model":this.node,"context":this.options.context,"action":"update"}})},"onBeforeShow":function(){this.content.show(this.tileView),this.footer.show(this.footerView)}});return i.extend(C.prototype,f),C}),csui.define("xecmpf/widgets/workspaces/controllers/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/workspaces/controllers/impl/nls/root/lang",{"errorGettingBusinessWorkspaceType":"Cannot get business workspace type."}),csui.define("xecmpf/widgets/workspaces/controllers/dialog.controller",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/namedsessionstorage","xecmpf/widgets/workspaces/pages/select.workspace/select.workspace.view","xecmpf/widgets/workspaces/pages/create.workspace/create.workspace.view","xecmpf/widgets/workspaces/pages/display.workspace/display.workspace.view","xecmpf/widgets/workspaces/pages/update.workspace/update.workspace.view","xecmpf/widgets/workspaces/factories/workspace.factory","xecmpf/widgets/workspaces/factories/workspace.types.factory","conws/models/workspacecreateforms","csui/utils/contexts/factories/connector","csui/models/node/node.model","csui/dialogs/modal.alert/modal.alert","i18n!xecmpf/widgets/workspaces/controllers/impl/nls/lang"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g){var b=o.Object.extend({"constructor":function(e){e=e||{},this.options=e,this.context=this.options.context||{},this.region=this.options.region},"updateWorkspace":function(e){e||(e=this.options),this._showUpdateWorkspaceView(e)},"displayWorkspace":function(e){e||(e=this.options),this._showDisplayWorkspaceView(e)},"createWorkspace":function(e){e||(e=this.options),this._showCreateWorkspaceView(e)},"selectWorkspace":function(e){e||(e=this.options),e.status||(e.status={});var o=e.context,s=e.data,a=this,r=[];this._getBOWorkspace(o,s).done(function(c){c?(i.defaults(e.status,{"workspaceNode":c,"viewMode":{"mode":s.viewMode?s.viewMode.mode:"folderBrowse"}}),a.displayWorkspace(e)):(r.push(a._getBOEarlyWorkspaces(o,s)),r.push(a._getBOWorkspaceType(o,s)),t.when.apply(t,r).done(function(t,o){t&&t.length?a._showSelectWorkspaceView(e):(i.defaults(e.status,{"workspaceType":new n.Model({"wksp_type_name":o.get("wksp_type_name"),"wksp_type_id":o.get("wksp_type_id"),"rm_enabled":o.get("rm_enabled"),"template":o.get("templates")[0],"type":848}),"mode":"directCreate"}),a._showCreateWorkspaceView(e))}).fail(function(e,t,i){e&&(e.responseJSON&&e.responseJSON.error?f.showError(g.errorGettingBusinessWorkspaceType+" "+e.responseJSON.error):f.showError(g.errorGettingBusinessWorkspaceType))})),delete s.deletecallback}).fail(function(e,t,i){e&&(e.responseJSON&&e.responseJSON.error?f.showError(g.errorGettingBusinessWorkspaceType+" "+e.responseJSON.error):f.showError(g.errorGettingBusinessWorkspaceType))})},"_showCreateWorkspaceView":function(e){this.region.show(new r(e))},"_showDisplayWorkspaceView":function(e){var t;if(e.region.currentView instanceof r||e.region.currentView instanceof l)this.region.show(new c(e));else if(this.region.currentView&&this.region.currentView.browser&&"folderBrowse"===this.options.data.viewMode.mode)t=this.options.status.workspaceNode.get("id"),this.region.currentView.browser.enterContainer(t);else if(this.region.currentView&&void 0===this.region.currentView.browser&&document.getElementById("xecm-full-page-frame")&&"fullPage"===this.options.data.viewMode.mode){var i=document.getElementById("xecm-full-page-frame").contentWindow;t=this.options.status.workspaceNode.get("id");var o={};o.action="enterContainer",o.id=t,o.busObjectType=this.options.data.busObjectType,o.busObjectId=this.options.data.busObjectId,o.extSystemId=this.options.data.extSystemId,o.viewMode=this.options.data.viewMode.mode,void 0===this.options.data.viewMode.viewIFrame||this.options.data.viewMode.viewIFrame?i.postMessage(JSON.stringify(o),"*"):this.trigger("xecm:change:fullPage",o)}else this.region.show(new c(e))},"_showUpdateWorkspaceView":function(e){var t=new l(e),i=this;t.fetchForm().done(function(){i.region.show(t)})},"_showSelectWorkspaceView":function(e){this.region.show(new a(e))},"_getBOWorkspace":function(e,i){var o=t.Deferred(),n=!1,a=new s("create_complete_wksp"),r=this.options.deletecallback||i.deletecallback,c=e.getCollection(d,{"attributes":i.busObjectId,"busObjectId":i.busObjectId,"busObjectType":i.busObjectType,"extSystemId":i.extSystemId,"detached":!1});if(r)a.remove(i.busObjectType+"-"+i.busObjectId),c.fetched=!1,delete this.options.data.workspaceNodeId,o.resolve(n);else if(a.get(i.busObjectType+"-"+i.busObjectId)&&!r){var l=a.get(i.busObjectType+"-"+i.busObjectId);n=new m({"id":l,"container":!0}),o.resolve(n)}else i.workspaceNodeId?(n=new m({"id":i.workspaceNodeId,"container":!0}),o.resolve(n)):c.ensureFetched().done(function(){if(1===c.length){var e=c.at(0).get("id");n=new m({"id":e,"container":!0}),a.set(i.busObjectType+"-"+i.busObjectId,e)}o.resolve(n)}).fail(function(){o.reject.apply(o,arguments)});return o},"_getBOEarlyWorkspaces":function(e,i){var o,n=t.Deferred(),s=e.getCollection(d,{"attributes":"early","early":!0,"busObjectType":i.busObjectType,"extSystemId":i.extSystemId,"detached":!0});return o=i.deletecallback||this.options.deletecallback?s.fetch():s.ensureFetched(),o.done(function(){n.resolve(s)}).fail(function(){n.reject.apply(n,arguments)}),n},"_getBOWorkspaceType":function(e,i){var o=t.Deferred(),n=!1,s=e.getCollection(p,{"busObjectType":i.busObjectType,"extSystemId":i.extSystemId,"detached":!0});return s.ensureFetched().done(function(){1===s.at(0).get("templates").length&&(n=s.at(0)),o.resolve(n)}).fail(function(){o.reject.apply(o,arguments)}),o}});return b}),csui.define("xecmpf/widgets/workspaces/routers/dialog.router",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","xecmpf/widgets/workspaces/controllers/dialog.controller"],function(e,t,i,o,n){var s=o.AppRouter.extend({"appRoutes":{"":"selectWorkspace","updateWorkspace/":"updateWorkspace","selectWorkspace/":"selectWorkspace","displayWorkspace/":"displayWorkspace","newWorkspace/":"createWorkspace"},"constructor":function(e){this.controller=new n(e),o.AppRouter.prototype.constructor.apply(this,arguments)},"execute":function(e,t,i){e&&e.apply(this,t)}});return s}),csui.define("xecmpf/widgets/workspaces/utils/urlhelper",["module","csui/lib/jquery","csui/lib/underscore","csui/utils/log","csui/utils/base"],function(e,t,i,o,n){var s={"getParams":function(e){return e.search.replace("?","").split("&").reduce(function(e,t){var i=t.split("=");return e[i[0].toLowerCase()]=i[1],e},{})}};return s}),csui.define("xecmpf/widgets/workspaces/workspaces.widget",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/lib/backbone","xecmpf/widgets/workspaces/routers/dialog.router","xecmpf/widgets/workspaces/controllers/dialog.controller","xecmpf/widgets/workspaces/utils/urlhelper","csui/utils/commands","csui/integration/folderbrowser/commands/go.to.node.history","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/user","xecmpf/widgets/workspaces/pages/select.workspace/select.workspace.view"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m){function f(e){e||(e={});var t=l.getParams(window.location);o.isEmpty(e.data)&&!o.isEmpty(t)?this.options=o.defaults({},e,{"data":{"busObjectId":t.busobjectid,"busObjectType":t.busobjecttype,"extSystemId":t.extsystemid}}):this.options=e,this.options.context.user=this.options.context.getModel(h)}var g=a.Marionette.Region.extend({"show":function(e){this._ensureElement(),e.render(),this.close(function(){this.currentView=e,this.open(e,function(){e instanceof m&&n.triggerMethodOn(e,"show")})})},"close":function(e){var t=this.currentView,i=this;return delete this.currentView,t?void t.$el.hide("slide",{"direction":"left","complete":function(){t.destroy&&t.destroy(),e&&e.call(i)}},250):void(e&&e.call(this))},"open":function(e,t){var i=this;this.$el.hide(),this.$el.html(e.$el),n.triggerMethodOn(e,"before:show"),n.triggerMethodOn(e,"show"),n.triggerMethodOn(e,"dom:refresh"),this.$el.show("slide",{"direction":"right","complete":function(){t&&t.call(i)}},250)}});return o.extend(f.prototype,{"refresh":function(e){e.data.busObjectId&&e.data.busObjectType&&e.data.extSystemId&&(this.options.status.workspaceNode&&delete this.options.status.workspaceNode,this.options.data.workspaceNodeId&&delete this.options.data.workspaceNodeId,this.options.data.busObjectType=e.data.busObjectType,this.options.data.extSystemId=e.data.extSystemId,this.options.data.busObjectId=e.data.busObjectId);var t=d.get("Back");t&&t.clearHistory&&this.region.currentView.browser&&t.clearHistory(this.region.currentView.browser.options.context);var i=new p;i.clearHistory(this.options.context),e.data.viewMode&&(this.options.data.viewMode={},this.options.data.viewMode.mode=e.data.viewMode),this.show(this.options)},"show":function(e){var t=this,n=function(e){try{var n=t.options.context.getObject(u),s=n.getConnectionUrl(),a=s.getProtocol(),r=s.getHost(),c=a+"://"+r;if((s.getOrigin().toLowerCase()===e.origin.toLowerCase()||c.toLowerCase()===e.origin.toLowerCase())&&("string"==typeof e.data||e.data instanceof String)){var l=JSON.parse(e.data);if(l.busObjectId&&l.busObjectType&&l.extSystemId){var d=i(".xecm-modal-header .cs-close");d.length>0&&d.trigger("click");var p=i("#xecm-full-page-frame");p.length>0&&p.remove(),o.defaults(t.options.data,{"deletecallback":!0}),t.showView(t,l)}}}catch(h){console.log(e)}};window.addEventListener("message",n,!1),this.showView(this,e)},"showView":function(e,t){e.region||(e.region=new g({"el":t.placeholder})),o.defaults(e.options,t,{"region":e.region}),e.options.status=e.options.status||{},o.defaults(e.options.status,{"wksp_controller":new c(e.options)}),e.options.status.wksp_controller.selectWorkspace(e.options)},"close":function(){return this.region&&this.region.currentView&&(this.region.currentView.content&&this.region.currentView.content.destroy(),this.region.currentView.browser&&this.region.currentView.browser.destroy(),this.region.currentView.destroy(),this.region.destroy(),this.region=null),this}}),f.version="1.0",f}),csui.define("xecmpf/widgets/myattachments/nls/myattachments.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/myattachments/nls/root/myattachments.lang",{"root":!0,"en-us":!1,"en":!1,"attachmentsTabTitle":"Business Objects","ErrorLoadingAddItemMenu":"Cannot load business object types to the Add menu.","DetachBusinessAttachment":"Detach","GoToWorkspace":"Go to Workspace","OpenSapObject":"Display","AddBusinessAttachment":"Add Business Object","ErrorCreatingBusAttachment":"Cannot create business attachment.","BOSearchTitle":"Search business objects","noBusinessAttachmentsAvailable":"Add business objects to this Content Server item.","tableColumnSearchNoResult":"No results found."}),csui.define("xecmpf/utils/commands/myattachments/detach_myattachment",["module","csui/models/command","csui/utils/commandhelper","csui/lib/jquery","csui/lib/underscore","csui/utils/commands/confirmable","csui/utils/command.error","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,a,r){"use strict";var c,l,d,p=t.extend({"defaults":{"signature":"detach_business_attachment","command_key":["detach_business_attachment"],"name":r.CommandNameDetach,"pageLeavingWarning":r.DetachPageLeavingWarning,"scope":"multiple","doneVerb":r.CommandDoneVerbDetached,"successMessages":{"formatForNone":r.DetachBusAttsNoneMessage,"formatForOne":r.DetachOneBusAttSuccessMessage,"formatForTwo":r.DetachSomeBusAttsSuccessMessage,"formatForFive":r.DetachManyBusAttsSuccessMessage},"errorMessages":{"formatForNone":r.DetachBusAttsNoneMessage,"formatForOne":r.DetachOneBusAttFailMessage,"formatForTwo":r.DetachSomeBusAttsFailMessage,"formatForFive":r.DetachManyBusAttsFailMessage}},"_getConfirmTemplate":function(e,t){return n.template("<span class='msgIcon WarningIcon'><%- message %></span>")},"_getConfirmData":function(e,t){var o=i.getAtLeastOneNode(e);return{"title":r.DetachBusAttsCommandConfirmDialogTitle,"message":1===o.length?n.str.sformat(r.DetachBusAttsCommandConfirmDialogSingleMessage,o.at(0).get("name")):n.str.sformat(r.DetachBusAttsCommandConfirmDialogMultipleMessage,o.length)}},"enabled":function(e,t){var o=i.getJustOneNode(e),n="delete_business_attachment",s=this._getNodeActionForSignature(o,n);return s?!0:!1},"_performAction":function(e,t){var i=e.node,s=o.Deferred(),c=i.collection;if(c){var l=i.destroy({"wait":!0}).done(function(){e.set("count",1),e.deferred.resolve(e),s.resolve(i)}).fail(function(t){var o=t?new a(t,i):t;e.deferred.reject(e,o),t||l.abort(),s.reject(o)});return s.promise()}return s.reject(new a(n.str.sformat(r.CommandFailedSingular,i.get("name"),r.CommandVerbDetach),{"errorDetails":"collection is undefined"}))},"startGlobalMessage":function(e){l.showFileUploadProgress(e,{"oneFileTitle":r.DetachingOneBusAtt,"oneFileSuccess":r.DetachOneBusAttSuccessMessage,"multiFileSuccess":r.DetachManyBusAttsSuccessMessage,"oneFilePending":r.DetachingOneBusAtt,"multiFilePending":r.DetachBusAtts,"oneFileFailure":r.DetachOneBusAttFailMessage,"multiFileFailure":r.DetachManyBusAttsFailMessage2,"someFileSuccess":r.DetachSomeBusAttsSuccessMessage,"someFilePending":r.DetachingSomeBusAtts,"someFileFailure":r.DetachSomeBusAttsFailMessage2,"enableCancel":!1})},"_removeBusAtt":function(e){return e.destroy({"wait":!0})},"_getRespError":function(e){var t="";return e&&e.responseJSON&&e.responseJSON.error?t=e.responseJSON.error:d.messageHelper.hasMessages()&&(t=o(d.messageHelper.toHtml()).text(),d.messageHelper.clear()),t},"_announceStart":function(e){var t=e.originatingView;t&&t.blockActions&&t.blockActions();var i=this.get("pageLeavingWarning");i&&this.PageLeavingBlocker.enable(i)},"_announceFinish":function(e){var t=this.get("pageLeavingWarning");t&&this.PageLeavingBlocker.disable();var i=e.originatingView;i&&i.unblockActions&&i.unblockActions()}});return n.extend(p.prototype,s,{"execute":function(e,t){var r=i.getAtLeastOneNode(e),c=(1===r.length&&r.first(),o.Deferred()),d=e.data||{},p=null!=d.showProgressDialog?d.showProgressDialog:!0;return this.showProgressDialog=p,e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,e.suppressMultipleFailMessage=!0,s.execute.apply(this,arguments).done(function(e){p&&l.hideFileUploadProgress(),c.resolve(e)}).fail(function(e){var t=e&&n.find(e,function(e){return!(e instanceof a)}),i=t?t:e;c.reject(i)}),c.promise()},"_performActions":function(e,t){var s=o.Deferred(),a=this;return csui.require(["csui/utils/taskqueue","csui/utils/page.leaving.blocker","csui/models/fileuploads","csui/utils/commands/multiple.items","csui/controls/globalmessage/globalmessage","csui/utils/messagehelper","csui/utils/base"],function(o,r,d,p,u,h,m){c=h,l=u,m=m,a.PageLeavingBlocker=arguments[1];var f=i.getAtLeastOneNode(e),g=f.models,b=n.map(g,function(e){return{"name":e.get("name"),"state":"pending","count":0,"total":1,"node":e}}),w=g&&g[0]&&g[0].connector,v=new d(b,{"connector":w}),y=n.defaults({"nodes":v},e);v.each(function(e){var t=e.get("node");e.node=t,e.unset("node")}),a.startGlobalMessage(v),p._performActions.call(a,y,t).done(function(e){l.hideFileUploadProgress(),s.resolve(e)}).fail(function(e){s.reject(e)})},function(e){console.log(e),s.reject(e)}),s.promise()}}),p}),csui.define("xecmpf/utils/commands/myattachments/go_to_workspace",["module","csui/models/command","csui/utils/commandhelper","csui/lib/underscore","csui/lib/jquery","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s){"use strict";var a=t.extend({"defaults":{"signature":"go_to_workspace","command_key":["go_to_workspace"],"name":s.CommandNameGoToWorkspace,"scope":"single"},"enabled":function(e){var t=i.getJustOneNode(e),o=this.get("command_key"),n=this._getNodeActionForSignature(t,o);return n?!0:!1},"execute":function(e,t){var o=i.getJustOneNode(e);return this._navigateTo(o,e,t)},"_navigateTo":function(e,t,i){var o=n.Deferred(),s=t.context||t.originatingView.options.context,a=e.get("wksp_id");return csui.require(["csui/lib/backbone","csui/utils/contexts/factories/connector","csui/models/node/node.model","csui/utils/commands/browse"],function(e,t,i,o){var n=s.getObject(t),r=new i({"id":a},{"connector":n}),c=new o;c.execute({"nodes":new e.Collection([r]),"context":s})},function(e){console.log(e),o.reject()}),o.promise()}});return a}),csui.define("xecmpf/utils/commands/myattachments/open_sap_object",["module","csui/models/command","csui/utils/commandhelper","csui/lib/underscore","csui/lib/jquery","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s){"use strict";var a=o.defaults({},e.config(),{"openInNewTab":!0}),r=t.extend({"defaults":{"signature":"open_sap_object","command_key":["open_sap_object"],"name":s.CommandNameOpenSapObject,"scope":"single"},"enabled":function(e){var t=i.getJustOneNode(e),o=this.get("command_key"),n=this._getNodeActionForSignature(t,o);if(n){var s=t.actions&&t.actions.findRecursively(o);return s.get("href")?!0:!1}return!1},"execute":function(e,t){var o=i.getJustOneNode(e);return this._navigateTo(o,t)},"openInNewTab":function(){return a.openInNewTab},"_navigateTo":function(e,t){var i=e.actions.findRecursively(this.attributes.signature),o=i.get("href");if(this.openInNewTab()===!0){var s=window.open(o,"_blank");s.focus()}else location.href=o;return n.Deferred().resolve().promise()}});return r}),csui.define("xecmpf/utils/commands/myattachments/add_myattachment",["require","csui/models/command","csui/utils/commandhelper","csui/lib/jquery","csui/lib/underscore","csui/utils/commands/confirmable","i18n!xecmpf/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,a){"use strict";var r,c,l,d,p=t.extend({"defaults":{"signature":"add_business_attachment","command_key":["add_business_attachment"],"name":a.CommandNameAttach,"scope":"multiple","doneVerb":a.CommandDoneVerbAttached,"successMessages":{"formatForNone":a.AttachBusAttsNoneMessage,"formatForOne":a.AttachOneBusAttSuccessMessage,"formatForTwo":a.AttachSomeBusAttsSuccessMessage,"formatForFive":a.AttachManyBusAttsSuccessMessage},"errorMessages":{"formatForNone":a.AttachBusAttsNoneMessage,"formatForOne":a.AttachOneBusAttFailMessage,"formatForTwo":a.AttachSomeBusAttsFailMessage,"formatForFive":a.AttachManyBusAttsFailMessage}},"_getConfirmTemplate":function(e,t){return n.template(a.AttachBusAttsCommandConfirmDialogHtml)},"_getConfirmData":function(e,t){var o=i.getAtLeastOneNode(e);return{"title":a.AttachBusAttsCommandConfirmDialogTitle,"message":1===o.length?n.str.sformat(a.AttachBusAttsCommandConfirmDialogSingleMessage,o.at(0).get("name")):n.str.sformat(a.AttachBusAttsCommandConfirmDialogMultipleMessage,o.length)}},"enabled":function(e){if(e.container.busatts.actions){var t=n.has(e.container.busatts.actions.data,this.defaults.signature);return t?!0:!1}return!1}});return n.extend(p.prototype,s,{"execute":function(e,t){return this._referenceSearchOpen(e,t)},"_referenceSearchOpen":function(e,t){var i=o.Deferred(),n=this;return csui.require(["csui/utils/contexts/factories/connector","i18n!xecmpf/widgets/myattachments/nls/myattachments.lang","xecmpf/widgets/myattachments/metadata.attachment.model","xecmpf/controls/bosearch/bosearch.model","xecmpf/controls/bosearch/bosearch.dialog.controller","csui/utils/command.error"],function(o,s,a,c,l,p){r=a,d=p,n.connector=t.context.getObject(o),n.collection=e.data.collection,n.boSearchModel=new c(e.data.boType,{"connector":n.connector});var u;u=".cs-metadata:has(> .metadata-content-wrapper)",n.boSearchDialogController=new l({"context":t.context,"htmlPlace":u,"multipleSelect":!0,"mode":"business_attachment_add","boSearchModel":n.boSearchModel,"title":s.BOSearchTitle}),n.status=e,n.listenTo(n.boSearchModel,"boresult:select",n._referenceSearchAttach),n.boSearchModel.trigger("reference:search"),i.resolve()},function(e){console.log(e),i.reject(e)}),i.promise()},"_referenceSearchAttach":function(e){var t=o.Deferred(),i=this;return csui.require(["csui/utils/page.leaving.blocker","csui/models/fileuploads","csui/utils/commands/multiple.items","csui/controls/globalmessage/globalmessage","csui/utils/messagehelper","csui/utils/command.error","csui/utils/base"],function(o,s,a,r,p,u,h){c=p,l=r,d=u,h=h;var m;if(i.PageLeavingBlocker=arguments[1],i.boSearchModel.trigger("reference:selected"),e.selectedItems){var f=e.selectedItems,g=n.map(f,function(e){return{"name":e.get("businessObjectId"),"state":"pending","count":0,"total":1,"node":e}}),b=f&&f[0]&&f[0].connector,w=new s(g,{"connector":b}),v=n.defaults({"nodes":w},status);v.suppressMultipleFailMessage=!0,w.each(function(e){var t=e.get("node");e.node=t,e.unset("node")}),i.startGlobalMessage(w),a._performActions.call(i,v,m).done(function(e){l.hideFileUploadProgress(),t.resolve(e)}).fail(function(e){t.reject(e)})}},function(e){console.log(e),t.reject(e)}),t.promise()},"startGlobalMessage":function(e){l.showFileUploadProgress(e,{"oneFileTitle":a.AttachingOneBusAtt,"oneFileSuccess":a.AttachOneBusAttSuccessMessage,"multiFileSuccess":a.AttachManyBusAttsSuccessMessage,"oneFilePending":a.AttachingOneBusAtt,"multiFilePending":a.AttachBusAtts,"oneFileFailure":a.AttachOneBusAttFailMessage,"multiFileFailure":a.AttachManyBusAttsFailMessage2,"someFileSuccess":a.AttachSomeBusAttsSuccessMessage,"someFilePending":a.AttachingSomeBusAtts,"someFileFailure":a.AttachSomeBusAttsFailMessage2,"enableCancel":!1})},"_performAction":function(e,t){var i=e.node,s=o.Deferred(),c=this;if(this.collection){var l=this.boSearchModel.get("ext_system_id"),p=this.boSearchModel.get("bo_type"),u="",h=i.get("businessObjectId"),m={"ext_system_id":l,"bo_type":p,"bo_id":h,"comment":u},f=new r(m,{"collection":this.collection,"connector":this.connector});return f.isLocallyCreated=!0,f.save({"wait":!0,"silent":!0}).done(function(t){c.collection.add(f,{"at":0}),e.set("count",1),e.deferred.resolve(e),s.resolve(i)}).fail(function(t){var o=t?new d(t,i):t;e.deferred.reject(e,o),s.reject(o)}),s.promise()}return s.reject(new d(n.str.sformat(a.CommandFailedSingular,i.get("name"),a.CommandVerbAttach),{"errorDetails":"collection is undefined"}))},"_announceStart":function(e){var t=e.originatingView;t&&t.blockActions&&t.blockActions();var i=this.get("pageLeavingWarning");i&&this.PageLeavingBlocker.enable(i)},"_announceFinish":function(e){this.get("pageLeavingWarning")&&this.PageLeavingBlocker.disable();var t=e.originatingView;t&&t.unblockActions&&t.unblockActions()}}),p}),csui.define("xecmpf/utils/commands/myattachments",["csui/lib/underscore","csui/models/commands","xecmpf/utils/commands/myattachments/detach_myattachment","xecmpf/utils/commands/myattachments/go_to_workspace","xecmpf/utils/commands/myattachments/open_sap_object","xecmpf/utils/commands/myattachments/add_myattachment"],function(e,t,i,o,n,s){"use strict";var a=new t([new i,new o,new n,new s]);return a}),csui.define("xecmpf/widgets/myattachments/metadata.attachments.columns",["csui/lib/backbone"],function(e){var t=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),i=e.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new i(this.map(function(e){return e.attributes}))}}),o=new i([{"key":"bo_id","sequence":10},{"key":"name","sequence":20},{"key":"ext_system_name","sequence":30},{"key":"create_date","sequence":40},{"key":"created_by_name","sequence":50},{"key":"comment","sequence":60}]);return o}),csui.define("css!xecmpf/widgets/myattachments/metadata.attachments",[],function(){}),csui.define("xecmpf/widgets/myattachments/metadata.attachments.toolbaritems",["csui/lib/underscore","i18n!xecmpf/widgets/myattachments/nls/myattachments.lang","csui/controls/toolbar/toolitems.factory","css!xecmpf/widgets/myattachments/metadata.attachments"],function(e,t,i){var o={"addToolbar":new i({"add":[]},{"maxItemsShown":0,"dropDownIcon":"icon icon-toolbarAdd","dropDownText":t.AddBusinessAttachment,"addTrailingDivider":!1}),"otherToolbar":new i({"main":[{"signature":"detach_business_attachment","name":t.DetachBusinessAttachment,"scope":"multiple","verb":"detach_business_attachment"},{"signature":"open_sap_object","name":t.OpenSapObject},{"signature":"go_to_workspace","name":t.GoToWorkspace}]},{"maxItemsShown":5,"dropDownIcon":"icon icon-toolbar-more"}),"inlineActionbar":new i({"other":[{"signature":"detach_business_attachment","name":t.DetachBusinessAttachment,"verb":"detach_business_attachment","icon":"icon icon-toolbar-detach"},{"signature":"open_sap_object","name":t.OpenSapObject,"icon":"icon icon-toolbar-preview"},{"signature":"go_to_workspace","name":t.GoToWorkspace,"icon":"icon icon-toolbar-workspace"}]},{"maxItemsShown":5,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return o}),csui.define("hbs!xecmpf/widgets/myattachments/metadata.attachments",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div class="csui-metadata-myattachments">\r\n  <div id="att-tabletoolbar"></div>\r\n  <div id="att-tableview"></div>\r\n  <div id="att-paginationview"></div>\r\n</div>';
}});return i.registerPartial("xecmpf_widgets_myattachments_metadata.attachments",o),o}),csui.define("xecmpf/widgets/myattachments/metadata.attachments.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/table/table.view","csui/controls/pagination/nodespagination.view","xecmpf/utils/commands/myattachments","csui/models/columns","xecmpf/widgets/myattachments/metadata.nodeattachments.model","xecmpf/widgets/myattachments/metadata.attachment.model","xecmpf/widgets/myattachments/metadata.attachments.columns","xecmpf/widgets/myattachments/metadata.attachments.toolbaritems","hbs!xecmpf/widgets/myattachments/metadata.attachments","csui/controls/toolbar/toolitem.model","csui/controls/globalmessage/globalmessage","csui/controls/toolbar/toolbar.command.controller","csui/utils/url","csui/utils/base","i18n!xecmpf/widgets/myattachments/nls/myattachments.lang","csui/controls/tile/behaviors/perfect.scrolling.behavior","css!xecmpf/widgets/myattachments/metadata.attachments"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x,_){"use strict";var k=e.config();i.defaults(k,{"defaultPageSize":30,"showInlineActionBarOnHover":!y.isTouchBrowser(),"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble","clearFilterOnChange":!0,"resetOrderOnChange":!1,"resetLimitOnChange":!0,"fixedFilterOnChange":!1});var C=o.LayoutView.extend({"className":"metadata-inner-wrapper","template":f,"ui":{"tableView":"#att-tableview","childContainer":"#att-tableview","paginationView":"#att-paginationview"},"regions":{"tableToolbarRegion":"#att-tabletoolbar","tableRegion":"#att-tableview","paginationRegion":"#att-paginationview"},"constructor":function T(e){T.__super__.constructor.call(this,e),this.options.data||(this.options.data={}),i.defaults(this.options.data,{"pageSize":k.defaultPageSize||30}),this.commands=l,this.collection=new p(void 0,{"node":this.options.model,"autoreset":!0,"expand":"user","commands":this.commands,"onlyClientSideDefinedColumns":!0}),this.commandController=new w({"commands":this.commands}),this.listenTo(this.commandController,"after:execute:command",this._toolbarActionTriggered),this.behaviors=i.extend({"PerfectScrolling":{"behaviorClass":_,"contentParent":"> .tab-content","scrollXMarginOffset":30,"scrollYMarginOffset":15}},this.behaviors),this.options.model.busatts=this.collection,this._setToolBar(),this._setTableView(),this._setPagination(),this.setActionBarEvents(),this.collection.fetch(),this.propagateEventsToRegions()},"onRender":function(){this.tableToolbarRegion.show(this.tableToolbarView),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)},"_toolbarActionTriggered":function(e){if(e)switch(e.commandSignature){case"detach_business_attachment":this.collection.fetch()}},"_buildToolbarItems":function(){var e=t.Deferred(),i=v.combine(this.model.urlBase(),"addablebotypes");i=i.replace("/v1","/v2");var o={"type":"GET","url":i},n=this;this.model.connector.makeAjaxCall(o).done(function(t,i,o){var s=[];t&&t.results&&t.results.length>0&&(t.results.forEach(function(e){var t=new g({"signature":"add_business_attachment","name":e.data.properties.bo_type_name,"type":123,"group":"add","commandData":{"boType":e.data.properties,"node_id":n.model.get("id"),"collection":n.collection}});s.push(t)}),s.length>0&&s.sort(function(e,t){var i=e.get("name"),o=t.get("name"),n=y.localeCompareString(i,o,{"usage":"sort"});return n})),m.addToolbar.reset(s),e.resolve.apply(e,arguments)}).fail(function(t,i,o){var n="\r\n",s=[];if("error"!==i&&s.push(i),t.responseText){var a=JSON.parse(t.responseText);a&&a.error&&s.push(a.error)}o&&s.push(o);var r=s.length>0?s.join(n):void 0;b.showMessage("error",x.ErrorLoadingAddItemMenu,r),e.reject.apply(e,arguments)})},"_setToolBar":function(){var e=this;this.options&&this.options.metadataView&&this.options.metadataView.options&&this.options.metadataView.options.metadataNavigationView&&(e=this.options.metadataView.options.metadataNavigationView),this._buildToolbarItems(),this.tableToolbarView=new n({"context":this.options.context,"commands":l,"toolbarItems":m,"collection":this.collection,"originatingView":e,"toolbarCommandController":this.commandController})},"_updateToolItems":function(){this.tableToolbarView&&this.tableToolbarView.updateForSelectedChildren(this.tableView.getSelectedChildren())},"_setTableView":function(){this.options||(this.options={});var e=i.extend({"tableColumns":h,"context":this.options.context,"connector":this.model.connector,"collection":this.collection,"columns":this.collection.columns,"pageSize":this.options.data.pageSize,"columnsWithSearch":["name","bo_id"],"orderBy":"bo_id asc","commands":l,"customLabels":{"zeroRecordsMsg":x.noBusinessAttachmentsAvailable,"emptySearchTable":x.tableColumnSearchNoResult}},this.options);this.tableView=new r(e),this.listenTo(this.tableView,"tableRowSelected",this._updateToolItems),this.listenTo(this.tableView,"tableRowUnselected",this._updateToolItems),this.listenTo(this.collection,"reset",this._updateToolItems),this.listenTo(this.collection,"change",this._updateToolItems),this.listenTo(this.collection,"remove",this._updateToolItems),this.listenTo(this.collection,"add",this._buildToolbarItems),this.listenTo(this.collection,"remove",this._buildToolbarItems)},"_setPagination":function(){return this.paginationView=new c({"collection":this.collection,"pageSize":this.options.data.pageSize}),!0},"setActionBarEvents":function(){k.forceInlineActionBarOnClick?this.listenTo(this.tableView,"row:clicked",function(e){if(this.tableActionBarView){var t=this.tableActionBarView.model.get("id"),i=e.node.get("id");if(t===i)return}this._destroyOldAndCreateNewActionBarWithoutDelay(e)}):k.showInlineActionBarOnHover&&(this.listenTo(this.tableView,"enterTableRow",this._showActionBarWithDelay),this.listenTo(this.tableView,"leaveTableRow",this._actionBarShouldDestroy)),this.listenTo(this.collection,"reset",this._destroyActionBar),this.collection.node&&this.listenTo(this.collection.node,"change:id",this._destroyActionBar)},"_showActionBar":function(e){var t=this.tableView.getSelectedChildren();if(!(t.length>0))if(this.tableActionBarView)this._savedHoverEnterArgs=e;else{this._savedHoverEnterArgs=null,this.tableActionBarView=new s(i.extend({"context":this.options.context,"commands":l,"collection":m.inlineActionbar,"delayedActions":this.collection.delayedActions,"container":this.collection.node,"model":e.node,"originatingView":this},m.inlineActionbar.options,{"inlineActionBarStyle":k.inlineActionBarStyle})),this.tableActionBarView.render(),this.listenToOnce(this.tableActionBarView,"destroy",function(){this.tableActionBarView&&this.stopListening(this.tableActionBarView),this._savedHoverEnterArgs&&this._showActionBarWithDelay(this._savedHoverEnterArgs)},this);var o=this.tableActionBarView.$el,n=this.tableView.getNameCell(e.target);if(n&&1===n.length){var a=n.find(".csui-table-cell-name-appendix");a.append(o),a.addClass("csui-table-cell-name-appendix-full"),this.tableActionBarView.triggerMethod("after:show")}}},"_showActionBarWithDelay":function(e){this._showActionbarTimeout&&clearTimeout(this._showActionbarTimeout);var t=this;this._showActionbarTimeout=setTimeout(function(){t._showActionbarTimeout=null,t.tableView.lockedForOtherContols||t._showActionBar.call(t,e)},200)},"_destroyOldAndCreateNewActionBarWithoutDelay":function(e){this._actionBarShouldDestroy(),this.tableView.lockedForOtherContols||this._showActionBar.call(this,e)},"_actionBarShouldDestroy":function(){this._showActionbarTimeout&&(clearTimeout(this._showActionbarTimeout),this._showActionbarTimeout=null),this._destroyActionBar()},"_destroyActionBar":function(){if(this.tableActionBarView){var e=this.tableActionBarView.$el.parent();e.removeClass("csui-table-cell-name-appendix-full"),this.tableActionBarView.destroy(),this.tableActionBarView=null}}});return i.extend(C.prototype,a),C}),csui.define("xecmpf/widgets/myattachments/metadata.property.panels",["i18n!xecmpf/widgets/myattachments/nls/myattachments.lang","xecmpf/widgets/myattachments/metadata.attachments.view"],function(e,t){return[{"title":e.attachmentsTabTitle,"sequence":40,"contentView":t}]}),csui.define("xecmpf/widgets/dossier/impl/dossier.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","xecmpf/widgets/dossier/impl/dossier.model"],function(e,t,i,o,n,s,a){var r;return r=o.extend({"propertyPrefix":"dossierCollection","constructor":function(s,r){o.prototype.constructor.apply(this,arguments);var c=this.options.dossierCollection||{};if(!(c instanceof i.Collection)){var l=s.getObject(n,r),d=e.config();c=new a(c.models,t.extend({"connector":l},c.options,d.options,{"autofetch":!0},r))}this.property=c},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("hbs!xecmpf/behaviors/scroll.controls/impl/scroll.controls",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){return"glyphicon glyphicon-chevron-left"},"3":function(e,t,i,o){return"glyphicon glyphicon-chevron-right"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return'<div class="cs-scroll-control cs-scroll-control-left">\r\n  <span class="'+(null!=(n=t.unless.call(e,null!=e?e.leftControlIconClass:e,{"name":"unless","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")+"\r\n  cs-scroll-control-icon cs-scroll-control-icon-left "+this.escapeExpression((s=null!=(s=t.leftControlIconClass||(null!=e?e.leftControlIconClass:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"leftControlIconClass","hash":{}}):s))+'"></span>\r\n</div>\r\n<div class="cs-scroll-control cs-scroll-control-right">\r\n  <span class="'+(null!=(n=t.unless.call(e,null!=e?e.rightControlIconClass:e,{"name":"unless","hash":{},"fn":this.program(3,o,0),"inverse":this.noop}))?n:"")+"\r\n  cs-scroll-control-icon cs-scroll-control-icon-right "+this.escapeExpression((s=null!=(s=t.rightControlIconClass||(null!=e?e.rightControlIconClass:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"rightControlIconClass","hash":{}}):s))+'"></span>\r\n</div>\r\n'}});return i.registerPartial("xecmpf_behaviors_scroll.controls_impl_scroll.controls",o),o}),csui.define("css!xecmpf/behaviors/scroll.controls/impl/scroll.controls",[],function(){}),csui.define("xecmpf/behaviors/scroll.controls/scroll.controls.behavior",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!xecmpf/behaviors/scroll.controls/impl/scroll.controls","css!xecmpf/behaviors/scroll.controls/impl/scroll.controls"],function(e,t,i,o,n){"use strict";function s(t,i){var o=i||this.options||{},n=o[t];return e.isFunction(n)?o[t].call(this.view):n}var a;return a=i.Behavior.extend({"defaults":{"contentParent":null,"controlsContainer":null,"scrollableWidth":null,"animateDuration":400},"ui":{"leftControl":".cs-scroll-control-left","rightControl":".cs-scroll-control-right"},"triggers":{"mousedown @ui.leftControl":"scroll:left","mousedown @ui.rightControl":"scroll:right"},"constructor":function(e,t){i.Behavior.prototype.constructor.apply(this,arguments),this.listenTo(t,"render",this._renderControls).listenTo(t,"dom:refresh",this._updateScrollControls).listenTo(t,"update:scroll:controls",this._updateScrollControls).listenTo(t,"scroll:left",this._scrollLeft).listenTo(t,"scroll:right",this._scrollRight).listenTo(t,"before:destroy",this._unbindUpdateControlsEvents)},"_renderControls":function(){var e=s.call(this,"controlsContainer");this._controlsContainer=e?this.view.$(e):this.view.$el;var t=s.call(this,"contentParent");this._contentParent=t?this.view.$(t):this.view.$el,this._bindControlsUpdatingEvents(),this.animateDuration=s.call(this,"animateDuration");var i={"leftControlIconClass":s.call(this,"leftControlIconClass"),"rightControlIconClass":s.call(this,"rightControlIconClass")};this._controlsContainer.append(o(i)),this.view._bindUIElements.call(this)},"_updateScrollControls":function(){if(this._contentParent&&this._contentParent instanceof t){var e=this._contentParent.scrollLeft(),i=this._contentParent.get(0).scrollWidth,o=this._contentParent.width();0===e?this.ui.leftControl.hide(100):this.ui.leftControl.show(100),e===i-o?this.ui.rightControl.hide(100):this.ui.rightControl.show(100)}},"_scrollLeft":function(){if(this._contentParent&&this._contentParent instanceof t){var e=s.call(this,"scrollableWidth")||this._contentParent.innerWidth(),i=this._contentParent.scrollLeft();this._contentParent.trigger("focus").filter(":not(:animated)").animate({"scrollLeft":i-e},this.animateDuration,"swing",t.proxy(function(){this.view.triggerMethod("update:scroll:controls")},this))}},"_scrollRight":function(){if(this._contentParent&&this._contentParent instanceof t){var e=s.call(this,"scrollableWidth")||this._contentParent.innerWidth(),i=this._contentParent.scrollLeft();this._contentParent.trigger("focus").filter(":not(:animated)").animate({"scrollLeft":i+e},this.animateDuration,"swing",t.proxy(function(){this.view.triggerMethod("update:scroll:controls")},this))}},"_bindControlsUpdatingEvents":function(){this._contentParent&&this._contentParent instanceof t&&(this._contentParent.attr("tabindex",1),this._contentParent.on("keydown",t.proxy(function(e){switch(e.which){case 37:this.view.triggerMethod("scroll:left");break;case 39:this.view.triggerMethod("scroll:right")}},this)),t(window).on("resize",t.proxy(function(){this._updateScrollControls()},this)))},"_unbindUpdateControlsEvents":function(){this._contentParent&&this._contentParent instanceof t&&(this._contentParent.off("keydown"),t(window).off("resize"))}})}),csui.define("hbs!xecmpf/utils/document.thumbnail/impl/document.thumbnail",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n,s;return'  <div class="document-thumbnail-caption">\r\n'+(null!=(n=t.unless.call(e,null!=e?e.disableIcon:e,{"name":"unless","hash":{},"fn":this.program(2,o,0),"inverse":this.noop}))?n:"")+'    <span class="document-name" title="'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+"</span>\r\n  </div>\r\n"},"2":function(e,t,i,o){var n;return'      <span class="csui-type-icon '+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" aria-hidden="true"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n,s;return'<div class="document-thumbnail-wrapper">\r\n  <div><a href="#" class="thumbnail_not_loaded thumbnail_empty" title="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'" aria-label="'+this.escapeExpression((s=null!=(s=t.document_name||(null!=e?e.document_name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"document_name","hash":{}}):s))+'"></a></div>\r\n  <button class="wrapper"><img src="" class="img-doc-preview binf-hidden" alt="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'" title="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'" /></button>\r\n</div>\r\n'+(null!=(n=t["if"].call(e,null!=e?e.enableCaption:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("xecmpf_utils_document.thumbnail_impl_document.thumbnail",o),o}),csui.define("xecmpf/utils/document.thumbnail/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/utils/document.thumbnail/impl/nls/root/lang",{"open":"Open","toOpen":"to open "}),csui.define("css!xecmpf/utils/document.thumbnail/impl/document.thumbnail",[],function(){}),csui.define("xecmpf/utils/document.thumbnail/document.thumbnail.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/url","csui/utils/contexts/factories/connector","csui/utils/nodesprites","csui/controls/node-type.icon/node-type.icon.view","csui/behaviors/default.action/default.action.behavior","hbs!xecmpf/utils/document.thumbnail/impl/document.thumbnail","i18n!xecmpf/utils/document.thumbnail/impl/nls/lang","css!xecmpf/utils/document.thumbnail/impl/document.thumbnail"],function(e,t,i,o,n,s,a,r,c,l){var d=i.ItemView.extend({"className":"xecmpf-document-thumbnail","constructor":function(e){if(e||(e={}),e.model||(e.model=e.node),i.ItemView.prototype.constructor.apply(this,arguments),!this.model)throw new Error("node is missing in the constructor options.")},"behaviors":{"DefaultAction":{"behaviorClass":r}},"template":c,"templateHelpers":function(){return{"title":this.options.title||l.open,"document_name":l.toOpen+this.options.model.get("name"),"enableCaption":this.options.enableCaption}},"ui":{"thumbnailNotLoadedEl":".thumbnail_not_loaded","imgEl":".img-doc-preview","iconEl":".csui-type-icon","buttonToHide":".document-thumbnail-wrapper > button"},"events":{"keydown .thumbnail_not_loaded":function(e){if(13===e.keyCode||32===e.keyCode){var i=this.$el.find(document.activeElement);t(i).trigger("click")}},"keydown button.wrapper":function(e){if(13===e.keyCode||32===e.keyCode){var i=this.$el.find(document.activeElement);t(i).trigger("click")}}},"_showThumbnail":function(){this.ui.thumbnailNotLoadedEl.addClass("thumbnail_empty").removeClass("binf-hidden thumbnail_missing"),this.ui.imgEl.addClass("binf-hidden");var e=this;this.model.connector.requestContentAuthToken({"id":e.model.get("id")}).then(function(i){var n;n=o.combine(e.model.connector.connection.url,"/nodes",e.model.get("id"),"/thumbnails/medium/content?token="+encodeURIComponent(i.token)),"function"==typeof t&&e.ui.imgEl instanceof t&&e.ui.thumbnailNotLoadedEl instanceof t&&(e.ui.imgEl.one("error",function(){var t=s.findClassByNode(e.model)||"thumbnail_missing";e.ui.thumbnailNotLoadedEl.removeClass("binf-hidden thumbnail_empty").addClass(t),e.ui.imgEl.addClass("binf-hidden"),e.ui.buttonToHide.addClass("binf-hidden")}),e.ui.imgEl.attr("src",n).one("load",function(t){t.target.clientHeight>=t.target.clientWidth?e.ui.imgEl.addClass("cs-form-img-vertical"):e.ui.imgEl.addClass("cs-form-img-horizontal"),e.ui.thumbnailNotLoadedEl.addClass("binf-hidden"),e.ui.imgEl.removeClass("binf-hidden").addClass("cs-form-img-border")}),e.ui.imgEl.parent().parent().on("click",function(){var t={"model":e.model,"abortDefaultAction":!1};e.triggerMethod("before:defaultAction",t),t.abortDefaultAction===!1&&e.triggerMethod("execute:DefaultAction",e.model),e.triggerMethod("after:defaultAction",t)}))},function(){"function"==typeof t&&e.ui.imgEl instanceof t&&e.ui.thumbnailNotLoadedEl instanceof t&&(e.ui.imgEl.addClass("binf-hidden"),e.ui.thumbnailNotLoadedEl.removeClass("binf-hidden thumbnail_empty").addClass("csui-icon thumbnail_missing"))})},"_renderNodeTypeIconView":function(){this._nodeIconView=new a({"el":this.ui.iconEl,"node":this.model}),this._nodeIconView.render()},"onRender":function(){this._renderNodeTypeIconView(),this._showThumbnail()},"onBeforeDestroy":function(){this._nodeIconView&&this._nodeIconView.destroy()}});return d}),csui.define("hbs!xecmpf/widgets/dossier/impl/documentslistitem/impl/metadata",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<td class="label" title="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'</td>\r\n<td class="value" title="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+"</td>"}});return i.registerPartial("xecmpf_widgets_dossier_impl_documentslistitem_impl_metadata",o),o}),csui.define("xecmpf/widgets/dossier/impl/documentslistitem/impl/metadata.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","hbs!xecmpf/widgets/dossier/impl/documentslistitem/impl/metadata"],function(e,t,i,o,n,s){var a=o.ItemView.extend({"tagName":"tr","constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments)},"template":s,"templateHelpers":function(){var e=this.model.get("value");return{"value":"Date"===this.model.get("type")?n.formatFriendlyDate(e):e}}}),r=o.CollectionView.extend({"tagName":"table","constructor":function(e){o.CollectionView.prototype.constructor.apply(this,arguments)},"childView":a});return r}),csui.define("hbs!xecmpf/widgets/dossier/impl/documentslistitem/impl/documentslistitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'    <div class="document-favorite">\r\n'+(null!=(n=t["if"].call(e,null!=e?e.favorite:e,{"name":"if","hash":{},"fn":this.program(2,o,0),"inverse":this.program(4,o,0)}))?n:"")+"    </div>\r\n"},"2":function(e,t,i,o){var n;return'           <a href="#" class="socialFav selected" title="'+this.escapeExpression((n=null!=(n=t.removeFav||(null!=e?e.removeFav:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"removeFav","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.removeFav||(null!=e?e.removeFav:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"removeFav","hash":{}}):n))+'">\r\n          <span class="icon icon-socialFav"></span>\r\n        </a>\r\n'},"4":function(e,t,i,o){var n;return'        <a href="#" class="socialFav notselected" tabindex="0" title="'+this.escapeExpression((n=null!=(n=t.addFav||(null!=e?e.addFav:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"addFav","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.addFav||(null!=e?e.addFav:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"addFav","hash":{}}):n))+'">\r\n          <span class="icon icon-socialFavOpen"></span>\r\n        </a>\r\n'},"6":function(e,t,i,o){return'    <div class="document-category-attributes"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="xecmpf-document-preview"></div>\r\n\r\n<div class="xecmpf-document-metadata">\r\n'+(null!=(n=t.unless.call(e,null!=e?e.hideFavorite:e,{"name":"unless","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:"")+(null!=(n=t.unless.call(e,null!=e?e.hideMetadata:e,{"name":"unless","hash":{},"fn":this.program(6,o,0),"inverse":this.noop}))?n:"")+"</div>\r\n"}});return i.registerPartial("xecmpf_widgets_dossier_impl_documentslistitem_impl_documentslistitem",o),o}),csui.define("xecmpf/widgets/dossier/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/dossier/impl/nls/root/lang",{"searchPlaceholder":"Search groups.","emptyListText":"No documents.","groupByLabel":"Group by","classificationLabel":"Classification","createDateLabel":"Creation date","documentTypeLabel":"Document type","tilesLabel":"group(s)","documentsLabel":"document(s)","addFav":"Add to favorite","removeFav":"Remove from favorite","selectByClassificationLabel":"Select group by Classification","selectByCreatedateLabel":"Select group by Created Date"}),csui.define("css!xecmpf/widgets/dossier/impl/documentslistitem/impl/documentslistitem",[],function(){}),csui.define("xecmpf/widgets/dossier/impl/documentslistitem/documentslistitem.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","conws/models/favorite.model","xecmpf/utils/document.thumbnail/document.thumbnail.view","xecmpf/widgets/dossier/impl/documentslistitem/impl/metadata.model","xecmpf/widgets/dossier/impl/documentslistitem/impl/metadata.view","hbs!xecmpf/widgets/dossier/impl/documentslistitem/impl/documentslistitem","i18n!xecmpf/widgets/dossier/impl/nls/lang","css!xecmpf/widgets/dossier/impl/documentslistitem/impl/documentslistitem"],function(e,t,i,o,n,s,a,r,c,l){var d;return d=o.ItemView.extend({"tagName":"li","className":"xecmpf-document-list-item","constructor":function(e){e||(e={}),o.ItemView.prototype.constructor.apply(this,arguments),this.favModel=new n({"selected":this.model.get("favorite")},{"connector":this.model.connector,"node":this.model}),this.listenTo(this.favModel,"change:selected",this.render)},"template":c,"templateHelpers":function(){return{"enableIcon":!0,"hideMetadata":this.options.hideMetadata,"hideFavorite":this.options.hideFavorite,"addFav":l.addFav+this.options.model.get("name"),"removeFav":l.removeFav+this.options.model.get("name")}},"ui":{"thumbnailEL":".xecmpf-document-preview","metadataEl":".document-category-attributes"},"triggers":{"click a.socialFav.selected":"remove:favorite","click a.socialFav.notselected":"add:favorite"},"events":{"keydown a.socialFav.selected":function(e){(13===e.keyCode||32===e.keyCode)&&this.triggerMethod("remove:favorite")},"keydown a.socialFav.notselected":function(e){(13===e.keyCode||32===e.keyCode)&&this.triggerMethod("add:favorite")}},"onRemoveFavorite":function(e){this.favModel.remove(),this.model.set("favorite",!1),this.render()},"onAddFavorite":function(e){this.favModel.add(),this.model.set("favorite",!0),this.render()},"_renderMetadata":function(){var e=this.model.get("metadata_categories");if(!t.isEmpty(e)){var i=new a(void 0,{"data":e,"hideEmptyFields":this.options.hideEmptyFields,"catsAndAttrs":this.options.catsAndAttrs});this._metadataView=new r({"collection":i}),this.ui.metadataEl.html(this._metadataView.render().el)}},"_renderThumbnail":function(){this._documentThumbnailView=new s({"model":this.model,"enableCaption":!0}),this.ui.thumbnailEL.html(this._documentThumbnailView.render().el)},"onRender":function(){this._renderThumbnail(),this.options.hideMetadata!==!0&&this._renderMetadata()},"onBeforeDestroy":function(){this._documentThumbnailView.destroy(),this._metadataView&&this._metadataView.destroy()}})}),csui.define("hbs!xecmpf/widgets/dossier/impl/documentslist/impl/documentslist",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<ul class="xecmpf-document-list-group"></ul>'}});return i.registerPartial("xecmpf_widgets_dossier_impl_documentslist_impl_documentslist",o),o}),csui.define("css!xecmpf/widgets/dossier/impl/documentslist/impl/documentslist",[],function(){}),csui.define("xecmpf/widgets/dossier/impl/documentslist/documentslist.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/tile/behaviors/blocking.behavior","csui/controls/tile/tile.view","csui/controls/list/emptylist.view","xecmpf/widgets/dossier/impl/documentslist/impl/documents.model","xecmpf/widgets/dossier/impl/documentslistitem/documentslistitem.view","i18n!xecmpf/widgets/dossier/impl/nls/lang","hbs!xecmpf/widgets/dossier/impl/documentslist/impl/documentslist","css!xecmpf/widgets/dossier/impl/documentslist/impl/documentslist"],function(e,t,i,o,n,s,a,r,c,l,d,p,u){var h,m;return h=o.CompositeView.extend({"className":"list-group-container","constructor":function(e){e||(e={}),o.CompositeView.prototype.constructor.apply(this,arguments)},"template":u,"behaviors":{"PerfectScrolling":{"behaviorClass":s,"suppressScrollX":!0,"scrollYMarginOffset":15},"InfiniteScrolling":{"behaviorClass":n,"content":">ul.xecmpf-document-list-group","fetchMoreItemsThreshold":80}},"childViewContainer":">ul.xecmpf-document-list-group","childView":d,"childViewOptions":function(){return{"context":this.options.context,"workspaceContext":this.options.workspaceContext,"nodeModel":this.options.nodeModel,"hideMetadata":this.options.hideMetadata,"hideEmptyFields":this.options.hideEmptyFields,"hideFavorite":this.options.hideFavorite,"catsAndAttrs":this.options.catsAndAttrs}},"emptyView":c,"emptyViewOptions":{"text":p.emptyListText||"No documents."},"onRender":function(){this.$el.one("mouseenter",e.proxy(function(){this.triggerMethod("dom:refresh")},this))}}),m=r.extend({"className":function(){var e="xecmpf-documents-tile",i=t.result(r.prototype,"className");return i&&(e+=" "+i),e},"_focusedChild":void 0,"_activeChild":void 0,"constructor":function(e){e||(e={}),r.prototype.constructor.apply(this,arguments),this.childrens=h},"templateHelpers":function(){var e=this.model&&this.model.get("name");return{"title":e,"icon":!1}},"behaviors":{"Blocking":{"behaviorClass":a}},"_accSelector":".thumbnail_not_loaded","currentlyFocusedElement":function(){return this.$(this._accSelector)},"getActiveChild":function(){return this._activeChild},"toggleFocus":function(e){this.ui.listItem.prop("tabindex",e===!0?"0":"-1"),e&&this.ui.listItem.trigger("focus")},"contentView":h,"contentViewOptions":function(){var e=t.extend(this.options.model&&this.options.model.get("query_params"),{"metadata_categories":this.options.metadata_categories}),i=this.options.model&&this.options.model.get("documents"),o=this.options.model&&this.options.model.get("paging"),n=new l(i,{"nodeModel":this.options.nodeModel,"query":e,"paging":o});return this.listenTo(n,"request",this.blockActions).listenTo(n,"sync",this.unblockActions).listenTo(n,"error",this.unblockActions),{"collection":n,"context":this.options.context,"workspaceContext":this.options.workspaceContext,"nodeModel":this.options.nodeModel,"hideMetadata":this.options.hideMetadata,"hideEmptyFields":this.options.hideEmptyFields,"hideFavorite":this.options.hideFavorite,"catsAndAttrs":this.options.catsAndAttrs}},"_renderTileProperties":function(){var t,i,o=this.model&&this.model.get("paging").total_count||"0";this.$docsCountEl=e("<span></span>").addClass("count docs-count").text(o),i=e("<span></span>").addClass("count-label").text(p.documentsLabel||"document(s)"),t=e("<div></div>").addClass("tile-properties").append(this.$docsCountEl).append(i),this.$(">.tile-header").append(t)},"onRender":function(){this._renderTileProperties()},"onBeforeShow":function(){this.listenTo(this.contentView,"execute:defaultAction",function(e){this.triggerMethod("execute:defaultAction",e)})}})}),csui.define("hbs!xecmpf/controls/dropdown/impl/dropdownitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<a href="#" tabindex="-1">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</a>"}});return i.registerPartial("xecmpf_controls_dropdown_impl_dropdownitem",o),o}),csui.define("xecmpf/controls/dropdown/dropdownitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!xecmpf/controls/dropdown/impl/dropdownitem"],function(e,t,i,o,n){var s;return s=o.ItemView.extend({"className":"dropdown-menu-item","tagName":"li","constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments)},"template":n,"triggers":{"click":"click:item"},"modelEvents":{"change":"render"}})}),csui.define("hbs!xecmpf/controls/dropdown/impl/dropdown",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<a class="binf-dropdown-toggle csui-acc-focusable" role="button"\r\n        data-binf-toggle="dropdown" aria-expanded="false" tabindex="-1">\r\n  <span class="dropdown-label">'+this.escapeExpression((n=null!=(n=t.dropdownLabel||(null!=e?e.dropdownLabel:e))?n:t.helperMissing,
"function"==typeof n?n.call(e,{"name":"dropdownLabel","hash":{}}):n))+'</span>\r\n  <span class="csui-button-icon icon-expandArrowDown"></span>\r\n</a>\r\n<ul class="binf-dropdown-menu" role="menu"></ul>\r\n'}});return i.registerPartial("xecmpf_controls_dropdown_impl_dropdown",o),o}),csui.define("css!xecmpf/controls/dropdown/impl/dropdown",[],function(){}),csui.define("xecmpf/controls/dropdown/dropdown.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/binf/js/binf","xecmpf/controls/dropdown/dropdownitem.view","hbs!xecmpf/controls/dropdown/impl/dropdown","css!xecmpf/controls/dropdown/impl/dropdown"],function(e,t,i,o,n,s,a,r){var c;return c=o.CompositeView.extend({"className":"xecmpf-dropdown binf-dropdown","constructor":function(e){e||(e={}),o.CompositeView.prototype.constructor.apply(this,arguments),this.label=this.options.label},"template":a,"templateHelpers":function(){return{"dropdownLabel":this.label||"Dropdown"}},"ui":{"control":".binf-dropdown-toggle","label":".dropdown-label"},"childView":s,"childViewContainer":"ul.binf-dropdown-menu","childEvents":{"render":"onRenderChild","click:item":"onClickItem"},"onRenderChild":function(e){var t=e.model;t.get("active")===!0&&(e.$el.addClass("binf-active").siblings().removeClass("binf-active"),this.currModel=t),t.get("hide")===!0&&e.$el.addClass("binf-hidden")},"onClickItem":function(e){if(!e.$el.hasClass("binf-active")){var t=e.model,i={"currModel":this.currModel,"newModel":t};this.triggerMethod("change:dropdown:item",i),i.change!==!1&&(e.$el.addClass("binf-active").siblings().removeClass("binf-active"),this.currModel=t),this.hideDropdownMenu()}},"showDropdownMenu":function(){this.$el.addClass("binf-open"),this.ui.control.attr("aria-expanded",!0)},"hideDropdownMenu":function(){this.$el.removeClass("binf-open"),this.ui.control.attr("aria-expanded",!1)},"updateLabel":function(e){e&&"string"==typeof e&&this.ui.label.text(e)},"setModelActive":function(e){e instanceof i.Model&&(e.unset("active",{"silent":!0}),e.set("active",!0))},"setModelHide":function(e){e instanceof i.Model&&(e.unset("hide",{"silent":!0}),e.set("hide",!0))},"onRender":function(){this.ui.control.binf_dropdown()}})}),csui.define("xecmpf/widgets/dossier/impl/dropdown.items",["module","csui/lib/backbone","i18n!xecmpf/widgets/dossier/impl/nls/lang"],function(e,t,i){var o,n,s,a=e.config();return o=t.Model.extend({"idAttribute":"value","defaults":{"value":null,"name":null,"sequence":0}}),n=t.Collection.extend({"model":o,"comparator":"sequence","getItemValues":function(){return this.pluck("value")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))}}),s=new n([{"value":"classification","name":a.groupByDocumentType?i.documentTypeLabel:i.classificationLabel,"sequence":10},{"value":"create_date","name":i.createDateLabel,"sequence":20}])}),csui.define("css!xecmpf/widgets/dossier/impl/dossier",[],function(){}),csui.define("xecmpf/widgets/dossier/dossier.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/node","conws/models/workspacecontext/workspacecontext.factory","xecmpf/widgets/dossier/impl/dossier.factory","csui/controls/tile/behaviors/blocking.behavior","csui/behaviors/limiting/limiting.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","xecmpf/behaviors/scroll.controls/scroll.controls.behavior","csui/controls/list/behaviors/list.view.keyboard.behavior","csui/dialogs/modal.alert/modal.alert","csui/controls/list/list.view","xecmpf/widgets/dossier/impl/documentslist/documentslist.view","xecmpf/controls/dropdown/dropdown.view","xecmpf/widgets/dossier/impl/dropdown.items","i18n!xecmpf/widgets/dossier/impl/nls/lang","css!xecmpf/widgets/dossier/impl/dossier"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b){var w;return w=h.extend({"id":"xecmpf-dossier","constructor":function(t){if(t||(t={}),t=t.data?e.extend(t,t.data):t,!t.workspaceContext){if(!t.context)throw new Error("Context is missing in the constructor options!");t.workspaceContext=t.context.getObject(s)}t.workspaceContext.setWorkspaceSpecific(a),h.prototype.constructor.apply(this,arguments),this.listenTo(this.completeCollection,"request",this.blockActions).listenTo(this.completeCollection,"error",this.unblockActions).listenTo(this.completeCollection,"sync",this.onCompleteCollectionSync),this.synced=!1},"templateHelpers":function(){return{"icon":void 0,"title":void 0,"searchPlaceholder":b.searchPlaceholder}},"events":{'focus span[title="Search"]':function(){var e=this.$el.find(".xecmpf-dropdown");e.removeClass("binf-open")},"keydown .clearer":function(){var e=this.$(".search");e.val(""),e.trigger("focus"),this.filterChanged()},"keydown li.dropdown-menu-item":function(){if(13===event.keyCode||32===event.keyCode){t(".dropdown-menu-item").trigger("click");var e=this.$el.find(".xecmpf-dropdown");e.removeClass("binf-open")}},"keydown .dossier-dropdown":"getDossierViewFilter",'keydown .tile-header span[title="Search"]':function(e){(13===e.keyCode||32===e.keyCode)&&t('.tile-header span[title="Search"]').trigger("click")},'keydown .tile-header input[class="search"]':function(e){27===e.keyCode&&(t('.tile-header span[title="Hide"]').trigger("click"),t('.tile-header span[title="Hide"]').trigger("focus"))}},"behaviors":{"LimitedList":{"behaviorClass":c,"limit":void 0,"completeCollection":function(){return this.nodeModel=this.options.workspaceContext.getObject(n),this.groupBy=this.options.groupBy,function(e,t){if(e||(e=[]),t.metadata_categories="",t.catsAndAttrs=[],e.length>0){var i="",o=[];e.forEach(function(e){e.attributeId?(i+=e.categoryId+",",o.push(e.categoryId+"_"+e.attributeId)):e.categoryId&&(i+=e.categoryId+",",o.push(e.categoryId))}),t.metadata_categories=i.substr(0,i.length-1),t.catsAndAttrs=o}}(this.options.metadata,this),this.options.workspaceContext.getCollection(a,{"options":{"nodeModel":this.nodeModel,"query":{"group_by":this.groupBy,"metadata_categories":this.metadata_categories}}})}},"PerfectScrolling":{"behaviorClass":l,"scrollingDisabled":!0},"ScrollControls":{"behaviorClass":d,"controlsContainer":">.tile-content","contentParent":">.tile-content>.binf-list-group","animateDuration":500,"scrollableWidth":function(){var e=this.$(">.tile-content").innerWidth(),t=this.$(">.tile-content>.binf-list-group>.tile").outerWidth(!0),i=Math.floor(e/t),o=i*t||t;return o},"leftControlIconClass":"caret-left","rightControlIconClass":"caret-right"},"Blocking":{"behaviorClass":r}},"getDossierViewFilter":function(e){switch(e.keyCode){case 13:case 32:var t=this.$el.find(".xecmpf-dropdown");t.hasClass("binf-open")?t.removeClass("binf-open"):t.addClass("binf-open")}},"childView":m,"childViewOptions":function(){return{"context":this.options.context,"workspaceContext":this.options.workspaceContext,"nodeModel":this.nodeModel,"hideMetadata":this.options.hideMetadata,"hideEmptyFields":this.options.hideEmptyFields,"metadata_categories":this.metadata_categories,"hideFavorite":this.options.hideFavorite,"catsAndAttrs":this.catsAndAttrs}},"onRenderTemplate":function(){this.options.hideGroupByCriterionDropdown!==!0&&this._renderGroupByDropdownView(),this._renderDossierProperties()},"onRenderCollection":function(){this.triggerMethod("update:scroll:controls")},"onCompleteCollectionSync":function(){this.synced=!0,this._updateDossierProperties(),this.unblockActions()},"isEmpty":function(){return this.synced===!0&&0===this.collection.models.length},"emptyViewOptions":{"text":b.emptyListText||"No documents."},"_renderGroupByDropdownView":function(){var e=t("<div></div>").addClass("dossier-dropdown-wrapper"),i=t("<span></span>").addClass("dossier-dropdown-label").text(b.groupByLabel),n=t("<div></div>").addClass("dossier-dropdown");e.append(i).append(n),this.$(">.tile-header>.tile-controls").prepend(e);var s=new o.Region({"el":n});this.groupBydropdownView=new f({"label":this._getGroupByDropdownLabel(g),"collection":g}),this.listenTo(this.groupBydropdownView,"change:dropdown:item",function(e){var t=e.newModel.get("value"),i=this;this.synced=!1,this.completeCollection.fetch({"query":{"group_by":t,"metadata_categories":this.metadata_categories}}).done(function(o,n,s){i.groupBy=t,i.groupBydropdownView.updateLabel(i._getGroupByDropdownLabel(e.newModel));var a=i.$(">.tile-content>.binf-list-group");a.scrollLeft(0),i.triggerMethod("update:scroll:controls"),i._setGroupByDropdownModelActive(i.groupBydropdownView.collection)}).fail(function(t,o,n){var s=t.responseJSON?t.responseJSON.error:"Internal Server Error!";u.showError(s).always(function(){i._setGroupByDropdownModelActive(e.currModel)})})}),s.show(this.groupBydropdownView),this._setGroupByDropdownModelActive(g)},"_getGroupByDropdownLabel":function(e){var t,o=" ";return e instanceof i.Model?t=e:e instanceof i.Collection&&(t=this._getGroupByDropdownActiveModel(e)),t&&(o+=t.get("name")),o},"_getGroupByDropdownActiveModel":function(e){return e instanceof i.Collection?e.find(t.proxy(function(e){return e.get("value")===this.groupBy},this)):void 0},"_setGroupByDropdownModelActive":function(e){var t;e instanceof i.Model?t=e:e instanceof i.Collection&&(t=this._getGroupByDropdownActiveModel(e)),t&&this.groupBydropdownView.setModelActive(t)},"_renderDossierProperties":function(){var e,i,o,n=this.completeCollection.length||"0",s=this.completeCollection.total_documents||"0";this.$tilesCountEl=t("<span></span>").addClass("count tiles-count").text(n),i=t("<span></span>").addClass("count-label").text(b.tilesLabel||"group(s)"),this.$docsCountEl=t("<span></span>").addClass("count docs-count").text(s),o=t("<span></span>").addClass("count-label").text(b.documentsLabel||"document(s)"),e=t("<div></div>").addClass("dossier-properties").append(this.$tilesCountEl).append(i).append(this.$docsCountEl).append(o);var a=this.$(".dossier-dropdown .csui-acc-focusable").get(0);a.setAttribute("tabindex","0");var r,c=this.groupBy;r="create_date"===c?b.selectByClassificationLabel:b.selectByCreatedateLabel,a.setAttribute("aria-label",r),this.$(">.tile-header>.tile-title").remove(),this.$(">.tile-header").prepend(e);var l=this.$('>.tile-header span[title="Search"]');t(l).addClass("csui-acc-focusable"),t(l).attr("tabindex","0")},"_updateDossierProperties":function(){var t=e.filter(this.completeCollection.models,function(e){return e.attributes.documents}),i=t.length,o=this.completeCollection.total_documents;this.$tilesCountEl.text(i),this.$docsCountEl.text(o)}})}),csui.define("xecmpf/models/eac/eventactionplans.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/node","xecmpf/models/eac/eventactionplans.model"],function(e,t,i,o,n,s){var a=o.extend({"propertyPrefix":"EACEventActionPlans","constructor":function(a,r){o.prototype.constructor.apply(this,arguments);var c=this.options.EACEventActionPlans||{};if(!(c instanceof i.Collection)){var l=a.getModel(n,r),d=e.config();c=new s(c.models,t.extend({"node":l,"connector":l.connector,"extSysTypes":r.extSysTypes},c.options,d.options,{"autofetch":!0}))}this.property=c},"fetch":function(e){return this.property.fetch(e)}});return a}),csui.define("xecmpf/models/eac/nodefacets.model",["csui/lib/underscore","csui/utils/url","csui/models/facets","csui/models/mixins/node.resource/node.resource.mixin","csui/models/node.facets/server.adaptor.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,o,n){"use strict";var s=i.extend({"constructor":function(e,t){i.prototype.constructor.apply(this,arguments),this.makeNodeResource(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.models,{"node":this.node,"filters":e.deepClone(this.filters)})}});return o.mixin(s.prototype),n.mixin(s.prototype),s.prototype.url=function(){var e=(this.node.get("id"),this.getFilterQuery(this.filters)),i=t.combine(this.connector.connection.url,"eventactioncenter","/facets").replace("/v1","/v2");return e&&(i+="?"+e),i},s}),csui.define("xecmpf/models/eac/node.facet.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/node","xecmpf/models/eac/nodefacets.model"],function(e,t,i,o,n,s){var a=o.extend({"propertyPrefix":"eacfacets","constructor":function(a,r){o.prototype.constructor.apply(this,arguments);var c=this.options.eacfacets||{};if(!(c instanceof i.Collection)){var l=c.options&&c.options.node||a.getModel(n,r),d=e.config();c=new s(c.models,t.defaults(d.options,c.options,{"autoreset":!0},{"node":l}))}this.property=c},"fetch":function(e){return this.property.fetch(e)}});return a}),csui.define("xecmpf/widgets/eac/impl/eac.table.columns",["csui/lib/underscore","csui/lib/backbone","i18n!xecmpf/widgets/eac/impl/nls/lang"],function(e,t,i){"use strict";var o=t.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=t.Collection.extend({"model":o,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))},"resetCollection":function(i,n){if(i){var s=0,a=e.map(i,function(i){var n=i instanceof t.Model?i.toJSON():i;return s+=10,new o(e.defaults(n,{"key":n.column_key,"sequence":s}))});this.reset(a,n)}}}),s=new n([{"key":"event_name","title":i.columnEventName,"sequence":10,"permanentColumn":!0},{"key":"namespace","title":i.columnSystemName,"sequence":20,"permanentColumn":!0},{"key":"action_plan","title":i.columnActionPlan,"sequence":30,"permanentColumn":!0}]);return s}),csui.define("css!xecmpf/widgets/eac/impl/eac",[],function(){}),csui.define("xecmpf/widgets/eac/impl/toolbaritems",["csui/controls/toolbar/toolitems.factory","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/eac"],function(e,t){var i={"leftToolbar":{"OtherToolbar":new e({"main":[{"signature":"EACBack","name":t.ToolbarItemBack,"toolItemAria":t.ToolbarItemBackAria,"icon":"icon icon-arrowBack"},{"signature":"Filter","name":t.ToolbarItemFilter,"icon":"icon icon-toolbarFilter","toolItemAria":t.ToolbarItemFilterAria,"toolItemAriaExpand":!1}]})},"rightToolbar":{"OtherToolbar":new e({"main":[{"signature":"EACRefresh","name":t.ToolbarItemRefresh,"icon":"icon icon-refresh","toolItemAria":t.ToolbarItemRefreshAria,"commandData":{"useContainer":!0}}]})}};return i}),csui.define("hbs!xecmpf/widgets/eac/impl/eac",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div id="xecmpf-eac-toolbar"></div>\r\n<div id="xecmpf-eac-facet-table-container">\r\n  <div id="xecmpf-eac-facet" class="csui-table-facetview csui-facetview-hidden csui-facetview-visibility"></div>\r\n  <div class="csui-outertablecontainer">\r\n    <div id="xecmpf-eac-table-container">\r\n      <div id="xecmpf-eac-facet-bar"></div>\r\n      <div id="xecmpf-eac-table-contents"></div>\r\n      <div id="xecmpf-eac-pagination"></div>\r\n    </div>\r\n  </div>\r\n</div>'}});return i.registerPartial("xecmpf_widgets_eac_impl_eac",o),o}),csui.define("xecmpf/widgets/eac/eac.view",["require","module","csui/lib/underscore","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/controls/progressblocker/blocker","csui/controls/table/table.view","xecmpf/models/eac/eventactionplans.factory","xecmpf/models/eac/node.facet.factory","csui/controls/facet.bar/facet.bar.view","xecmpf/controls/dialogheader/dialogheader.view","xecmpf/controls/title/title.view","xecmpf/widgets/eac/impl/eac.table.columns","xecmpf/controls/headertoolbar/headertoolbar.view","xecmpf/widgets/eac/impl/toolbaritems","csui/utils/commands","csui/controls/facet.panel/facet.panel.view","csui/utils/contexts/factories/node","xecmpf/models/eac/eventactionplans.model","csui/controls/toolbar/toolbar.command.controller","hbs!xecmpf/widgets/eac/impl/eac","i18n!xecmpf/widgets/eac/impl/nls/lang","css!xecmpf/widgets/eac/impl/eac"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m,f,g,b,w,v,y,x,_){function k(e){return e.$el.is(":visible")?void e.success():(e.count||(e.count="noLimit"),e.interval||(e.interval=200),void setTimeout(function(){0===e.count?void 0!==e.error&&e.error():("number"==typeof e.count&&e.count--,k(e))},e.interval))}var C=t.config();i.defaults(C,{"defaultPageSize":30});var T=o.LayoutView.extend({"className":"xecmpf-eac csui-nodestable","template":x,"ui":{"facetView":".csui-table-facetview"},"regions":{"toolbarRegion":"#xecmpf-eac-toolbar","facetRegion":"#xecmpf-eac-facet","facetBarRegion":"#xecmpf-eac-facet-bar","tableRegion":"#xecmpf-eac-table-contents","paginationRegion":"#xecmpf-eac-pagination"},"events":{'click li[data-csui-command="eacback"]':function(e){history.state&&history.back()}},"constructor":function(e){if(e||(e={}),e=e.data?i.extend(e,e.data):e,i.defaults(e,{"pageSize":C.defaultPageSize}),!e.context)throw new Error("Context is missing in the constructor options");a.imbue(this),o.LayoutView.prototype.constructor.apply(this,arguments),this.connector=e.connector||e.context.getObject(n)},"initialize":function(e){this.node=e.context.getModel(s,e),this.collection=e.context.getCollection(c,e),this.commands=e.commands||g,this.commandController=new y({"commands":this.commands}),this.listenTo(this.commandController,"after:execute:command",this._toolbarActionTriggered),this.setHeaderView(),this.setFacetView(),this.setFacetBarView(),this.setTableView()},"setFacetView":function(){this.facetFilters=this.options.facetFilters||this.options.context.getCollection(l,{"options":{"node":this.node},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0,"detached":!0}),this.listenToOnce(this.options.context,"request",function(){this.facetFilters.fetch()}),this.facetView=new b({"collection":this.facetFilters,"blockingLocal":!0}),this.listenTo(this.facetView,{"remove:filter":this._removeFacetFilter,"remove:all":this._removeAll,"apply:filter":this._addToFacetFilter,"apply:all":this._setFacetFilter})},"setFacetBarView":function(){this.facetBarView=new d({"collection":this.facetFilters,"context":this.options.context,"showSaveFilter":!1}),this.listenTo(this.facetBarView,"remove:filter",this._removeFacetFilter).listenTo(this.facetBarView,"remove:all",this._removeAll).listenTo(this.facetBarView,"facet:bar:visible",this._handleFacetBarVisible).listenTo(this.facetBarView,"facet:bar:hidden",this._handleFacetBarHidden)},"setHeaderView":function(){var e=new m({"commands":g,"originatingView":this,"context":this.options.context,"collection":this.collection,"toolbarItems":f.leftToolbar,"container":this.node,"commandController":this.commandController}),t=new u({"title":_.dialogTitle}),i=new m({"commands":g,"originatingView":this,"context":this.options.context,"collection":this.collection,"toolbarItems":f.rightToolbar,"container":this.node,"commandController":this.commandController});this.headerView=new p({"leftView":e,"centerView":t,"hideDialogClose":!0,"rightView":i})},"setTableView":function(){this.tableView=new r({"context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.collection.columns,"tableColumns":h.clone(),"pageSize":this.options.pageSize,"originatingView":this,"columnsWithSearch":["event_name"],"orderBy":this.options.data.orderBy||this.options.orderBy||this.collection.orderBy||"event_name asc","blockingParentView":this,"parentView":this,"selectColumn":!1,"selectRows":"none","tableTexts":{"zeroRecords":_.emptyTableText||"No results found"},"haveToggleAllDetailsRows":!1,"haveDetailsRowExpandCollapseColumn":!1})},"onRender":function(){if(!history.state){var e=this.$el.find('li[data-csui-command="eacback"]');e.css({"display":"none"})}this.listenTo(this.collection,"sync",function(){this.setTableView(),this.showChildView("tableRegion",this.tableView),this.showChildView("toolbarRegion",this.headerView),this.showChildView("facetRegion",this.facetView),this.showChildView("facetBarRegion",this.facetBarView);var e=this;k({"$el":e.tableView.$el,"success":function(){e.tableView.triggerMethod("dom:refresh")}})})},"_handleFacetBarVisible":function(){this.facetBarView.$el.find("#xecmpf-eac-facet-bar .csui-facet-list-bar .csui-facet-item:last a").trigger("focus")},"_handleFacetBarHidden":function(){},"_setFacetPanelView":function(){this.facetView=new b({"collection":this.facetFilters,"blockingLocal":!0}),this.listenTo(this.facetView,{"remove:filter":this._removeFacetFilter,"remove:all":this._removeAll,"apply:filter":this._addToFacetFilter,"apply:all":this._setFacetFilter})},"_filterArray":function(e){return e.reduce(function(e,t){var i=t.split(":");return e[i[0]]=i[1].split("|"),e},{})},"_addToFacetFilter":function(e){this.facetFilters.addFilter(e);var t=this.facetFilters.getFilterQueryValue();this.collection.setFilter(this._filterArray(t))},"_setFacetFilter":function(e){this.facetFilters.setFilter(e);var t=this.facetFilters.getFilterQueryValue();this.collection.setFilter(this._filterArray(t))},"_removeFacetFilter":function(e){this.facetFilters.removeFilter(e);var t=this.facetFilters.getFilterQueryValue();0===t.length?this._removeAll():this.collection.setFilter(this._filterArray(t))},"_removeAll":function(){this.facetFilters.clearFilter(),this.collection.reset(this.collection.allModels)},"_toolbarActionTriggered":function(e){switch(e.commandSignature){case"EACBack":break;case"Filter":this._completeFilterCommand();break;case"EACRefresh":}},"_transitionEnd":i.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if("undefined"!=typeof i.style[e])return t[e]}),"_completeFilterCommand":function(){var e=this;this.showFilter=!this.showFilter,this.showFilter?(this._ensureFacetPanelViewDisplayed(),this.ui.facetView.removeClass("csui-facetview-visibility"),this.ui.facetView.one(this._transitionEnd(),function(){e.tableView.triggerMethod("dom:refresh")}).removeClass("csui-facetview-hidden")):this.ui.facetView.one(this._transitionEnd(),function(){e.tableView.triggerMethod("dom:refresh"),e.ui.facetView.hasClass("csui-facetview-hidden")&&e.ui.facetView.addClass("csui-facetview-visibility"),e._removeFacetPanelView()}).addClass("csui-facetview-hidden")},"_ensureFacetPanelViewDisplayed":function(){void 0===this.facetView&&(this._setFacetPanelView(),this.facetRegion.show(this.facetView))},"_removeFacetPanelView":function(){this.facetRegion.empty(),this.facetView=void 0}});return T}),csui.define("xecmpf/widgets/header/impl/previewpane/impl/previewpane.list.keyboard.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/lib/marionette"],function(e,t,i,o,n){"use strict";var s={"none":-1,"list":1},a=n.Behavior.extend({"constructor":function(e,i){n.Behavior.prototype.constructor.apply(this,arguments),i.keyboardBehavior=this,this.tabableElements=[];var o=this;this.listenTo(i,"show",function(){o.refreshTabableElements(i)}),this.listenTo(i,"click:item",function(e){var t=i.selectedIndex,o=i.selectedIndexElem(t);o&&o.prop("tabindex","-1"),i.currentTabPosition=s.list,i.selectedIndex=i.collection.indexOf(e.model)}),t.extend(i,{"_focusList":function(){return(this.selectedIndex<0||void 0===this.selectedIndex)&&(this.selectedIndex=this.getSelectedIndex()),this.currentTabPosition=s.list,this.getSelectedItem().$el},"_setFocus":function(){return this._focusList()},"_listIsInFocus":function(){var e,t=!1;for(e=0;e<this.collection.length;e++){var i=this.selectedIndexElem(e);if(i&&i.is(":focus")){t=!0;break}}return t},"_checkFocusAndSetCurrentTabPosition":function(){this._listIsInFocus()?this.currentTabPosition=s.list:this.currentTabPosition=s.none},"_setFirstAndLastFocusable":function(){this.getSelectedItem()&&this.getSelectedItem().$el.prop("tabindex","0")},"currentlyFocusedElement":function(e){return this._checkFocusAndSetCurrentTabPosition(),this._setFirstAndLastFocusable(),e&&e.shiftKey?this._focusList():this.currentTabPosition===s.list?this._focusList():this._setFocus()},"_resetFocusedListElem":function(){var e,t;e=this.selectedIndex,t=this.selectedIndexElem(e),t&&t.prop("tabindex","-1"),e=this.getSelectedIndex(),t=this.selectedIndexElem(e),t&&(t.prop("tabindex","0"),this.selectedIndex=e)},"_moveTo":function(e,i,o){e.preventDefault(),e.stopPropagation(),setTimeout(t.bind(function(){o&&o.prop("tabindex","-1"),i.prop("tabindex","0"),i.trigger("focus")},this),50)},"onKeyInView":function(e){if(this._checkFocusAndSetCurrentTabPosition(),9===e.keyCode)e.shiftKey&&setTimeout(t.bind(function(){this._resetFocusedListElem()},this),50);else if(32===e.keyCode||13===e.keyCode)this.currentTabPosition===s.list&&(e.preventDefault(),e.stopPropagation(),this.selectAt(this.selectedIndex));else if(27===e.keyCode&&this.previewPane){this.previewPane.hide();var i=this.previewPane.parent.$el.find("button");i&&i.trigger("focus")}},"onKeyDown":function(e){if(this.config.debug===!0&&console.log("preview-behavior: onKeydown - keyCode:"+e.which),this._checkFocusAndSetCurrentTabPosition(),this.currentTabPosition!==s.list)return void this.onKeyInView(e);var t=this.selectedIndex;(0>t||void 0===t)&&(t=this.getSelectedIndex());var i=this.selectedIndexElem(t);switch(e.which){case 33:this._moveTo(e,this._selectFirst(),i);break;case 34:this._moveTo(e,this._selectLast(),i);break;case 38:this._moveTo(e,this._selectPrevious(),i);break;case 40:this._moveTo(e,this._selectNext(),i);break;default:return void this.onKeyInView(e)}},"_selectFirst":function(){return this.selectedIndex=0,this.selectedIndexElem(this.selectedIndex)},"_selectLast":function(){return this.selectedIndex=this.collection.length-1,this.selectedIndexElem(this.selectedIndex)},"_selectNext":function(){return(this.selectedIndex<0||void 0===this.selectedIndex)&&(this.selectedIndex=this.getSelectedIndex()),this.selectedIndex<this.collection.length-1&&this.selectedIndex++,this.selectedIndexElem(this.selectedIndex)},"_selectPrevious":function(){return(this.selectedIndex<0||void 0===this.selectedIndex)&&(this.selectedIndex=this.getSelectedIndex()),this.selectedIndex>0&&this.selectedIndex--,this.selectedIndexElem(this.selectedIndex)},"selectAt":function(e){if(!(e>=this.collection.length||0>e)){var t=this.selectedIndexElem(e);t&&t.trigger("click")}}})},"refreshTabableElements":function(e){o.debug("PreviewPaneListKeyboardBehavior::refreshTabableElements "+e.constructor.name)&&console.log(o.last),this.view.currentTabPosition=s.none,this.view.selectedIndex=-1}});return a}),csui.define("xecmpf/widgets/header/impl/previewpane/impl/previewpane.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/list/simplelist.view","csui/controls/node-type.icon/node-type.icon.view","xecmpf/widgets/header/impl/previewpane/impl/previewpane.list.keyboard.behavior","csui/dialogs/modal.alert/modal.alert"],function(e,t,i,o,n,s,a,r){var c=n.extend({"constructor":function(e){n.prototype.constructor.apply(this,arguments)},"behaviors":{"PreviewPaneListKeyboardBehavior":{"behaviorClass":a}},"events":{"keydown":"onKeyDown"},"initialize":function(e){e||(e={}),this.enableIcon=e.enableIcon,this.enableDescription=e.enableDescription,this.previewPane=e.previewPane,this.config=e.config,this.listenTo(this,"childview:render",this.onRenderItem),this.listenTo(this,"childview:before:destroy",this.onBeforeDestroyItem),this.listenTo(this,"click:item",this.onClickListItem)},"childViewOptions":function(e){return{"templateHelpers":function(){return{"enableIcon":this.enableIcon,"enableDescription":this.enableDescription,"name":e.get("name")}}.bind(this)}},"onClickListItem":function(e){var t=e.model.get("displayUrl"),i=e.model.get("displayUrlError");if(i)r.showError(i);else if(t){var o=window.open(t,"_blank");o.focus()}},"onRenderItem":function(e){if(e._nodeIconView=new s({"el":e.$(".csui-type-icon").get(0),"node":e.model}),e._nodeIconView.render(),this.options&&e.model&&e.model.attributes&&e.model.attributes.name&&this.options.enableDescription){var t='<div class="SLITitleDiv"><div class="SLITitle"><span title="'+e.model.attributes.name+'">'+e.model.attributes.name+'</span></div><div class="SLIDescription"><span title="'+e.model.attributes.classification_name+'">'+e.model.attributes.classification_name+"</span></div></div>";e.$(".list-item-title").replaceWith(t)}var i=e.model.get("displayUrl");if(i){var o=e.$el[0];o.href=i}},"onBeforeDestroyItem":function(e){e._nodeIconView&&e._nodeIconView.destroy()}});return c}),csui.define("hbs!xecmpf/widgets/header/impl/previewpane/impl/previewpane",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'\r\n<div class="binf-panel-body xecmpf-preview-body"></div>\r\n\r\n<div class="binf-panel-footer xecmpf-preview-footer">'+this.escapeExpression((n=null!=(n=t.info||(null!=e?e.info:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"info","hash":{}}):n))+"</div>\r\n"}});return i.registerPartial("xecmpf_widgets_header_impl_previewpane_impl_previewpane",o),o}),csui.define("css!xecmpf/widgets/header/impl/previewpane/impl/previewpane",[],function(){}),csui.define("xecmpf/widgets/header/impl/previewpane/previewpane.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","xecmpf/widgets/header/impl/previewpane/impl/previewpane.list.view","hbs!xecmpf/widgets/header/impl/previewpane/impl/previewpane","i18n","css!xecmpf/widgets/header/impl/previewpane/impl/previewpane"],function(e,t,i,o,n,s,a,r,c){var l=i.LayoutView.extend({"className":"xecmpf-preview binf-panel binf-panel-default","constructor":function(o){if(i.LayoutView.prototype.constructor.call(this,o),o||(o={}),this.config=o.config,this.config){this.parent=o.parent,this.config.readonly=!0,this.docsCollection=o.collection,this.headerTitle=o.headerTitle,this.footerInfoText=o.info,this.direction=c.settings.rtl?"left":"right",o.parent.$el.binf_popover({"content":this.$el,"placement":"auto "+this.direction,"trigger":"manual","container":"body","html":!0,"title":o.headerTitle});var n=this.parent.$el.data("binf.popover"),s=n.tip();o.customPopoverClass?"":o.customPopoverClass;s.addClass("xecmpf-previewpane-popover").addClass(o.customPopoverClass),o&&o.headerColor&&(this.config.debug===!0&&console.log("add headerColor "+o.headerColor+" to "+s.find(".binf-popover-title")),s.find(".binf-popover-title").addClass(o.headerColor)),this.parent.$el.off("click").on("click",t.proxy(function(){this.config.debug===!0&&console.log("Preview : Keyboard enter item"),this.show();var t=0,i=e.str.sformat("div a:nth-child({0})",t+1),o=this.docsListView.$(i);o.first().trigger("focus")},this)),this.parent.$el.off("mouseenter").on("mouseenter",t.proxy(function(){this.config.debug===!0&&console.log("Preview : Mouseenter item"),this.show()},this)),this.parent.$el.off("keydown").on("keydown",t.proxy(function(){(13===event.keyCode||32===event.keyCode)&&this.show(),27===event.keyCode&&this.isRendered&&this._delayedHide()},this)),this.toggle=0,this.parent.$el.on("touchend",t.proxy(function(){this.config.debug===!0&&console.log("Preview : touchend item"),this.$el.is(":visible")||(this.toggle=0),0===this.toggle?this.show():1===this.toggle&&this._delayedHide()},this)),this.parent.$el.off("mouseleave").on("mouseleave",t.proxy(function(){this.config.debug===!0&&console.log("Preview : Mouseleave item"),this._delayedHide()},this)),s.off("mouseenter").on("mouseenter",t.proxy(function(){this.config.debug===!0&&console.log("Preview : Mouseenter binf-popover"),this.show()},this)),s.off("keydown").on("keydown",t.proxy(function(e){27===e.keyCode&&this._delayedHide()},this)),s.off("mouseleave").on("mouseleave",t.proxy(function(){this.config.debug===!0&&console.log("Preview : Mouseleave binf-popover"),this._delayedHide()},this)),this.propagateEventsToRegions(),this.listenTo(this,"dom:refresh",function(){
this.options.parent.$el.binf_popover("show")})}},"template":r,"regions":{"contentRegion":".xecmpf-preview-body","footerRegion":".xecmpf-preview-footer"},"templateHelpers":function(){return{"title":this.headerTitle,"info":this.footerInfoText}},"behaviors":{"PerfectScrolling":{"behaviorClass":n,"contentParent":".xecmpf-preview-body","suppressScrollX":!0}},"onBeforeDestroy":function(e){this.config&&this.parent.$el.binf_popover("destroy")},"show":function(){if(this.config){if(this.config.debug===!0&&console.log("Preview : Preparing show"),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.config.debug===!0&&console.log("Preview : Cleared hide timeout"),this.hideTimeout=null),this.$el.is(":visible"))return void(this.config.debug===!0&&console.log("Preview : Already visible"));this.showCancelled=!1,this.$el.hide(),this.render(),this.docsListView&&this.docsListView.destroy(),this.docsListView=new a({"collection":this.docsCollection,"enableIcon":this.options.enableIcon,"enableDescription":this.options.enableDescription,"previewPane":this,"config":this.config}),this.listenTo(this.docsListView,"before:DefaultAction",function(e){e.cancelDefaultAction=this.options.cancelDefaultAction}),this.showCancelled?this.config.debug===!0&&console.log("Preview : Show was cancelled"):(this.config.debug===!0&&console.log("Preview : Showing"),this.contentRegion.show(this.docsListView,{"render":!0}),this.$el.show(),this.triggerMethod("before:show",this),this.toggle=1,this.options.parent.$el.binf_popover("show"),this.triggerMethod("show",this),this.config.debug===!0&&(console.log("Viewport height: "+t(window).height()),console.log("document height: "+t(document).height()),console.log("body     height: "+t("body").height()),console.log("binf-popover  height: "+this.$el.height()),console.log("list     height: "+this.$el.find(".xecmpf-preview-body").height())))}},"hide":function(){this.config.debug===!0&&console.log("Preview : Going to hide"),this.config&&!this.config.debugNoHide?(this.config.debug===!0&&console.log("Preview : Hidden"),this.toggle=0,this.options.parent.$el.binf_popover("hide"),this.hideTimeout=null):this.config.debug===!0&&console.log("Preview : Leaving visible"),this.showCancelled=!0,this.hideTimeout=null},"_delayedHide":function(){this.config.debug===!0&&console.log("Preview : Setting hide timeout"),this.hideTimeout=window.setTimeout(t.proxy(this.hide,this),200)},"onShow":function(){this.$(".cs-simplelist.binf-panel").css("height",this.$(".binf-panel-body.xecmpf-preview-body").height()),this.footerInfoText||t(this.regions.footerRegion).hide()}});return e.extend(l.prototype,s),l}),csui.define("hbs!xecmpf/widgets/header/impl/completenesscheck/impl/completenesscheckitem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n;return'  <span class="csui-icon '+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'"></span>\r\n  <button class="count binf-btn binf-btn-default xecmpf-docscount-without-text">'+this.escapeExpression((n=null!=(n=t.docsCount||(null!=e?e.docsCount:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"docsCount","hash":{}}):n))+'</button>\r\n  <button class="count binf-btn binf-btn-default xecmpf-docscount-with-text">'+this.escapeExpression((n=null!=(n=t.docsCountWithText||(null!=e?e.docsCountWithText:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"docsCountWithText","hash":{}}):n))+"</button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return null!=(n=t["if"].call(e,null!=e?e.docsCount:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:""}});return i.registerPartial("xecmpf_widgets_header_impl_completenesscheck_impl_completenesscheckitem",o),o}),csui.define("hbs!xecmpf/widgets/header/impl/completenesscheck/impl/completenesscheck",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){return'  <div class="missing-docs-check"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return null!=(n=t.unless.call(e,null!=e?e.hideMissingDocsCheck:e,{"name":"unless","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:""}});return i.registerPartial("xecmpf_widgets_header_impl_completenesscheck_impl_completenesscheck",o),o}),csui.define("xecmpf/widgets/header/impl/completenesscheck/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/header/impl/completenesscheck/impl/nls/root/lang",{"missingDocsTitle":"Missing documents","dialogTitle":"Reports","recentReportName":"Last 10 added documents","addedReportName":"Documents you added","missingReportName":"{0} missing","emptyMessage":"No documents to display"}),csui.define("css!xecmpf/widgets/header/impl/completenesscheck/impl/completenesscheck",[],function(){}),csui.define("xecmpf/widgets/header/impl/completenesscheck/completenesscheck.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","conws/models/workspacecontext/workspacecontext.factory","xecmpf/widgets/header/impl/completenesscheck/impl/missingdocuments.factory","csui-ext!xecmpf/widgets/header/completenesscheck/completenesscheck.factory","xecmpf/widgets/header/impl/previewpane/previewpane.view","hbs!xecmpf/widgets/header/impl/completenesscheck/impl/completenesscheckitem","hbs!xecmpf/widgets/header/impl/completenesscheck/impl/completenesscheck","i18n!xecmpf/widgets/header/impl/completenesscheck/impl/nls/lang","css!xecmpf/widgets/header/impl/completenesscheck/impl/completenesscheck"],function(e,t,i,o,n,s,a,r,c,l,d){var p="selfserviceOutdatedCollection",u="selfserviceQueuedCollection",h=o.ItemView.extend({"className":"docs-check-list-item","constructor":function(e){e||(e={}),o.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.options.collection,"change",this.render),this.options&&this.options.preview&&(this.previewPane=new r({"parent":this,"context":this.options.workspaceContext,"config":this.options.preview,"collection":this.options.collection,"headerTitle":this.options.title,"enableIcon":this.options.enableIcon,"headerColor":e.headerColor,"enableDescription":e.enableDescription,"info":this.options.info,"cancelDefaultAction":this.options.cancelDefaultAction,"customPopoverClass":this.options.customPopoverClass}))},"template":c,"templateHelpers":function(){return{"icon":this.options.icon,"docsCount":this.options.collection.length,"docsCountWithText":e.str.sformat(this.options.label,this.options.collection.length)}},"onBeforeDestroy":function(){this.previewPane&&(this.previewPane.destroy(),delete this.previewPane)}}),m=o.LayoutView.extend({"className":"xecmpf-completenesscheck","constructor":function(e){e||(e={}),o.LayoutView.prototype.constructor.apply(this,arguments),e.workspaceContext||(e.workspaceContext=e.context.getObject(n)),e.workspaceContext.setWorkspaceSpecific(s),this.missingDocsCollection=e.hideMissingDocsCheck?void 0:e.workspaceContext.getCollection(s)},"template":l,"templateHelpers":function(){return{"hideMissingDocsCheck":this.options.hideMissingDocsCheck}},"onRender":function(){this.showCompletenessCheck({"collection":this.missingDocsCollection,"title":d.missingDocsTitle,"label":d.missingReportName,"icon":"missing-icon","index":0,"enableIcon":!1,"region":this.missingDocsRegion,"enableDescription":!1,"cancelDefaultAction":!0,"customPopoverClass":"xecmpf-missing-docs-check"}),this.showExternalViews(this.options)},"regions":{"missingDocsRegion":".missing-docs-check"},"showCompletenessCheck":function(e){e.collection&&(e.collection.fetched===!0&&e.collection.length>0&&(this._showCompletenessCheck(e),this._completenessCheckAvailable()),this.listenToOnce(e.collection,"sync",function(){e.collection.length>0&&(e.collection.fetched=!0,e.title=e.collection.options&&e.collection.options.name?e.collection.options.name:e.title,e.label=e.collection.options&&e.collection.options.label?e.collection.options.label:e.label,e.icon=e.collection.options&&e.collection.options.iconClass?e.collection.options.iconClass:e.icon,e.customPopoverClass=e.collection.options&&e.collection.options.customPopoverClass?e.collection.options.customPopoverClass:e.customPopoverClass,this._showCompletenessCheck(e),this._completenessCheckAvailable())}))},"_completenessCheckAvailable":function(){this.trigger("completeness:check:available"),this.options.originatingView&&this.options.originatingView.trigger("completeness:check:available")},"_showCompletenessCheck":function(e){if(this.showRegion=!0,!e.region){var t=this.regionManager.completenesscheck_view0,i=this.regionManager.completenesscheck_view1;if(t&&0===e.index||i&&1===e.index)this.showRegion=!1;else{var o="completenesscheck_view"+e.index;this.addRegion(o),e.region=this.regionManager[o]}}this.showRegion&&e.region.show(new h({"workspaceContext":this.options.workspaceContext,"collection":e.collection,"preview":{"debug":!1},"title":e.title,"label":e.label,"icon":e.icon,"headerColor":e.headerColor,"enableIcon":e.enableIcon,"enableDescription":e.enableDescription,"cancelDefaultAction":e.cancelDefaultAction,"customPopoverClass":e.customPopoverClass}))},"showExternalViews":function(t){if(a&&a.length>0){var i,o=this;e.each(a,function(e,s){t.hideOutdatedDocsCheck&&e.prototype.propertyPrefix===p||t.hideInProcessDocsCheck&&e.prototype.propertyPrefix===u||(t.workspaceContext||(t.workspaceContext=t.context.getObject(n)),t.workspaceContext.setWorkspaceSpecific(e),i=t.workspaceContext.getCollection(e),o.showCompletenessCheck({"collection":i,"title":i.options.name,"label":i.options.label?i.options.label:i.options.name,"icon":i.options.iconClass,"headerColor":i.options.headerColor,"enableIcon":i.options.enableIcon,"enableDescription":i.options.enableDescription,"index":s,"cancelDefaultAction":i.options.cancelDefaultAction,"customPopoverClass":i.options.customPopoverClass}))})}},"addRegion":function(e){this.regionManager||(this.regionManager={});var i=this,n=t(this.el);n.append(t("<div></div>").attr({"class":e}));var s=o.Region.buildRegion({"el":n.find("."+e)},o.Region);s.getEl=function(e){return i.$(e)},this.regionManager[e]=s}});return m}),csui.define("hbs!xecmpf/widgets/header/impl/displayUrl/impl/displayUrlItem",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){var n,s;return'  <a class="xecmpf-displayUrl-icon conws-quick_link '+(null!=(n=t["if"].call(e,null!=e?e.displayUrlError:e,{"name":"if","hash":{},"fn":this.program(2,o,0),"inverse":this.noop}))?n:"")+'" title="'+this.escapeExpression((s=null!=(s=t.displayUrlTooltip||(null!=e?e.displayUrlTooltip:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"displayUrlTooltip","hash":{}}):s))+'"\r\n     aria-label="'+this.escapeExpression((s=null!=(s=t.ariaLabelBusApplText||(null!=e?e.ariaLabelBusApplText:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"ariaLabelBusApplText","hash":{}}):s))+'" '+(null!=(n=t["if"].call(e,null!=e?e.displayUrlError:e,{"name":"if","hash":{},"fn":this.program(4,o,0),"inverse":this.program(6,o,0)}))?n:"")+"></a>\r\n"},"2":function(e,t,i,o){return"\r\n    xecmpf-displayUrl-error "},"4":function(e,t,i,o){return'  href="#"  '},"6":function(e,t,i,o){var n;return'\r\n     href="'+this.escapeExpression((n=null!=(n=t.displayUrl||(null!=e?e.displayUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"displayUrl","hash":{}}):n))+'" target="_blank"'},"8":function(e,t,i,o){var n;return'  <button class="xecmpf-displayUrl-icon conws-quick_link binf-btn binf-btn-default"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=t.ariaLabelBusApplText||(null!=e?e.ariaLabelBusApplText:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaLabelBusApplText","hash":{}}):n))+'"></button>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return null!=(n=t["if"].call(e,null!=e?e.displayUrl:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.program(8,o,0)}))?n:""}});return i.registerPartial("xecmpf_widgets_header_impl_displayUrl_impl_displayUrlItem",o),o}),csui.define("hbs!xecmpf/widgets/header/impl/displayUrl/impl/displayUrl",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o){return'  <div id="displayUrl-check"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return null!=(n=t["if"].call(e,null!=e?e.bDisplayUrl:e,{"name":"if","hash":{},"fn":this.program(1,o,0),"inverse":this.noop}))?n:""}});return i.registerPartial("xecmpf_widgets_header_impl_displayUrl_impl_displayUrl",o),o}),csui.define("xecmpf/widgets/header/impl/displayUrl/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/header/impl/displayUrl/impl/nls/root/lang",{"displayUrlTooltip":"Business application","displayUrlTitle":"Business applications","ariaLabelBusApplText":"Go to business application"}),csui.define("css!xecmpf/widgets/header/impl/displayUrl/impl/displayUrl",[],function(){}),csui.define("xecmpf/widgets/header/impl/displayUrl/displayUrl.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/dialogs/modal.alert/modal.alert","xecmpf/widgets/header/impl/previewpane/previewpane.view","hbs!xecmpf/widgets/header/impl/displayUrl/impl/displayUrlItem","hbs!xecmpf/widgets/header/impl/displayUrl/impl/displayUrl","i18n!xecmpf/widgets/header/impl/displayUrl/impl/nls/lang","css!xecmpf/widgets/header/impl/displayUrl/impl/displayUrl"],function(e,t,i,o,n,s,a,r,c){var l=o.ItemView.extend({"className":"xecmpf-displayUrl-item","constructor":function(e){e||(e={}),this.options=e,o.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.options.collection,"change",this.render),this.options&&this.options.preview&&e.collection.length>1&&(this.previewPane=new s({"parent":this,"config":{"debug":!0},"collection":e.collection,"headerTitle":c.displayUrlTitle,"headerColor":e.headerColor}))},"events":{"click .xecmpf-displayUrl-error":"showError"},"template":a,"templateHelpers":function(){var e=1===this.options.collection.length?this.options.collection.models[0].get("displayUrl"):!1,t=1===this.options.collection.length?this.options.collection.models[0].get("displayUrlError"):"",i=c.ariaLabelBusApplText+(e?" "+this.options.collection.models[0].get("external_system_name"):""),o=e?c.displayUrlTooltip:"";return{"ariaLabelBusApplText":i,"displayUrlTooltip":o,"displayUrl":e,"displayUrlError":t}},"onBeforeDestroy":function(){this.previewPane&&(this.previewPane.destroy(),delete this.previewPane)},"showError":function(){n.showError(this.options.collection.models[0].get("displayUrlError"))}}),d=o.LayoutView.extend({"className":"xecmpf-displayUrlcheck","constructor":function(e){e||(e={}),this.model=e.model,this.options.headerColor="xecmpf-displayUrl-header-background",o.LayoutView.prototype.constructor.apply(this,arguments)},"template":r,"templateHelpers":function(){var e=this.model.display_urls&&this.model.display_urls.length>0?!0:!1;return{"bDisplayUrl":e}},"regions":{"displayUrlRegion":"#displayUrl-check"},"onRender":function(){var t;if(this.model.display_urls&&this.model.display_urls.length>=1){var o=e.map(this.model.display_urls,function(e){var t=e.business_object_type_name+" ("+e.external_system_name+")";return{"name":t,"displayUrl":e.displayUrl,"external_system_name":e.external_system_name,"displayUrlError":e.errMsg}});t=new i.Collection,t.add(o),this.displayUrlRegion.show(new l({"collection":t,"preview":{"debug":!0},"headerColor":this.options.headerColor}))}}});return d}),csui.define("xecmpf/widgets/header/impl/nls/header.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/header/impl/nls/root/header.lang",{"noMetadataMessage":"No data to display.","CollapsePageOverlay":"Close"}),csui.define("xecmpf/widgets/header/impl/metadata.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/controls/list/emptylist.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","conws/models/workspacecontext/workspacecontext.factory","conws/models/selectedmetadataform/selectedmetadataform.factory","conws/controls/selectedmetadataform/selectedmetadataform.view","i18n!xecmpf/widgets/header/impl/nls/header.lang"],function(e,t,i,o,n,s,a,r,c,l){var d=i.ItemView.extend({"className":"xecmpf-form-metadata","attributes":{"style":"height: 100%"},"template":!1,"constructor":function(e){if(e||(e={}),!e.context)throw new Error("Context is missing in the constructor options");e.workspaceContext||(e.workspaceContext=e.context.getObject(a)),e.workspaceContext.setWorkspaceSpecific(r),e.model=e.workspaceContext.getObject(r,{"metadataConfig":e.data,"unique":!0}),this.noMetadataMessage=l.noMetadataMessage,i.ItemView.prototype.constructor.call(this,e),this.listenTo(e.model,"change",this.render)},"behaviors":{"PerfectScrolling":{"behaviorClass":s,"contentParent":this.$el,"suppressScrollX":!0,"scrollYMarginOffset":15}},"onRender":function(){if(this.formRegion=new i.Region({"el":this.$el}),e.isEmpty(this.model.attributes.data))this.noDataFound=!0,this.formView=new n({"text":this.noMetadataMessage}),this.formRegion.show(this.formView),this.triggerMethod("xecmpf:metadata:config");else{this.noDataFound=!1;var t=this.model.attributes.data,o=this.options.data.colOptions,s=this.model.attributes.options.fields;if(e.each(e.keys(t),function(i){"null"===t[i]&&(t=e.omit(t,i),s[i].hidden=!0)}),this.model.attributes.data=t,this.model.attributes.options.fields=s,"doubleCol"===o){var a=e.size(e.filter(e.keys(s),function(e){return void 0!==s[e].hidden&&s[e].hidden===!1}));o=a>5?"doubleCol":"singleCol"}this.formView=new c({"model":this.model,"context":this.options.context,"layoutMode":o&&"singleCol"===o?o:"doubleCol","breakFieldsAt":5}),this.formRegion.show(this.formView),this.triggerMethod("xecmpf:metadata:config")}this.listenTo(this.formView,"render:form",function(){this.triggerMethod("dom:refresh")})}});return d}),csui.define("css!xecmpf/widgets/header/impl/header",[],function(){}),csui.define("xecmpf/widgets/header/header.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","conws/widgets/header/header.view","conws/models/selectedmetadataform/selectedmetadataform.factory","xecmpf/widgets/header/impl/completenesscheck/completenesscheck.view","xecmpf/widgets/header/impl/displayUrl/displayUrl.view","esoc/widgets/activityfeedwidget/activityfeedfactory","esoc/widgets/activityfeedwidget/activityfeedcontent","xecmpf/widgets/header/impl/metadata.view","conws/controls/description/description.view","css!xecmpf/widgets/header/impl/header"],function(e,t,i,o,n,s,a,r,c,l,d,p,u){var h={"activityfeedwidget":"esoc/widgets/activityfeedwidget"},m=e.config(),f=s.extend({"id":"xecmpf-header","constructor":function(e){e||(e={}),e.data||(e.data={}),e.data.widget||(e.data.widget={}),e.data.widget.type||(e.data.widget.type="metadata"),e.hideToolbar=!!m.hideToolbar,e.hideActivityFeed=!!m.hideActivityFeed,e.hideMetadata=!!m.hideMetadata||!(e.data.metadataSettings&&e.data.metadataSettings.metadata&&!e.data.metadataSettings.hideMetadata),e.toolbarBlacklist=[],e.extensionToolbarBlacklist=[],e.delayedToolbarBlacklist=[],e.extensionToolbarDelayedActionsBlacklist=[],e.enableCollapse=!!m.enableCollapse;var i=m.toolbarBlacklist;Array.isArray(i)&&i.length>0&&(e.toolbarBlacklist=i);var o=m.delayedToolbarBlacklist;Array.isArray(o)&&o.length>0&&(e.delayedToolbarBlacklist=o);var n=m.extensionToolbarBlacklist;Array.isArray(n)&&n.length>0&&(e.extensionToolbarBlacklist=n);var c=m.extensionToolbarDelayedActionsBlacklist;Array.isArray(c)&&c.length>0&&(e.extensionToolbarDelayedActionsBlacklist=c),e.data&&e.data.favoriteSettings&&e.data.favoriteSettings.hideFavorite&&(e.toolbarBlacklist.Favorite2||e.toolbarBlacklist.push("Favorite2"),e.extensionToolbarBlacklist.Favorite2||e.extensionToolbarBlacklist.push("Favorite2")),e.extensionToolbarBlacklist.CompletenessCheck||e.extensionToolbarBlacklist.push("CompletenessCheck");var d=e.data.completenessCheckSettings,p={"context":e.context,"workspaceContext":e.workspaceContext,"hideMissingDocsCheck":d&&d.hideMissingDocsCheck,"hideOutdatedDocsCheck":d&&d.hideOutdatedDocsCheck,"hideInProcessDocsCheck":d&&d.hideInProcessDocsCheck};e.cCViewOptions=p,e.statusIndicatorsView=r,e.statusIndicatorsViewOptions=t.extend(p,{"originatingView":this}),s.prototype.constructor.call(this,e),e.workspaceContext&&(e.workspaceContext.setWorkspaceSpecific(a),e.workspaceContext.setWorkspaceSpecific(l))},"initialize":function(e){if(e||(e={}),e.data){var i=e.data.headerwidget&&e.data.headerwidget.type?e.data.headerwidget.type:"metadata";if(this.headerwidgetConfigValue=i,"metadata"===i&&"metadata"===e.data.widget.type&&!this.options.hideMetadata){var o=e.data.metadataSettings,n=this._makeMetadataReadOnly(o.metadata),s={"context":e.context,"workspaceContext":e.workspaceContext,"data":{"hideEmptyFields":o.hideEmptyFields,"metadata":n,"readonly":!0,"colOptions":e.data.metadataSettings.metadataInColumns}};this.metadataView=new p(s),this.listenTo(this.metadataView,"xecmpf:metadata:config",function(){this.metadataView.noDataFound?this.$el.parent().addClass("xecmpf-metadata-configured-nodata").removeClass("xecmpf-metadata-configured"):this.$el.parent().addClass("xecmpf-metadata-configured").removeClass("xecmpf-metadata-configured-nodata")})}if("activityfeed"!==this.headerwidgetConfigValue||this.options.hideActivityFeed||(e.data.widget.type=h.activityfeedwidget,e.data.widget.options||(e.data.widget.options={})),!m.pageWidget){var a=t.extend(e.cCViewOptions,{"workspaceContext":e.workspaceContext});a.hideMissingDocsCheck&&a.hideOutdatedDocsCheck&&a.hideInProcessDocsCheck||(this.options.hasMetadataExtension=!0,this.completenessCheckView=new r(a))}var l={"model":this.model,"logging":{"debug":!1}};this.displayUrlView=new c(l),this.listenTo(this.completenessCheckView,"completeness:check:available",function(){if(this.$el.parent().addClass("xecmpf-completenesscheck-available"),e.expandDescription=!1,!this.options.hideDescription&&!this.hasEmptyDescription()){var t={"view":this,"complete_desc":this.resolveProperty("description"),"expandDescription":e.expandDescription};this.descriptionView=new u(t),this.descriptionRegion.show(this.descriptionView),this.$el.parent().addClass("conws-description-available"),this.listenToDescriptionView()}}),this.listenTo(this,"render",function(){this.model.fetched&&this.showChildViews()})}},"ui":{"completenessCheckRegion":".conws-header-metadata-extension","metadataRegion":"#conws-header-childview","displayUrlRegion":".conws-header-child-displayUrl"},"_makeMetadataReadOnly":function(e){var t=e||[];return t.forEach(function(e){e.readOnly=!0}),t},"showChildViews":function(){this.completenessCheckView&&(this.completenessCheckRegion=new o.Region({"el":this.ui.completenessCheckRegion}),this.completenessCheckRegion.show(this.completenessCheckView),this.listenToDescriptionView()),this.metadataView&&(this.metadataRegion=new o.Region({"el":this.ui.metadataRegion}),this.metadataRegion.show(this.metadataView)),this.displayUrlView&&(this.displayUrlRegion=new o.Region({"el":this.ui.displayUrlRegion}),this.displayUrlRegion.show(this.displayUrlView)),this.listenTo(this,"completeness:check:available",function(){this.headerToolbarView.triggerMethod("status:indicator:available")})},"listenToDescriptionView":function(){this.descriptionView&&(this.listenTo(this.descriptionView,"show:more:description",function(){this.toggleCompletenessCheckView(!1)}),this.listenTo(this.descriptionView,"show:less:description",function(){this.toggleCompletenessCheckView(!0)}))},"toggleCompletenessCheckView":function(e){e?this.completenessCheckView.$el.removeClass("xecmpf-completenesscheck-hidden").addClass("xecmpf-completenesscheck-shown"):this.completenessCheckView.$el.removeClass("xecmpf-completenesscheck-shown").addClass("xecmpf-completenesscheck-hidden")},"hasChildView":function(){var e=this.options.data&&this.options.data.widget&&this.options.data.widget.type&&"none"!==this.options.data.widget.type;return"activityfeed"===this.headerwidgetConfigValue?!this.options.hideActivityFeed&&e:"metadata"===this.headerwidgetConfigValue?!this.options.hideMetadata&&e:void 0},"onDomRefresh":function(){this.addActivityFeedClass(),this.completenessCheckView&&this.toggleCompletenessCheckView(!0),this.descriptionView&&this.descriptionView.$el.find(this.descriptionView.ui.readMore).is(":hidden")&&this.descriptionView.$el.find(this.descriptionView.ui.showLess).is(":visible")&&(this.descriptionView.ui.showLess.trigger("click"),this.currentlyFocusedElement().trigger("focus")),this.isTabable()?this.currentlyFocusedElement().attr("tabindex","0"):this.currentlyFocusedElement().attr("tabindex","-1"),this._clampTexts(),this.options.hideToolbar||this.headerToolbarView.triggerMethod("dom:refresh")},"onBeforeDestroy":function(){this.metadataView&&this.metadataView.destroy(),this.displayUrlView&&this.displayUrlView.destroy()}});return f}),csui.define("xecmpf/widgets/scan/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/scan/impl/nls/root/lang",{"title":"Scan barcode","defaultTextForDesktop":"This widget is only supported for mobile UI."}),csui.define("xecmpf/widgets/scan/scan.content.view",["csui/lib/marionette","i18n!xecmpf/widgets/scan/impl/nls/lang"],function(e,t){var i=e.ItemView.extend({"constructor":function(t){e.ItemView.prototype.constructor.call(this,t)},"render":function(){return this.$el.text(t.defaultTextForDesktop),this}});return i}),csui.define("xecmpf/widgets/scan/scan.view",["csui/lib/underscore","csui/controls/tile/tile.view","xecmpf/widgets/scan/scan.content.view","i18n!xecmpf/widgets/scan/impl/nls/lang"],function(e,t,i,o){var n=t.extend({"constructor":function(e){t.prototype.constructor.call(this,e)},"contentView":i,"icon":"title-recentlyaccessed","title":o.title});return n}),csui.define("xecmpf/controls/savedquery.node.picker/impl/search.query.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory"],function(e,t,i,o){var n=i.Model.extend({"constructor":function a(e,t){a.__super__.constructor.apply(this,arguments)},"toJSON":function(){return n.__super__.toJSON.apply(this,arguments)}}),s=o.extend({"propertyPrefix":"xecmpfSearchQuery","constructor":function(s,a){o.prototype.constructor.apply(this,arguments);var r=this.options.xecmpfSearchQuery||{};if(!(r instanceof i.Model)){var c=e.config();r=new n(r.models,t.extend({},r.options,c.options))}this.property=r}});return s}),csui.define("xecmpf/controls/savedquery.node.picker/impl/search.results.factory",["require","module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/models/widget/search.results/search.results.model","csui/utils/commands","csui/utils/base"],function(e,t,i,o,n,s,a,r,c){var l=n.extend({"propertyPrefix":"xecmpfSearchResults","constructor":function(e,c){n.prototype.constructor.apply(this,arguments);var l=this.options.xecmpfSearchResults||{};if(!(l instanceof o.Collection)){var d=e.getObject(s,c),p=c.xecmpfSearchResults.query,u=t.config();l=new a(l.models,i.extend({"connector":d,"query":p,"commands":r.getAllSignatures()},l.options,u.options,{"autofetch":!0,"autoreset":!0}))}this.property=l},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){this.property.fetch({"success":i.bind(this._onSearchResultsFetched,this,e),"error":i.bind(this._onSearchResultsFailed,this,e)})},"_onSearchResultsFetched":function(e){return!0},"_onSearchResultsFailed":function(e,t,i){var o=new c.RequestErrorMessage(i);csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showError(o.toString())})}});return l}),csui.define("hbs!xecmpf/controls/savedquery.node.picker/impl/savedquery.form",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){return'<div class="xecmpf-sq-select-container"></div>\r\n<div class="xecmpf-custom-search-container"></div>\r\n'}});return i.registerPartial("xecmpf_controls_savedquery.node.picker_impl_savedquery.form",o),o}),csui.define("xecmpf/controls/savedquery.node.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/controls/savedquery.node.picker/impl/nls/root/lang",{"selectQuery":"Select Search Query"}),csui.define("css!xecmpf/controls/savedquery.node.picker/impl/savedquery.form",[],function(){}),csui.define("xecmpf/controls/savedquery.node.picker/impl/savedquery.form.view",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/node/node.model","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/children2","csui/behaviors/keyboard.navigation/tabables.behavior","xecmpf/controls/savedquery.node.picker/impl/search.query.factory","csui/models/form","csui/controls/form/form.view","csui/widgets/search.custom/search.custom.view","hbs!xecmpf/controls/savedquery.node.picker/impl/savedquery.form","i18n!xecmpf/controls/savedquery.node.picker/impl/nls/lang","css!xecmpf/controls/savedquery.node.picker/impl/savedquery.form"],function(e,t,i,o,n,s,a,r,c,l,d,p,u,h,m){var f=i.extend({"csSubTypes":{"queryVolume":860,"query":258}},e.config()),g=n.LayoutView.extend({"className":"xecmpf-savedquery-form","template":h,"regions":{"querySelectRegion":".xecmpf-sq-select-container","customSearchRegion":".xecmpf-custom-search-container"},"constructor":function(e){e||(e={}),e.query||(e.query=e.context.getModel(l)),n.LayoutView.prototype.constructor.apply(this,arguments)},"initialize":function(e){this.query=e.query},"setQuerySelectField":function(){var e=o.Deferred();return this._getQueryCollection().then(function(t){var o={};t.each(function(e){o[e.get("name")]=e.get("id")}),this.query.set("query_id",o[i.keys(o)[0]]||"",{"silent":!0});var n=this;this.querySelectForm=new p({"mode":"create","model":new d({"data":{"searchQueryId":this.query.get("query_id")},"schema":{"properties":{"searchQueryId":{"enum":i.values(o)}}},"options":{"fields":{"searchQueryId":{"label":m.selectQuery,"name":"searchQueryId","type":"select","optionLabels":i.keys(o),"removeDefaultNone":!0,"onFieldChange":function(){n.onChangeSavedQuerySelectField(this.getValue())}}}}})}),e.resolve()}.bind(this),e.reject),e},"onChangeSavedQuerySelectField":function(e){this.query.clear({"silent":!0}).set("query_id",e,{"silent":!0}),this.setCustomSearchView().then(function(){this.showChildView("customSearchRegion",this.customSearchView)}.bind(this),function(e){console.error("Unable to set custom search form view.")})},"_getQueryCollection":function(){var e=this.options.context.getCollection(r,{"options":{"node":new s({"id":f.queryVolumeId,"type":f.csSubTypes.queryVolume},{"connector":this.options.context.getObject(a)}),"filter":{"type":f.csSubTypes.query}},"attributes":{"id":f.queryVolumeId}}),t=o.Deferred();return e.ensureFetched().then(function(){t.resolve(e)},t.reject),t},"setCustomSearchView":function(){var e=o.Deferred();return csui.require(["csui/widgets/search.custom/impl/search.object.view"],function(t){this.customSearchView&&this.customSearchView.destroy();var i=this.query.get("query_id");this.customSearchView=i?new t({"context":this.options.context,"query":this.options.query,"savedSearchQueryId":i}):new n.View,this.customSearchView.model&&this.customSearchView.model.ensureFetched(),e.resolve()}.bind(this),e.reject),e},"onRender":function(){this.setQuerySelectField().then(function(){this.showChildView("querySelectRegion",this.querySelectForm),this.setCustomSearchView().then(function(){this.showChildView("customSearchRegion",this.customSearchView)}.bind(this),function(e){console.error("Unable to set custom search form view.")})}.bind(this),function(e){console.error("Unable to set saved queries select field.")})},"onBeforeDestroy":function(){this.customSearchView&&this.customSearchView.destroy()}});return g}),csui.define("css!xecmpf/controls/savedquery.node.picker/impl/savedquery.node.picker",[],function(){}),
csui.define("xecmpf/controls/savedquery.node.picker/savedquery.node.picker.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","xecmpf/controls/savedquery.node.picker/impl/search.query.factory","xecmpf/controls/savedquery.node.picker/impl/search.results.factory","xecmpf/controls/savedquery.node.picker/impl/savedquery.form.view","csui/widgets/search.results/search.results.view","css!xecmpf/controls/savedquery.node.picker/impl/savedquery.node.picker"],function(e,t,i,o,n,s,a,r,c){var l=o.Object.extend({"constructor":function(t){t||(t={}),t.query||(t.query=t.context.getModel(s)),t.collection||(t.collection=t.context.getCollection(a,e.extend({},t,{"unique":!0,"temporary":!0,"detached":!0,"internal":!1}))),o.Object.prototype.constructor.apply(this,arguments)},"initialize":function(e){this.searchFormView=new r({"context":e.context,"query":e.query}),this.searchResultsView=new c({"context":e.context,"query":e.query,"collection":e.collection,"customSearchView":this.searchFormView,"toolbarItems":this.options.toolbarItems,"enableBackButton":this.options.enableBackButton,"titleView":new o.ItemView({"tagName":"h2","template":n.compile("<span>{{title}}</span>")({"title":this.options.title})})}),this.options.toolbarItems.inlineToolbar||(this.searchResultsView.resultsView.lockedForOtherContols=!0,this.searchResultsView.resultsView.$el.addClass("xecmpf-sq-np-no-inline-toolbar")),this.listenTo(this.searchResultsView,{"set:picker:result":function(e){this._result=e},"close go:back":function(){this.triggerMethod("close")}})},"onBeforeDestroy":function(){this.options.query.clear(),this.searchFormView.destroy(),this.searchResultsView.destroy()},"show":function(){this._deferred=t.Deferred();var n=this.options.originatingView,s=this.options.containerEl;if(n instanceof i.View){var a=t("<div/>",{"class":"xecmpf-savedquery-node-picker"}),r=e.isString(s)&&t(s+">*")||n.$el;r.parent().append(a),this.searchResultsView.render(),o.triggerMethodOn(this.searchResultsView,"before:show"),a.append(this.searchResultsView.el);var c=this;return a.show("blind",{"direction":"right","complete":function(){r.hide(),n.isDisplayed=!1,c.searchResultsView.ui.searchSidePanel.hasClass("csui-is-hidden")&&c.searchResultsView.headerView.triggerMethod("toggle:filter",c.searchResultsView),o.triggerMethodOn(c.searchResultsView,"show")}},100),this.listenTo(this,"close",function(){r.show(),r.promise().done(function(){n.isDisplayed=!0,a.hide("blind",{"direction":"right","complete":function(){c._result?c._deferred.resolve(c._result):"pending"===c._deferred.state()&&c._deferred.reject({"cancelled":!0}),c.destroy(),a.remove()}},100)})}),this._deferred}return this._deferred.reject().promise()}});return l}),csui.define("hbs!xecmpf/controls/search.textbox/impl/search.textbox",["module","hbs","csui/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,o){var n;return'<div class="xecmpf-search-bar" role="dialog">\r\n  <div class="xecmpf-search-bar-content">  \r\n      <span class="xecmpf-search-icon-static" title="'+this.escapeExpression((n=null!=(n=t.searchTooltip||(null!=e?e.searchTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchTooltip","hash":{}}):n))+'"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=t.searchTooltip||(null!=e?e.searchTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchTooltip","hash":{}}):n))+'"></span>  \r\n    <div class="xecmpf-search-input-container">\r\n      <input type="text" class="xecmpf-input" placeholder="'+this.escapeExpression((n=null!=(n=t.searchFromHere||(null!=e?e.searchFromHere:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchFromHere","hash":{}}):n))+'"\r\n             title="'+this.escapeExpression((n=null!=(n=t.searchFromHere||(null!=e?e.searchFromHere:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchFromHere","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.searchFromHere||(null!=e?e.searchFromHere:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchFromHere","hash":{}}):n))+'">\r\n    </div>\r\n    <a href="#" class="xecmpf-clearer formfield_clear" title="'+this.escapeExpression((n=null!=(n=t.clearTextTooltip||(null!=e?e.clearTextTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"clearTextTooltip","hash":{}}):n))+'"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=t.clearTextTooltip||(null!=e?e.clearTextTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"clearTextTooltip","hash":{}}):n))+'"></a>\r\n  </div>\r\n</div>\r\n<div role="button" class="xempf-search-close" aria-label="'+this.escapeExpression((n=null!=(n=t.closeSearchTooltip||(null!=e?e.closeSearchTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"closeSearchTooltip","hash":{}}):n))+'">\r\n  <a href="javascript:void(0);" class="icon xecmpf-icon-close xempf-search-hide csui-acc-focusable"\r\n    title="'+this.escapeExpression((n=null!=(n=t.closeSearchTooltip||(null!=e?e.closeSearchTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"closeSearchTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.closeSearchTooltip||(null!=e?e.closeSearchTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"closeSearchTooltip","hash":{}}):n))+'" aria-expanded="false"></a>\r\n</div>'}});return i.registerPartial("xecmpf_controls_search.textbox_impl_search.textbox",o),o}),csui.define("xecmpf/controls/search.textbox/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/controls/search.textbox/impl/nls/root/lang",{"searchFromHere":"Search from here","closeSearchTooltip":"Clear all text and hide search","clearTextTooltip":"Clear all text in this field","search":"search"}),csui.define("css!xecmpf/controls/search.textbox/impl/search.textbox",[],function(){}),csui.define("xecmpf/controls/search.textbox/search.textbox.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/contexts/factories/search.query.factory","hbs!xecmpf/controls/search.textbox/impl/search.textbox","i18n!xecmpf/controls/search.textbox/impl/nls/lang","i18n","css!xecmpf/controls/search.textbox/impl/search.textbox"],function(e,t,i,o,n,s,a,r){"use strict";var c=t.defaults({},e.config(),{"inputValue":"","nodeId":"","nodeName":""}),l=o.ItemView.extend({"className":"xecmpf-search-text-box","template":s,"ui":{"input":".xecmpf-input","clearer":".xecmpf-clearer","closeSearchBtn":".xempf-search-hide"},"events":{"keyup @ui.input":"inputTyped","keydown @ui.input":"inputTyped","paste @ui.input":"inputChanged","change @ui.input":"inputChanged","click @ui.clearer":"clearerClicked","keydown @ui.clearer":"keyDownOnClear","click @ui.closeSearchBtn":"closeSearchButtonClicked","keydown @ui.closeSearchBtn":"KeyDownOnCloseSearchBtn"},"templateHelpers":function(){return{"searchFromHere":a.searchFromHere,"clearTextTooltip":a.clearTextTooltip,"closeSearchTooltip":a.closeSearchTooltip,"searchTooltip":a.search}},"constructor":function(e){e||(e={}),e.data=t.defaults({},e.data,c),this.direction=r.settings.rtl?"left":"right";var i=e.context;e.model||(e.model=i.getModel(n)),o.ItemView.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.options.data.inputValue||this.model.get("where");e&&this._setInputValue(e)},"inputTyped":function(e){var t=this.ui.input.val().trim();32===e.which?e.stopPropagation():13===e.which?(e.preventDefault(),e.stopPropagation(),this._setInputValue(t),t&&this.searchIconClicked(e),this.previousValue!==t&&(this.previousValue=t)):this.inputChanged(e)},"inputChanged":function(e){var t=this.ui.input.val();this.ui.clearer.toggle(!!t.length)},"clearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this._setInputValue(""),this.ui.input.trigger("focus")},"keyDownOnClear":function(e){13===e.keyCode&&this.clearerClicked(e)},"searchIconClicked":function(e){var t=this.ui.input.val().trim();if(t){this._setInputValue(t);var i=this.options.data.nodeId;t&&(this._setSearchQuery(t,this.options.sliceString,i,e),this._updateInput(),this.options.data.searchFromHere=!0),this._triggerSearchResults()}},"_updateInput":function(){if(this._isRendered){var e=this.model.get("where")||"";this._setInputValue(e)}},"_setSearchQuery":function(e,t,i,o){this.model.clear({"silent":!0});var n={};t&&(n.slice=t),i&&(n.location_id1=i),e&&(n.where=e),this.model.set(n)},"_setInputValue":function(e){this.ui.input.val(e),this.ui.clearer.toggle(!!e.length)},"closeSearchButtonClicked":function(e){this.trigger("hide:searchbar")},"KeyDownOnCloseSearchBtn":function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.trigger("hide:searchbar"))},"_triggerSearchResults":function(){this.trigger("search:results")}});return l}),csui.define("xecmpf/controls/property.panels/reference/reference.panel.controller",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/utils/log"],function(e,t,i,o,n,s,a){"use strict";function r(e,o,n,s){var a=i.Deferred();return csui.require(["xecmpf/controls/bosearch/bosearch.model","xecmpf/controls/bosearch/bosearch.dialog.controller","xecmpf/controls/property.panels/reference/impl/workspace.reference.model","xecmpf/controls/property.panels/reference/impl/reference.panel.model","xecmpf/controls/property.panels/reference/impl/reference.panel.view"],function(r,c,l,d,p){var u={};e.options.context.trigger("request:actioncontext",u);var h=t.extend(u.actionContext||{},{"mode":o});e.options.context.once("request:actioncontext",function(e){e.actionContext=h}),h.workspaceReference?(h.workspaceReference.node=e.options.model,h.workspaceReference.set(s)):h.workspaceReference=new l(s,{"node":e.options.model});var m=h.workspaceReference,f=m.get("id")?m.fetch():i.Deferred().resolve().promise();f.then(function(){n&&(null!=m.get("bo_type_id")?n.addClass("conws-reference-showing"):n.removeClass("conws-reference-showing")),null!=m.get("bo_type_id")?a.resolve([{"model":new d,"contentView":p,"contentViewOptions":{"actionContext":h}}]):a.resolve([])},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise()}var c=n.Controller.extend({"constructor":function(e){n.Controller.prototype.constructor.apply(this,arguments)},"getPropertyPanels":function(e){var t;if(t=this.options&&this.options.model&&848===this.options.model.get("type")&&!this.options.context.options.suppressReferencePanel){a.debug("getPropertyPanels for connected workspace called")&&console.log(a.last);var o="workspace_reference_edit",n=i(".cs-perspective-panel .cs-properties-wrapper .metadata-content .cs-metadata"),s={"id":this.options.model.get("id"),"bo_id":void 0,"bo_type_id":void 0,"bo_type_name":void 0,"ext_system_id":void 0,"ext_system_name":void 0};return r(this,o,n,s)}return null},"getPropertyPanelsForCreate":function(e){function i(e,i){e&&(i.listenTo(e,"before:render",function(){if(e.addPropertiesView&&(e.addPropertiesViewIsXecmRecreated||(e._createAddPropertiesView(),e.addPropertiesViewIsXecmRecreated=!0)),e.addPropertiesView&&e.addPropertiesView.collection&&!e.addPropertiesView.collection.hasXecmFilterModelsFunction){var i=e.addPropertiesView.collection.filterModels;e.addPropertiesView.collection.filterModels=function(e){return arguments[0]=t.filter(e,function(e){var t=e.get("signature");return"AddRMClassification"===t||"AddCategory"===t}),i.apply(this,arguments)},e.addPropertiesView.collection.hasXecmFilterModelsFunction=!0,e.addPropertiesView.collection.refilter()}}),i.listenTo(e,"render",function(){e.addPropertiesViewIsXecmRecreated&&delete e.addPropertiesViewIsXecmRecreated}))}var o,n;if(e&&e.forms&&e.forms.models&&t.each(e.forms.models,function(e){"general"===e.get("id")&&(o=e.get("data"),n=o?848===o.type:!1)},this),n=n&&!this.options.context.options.suppressReferencePanel,n&&(a.debug("getPropertyPanelsForCreate for connected workspace called")&&console.log(a.last),o)){var s="workspace_reference_create",c=e&&e.forms,l=c&&c.formCollection,d=l&&l.bo_id,p=l&&l.options,u=p&&p.metadataAddItemController,h=u&&u.dialog,m=h&&h.$(".binf-modal-content .binf-modal-body .cs-add-item-metadata-form"),f={"id":void 0,"bo_id":d,"bo_type_id":o.bo_type_id,"bo_type_name":o.bo_type_name,"ext_system_id":o.ext_system_id,"ext_system_name":o.ext_system_name,"change_reference":!0,"complete_reference":!0},g=u&&u.metadataAddItemPropView,b=g&&g.metadataPropertiesView;return b&&i(b,this),r(this,s,m,f)}return null}});return c}),csui.define("xecmpf/controls/property.panels/reference/reference.panel",["xecmpf/controls/property.panels/reference/reference.panel.controller"],function(e){return[{"sequence":10,"controller":e}]}),csui.define("xecmpf/dialogs/node.picker/start.locations/businessobjecttypes.container/businessobjecttypes.container.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/node.base.factory"],function(e,t,i){"use strict";var o=i.extend({"constructor":function(t){t=e.defaults({"node":{"type":888}},t),i.prototype.constructor.call(this,t)},"updateLocationModel":function(e){return e.set({"invalid":!0}),t.Deferred().resolve().promise()}});return o}),csui.define("xecmpf/dialogs/node.picker/start.locations/extended.ecm.volume.container/extended.ecm.volume.container.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i){"use strict";var o=t.extend({"constructor":function(o){o=e.defaults({"node":{"id":"volume","type":882},"unselectable":!0,"defaultName":i.labelExtendedECMVolume},o),t.prototype.constructor.call(this,o)}});return o}),csui.define("json!xecmpf/widgets/workspaces/workspaces.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"Workspaces Creation and Completion Widget","description":"User gets a list of early workspaces so he can select one workspace to complete the reference. If the user does not find an appropriate early workspace he can create a new workspace.","schema":{"type":"object","properties":{"busObjectId":{"type":"string","title":"Business object id","description":"ID of a business object"},"busObjectType":{"type":"string","title":"Business object type","description":"Type of a business object"},"extSystemId":{"type":"string","title":"External system id","description":"ID of an external system"}}}}),csui.define("json!xecmpf/widgets/boattachments/boattachments.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"Business Attachments","description":"Shows business attachments for a business object","schema":{"type":"object","properties":{"title":{"type":"object","title":"Title","description":"Title of the business attachments widget"},"businessattachment":{"type":"object","title":"Business attachment","description":"Business attachment specific options","properties":{"properties":{"type":"object","title":"Properties","description":"Configuration properties","properties":{"busObjectId":{"type":"string","title":"Business object id","default":"","description":"ID of the business object whose business attachments are displayed"},"busObjectType":{"type":"string","title":"Business object type","default":"","description":"Type of the business object"},"extSystemId":{"type":"string","title":"Business application ID","default":"","description":"Business application of the business object"}}}}},"collapsedView":{"type":"object","title":"Collapsed view","description":"Options for the collapsed view of this widget","properties":{"noResultsPlaceholder":{"type":"object","title":"Message for empty result","description":"Message if there are no business attachments to display"},"orderBy":{"type":"object","title":"Order by","description":"Sort order of the displayed business attachments","properties":{"sortColumn":{"type":"string","title":"Column","description":"Column to order by"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"Sort order","description":"Sort order to be used"}}},"title":{"type":"object","title":"Business attachment title","description":"Title of the business attachment in collapsed view","properties":{"value":{"type":"string","title":"Title","description":"Value for the Title field"}}},"description":{"type":"object","title":"Business attachment description","description":"Description of the business attachment in collapsed view","properties":{"value":{"type":"string","title":"Description","description":"Value for the description field"}}},"topRight":{"type":"object","title":"Top right metadata field","description":"Metadata displayed in top right metadata field in collapsed view","properties":{"label":{"type":"object","title":"Label","description":"Label for the metadata field"},"value":{"type":"string","title":"Value","description":"Value for the top right metadata field"}}},"bottomLeft":{"type":"object","title":"Bottom left  metadata field","description":"Metadata displayed in bottom left metadata field in collapsed view","properties":{"label":{"type":"object","title":"Label","description":"Label for the metadata field"},"value":{"type":"string","title":"Value","description":"Value for the bottom left metadata field"}}},"bottomRight":{"type":"object","title":"Bottom right metadata field","description":"Metadata displayed in bottom right metadata field in collapsed view","properties":{"label":{"type":"object","title":"Label","description":"Label for the metadata field"},"value":{"type":"string","title":"Value","description":"Value for the bottom right metadata  metadata field"}}}}},"expandedView":{"type":"object","title":"Expanded view","description":"Options for the expanded view of this widget","properties":{"orderBy":{"type":"object","title":"Order by","description":"Sort order of the displayed business attachments","properties":{"sortColumn":{"type":"string","title":"Column","description":"Column to order by"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"Sort order","description":"Sort order to be used"}}}}},"snapshot":{"type":"object","title":"Snapshot","description":"Options for the snapshots of Business Attachments","properties":{"parentFolderName":{"type":"string","title":"Parent folder name","description":"Folder in business workspace, where Snapshots are created."},"folderNamePrefix":{"type":"string","title":"Snapshot name prefix","description":"The name of a snapshot consists of the prefix and a timestamp."}}}}},"options":{"fields":{"businessattachment":{"fields":{"properties":{"fields":{"busObjectId":{"type":"otconws_metadata_string"},"busObjectType":{"type":"otconws_metadata_string"},"extSystemId":{"type":"otconws_metadata_string"}}}}},"title":{"type":"otcs_multilingual_string"},"collapsedView":{"fields":{"noResultsPlaceholder":{"type":"otcs_multilingual_string"},"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["Ascending","Descending"]}}},"title":{"fields":{"value":{"type":"otconws_customcolumn"}}},"description":{"fields":{"value":{"type":"otconws_customcolumn"}}},"topRight":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}},"bottomLeft":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}},"bottomRight":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}}}},"expandedView":{"fields":{"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["Ascending","Descending"]}}}}},"snapshot":{"fields":{"parentFolderName":{"type":"text"},"folderNamePrefix":{"type":"text"}}}}}}),csui.define("json!xecmpf/widgets/dossier/dossier.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"Dossier","description":"Dossier View for business workspaces grouped by some criterion say create date ,classification","schema":{"type":"object","properties":{"groupBy":{"type":"string","enum":["classification","create_date"],"default":"create_date","title":"Default group by criterion","description":"Group by criterion that dossier view will use to load for the first time"},"hideGroupByCriterionDropdown":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide group by criterion dropdown","description":"Option to hide the dropdown to choose the group by criterion"},"hideMetadata":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide metadata","description":"Option to hide the document's metadata view"},"metadata":{"type":"array","title":"Metadata","description":"Metadata displayed for document","items":{"type":"object","title":"Category or attribute","description":"Category or attribute with metadata"}},"hideEmptyFields":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide empty fields","description":"Display only fields with values"},"hideFavorite":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide favorite","description":"Option to hide the favorite icon"}}},"options":{"fields":{"groupBy":{"type":"select","optionLabels":["Classification","Create Date"]},"metadata":{"fields":{"item":{"type":"otconws_metadata"}}}}}}),csui.define("json!xecmpf/widgets/header/header.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"Header","description":"Header widget for business workspaces","schema":{"type":"object","properties":{"workspace":{"type":"object","title":"Workspace","description":"Workspace specific options","properties":{"properties":{"type":"object","title":"Properties","description":"Configuration properties","properties":{"title":{"type":"string","title":"Title","default":"{name}","description":"Name of the business workspace"},"type":{"type":"string","title":"Type","default":"{business_properties.workspace_type_name}","description":"Name of the workspace type"},"description":{"type":"string","title":"Description","default":"{description}","description":"Description of the business workspace"}}}}},"completenessCheckSettings":{"type":"object","title":"Completeness check","description":"Completeness check configuration","properties":{"hideMissingDocsCheck":{"title":"Hide missing documents check","description":"Option to show or hide the missing document check","type":"boolean","default":!1},"hideOutdatedDocsCheck":{"title":"Hide outdated documents check","description":"Option to show or hide the outdated document check. This option will be effective only if the Extended ECM for SAP SuccessFactors module is installed on the system","type":"boolean","default":!1},"hideInProcessDocsCheck":{"title":"Hide In process documents check","description":"Option to show or hide the In process document check. This option will be effective only if the Extended ECM for SAP SuccessFactors module is installed on the system","type":"boolean","default":!1}}},"headerwidget":{"type":"object","title":"Widget","description":"Additional widget that can be embedded in the header widget","properties":{"type":{"type":"string","enum":["none","activityfeed","metadata"],"default":"none","title":"Embed widget","description":"Widget to be embedded in the header widget"}}},"metadataSettings":{"type":"object","title":"Metadata","description":"Header metadata configuration","properties":{"metadataInColumns":{"type":"string","enum":["singleCol","doubleCol"],"default":"doubleCol","title":"Show Metadata In Columns","description":"Show Metadata In Columns"},"hideMetadata":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide Metadata","description":"Hide metadata on header"},"hideEmptyFields":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide empty fields","description":"Display only fields with values"},"metadata":{"type":"array","title":"Metadata","description":"Metadata displayed in Header widget","items":{"type":"object","title":"Category or attribute","description":"Category or attribute with metadata"}}}},"favoriteSettings":{"type":"object","title":"Favorite","description":"Favorite configuration","properties":{"hideFavorite":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"Hide Favorite","description":"Option to hide the favorite icon on the header"}}}}},"options":{"fields":{"workspace":{"fields":{"properties":{"fields":{"title":{"type":"otconws_metadata_string"},"type":{"type":"otconws_metadata_string"},"description":{"type":"otconws_metadata_string"}}}}},"metadataSettings":{"fields":{"metadata":{"fields":{"item":{"type":"otconws_metadata"}}},"metadataInColumns":{"type":"select","optionLabels":["Single","Double"]}}},"headerwidget":{"fields":{"type":{"type":"select","optionLabels":["None","Activity Feed","Metadata"]}}}}}}),csui.define("json!xecmpf/widgets/scan/scan.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","properties":{"businessobjecttypes":{"title":"{{botypesTitle}}","description":"{{botypesDescription}}","type":"array","items":{"type":"object","properties":{"id":{"type":"integer","description":"{{botypeBrowseDescription}}","title":"{{botypeBrowseTitle}}"}}}}}},"options":{"fields":{"businessobjecttypes":{"items":{"fields":{"id":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[889],"startLocation":"xecmpf/dialogs/node.picker/start.locations/businessobjecttypes.container"}}}}}}}}}),csui.define("json!xecmpf/utils/perspective/custom.search.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"xecmpf/widgets/integration/folderbrowse/search.results","options":{"enableBackButton":!0}}}]}]}}),csui.define("xecmpf/widgets/scan/impl/nls/scan.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("xecmpf/widgets/scan/impl/nls/root/scan.manifest",{"widgetTitle":"Scan barcode","widgetDescription":"Scans the barcode and opens the corresponding workspace","botypesTitle":"Business Object Types","botypesDescription":"List of business object types which are relavant for the scan","botypeBrowseTitle":"Business Object Type","botypeBrowseDescription":"Select the business object type which is relavant for the scan"}),csui.define("xecmpf/utils/perspective/custom.search.perspective",["csui/lib/backbone"],function(e){return[{"decides":function(){return e.history.root&&!!e.history.root.match("xecm")},"module":"json!xecmpf/utils/perspective/custom.search.json"}]}),csui.define("xecmpf/utils/perspective/eventactionnode.perspective",[],function(){"use strict";return[{"equals":{"type":[898]},"important":!0,"module":"json!xecmpf/utils/perspective/impl/perspectives/eventaction.json"}]}),csui.define("json!xecmpf/utils/perspective/impl/perspectives/eventaction.json",{"type":"left-center-right","options":{"center":{"kind":"fullpage","options":{},"type":"xecmpf/widgets/eac"},"left":{},"right":{}}}),csui.define("bundles/xecmpf-app",["xecmpf/pages/start/perspective-only.page.view","xecmpf/widgets/integration/folderbrowse/search.box.view","xecmpf/widgets/integration/folderbrowse/full.page.workspace.view","xecmpf/widgets/integration/folderbrowse/search.results/search.results.view","xecmpf/widgets/integration/folderbrowse/modaldialog/modal.dialog.view","xecmpf/utils/commands/folderbrowse/go.to.workspace.history","xecmpf/utils/commands/folderbrowse/search.container","xecmpf/utils/commands/folderbrowse/open.full.page.workspace","xecmpf/utils/commands/workspaces/workspace.delete","xecmpf/utils/commands/boattachments/boattachments.create","xecmpf/utils/commands/eac/eac.refresh","xecmpf/utils/commands/eac/eac.back","xecmpf/widgets/boattachments/impl/boattachment.table/commands/snapshot","xecmpf/behaviors/toggle.header/toggle.header.behavior","xecmpf/widgets/integration/folderbrowse/toolbaritems","xecmpf/widgets/boattachments/impl/boattachment.table/tablecell/createdby.view","xecmpf/widgets/boattachments/impl/boattachment.table/tablecell/modifiedby.view","xecmpf/controls/table/cells/eac.actionplan.view","xecmpf/controls/bosearch/bosearch.dialog.controller","xecmpf/controls/property.panels/reference/impl/reference.panel.view","xecmpf/widgets/boattachments/boattachments.view","xecmpf/widgets/workspaces/workspaces.widget","xecmpf/widgets/myattachments/metadata.property.panels","xecmpf/widgets/dossier/dossier.view","xecmpf/widgets/eac/eac.view","xecmpf/widgets/header/header.view","xecmpf/widgets/scan/scan.view","xecmpf/utils/document.thumbnail/document.thumbnail.view","xecmpf/controls/savedquery.node.picker/savedquery.node.picker.view","xecmpf/controls/savedquery.node.picker/impl/savedquery.form.view","xecmpf/controls/search.textbox/search.textbox.view","xecmpf/controls/property.panels/reference/reference.panel","xecmpf/dialogs/node.picker/start.locations/businessobjecttypes.container/businessobjecttypes.container.factory","xecmpf/dialogs/node.picker/start.locations/extended.ecm.volume.container/extended.ecm.volume.container.factory","json!xecmpf/widgets/workspaces/workspaces.manifest.json","json!xecmpf/widgets/boattachments/boattachments.manifest.json","json!xecmpf/widgets/dossier/dossier.manifest.json","json!xecmpf/widgets/header/header.manifest.json","json!xecmpf/widgets/scan/scan.manifest.json","json!xecmpf/utils/perspective/custom.search.json","i18n!xecmpf/widgets/scan/impl/nls/scan.manifest","i18n!xecmpf/widgets/boattachments/impl/nls/lang","i18n!xecmpf/controls/property.panels/reference/impl/nls/lang","xecmpf/utils/perspective/custom.search.perspective","xecmpf/widgets/boattachments/impl/boattachmentutil","xecmpf/utils/perspective/eventactionnode.perspective","json!xecmpf/utils/perspective/impl/perspectives/eventaction.json"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"xecmpf/bundles/xecmpf-app",!0)});
//# sourceMappingURL=xecmpf-app.js.map